------------------------------------------------------------------------
r12076 | havoc | 2014-05-13 15:13:15 -0700 (Tue, 13 May 2014) | 1 line
Changed paths:
   M /trunk/darkplaces/collision.c

Changed the collision code used by sv_gameplayfix_nudgeoutofsolid to not consider collision_impactnudge as that is already taken care of by the caller, and the way it was being done would typically reject such collisions anyway.
------------------------------------------------------------------------
r12075 | havoc | 2014-05-13 10:59:02 -0700 (Tue, 13 May 2014) | 1 line
Changed paths:
   M /trunk/darkplaces/collision.c

Removed collision_enternudge, collision_leavenudge, collision_startnudge, collision_endnudge cvars, all replaced with their current value (0) as other values break collisions too badly to be of practical value.
------------------------------------------------------------------------
r12074 | havoc | 2014-05-13 10:43:21 -0700 (Tue, 13 May 2014) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/collision.c
   M /trunk/darkplaces/collision.h
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c

Removed collision_prefernudgedfraction cvar and trace.realfraction field, this has been 1 for a very long time and it is time to lock in that value, thus trace.realfraction no longer has any reason to exist.
------------------------------------------------------------------------
r12073 | havoc | 2014-05-13 10:03:38 -0700 (Tue, 13 May 2014) | 1 line
Changed paths:
   M /trunk/darkplaces/collision.c

Changed collision_enternudge and collision_leavenudge back to 0 because of massive sticking issues in terrain maps such as the Nexuiz 2.5.2 map ons-reborn.
------------------------------------------------------------------------
r12072 | havoc | 2014-05-07 20:10:57 -0700 (Wed, 07 May 2014) | 6 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/cl_collision.h
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/collision.c
   M /trunk/darkplaces/collision.h
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/sbar.c
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_move.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sv_user.c
   M /trunk/darkplaces/svvm_cmds.c
   M /trunk/darkplaces/view.c

Overhauled the tracebox extending code, it now lives in collision.c rather than cl_collision.c/sv_phys.c and has 3 cvars controlling it:
collision_extendmovelength - affects ALL engine traces (physics, etc), this has a higher value because of how important it is to not get stuck in things.
collision_extendtraceboxlength - affects only the qc tracebox builtin.
collision_extendtracelinelength - affects only the qc traceline builtin (in particular it is a bad idea to set this to a high value because it can interfere with trace_inwater/trace_inair reporting).
Changed collision_enternudge/collision_leavenudge to behave more like Quake2/Quake3, this means that you can not sink into a brush (assuming the brush is detected - see collision_extendmovelength).
Some beautification on the RecursiveHullCheck and RecursiveLightPoint code.
------------------------------------------------------------------------
r12071 | havoc | 2014-05-07 20:06:11 -0700 (Wed, 07 May 2014) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

Reworked r_useportalculling to use expanded portal bboxes based on r_nearclip, this resolves an issue where a portal could lie entirely behind the nearclip plane of the frustum, but still need to be recursed.
------------------------------------------------------------------------
r12070 | havoc | 2014-05-07 18:02:39 -0700 (Wed, 07 May 2014) | 1 line
Changed paths:
   M /trunk/darkplaces/model_brush.c

Fixed LightPoint code to deal better with lightmap bounds checking, this resolves several issues with item pickups in specific maps being lit wrong, thanks to jitspoe for discussion that led to this fix.
------------------------------------------------------------------------
r12069 | havoc | 2014-05-07 17:51:07 -0700 (Wed, 07 May 2014) | 1 line
Changed paths:
   M /trunk/darkplaces/sv_phys.c

Fix a compile error when using COLLISION_PARANOID 3.
------------------------------------------------------------------------
r12068 | havoc | 2014-05-07 17:48:59 -0700 (Wed, 07 May 2014) | 1 line
Changed paths:
   M /trunk/darkplaces/sv_phys.c

Fix sv_jumpstep cvar, whose behavior was completely inverted (jump stepping worked with it off, and did not work with it on).
------------------------------------------------------------------------
r12067 | havoc | 2014-05-07 15:02:04 -0700 (Wed, 07 May 2014) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_sdl.c

fix compile error caused by mixing of SDL2 and SDL1 code

------------------------------------------------------------------------
r12066 | divverent | 2014-05-07 02:42:41 -0700 (Wed, 07 May 2014) | 1 line
Changed paths:
   M /trunk/darkplaces/vid_sdl.c

Turn off alpha blending on vid_softsurface.
------------------------------------------------------------------------
r12065 | havoc | 2014-04-30 18:50:34 -0700 (Wed, 30 Apr 2014) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile

changed macosx default LINK_LIB_JPEG from shared to dlopen as we still distribute the jpeg62 version with it

------------------------------------------------------------------------
r12062 | divverent | 2014-04-09 06:05:42 -0700 (Wed, 09 Apr 2014) | 1 line
Changed paths:
   M /trunk/darkplaces/dpdefs/dpextensions.qc

Argh, had to update the VM_sprintf extension spec. No code change.
------------------------------------------------------------------------
r12061 | havoc | 2014-04-08 21:35:09 -0700 (Tue, 08 Apr 2014) | 4 lines
Changed paths:
   M /trunk/darkplaces/shader_glsl.h

patch from graphitemaster that changes r_fxaa use of texture2D in
default.glsl to use dp_texture2D instead (which resolves to the correct
texture function on later GL versions)

------------------------------------------------------------------------
r12060 | divverent | 2014-04-05 03:07:18 -0700 (Sat, 05 Apr 2014) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/makefile.inc

Make r_fxaa also enable postprocessing shaders so only one cvar is
needed to enable FXAA.

From: graphitemaster
------------------------------------------------------------------------
r12059 | divverent | 2014-04-05 03:07:15 -0700 (Sat, 05 Apr 2014) | 1 line
Changed paths:
   M /trunk/darkplaces/shader_glsl.h
   M /trunk/darkplaces/shader_hlsl.h

Properly make the blur conditional on non empty uservecs 1 and 2.
------------------------------------------------------------------------
r12058 | havoc | 2014-03-15 17:06:53 -0700 (Sat, 15 Mar 2014) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

changed dpmaster.deathmask.net ip4 address, added ip6 address

------------------------------------------------------------------------
r12057 | divverent | 2014-03-15 05:23:41 -0700 (Sat, 15 Mar 2014) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

Fix very stupid typo by me in counting coverage() statements.
------------------------------------------------------------------------
r12056 | divverent | 2014-03-08 09:57:10 -0800 (Sat, 08 Mar 2014) | 1 line
Changed paths:
   M /trunk/darkplaces/dpdefs/csprogsdefs.qc
   M /trunk/darkplaces/dpdefs/dpextensions.qc

Clarify what sprintf does on %1$s %s
------------------------------------------------------------------------
r12055 | havoc | 2014-03-04 15:21:13 -0800 (Tue, 04 Mar 2014) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c

increase MAX_PARTICLEEFFECTNAME and MAX_PARTICLEEFFECTINFO limits
(formerly 256,4096 and now 4096,8192)

------------------------------------------------------------------------
r12054 | havoc | 2014-02-25 18:38:43 -0800 (Tue, 25 Feb 2014) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

make R_View_UpdateEntityVisible more readable and consistent

------------------------------------------------------------------------
r12053 | havoc | 2014-02-24 15:44:45 -0800 (Mon, 24 Feb 2014) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

don't skip nearclip plane in R_CullBox as it is possible that the view
is in ortho mode

------------------------------------------------------------------------
r12052 | havoc | 2014-01-29 18:05:50 -0800 (Wed, 29 Jan 2014) | 8 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

allow .rtlights files to have style values outside the range
0...MAX_LIGHTSTYLES - in particular, -1 is used by fte for unstyled
lights and this is a compatible behavior, just that the loader was
getting in the way.

for safety the MAX_LIGHTSTYLES comparison has been added to each use of
light->style in rendering.

------------------------------------------------------------------------
r12051 | divverent | 2014-01-24 08:39:06 -0800 (Fri, 24 Jan 2014) | 5 lines
Changed paths:
   M /trunk/darkplaces/crypto.c
   M /trunk/darkplaces/crypto.h
   M /trunk/darkplaces/netconn.c

Fix some d0_blind_id related bugs:

- Higher numbered CAs should have priority over lower numbered CAs,
  making CA 0 the "default" CA.
- Fix the "Authenticated connection to ..." message (no more -@- crap).
------------------------------------------------------------------------
r12050 | divverent | 2014-01-18 03:19:45 -0800 (Sat, 18 Jan 2014) | 1 line
Changed paths:
   M /trunk/darkplaces/vid_wgl.c

Always pass CDS_FULLSCREEN to ChangeDisplaySettings, fixes #1797.
------------------------------------------------------------------------
r12049 | divverent | 2014-01-10 10:53:30 -0800 (Fri, 10 Jan 2014) | 1 line
Changed paths:
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/vid_sdl.c

sdl2: fix mouse wheel
------------------------------------------------------------------------
r12048 | divverent | 2014-01-10 10:38:11 -0800 (Fri, 10 Jan 2014) | 1 line
Changed paths:
   M /trunk/darkplaces/vid_sdl.c

sdl2: fix compile.
------------------------------------------------------------------------
r12047 | divverent | 2014-01-08 08:02:04 -0800 (Wed, 08 Jan 2014) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_exec.c
   M /trunk/darkplaces/prvm_execprogram.h

Support statementprofiling in the fast interpreter.
------------------------------------------------------------------------
r12046 | divverent | 2014-01-08 08:02:01 -0800 (Wed, 08 Jan 2014) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_execprogram.h

Restructure profiling to allow easier statement coverage later.
------------------------------------------------------------------------
r12045 | divverent | 2014-01-08 08:01:58 -0800 (Wed, 08 Jan 2014) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_execprogram.h

Use PreError() for warnings too. Simpler code!
------------------------------------------------------------------------
r12044 | divverent | 2014-01-07 11:22:59 -0800 (Tue, 07 Jan 2014) | 5 lines
Changed paths:
   M /trunk/darkplaces/prvm_exec.c
   M /trunk/darkplaces/prvm_execprogram.h

Use an explicit jump table for QCVM instruction dispatch.

Also, duplicate the dispatch into the end of each case for additional
speedup (each of these branches gets a separate branch prediction slot
on many CPUs, which pays off quickly).
------------------------------------------------------------------------
r12043 | divverent | 2014-01-07 08:29:29 -0800 (Tue, 07 Jan 2014) | 1 line
Changed paths:
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_exec.c
   M /trunk/darkplaces/prvm_execprogram.h

Better coverage output.
------------------------------------------------------------------------
r12042 | divverent | 2014-01-07 08:29:25 -0800 (Tue, 07 Jan 2014) | 9 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/dpdefs/csprogsdefs.qc
   M /trunk/darkplaces/dpdefs/dpextensions.qc
   M /trunk/darkplaces/dpdefs/menudefs.qc
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/prvm_exec.c
   M /trunk/darkplaces/prvm_execprogram.h
   M /trunk/darkplaces/svvm_cmds.c

COVERAGE! Also fixes prvm always running as PRVMSLOWINTERPRETER :(

Very basic implementation. Needs a persistent store later, I suppose, as
well as better output (e.g. for statements and coverage(), also show
function, file and line).

prvm_coverage 1: report function call coverage
prvm_coverage 2: report coverage() builtin coverage (compiler aided)
prvm_coverage 4: report statement coverage (SLOW)
------------------------------------------------------------------------
r12041 | divverent | 2014-01-07 08:29:21 -0800 (Tue, 07 Jan 2014) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/prvm_cmds.h

Fix some warnings.
------------------------------------------------------------------------
r12040 | divverent | 2014-01-06 02:00:04 -0800 (Mon, 06 Jan 2014) | 3 lines
Changed paths:
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/prvm_exec.c

Patch by graphitemaster to support column number enhanced lno format.

From: Dale Weiler <killfieldengine@gmail.com>
------------------------------------------------------------------------
r12039 | divverent | 2014-01-06 01:49:47 -0800 (Mon, 06 Jan 2014) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

Disable r_water_hideplayer while in chase camera view

From: Samual Lenks <samual@xonotic.org>
------------------------------------------------------------------------
r12038 | divverent | 2014-01-06 01:48:46 -0800 (Mon, 06 Jan 2014) | 5 lines
Changed paths:
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/sv_main.c

CSQC entity sending rework.

Properly support returning FALSE from a CSQC entity to mean "remove".

From: Rudolf Polzer <divverent@xonotic.org>
------------------------------------------------------------------------
r12037 | divverent | 2014-01-06 01:48:43 -0800 (Mon, 06 Jan 2014) | 3 lines
Changed paths:
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c

Kill csqcentityglobalhistory.

From: Rudolf Polzer <divverent@xonotic.org>
------------------------------------------------------------------------
r12036 | divverent | 2014-01-06 01:48:40 -0800 (Mon, 06 Jan 2014) | 3 lines
Changed paths:
   M /trunk/darkplaces/protocol.c

Give CSQC entity scopes names.

From: Rudolf Polzer <divverent@xonotic.org>
------------------------------------------------------------------------
r12035 | divverent | 2014-01-04 04:46:04 -0800 (Sat, 04 Jan 2014) | 1 line
Changed paths:
   M /trunk/darkplaces/libcurl.c

Fix cl_curl_maxspeed 0 + sv_curl_maxspeed > 0.
------------------------------------------------------------------------
r12034 | divverent | 2014-01-03 00:26:05 -0800 (Fri, 03 Jan 2014) | 4 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

Unbreak most of sv_ratelimitlocalplayer.

A redesign to move the rate stuff from function parameters into the
netconn struct needs doing.
------------------------------------------------------------------------
r12033 | divverent | 2013-12-23 02:52:33 -0800 (Mon, 23 Dec 2013) | 4 lines
Changed paths:
   M /trunk/darkplaces/console.c

"log_file_stripcolors" cvar to strip colors from log_file;
Also add condump_stripcolors.

From: nitroxis <nitroxis@wtwrp.de>
------------------------------------------------------------------------
r12032 | divverent | 2013-12-19 05:04:19 -0800 (Thu, 19 Dec 2013) | 1 line
Changed paths:
   M /trunk/darkplaces/protocol.c

ENTITYSIZEPROFILING: also log entity number and sendflags.
------------------------------------------------------------------------
r12031 | havoc | 2013-12-14 17:22:30 -0800 (Sat, 14 Dec 2013) | 7 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/csprogs.h

Upgrade CL_VM_InputEvent to using floats rather than ints, this keeps
the precision on fractional absolute mouse positions.

Changed CL_VM_InputEvent passing of relative mouse moves to no longer
scale by vid_conwidth, vid_conheight as this goes against the intention
in most cases (where mouse turning or similar is being achieved).

------------------------------------------------------------------------
r12030 | havoc | 2013-12-14 02:15:36 -0800 (Sat, 14 Dec 2013) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

don't try to validate parameters to an opcode that is unrecognized

------------------------------------------------------------------------
r12029 | havoc | 2013-11-29 18:49:09 -0800 (Fri, 29 Nov 2013) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/shader_glsl.h
   M /trunk/darkplaces/shader_hlsl.h

Patch from graphitemaster adding r_fxaa cvar, this enables the popular pseudo-antialiasing method in postprocess.
------------------------------------------------------------------------
r12028 | havoc | 2013-11-29 12:14:31 -0800 (Fri, 29 Nov 2013) | 4 lines
Changed paths:
   M /trunk/darkplaces/BSDmakefile
   M /trunk/darkplaces/makefile.inc

patch from Blub to make BSDmakefile work again, this also changes the
build directories from obj/ to build-obj/ due to pmake having a peculiar
fondness for obj/

------------------------------------------------------------------------
r12027 | havoc | 2013-11-19 22:06:41 -0800 (Tue, 19 Nov 2013) | 3 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

suppress shadow entities when preparing an rtlight with shadows
disabled, this way we don't call R_AnimCache_GetEntity on each one

------------------------------------------------------------------------
r12026 | havoc | 2013-11-03 22:36:48 -0800 (Sun, 03 Nov 2013) | 1 line
Changed paths:
   M /trunk/darkplaces/darkplaces-dedicated-vs2010.vcxproj
   M /trunk/darkplaces/darkplaces-dedicated-vs2012.vcxproj
   M /trunk/darkplaces/darkplaces-sdl-vs2010.vcxproj
   M /trunk/darkplaces/darkplaces-sdl-vs2012.vcxproj
   M /trunk/darkplaces/darkplaces-wgl-vs2010.vcxproj
   M /trunk/darkplaces/darkplaces-wgl-vs2012.vcxproj

enable CONFIG_CD on Visual Studio projects, somehow only CONFIG_MENU was added...  which meant the cd command was missing, so even if hardware cd playback was not wanted it also lost the ability to play music entirely.
------------------------------------------------------------------------
r12025 | havoc | 2013-10-16 13:53:13 -0700 (Wed, 16 Oct 2013) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

clarify in_pitch_* cvar descriptions about upward/downward values

------------------------------------------------------------------------
r12024 | divverent | 2013-10-13 09:40:38 -0700 (Sun, 13 Oct 2013) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

Software tcmod/tcgen: skip if pass needs no texcoords. Fixes #1326.
------------------------------------------------------------------------
r12023 | divverent | 2013-10-11 07:43:19 -0700 (Fri, 11 Oct 2013) | 7 lines
Changed paths:
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/netconn.h

Netconn: when an encrypted connection is used, randomly set one or more of three unused NETFLAGs.

When AES encryption is enabled, this will then work around substring
matching in routers/IPS thanks to CBC and our method of IV selection.
See "startkeylogger". Note that this neither improves nor weakens
security - SSL e.g. has the very issue we're fixing here because it is
based on TCP, and thus resends always are identical payloads.
------------------------------------------------------------------------
r12022 | divverent | 2013-10-10 10:15:03 -0700 (Thu, 10 Oct 2013) | 1 line
Changed paths:
   M /trunk/darkplaces/dpdefs/menudefs.qc

Update m_draw prototype in dpdefs.
------------------------------------------------------------------------
r12021 | divverent | 2013-10-10 10:12:47 -0700 (Thu, 10 Oct 2013) | 11 lines
Changed paths:
   M /trunk/darkplaces/cvar.c
   M /trunk/darkplaces/dpdefs/menudefs.qc
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/menu.h
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/netconn.h
   M /trunk/darkplaces/prvm_offsets.h

Add SLIF_CATEGORY for the server list, and a menu QC function to set it.

Callback:
float m_gethostcachecategory(float entry_id) {
	// Is supposed to use gethostcachestring() etc. and return a
	// category integer.
	// The server list is sorted by this category first if
	// SLSF_CATEGORIES is set in the sort flags.
}

From: Samual Lenks <samual@xonotic.org>
------------------------------------------------------------------------
r12020 | divverent | 2013-10-10 10:09:20 -0700 (Thu, 10 Oct 2013) | 3 lines
Changed paths:
   M /trunk/darkplaces/dpdefs/menudefs.qc
   M /trunk/darkplaces/mvm_cmds.c

Allow refreshserverlist() to also clear the list like net_slist command.

Usage: refreshserverlist(TRUE);
------------------------------------------------------------------------
r12019 | divverent | 2013-10-10 09:53:28 -0700 (Thu, 10 Oct 2013) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

sv_checkforpacketsduringsleep: perform a netconn master server frame
immediately. Fixes ping view in server browser.
------------------------------------------------------------------------
r12018 | divverent | 2013-10-09 05:55:05 -0700 (Wed, 09 Oct 2013) | 1 line
Changed paths:
   M /trunk/darkplaces/libcurl.c

Fix cl_curl_enabled 0.
------------------------------------------------------------------------
r12017 | divverent | 2013-09-30 12:52:54 -0700 (Mon, 30 Sep 2013) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

support "declaring" particle effects at the top of the effectinfo file

Now "effect EFFECTNAME" without any fields set is harmless; the slot it creates
will be used by a later "effect EFFECTNAME" definition.
------------------------------------------------------------------------
r12016 | divverent | 2013-09-29 04:47:50 -0700 (Sun, 29 Sep 2013) | 1 line
Changed paths:
   M /trunk/darkplaces/host.c

Initialize host_dirtytime.
------------------------------------------------------------------------
r12015 | havoc | 2013-09-26 16:27:19 -0700 (Thu, 26 Sep 2013) | 1 line
Changed paths:
   M /trunk/darkplaces/darkplaces-dedicated-vs2010.vcxproj
   M /trunk/darkplaces/darkplaces-dedicated-vs2012.vcxproj
   M /trunk/darkplaces/darkplaces-dedicated.vcproj
   M /trunk/darkplaces/darkplaces-sdl-vs2010.vcxproj
   M /trunk/darkplaces/darkplaces-sdl-vs2012.vcxproj
   M /trunk/darkplaces/darkplaces-sdl.vcproj
   M /trunk/darkplaces/darkplaces-wgl-vs2010.vcxproj
   M /trunk/darkplaces/darkplaces-wgl-vs2012.vcxproj
   M /trunk/darkplaces/darkplaces-wgl.vcproj
   M /trunk/darkplaces/vid_sdl.c

fix several visual studio projects which did not have CONFIG_MENU added
------------------------------------------------------------------------
r12014 | havoc | 2013-09-26 13:54:23 -0700 (Thu, 26 Sep 2013) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c

fix a typo

------------------------------------------------------------------------
r12013 | havoc | 2013-09-26 13:47:40 -0700 (Thu, 26 Sep 2013) | 9 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/netconn.c

added GAME_SSAMMO
added another column to gameinfo for the network filter name (gamename
for master server), and now replaces spaces with _ characters
automatically when using -customgamename, added
-customgamenetworkfiltername to override this if desired

this is necessary to resolve an issue where games whose names contain
spaces were not being supported by dpmaster

------------------------------------------------------------------------
r12012 | havoc | 2013-09-21 11:30:38 -0700 (Sat, 21 Sep 2013) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

restore the wrapping behavior on tcMod scroll for compatibility reasons
(this matches Quake3 logic)

------------------------------------------------------------------------
r12011 | divverent | 2013-09-20 00:22:34 -0700 (Fri, 20 Sep 2013) | 7 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_sdl.c

GLX: Fix desktopfullscreen size when we actually switched to it.

Should fix a few possible issues with getresolution(-1) on a multihead
setup with some window managers.

Also, remove a superfluous memory allocation on GLX when not using
DPSOFTRAST.
------------------------------------------------------------------------
r12010 | divverent | 2013-09-20 00:15:58 -0700 (Fri, 20 Sep 2013) | 1 line
Changed paths:
   M /trunk/darkplaces/vid_wgl.c

Fix a compile error on win32 I introduced.
------------------------------------------------------------------------
r12009 | divverent | 2013-09-19 05:19:24 -0700 (Thu, 19 Sep 2013) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/sbar.c
   M /trunk/darkplaces/sv_main.c

Rework game specific hacks to have a special group for Nexuiz-derived games.

From: Rudolf Polzer <divverent@xonotic.org>
------------------------------------------------------------------------
r12008 | divverent | 2013-09-19 05:19:20 -0700 (Thu, 19 Sep 2013) | 3 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h

Game definitions for Vore Tournament

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r12007 | divverent | 2013-09-19 04:49:40 -0700 (Thu, 19 Sep 2013) | 1 line
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

TEMPHACK_origin is no longer needed. Begone!
------------------------------------------------------------------------
r12006 | divverent | 2013-09-18 02:33:21 -0700 (Wed, 18 Sep 2013) | 1 line
Changed paths:
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_agl.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_null.c
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_wgl.c

vid_desktopfullscreen improvements; allow querying the desktop mode
------------------------------------------------------------------------
r12005 | divverent | 2013-09-17 12:38:35 -0700 (Tue, 17 Sep 2013) | 1 line
Changed paths:
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c

rename netwmfullscreen to desktopfullscreen; implement in other drivers (except agl)
------------------------------------------------------------------------
r12004 | havoc | 2013-09-16 18:17:53 -0700 (Mon, 16 Sep 2013) | 5 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

reworked tcmod to wrap shadertime every 9.1 hours (32768 seconds) rather
than attempting to fixup precision issues in tcmod scroll, which was
breaking shaders that had other tcmod effects after tcmod scroll (or if
they used clampmap)

------------------------------------------------------------------------
r12003 | havoc | 2013-09-15 11:54:47 -0700 (Sun, 15 Sep 2013) | 2 lines
Changed paths:
   M /trunk/darkplaces/csprogs.c

set world.absmin and world.absmax in csqc

------------------------------------------------------------------------
r12002 | divverent | 2013-09-12 05:43:08 -0700 (Thu, 12 Sep 2013) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

Fix loading of common.LANGUAGE.po.
------------------------------------------------------------------------
r12001 | divverent | 2013-09-11 07:58:18 -0700 (Wed, 11 Sep 2013) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

.po support: support common.<language>.po as secondary translation source independent from progs filename
------------------------------------------------------------------------
r12000 | divverent | 2013-08-29 05:55:48 -0700 (Thu, 29 Aug 2013) | 1 line
Changed paths:
   M /trunk/darkplaces/dpdefs/csprogsdefs.qc

remove this movetype from CSQC. How did it get there...
------------------------------------------------------------------------
r11999 | divverent | 2013-08-29 05:40:35 -0700 (Thu, 29 Aug 2013) | 1 line
Changed paths:
   M /trunk/darkplaces/dpdefs/csprogsdefs.qc
   M /trunk/darkplaces/dpdefs/keycodes.qc
   M /trunk/darkplaces/dpdefs/menudefs.qc
   M /trunk/darkplaces/dpdefs/progsdefs.qc

sync dpdefs
------------------------------------------------------------------------
r11998 | divverent | 2013-08-22 07:45:18 -0700 (Thu, 22 Aug 2013) | 3 lines
Changed paths:
   M /trunk/darkplaces/crypto.c

fix bug in Crypto_RetrieveLocalKey

From: Jan Behrens <zykure@web.de>
------------------------------------------------------------------------
r11997 | divverent | 2013-08-08 03:15:09 -0700 (Thu, 08 Aug 2013) | 1 line
Changed paths:
   M /trunk/darkplaces/makefile

fix typo, sorry
------------------------------------------------------------------------
r11996 | divverent | 2013-08-08 02:42:21 -0700 (Thu, 08 Aug 2013) | 1 line
Changed paths:
   M /trunk/darkplaces/makefile

Make d0_rijndael library optional again.
------------------------------------------------------------------------
r11995 | divverent | 2013-08-06 06:40:35 -0700 (Tue, 06 Aug 2013) | 3 lines
Changed paths:
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/svvm_cmds.c

In prog reset functions, do not call functions unless prog->loaded.

This fixes segfaults in case progs loading itself may have caused Host_Error.
------------------------------------------------------------------------
r11994 | divverent | 2013-08-03 09:03:26 -0700 (Sat, 03 Aug 2013) | 3 lines
Changed paths:
   M /trunk/darkplaces/makefile

fix DP_FS_BASEDIR escaping

From: Rudolf Polzer <divverent@xonotic.org>
------------------------------------------------------------------------
r11993 | divverent | 2013-08-03 05:48:23 -0700 (Sat, 03 Aug 2013) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_demo.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/snd_mix.c

Fix name of CONFIG_VIDEO_CAPTURE macro.
------------------------------------------------------------------------
r11992 | divverent | 2013-08-03 05:48:18 -0700 (Sat, 03 Aug 2013) | 5 lines
Changed paths:
   M /trunk/darkplaces/.gitignore
   M /trunk/darkplaces/BSDmakefile
   M /trunk/darkplaces/cl_demo.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/makefile.inc
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/prvm_exec.c
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_mix.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c

Revert "Revert "Build in subdirs"", as the issues seem to be ironed out now.
Revert "Revert "Make cdda optional, server does not need to play music" because it", as its requirements are there now.
Do not include menu QC support in server builds.

Author: Nikoli
------------------------------------------------------------------------
r11991 | divverent | 2013-07-29 03:50:09 -0700 (Mon, 29 Jul 2013) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/clvm_cmds.c

audit all uses of CL_ParticleEffect and CL_ParticleTrail and state box/trail intention

Should fix Nexuiz.
------------------------------------------------------------------------
r11990 | divverent | 2013-07-29 03:50:06 -0700 (Mon, 29 Jul 2013) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

Treat attempts to draw trails with pointparticles as zero length trails.

This means they will get dlight, and count/countabsolute do get applied.
------------------------------------------------------------------------
r11989 | divverent | 2013-07-28 06:58:09 -0700 (Sun, 28 Jul 2013) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

cl_particles_forcetraileffects: emulate old trail behaviour (Xonotic 0.7 compatibility).

When this is set, trail effects are always drawn, even if a box is requested.
------------------------------------------------------------------------
r11988 | havoc | 2013-07-27 17:11:33 -0700 (Sat, 27 Jul 2013) | 4 lines
Changed paths:
   M /trunk/darkplaces/common.c

added FORCEGAME define for building an engine that runs a specific game
regardless of executable name (this basically overrides the executable
name check)

------------------------------------------------------------------------
r11987 | havoc | 2013-07-27 17:10:50 -0700 (Sat, 27 Jul 2013) | 2 lines
Changed paths:
   M /trunk/darkplaces/world.c

fix an unused variable warning caused by USEODE

------------------------------------------------------------------------
r11986 | divverent | 2013-07-27 03:36:19 -0700 (Sat, 27 Jul 2013) | 8 lines
Changed paths:
   M /trunk/darkplaces/BSDmakefile
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/makefile.inc
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c

Revert "Make cdda optional, server does not need to play music" because it
depends on having separate build directories. No hard feelings, Nikoli, when
separate build directories work again, feel free to revert this revert.

This reverts commit 97b79884ee55276e90c4dd60f9bfde8b9dbbff68.

Conflicts:
	makefile.inc
------------------------------------------------------------------------
r11985 | divverent | 2013-07-27 03:24:22 -0700 (Sat, 27 Jul 2013) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/prvm_offsets.h

Separate box and trail particles. Makes Xonotic's Nex beam possible again.
------------------------------------------------------------------------
r11984 | divverent | 2013-07-27 03:06:26 -0700 (Sat, 27 Jul 2013) | 9 lines
Changed paths:
   M /trunk/darkplaces/.gitignore
   M /trunk/darkplaces/BSDmakefile
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/makefile.inc

Revert "Build in subdirs"

This reverts commit f41e93d3e84e082d4728e3d6a9aadb3ca686a9b9.

Conflicts:
	BSDmakefile
	makefile.inc

From: Matthias Krüger <matthias.krueger@famsik.de>
------------------------------------------------------------------------
r11983 | havoc | 2013-07-27 02:29:35 -0700 (Sat, 27 Jul 2013) | 3 lines
Changed paths:
   M /trunk/darkplaces/makefile

use DP_LINK_ZLIB=dlopen on mingw build to reduce compile-time
dependencies

------------------------------------------------------------------------
r11982 | havoc | 2013-07-26 12:01:50 -0700 (Fri, 26 Jul 2013) | 3 lines
Changed paths:
   M /trunk/darkplaces/BSDmakefile
   M /trunk/darkplaces/DPiOS.xcodeproj/project.pbxproj
   M /trunk/darkplaces/darkplaces-dedicated-vs2010.vcxproj
   M /trunk/darkplaces/darkplaces-dedicated-vs2012.vcxproj
   M /trunk/darkplaces/darkplaces-dedicated.vcproj
   M /trunk/darkplaces/darkplaces-sdl-vs2010.vcxproj
   M /trunk/darkplaces/darkplaces-sdl-vs2012.vcxproj
   M /trunk/darkplaces/darkplaces-sdl.dsp
   M /trunk/darkplaces/darkplaces-sdl.vcproj
   M /trunk/darkplaces/darkplaces-wgl-vs2010.vcxproj
   M /trunk/darkplaces/darkplaces-wgl-vs2012.vcxproj
   M /trunk/darkplaces/darkplaces-wgl.vcproj
   M /trunk/darkplaces/darkplaces.dsp
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/makefile.inc
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_mem.c
   D /trunk/darkplaces/snd_modplug.c
   D /trunk/darkplaces/snd_modplug.h

removed modplug support, the library is too insecure and barely used by
anyone

------------------------------------------------------------------------
r11981 | nikoli | 2013-07-26 01:19:12 -0700 (Fri, 26 Jul 2013) | 3 lines
Changed paths:
   M /trunk/darkplaces/BSDmakefile
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/makefile.inc
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c

Make cdda optional, server does not need to play music


------------------------------------------------------------------------
r11980 | nikoli | 2013-07-25 21:27:29 -0700 (Thu, 25 Jul 2013) | 5 lines
Changed paths:
   M /trunk/darkplaces/.gitignore
   M /trunk/darkplaces/BSDmakefile
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/makefile.inc

Build in subdirs
    
Now this command works fine:
make cl-debug sdl-release sv-release-profile -j9

------------------------------------------------------------------------
r11979 | nikoli | 2013-07-24 09:27:58 -0700 (Wed, 24 Jul 2013) | 8 lines
Changed paths:
   M /trunk/darkplaces/BSDmakefile
   M /trunk/darkplaces/crypto.c
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/makefile.inc
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/snd_modplug.c
   M /trunk/darkplaces/world.c
   M /trunk/darkplaces/world.h

Update build system, fix and enable ODE by default

Fixed crash when running in Hardened Gentoo with libode installed.
Fixed building and running with USEODE disabled.
Use same LINK_TO_NAME, LIB_NAME, CFLAGS_NAME style for dependencies.
Link to libz and libode by default.


------------------------------------------------------------------------
r11978 | nikoli | 2013-07-24 09:13:57 -0700 (Wed, 24 Jul 2013) | 1 line
Changed paths:
   M /trunk/darkplaces/builddate.c

Add ability to reproduce build
------------------------------------------------------------------------
r11977 | divverent | 2013-07-24 04:44:30 -0700 (Wed, 24 Jul 2013) | 1 line
Changed paths:
   M /trunk/darkplaces/sys_shared.c

make clock_gettime default (since 2.6.28 it is NTP-adjusted)
------------------------------------------------------------------------
r11976 | divverent | 2013-07-22 07:47:00 -0700 (Mon, 22 Jul 2013) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_screen.c

fix alpha screenshots
------------------------------------------------------------------------
r11975 | divverent | 2013-07-22 07:39:25 -0700 (Mon, 22 Jul 2013) | 1 line
Changed paths:
   M /trunk/darkplaces/makefile.inc

fix typo leading to DP_PHYSICS_ODE not being detectable
------------------------------------------------------------------------
r11974 | vortex | 2013-07-21 15:04:34 -0700 (Sun, 21 Jul 2013) | 1 line
Changed paths:
   M /trunk/darkplaces/sys.h
   M /trunk/darkplaces/vid_sdl.c

Fix C++ typecast/linkage specification errors.
------------------------------------------------------------------------
r11973 | havoc | 2013-07-16 22:44:37 -0700 (Tue, 16 Jul 2013) | 6 lines
Changed paths:
   M /trunk/darkplaces/DPiOS.xcodeproj/project.pbxproj
   A /trunk/darkplaces/DPiOS.xcodeproj/project.xcworkspace
   A /trunk/darkplaces/DPiOS.xcodeproj/project.xcworkspace/contents.xcworkspacedata
   A /trunk/darkplaces/DPiOS.xcodeproj/project.xcworkspace/xcuserdata
   M /trunk/darkplaces/Info.plist
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/image_png.c
   M /trunk/darkplaces/jpeg.c
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_textures.h
   M /trunk/darkplaces/screen.h
   M /trunk/darkplaces/snd_modplug.c
   M /trunk/darkplaces/sys_sdl.c
   M /trunk/darkplaces/sys_shared.c
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_shared.c

Steel Storm additions for mobile (EluanCM)
engine support for Android (EluanCM's port, some cleanup by Forest Hale)
engine support for iPhoneOS (Forest Hale)

credit: EluanCM, myself (Forest Hale)

------------------------------------------------------------------------
r11972 | havoc | 2013-07-16 21:07:25 -0700 (Tue, 16 Jul 2013) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_sdl.c

moved #include <SDL.h> above #include "quakedef.h"

------------------------------------------------------------------------
r11971 | havoc | 2013-07-16 21:05:48 -0700 (Tue, 16 Jul 2013) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c

fix an unused variable warning with USE_GLES2

------------------------------------------------------------------------
r11970 | havoc | 2013-07-16 21:03:07 -0700 (Tue, 16 Jul 2013) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/keys.c

added #ifndef DP_MOBILETOUCH on the command history and ip logging

credit: EluanCM

------------------------------------------------------------------------
r11969 | havoc | 2013-07-16 21:00:01 -0700 (Tue, 16 Jul 2013) | 2 lines
Changed paths:
   M /trunk/darkplaces/thread_sdl.c

we need to #include <SDL.h> before #include "quakedef.h"

------------------------------------------------------------------------
r11968 | havoc | 2013-07-16 20:59:09 -0700 (Tue, 16 Jul 2013) | 4 lines
Changed paths:
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/cmd.h

Cmd_ExecuteString now calls Cbuf_LockThreadMutex

credit: EluanCM

------------------------------------------------------------------------
r11967 | havoc | 2013-07-16 20:54:31 -0700 (Tue, 16 Jul 2013) | 5 lines
Changed paths:
   M /trunk/darkplaces/ft2.c

new #define DP_FREETYPE_STATIC for compiling with freetype linked
directly rather than runtime loaded

credit: EluanCM

------------------------------------------------------------------------
r11966 | divverent | 2013-07-13 03:15:35 -0700 (Sat, 13 Jul 2013) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/cvar.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/netconn.h
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c

New rate burst handling; cvars: cl_rate_burstsize, net_usesizelimit, net_burstreserve

This supports some kind of packet size bursting to give better experience at
small rates. Can be controlled by the client.
------------------------------------------------------------------------
r11965 | divverent | 2013-07-08 02:39:13 -0700 (Mon, 08 Jul 2013) | 3 lines
Changed paths:
   M /trunk/darkplaces/libcurl.c
   M /trunk/darkplaces/libcurl.h

implement curl --cachepic and curl --skinframe (experimental)

which can load textures from the web
------------------------------------------------------------------------
r11964 | havoc | 2013-07-06 23:42:11 -0700 (Sat, 06 Jul 2013) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/render.h

fix a serious issue with CSQC frametime being non-zero on both calls
when using stereo rendering, it is now zero on the second eye so that
frametime does not lie

------------------------------------------------------------------------
r11963 | divverent | 2013-06-29 04:21:01 -0700 (Sat, 29 Jun 2013) | 1 line
Changed paths:
   M /trunk/darkplaces/crypto.c

oops... fix nul termination. luckily not exploitable.
------------------------------------------------------------------------
r11962 | havoc | 2013-06-26 23:55:10 -0700 (Wed, 26 Jun 2013) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

reenabled index buffers on GLES2 path

------------------------------------------------------------------------
r11961 | havoc | 2013-06-26 23:20:52 -0700 (Wed, 26 Jun 2013) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

fix severe (crashing) bugs with two calls to qglDrawElements when using
index buffers (this bug was hidden by gl_mesh_drawrangeelements being 1
by default)

------------------------------------------------------------------------
r11960 | havoc | 2013-06-26 22:57:31 -0700 (Wed, 26 Jun 2013) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

remove cvar gl_mesh_prefer_short_elements because many draw calls do not
even provide an element3i to use

------------------------------------------------------------------------
r11959 | havoc | 2013-06-26 22:53:59 -0700 (Wed, 26 Jun 2013) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_rmain.c

allow use of cvar gl_vbo_dynamicindex in RENDERPATH_GLES2 

------------------------------------------------------------------------
r11958 | havoc | 2013-06-18 19:47:18 -0700 (Tue, 18 Jun 2013) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/render.h

further optimizations for gl_vbo_dynamicvertex and gl_vbo_dynamicindex

------------------------------------------------------------------------
r11957 | havoc | 2013-06-18 18:42:17 -0700 (Tue, 18 Jun 2013) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h

gl_vbo_dynamicvertex and gl_vbo_dynamicindex now use R_BufferData_Store
rather than the much slower path they used before

------------------------------------------------------------------------
r11956 | havoc | 2013-06-18 18:27:59 -0700 (Tue, 18 Jun 2013) | 13 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_rmain.c

some cleanup of glDelete calls to guard against bugs caused by GL
changing the binding when we delete a currently active object

fix a major resource leak by calling R_FrameData_NewFrame and
R_BufferData_NewFrame earlier so that they work when disconnected

improved gl_vbostats output

clarify some logic related to r_batch_dynamicbuffer

don't bother destroying a temporary vertex buffer that we end up
destroying as part of the array cleanup

------------------------------------------------------------------------
r11955 | havoc | 2013-06-18 16:01:15 -0700 (Tue, 18 Jun 2013) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix a critical bug with r_restart or vid_restart in R_BufferData_Reset
where it did not properly reset all buffers

------------------------------------------------------------------------
r11954 | havoc | 2013-06-18 14:08:14 -0700 (Tue, 18 Jun 2013) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/render.h

renamed r_bufferdatasize_ cvars to r_buffermegs_ to give them new good
values, as the old cvar increase logic was badly bugged and would
arbitrarily increase them when not necessary

------------------------------------------------------------------------
r11953 | havoc | 2013-06-18 13:51:30 -0700 (Tue, 18 Jun 2013) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/render.h

removed allowfail flag on R_BufferData_Store and made cvar management
more consistent, increased the buffer cycle to 3 frames

------------------------------------------------------------------------
r11952 | divverent | 2013-05-29 09:53:08 -0700 (Wed, 29 May 2013) | 1 line
Changed paths:
   M /trunk/darkplaces/image_png.c

image_png: libpng16 support (by graphitemaster)
------------------------------------------------------------------------
r11951 | divverent | 2013-05-25 07:08:53 -0700 (Sat, 25 May 2013) | 3 lines
Changed paths:
   M /trunk/darkplaces/lhnet.c
   M /trunk/darkplaces/lhnet.h
   M /trunk/darkplaces/netconn.c

Implement DSCP for ToS according to RFC2474 / RFC4594

From: Merlijn Hofstra <merlijn@Merlijns-MacBook-Air.local>
------------------------------------------------------------------------
r11950 | havoc | 2013-05-21 23:45:43 -0700 (Tue, 21 May 2013) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

clarify the code when gl_mesh_prefer_short_elements is off

------------------------------------------------------------------------
r11949 | divverent | 2013-05-08 03:41:01 -0700 (Wed, 08 May 2013) | 1 line
Changed paths:
   M /trunk/darkplaces/shader_glsl.h
   M /trunk/darkplaces/shader_hlsl.h

order postprocess code properly (so blur does not cancel bloom)
------------------------------------------------------------------------
r11948 | divverent | 2013-05-06 02:54:55 -0700 (Mon, 06 May 2013) | 1 line
Changed paths:
   M /trunk/darkplaces/thread_pthread.c

fix a floating around mutexattr object
------------------------------------------------------------------------
r11947 | divverent | 2013-05-06 02:50:57 -0700 (Mon, 06 May 2013) | 1 line
Changed paths:
   M /trunk/darkplaces/thread_pthread.c

fix a possible pthread crash
------------------------------------------------------------------------
r11946 | havoc | 2013-05-04 21:04:34 -0700 (Sat, 04 May 2013) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

VM_CL_findradius now uses World_EntitiesInBox as it should

------------------------------------------------------------------------
r11945 | divverent | 2013-04-19 02:40:43 -0700 (Fri, 19 Apr 2013) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_particles.c

fix endless loop with gcc 4.8
------------------------------------------------------------------------
r11944 | eihrul | 2013-04-18 10:30:25 -0700 (Thu, 18 Apr 2013) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

OPENGL_ORIENTATION -> MATRIX4x4_OPENGLORIENTATION

------------------------------------------------------------------------
r11943 | havoc | 2013-04-17 00:13:52 -0700 (Wed, 17 Apr 2013) | 1 line
Changed paths:
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/vid_shared.c

set vid_stereobuffer cvar based on whether GL_STEREO is true after setting the mode
------------------------------------------------------------------------
r11942 | havoc | 2013-04-16 19:46:57 -0700 (Tue, 16 Apr 2013) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/snd_main.c

fix a severe texture corruption and crash case when using vid_dx9 1 is used with vid_sRGB 1
work around a crash when using vid_dx9 1 with vid_stereobuffer 1 (this needs a better fix, D3D9 does not support this)
fix a warning in C++ where a bit flag mask was being passed as a bool

------------------------------------------------------------------------
r11941 | havoc | 2013-04-16 19:33:45 -0700 (Tue, 16 Apr 2013) | 2 lines
Changed paths:
   M /trunk/darkplaces/qtypes.h

add prvm_uint_t type

------------------------------------------------------------------------
r11940 | havoc | 2013-04-16 15:51:33 -0700 (Tue, 16 Apr 2013) | 3 lines
Changed paths:
   M /trunk/darkplaces/prvm_exec.c
   M /trunk/darkplaces/prvm_execprogram.h

optimized vm by using cached local variables instead of accessing prog->
fields all the time

------------------------------------------------------------------------
r11939 | havoc | 2013-04-16 15:17:09 -0700 (Tue, 16 Apr 2013) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_execprogram.h

added prvm_uint_t for bounds check tests in the vm

------------------------------------------------------------------------
r11938 | havoc | 2013-04-16 14:57:17 -0700 (Tue, 16 Apr 2013) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_execprogram.h

use unsigned comparisons for most of the boundschecks in the vm

------------------------------------------------------------------------
r11937 | divverent | 2013-04-16 01:51:32 -0700 (Tue, 16 Apr 2013) | 1 line
Changed paths:
   M /trunk/darkplaces/netconn.c

ipv6 dpmaster.sudo.rm-f.org has moved
------------------------------------------------------------------------
r11936 | havoc | 2013-04-15 20:24:09 -0700 (Mon, 15 Apr 2013) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

clarify a comment

------------------------------------------------------------------------
r11935 | havoc | 2013-04-15 20:22:39 -0700 (Mon, 15 Apr 2013) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

when using engine particles (not effectinfo), prevent spawning particles
for EFFECT_EF_FLAME and EFFECT_EF_STARDUST when paused

------------------------------------------------------------------------
r11934 | havoc | 2013-04-15 20:16:17 -0700 (Mon, 15 Apr 2013) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix two very ambiguous for loops that calculate camerawidth and
cameraheight

------------------------------------------------------------------------
r11933 | havoc | 2013-04-15 20:09:01 -0700 (Mon, 15 Apr 2013) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid.h

use int not qboolean for glshaderversion

------------------------------------------------------------------------
r11932 | eihrul | 2013-04-01 08:58:00 -0700 (Mon, 01 Apr 2013) | 2 lines
Changed paths:
   M /trunk/darkplaces/shader_glsl.h

move extension enables to the top of the shader to comply with spec

------------------------------------------------------------------------
r11931 | eihrul | 2013-04-01 08:54:53 -0700 (Mon, 01 Apr 2013) | 2 lines
Changed paths:
   M /trunk/darkplaces/shader_glsl.h

enable UBO extension for skeletal

------------------------------------------------------------------------
r11930 | vortex | 2013-03-28 13:24:13 -0700 (Thu, 28 Mar 2013) | 1 line
Changed paths:
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/zone.c
   M /trunk/darkplaces/zone.h

Rewritten SVQC stringbuffer saving routines (which is part of yet unfinished databuffers extension). Changes are backwards compatible with old savefile format. Now, once saved stringbuffers are found in extended savegame section, all string buffers allocated by worldspawn()/entityspawn (which is processed prior to savegame parsing) are deleted, and stringbuffers are restored from savegamefile with their original handles.
------------------------------------------------------------------------
r11929 | eihrul | 2013-03-26 15:19:01 -0700 (Tue, 26 Mar 2013) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

disable depthfirst rendering on animated models since it doesn't work and should theoretically have little performance benefit (and most likely performance detriment)

------------------------------------------------------------------------
r11928 | eihrul | 2013-03-26 14:01:54 -0700 (Tue, 26 Mar 2013) | 2 lines
Changed paths:
   M /trunk/darkplaces/mod_skeletal_animatevertices_generic.c

fix boneposerelative address

------------------------------------------------------------------------
r11927 | eihrul | 2013-03-26 12:34:00 -0700 (Tue, 26 Mar 2013) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/mod_skeletal_animatevertices_generic.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_alias.h

factor out skeletal animation transform generation so that it can be reused

------------------------------------------------------------------------
r11926 | havoc | 2013-03-24 11:20:15 -0700 (Sun, 24 Mar 2013) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/collision.h
   M /trunk/darkplaces/sv_phys.c

reworked the MOVETYPE_WALK and MOVETYPE_STEP sticking logic so that it
only cares about world when deciding to be stuck, this means if you get
into a bmodel entity you can still move out of it

------------------------------------------------------------------------
r11925 | havoc | 2013-03-04 17:05:14 -0800 (Mon, 04 Mar 2013) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

don't call glGetUniformBlockIndex without GL_ARB_uniform_buffer_object
as the pointer is NULL (this crashed OpenGL 2.0-3.0 drivers)

------------------------------------------------------------------------
r11924 | havoc | 2013-03-02 17:59:37 -0800 (Sat, 02 Mar 2013) | 3 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/svvm_cmds.c

restrict which CHANNELFLAG_ values can be used in sound7 builtin, to
keep qc from using internal-only ones

------------------------------------------------------------------------
r11923 | havoc | 2013-03-01 20:57:07 -0800 (Fri, 01 Mar 2013) | 4 lines
Changed paths:
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/svvm_cmds.c

changed MOVETYPE_STEP and MOVETYPE_WALK to match Quake behavior (unable
to move when allsolid - but also check SUPERCONTENTS_SOLID), this makes
hip2m3 shalrath work again

------------------------------------------------------------------------
r11922 | havoc | 2013-03-01 16:42:01 -0800 (Fri, 01 Mar 2013) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix C++ compile error

------------------------------------------------------------------------
r11920 | havoc | 2013-02-28 03:41:40 -0800 (Thu, 28 Feb 2013) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/render.h

implemented r_batch_dynamicbuffer which allows the rsurface batching
code to produce dynamic vertex/index buffers using R_BufferData_Store

------------------------------------------------------------------------
r11919 | divverent | 2013-02-28 03:39:47 -0800 (Thu, 28 Feb 2013) | 1 line
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/sound.h
   M /trunk/darkplaces/svvm_cmds.c

sound7(): properly support channel flags on client; reassign sound flags so FORCELOOP is now 2 (and FULLVOLUME is 16); note that these flags only work on csqc for now
------------------------------------------------------------------------
r11918 | havoc | 2013-02-28 01:46:44 -0800 (Thu, 28 Feb 2013) | 3 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

restore flags feature in csqc sound7 builtin, so that mods can use
CHANNELFLAG_FORCELOOP and others as before

------------------------------------------------------------------------
r11917 | havoc | 2013-02-28 01:44:12 -0800 (Thu, 28 Feb 2013) | 5 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/prvm_offsets.h

csqc sound7 call now looks at the global variable sound_starttime to
calculate a startposition from, this allows a sound to be played at a
later time (delayed) or an earlier time (for instance restoring a
dialogue sound in-progress when loading a savegame)

------------------------------------------------------------------------
r11916 | havoc | 2013-02-28 01:36:29 -0800 (Thu, 28 Feb 2013) | 5 lines
Changed paths:
   M /trunk/darkplaces/cmd.c

changed the default sv_gameplayfix_ cvar values based on GAME_,
GAME_NORMAL (quake) and derivatives now default them to 0 for better
compatibility and avoiding gameplay changes, non-quake games such as
GAME_NEXUIZ and others are unaffected (still default to 1 there)

------------------------------------------------------------------------
r11915 | havoc | 2013-02-28 01:30:03 -0800 (Thu, 28 Feb 2013) | 7 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/shader_glsl.h
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_shared.c

implemented use of GL_ARB_uniform_buffer_object for r_glsl_skeletal
added R_BufferData_ system which allows arbitrary vertex/index/uniform
buffers to be dynamically built during a frame (in the same way as the
R_FrameData_ system), this has vastly better performance than uploading
them individually and code should be migrated to use it as appropriate
vid.support.glshaderversion added (typically 140)

------------------------------------------------------------------------
r11914 | havoc | 2013-02-27 16:21:59 -0800 (Wed, 27 Feb 2013) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

implemented loading of the RMQe variant of BSP2 ("2PSB")

------------------------------------------------------------------------
r11913 | havoc | 2013-02-27 16:21:22 -0800 (Wed, 27 Feb 2013) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

fix typo in cvar description (grude -> crude)

------------------------------------------------------------------------
r11912 | havoc | 2013-02-27 16:21:01 -0800 (Wed, 27 Feb 2013) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h

implemented loading of the RMQe variant of BSP2 ("2PSB")

------------------------------------------------------------------------
r11911 | divverent | 2013-02-27 05:30:07 -0800 (Wed, 27 Feb 2013) | 1 line
Changed paths:
   M /trunk/darkplaces/crypto.c

fix another warning in crypto.c
------------------------------------------------------------------------
r11910 | divverent | 2013-02-27 05:30:04 -0800 (Wed, 27 Feb 2013) | 1 line
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

remove unused variable
------------------------------------------------------------------------
r11909 | divverent | 2013-02-27 03:38:50 -0800 (Wed, 27 Feb 2013) | 1 line
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/sound.h
   M /trunk/darkplaces/svvm_cmds.c

rename CHANFLAG_RELIABLE to SOUNDFLAG_RELIABLE to match dpdefs; remove accidental flags passing in CL_sound()
------------------------------------------------------------------------
r11908 | divverent | 2013-02-25 04:28:46 -0800 (Mon, 25 Feb 2013) | 3 lines
Changed paths:
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/menu.h

Add a cvar to change menu progs filename

From: Mario <mario.mario@y7mail.com>
------------------------------------------------------------------------
r11907 | havoc | 2013-02-24 20:40:39 -0800 (Sun, 24 Feb 2013) | 3 lines
Changed paths:
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c

removed cvar sv_gameplayfix_stepwhilejumping which wasn't needed
(sv_jumpstep is no longer dependent on this cvar)

------------------------------------------------------------------------
r11906 | divverent | 2013-02-24 08:59:37 -0800 (Sun, 24 Feb 2013) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/console.c

Nevermind, we can't remove that STX char... just add \{3} for our purposes

From: Samual Lenks <samual@xonotic.org>
------------------------------------------------------------------------
r11905 | divverent | 2013-02-24 08:59:33 -0800 (Sun, 24 Feb 2013) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/console.c

Fix bug with cl_parse.c putting extra \2 in the Con_Printf() line

From: Samual Lenks <samual@xonotic.org>
------------------------------------------------------------------------
r11904 | divverent | 2013-02-24 08:59:30 -0800 (Sun, 24 Feb 2013) | 3 lines
Changed paths:
   M /trunk/darkplaces/console.c

Lets add the ability to have silent messages sent to the chatbox, this is so that it can later replace the console output in Xonotic

From: Samual <samual@xonotic.org>
------------------------------------------------------------------------
r11903 | havoc | 2013-02-23 13:55:11 -0800 (Sat, 23 Feb 2013) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

fix C++ compile error

------------------------------------------------------------------------
r11902 | havoc | 2013-02-23 04:23:39 -0800 (Sat, 23 Feb 2013) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix bug where particle textures scroll in GL11/GL13 paths

------------------------------------------------------------------------
r11901 | havoc | 2013-02-23 03:08:31 -0800 (Sat, 23 Feb 2013) | 9 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/r_shadow.c

added entity caching stats in graph
optimized logic for animcache and dynamic batching
optimized r_shadows code which was often casting shadows from entities
it did not animcache, and these entities didn't need to cast anyway,
imposed an artificial limit of 1024 entities in r_shadows code...
now exactly determines if models are animated at load (except iqm which
is trusted), and the isanimated flag is not needed for animating a
skeletal model with skeletonobject

------------------------------------------------------------------------
r11900 | havoc | 2013-02-22 23:38:19 -0800 (Fri, 22 Feb 2013) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

removed frames last second report in r_speeds graph

------------------------------------------------------------------------
r11899 | havoc | 2013-02-22 23:37:10 -0800 (Fri, 22 Feb 2013) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/collision.c
   M /trunk/darkplaces/draw.h
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/r_shadow.c

changed r_refdef.stats struct to be an array indexed by r_stat_* enums
added r_speeds_graph and associated cvars, this will visually graph any
chosen renderer statistics (8 allowed at one time)
added a lot of additional statistics for the batcher

------------------------------------------------------------------------
r11898 | havoc | 2013-02-22 23:34:07 -0800 (Fri, 22 Feb 2013) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

added velocity-oriented blood decals, cvar is cl_decals_newsystem_bloodsmears

------------------------------------------------------------------------
r11897 | havoc | 2013-02-16 21:05:28 -0800 (Sat, 16 Feb 2013) | 7 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

changed Q1BSP traceline to only use the surface-hitting variant if
sv_gameplayfix_q1bsptracelinereportstexture is on, because in one of
negke's maps a set of items are crushed by a pusher and are expected to
fall through the sky brush they are sitting on, which does not happen if
the sky surface is considered solid, but in any other situation this
should be reported as solid

------------------------------------------------------------------------
r11896 | havoc | 2013-02-15 12:51:04 -0800 (Fri, 15 Feb 2013) | 1 line
Changed paths:
   A /trunk/darkplaces/darkplaces-dedicated-vs2010.vcxproj
   A /trunk/darkplaces/darkplaces-sdl-vs2010.vcxproj
   A /trunk/darkplaces/darkplaces-wgl-vs2010.vcxproj

added missing VS2010 projects
------------------------------------------------------------------------
r11895 | havoc | 2013-02-07 06:22:17 -0800 (Thu, 07 Feb 2013) | 1 line
Changed paths:
   D /trunk/darkplaces/darkplaces-2010.sln
   M /trunk/darkplaces/darkplaces-dedicated-vs2012.vcxproj
   D /trunk/darkplaces/darkplaces-dedicated.vcxproj
   M /trunk/darkplaces/darkplaces-sdl-vs2012.vcxproj
   D /trunk/darkplaces/darkplaces-sdl.vcxproj
   A /trunk/darkplaces/darkplaces-vs2010.sln
   M /trunk/darkplaces/darkplaces-vs2012.sln
   M /trunk/darkplaces/darkplaces-wgl-vs2012.vcxproj
   D /trunk/darkplaces/darkplaces-wgl.vcxproj
   A /trunk/darkplaces/vs2010_win32.props
   A /trunk/darkplaces/vs2010_win64.props
   A /trunk/darkplaces/vs2012_win32.props
   A /trunk/darkplaces/vs2012_win64.props

added props files for vs2010 and vs2012, changed name of darkplaces-2010.sln to darkplaces-vs2010.sln and renamed the vcproj files similarly to darkplaces-sdl-vs2010.vcxproj and such.
------------------------------------------------------------------------
r11894 | havoc | 2013-02-07 05:36:55 -0800 (Thu, 07 Feb 2013) | 1 line
Changed paths:
   A /trunk/darkplaces/darkplaces-dedicated-vs2012.vcxproj
   A /trunk/darkplaces/darkplaces-sdl-vs2012.vcxproj
   A /trunk/darkplaces/darkplaces-vs2012.sln
   A /trunk/darkplaces/darkplaces-wgl-vs2012.vcxproj

added MSVC 2012 projects
------------------------------------------------------------------------
r11893 | havoc | 2013-02-07 05:00:33 -0800 (Thu, 07 Feb 2013) | 1 line
Changed paths:
   A /trunk/darkplaces/darkplaces-2010.sln
   A /trunk/darkplaces/darkplaces-dedicated.vcxproj
   A /trunk/darkplaces/darkplaces-sdl.vcxproj
   A /trunk/darkplaces/darkplaces-wgl.vcxproj

added MSVC++ 2010 projects
------------------------------------------------------------------------
r11892 | havoc | 2013-02-07 04:59:53 -0800 (Thu, 07 Feb 2013) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/gl_rmain.c

fix a sizeof using an array index variable that is never initialized (harmless but the variable is unused by actual code and thus causes a warning)
declare macros for ID3DXBuffer_ functions because they were removed in a DX SDK update
------------------------------------------------------------------------
r11891 | havoc | 2013-02-07 04:06:40 -0800 (Thu, 07 Feb 2013) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix another C++ compile error

------------------------------------------------------------------------
r11890 | havoc | 2013-02-07 03:42:21 -0800 (Thu, 07 Feb 2013) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix a Mem_Alloc call that needs a type cast in C++

------------------------------------------------------------------------
r11889 | havoc | 2013-02-07 03:40:40 -0800 (Thu, 07 Feb 2013) | 10 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c
   M /trunk/darkplaces/dpsoftrast.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/shader_glsl.h
   M /trunk/darkplaces/shader_hlsl.h

changed format of builtin shader strings to use comma separated lines,
this should fix compilation on MSVC where default.glsl exceeded 65535
character limit
removed MODE_SHOWDEPTH from shaders and code because it is not used and
is not likely to ever be used anyway
reworked shadermodeinfo_t to only have one filename rather than separate
filenames for vertex and fragment shader
reworked r_glsl_dumpshader to cope with multiple shader filenames and
unified some code for glsl and hlsl text processing

------------------------------------------------------------------------
r11888 | eihrul | 2013-02-07 03:16:38 -0800 (Thu, 07 Feb 2013) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

remove unused macro

------------------------------------------------------------------------
r11887 | divverent | 2013-01-25 11:59:31 -0800 (Fri, 25 Jan 2013) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

r_showsurfaces + r_glsl_skeletal doesn't work currently, so blacklist the combination for now
------------------------------------------------------------------------
r11886 | divverent | 2013-01-23 04:52:13 -0800 (Wed, 23 Jan 2013) | 5 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/svvm_cmds.c

skel_build: fix wrong 4th matrix row of skeleton matrices

Matrix4x4_Scale doesn't affect the 4th row, but Matrix4x4_Accumulate
does, leading to wrong result. This broke weapon to player attachment
when the player has a skeletonobject.
------------------------------------------------------------------------
r11884 | divverent | 2013-01-22 03:28:19 -0800 (Tue, 22 Jan 2013) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/render.h

fix r_depthfirst 2 with r_glsl_skeletal 1
------------------------------------------------------------------------
r11883 | divverent | 2013-01-20 13:11:58 -0800 (Sun, 20 Jan 2013) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/shader_glsl.h

Fix typos in GPU skeletal; explain the crossproduct hack
------------------------------------------------------------------------
r11882 | havoc | 2013-01-16 08:54:25 -0800 (Wed, 16 Jan 2013) | 6 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/render.h

implemented a fallback case for r_glsl_skeletal 1 when dynamicvertex
occurs (the batch code will apply the skeletal deforms to the batch, to
ensure proper functionality with deformvertexes and such)
added r_batch_debugdynamicvertexpath cvar which is useful for debugging
skeletal fallback issues

------------------------------------------------------------------------
r11881 | havoc | 2013-01-16 06:23:31 -0800 (Wed, 16 Jan 2013) | 3 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/dpsoftrast.h
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/shader_glsl.h

implemented gpu-skinning (vertex shader skeletal animation), can be
disabled by turning off the r_glsl_skeletal cvar

------------------------------------------------------------------------
r11880 | divverent | 2013-01-13 12:12:03 -0800 (Sun, 13 Jan 2013) | 3 lines
Changed paths:
   M /trunk/darkplaces/prvm_exec.c
   M /trunk/darkplaces/prvm_execprogram.h

make MUL_VF and MUL_FV friendlier for compilers, and fix segfaul in LOAD_V

From: Wolfgang Bumiller <blub@speed.at>
------------------------------------------------------------------------
r11879 | havoc | 2013-01-11 17:50:07 -0800 (Fri, 11 Jan 2013) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

cast to etype_t to avoid g++ compiler errors

------------------------------------------------------------------------
r11878 | divverent | 2013-01-10 02:24:33 -0800 (Thu, 10 Jan 2013) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_execprogram.h

fix a typo in the watchpoints code that warns
------------------------------------------------------------------------
r11877 | havoc | 2013-01-09 21:36:54 -0800 (Wed, 09 Jan 2013) | 6 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

fix effectinfo.txt trail effects which were honoring the (time-based)
count parameter, trailspacing now completely overrides the count
parameter as was assumed by the previous change (11539) that passed time
as count, this only affected network entities (.traileffectnum or
.effects or .modelflags) but was clearly broken

------------------------------------------------------------------------
r11876 | havoc | 2013-01-09 18:58:16 -0800 (Wed, 09 Jan 2013) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_demo.c
   M /trunk/darkplaces/cl_screen.c

patch from roboman2444 :
new cvar cl_capturevideo_demo_stop which makes video capture automatically
end when demo playback ends

------------------------------------------------------------------------
r11875 | divverent | 2013-01-09 04:19:15 -0800 (Wed, 09 Jan 2013) | 1 line
Changed paths:
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/prvm_execprogram.h

Make watchpoints data type aware; now vector watchpoints work too.
------------------------------------------------------------------------
r11874 | divverent | 2013-01-08 04:37:43 -0800 (Tue, 08 Jan 2013) | 12 lines
Changed paths:
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/prvm_exec.c
   M /trunk/darkplaces/prvm_execprogram.h

Breakpoints and watchpoints

"Break" on statement: prvm_breakpoint server 12345
"Break" on function: prvm_breakpoint server ClientConnect
Watch for global change: prvm_globalwatchpoint server time
Watch for entity field change: prvm_edictwatchpoint server 1 health

There can be only one of each kind. To clear, do:

prvm_breakpoint server
prvm_globalwatchpoint server
prvm_edictwatchpoint server
------------------------------------------------------------------------
r11873 | havoc | 2013-01-08 04:29:24 -0800 (Tue, 08 Jan 2013) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/render.h

reworked some code for BATCHNEED_NOGAPS to be more consistent and made
the comments more clear about its behavior (firstvertex is 0, no gaps),
no longer using BATCHNEED_NOGAPS in a couple places

------------------------------------------------------------------------
r11872 | havoc | 2013-01-08 03:19:58 -0800 (Tue, 08 Jan 2013) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c

flag a few more things (depth-only draws, shadowmap draws) as allowing
r_batch_multidraw to work

------------------------------------------------------------------------
r11871 | havoc | 2013-01-08 02:56:58 -0800 (Tue, 08 Jan 2013) | 6 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/render.h

added r_batch_multidraw and r_batch_multidraw_mintriangles cvars, this
code defaults on, restoring the old rendering path that used multiple
glDrawRangeElements calls for surface batching rather than copying index
data, on high poly maps this has a positive impact, on low poly maps I
was unable to find a difference in fps either way

------------------------------------------------------------------------
r11870 | divverent | 2013-01-02 00:27:19 -0800 (Wed, 02 Jan 2013) | 3 lines
Changed paths:
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sv_user.c

server: ignore out of order prespawn/spawn/begin commands

This fixes disconnection issues for clients joining during map change.
------------------------------------------------------------------------
r11869 | divverent | 2012-12-31 11:10:23 -0800 (Mon, 31 Dec 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/vid_glx.c

slightly speed up vid_glx by better XShm handling
------------------------------------------------------------------------
r11868 | eihrul | 2012-12-24 17:26:12 -0800 (Mon, 24 Dec 2012) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c

allow framebuffer objects to be used where non-power of two textures are not required

------------------------------------------------------------------------
r11867 | havoc | 2012-12-22 02:32:38 -0800 (Sat, 22 Dec 2012) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

fixed coronas not being rendered with MATERIALFLAG_NODEPTHTEST

------------------------------------------------------------------------
r11866 | havoc | 2012-12-21 23:49:40 -0800 (Fri, 21 Dec 2012) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/model_sprite.c

fix bug with transparency sorting introduced by vortex in r11822 where
.transparentsort was not initialized in a lot of materials, which meant
TRANSPARENTSORT_SKY was used rather than TRANSPARENTSORT_DISTANCE

------------------------------------------------------------------------
r11865 | havoc | 2012-12-21 22:19:30 -0800 (Fri, 21 Dec 2012) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/sbar.c
   M /trunk/darkplaces/sv_main.c

added GAME_QUOTH to use the hipnotic hud and workarounds with the quoth
folder instead of hipnotic

------------------------------------------------------------------------
r11864 | havoc | 2012-12-21 20:35:03 -0800 (Fri, 21 Dec 2012) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/sbar.c

removed GAME_SOM as this game was never finished or released

------------------------------------------------------------------------
r11863 | havoc | 2012-12-21 20:07:06 -0800 (Fri, 21 Dec 2012) | 3 lines
Changed paths:
   M /trunk/darkplaces/menu.c

don't set r_hdr in the menu presets for lighting quality, the cvar has
been removed

------------------------------------------------------------------------
r11862 | divverent | 2012-12-20 03:37:38 -0800 (Thu, 20 Dec 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_exec.c

use LNO files for backtraces (by Blub)
------------------------------------------------------------------------
r11861 | divverent | 2012-12-20 03:05:54 -0800 (Thu, 20 Dec 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

properly use the D3DX C interface
------------------------------------------------------------------------
r11860 | divverent | 2012-12-20 03:05:48 -0800 (Thu, 20 Dec 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/vid_sdl.c

only include SDL_syswm.h if really necessary
------------------------------------------------------------------------
r11859 | divverent | 2012-12-13 06:44:12 -0800 (Thu, 13 Dec 2012) | 3 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/svvm_cmds.c

skel_build: normalize the per-bone matrices

Looks a lot better if animations are "mismatched" in some evil ways.
------------------------------------------------------------------------
r11858 | eihrul | 2012-12-07 18:31:28 -0800 (Fri, 07 Dec 2012) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/shader_glsl.h

additional high quality shadowmap filter that uses the shadow sampler rather than texture gathers

------------------------------------------------------------------------
r11857 | eihrul | 2012-12-01 05:08:38 -0800 (Sat, 01 Dec 2012) | 2 lines
Changed paths:
   M /trunk/darkplaces/shader_glsl.h

faster shadowmap sampler filter

------------------------------------------------------------------------
r11856 | eihrul | 2012-12-01 05:04:49 -0800 (Sat, 01 Dec 2012) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

silence more warnings

------------------------------------------------------------------------
r11855 | eihrul | 2012-12-01 04:58:17 -0800 (Sat, 01 Dec 2012) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

silence some warnings

------------------------------------------------------------------------
r11854 | eihrul | 2012-09-29 00:20:13 -0700 (Sat, 29 Sep 2012) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

ensure shadowing quality keeps track of r_fb.usedepthtextures

------------------------------------------------------------------------
r11853 | divverent | 2012-09-27 03:25:09 -0700 (Thu, 27 Sep 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/host_cmd.c

fix rcon crash
------------------------------------------------------------------------
r11852 | divverent | 2012-09-26 05:48:42 -0700 (Wed, 26 Sep 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/world.c

use library versions 2 and 3 of ODE too. It seems compatible.
------------------------------------------------------------------------
r11851 | divverent | 2012-09-26 00:35:01 -0700 (Wed, 26 Sep 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/dpdefs/csprogsdefs.qc
   M /trunk/darkplaces/dpdefs/menudefs.qc
   M /trunk/darkplaces/mvm_cmds.c

support DP_QC_ENTITYDATA in menuqc too
------------------------------------------------------------------------
r11850 | vortex | 2012-09-23 02:42:43 -0700 (Sun, 23 Sep 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_screen.c

scr_loadingscreen_background: fix double-applied gamma.
------------------------------------------------------------------------
r11849 | divverent | 2012-09-20 02:26:48 -0700 (Thu, 20 Sep 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_parse.c

add a cast to fix compile error
------------------------------------------------------------------------
r11848 | divverent | 2012-09-19 08:13:14 -0700 (Wed, 19 Sep 2012) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/sv_main.c

buffer csprogs downloads and load csprogs from the buffer instead of a file, if available

This fixes csprogs-from-demo loading if dlcache is not writable
------------------------------------------------------------------------
r11847 | divverent | 2012-09-19 03:22:05 -0700 (Wed, 19 Sep 2012) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

cl_loadingscreen_fps: fix it on Linux

Sys_DirtyTime returns double, float doesn't have enough accuracy to hold
a gettimeofday() result, which caused VERY seldom loading screen updates
------------------------------------------------------------------------
r11846 | divverent | 2012-09-19 03:02:57 -0700 (Wed, 19 Sep 2012) | 3 lines
Changed paths:
   M /trunk/darkplaces/host.c

turn off session locking if running -readonly

because locking obviously fails when readonly
------------------------------------------------------------------------
r11845 | divverent | 2012-09-18 04:57:22 -0700 (Tue, 18 Sep 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/fs.c

command line option -readonly to turn off all writing
------------------------------------------------------------------------
r11844 | vortex | 2012-09-17 06:58:17 -0700 (Mon, 17 Sep 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/render.h

New cvar r_shadows_shadowmapbias to customize bias of fake shadows. Default is -1 - use r_shadow_shadowmapping_bias.
------------------------------------------------------------------------
r11843 | havoc | 2012-09-06 22:28:06 -0700 (Thu, 06 Sep 2012) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_brush.h

upgrade some memory formats to unsigned int from unsigned short for BSP2
maps

------------------------------------------------------------------------
r11842 | divverent | 2012-09-06 11:43:49 -0700 (Thu, 06 Sep 2012) | 3 lines
Changed paths:
   M /trunk/darkplaces/console.c

special character translation: don't generate control characters from non-control characters!

qfont_table entry 10 e.g. causes U+E00A to be turned into a newline. DO NOT WANT.
------------------------------------------------------------------------
r11841 | vortex | 2012-08-31 18:46:04 -0700 (Fri, 31 Aug 2012) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/gl_draw.c

New cvar scr_loadingscreen_picture to customize loading pic.
GAME_BLOODOMNICIDE: allow to load low quality version pics (ones used to get sizes) from locale/.
------------------------------------------------------------------------
r11840 | vortex | 2012-08-09 11:38:54 -0700 (Thu, 09 Aug 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_screen.c

New cvar scr_loadingscreen_maxfps (default 10) which restricts maximum number of loading screen updates per second. This will halve loading times of quake maps with vid_vsync 1 as it really spends more time on drawing loading screen than on actual loading there.
------------------------------------------------------------------------
r11839 | havoc | 2012-08-05 16:24:06 -0700 (Sun, 05 Aug 2012) | 3 lines
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

relax PRVM_EDICT_NUM error checking on saving a savegame so that
honey.bsp can save game

------------------------------------------------------------------------
r11838 | havoc | 2012-07-31 22:30:31 -0700 (Tue, 31 Jul 2012) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/glquake.h

fix some compile errors and warnings with USE_GLES2

------------------------------------------------------------------------
r11837 | vortex | 2012-07-28 13:18:26 -0700 (Sat, 28 Jul 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

gl_lightmaps: value of 2 keeps normalmaps.
------------------------------------------------------------------------
r11836 | havoc | 2012-07-25 00:45:10 -0700 (Wed, 25 Jul 2012) | 4 lines
Changed paths:
   M /trunk/darkplaces/cvar.c

fix an infinite loop if an engine cvar is being restored, that did not
exist at init (but it still warns about it), thanks to Omega for
debugging this

------------------------------------------------------------------------
r11835 | havoc | 2012-07-21 17:50:49 -0700 (Sat, 21 Jul 2012) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

don't double-apply slowmo when playing back non-darkplaces demos (this
fixes the bug where if you changed slowmo during a demo to a low value
and back it would often take a long time to reach the next frame before
applying the new value)

------------------------------------------------------------------------
r11834 | havoc | 2012-07-21 17:49:35 -0700 (Sat, 21 Jul 2012) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix bloom rendering bugs caused by lingering state from transparent
entity rendering (this bug was hidden by r_coronas before)

------------------------------------------------------------------------
r11833 | havoc | 2012-07-21 15:27:19 -0700 (Sat, 21 Jul 2012) | 3 lines
Changed paths:
   M /trunk/darkplaces/host.c

don't honor cl.paused or host_framerate in demo playback (to fix Malice
intro demos which otherwise get paused and stay there)

------------------------------------------------------------------------
r11832 | divverent | 2012-06-27 05:31:50 -0700 (Wed, 27 Jun 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/keys.c

don't put lines starting with rcon_password in the history
------------------------------------------------------------------------
r11831 | havoc | 2012-06-22 21:54:58 -0700 (Fri, 22 Jun 2012) | 3 lines
Changed paths:
   M /trunk/darkplaces/collision.c

fix for hip1m1 gold key door - favor earlier entity result in cliptrace
combining (use of < operator preferred over <=)

------------------------------------------------------------------------
r11830 | divverent | 2012-06-22 04:12:36 -0700 (Fri, 22 Jun 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

uri_postbuf: copy the content-type, do not keep a reference to qc
------------------------------------------------------------------------
r11829 | divverent | 2012-06-15 01:08:38 -0700 (Fri, 15 Jun 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/collision.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/mathlib.h
   M /trunk/darkplaces/portals.c
   M /trunk/darkplaces/r_shadow.c

rename a macro with misleading name, as TriangleOverlapsBox doesn't check for actual triangle/box overlap, but just whether an overlap is possible at all using a bbox check. No functional changes, just search/replace.
------------------------------------------------------------------------
r11828 | havoc | 2012-06-14 19:14:09 -0700 (Thu, 14 Jun 2012) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_sprites.c

fix two crashes introduced by vortex ( r11822 ) on sprites and nomodels

------------------------------------------------------------------------
r11827 | divverent | 2012-06-10 10:07:15 -0700 (Sun, 10 Jun 2012) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

fix a misleading error "Mod_ForName: NULL name"

as that one means empty name, not NULL
------------------------------------------------------------------------
r11826 | divverent | 2012-06-10 09:45:08 -0700 (Sun, 10 Jun 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/dpdefs/csprogsdefs.qc
   M /trunk/darkplaces/dpdefs/dpextensions.qc

sync dpdefs with xonotic
------------------------------------------------------------------------
r11825 | divverent | 2012-06-06 07:07:46 -0700 (Wed, 06 Jun 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/zone.c

Mem_Realloc: allow the pool to be NULL in which case the block's previous pool is used
------------------------------------------------------------------------
r11824 | havoc | 2012-05-27 16:23:12 -0700 (Sun, 27 May 2012) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

added note about multi-gpu on the descriptions of r_motionblur and
r_damageblur cvars

------------------------------------------------------------------------
r11823 | havoc | 2012-05-27 16:22:45 -0700 (Sun, 27 May 2012) | 4 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

disable r_coronas by default
disable r_coronas_occlusionquery by default (bad performance, especially
on multi-gpu)

------------------------------------------------------------------------
r11822 | vortex | 2012-05-24 10:32:00 -0700 (Thu, 24 May 2012) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/meshqueue.c
   M /trunk/darkplaces/meshqueue.h
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_lightning.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_sprites.c

New shader keyword dptransparentsort (can be "sky", "distance", "hud") which forces one of transparent sort techniques. EF_NODEPTHTEST and RENDER_WORLDOBJECT entity flags have greater priority and override shader-set transparent sort technique.
New cvar q3shader_force_terrain_alphaflag which sets TEXF_ALPHA on both vertextextureblend textures (fixes r_glsl_vertextextureblend_usebothalphas).
------------------------------------------------------------------------
r11821 | eihrul | 2012-05-20 07:24:52 -0700 (Sun, 20 May 2012) | 2 lines
Changed paths:
   M /trunk/darkplaces/shader_glsl.h

slightly cheaper linear PCF sequence

------------------------------------------------------------------------
r11820 | eihrul | 2012-05-18 21:17:00 -0700 (Fri, 18 May 2012) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/shader_glsl.h

use texture gather emulation for the shadowmap sampler path, and use it by default instead of texture gather

------------------------------------------------------------------------
r11819 | divverent | 2012-05-16 00:44:52 -0700 (Wed, 16 May 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix alphatest surfaces in GL11 path
------------------------------------------------------------------------
r11818 | divverent | 2012-05-16 00:44:42 -0700 (Wed, 16 May 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

multiple fog fixes for GL11/GL13 render path
------------------------------------------------------------------------
r11817 | divverent | 2012-05-15 03:32:51 -0700 (Tue, 15 May 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

reorder printf fields
------------------------------------------------------------------------
r11816 | divverent | 2012-05-13 12:08:32 -0700 (Sun, 13 May 2012) | 3 lines
Changed paths:
   M /trunk/darkplaces/quakedef.h

workaround for broken libc on mingw32

mingw32-gcc claims to be C99, but its sprintf() isn't
------------------------------------------------------------------------
r11815 | havoc | 2012-05-05 14:29:07 -0700 (Sat, 05 May 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/view.c

fix some int to bool conversion warnings on MSVS2008
------------------------------------------------------------------------
r11814 | havoc | 2012-05-05 14:24:08 -0700 (Sat, 05 May 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/shader_glsl.h

redesigned r_celoutlines shader code to be a shadowing method rather than edge detect, looks better now
------------------------------------------------------------------------
r11813 | divverent | 2012-04-29 08:49:56 -0700 (Sun, 29 Apr 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

fix a stupid overrun in OP_DONE/OP_RETURN when trying to return one of the last two globals
------------------------------------------------------------------------
r11812 | vortex | 2012-04-24 12:05:21 -0700 (Tue, 24 Apr 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_sprites.c

R_MeshQueue_AddTransparent: Switch checks for RENDER_NODEPTHTEST and RENDER_WORLDOBJECT so RENDER_WORLDOBJECT keeps it's sorting index even if have RENDER_NODEPTHTEST.
------------------------------------------------------------------------
r11811 | divverent | 2012-04-21 06:46:27 -0700 (Sat, 21 Apr 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/makefile.inc

add extra var DP_GMP_STATIC_LIBDIR
------------------------------------------------------------------------
r11810 | divverent | 2012-04-20 01:46:33 -0700 (Fri, 20 Apr 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/quakedef.h

VM_sprintf: use intmax_t for integer types
------------------------------------------------------------------------
r11809 | divverent | 2012-04-20 01:20:43 -0700 (Fri, 20 Apr 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/svvm_cmds.c

fix ReadPicture/WritePicture for sizes > 32k
------------------------------------------------------------------------
r11808 | havoc | 2012-04-19 18:56:30 -0700 (Thu, 19 Apr 2012) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

fix a few more redundancies with PRVM_64

------------------------------------------------------------------------
r11807 | havoc | 2012-04-19 18:40:13 -0700 (Thu, 19 Apr 2012) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/svvm_cmds.c

fix several issues with PRVM_64, mostly cleaning up (int) casts

------------------------------------------------------------------------
r11806 | divverent | 2012-04-19 13:27:57 -0700 (Thu, 19 Apr 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/crypto.c

fix a warning that was there for a while
------------------------------------------------------------------------
r11805 | divverent | 2012-04-19 13:27:53 -0700 (Thu, 19 Apr 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/dpsoftrast.c
   M /trunk/darkplaces/ft2.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/snd_mix.c

remove some more dead code
------------------------------------------------------------------------
r11804 | divverent | 2012-04-19 13:27:45 -0700 (Thu, 19 Apr 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/dpsoftrast.c
   M /trunk/darkplaces/gl_rmain.c

remove some more dead code ("Dead Increment" bugs from clang-analyzer); however, many of these were kept there as they help making code more readable/maintainable (e.g. incrementing data pointer after the LAST read from a model)
------------------------------------------------------------------------
r11803 | divverent | 2012-04-19 12:55:26 -0700 (Thu, 19 Apr 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/cap_ogg.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/world.c

remove some dead initializations that clang-analyzer found (verified)
------------------------------------------------------------------------
r11802 | divverent | 2012-04-19 12:52:58 -0700 (Thu, 19 Apr 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/vid_glx.c

handle the unlikely case of qglXSwapIntervalSGI becoming invalid after GL restart (found by clang-analyzer)
------------------------------------------------------------------------
r11801 | divverent | 2012-04-19 12:48:29 -0700 (Thu, 19 Apr 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/sys.h

mark Host_Error as noreturn to help static analysis
------------------------------------------------------------------------
r11800 | havoc | 2012-04-19 04:48:07 -0700 (Thu, 19 Apr 2012) | 4 lines
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

changed PRVM_ValueString (used by prvm_global, prvm_globals, prvm_edict,
prvm_edicts) to print floats and vectors with more precision (using the
FLOAT_LOSSLESS_FORMAT and VECTOR_LOSSLESS_FORMAT macros previously added)

------------------------------------------------------------------------
r11799 | havoc | 2012-04-19 02:18:21 -0700 (Thu, 19 Apr 2012) | 4 lines
Changed paths:
   M /trunk/darkplaces/prvm_execprogram.h

fix severe bugs with the PRVM_64 support, which affected both modes of
operation (PRVM_64 defined or not) - the OP_LOAD_ operations were
converting between float and int unintentionally

------------------------------------------------------------------------
r11798 | havoc | 2012-04-19 02:17:39 -0700 (Thu, 19 Apr 2012) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

fix some redundant int to float to double casts when using PRVM_64

------------------------------------------------------------------------
r11797 | divverent | 2012-04-19 01:06:50 -0700 (Thu, 19 Apr 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/image_png.c

fix writing using libpng15
------------------------------------------------------------------------
r11796 | havoc | 2012-04-17 14:29:58 -0700 (Tue, 17 Apr 2012) | 3 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/world.c

fix two bugs introduced in r11402 that broke dm6 teleporters and many
other triggers (was using overly padded mins and maxs)

------------------------------------------------------------------------
r11795 | havoc | 2012-04-15 06:12:25 -0700 (Sun, 15 Apr 2012) | 2 lines
Changed paths:
   M /trunk/darkplaces/qtypes.h

disable PRVM_64 until the bugs are worked out

------------------------------------------------------------------------
r11794 | havoc | 2012-04-12 00:08:45 -0700 (Thu, 12 Apr 2012) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

fix a use of Cmd_Argv(1) as a dpsnprintf format string

------------------------------------------------------------------------
r11793 | divverent | 2012-04-11 07:14:31 -0700 (Wed, 11 Apr 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/quakedef.h

fix a typo
------------------------------------------------------------------------
r11792 | divverent | 2012-04-11 06:34:44 -0700 (Wed, 11 Apr 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/quakedef.h

PRVM_64: make savegames precision-loss-less
------------------------------------------------------------------------
r11791 | divverent | 2012-04-11 03:58:16 -0700 (Wed, 11 Apr 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

fix "strings go past end of file" check
------------------------------------------------------------------------
r11790 | havoc | 2012-04-08 20:06:33 -0700 (Sun, 08 Apr 2012) | 2 lines
Changed paths:
   M /trunk/darkplaces/progsvm.h

fix PRVM_E_INT which was severely bugged

------------------------------------------------------------------------
r11789 | divverent | 2012-04-06 11:20:32 -0700 (Fri, 06 Apr 2012) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

properly check for bloom being active

From: Rudolf Polzer <divverent@alientrap.org>
------------------------------------------------------------------------
r11788 | divverent | 2012-04-06 11:20:27 -0700 (Fri, 06 Apr 2012) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

Create a cvar which changes brightness when r_bloom is enabled. This is useful to tweak overall scene brightness when bloom is on, so that it matches the same brightness and the over-brightening caused by bloom can be somewhat canceled.

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r11787 | havoc | 2012-04-04 21:14:10 -0700 (Wed, 04 Apr 2012) | 2 lines
Changed paths:
   M /trunk/darkplaces/server.h

use prvm_vec_t for spawn_parms storage

------------------------------------------------------------------------
r11786 | havoc | 2012-04-04 00:07:59 -0700 (Wed, 04 Apr 2012) | 2 lines
Changed paths:
   M /trunk/darkplaces/qtypes.h

enable PRVM_64 define

------------------------------------------------------------------------
r11785 | havoc | 2012-04-04 00:04:45 -0700 (Wed, 04 Apr 2012) | 8 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/mathlib.c
   M /trunk/darkplaces/mathlib.h
   M /trunk/darkplaces/matrixlib.h
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/prvm_exec.c
   M /trunk/darkplaces/prvm_execprogram.h
   M /trunk/darkplaces/qtypes.h
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_move.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sv_user.c
   M /trunk/darkplaces/svvm_cmds.c
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/world.c

added PRVM_64 define which upgrades the QC VM to double precision
variables (such that levels can run for more than 24 hours without
time precision breakdown, and bit arithmetic can be done on 52 bit flags
rather than 23 bit flags)
changed csqc setmodel builtin to do setsize as well (like on server)
fixed multiple bugs where csqc builtins were passing right as left in a
matrix conversion

------------------------------------------------------------------------
r11784 | divverent | 2012-04-01 06:46:01 -0700 (Sun, 01 Apr 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/snd_mix.c

put comment about wrong cppcheck warning (apparently got confused about scope of different "channel" vars)
------------------------------------------------------------------------
r11783 | divverent | 2012-04-01 06:45:58 -0700 (Sun, 01 Apr 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/snd_3dras.c

fix out of buffer access in snd_3dras
------------------------------------------------------------------------
r11782 | divverent | 2012-04-01 06:45:55 -0700 (Sun, 01 Apr 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/sbar.c
   M /trunk/darkplaces/sys_win.c

set right include path for two #include commands
------------------------------------------------------------------------
r11781 | divverent | 2012-04-01 06:45:52 -0700 (Sun, 01 Apr 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/snd_3dras.c

another NULL dereference fixed
------------------------------------------------------------------------
r11780 | divverent | 2012-04-01 06:45:48 -0700 (Sun, 01 Apr 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

remove pointless NULL checks in gl_rmain as they can never hit without code crashing elsewhere; also, the pointer can never be NULL anyway
------------------------------------------------------------------------
r11779 | divverent | 2012-04-01 06:30:20 -0700 (Sun, 01 Apr 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/cvar.c

slightly simplify cmd and cvar code (also silences a - false - cppcheck error)
------------------------------------------------------------------------
r11778 | divverent | 2012-04-01 06:30:16 -0700 (Sun, 01 Apr 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_video_jamdecode.c
   M /trunk/darkplaces/cl_video_libavw.c

fix NULL dereference in jam and avw video playback when out of memory
------------------------------------------------------------------------
r11777 | divverent | 2012-04-01 06:20:46 -0700 (Sun, 01 Apr 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/model_shared.c

fix a NULL pointer dereference in modeldecompile
------------------------------------------------------------------------
r11776 | divverent | 2012-04-01 02:36:32 -0700 (Sun, 01 Apr 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_video_libavw.c

FIX LINEFEEDS :(
------------------------------------------------------------------------
r11775 | divverent | 2012-04-01 02:36:28 -0700 (Sun, 01 Apr 2012) | 3 lines
Changed paths:
   M /trunk/darkplaces/lhnet.c

Turn off RFC 1149 on systems that have it enabled.

We got massive reports of lags on systems supporting this protocol.
------------------------------------------------------------------------
r11773 | eihrul | 2012-03-23 19:11:20 -0700 (Fri, 23 Mar 2012) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

R_Shadow_CullFrustumSide fixes

------------------------------------------------------------------------
r11772 | havoc | 2012-03-21 17:48:23 -0700 (Wed, 21 Mar 2012) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_video_libavw.c

hush more warnings

------------------------------------------------------------------------
r11771 | havoc | 2012-03-21 17:44:28 -0700 (Wed, 21 Mar 2012) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/prvm_cmds.c

mark some functions as static to hush warnings
changed a VM_Warning to fix a format warning

------------------------------------------------------------------------
r11770 | havoc | 2012-03-21 16:18:16 -0700 (Wed, 21 Mar 2012) | 5 lines
Changed paths:
   M /trunk/darkplaces/collision.c
   M /trunk/darkplaces/collision.h

implemented collision_triangle_axialsides cvar (default 1, matching
existing behavior)
implemented collision_triangle_bevelsides cvar (default 1, this changes
the side planes of triangles to be a 45 degree slope)

------------------------------------------------------------------------
r11769 | havoc | 2012-03-21 06:22:32 -0700 (Wed, 21 Mar 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_video_libavw.c

fixed compilation on MSVS2008 - do not use stdint.h
------------------------------------------------------------------------
r11768 | vortex | 2012-03-20 15:02:40 -0700 (Tue, 20 Mar 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/r_shadow.c

r_editlights: added r_editlights_drawproperties cvar and read-only cvars for selected light properties (QC-based editor can query them).
------------------------------------------------------------------------
r11767 | vortex | 2012-03-20 14:55:04 -0700 (Tue, 20 Mar 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/dpdefs/dpextensions.qc
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.h
   M /trunk/darkplaces/svvm_cmds.c

Work-in-progress extension: DP_QC_STRINGBUFFERS_EXT_WIP. 
------------------------------------------------------------------------
r11766 | vortex | 2012-03-20 13:56:05 -0700 (Tue, 20 Mar 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/cl_video.h
   M /trunk/darkplaces/cl_video_jamdecode.c
   A /trunk/darkplaces/cl_video_libavw.c
   M /trunk/darkplaces/dpvsimpledecode.c
   M /trunk/darkplaces/dpvsimpledecode.h

Introducing LibAvW - a wrapper DLL to play videos using libav. Basic support includes extraction of video frames (sound files should be placed as separate .ogg's) and scaling. No ABI requirements (wrapper takes all dirty code). LibAvW can be found at: svn://svn.icculus.org/razorwind/trunk/dplibavw .
------------------------------------------------------------------------
r11765 | vortex | 2012-03-20 13:46:03 -0700 (Tue, 20 Mar 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_particles.c

cl_particles_reloadeffects <filename> - reload effects from custom effect file
------------------------------------------------------------------------
r11764 | divverent | 2012-03-18 14:20:27 -0700 (Sun, 18 Mar 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/svvm_cmds.c

checkpvs: use the right worldmodel
------------------------------------------------------------------------
r11763 | divverent | 2012-03-18 13:20:43 -0700 (Sun, 18 Mar 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

document that celshading and celoutlines currently require GL2
------------------------------------------------------------------------
r11762 | havoc | 2012-03-18 12:07:28 -0700 (Sun, 18 Mar 2012) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/svvm_cmds.c

VM_FrameBlendFromFrameGroupBlend was using cl.time even on server

------------------------------------------------------------------------
r11761 | eihrul | 2012-03-18 10:16:46 -0700 (Sun, 18 Mar 2012) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

fix usage of linear filter when using shadowmap sampler

------------------------------------------------------------------------
r11760 | divverent | 2012-03-15 22:49:43 -0700 (Thu, 15 Mar 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/netconn.c

fix a typo in challenge flood protection
------------------------------------------------------------------------
r11758 | divverent | 2012-03-12 23:44:51 -0700 (Mon, 12 Mar 2012) | 5 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

fix an unlikely crypto downgrade attack found during audit

if DP3 and earlier protocols are active, a malicious client may intervene
during connect with an authenticated player's connect and downgrade to
unauthenticated NQ protocol
------------------------------------------------------------------------
r11757 | divverent | 2012-03-12 23:44:47 -0700 (Mon, 12 Mar 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/server.h

also block floods of getstatus, getinfo, getchallenge
------------------------------------------------------------------------
r11756 | havoc | 2012-03-12 19:26:31 -0700 (Mon, 12 Mar 2012) | 3 lines
Changed paths:
   M /trunk/darkplaces/svvm_cmds.c

use prog->progs_mempool for server DP_SKELETONOBJECTS storage, not
cls.levelmempool

------------------------------------------------------------------------
r11754 | divverent | 2012-03-12 02:21:55 -0700 (Mon, 12 Mar 2012) | 6 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/screen.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/vid_shared.c

introducing "scr_loadingscreen_firstforstartup"

make first loading.tga screen a special startup splash-screen,
that shows only once on client startup

From: nyov <nyov@nexnode.net>
------------------------------------------------------------------------
r11753 | divverent | 2012-03-10 04:54:55 -0800 (Sat, 10 Mar 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

dpsoftrast: SHADERMODE_GENERIC SHADERPERMUTATION_ALPHAKILL too
------------------------------------------------------------------------
r11752 | divverent | 2012-03-10 04:39:29 -0800 (Sat, 10 Mar 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/dpsoftrast.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/shader_glsl.h
   M /trunk/darkplaces/shader_hlsl.h

allow MATERIALFLAG_CAMERA to fade out
------------------------------------------------------------------------
r11751 | divverent | 2012-03-09 11:08:04 -0800 (Fri, 09 Mar 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/mathlib.c

try to really fix vectorvectors to be 100% equivalent to makevectors(flippitch(vectoangles(v)))
------------------------------------------------------------------------
r11749 | havoc | 2012-03-08 20:48:36 -0800 (Thu, 08 Mar 2012) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_demo.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/prvm_edict.c

patch from Klaus Silveira cleaning up several inefficient and redundant
code bits

------------------------------------------------------------------------
r11748 | havoc | 2012-03-08 20:48:02 -0800 (Thu, 08 Mar 2012) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fixed a severely bugged check of R_BlendFuncFlags
removed a redundant lightmap update loop
thanks to Klaus Silveira for pointing out these issues

------------------------------------------------------------------------
r11747 | havoc | 2012-03-08 20:25:25 -0800 (Thu, 08 Mar 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/makefile.inc

use CFLAGS_ODE on prvm_cmd.c because it checks ODE_DYNAMIC and ODE_STATIC defines
------------------------------------------------------------------------
r11746 | havoc | 2012-03-08 20:22:41 -0800 (Thu, 08 Mar 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

fix compile error where no extern was defined for ode_dll
------------------------------------------------------------------------
r11744 | divverent | 2012-03-08 06:01:06 -0800 (Thu, 08 Mar 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/world.c
   M /trunk/darkplaces/world.h

fix checkextension based ODE detection for QC code
------------------------------------------------------------------------
r11740 | divverent | 2012-03-01 06:34:32 -0800 (Thu, 01 Mar 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/model_alias.c

add a flag to forcibly turn off skeletal animation for benchmarking
------------------------------------------------------------------------
r11739 | divverent | 2012-03-01 05:32:55 -0800 (Thu, 01 Mar 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/console.c

Con_ClearNotify: only hide notify, not chat
------------------------------------------------------------------------
r11737 | divverent | 2012-02-28 03:52:14 -0800 (Tue, 28 Feb 2012) | 3 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

fix a stupid type error.

Why doesn't PRVM_EDICT_NUM(prvm_edict_t *) warn?!?
------------------------------------------------------------------------
r11736 | divverent | 2012-02-28 03:06:10 -0800 (Tue, 28 Feb 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clvm_cmds.c

runstandardplayerphysics: ignore the passed edict for player physics (consistent to legacy prediction)
------------------------------------------------------------------------
r11735 | havoc | 2012-02-27 10:31:30 -0800 (Mon, 27 Feb 2012) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/render.h

fix for .alpha and other effects on sprites that use the same frame,
they were all reusing the same alpha value, probably also broke
interpolation at the same time

------------------------------------------------------------------------
r11734 | havoc | 2012-02-26 07:06:40 -0800 (Sun, 26 Feb 2012) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_wav.c

byteswap S16LE sound data on load once, not twice :)

------------------------------------------------------------------------
r11730 | divverent | 2012-02-24 06:43:49 -0800 (Fri, 24 Feb 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/sv_main.c

remove redundant check
------------------------------------------------------------------------
r11729 | divverent | 2012-02-24 06:42:30 -0800 (Fri, 24 Feb 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/sv_main.c

don't accumulate time reports for the first 10 seconds of a match so things can settle
------------------------------------------------------------------------
r11728 | divverent | 2012-02-24 05:34:16 -0800 (Fri, 24 Feb 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/host.c

add missing variable
------------------------------------------------------------------------
r11727 | divverent | 2012-02-24 04:28:41 -0800 (Fri, 24 Feb 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/sv_main.c

also count timing info when nobody is playing
------------------------------------------------------------------------
r11724 | havoc | 2012-02-23 04:17:32 -0800 (Thu, 23 Feb 2012) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_sdl.c

use stickmouse code when SDL2 relative mouse fails

------------------------------------------------------------------------
r11723 | havoc | 2012-02-23 04:06:18 -0800 (Thu, 23 Feb 2012) | 2 lines
Changed paths:
   M /trunk/darkplaces/thread_sdl.c
   M /trunk/darkplaces/vid_sdl.c

work with SDL2

------------------------------------------------------------------------
r11722 | divverent | 2012-02-23 02:35:46 -0800 (Thu, 23 Feb 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/netconn.c

I moved the IPv6 master server to another server. Sorry for that.
------------------------------------------------------------------------
r11719 | havoc | 2012-02-21 11:21:05 -0800 (Tue, 21 Feb 2012) | 3 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

use both .items2 and serverflags in items stat, to finally fix the runes
missing on the hud bug

------------------------------------------------------------------------
r11718 | divverent | 2012-02-21 04:03:12 -0800 (Tue, 21 Feb 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/zone.c

fix a stupid typo
------------------------------------------------------------------------
r11717 | divverent | 2012-02-21 03:49:25 -0800 (Tue, 21 Feb 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/zone.c

no need to waste a full page
------------------------------------------------------------------------
r11716 | divverent | 2012-02-21 03:32:57 -0800 (Tue, 21 Feb 2012) | 5 lines
Changed paths:
   M /trunk/darkplaces/zone.c

crazy feature: -DFILE_BASED_MALLOC=1

replaces malloc/free calls by mmap/munmap of file backed store.

Best used with -DMEMCLUMPING=1
------------------------------------------------------------------------
r11715 | havoc | 2012-02-20 11:36:01 -0800 (Mon, 20 Feb 2012) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fix the compiler error fo' reals this time

------------------------------------------------------------------------
r11713 | havoc | 2012-02-20 11:34:16 -0800 (Mon, 20 Feb 2012) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fix compile error

------------------------------------------------------------------------
r11712 | divverent | 2012-02-20 11:25:50 -0800 (Mon, 20 Feb 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/makefile.inc

we don't use DGA any more, so why -lxxf86dga
------------------------------------------------------------------------
r11711 | havoc | 2012-02-20 11:21:23 -0800 (Mon, 20 Feb 2012) | 4 lines
Changed paths:
   M /trunk/darkplaces/bspfile.h
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/wad.c
   M /trunk/darkplaces/wad.h

added Q1 BSP2 format support, compatible with hmap2
Q1BSP loader is now based on MSG_Read functions to make it very
extensible

------------------------------------------------------------------------
r11708 | divverent | 2012-02-20 07:11:32 -0800 (Mon, 20 Feb 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/mathlib.c

add a note about a VectorVectors bug
------------------------------------------------------------------------
r11707 | divverent | 2012-02-20 06:54:40 -0800 (Mon, 20 Feb 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/draw.h
   M /trunk/darkplaces/gl_draw.c

fix broken use of + and | in drawflags
------------------------------------------------------------------------
r11703 | divverent | 2012-02-20 04:28:09 -0800 (Mon, 20 Feb 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/image.c

fix a crash when JPEG loading when alpha image is corrupt
------------------------------------------------------------------------
r11702 | vortex | 2012-02-18 16:43:54 -0800 (Sat, 18 Feb 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_backend.c

Fix shader compile log again. Print error in any case, warnings only if developer, all other if developer_extra.
------------------------------------------------------------------------
r11701 | vortex | 2012-02-18 14:09:50 -0800 (Sat, 18 Feb 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_backend.c

Fixed shader compile log to use Con_DPrintf.
------------------------------------------------------------------------
r11700 | havoc | 2012-02-18 13:52:00 -0800 (Sat, 18 Feb 2012) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

remove some undesired else's that break r_celshading and r_celoutlines

------------------------------------------------------------------------
r11699 | vortex | 2012-02-18 11:30:20 -0800 (Sat, 18 Feb 2012) | 2 lines
Changed paths:
   M /trunk/darkplaces/matrixlib.c
   M /trunk/darkplaces/matrixlib.h
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/prvm_offsets.h
   M /trunk/darkplaces/world.c

ODE: rewrite scale support to scale collision mesh. Now mass center and object bounds is derived from real collision mesh box, not model/entity box. Added experimental code for Convex Hull geometry (off by default). Also autodisabling was fixed to exclude collisions between disabled objects which gives a huge speedup on dCollide* phase. Increased defaults for damping and autodisable.
Matrixlib: removed  Matrix4x4_OriginScale3 which was added for ODE offsetmatrix scale, since it's not used by it anymore, its removed.
------------------------------------------------------------------------
r11698 | divverent | 2012-02-18 05:48:09 -0800 (Sat, 18 Feb 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/sys_shared.c

always allow -nosse and -nosse2 flags to change SSE status
------------------------------------------------------------------------
r11697 | vortex | 2012-02-18 04:29:05 -0800 (Sat, 18 Feb 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/mathlib.c

VectorVectors: renormalize 'up' vector as it seems to be unnormalized in some cases (a test case - spawning of large-scaled oriented particle).
------------------------------------------------------------------------
r11696 | divverent | 2012-02-18 03:19:13 -0800 (Sat, 18 Feb 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/thread_pthread.c
   M /trunk/darkplaces/thread_sdl.c
   M /trunk/darkplaces/thread_win.c

actually fix the barrier typecasts... these really need to be volatile due to the b->called counter
------------------------------------------------------------------------
r11695 | vortex | 2012-02-18 02:23:32 -0800 (Sat, 18 Feb 2012) | 2 lines
Changed paths:
   M /trunk/darkplaces/draw.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/r_textures.h

Add an optional DRAW_NOGAMMA flag for R_DrawQSuperPic (disable glslgamma for that pic).
r_texture_dds_load_logfailure: 1 only prints required diffuse textures, 2 keeps old behavior - prints all missing textures (including normalmap, gloss, pants, shirt, mask.
------------------------------------------------------------------------
r11694 | vortex | 2012-02-18 02:05:58 -0800 (Sat, 18 Feb 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/thread_sdl.c

fix type cast
------------------------------------------------------------------------
r11693 | vortex | 2012-02-18 02:04:23 -0800 (Sat, 18 Feb 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/thread_sdl.c

fix type cast
------------------------------------------------------------------------
r11692 | divverent | 2012-02-16 13:04:22 -0800 (Thu, 16 Feb 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/thread.h
   M /trunk/darkplaces/thread_null.c
   M /trunk/darkplaces/thread_pthread.c
   M /trunk/darkplaces/thread_sdl.c
   M /trunk/darkplaces/thread_win.c

Add support for barriers to the threading interface; fix skeletal animation appearing as part of visibility in r_speeds 2
------------------------------------------------------------------------
r11691 | havoc | 2012-02-16 12:14:15 -0800 (Thu, 16 Feb 2012) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix typos

------------------------------------------------------------------------
r11690 | havoc | 2012-02-15 15:34:35 -0800 (Wed, 15 Feb 2012) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/shader_glsl.h

added r_celshading cvar and GLSL shader code
added r_celoutlines cvar and GLSL shader code

------------------------------------------------------------------------
r11687 | eihrul | 2012-02-12 12:30:58 -0800 (Sun, 12 Feb 2012) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

make sure depth test is disabled before rendering bloom

------------------------------------------------------------------------
r11686 | eihrul | 2012-02-12 12:17:59 -0800 (Sun, 12 Feb 2012) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix some weird incidental finding in the bloom code

------------------------------------------------------------------------
r11685 | divverent | 2012-02-12 00:42:00 -0800 (Sun, 12 Feb 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/image_png.c

also support 1.2 again
------------------------------------------------------------------------
r11684 | divverent | 2012-02-12 00:23:43 -0800 (Sun, 12 Feb 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/image_png.c

implement the libpng longjmp hack properly. png_jmpbuf is actually a macro!
------------------------------------------------------------------------
r11683 | divverent | 2012-02-12 00:16:11 -0800 (Sun, 12 Feb 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/image_png.c

bring back old glibc workaround
------------------------------------------------------------------------
r11682 | divverent | 2012-02-12 00:14:26 -0800 (Sun, 12 Feb 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/image_png.c

fix jump buffer type
------------------------------------------------------------------------
r11681 | eihrul | 2012-02-11 10:28:01 -0800 (Sat, 11 Feb 2012) | 2 lines
Changed paths:
   M /trunk/darkplaces/mod_skeletal_animatevertices_generic.c
   M /trunk/darkplaces/mod_skeletal_animatevertices_sse.c

dual quat -> matrix optimizations

------------------------------------------------------------------------
r11680 | eihrul | 2012-02-11 09:43:20 -0800 (Sat, 11 Feb 2012) | 2 lines
Changed paths:
   M /trunk/darkplaces/mod_skeletal_animatevertices_sse.c

fix multiply for skeleton objects

------------------------------------------------------------------------
r11679 | eihrul | 2012-02-11 09:25:12 -0800 (Sat, 11 Feb 2012) | 2 lines
Changed paths:
   M /trunk/darkplaces/mod_skeletal_animatevertices_sse.c

skeleton object openglorientation fix

------------------------------------------------------------------------
r11678 | eihrul | 2012-02-11 09:16:42 -0800 (Sat, 11 Feb 2012) | 2 lines
Changed paths:
   M /trunk/darkplaces/mod_skeletal_animatevertices_sse.c

SIMD-ize the matrix multiplication in AnimateVertices

------------------------------------------------------------------------
r11677 | divverent | 2012-02-11 07:55:36 -0800 (Sat, 11 Feb 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/image_png.c

support libpng 1.5.0
------------------------------------------------------------------------
r11676 | divverent | 2012-02-10 06:00:22 -0800 (Fri, 10 Feb 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/lhnet.c

add a static to an unprototyped internal function to shut off warning
------------------------------------------------------------------------
r11675 | divverent | 2012-02-10 06:00:18 -0800 (Fri, 10 Feb 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/crypto.c
   M /trunk/darkplaces/netconn.c

fix two seriously wrong memset calls possibly causing crypto connections to fail, or bogus servers in the server list
------------------------------------------------------------------------
r11674 | divverent | 2012-02-10 06:00:13 -0800 (Fri, 10 Feb 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/server.h

fix clang warnings for unused result of *_LockThreadMutex
------------------------------------------------------------------------
r11673 | divverent | 2012-02-10 06:00:04 -0800 (Fri, 10 Feb 2012) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/fs.c

fix a few clang warnings that try to hint to buffer overruns

except that these were not overruns (see context in code), but just redundant
strlen calls for allocating and then copying
------------------------------------------------------------------------
r11672 | divverent | 2012-02-09 06:51:09 -0800 (Thu, 09 Feb 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/host.c

use togglemenu 1 to enable menu at startup
------------------------------------------------------------------------
r11671 | divverent | 2012-02-07 14:17:32 -0800 (Tue, 07 Feb 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

allow GET requests to be signed too (typo fix)
------------------------------------------------------------------------
r11670 | eihrul | 2012-02-07 09:15:36 -0800 (Tue, 07 Feb 2012) | 2 lines
Changed paths:
   M /trunk/darkplaces/mod_skeletal_animatevertices_sse.c

spaces -> tabs

------------------------------------------------------------------------
r11669 | eihrul | 2012-02-07 09:13:12 -0800 (Tue, 07 Feb 2012) | 2 lines
Changed paths:
   M /trunk/darkplaces/mod_skeletal_animatevertices_generic.c
   M /trunk/darkplaces/mod_skeletal_animatevertices_sse.c

use dual quaternions for frame blends

------------------------------------------------------------------------
r11667 | eihrul | 2012-02-04 11:42:46 -0800 (Sat, 04 Feb 2012) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/matrixlib.c
   M /trunk/darkplaces/matrixlib.h
   M /trunk/darkplaces/mod_skeletal_animatevertices_generic.c
   M /trunk/darkplaces/mod_skeletal_animatevertices_sse.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/svvm_cmds.c

convert pose6s data to pose7s data to resolve quaternion W coordinate precision issues

------------------------------------------------------------------------
r11666 | havoc | 2012-02-04 01:46:50 -0800 (Sat, 04 Feb 2012) | 3 lines
Changed paths:
   M /trunk/darkplaces/draw.h
   M /trunk/darkplaces/gl_draw.c

added cvars r_nearest_2d and r_nearest_conchars which let you force all
2d pics (including conchars) to nearest filtering, or just conchars

------------------------------------------------------------------------
r11665 | havoc | 2012-01-31 14:36:33 -0800 (Tue, 31 Jan 2012) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c

moved S_FreeSfx call in S_StopChannel to be in a safer place

------------------------------------------------------------------------
r11664 | divverent | 2012-01-31 00:49:09 -0800 (Tue, 31 Jan 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_textures.c

fix a compile error; don't reallocate if target is same size (not sure if that can ever happen though)
------------------------------------------------------------------------
r11663 | eihrul | 2012-01-30 13:50:20 -0800 (Mon, 30 Jan 2012) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

ensure texture is not null before adjusting bind counter

------------------------------------------------------------------------
r11662 | divverent | 2012-01-30 13:39:54 -0800 (Mon, 30 Jan 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_textures.c

properly handle !vid.support.arb_texture_non_power_of_two in DDS upload (fixes segfault with dpsoftrast in xonotic effects-low.cfg)
------------------------------------------------------------------------
r11661 | havoc | 2012-01-28 09:59:05 -0800 (Sat, 28 Jan 2012) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

remove a confusing #if

------------------------------------------------------------------------
r11660 | divverent | 2012-01-26 09:24:57 -0800 (Thu, 26 Jan 2012) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

fix avgcolor calculation when loading dds

Fixes "black screen with r_showsurfaces 3" bug
------------------------------------------------------------------------
r11659 | havoc | 2012-01-26 08:35:07 -0800 (Thu, 26 Jan 2012) | 4 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

change mdl texcoord loading to not have a .5 pixel offset, this now
matches winquake (complete top row and left column are used, bottom row
and right column are not because the texcoords would be off the skin)

------------------------------------------------------------------------
r11658 | divverent | 2012-01-24 13:47:10 -0800 (Tue, 24 Jan 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/dpdefs/csprogsdefs.qc
   M /trunk/darkplaces/dpdefs/menudefs.qc
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/prvm_cmds.c

remove PRECACHE_PIC_NOCLAMP because it currently has no chance to work
------------------------------------------------------------------------
r11657 | divverent | 2012-01-24 13:47:07 -0800 (Tue, 24 Jan 2012) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c

Revert "don't compare texflags in Draw_CachePic_Flags simply because usage of pics doesn't have a way to specify the flags you want, so "anything matches" is a good strategy here" because I just noticed it was a bad idea (R_BeginPolygon vs line drawing).

This reverts commit b561aa07fda3f8aef74c4e4799ea81ef8c479e2a.
------------------------------------------------------------------------
r11656 | divverent | 2012-01-24 13:45:05 -0800 (Tue, 24 Jan 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_draw.c

don't compare texflags in Draw_CachePic_Flags simply because usage of pics doesn't have a way to specify the flags you want, so "anything matches" is a good strategy here
------------------------------------------------------------------------
r11655 | divverent | 2012-01-24 13:28:53 -0800 (Tue, 24 Jan 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/dpdefs/csprogsdefs.qc
   M /trunk/darkplaces/dpdefs/menudefs.qc
   M /trunk/darkplaces/prvm_cmds.c

update dpdefs; support flags to precache_pic
------------------------------------------------------------------------
r11654 | divverent | 2012-01-24 12:41:31 -0800 (Tue, 24 Jan 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/model_shared.c

mod_obj_orientation: affect modeldecompile too
------------------------------------------------------------------------
r11653 | divverent | 2012-01-24 12:41:27 -0800 (Tue, 24 Jan 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/draw.h
   M /trunk/darkplaces/gl_draw.c

add a (yet unused) CACHEPICFLAG_MIPMAP
------------------------------------------------------------------------
r11652 | divverent | 2012-01-22 13:01:16 -0800 (Sun, 22 Jan 2012) | 3 lines
Changed paths:
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c

WORKAROUND: turn off vid.support.ext_framebuffer_object if nonpoweroftwo is not supported because FBO rendering with non-npot is currently massively broken

Please revert this commit when fixing the issue.
------------------------------------------------------------------------
r11651 | divverent | 2012-01-19 14:51:21 -0800 (Thu, 19 Jan 2012) | 3 lines
Changed paths:
   M /trunk/darkplaces/crypto.c

Revert "note that in some cases, crypto_aeslevel changes need crypto_reload to apply (namely, for the server info string)" because I am stupid, this is already solved by code editing the first character

This reverts commit 9a55aaeb89cf823297d40821f9558daed16c87f1.
------------------------------------------------------------------------
r11650 | divverent | 2012-01-19 14:50:29 -0800 (Thu, 19 Jan 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/crypto.c

note that in some cases, crypto_aeslevel changes need crypto_reload to apply (namely, for the server info string)
------------------------------------------------------------------------
r11649 | eihrul | 2012-01-16 13:33:09 -0800 (Mon, 16 Jan 2012) | 3 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/vid_shared.c

flip dpsoftrast's texture memory layout so it matches the framebuffer orientation (allows r_viewfbo and r_bloom to work)
however, r_viewfbo and r_bloom in combination are still broken on GPUs/dpsoftrast without non-power-of-2 textures due to not matching the position DP's bloom expects them to be located at

------------------------------------------------------------------------
r11648 | divverent | 2012-01-16 01:19:27 -0800 (Mon, 16 Jan 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/vid_shared.c

workaround for upside down bug in dpsoftrast: turn off FBO support for dpsoftrast
------------------------------------------------------------------------
r11647 | divverent | 2012-01-15 07:18:32 -0800 (Sun, 15 Jan 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/shader_glsl.h
   M /trunk/darkplaces/shader_hlsl.h

offsetmapping LOD: at least 3 steps!
------------------------------------------------------------------------
r11646 | divverent | 2012-01-15 06:14:19 -0800 (Sun, 15 Jan 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/shader_glsl.h
   M /trunk/darkplaces/shader_hlsl.h

fix scale issue with offsetmapping LOD due to calculated fractional steps count
------------------------------------------------------------------------
r11645 | eihrul | 2012-01-14 04:18:57 -0800 (Sat, 14 Jan 2012) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

better ATI detection

------------------------------------------------------------------------
r11644 | divverent | 2012-01-09 12:02:47 -0800 (Mon, 09 Jan 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c

force a send if movesequence changed
------------------------------------------------------------------------
r11643 | divverent | 2012-01-09 07:12:09 -0800 (Mon, 09 Jan 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/sv_phys.c

fix c/s consistency of sv_gameplayfix_nogravityonground and sv_gameplayfix_gravityunaffectedbyticrate
------------------------------------------------------------------------
r11642 | divverent | 2012-01-09 05:32:43 -0800 (Mon, 09 Jan 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/view.c

add a missing line from the previous commit
------------------------------------------------------------------------
r11641 | divverent | 2012-01-09 05:29:32 -0800 (Mon, 09 Jan 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/view.c

fix issues with V_CalcRefdef in CSQC and stereo view
------------------------------------------------------------------------
r11640 | divverent | 2012-01-09 04:30:23 -0800 (Mon, 09 Jan 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/view.c

use a param for velocity too
------------------------------------------------------------------------
r11639 | divverent | 2012-01-09 04:30:20 -0800 (Mon, 09 Jan 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/view.c

fix a typo, removing use of cl.viewangles
------------------------------------------------------------------------
r11638 | divverent | 2012-01-09 04:30:17 -0800 (Mon, 09 Jan 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/view.c

add TODO markers, possibly for WIP3 version of V_CalcRefdef extension
------------------------------------------------------------------------
r11637 | divverent | 2012-01-09 04:17:11 -0800 (Mon, 09 Jan 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/dpdefs/csprogsdefs.qc
   M /trunk/darkplaces/svvm_cmds.c
   M /trunk/darkplaces/view.c

DP_CSQC_V_CALCREFDEF_WIP2
------------------------------------------------------------------------
r11636 | divverent | 2012-01-09 04:17:07 -0800 (Mon, 09 Jan 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/view.c

add viewmodel info too
------------------------------------------------------------------------
r11635 | divverent | 2012-01-09 03:18:23 -0800 (Mon, 09 Jan 2012) | 3 lines
Changed paths:
   M /trunk/darkplaces/view.c

VectorCopy vieworg and viewangles in intermission too

From: Samual <samual@xonotic.org>
------------------------------------------------------------------------
r11634 | havoc | 2012-01-03 20:36:21 -0800 (Tue, 03 Jan 2012) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

if vertex texture blending is used with a _glow texture, make sure both
layers have a valid _glow texture to render with (otherwise substitute
black in their place)

------------------------------------------------------------------------
r11633 | havoc | 2012-01-03 17:23:47 -0800 (Tue, 03 Jan 2012) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

check rsurface.texture->backgroundglowtexture as well when deciding
whether to enable the GLSL code for _glow texture

------------------------------------------------------------------------
r11632 | divverent | 2012-01-03 14:07:54 -0800 (Tue, 03 Jan 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

argh, sorry for broken copypasta
------------------------------------------------------------------------
r11631 | divverent | 2012-01-03 08:32:45 -0800 (Tue, 03 Jan 2012) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

getimagesize(): return '0 0 0' for missing texture (previously the size of the notexture, that is, '16 16 0')
------------------------------------------------------------------------
r11630 | divverent | 2012-01-03 04:00:40 -0800 (Tue, 03 Jan 2012) | 5 lines
Changed paths:
   M /trunk/darkplaces/libcurl.c

allow control over User-Agent:

cl_curl_useragent 0 turns it off
-DHTTP_USER_AGENT="Foo" overrides the engineversion part
cl_curl_useragent_append bar appends stuff ("Foo bar")
------------------------------------------------------------------------
r11629 | vortex | 2011-12-31 09:11:35 -0800 (Sat, 31 Dec 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/world.c

Try fix ode_body cast.
------------------------------------------------------------------------
r11628 | divverent | 2011-12-31 05:32:02 -0800 (Sat, 31 Dec 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/csprogs.h
   M /trunk/darkplaces/dpdefs/dpextensions.qc
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/svvm_cmds.c

EF_DYNAMICMODELLIGHT
------------------------------------------------------------------------
r11627 | divverent | 2011-12-31 04:19:58 -0800 (Sat, 31 Dec 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/view.c

fix a typo in V_CalcRefdef regarding csqc view entities
------------------------------------------------------------------------
r11626 | vortex | 2011-12-31 01:53:16 -0800 (Sat, 31 Dec 2011) | 9 lines
Changed paths:
   M /trunk/darkplaces/dpdefs/dpextensions.qc
   M /trunk/darkplaces/matrixlib.c
   M /trunk/darkplaces/matrixlib.h
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_offsets.h
   M /trunk/darkplaces/world.c
   M /trunk/darkplaces/world.h

ODE stuff: 
1) Cleaned up capsule/cylinder setup code. New geomtypes - axis-oriented cylinder (x, y, z) and capsule, the only difference from original cylinder/capsule is that leading axis is fixed for these types, allowing to set cylinder with length lesser than diameter. Axis oriented
capsule is not that useful (as there is no capsule which height is lesser than radius, so it's going to fix radius to match), but could be useful is some cases.
2) GEOMTYPE_TRIMESH now supports .scale and .modelscale_vec (q3map2's per-axis scale).
3) New cvar physics_ode_contact_maxpoints (default 16, can be up to 32) to control default maximum number of contact points between two objects, and new .maxcontacts entity field to control maximum number of contacts it could have with other entities, setting it to low value (5 or 10) gains speed with large stacks of GEOMTYPE_TRIMESH, but makes collision more grude, use it on debris and such stuff.
4) At engine startup, print configuration (extensions string) ODE was built with.
5) physics_ode_constantstep is rewritten to do what actually it should do - it tries to run physics with constant time step, making more ODE iterations to match frametime. So it allows to run physics at 50 FPS, 100 fps no matter what rendering fps are, with some restrictions. physics_ode_iterationsperframe has no effect when using constantstep.
6) New GEOMTYPE_NONE that makes object to be entirely ignored by ODE. Also SOLID_NOT and SOLID_TRIGGER defaults to GEOMTYPE_NONE (if geomtype is 0).
7) Added basic forces in same manner as joints (entities with .forcetype), physics_addforce() and physics_addtorgue() is now deprecated as they cant work with multiple ODE iterations per frame.
------------------------------------------------------------------------
r11625 | divverent | 2011-12-30 12:11:07 -0800 (Fri, 30 Dec 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/dpdefs/csprogsdefs.qc
   M /trunk/darkplaces/dpdefs/menudefs.qc

some fixes for dpdefs
------------------------------------------------------------------------
r11624 | havoc | 2011-12-27 20:11:29 -0800 (Tue, 27 Dec 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c

change GAME_STEELSTORM2 to be after GAME_STEELSTORM again

------------------------------------------------------------------------
r11623 | havoc | 2011-12-27 18:46:39 -0800 (Tue, 27 Dec 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c

swap order of GAME_STEELSTORM and GAME_STEELSTORM2 in detection list

------------------------------------------------------------------------
r11622 | divverent | 2011-12-26 07:54:33 -0800 (Mon, 26 Dec 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clvm_cmds.c

make CSQC support the >0.05s/<0.0005s handling of standard player physics so CSQC code doesn't have to
------------------------------------------------------------------------
r11621 | divverent | 2011-12-23 14:39:32 -0800 (Fri, 23 Dec 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/model_brush.c

mod_obj_orientation cvar: 1 = DP's previous behaviour, 0 = leave coordinates alone (q3map2 compatible)
------------------------------------------------------------------------
r11620 | vortex | 2011-12-21 07:20:10 -0800 (Wed, 21 Dec 2011) | 6 lines
Changed paths:
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/dpdefs/dpextensions.qc
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/prvm_offsets.h
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/world.c

Cumulative patch:
Fix RF_MODELLIGHT (was broken and dont work same way engine does it). 
Fix bug in physics_ode_constantstep 1 (integer division, huh). 
Added new geomtype field for ODE physics - sets collision shape, SOLID_PHYSICS_ are not deprecated (but keeped for compatibility reasons), as geomtype is a more correct way to set collision shape (allows to set both SOLID_CORPSE and trimesh collisions for instance).
Fixed support of custinfoparms.txt as some recent change in shader code seemed to broke it.

------------------------------------------------------------------------
r11619 | divverent | 2011-12-20 12:16:30 -0800 (Tue, 20 Dec 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_input.c

oops, didn't want this debug spam to be committed
------------------------------------------------------------------------
r11618 | divverent | 2011-12-20 12:14:36 -0800 (Tue, 20 Dec 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/clvm_cmds.c

if(developer_extra.integer) Con_DPrintf("VM_CL_gettagindex(entity #%i): tag \"%s\" not found\n", PRVM_NUM_FOR_EDICT(ent), tag_name);
------------------------------------------------------------------------
r11617 | divverent | 2011-12-18 07:29:05 -0800 (Sun, 18 Dec 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

skip skip

This is referring to "surfaceparm skip".
------------------------------------------------------------------------
r11616 | divverent | 2011-12-15 13:04:33 -0800 (Thu, 15 Dec 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/shader_glsl.h
   M /trunk/darkplaces/shader_hlsl.h

r_water, MODE_REFRACTION: support alphaGen vertex for fading out water
------------------------------------------------------------------------
r11615 | divverent | 2011-12-13 12:44:37 -0800 (Tue, 13 Dec 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/dpsoftrast.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/shader_glsl.h
   M /trunk/darkplaces/shader_hlsl.h

support alphaGen vertex
------------------------------------------------------------------------
r11614 | divverent | 2011-12-13 12:20:03 -0800 (Tue, 13 Dec 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/dpsoftrast.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/render.h

get rid of 3 permutation bits
------------------------------------------------------------------------
r11613 | divverent | 2011-12-12 00:37:47 -0800 (Mon, 12 Dec 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/dpdefs/menudefs.qc
   M /trunk/darkplaces/menu.c

m_toggle takes a parameter, fix its definition

Signed-off-by: terencehill <piuntn@gmail.com>
------------------------------------------------------------------------
r11612 | divverent | 2011-12-11 22:13:32 -0800 (Sun, 11 Dec 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/dpdefs/dpextensions.qc
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/utf8lib.c
   M /trunk/darkplaces/utf8lib.h

VM_sprintf: support color codes in %s
------------------------------------------------------------------------
r11611 | divverent | 2011-12-11 04:42:44 -0800 (Sun, 11 Dec 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/cmd.c

if no varfunc is left, NULL it
------------------------------------------------------------------------
r11610 | divverent | 2011-12-10 00:37:14 -0800 (Sat, 10 Dec 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/cmd.c

alias expansion, cvar expansion: support optional arguments
------------------------------------------------------------------------
r11609 | vortex | 2011-12-09 15:10:16 -0800 (Fri, 09 Dec 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/thread.h
   M /trunk/darkplaces/thread_sdl.c
   M /trunk/darkplaces/thread_win.c

Add THREADDISABLE define to make builds with whole threading system disabled.
------------------------------------------------------------------------
r11608 | divverent | 2011-12-09 05:42:02 -0800 (Fri, 09 Dec 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/crypto.c

fix stupid typo
------------------------------------------------------------------------
r11607 | divverent | 2011-12-09 04:53:21 -0800 (Fri, 09 Dec 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/crypto.c

for crypto keys, also write an easy to share text file with its fingerprint and status
------------------------------------------------------------------------
r11606 | divverent | 2011-12-09 04:53:18 -0800 (Fri, 09 Dec 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/crypto.c

While I'm reworking this anyway: also write a file key_0-public-fp.txt

containing the public key fingerprint for a key when loading/keygenning. Helps
with submitting your key to websites.
------------------------------------------------------------------------
r11605 | divverent | 2011-12-09 04:53:16 -0800 (Fri, 09 Dec 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/crypto.c
   M /trunk/darkplaces/crypto.h
   M /trunk/darkplaces/dpdefs/menudefs.qc
   M /trunk/darkplaces/mvm_cmds.c

blind_id: rework of keygen to be able to save an unsigned key
------------------------------------------------------------------------
r11604 | vortex | 2011-12-08 15:22:00 -0800 (Thu, 08 Dec 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_offsets.h
   M /trunk/darkplaces/world.c

ODE: experimental 'erp' field for per-entity control of Error Restitution (was only controlled globally by cvar). For more sharp collisions it helps to set high ERP for small objects and low or 0 on big ones (as high ERP on large and high-mass objects tends to explode pretty badly).
------------------------------------------------------------------------
r11603 | vortex | 2011-12-08 15:13:04 -0800 (Thu, 08 Dec 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/csprogs.c

RF_MODELLIGHT compatible with getlight() - assuming light direction is worldspace and transforming it into modelspace.
------------------------------------------------------------------------
r11602 | havoc | 2011-12-08 11:48:03 -0800 (Thu, 08 Dec 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/protocol.c

print E5_COMPLEXANIMATION and E5_TRAILEFFECTNUM in
developer_networkentities, also print bytes per entity update

------------------------------------------------------------------------
r11601 | havoc | 2011-12-07 20:51:02 -0800 (Wed, 07 Dec 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/world.c

disable VorteX's broken physics_ode_constantstep code by setting the
cvar to 0 by default

------------------------------------------------------------------------
r11600 | havoc | 2011-12-07 05:17:06 -0800 (Wed, 07 Dec 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

r_showbboxes now shows SOLID_CORPSE as orange

------------------------------------------------------------------------
r11599 | havoc | 2011-12-05 04:21:35 -0800 (Mon, 05 Dec 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/r_shadow.c

fixed a crash with r_shadow_bouncegrid 2 when also using r_shadow_deferred, made the light draw skipping for r_shadow_bouncegrid 2 a bit more elegant
------------------------------------------------------------------------
r11598 | divverent | 2011-12-04 09:21:42 -0800 (Sun, 04 Dec 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/makefile.inc

move the hack to makefile, as it's using a GNU make feature
------------------------------------------------------------------------
r11597 | divverent | 2011-12-04 09:20:59 -0800 (Sun, 04 Dec 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/makefile.inc

makefile: if a .h file in dependency file is missing (cl_gecko.h), ignore the error and continue anyway
------------------------------------------------------------------------
r11596 | divverent | 2011-12-04 06:48:17 -0800 (Sun, 04 Dec 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/csprogs.c

we now no longer need the auto RENDER_EXTERIORMODEL hack
------------------------------------------------------------------------
r11595 | divverent | 2011-12-04 06:48:14 -0800 (Sun, 04 Dec 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/csprogs.c

make player_localnum and player_localentnum conform to FTEQW
------------------------------------------------------------------------
r11594 | divverent | 2011-12-04 05:40:41 -0800 (Sun, 04 Dec 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/csprogs.c

fix CSQC view entity handling
------------------------------------------------------------------------
r11593 | divverent | 2011-12-03 04:21:12 -0800 (Sat, 03 Dec 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/host.c

add cl_minfps_force cvar to run minfps code even during timedemo
------------------------------------------------------------------------
r11592 | divverent | 2011-12-03 04:06:49 -0800 (Sat, 03 Dec 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

cl_minfps: apply r_refdef.view.quality to reliefmapping LOD distance if reliefmapping LOD is enabled
------------------------------------------------------------------------
r11591 | divverent | 2011-12-03 04:06:45 -0800 (Sat, 03 Dec 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/host.c

transform: make hysteresis one-sided, no behaviour change
------------------------------------------------------------------------
r11590 | divverent | 2011-12-03 00:53:50 -0800 (Sat, 03 Dec 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/host.c

new cl_minfps logic that seems a lot more successful at attaining target fps

The new approach is quite similar to r_viewscale_fpsscaling; possibly, that
logic then can be changed to use r_refdef.view.quality instead at a later time
------------------------------------------------------------------------
r11589 | divverent | 2011-12-02 03:17:01 -0800 (Fri, 02 Dec 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_particles.c

fix a typo... why didn't compiler error
------------------------------------------------------------------------
r11588 | divverent | 2011-12-02 03:13:00 -0800 (Fri, 02 Dec 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_particles.c

effectinfo: lightcorona <alphascale> <sizescale> (default: lightcorona 1 0.25)
------------------------------------------------------------------------
r11587 | divverent | 2011-12-02 02:30:00 -0800 (Fri, 02 Dec 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/csprogs.c

CSQC: propagate automatic RENDER_EXTERIORMODEL inherited from local player ent
------------------------------------------------------------------------
r11586 | eihrul | 2011-12-01 11:39:23 -0800 (Thu, 01 Dec 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c

check for valid socket in Con_Rcon_Redirect_Flush

------------------------------------------------------------------------
r11585 | havoc | 2011-11-30 01:55:48 -0800 (Wed, 30 Nov 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

added r_shadow_shadowmapping_useshadowsampler cvar for performance
testing of whether this intrinsic feature is faster or not

------------------------------------------------------------------------
r11584 | havoc | 2011-11-30 01:30:08 -0800 (Wed, 30 Nov 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/shader_glsl.h

fix GLSL compile errors caused by use of * 64 rather than * 64.0 (oops)

------------------------------------------------------------------------
r11583 | havoc | 2011-11-30 01:15:09 -0800 (Wed, 30 Nov 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/vid_shared.c

bind to GL_ARB_framebuffer_object functions correctly - unlike almost
everything else, these lack the ARB suffix (issue 8 in the spec)

------------------------------------------------------------------------
r11582 | havoc | 2011-11-29 22:19:30 -0800 (Tue, 29 Nov 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/common.c

since motorsep put steelstorm2 after steelstorm, change the commandline
search order so that it picks the last one

------------------------------------------------------------------------
r11581 | motorsep | 2011-11-29 21:56:32 -0800 (Tue, 29 Nov 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h

+ Added Steel Storm 2 and Tomes of Mephistopheles games

------------------------------------------------------------------------
r11580 | divverent | 2011-11-26 06:09:58 -0800 (Sat, 26 Nov 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/model_brush.c

fix lightmapscale logic for sRGB lightmaps to actually work the way one may "expect" (color 128 is neutral)
------------------------------------------------------------------------
r11579 | divverent | 2011-11-26 05:54:55 -0800 (Sat, 26 Nov 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/host_cmd.c

fix a stupid typo in pausable checking code
------------------------------------------------------------------------
r11578 | divverent | 2011-11-26 03:51:58 -0800 (Sat, 26 Nov 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/prvm_offsets.h

runstandardplayerphysics: also implement the no-args case
------------------------------------------------------------------------
r11577 | divverent | 2011-11-26 03:51:55 -0800 (Sat, 26 Nov 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/dpdefs/csprogsdefs.qc

more bugfix
------------------------------------------------------------------------
r11576 | divverent | 2011-11-26 03:32:55 -0800 (Sat, 26 Nov 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/dpdefs/csprogsdefs.qc

make dpdefs capable to compile Xonotic
------------------------------------------------------------------------
r11575 | divverent | 2011-11-26 02:40:54 -0800 (Sat, 26 Nov 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/dpdefs/dpextensions.qc

we need max with ...
------------------------------------------------------------------------
r11574 | divverent | 2011-11-26 02:40:51 -0800 (Sat, 26 Nov 2011) | 1 line
Changed paths:
   A /trunk/darkplaces/dpdefs/keycodes.qc
   M /trunk/darkplaces/dpdefs/menudefs.qc

dpdefs: lots of improvements
------------------------------------------------------------------------
r11573 | divverent | 2011-11-26 00:41:59 -0800 (Sat, 26 Nov 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/dpdefs/progsdefs.qc

remove dpmod stuff here
------------------------------------------------------------------------
r11572 | divverent | 2011-11-26 00:22:30 -0800 (Sat, 26 Nov 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/csprogs.h
   M /trunk/darkplaces/dpdefs/csprogsdefs.qc

move VF_MAINVIEW and VF_MINFPS_QUALITY to DP's extension range (4xx)
------------------------------------------------------------------------
r11571 | divverent | 2011-11-25 05:13:06 -0800 (Fri, 25 Nov 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix another bug with HDR bloom
------------------------------------------------------------------------
r11570 | divverent | 2011-11-25 05:13:02 -0800 (Fri, 25 Nov 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix r_bloom_colorexponent with fbo (fixed version doesn't support npot exponents, but non fixed version does them wrong too)
------------------------------------------------------------------------
r11569 | divverent | 2011-11-25 03:59:43 -0800 (Fri, 25 Nov 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/model_brush.c

fix typo
------------------------------------------------------------------------
r11568 | divverent | 2011-11-25 03:50:28 -0800 (Fri, 25 Nov 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/crypto.c

fix a bug in handling "accept" for crypto connections
------------------------------------------------------------------------
r11567 | divverent | 2011-11-25 03:46:26 -0800 (Fri, 25 Nov 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h

introduce a lightmap scale for models, and use this for the sRGB fallback instead (better quality)
------------------------------------------------------------------------
r11566 | divverent | 2011-11-22 22:36:30 -0800 (Tue, 22 Nov 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/crypto.c
   M /trunk/darkplaces/netconn.c

crypto: some simplifications; also apply policies properly to NQ legacy accept messages
------------------------------------------------------------------------
r11565 | divverent | 2011-11-19 04:50:40 -0800 (Sat, 19 Nov 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/csprogs.h
   M /trunk/darkplaces/dpdefs/csprogsdefs.qc
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/svvm_cmds.c
   M /trunk/darkplaces/view.c

support viewentity to be shared; DP_CSQC_V_CALCREFDEF
------------------------------------------------------------------------
r11564 | divverent | 2011-11-18 03:02:25 -0800 (Fri, 18 Nov 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/host.c

make locksession a bit more robust by calling FS_CreatePath just in case
------------------------------------------------------------------------
r11563 | divverent | 2011-11-17 05:08:33 -0800 (Thu, 17 Nov 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/dpdefs/csprogsdefs.qc
   M /trunk/darkplaces/svvm_cmds.c

document DP_CSQC_MINFPS_QUALITY
------------------------------------------------------------------------
r11562 | divverent | 2011-11-17 05:06:21 -0800 (Thu, 17 Nov 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/csprogs.h

expose r_refdef.view.quality to CSQC R_SetView VF_MINFPS_QUALITY
------------------------------------------------------------------------
r11561 | divverent | 2011-11-15 06:36:30 -0800 (Tue, 15 Nov 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

new effectinfo keywords: relativeoriginoffset, relativevelocityoffset

they take parameters <forward> <right> <up> and are relative to beam/trail direction or average velocity
------------------------------------------------------------------------
r11560 | divverent | 2011-11-15 06:14:27 -0800 (Tue, 15 Nov 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h

actually USE surfaceparms parsed from the shaders (when on models)

the old code loaded them but never converted them from "parms" to "flags", which is the only ones the engine uses
------------------------------------------------------------------------
r11559 | divverent | 2011-11-14 13:22:06 -0800 (Mon, 14 Nov 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/view.c

fix another bug in grounded V_CalcRefDef
------------------------------------------------------------------------
r11558 | divverent | 2011-11-14 13:18:51 -0800 (Mon, 14 Nov 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_screen.c

hopefully fix the r_stereo bug
------------------------------------------------------------------------
r11557 | divverent | 2011-11-14 12:42:20 -0800 (Mon, 14 Nov 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/view.c

ground R_CalcRefdef when the player entity is shared
------------------------------------------------------------------------
r11556 | divverent | 2011-11-14 06:30:49 -0800 (Mon, 14 Nov 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

match FTEQW more closely in runstandardplayerphysics
------------------------------------------------------------------------
r11555 | divverent | 2011-11-14 01:31:55 -0800 (Mon, 14 Nov 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/snd_main.c

CSQC: track client-side entities for sounds issued for the server-side matching entity
------------------------------------------------------------------------
r11554 | divverent | 2011-11-14 01:18:06 -0800 (Mon, 14 Nov 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/view.c

factor V_CalcRefdef into two functions

with the later goal of making it callable after CSQC prediction
------------------------------------------------------------------------
r11553 | divverent | 2011-11-13 07:07:49 -0800 (Sun, 13 Nov 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_input.c

always set movement_velocity even for unpredicted moves
------------------------------------------------------------------------
r11552 | havoc | 2011-11-12 18:39:46 -0800 (Sat, 12 Nov 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_demo.c

fix C++ compile error (missing cast)

------------------------------------------------------------------------
r11551 | divverent | 2011-11-12 11:52:01 -0800 (Sat, 12 Nov 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/prvm_offsets.h

support pmove_flags (the actual flag values may be wrong, someone please find the CSQC spec about them)
------------------------------------------------------------------------
r11550 | divverent | 2011-11-12 11:10:28 -0800 (Sat, 12 Nov 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

we don't need ALL those fields I marked with ???
------------------------------------------------------------------------
r11549 | divverent | 2011-11-12 11:08:03 -0800 (Sat, 12 Nov 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clvm_cmds.c

an attempt to do CL_runplayerphysics, not working properly yet
------------------------------------------------------------------------
r11548 | divverent | 2011-11-12 09:15:42 -0800 (Sat, 12 Nov 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/csprogs.c

make it possible to unset effects for CSQC entities
------------------------------------------------------------------------
r11547 | divverent | 2011-11-12 06:39:15 -0800 (Sat, 12 Nov 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_demo.c

-benchmarkruns: show a report of min/median/max of the benchmarks at the end
------------------------------------------------------------------------
r11546 | divverent | 2011-11-12 03:17:38 -0800 (Sat, 12 Nov 2011) | 14 lines
Changed paths:
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/sv_main.c

complexanimation now beginning to be suitable for SVQC use

- only set E5_COMPLEXANIMATION flag when required to save a LOT of bandwidth
- don't also send a legacy frame number when using complex animation to save a bit more
- no more support of "anims that start in the future", use a QC think function to handle them
- fix wraparound logic for complex animation (if a model animation is shorter than 30 sec, it won't jerk when playing the same anim for over a minute)

Bandwidth use per update message:
- simple anim: 1 byte
- 1 blends: 5 bytes
- 2 blends: 11 bytes
- 3 blends: 16 bytes
- 4 blends: 21 bytes
- skeletonobject: 4 + 12*bonecount bytes
------------------------------------------------------------------------
r11545 | havoc | 2011-11-10 09:05:43 -0800 (Thu, 10 Nov 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

removed a model->numframes <= 1 check which broke animated models with a
single framegroup defined

------------------------------------------------------------------------
r11544 | havoc | 2011-11-09 11:39:40 -0800 (Wed, 09 Nov 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/world.c

don't call ODE dWorldQuickStep with 0 step time

------------------------------------------------------------------------
r11543 | havoc | 2011-11-08 19:02:20 -0800 (Tue, 08 Nov 2011) | 6 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/meshqueue.c
   M /trunk/darkplaces/meshqueue.h
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_lightning.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_sprites.c
   M /trunk/darkplaces/render.h

added r_transparent_sortsurfacesbynearest cvar (default 1), this
resolves a lot of sorting issues with transparent surfaces
added r_transparent_useplanardistance cvar (default 0), the new
spherical distance method will not change when the view rotates, mostly
a consistency improvement

------------------------------------------------------------------------
r11542 | havoc | 2011-11-08 18:54:18 -0800 (Tue, 08 Nov 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

default r_usedepthtextures to 1 until issues are resolved with its
biasing

------------------------------------------------------------------------
r11541 | vortex | 2011-11-08 16:37:52 -0800 (Tue, 08 Nov 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/world.c

DDS with DXT1a: was not correctly detected if r_texture_dds_load_alphamod == 0 (it does not really check for DDPF_ALPHAPIXELS), fixing. 
ODE: physics_ode_constantstep now can be fractional, in this case ODE will run at this tickrate instead of using sys_ticrate, so ODE run at different framerate than server (may be useful for high values, such like running ODE at 100 fps and server at 40fps).
------------------------------------------------------------------------
r11540 | divverent | 2011-11-08 12:49:52 -0800 (Tue, 08 Nov 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/csprogs.h
   M /trunk/darkplaces/dpdefs/csprogsdefs.qc
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/svvm_cmds.c

1. make the first CSQC rendered view the "main" view, for use e.g. by origin display in r_speeds, prydon cursor, etc.
2. add an extension DP_CSQC_MAINVIEW to override DP's notion of the "main" view when necessesary
------------------------------------------------------------------------
r11539 | havoc | 2011-11-08 12:27:31 -0800 (Tue, 08 Nov 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

allow time-based traileffectnum effects by passing frametime as count to
the particle effect, this means that a trail effect can use count rather
than trailspacing for a time-based effect

------------------------------------------------------------------------
r11538 | havoc | 2011-11-08 11:18:19 -0800 (Tue, 08 Nov 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/world.c
   M /trunk/darkplaces/world.h

remove physics_ode_worldstep cvar, it is now always dWorldQuickStep,
this should resolve problems with ode binaries from svn

------------------------------------------------------------------------
r11537 | havoc | 2011-11-08 11:17:40 -0800 (Tue, 08 Nov 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

fix compile error (missing variable)

------------------------------------------------------------------------
r11536 | divverent | 2011-11-08 05:25:56 -0800 (Tue, 08 Nov 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/vid.h

fix compile error regarding vid_sRGB declaration
------------------------------------------------------------------------
r11535 | divverent | 2011-11-08 03:29:06 -0800 (Tue, 08 Nov 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

sRGB fallback: properly convert r_hdr_scenebrightness
------------------------------------------------------------------------
r11534 | divverent | 2011-11-08 03:29:04 -0800 (Tue, 08 Nov 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/sv_main.c

explain that with pausable 0, the server admin still can pause
------------------------------------------------------------------------
r11533 | divverent | 2011-11-08 03:29:00 -0800 (Tue, 08 Nov 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/host_cmd.c

allow listen server owner to pause the game (this also allows rcon pause)
------------------------------------------------------------------------
r11532 | divverent | 2011-11-06 11:43:34 -0800 (Sun, 06 Nov 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/model_shared.c

change framegroups parsing so the final EOL is optional
------------------------------------------------------------------------
r11531 | divverent | 2011-11-06 06:33:48 -0800 (Sun, 06 Nov 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/world.c

fix two checks to not crash when showtex is used without a loaded worldmodel
------------------------------------------------------------------------
r11530 | divverent | 2011-11-06 06:24:59 -0800 (Sun, 06 Nov 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/sbar.c

fix showtex
------------------------------------------------------------------------
r11529 | divverent | 2011-11-05 11:10:14 -0700 (Sat, 05 Nov 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix OBJ models not getting any lighting
------------------------------------------------------------------------
r11528 | divverent | 2011-11-05 09:29:37 -0700 (Sat, 05 Nov 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/render.h

refactoring to avoid doing the same mistake again (see HEAD^)
------------------------------------------------------------------------
r11527 | divverent | 2011-11-05 09:10:25 -0700 (Sat, 05 Nov 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_draw.c

sync _DrawQ_Setup to R_ResetViewRendering2D (they match except for extra parameters and min/max coordinates)
------------------------------------------------------------------------
r11526 | divverent | 2011-11-05 07:11:40 -0700 (Sat, 05 Nov 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/model_shared.c

eat unsupported tokens from framegroups file
------------------------------------------------------------------------
r11523 | divverent | 2011-11-05 07:04:12 -0700 (Sat, 05 Nov 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/model_shared.c

framegroups parsing: make 5th arg animation name, not comment
------------------------------------------------------------------------
r11522 | havoc | 2011-11-04 14:47:09 -0700 (Fri, 04 Nov 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

fix crash in CL_ModelIndexList_f

------------------------------------------------------------------------
r11521 | divverent | 2011-11-03 01:57:42 -0700 (Thu, 03 Nov 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_exec.c

fix segfault in prvm_printfunction
------------------------------------------------------------------------
r11520 | divverent | 2011-11-02 08:59:09 -0700 (Wed, 02 Nov 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_main.c

fix accuracy issue in timerefresh
------------------------------------------------------------------------
r11519 | havoc | 2011-11-02 02:05:20 -0700 (Wed, 02 Nov 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/r_textures.h
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_shared.c

support GL_ARB_framebuffer_object, with GL_EXT_framebuffer_object as fallback, use GL_DEPTH_STENCIL_ATTACHMENT_ARB to fix fbo init errors
------------------------------------------------------------------------
r11518 | divverent | 2011-11-02 02:01:54 -0700 (Wed, 02 Nov 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

mark 5 permutation bits eligible for moving to static parms
------------------------------------------------------------------------
r11517 | divverent | 2011-11-02 01:07:23 -0700 (Wed, 02 Nov 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/fs.c

win32: add two includes to make sure the constants for file mode and sharing are there
------------------------------------------------------------------------
r11516 | divverent | 2011-11-01 22:42:40 -0700 (Tue, 01 Nov 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/netconn.c

fix some typos
------------------------------------------------------------------------
r11515 | divverent | 2011-11-01 08:28:55 -0700 (Tue, 01 Nov 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/crypto.c
   M /trunk/darkplaces/crypto.h
   M /trunk/darkplaces/netconn.c

Crypto_LoadKeys: make the caller responsible for the mutex
------------------------------------------------------------------------
r11514 | divverent | 2011-11-01 08:13:41 -0700 (Tue, 01 Nov 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/crypto.c

lock the thread mutex while altering crypto key stuff
------------------------------------------------------------------------
r11513 | divverent | 2011-11-01 07:45:57 -0700 (Tue, 01 Nov 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/crypto.c
   M /trunk/darkplaces/crypto.h
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/quakedef.h

Command line: -sessionid, cvars: locksession, (R/O) sessionid

Allows games to require a session lock. Put "locksession 1" in the game's default config file and users then need to run instances with unique -sessionid parameter.
------------------------------------------------------------------------
r11512 | havoc | 2011-11-01 06:25:56 -0700 (Tue, 01 Nov 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/shader_hlsl.h

fix an issue with glStencilFuncSeparate being misused (strange that I don't think I ever got a GL error on this before)
fixed deferred rendering in D3D9 renderer
------------------------------------------------------------------------
r11511 | divverent | 2011-11-01 05:22:59 -0700 (Tue, 01 Nov 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/svvm_cmds.c

impact handling: instead of detecting teleports by origin or angles changing, detect teleports by calls to the setorigin() builtin
------------------------------------------------------------------------
r11510 | divverent | 2011-11-01 05:22:57 -0700 (Tue, 01 Nov 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

speed up leaktest a bit
------------------------------------------------------------------------
r11509 | divverent | 2011-11-01 04:30:21 -0700 (Tue, 01 Nov 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/model_shared.c

remove debug print
------------------------------------------------------------------------
r11508 | divverent | 2011-11-01 04:30:19 -0700 (Tue, 01 Nov 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/model_shared.c

more parsing fix
------------------------------------------------------------------------
r11507 | divverent | 2011-11-01 04:20:32 -0700 (Tue, 01 Nov 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/model_shared.c

fix a parsing issue for framegroups files
------------------------------------------------------------------------
r11506 | divverent | 2011-11-01 03:52:09 -0700 (Tue, 01 Nov 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

fix compile of VM_Warning changes
------------------------------------------------------------------------
r11505 | divverent | 2011-11-01 02:38:50 -0700 (Tue, 01 Nov 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

VM_Warning should appear even if developer is 0.
------------------------------------------------------------------------
r11504 | divverent | 2011-11-01 02:25:09 -0700 (Tue, 01 Nov 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

turn "z value discarded" into VM_Warnings so one can backtrace them
------------------------------------------------------------------------
r11503 | havoc | 2011-10-31 20:32:36 -0700 (Mon, 31 Oct 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/darkplaces-dedicated.vcproj
   M /trunk/darkplaces/darkplaces-sdl.vcproj
   M /trunk/darkplaces/darkplaces-wgl.vcproj
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/sys_shared.c
   M /trunk/darkplaces/vid_shared.c

fix compile errors and warnings in MSVC
------------------------------------------------------------------------
r11502 | havoc | 2011-10-31 19:43:43 -0700 (Mon, 31 Oct 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

always use RGBA16F format for deferred rendering regardless of r_viewfbo

------------------------------------------------------------------------
r11501 | havoc | 2011-10-31 10:23:19 -0700 (Mon, 31 Oct 2011) | 8 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.h
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_textures.h
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/shader_glsl.h
   M /trunk/darkplaces/vid_shared.c

added R_LoadTextureRenderbuffer for creating renderbuffers rather than
textures, now using renderbuffer for depth instead of a texture when
doing fbo renders, this seems to give a significant speed gain
implemented shadowmap color texture rendering in a general way (no
longer D3D specific) when r_usedepthtextures cvar is 0
reworked r_shadow_deferred to rely on r_viewfbo 2 or higher for proper
function, this gave a speed boost by eliminating the depth texture

------------------------------------------------------------------------
r11500 | havoc | 2011-10-31 01:49:00 -0700 (Mon, 31 Oct 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

fix a bug that broke cl_maxphysicsframesperserverframe

------------------------------------------------------------------------
r11499 | havoc | 2011-10-31 01:35:12 -0700 (Mon, 31 Oct 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/host.c

changed sv_fixedframeratesingleplayer logic a bit (now 10ms to 100ms per
frame as in original Quake), this cvar is off by default so it should
not be a concern

------------------------------------------------------------------------
r11498 | havoc | 2011-10-31 00:57:35 -0700 (Mon, 31 Oct 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

hit q1bsp sky as a solid in surface traceline

------------------------------------------------------------------------
r11497 | havoc | 2011-10-31 00:56:24 -0700 (Mon, 31 Oct 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/sv_phys.c

undo the SUPERCONTENTS_SKY change, it should not be treated as solid,
instead the q1bsp loader should set SUPERCONTENTS_SOLID

------------------------------------------------------------------------
r11496 | havoc | 2011-10-31 00:14:35 -0700 (Mon, 31 Oct 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c

removed r_shadow_deferred_8bitrange cvar

------------------------------------------------------------------------
r11495 | havoc | 2011-10-31 00:01:42 -0700 (Mon, 31 Oct 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix r_shadow_deferred total breakage from r11146

------------------------------------------------------------------------
r11494 | havoc | 2011-10-30 23:52:07 -0700 (Sun, 30 Oct 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

fix dpmod shell casings spinning on the floor by disabling the
velocity-change-is-a-teleport logic in SV_PushEntity

------------------------------------------------------------------------
r11493 | havoc | 2011-10-30 23:14:49 -0700 (Sun, 30 Oct 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

cleaned up SV_Physics_Toss code to be more maintainable

------------------------------------------------------------------------
r11492 | havoc | 2011-10-30 17:42:04 -0700 (Sun, 30 Oct 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_textures.h
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_shared.c

added support for GL_EXT_packed_depth_stencil, this means that r_viewfbo
no longer breaks stencil shadows

------------------------------------------------------------------------
r11491 | havoc | 2011-10-29 20:04:21 -0700 (Sat, 29 Oct 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

fix compile error on OSX

------------------------------------------------------------------------
r11490 | havoc | 2011-10-29 19:57:02 -0700 (Sat, 29 Oct 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

fix two more C++ compile errors

------------------------------------------------------------------------
r11489 | havoc | 2011-10-29 19:55:30 -0700 (Sat, 29 Oct 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/hmac.c

fix C++ compile error

------------------------------------------------------------------------
r11488 | havoc | 2011-10-29 19:46:57 -0700 (Sat, 29 Oct 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix compile errors in D3D renderer (missing vabuf variable)

------------------------------------------------------------------------
r11487 | havoc | 2011-10-29 00:27:10 -0700 (Sat, 29 Oct 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/sv_phys.c

let traces hit sky by default, don't know why this wasn't in

------------------------------------------------------------------------
r11486 | havoc | 2011-10-29 00:10:46 -0700 (Sat, 29 Oct 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

allow .psk models to be loaded without a corresponding .psa file

------------------------------------------------------------------------
r11485 | havoc | 2011-10-29 00:09:52 -0700 (Sat, 29 Oct 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

less warning spew about non-existent frames in a model (developer_extra
is now checked) and also not warning about using a frame number on a
model with only one frame

------------------------------------------------------------------------
r11484 | havoc | 2011-10-27 14:07:34 -0700 (Thu, 27 Oct 2011) | 6 lines
Changed paths:
   M /trunk/darkplaces/shader_glsl.h
   M /trunk/darkplaces/shader_hlsl.h

added USEREFLECTCUBE case to MODE_GENERIC, this disables use of texture
alpha on the first texture so that the motion blur compositing works
properly regardless of accumulated framebuffer alpha
fix USEGAMMARAMPS in HLSL because it was using an undeclared
dp_texture2D macro

------------------------------------------------------------------------
r11483 | divverent | 2011-10-27 12:59:02 -0700 (Thu, 27 Oct 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_demo.c
   M /trunk/darkplaces/client.h

-demo and -capturedemo: don't quit if loading another demo, only quit when no more demos are started
------------------------------------------------------------------------
r11482 | divverent | 2011-10-27 03:38:35 -0700 (Thu, 27 Oct 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/crypto.c

rename some functions to avoid a name conflict
------------------------------------------------------------------------
r11481 | divverent | 2011-10-27 00:08:50 -0700 (Thu, 27 Oct 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/libcurl.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/sv_main.c

framegroups: add support for group names specified as // comment
------------------------------------------------------------------------
r11480 | havoc | 2011-10-26 15:57:31 -0700 (Wed, 26 Oct 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/vid_shared.c

vid_soft_threads 8 by default because excessive threads doesn't hurt
low-core cpus very much and this helps high-core cpus a lot

------------------------------------------------------------------------
r11479 | divverent | 2011-10-26 02:07:21 -0700 (Wed, 26 Oct 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sys.h
   M /trunk/darkplaces/sys_shared.c

Linux dedicated server: set nice -19 while spawning server (can be turned off by -nonice option)
------------------------------------------------------------------------
r11478 | havoc | 2011-10-25 16:18:48 -0700 (Tue, 25 Oct 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/thread.h
   M /trunk/darkplaces/thread_null.c
   M /trunk/darkplaces/thread_pthread.c
   M /trunk/darkplaces/thread_sdl.c
   M /trunk/darkplaces/thread_win.c

thread_pthread now uses recursive mutex (THREADRECURSIVE)
THREADDEBUG now prints about all Thread_ functions except
Init/Shutdown/HasThreads

------------------------------------------------------------------------
r11477 | havoc | 2011-10-25 16:17:37 -0700 (Tue, 25 Oct 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/cd_null.c
   M /trunk/darkplaces/vid_null.c

fix warnings

------------------------------------------------------------------------
r11476 | divverent | 2011-10-25 13:39:27 -0700 (Tue, 25 Oct 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

as realtime no longer suffices to detect same frame, change the "same frame" logic for entity reallocating for the first few sec to mean "within 0.1 seconds".
------------------------------------------------------------------------
r11475 | divverent | 2011-10-25 13:39:24 -0700 (Tue, 25 Oct 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

fix a bug regarding entity reuse
------------------------------------------------------------------------
r11474 | divverent | 2011-10-25 07:20:52 -0700 (Tue, 25 Oct 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/crypto.c

mutex support for d0_blind_id (requires current git build of the lib)
------------------------------------------------------------------------
r11473 | divverent | 2011-10-25 04:14:32 -0700 (Tue, 25 Oct 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/hmac.c

HMAC: remove static vars
------------------------------------------------------------------------
r11472 | havoc | 2011-10-25 03:02:57 -0700 (Tue, 25 Oct 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/cmd.h
   M /trunk/darkplaces/host.c

only lock the server mutex if executing commands

------------------------------------------------------------------------
r11471 | havoc | 2011-10-25 01:31:10 -0700 (Tue, 25 Oct 2011) | 7 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sys.h
   M /trunk/darkplaces/sys_shared.c
   M /trunk/darkplaces/thread_null.c
   M /trunk/darkplaces/thread_pthread.c
   M /trunk/darkplaces/thread_sdl.c
   M /trunk/darkplaces/thread_win.c
   M /trunk/darkplaces/vid_agl.c

added Sys_PrintfToTerminal function for convenience, this replaces
printf in a few places
changed SV_LockThreadMutex and SV_UnlockThreadMutex to macros so they
get the filename and line number for THREADDEBUG prints
fixed multiple recursive mutex locks in the console system so glx client
works again

------------------------------------------------------------------------
r11470 | havoc | 2011-10-24 19:14:17 -0700 (Mon, 24 Oct 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/thread.h
   M /trunk/darkplaces/thread_null.c
   M /trunk/darkplaces/thread_pthread.c
   M /trunk/darkplaces/thread_sdl.c
   M /trunk/darkplaces/thread_win.c

added debug prints (enabled if you define THREADDEBUG) for debugging
mutex locks

------------------------------------------------------------------------
r11469 | havoc | 2011-10-24 18:15:25 -0700 (Mon, 24 Oct 2011) | 5 lines
Changed paths:
   M /trunk/darkplaces/keysym2ucs.c
   M /trunk/darkplaces/vid_glx.c

stupid hack - declare a prototype for keysym2ucs to suppress the
prototype warning, this is being done only because it is not worth
having a keysym2ucs.h file and the keysym2ucs.c file claims to be
auto-generated...

------------------------------------------------------------------------
r11468 | havoc | 2011-10-24 02:42:37 -0700 (Mon, 24 Oct 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/collision.c

fix Collision_ClipTrace_Line_Sphere calculation of impactdist (had a
discussion about this previously but forgot the solution, now reminded)

------------------------------------------------------------------------
r11467 | havoc | 2011-10-23 15:52:27 -0700 (Sun, 23 Oct 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/zone.c

move the mutex creation to after the memory pool is created

------------------------------------------------------------------------
r11466 | havoc | 2011-10-23 15:52:12 -0700 (Sun, 23 Oct 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c

added USEDGA define, disabled by default, to suppress the xf86dga.h
deprecated warnings by not using the dga code anymore

------------------------------------------------------------------------
r11465 | divverent | 2011-10-23 12:08:42 -0700 (Sun, 23 Oct 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/vid_glx.c

fix compile errors in vid_glx.c
------------------------------------------------------------------------
r11464 | divverent | 2011-10-23 08:53:12 -0700 (Sun, 23 Oct 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_particles.c

fix a sRGB conversion in effectinfo handling
------------------------------------------------------------------------
r11463 | havoc | 2011-10-22 16:52:58 -0700 (Sat, 22 Oct 2011) | 11 lines
Changed paths:
   M /trunk/darkplaces/cap_avi.c
   M /trunk/darkplaces/cap_ogg.c
   M /trunk/darkplaces/cd_shared.c
   M /trunk/darkplaces/cdaudio.h
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/cl_demo.c
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/cl_video_jamdecode.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/clvm_cmds.h
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/cmd.h
   M /trunk/darkplaces/collision.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/console.h
   M /trunk/darkplaces/crypto.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/csprogs.h
   M /trunk/darkplaces/curves.c
   M /trunk/darkplaces/cvar.c
   M /trunk/darkplaces/dpsoftrast.c
   M /trunk/darkplaces/dpvsimpledecode.c
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/fs.h
   M /trunk/darkplaces/ft2.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/image_png.c
   M /trunk/darkplaces/jpeg.c
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/keys.h
   M /trunk/darkplaces/lhnet.c
   M /trunk/darkplaces/lhnet.h
   M /trunk/darkplaces/libcurl.c
   M /trunk/darkplaces/libcurl.h
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/mathlib.h
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/menu.h
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_sprite.c
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/netconn.h
   M /trunk/darkplaces/palette.c
   M /trunk/darkplaces/portals.c
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/prvm_exec.c
   M /trunk/darkplaces/prvm_execprogram.h
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/r_lightning.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/r_sprites.c
   M /trunk/darkplaces/r_textures.h
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/sbar.c
   M /trunk/darkplaces/sbar.h
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_mix.c
   M /trunk/darkplaces/sound.h
   M /trunk/darkplaces/sv_demo.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_move.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sv_user.c
   M /trunk/darkplaces/svvm_cmds.c
   M /trunk/darkplaces/sys.h
   M /trunk/darkplaces/sys_shared.c
   M /trunk/darkplaces/timing.h
   M /trunk/darkplaces/utf8lib.c
   M /trunk/darkplaces/utf8lib.h
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/view.c
   M /trunk/darkplaces/world.c
   M /trunk/darkplaces/world.h
   M /trunk/darkplaces/zone.c

major overhaul for thread-safety - many global variables and static
buffers eliminated, this causes MANY changes, such as va() taking a
buffer, prog variable has to be passed as parameter to every PRVM
function, and many other edits of that nature.
realtime is now the only linearly increasing time stamp in the engine,
Sys_DoubleTime replaced by Sys_DirtyTime which requires sanity checks in
every use, but ensures thread-safe behavior
added -Wmissing-prototypes to makefile so that no one will ever put an
extern function prototype in a .c file again, this was necessary to
clean up crashes where prototype parameters differed.

------------------------------------------------------------------------
r11462 | havoc | 2011-10-22 15:28:04 -0700 (Sat, 22 Oct 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

use checkdisk flag on model loading after ingame download, this should
eliminate the need for r_restart

------------------------------------------------------------------------
r11461 | divverent | 2011-10-22 09:00:16 -0700 (Sat, 22 Oct 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/model_brush.c

fix factors in sRGBlightmaps code
------------------------------------------------------------------------
r11460 | divverent | 2011-10-22 08:28:56 -0700 (Sat, 22 Oct 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/image.h

fix image loading sRGB conversion
------------------------------------------------------------------------
r11459 | divverent | 2011-10-22 08:08:47 -0700 (Sat, 22 Oct 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/image.h
   M /trunk/darkplaces/vid_shared.c

more sRGB simplification
------------------------------------------------------------------------
r11458 | divverent | 2011-10-22 07:19:37 -0700 (Sat, 22 Oct 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/image.h

a harmless sRGB simplification, more to be done later
------------------------------------------------------------------------
r11457 | havoc | 2011-10-21 17:01:07 -0700 (Fri, 21 Oct 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

don't crash when .clientcamera is set on a botclient

------------------------------------------------------------------------
r11456 | divverent | 2011-10-21 04:09:48 -0700 (Fri, 21 Oct 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/vid_shared.c

use the correct sRGB conversion for the gamma ramps
------------------------------------------------------------------------
r11455 | divverent | 2011-10-21 03:23:12 -0700 (Fri, 21 Oct 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/image.h

fix another typo in sRGB conversion
------------------------------------------------------------------------
r11454 | divverent | 2011-10-21 03:12:43 -0700 (Fri, 21 Oct 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/image.h

make sRGB conversions match entirely with GL_EXT_texture_sRGB spec
------------------------------------------------------------------------
r11453 | divverent | 2011-10-21 02:59:59 -0700 (Fri, 21 Oct 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/model_brush.c

option: mod_q3bsp_sRGBlightmaps (experimental)
------------------------------------------------------------------------
r11452 | divverent | 2011-10-20 21:41:30 -0700 (Thu, 20 Oct 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/vid_shared.c

vid_sRGB_fallback: now 3 is unconditional, and 2 also falls back if framebuffer is 8bit (I know this detection breaks when toggling r_viewfbo at runtime, don't care, people shall do vid_restart)
------------------------------------------------------------------------
r11451 | divverent | 2011-10-20 10:40:37 -0700 (Thu, 20 Oct 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/vid_shared.c

make the sRGB fallback cvar controlled (and off by default)
------------------------------------------------------------------------
r11450 | divverent | 2011-10-20 10:40:36 -0700 (Thu, 20 Oct 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_textures.c

fix parts of the sRGB emulation
------------------------------------------------------------------------
r11449 | divverent | 2011-10-20 10:40:34 -0700 (Thu, 20 Oct 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/r_textures.h

sRGB: also handle sRGB for loading DDS textures
------------------------------------------------------------------------
r11448 | divverent | 2011-10-20 10:40:31 -0700 (Thu, 20 Oct 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/image.h
   M /trunk/darkplaces/model_brush.c

sRGB: also convert vertex colors
------------------------------------------------------------------------
r11447 | divverent | 2011-10-20 10:40:30 -0700 (Thu, 20 Oct 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/image.h
   M /trunk/darkplaces/model_brush.c

rename the function
------------------------------------------------------------------------
r11446 | divverent | 2011-10-20 10:40:28 -0700 (Thu, 20 Oct 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/image.h
   M /trunk/darkplaces/model_brush.c

convert lightmaps to sRGB for nice sRGB support
------------------------------------------------------------------------
r11445 | divverent | 2011-10-19 00:33:08 -0700 (Wed, 19 Oct 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix a compile error in recent bloom changes
------------------------------------------------------------------------
r11444 | eihrul | 2011-10-18 00:56:03 -0700 (Tue, 18 Oct 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

make R_SetupView take view size from fbo textures if available

------------------------------------------------------------------------
r11443 | eihrul | 2011-10-18 00:14:43 -0700 (Tue, 18 Oct 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

fix fbo var name bug in R_DrawModelShadowMaps

------------------------------------------------------------------------
r11442 | divverent | 2011-10-18 00:00:38 -0700 (Tue, 18 Oct 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/vid_sdl.c

fix one C++ compile error. It looks like we have no more wrong declaration of function issues, as C++ name mangling should have detected them.
------------------------------------------------------------------------
r11441 | divverent | 2011-10-17 23:58:29 -0700 (Mon, 17 Oct 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.h

move these declarations to where they belong
------------------------------------------------------------------------
r11440 | eihrul | 2011-10-17 23:52:23 -0700 (Mon, 17 Oct 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix R_DrawModelShadows/R_DrawModelShadowMaps prototypes not matching definitions

------------------------------------------------------------------------
r11439 | havoc | 2011-10-17 10:19:28 -0700 (Mon, 17 Oct 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_sprite.c

fix more crashes to do with animscenes being NULL on some models,
audited all the isanimated lines

------------------------------------------------------------------------
r11438 | havoc | 2011-10-17 10:07:41 -0700 (Mon, 17 Oct 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/cvar.c
   M /trunk/darkplaces/sv_main.c

added sv_disablenotify cvar (default 1) to suppress prints about
CVAR_NOTIFY cvars changing

------------------------------------------------------------------------
r11437 | havoc | 2011-10-17 10:02:52 -0700 (Mon, 17 Oct 2011) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_demo.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/cmd.h
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_user.c
   M /trunk/darkplaces/svvm_cmds.c
   M /trunk/darkplaces/vid_wgl.c
   M /trunk/darkplaces/zone.c

added sv_threaded cvar, the server can now be moved to another thread
and execute in parallel with the client code
THIS IS EXPERIMENTAL AND MAY CRASH IF USED
this required adding mutex's to many subsystems...

------------------------------------------------------------------------
r11436 | havoc | 2011-10-17 10:00:10 -0700 (Mon, 17 Oct 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/cl_collision.h
   M /trunk/darkplaces/collision.c
   M /trunk/darkplaces/collision.h
   M /trunk/darkplaces/r_shadow.c

reworked collision cache to only be used by bouncegrid and only in
dynamic mode (static mode no longer causes several heart attacks in the
collision cache as it executes many times the regular amount of traces)

------------------------------------------------------------------------
r11435 | havoc | 2011-10-17 05:02:53 -0700 (Mon, 17 Oct 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/sys_sdl.c

allow terminal input on sdl client as well (glx client already does)

------------------------------------------------------------------------
r11434 | havoc | 2011-10-17 04:16:53 -0700 (Mon, 17 Oct 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

init/shutdown thread system in dedicated server as well

------------------------------------------------------------------------
r11433 | divverent | 2011-10-17 04:07:20 -0700 (Mon, 17 Oct 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/host.c

new cvar: cl_maxphysicsframesperserverframe
------------------------------------------------------------------------
r11432 | havoc | 2011-10-16 11:26:06 -0700 (Sun, 16 Oct 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

fix byte color handling in iqm loader

------------------------------------------------------------------------
r11431 | divverent | 2011-10-16 07:17:50 -0700 (Sun, 16 Oct 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/vid_shared.c

properly detect vid.samples value if overridden by driver
------------------------------------------------------------------------
r11430 | havoc | 2011-10-16 06:50:53 -0700 (Sun, 16 Oct 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/vid_shared.c

if vid_samples is > 1 then do not use fbo view or water renders

------------------------------------------------------------------------
r11429 | havoc | 2011-10-16 05:49:59 -0700 (Sun, 16 Oct 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/render.h

fix motionblur with r_viewfbo 2 or 3

------------------------------------------------------------------------
r11428 | divverent | 2011-10-16 05:39:10 -0700 (Sun, 16 Oct 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/vid_shared.c

for now, turn off FBO if multisampling as their combination is not implemented yet
------------------------------------------------------------------------
r11427 | havoc | 2011-10-16 02:57:08 -0700 (Sun, 16 Oct 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

added r_water_fbo cvar to enable fbo rendering of water by default
regardless of r_viewfbo

------------------------------------------------------------------------
r11426 | havoc | 2011-10-16 02:54:40 -0700 (Sun, 16 Oct 2011) | 5 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/render.h

removed cvars r_hdr and r_hdr_range - now the only way to get HDR
rendering is using r_viewfbo 2 (which is faster and nicer)
implemented fbo rendering for water, bloom and gamma, setting r_viewfbo
to 1 gives a consistent speed gain because it avoids all texture copies

------------------------------------------------------------------------
r11425 | havoc | 2011-10-16 02:38:54 -0700 (Sun, 16 Oct 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h
   M /trunk/darkplaces/render.h

overhauling a lot of functions to allow fbo rendering

------------------------------------------------------------------------
r11424 | havoc | 2011-10-16 02:11:52 -0700 (Sun, 16 Oct 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_sprites.c
   M /trunk/darkplaces/render.h

renamed r_bloomstate to r_fb because it contains framebuffer settings
moved r_waterstate to r_fb.water

------------------------------------------------------------------------
r11423 | havoc | 2011-10-16 01:55:06 -0700 (Sun, 16 Oct 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

oops, missed this

------------------------------------------------------------------------
r11422 | havoc | 2011-10-16 01:50:13 -0700 (Sun, 16 Oct 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/render.h

added cvar r_water_hideplayer with 3 possible values (can hide from
nothing, refraction, or refraction and reflection)
renamed r_waterstate.renderingrefraction to r_waterstate.hideplayer

------------------------------------------------------------------------
r11421 | divverent | 2011-10-15 14:07:33 -0700 (Sat, 15 Oct 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/libcurl.c

curl: change how failure/success is decided to prevent "black screen" problems if an unrelated download 404s
------------------------------------------------------------------------
r11420 | havoc | 2011-10-14 18:53:30 -0700 (Fri, 14 Oct 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

fix crashes in viewthing code

------------------------------------------------------------------------
r11419 | havoc | 2011-10-14 17:19:54 -0700 (Fri, 14 Oct 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

fix two crashes that divVerent found and fixed but didn't commit

------------------------------------------------------------------------
r11418 | divverent | 2011-10-14 11:59:57 -0700 (Fri, 14 Oct 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/snd_mix.c

fix warning
------------------------------------------------------------------------
r11417 | divverent | 2011-10-14 11:59:55 -0700 (Fri, 14 Oct 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/snd_mix.c

add missing fabs
------------------------------------------------------------------------
r11416 | divverent | 2011-10-14 11:53:03 -0700 (Fri, 14 Oct 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/snd_mix.c

fix decay calculation in snd_softclip
------------------------------------------------------------------------
r11415 | divverent | 2011-10-14 11:48:59 -0700 (Fri, 14 Oct 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_mix.c

snd_maxchannelvolume and snd_softclip
------------------------------------------------------------------------
r11414 | divverent | 2011-10-14 10:41:41 -0700 (Fri, 14 Oct 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/snd_ogg.c

also support ReplayGain if peak is not defined
------------------------------------------------------------------------
r11413 | havoc | 2011-10-14 07:47:22 -0700 (Fri, 14 Oct 2011) | 2 lines
Changed paths:
   D /trunk/darkplaces/cl_gecko.c
   D /trunk/darkplaces/cl_gecko.h
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/makefile.inc
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.h
   M /trunk/darkplaces/prvm_offsets.h
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/svvm_cmds.c

removed OffscreenGecko support because it is not maintained

------------------------------------------------------------------------
r11412 | havoc | 2011-10-14 07:39:55 -0700 (Fri, 14 Oct 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

removed scr_zoomwindow feature to simplify code

------------------------------------------------------------------------
r11410 | havoc | 2011-10-14 07:34:03 -0700 (Fri, 14 Oct 2011) | 6 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/gl_rmain.c

fix bugs with CSQC clearscene function - it now restores the view to
what was given to CSQC_UpdateView in the first place
fix bugs with getpropertyvec(VF_FOV) - it reads view.ortho_x and y
values assuming they are the original angles, so these needed to be set
correctly by the engine before invoking CSQC_UpdateView

------------------------------------------------------------------------
r11409 | havoc | 2011-10-14 06:11:14 -0700 (Fri, 14 Oct 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpdefs/csprogsdefs.qc

added getproperty and getpropertyvec

------------------------------------------------------------------------
r11407 | havoc | 2011-10-14 02:52:32 -0700 (Fri, 14 Oct 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

use PRVM_serverfunction when looking up SV_ChangeTeam,
not PRVM_clientfunction (harmless but stupid)

------------------------------------------------------------------------
r11405 | havoc | 2011-10-14 01:28:45 -0700 (Fri, 14 Oct 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

fix crashes with last patch to model loaders
load vertex colors in iqm model format if they exist (can be accessed in
GLSL Shaders) 

------------------------------------------------------------------------
r11404 | havoc | 2011-10-13 23:18:08 -0700 (Thu, 13 Oct 2011) | 6 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

allow iqm models without geometry
allow iqm models without animation
compute model->surfmesh.isanimated and model->AnimateVertices in a
better way to make sure static models are identified as such (if bones
is 0 or 1, and no animation frames, treat as static)

------------------------------------------------------------------------
r11403 | havoc | 2011-10-12 05:10:26 -0700 (Wed, 12 Oct 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

moved surface culling code to a separate function, added a call to it in
the custompvs case (for water rendering), should be a good speedup

------------------------------------------------------------------------
r11402 | havoc | 2011-10-12 03:16:57 -0700 (Wed, 12 Oct 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/svvm_cmds.c
   M /trunk/darkplaces/world.c

added sv_areadebug cvar which disables the use of the areagrid (VERY bad
for performance, use ONLY for testing collision bugs)
added a small padding value (1 unit) to areagrid queries

------------------------------------------------------------------------
r11401 | havoc | 2011-10-12 03:14:02 -0700 (Wed, 12 Oct 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

added r_hdr_irisadaptation_radius which determines the area being
sampled for lighting to choose a scene brightness...  still a lousy
effect though

------------------------------------------------------------------------
r11400 | havoc | 2011-10-12 03:13:17 -0700 (Wed, 12 Oct 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

display scene brightness (r_refdef.view.colorscale) in r_speeds

------------------------------------------------------------------------
r11399 | havoc | 2011-10-12 01:18:30 -0700 (Wed, 12 Oct 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_null.c
   M /trunk/darkplaces/sound.h

removed S_StartSound_StartPosition function because it was unnecessary
make sure flags is passed correctly to CL_VM_Event_Sound and
S_StartSound_StartPosition_Flags

------------------------------------------------------------------------
r11398 | havoc | 2011-10-12 01:15:00 -0700 (Wed, 12 Oct 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c

added cvar sv_gameplayfix_bugfixedcheckwatertransition to allow the
contents bugfixes to be disabled if desired, improved contents handling
to prevent a splash sound on spawn

------------------------------------------------------------------------
r11397 | divverent | 2011-10-10 03:24:53 -0700 (Mon, 10 Oct 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_input.c

cl_movement: hit CSQC entities if solid (rationale: if you don't want this in your mod, don't make the ents solid, virtually nothing else cares for that!); the TracePoint calls used for checking if you are in water are NOT changed by this, as they also do not hit networkplayers and CSQC may have solid network players
------------------------------------------------------------------------
r11396 | divverent | 2011-10-09 06:37:43 -0700 (Sun, 09 Oct 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/snd_main.c

add cvars: snd_attenuation_exponent, snd_attenuation_decibel
------------------------------------------------------------------------
r11395 | divverent | 2011-10-09 05:29:49 -0700 (Sun, 09 Oct 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/snd_mix.c

improve logic for silent sound cutoff based on output buffer width
------------------------------------------------------------------------
r11394 | divverent | 2011-10-08 11:12:33 -0700 (Sat, 08 Oct 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/snd_main.c

add a TODO comment about sound falloff curve, needs research
------------------------------------------------------------------------
r11393 | divverent | 2011-10-08 10:57:23 -0700 (Sat, 08 Oct 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/snd_mix.c

sound mixing: PROPERLY detect silent sounds. Old code would cut off sounds at -15dB already.
------------------------------------------------------------------------
r11392 | divverent | 2011-10-04 04:24:07 -0700 (Tue, 04 Oct 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/netconn.h
   M /trunk/darkplaces/quakedef.h

server list: allow more AND and OR masks (except in DP_SMALLMEMORY profile)
------------------------------------------------------------------------
r11391 | divverent | 2011-10-04 00:42:50 -0700 (Tue, 04 Oct 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/snd_main.c

if the two mtimes are identical, also use the max interval as it's better to have this randomization than to have none
------------------------------------------------------------------------
r11390 | divverent | 2011-10-04 00:35:39 -0700 (Tue, 04 Oct 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/snd_main.c

by default, skip start of the sound, don't delay (to match Quake)
------------------------------------------------------------------------
r11389 | divverent | 2011-10-04 00:35:35 -0700 (Tue, 04 Oct 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/snd_main.c

provide cvars to change identical sound randomization
------------------------------------------------------------------------
r11388 | divverent | 2011-10-04 00:35:30 -0700 (Tue, 04 Oct 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/snd_main.c

sound: when randomizing sound start times, check pitch (base speed) too
------------------------------------------------------------------------
r11385 | divverent | 2011-10-02 02:37:48 -0700 (Sun, 02 Oct 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

fix warnings I caused in a previous commit
------------------------------------------------------------------------
r11384 | divverent | 2011-10-01 08:04:36 -0700 (Sat, 01 Oct 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/dpdefs/dpextensions.qc

fix broken English
------------------------------------------------------------------------
r11383 | divverent | 2011-10-01 07:08:36 -0700 (Sat, 01 Oct 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/csprogs.c

CSQC_Event_Sound: pass pitch shift info; actually apply received pitch shift data
------------------------------------------------------------------------
r11382 | divverent | 2011-10-01 06:29:16 -0700 (Sat, 01 Oct 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/crypto.c
   M /trunk/darkplaces/crypto.h
   M /trunk/darkplaces/dpdefs/dpextensions.qc
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.h
   M /trunk/darkplaces/svvm_cmds.c

implement digest_hex()
------------------------------------------------------------------------
r11381 | divverent | 2011-10-01 06:29:14 -0700 (Sat, 01 Oct 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/dpdefs/dpextensions.qc

document DP_QC_DIGEST
------------------------------------------------------------------------
r11380 | divverent | 2011-10-01 06:29:12 -0700 (Sat, 01 Oct 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/dpdefs/dpextensions.qc

move crc16()
------------------------------------------------------------------------
r11379 | eihrul | 2011-09-30 19:01:07 -0700 (Fri, 30 Sep 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

fix crash when compiling shadowmaps for certain Q3BSP files with no faces

------------------------------------------------------------------------
r11378 | divverent | 2011-09-30 08:02:30 -0700 (Fri, 30 Sep 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/dpdefs/dpextensions.qc
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/svvm_cmds.c

oops, I hadn't document DP_QC_I18N back then... sorry for that
------------------------------------------------------------------------
r11377 | eihrul | 2011-09-30 07:05:06 -0700 (Fri, 30 Sep 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/mod_skeletal_animatevertices_generic.c
   M /trunk/darkplaces/mod_skeletal_animatevertices_sse.c
   M /trunk/darkplaces/model_alias.c

better fix for skeletal no-bones case

------------------------------------------------------------------------
r11376 | eihrul | 2011-09-30 07:00:19 -0700 (Fri, 30 Sep 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/mod_skeletal_animatevertices_generic.c
   M /trunk/darkplaces/mod_skeletal_animatevertices_sse.c
   M /trunk/darkplaces/model_alias.c

handle no-bones case for skeletal animation

------------------------------------------------------------------------
r11375 | havoc | 2011-09-27 22:05:35 -0700 (Tue, 27 Sep 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

round the pitchchange setting to the nearest value

------------------------------------------------------------------------
r11374 | havoc | 2011-09-27 21:46:59 -0700 (Tue, 27 Sep 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

fix another bug with sound pitchspeed parameter

------------------------------------------------------------------------
r11373 | havoc | 2011-09-27 21:43:41 -0700 (Tue, 27 Sep 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

write SND_SPEEDUSHORT4000 correctly

------------------------------------------------------------------------
r11372 | havoc | 2011-09-26 16:19:55 -0700 (Mon, 26 Sep 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/Darkplaces.app/Contents/Info.plist
   M /trunk/darkplaces/Darkplaces.app/Contents/Resources/English.lproj/InfoPlist.strings

Mac:
changed name from Darkplaces to DarkPlaces for consistency
changed launch script filename from darkplaces-sdl to darkplaces-osx-sdl

------------------------------------------------------------------------
r11371 | havoc | 2011-09-26 13:50:29 -0700 (Mon, 26 Sep 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

detect if items2 field was declared in the quakec rather than checking
if GAME_HIPNOTIC or GAME_ROGUE because that prevented existing quake
server mods from abusing the runes on the quake hud

------------------------------------------------------------------------
r11370 | havoc | 2011-09-26 09:00:20 -0700 (Mon, 26 Sep 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_mix.c

fix two warnings (both were bad but unlikely to cause issues)

------------------------------------------------------------------------
r11369 | divverent | 2011-09-25 21:56:31 -0700 (Sun, 25 Sep 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_textures.c

DDS: properly count miplevels for 1x1 textures too when DDS saving
------------------------------------------------------------------------
r11368 | vortex | 2011-09-24 19:08:56 -0700 (Sat, 24 Sep 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/dpdefs/dpextensions.qc
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/prvm_offsets.h
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/world.c

DP_PHYSICS_ODE: new SOLID_PHYSICS_CYLINDER. New "massofs" vector field (shifts center-of-mass from model center, replaces default 'center of mins/maxs' approach). New "friction" field. Contact friction = cvar:physics_ode_contact_mu * object1.friction * object2.friction.
------------------------------------------------------------------------
r11367 | divverent | 2011-09-24 08:37:28 -0700 (Sat, 24 Sep 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/dpdefs/dpextensions.qc
   M /trunk/darkplaces/svvm_cmds.c

export DP_SND_SOUND7_WIP2 (pitch shifting) to checkextension
------------------------------------------------------------------------
r11366 | vortex | 2011-09-24 08:35:49 -0700 (Sat, 24 Sep 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/dpdefs/csprogsdefs.qc
   M /trunk/darkplaces/prvm_offsets.h

CSQC Getlight - added globals:
  vector getlight_dir;
  vector getlight_ambient;
  vector getlight_diffuse;
------------------------------------------------------------------------
r11365 | havoc | 2011-09-23 09:43:52 -0700 (Fri, 23 Sep 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

if MATERIALFLAG_CUSTOMBLEND, clear MATERIALFLAG_ADD and
MATERIALFLAG_ALPHA, to prevent bugs where code checks those flags

------------------------------------------------------------------------
r11364 | divverent | 2011-09-21 05:19:06 -0700 (Wed, 21 Sep 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

prevent recursive invocation of loading screen

when loading the loading screen takes longer than 2 sec
------------------------------------------------------------------------
r11363 | divverent | 2011-09-19 04:52:52 -0700 (Mon, 19 Sep 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/cap_avi.c
   M /trunk/darkplaces/cap_ogg.c

video capture: add the missing 32768.0f factor
------------------------------------------------------------------------
r11362 | divverent | 2011-09-17 22:46:17 -0700 (Sat, 17 Sep 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/cvar.c

cvar saving robustness

Don't match cvars that are equal to their default but not locked if they are
engine cvars. Fixes config value reverting on "invalid basedir".
------------------------------------------------------------------------
r11361 | havoc | 2011-09-17 19:45:26 -0700 (Sat, 17 Sep 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c

fix watershader on entities

------------------------------------------------------------------------
r11360 | havoc | 2011-09-16 20:23:29 -0700 (Fri, 16 Sep 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

avoid crashes on watershader surfaces in models that are off-screen (yet
somehow marked visible)

------------------------------------------------------------------------
r11359 | havoc | 2011-09-16 04:16:59 -0700 (Fri, 16 Sep 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

tighten the tolerances on water plane merging

------------------------------------------------------------------------
r11358 | havoc | 2011-09-16 04:09:13 -0700 (Fri, 16 Sep 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

transform surface vertices to worldspace before calculating waterplane

------------------------------------------------------------------------
r11357 | havoc | 2011-09-16 03:54:11 -0700 (Fri, 16 Sep 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_alias.c

fix issues with watershader on models, also now supports deformvertexes
fix issues with sky shaders on models (untested)

------------------------------------------------------------------------
r11356 | havoc | 2011-09-16 03:30:44 -0700 (Fri, 16 Sep 2011) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

added scr_screenshot_timestamp cvar which defaults on, this changes the
screenshot numbering scheme to use a time-based numbering system (while
still scanning for available filenames when you take multiple in one
second)

------------------------------------------------------------------------
r11355 | havoc | 2011-09-16 01:56:11 -0700 (Fri, 16 Sep 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/svvm_cmds.c

added network protocol for sound speed
(ushort speed*4000, not compatible with FTEQW, different flag)
added optional pitchchange parameter to pointsound

------------------------------------------------------------------------
r11354 | havoc | 2011-09-16 01:19:12 -0700 (Fri, 16 Sep 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_mix.c

fixed multiple crashes and infinite loops in sound mixer
reworked channel delay (negative position) to work properly

------------------------------------------------------------------------
r11353 | divverent | 2011-09-15 21:47:01 -0700 (Thu, 15 Sep 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

CSQC: support the sound pitch shift arg (NOT in SVQC yet)
------------------------------------------------------------------------
r11352 | havoc | 2011-09-15 12:12:19 -0700 (Thu, 15 Sep 2011) | 7 lines
Changed paths:
   M /trunk/darkplaces/cd_shared.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_main.h
   M /trunk/darkplaces/snd_mem.c
   M /trunk/darkplaces/snd_mix.c
   M /trunk/darkplaces/snd_modplug.c
   M /trunk/darkplaces/snd_null.c
   M /trunk/darkplaces/snd_ogg.c
   M /trunk/darkplaces/snd_wav.c
   M /trunk/darkplaces/sound.h

sound mixer now operates on floating point, has on-the-fly resampling
(allows features like pitch shifting, and potentially doppler), and the
ogg and modplug streaming code has been largely rewritten, much cleaner
now, this saves about 4MB of ram when playing quake content at default
settings (by not resampling the wav data to 48khz anymore), snd_speed
changes will now apply to next vid_restart (tested at 48, 96, 192khz)

------------------------------------------------------------------------
r11351 | havoc | 2011-09-15 11:30:38 -0700 (Thu, 15 Sep 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c

register the snd_streaming_length cvar

------------------------------------------------------------------------
r11350 | divverent | 2011-09-14 05:39:39 -0700 (Wed, 14 Sep 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/libcurl.c

fix a crash on CentOS 5.6
------------------------------------------------------------------------
r11349 | divverent | 2011-09-14 02:19:08 -0700 (Wed, 14 Sep 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_main.h
   M /trunk/darkplaces/snd_ogg.c

new cvar: snd_streaming_length ("don't stream sound files below this length")
------------------------------------------------------------------------
r11348 | havoc | 2011-09-13 17:42:26 -0700 (Tue, 13 Sep 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/common.c

changed executable name detection to ignore path
changed GAME_SONOFMAN name detection to use sonofman instead of som as
this was causing game detection bugs

------------------------------------------------------------------------
r11347 | eihrul | 2011-09-13 09:52:33 -0700 (Tue, 13 Sep 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/shader_glsl.h
   M /trunk/darkplaces/shader_hlsl.h

slightly better non-VSDCT shadowmap code

------------------------------------------------------------------------
r11346 | eihrul | 2011-09-12 19:30:52 -0700 (Mon, 12 Sep 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/shader_glsl.h

abstracted texture2DOffset usage to work around GLSL 130 deprecation warnings

------------------------------------------------------------------------
r11345 | eihrul | 2011-09-12 19:17:47 -0700 (Mon, 12 Sep 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix error with unused ClientTime reference

------------------------------------------------------------------------
r11344 | vortex | 2011-09-12 09:53:12 -0700 (Mon, 12 Sep 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/csprogs.h
   M /trunk/darkplaces/dpdefs/csprogsdefs.qc
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/meshqueue.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/prvm_offsets.h
   M /trunk/darkplaces/svvm_cmds.c

Added DP_CSQC_ENTITYMODELLIGHT extension (CSQC-updated modellight using modellight_* fields). RF_NOCULL transformed to RF_WORLDOBJECT which gives maximal transparent sorting distance (and disables culling), making transparent RF_WORLDOBJECT order-dependent. This is still a hacky thing and can change in the future since whole concept of this flag is not good (it's a quick trick to solve bugs with rendering of really large sky objects).
------------------------------------------------------------------------
r11343 | eihrul | 2011-09-12 04:59:37 -0700 (Mon, 12 Sep 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/shader_glsl.h

slightly faster non-VSDCT GetShadowMapTC2D variant

------------------------------------------------------------------------
r11342 | eihrul | 2011-09-11 12:03:05 -0700 (Sun, 11 Sep 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/shader_glsl.h

fix fix for shadow sampler sampling

------------------------------------------------------------------------
r11341 | eihrul | 2011-09-11 11:44:47 -0700 (Sun, 11 Sep 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/shader_glsl.h

fix sampling of shadow2D results

------------------------------------------------------------------------
r11340 | divverent | 2011-09-11 05:55:33 -0700 (Sun, 11 Sep 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_input.c

clip velocity when detecting ground
------------------------------------------------------------------------
r11339 | divverent | 2011-09-11 05:55:30 -0700 (Sun, 11 Sep 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_input.c

more canjump fixes
------------------------------------------------------------------------
r11338 | divverent | 2011-09-10 14:00:50 -0700 (Sat, 10 Sep 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

fix another canjump tracking bug; STILL not good

(but now the canjump flags in the move queue LOOK consistent, which makes it odd now)
------------------------------------------------------------------------
r11337 | divverent | 2011-09-10 13:55:32 -0700 (Sat, 10 Sep 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_input.c

fix one bug in cl_movement_track_canjump. Still buggy.
------------------------------------------------------------------------
r11336 | divverent | 2011-09-09 04:22:49 -0700 (Fri, 09 Sep 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_input.c

add a FIXME comment regarding canjump, will check that later
------------------------------------------------------------------------
r11335 | divverent | 2011-09-08 11:01:01 -0700 (Thu, 08 Sep 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/snd_modplug.c

modplug. set total length to 1<<30 now, as anything higher causes Host_Error
------------------------------------------------------------------------
r11334 | havoc | 2011-09-07 18:47:20 -0700 (Wed, 07 Sep 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

changed D3D shader warning prints to dprints

------------------------------------------------------------------------
r11333 | divverent | 2011-09-06 22:36:18 -0700 (Tue, 06 Sep 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

simplify: just turn off rtlights on MATERIALFLAG_FULLBRIGHT, which is forced by customblend
------------------------------------------------------------------------
r11332 | havoc | 2011-09-06 21:12:30 -0700 (Tue, 06 Sep 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/shader_hlsl.h

initialize some variables differently in the HLSL shader to hush
warnings

------------------------------------------------------------------------
r11331 | havoc | 2011-09-06 15:37:47 -0700 (Tue, 06 Sep 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

fix a C++ error introduced when ddspixels was used as a memcpy target

------------------------------------------------------------------------
r11330 | divverent | 2011-09-06 12:27:58 -0700 (Tue, 06 Sep 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

blendfunc addalpha

shorthand for GL_SRC_ALPHA GL_ONE
------------------------------------------------------------------------
r11329 | divverent | 2011-09-06 12:26:01 -0700 (Tue, 06 Sep 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c

mod_q3shader_force_addalpha (default 0)

treat GL_ONE GL_ONE (or add) blendfunc as GL_SRC_ALPHA GL_ONE for compatibility with older DarkPlaces releases
------------------------------------------------------------------------
r11328 | divverent | 2011-09-06 10:26:54 -0700 (Tue, 06 Sep 2011) | 5 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

now that DDS loading is consistent with RGBA loading again, let's properly set TEXF_ALPHA _only_ if the blendfunc uses alpha

THIS BREAKS blendfunc add WITH ALPHA CHANNEL, AS THE ALPHA CHANNEL IS NOW PROPERLY IGNORED.

Use blendfunc GL_SRC_ALPHA GL_ONE if you want to add with alpha channel!
------------------------------------------------------------------------
r11327 | divverent | 2011-09-06 10:26:51 -0700 (Tue, 06 Sep 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_textures.c

DDS support: convert DXT3/DXT5 to DXT1 when requesting non-alpha (correctness)
------------------------------------------------------------------------
r11326 | divverent | 2011-09-06 10:02:34 -0700 (Tue, 06 Sep 2011) | 8 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_shared.c

fix interaction of blendfunc with rtlights

basically, we exclude a number of CUSTOMBLEND blendfuncs from receiving rtlights
the rationale is not that doing this is always correct - it is not in some
cases (e.g. for crazy stuff like GL_ONE GL_SRC_COLOR). The rationale is that
the current behaviour for these is wrong too.

All surfaces that now receive rtlights, receive it correctly.
------------------------------------------------------------------------
r11325 | divverent | 2011-09-06 10:02:29 -0700 (Tue, 06 Sep 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

Revert "disable divVerent's texflags hack for now because it is breaking"

This reverts commit b8d8e2759007ef43aa26459b0a2f5fd3ae4394b0.
------------------------------------------------------------------------
r11324 | havoc | 2011-09-05 16:49:16 -0700 (Mon, 05 Sep 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

disable divVerent's texflags hack for now because it is breaking
steelstorm's light interactions with transparent materials, until this
issue can be investigated properly this code will be disabled

------------------------------------------------------------------------
r11323 | divverent | 2011-09-03 13:13:16 -0700 (Sat, 03 Sep 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

showtex 1

shows the texture on crosshair (only world and SOLID_BSP surfaces)
------------------------------------------------------------------------
r11322 | divverent | 2011-09-03 08:06:21 -0700 (Sat, 03 Sep 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/r_textures.h

disable offsetmapping where TEXF_ALPHA is not set and no height bias exists
------------------------------------------------------------------------
r11321 | divverent | 2011-09-02 14:09:25 -0700 (Fri, 02 Sep 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/keys.c

add -noconsole option to block console input and display
------------------------------------------------------------------------
r11320 | divverent | 2011-09-02 13:24:31 -0700 (Fri, 02 Sep 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/model_shared.c

also set TEXF_ALPHA on GL_ONE GL_ONE (don't ask)
------------------------------------------------------------------------
r11319 | divverent | 2011-09-02 11:25:53 -0700 (Fri, 02 Sep 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

enable offsetmapping permutations only if a normalmap exists and no bias is set
------------------------------------------------------------------------
r11318 | divverent | 2011-09-01 11:26:25 -0700 (Thu, 01 Sep 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/shader_glsl.h
   M /trunk/darkplaces/shader_hlsl.h

change how offsetmapping bias works for less artifacts in offsetmapping mode
------------------------------------------------------------------------
r11317 | divverent | 2011-09-01 00:49:18 -0700 (Thu, 01 Sep 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/model_shared.c

fix parameter number
------------------------------------------------------------------------
r11316 | divverent | 2011-09-01 00:09:19 -0700 (Thu, 01 Sep 2011) | 6 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

change to offsetmapping syntax:

dpoffsetmapping - SCALE bias BIASVALUE
dpoffsetmapping - SCALE match FLOAT_PIXEL_VALUE_THAT_IS_BASE_LEVEL
dpoffsetmapping - SCALE match8 8BIT_PIXEL_VALUE_THAT_IS_BASE_LEVEL
dpoffsetmapping - SCALE match16 16BIT_PIXEL_VALUE_THAT_IS_BASE_LEVEL
------------------------------------------------------------------------
r11315 | divverent | 2011-08-30 22:42:35 -0700 (Tue, 30 Aug 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/fs.c

on Unix, avoid actually creating config.cfg when testing gamedirs

We can use access() with W_OK | X_OK on the directory instead there
------------------------------------------------------------------------
r11314 | divverent | 2011-08-30 07:55:33 -0700 (Tue, 30 Aug 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix a typo causing compile error
------------------------------------------------------------------------
r11313 | divverent | 2011-08-30 06:14:55 -0700 (Tue, 30 Aug 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/model_shared.h

fix another data loss type conversion
------------------------------------------------------------------------
r11312 | divverent | 2011-08-30 05:10:35 -0700 (Tue, 30 Aug 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h

offsetbias: changed range to 0..1 to match what the shader does

(agreed to with LordHavoc)
------------------------------------------------------------------------
r11311 | divverent | 2011-08-29 13:23:09 -0700 (Mon, 29 Aug 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

make offsetmapping bias actually work

(integer division -> float division)
------------------------------------------------------------------------
r11310 | divverent | 2011-08-29 13:20:38 -0700 (Mon, 29 Aug 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/model_shared.c

set TEXF_ALPHA on shader stages only if necessary
------------------------------------------------------------------------
r11309 | vortex | 2011-08-29 12:35:03 -0700 (Mon, 29 Aug 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/dpsoftrast.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/model_sprite.c
   M /trunk/darkplaces/shader_glsl.h
   M /trunk/darkplaces/shader_hlsl.h

Offsetmapping: new "Bias" parameter that sets a custom "null point" instead of always having fixed one (at white), set as 0-255 byte additional "dpoffsetmapping" parm (dpoffsetmapping <technic> <scale> <bias>) a value of 128 makes offsetmapping centered at gray (no effect at gray, black is positive offset, white is negative). Additinally "dpoffsetmapping disabled" now parsed correctly. To see difference of offsetmapping bias see this shot (animated): http://omnicide.legacy-of-kain.ru/work/omnicide000137.gif
------------------------------------------------------------------------
r11308 | divverent | 2011-08-29 12:23:31 -0700 (Mon, 29 Aug 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

add missing TEXF_ALPHA when loading the glossmap
------------------------------------------------------------------------
r11307 | divverent | 2011-08-29 12:08:36 -0700 (Mon, 29 Aug 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/shader_glsl.h
   M /trunk/darkplaces/shader_hlsl.h

gloss: exact specular math has min gloss exponent 4, not 1

this is because both yield to "internal exponent" 1, because exactspecularmath has to divide the exponent by 4 to look the same
------------------------------------------------------------------------
r11306 | divverent | 2011-08-29 08:23:33 -0700 (Mon, 29 Aug 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/shader_glsl.h
   M /trunk/darkplaces/shader_hlsl.h

make sure another way it never calculates 0^0

we now avoid too-small exponents instead (alpha 0 now is exponent 1, not 0)
------------------------------------------------------------------------
r11305 | divverent | 2011-08-29 07:02:58 -0700 (Mon, 29 Aug 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c
   M /trunk/darkplaces/shader_glsl.h
   M /trunk/darkplaces/shader_hlsl.h

make sure gloss never calculates 0^0

as that is undefined and leads to black stuff
------------------------------------------------------------------------
r11304 | divverent | 2011-08-27 12:00:18 -0700 (Sat, 27 Aug 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_textures.h

implement TEXF_FORCE_RELOAD to reload a pre-existing skinframe
------------------------------------------------------------------------
r11303 | divverent | 2011-08-27 11:52:13 -0700 (Sat, 27 Aug 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/draw.h
   M /trunk/darkplaces/gl_draw.c

fix cachepic handling with respect to r_restart and Draw_NewPic

Some forgotten memsets, and attempts to free the notexture, could wreak havoc
------------------------------------------------------------------------
r11302 | eihrul | 2011-08-24 05:52:15 -0700 (Wed, 24 Aug 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/vid_shared.c

fix bugs introduced by r11262

------------------------------------------------------------------------
r11301 | divverent | 2011-08-24 05:32:01 -0700 (Wed, 24 Aug 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/svn-eol-style-from-gitattributes.sh

this file needs eol-style too...

------------------------------------------------------------------------
r11300 | divverent | 2011-08-24 05:31:22 -0700 (Wed, 24 Aug 2011) | 2 lines
Changed paths:
   A /trunk/darkplaces/svn-eol-style-from-gitattributes.sh

add a script to automate svn:eol-style processing

------------------------------------------------------------------------
r11299 | divverent | 2011-08-24 05:31:09 -0700 (Wed, 24 Aug 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/Doxyfile
   M /trunk/darkplaces/Info.plist
   M /trunk/darkplaces/SDLMain.h
   M /trunk/darkplaces/SDLMain.m
   M /trunk/darkplaces/bih.c
   M /trunk/darkplaces/bih.h
   M /trunk/darkplaces/cap_avi.c
   M /trunk/darkplaces/cap_avi.h
   M /trunk/darkplaces/cap_ogg.c
   M /trunk/darkplaces/cap_ogg.h
   M /trunk/darkplaces/cl_dyntexture.c
   M /trunk/darkplaces/cl_dyntexture.h
   M /trunk/darkplaces/cl_gecko.h
   M /trunk/darkplaces/cl_video_jamdecode.c
   M /trunk/darkplaces/crypto-keygen-standalone-brute.sh
   M /trunk/darkplaces/crypto-keygen-standalone.c
   M /trunk/darkplaces/crypto.c
   M /trunk/darkplaces/crypto.h
   M /trunk/darkplaces/darkplaces-dedicated.dev
   M /trunk/darkplaces/darkplaces.dev
   M /trunk/darkplaces/darkplaces.rc
   M /trunk/darkplaces/darkplaces.txt
   M /trunk/darkplaces/darkplaces.xpm
   M /trunk/darkplaces/dpsoftrast.c
   M /trunk/darkplaces/dpsoftrast.h
   M /trunk/darkplaces/fogeval.pl
   M /trunk/darkplaces/ft2.c
   M /trunk/darkplaces/ft2.h
   M /trunk/darkplaces/ft2_defs.h
   M /trunk/darkplaces/ft2_fontdefs.h
   M /trunk/darkplaces/hmac.c
   M /trunk/darkplaces/hmac.h
   M /trunk/darkplaces/intoverflow.h
   M /trunk/darkplaces/keysym2ucs.c
   M /trunk/darkplaces/mod_skeletal_animatevertices_generic.c
   M /trunk/darkplaces/mod_skeletal_animatevertices_generic.h
   M /trunk/darkplaces/mod_skeletal_animatevertices_sse.c
   M /trunk/darkplaces/mod_skeletal_animatevertices_sse.h
   M /trunk/darkplaces/model_iqm.h
   M /trunk/darkplaces/nexuiz.xpm
   M /trunk/darkplaces/prvm_offsets.h
   M /trunk/darkplaces/shader_glsl.h
   M /trunk/darkplaces/shader_hlsl.h
   M /trunk/darkplaces/snd_3dras.c
   M /trunk/darkplaces/snd_3dras.h
   M /trunk/darkplaces/snd_3dras_typedefs.h
   M /trunk/darkplaces/snd_modplug.c
   M /trunk/darkplaces/snd_modplug.h
   M /trunk/darkplaces/sv_demo.c
   M /trunk/darkplaces/sv_demo.h
   M /trunk/darkplaces/thread.h
   M /trunk/darkplaces/thread_null.c
   M /trunk/darkplaces/thread_pthread.c
   M /trunk/darkplaces/thread_sdl.c
   M /trunk/darkplaces/thread_win.c
   M /trunk/darkplaces/utf8lib.c
   M /trunk/darkplaces/utf8lib.h

set svn:eol-style properties on new files

------------------------------------------------------------------------
r11298 | eihrul | 2011-08-24 04:47:00 -0700 (Wed, 24 Aug 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.h

add missing uniform

------------------------------------------------------------------------
r11297 | eihrul | 2011-08-24 03:55:28 -0700 (Wed, 24 Aug 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

fix crashing due to alignment

------------------------------------------------------------------------
r11296 | eihrul | 2011-08-24 03:51:39 -0700 (Wed, 24 Aug 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

ALIGNED_SIZE -> ALIGN_SIZE

------------------------------------------------------------------------
r11295 | eihrul | 2011-08-24 03:49:14 -0700 (Wed, 24 Aug 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

only need 4 byte alignment for atomicity

------------------------------------------------------------------------
r11294 | divverent | 2011-08-24 02:02:05 -0700 (Wed, 24 Aug 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/shader_glsl.h
   M /trunk/darkplaces/shader_hlsl.h

who's inserting CRLFs all the time
------------------------------------------------------------------------
r11293 | divverent | 2011-08-24 01:49:36 -0700 (Wed, 24 Aug 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/model_shared.c

big oops: fix C++ compilation (had used "operator" as variable name)
------------------------------------------------------------------------
r11292 | vortex | 2011-08-23 15:13:07 -0700 (Tue, 23 Aug 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/shader_glsl.h
   M /trunk/darkplaces/shader_hlsl.h

Experimental r_glsl_offsetmapping_lod cvar which applies a distance-based correction to number of offsetmapping steps, makes up to 40% fps boost on open area maps with lots of reliefmapped surfaces and no quality loss, gives about 5-10% on generic case (requires accurate tweaking for best results).
------------------------------------------------------------------------
r11291 | divverent | 2011-08-23 12:25:09 -0700 (Tue, 23 Aug 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/netconn.c

fix gameversion logic :(
------------------------------------------------------------------------
r11290 | divverent | 2011-08-23 06:59:15 -0700 (Tue, 23 Aug 2011) | 6 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

new cvar: r_sortentities to sort render edicts.

This is not as good as real surface batching across entities, but often about
equally good. Tends to gain about 1% on space maps or other "unvisable stuff".

Not active by default yet.
------------------------------------------------------------------------
r11289 | vortex | 2011-08-21 07:55:40 -0700 (Sun, 21 Aug 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/csprogs.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/meshqueue.c
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/svvm_cmds.c

2 new cvars: sv_gameplayfix_unstickentities and sv_gameplayfix_unstickplayers to enable/disable unsticking checks, added a couple of VF_ parms for csqc setview to control fog (so CSQC viewports can have different fog settings). Rearranged fog update (moved all update code from R_UpdateVariables to R_UpdateFog which is called for each viewport render), so can have different fog settings for several viewports. Added back cvar r_transparent_sortmindist.
------------------------------------------------------------------------
r11288 | divverent | 2011-08-20 09:46:20 -0700 (Sat, 20 Aug 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/sv_main.c

cvar: csqc_usedemoprogs

allows to use the file system csprogs.dat for demo playback, mainly useful
for debugging csqc issues that happen when playing back a demo
------------------------------------------------------------------------
r11287 | divverent | 2011-08-20 08:41:23 -0700 (Sat, 20 Aug 2011) | 23 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

dpshaderkill enhancements

"Kill" current shader:
dpshaderkillifcvar r_foo == 42
dpshaderkillifcvar r_foo != 42
dpshaderkillifcvar r_foo < 42
dpshaderkillifcvar r_foo > 42
dpshaderkillifcvar r_foo <= 42
dpshaderkillifcvar r_foo >= 42

"Un-kill" current shader (unsets the kill flag):
dpnoshaderkillifcvar r_foo == 42
dpnoshaderkillifcvar r_foo != 42
dpnoshaderkillifcvar r_foo < 42
dpnoshaderkillifcvar r_foo > 42
dpnoshaderkillifcvar r_foo <= 42
dpnoshaderkillifcvar r_foo >= 42

Also, shader override logic is modified so killed shaders can be used to make
alternatives, e.g. switching between two shader definitions based on cvars:
- killed shaders never override other shaders, but show no warning
- non-killed shaders override killed shaders
- non-killed shaders still do not override other non-killed shaders
------------------------------------------------------------------------
r11286 | havoc | 2011-08-20 06:29:21 -0700 (Sat, 20 Aug 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h

added dpshaderkillifcvar and dpshaderkillifcvarzero keywords for
shaders, their parameter is a custom cvar name of your choice

------------------------------------------------------------------------
r11285 | divverent | 2011-08-18 06:02:52 -0700 (Thu, 18 Aug 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/sys_shared.c

sys_usenoclockbutbenchmark: use double for the timer,

to run for more than 1h:11m simulated time
------------------------------------------------------------------------
r11284 | divverent | 2011-08-18 04:36:43 -0700 (Thu, 18 Aug 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/crypto.c

be more clear that the crypto_keys fingerprints are public
------------------------------------------------------------------------
r11283 | divverent | 2011-08-17 13:11:33 -0700 (Wed, 17 Aug 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

uri_post: make content type mandatory
------------------------------------------------------------------------
r11282 | divverent | 2011-08-17 00:42:33 -0700 (Wed, 17 Aug 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/console.c

allow extra args for messagemode and messagemode2 to prefill a message prefix

useful for quick team communication binds (e.g. putting "Get the flag," in the message, and using tab completion to fill in the name who should do it)
------------------------------------------------------------------------
r11281 | divverent | 2011-08-16 05:10:18 -0700 (Tue, 16 Aug 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/dpdefs/dpextensions.qc
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/svvm_cmds.c

MOVETYPE_FLY_WORLDONLY (movetype 33)

Can't explain here what it does, Captain Obvious would enjoy it too much.
------------------------------------------------------------------------
r11280 | havoc | 2011-08-16 05:04:15 -0700 (Tue, 16 Aug 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.c

allow drawpic calls without flag parameter, as per CSQC spec

------------------------------------------------------------------------
r11279 | havoc | 2011-08-16 05:01:11 -0700 (Tue, 16 Aug 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.c

allow calls to drawstring without the flag parameter, as per CSQC spec

------------------------------------------------------------------------
r11278 | havoc | 2011-08-16 04:56:43 -0700 (Tue, 16 Aug 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

expose R_SetView (aka setproperty) as builtin 309 as well (FTEQW's
getproperty builtin), this should be compatible

------------------------------------------------------------------------
r11277 | havoc | 2011-08-16 04:39:27 -0700 (Tue, 16 Aug 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/keys.c

implemented CSQC_InputEvent type 2 and type 3 mouse move events
added cl_csqc_generatemousemoveevents cvar to allow this to be disabled
based on gamemode (currently disabled in GAME_STEELSTORM due to csqc bugs)

------------------------------------------------------------------------
r11276 | havoc | 2011-08-16 04:34:12 -0700 (Tue, 16 Aug 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

fix MOVETYPE_FAKEPUSH (tenebrae movetype 13) implementation

------------------------------------------------------------------------
r11275 | havoc | 2011-08-16 01:19:35 -0700 (Tue, 16 Aug 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

don't draw bouncegrid on custom csqc scenes without drawworld

------------------------------------------------------------------------
r11274 | havoc | 2011-08-16 01:06:52 -0700 (Tue, 16 Aug 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/shader_glsl.h

fix GLSL shader error with directional bouncegrid and fog

------------------------------------------------------------------------
r11273 | divverent | 2011-08-14 11:40:27 -0700 (Sun, 14 Aug 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/cap_avi.c

fix a wrong variable name
------------------------------------------------------------------------
r11272 | divverent | 2011-08-14 07:50:49 -0700 (Sun, 14 Aug 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/cap_avi.c
   M /trunk/darkplaces/cap_ogg.c

fix support of odd heights in YUV conversion for video capture

(prevents a memory corruption there)
------------------------------------------------------------------------
r11271 | havoc | 2011-08-07 10:59:14 -0700 (Sun, 07 Aug 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/shader_glsl.h

added cast_half, cast_half2, cast_half3, cast_half4 macros to avoid
errors on the use of mediump when doing casts on GLES2

------------------------------------------------------------------------
r11270 | havoc | 2011-08-05 14:19:06 -0700 (Fri, 05 Aug 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

fix typos

------------------------------------------------------------------------
r11269 | havoc | 2011-08-05 14:13:08 -0700 (Fri, 05 Aug 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

don't depend on ptrdiff_t

------------------------------------------------------------------------
r11268 | havoc | 2011-08-05 09:56:43 -0700 (Fri, 05 Aug 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_sdl.c

we probably don't need to call SDL_GL_LoadLibrary on Maemo...

------------------------------------------------------------------------
r11267 | havoc | 2011-08-05 09:52:37 -0700 (Fri, 05 Aug 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_sdl.c

fix a couple compile issues affecting Maemo

------------------------------------------------------------------------
r11266 | havoc | 2011-08-03 13:57:40 -0700 (Wed, 03 Aug 2011) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/ft2.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/shader_glsl.h
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_shared.c

fix a pile of issues with calling conventions on GLES2 platforms by
directly calling the gl functions on these platforms, this required
quite an overhaul in the headers and a lot of code gets disabled if
USE_GLES2 to avoid referencing undefined constants and such...

------------------------------------------------------------------------
r11265 | divverent | 2011-08-03 06:34:47 -0700 (Wed, 03 Aug 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix an obvious crash in user controlled wave func handling
------------------------------------------------------------------------
r11264 | divverent | 2011-08-02 11:58:58 -0700 (Tue, 02 Aug 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/shader_glsl.h
   M /trunk/darkplaces/shader_hlsl.h

fix line feeds
------------------------------------------------------------------------
r11263 | divverent | 2011-08-02 11:58:57 -0700 (Tue, 02 Aug 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/keys.h

add a helper function to release all keys "properly"

(not used yet)
------------------------------------------------------------------------
r11262 | vortex | 2011-07-31 14:54:13 -0700 (Sun, 31 Jul 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/dpsoftrast.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/shader_glsl.h
   M /trunk/darkplaces/shader_hlsl.h
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/vid_shared.c

r_glsl_deluxemapping 2 support for vertexlit surfaces, deluxemap forced surfaces no longer use texture2d(deluxemap). Attempt to fix '2D pics GLSL gamma with sRGB', added v_glslgamma_2d (default 0). New "dprtlightambient" shader keyword which adds ambient rtlight to surface, useful on lowpoly harsh entities (like grass bushes) for smoother rtlightning. New trick: CSQC sound/pointsound plugins take "#sound_index" which can be returned by precache_sound.
------------------------------------------------------------------------
r11261 | vortex | 2011-07-30 20:47:41 -0700 (Sat, 30 Jul 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/dpdefs/dpextensions.qc
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/world.c

Lightmaps merging debug print ("copying original lightmap") now uses dprint. ODE: Add SOLID_PHYSICS_TRIMESH to replace SOLID_BSP as it has some bad hacks applied (like unstuck code). Added cvar physics_ode_world_gravitymod.
------------------------------------------------------------------------
r11260 | eihrul | 2011-07-29 06:22:43 -0700 (Fri, 29 Jul 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

removing more memcpys from IQM loading

------------------------------------------------------------------------
r11259 | eihrul | 2011-07-29 06:20:20 -0700 (Fri, 29 Jul 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

IQM loading fixes and optimizations

------------------------------------------------------------------------
r11258 | havoc | 2011-07-29 05:42:24 -0700 (Fri, 29 Jul 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

re-optimize the IQM model loader somewhat by not allocating and copying
any data that is read-only in nature (the endian functions are
unaligned-safe by nature)

------------------------------------------------------------------------
r11257 | havoc | 2011-07-29 02:38:36 -0700 (Fri, 29 Jul 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

reworked iqm model loader to copy all data into allocated memory blocks
at load to prevent misaligned memory crashes on Sparc, PowerPC, others

------------------------------------------------------------------------
r11256 | vortex | 2011-07-28 03:20:57 -0700 (Thu, 28 Jul 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/common.c

Quick fix on COM_ToLowerString/COM_ToUpperString to let them work right on null UTF8 strings.
------------------------------------------------------------------------
r11255 | vortex | 2011-07-27 13:30:34 -0700 (Wed, 27 Jul 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/zone.c

Fix savegame loading crash
------------------------------------------------------------------------
r11254 | divverent | 2011-07-27 07:14:56 -0700 (Wed, 27 Jul 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

SV_PushMove: no longer assume that just rotating the origin is correct

instead, do some nudge-out-of-solid like handling of the error
------------------------------------------------------------------------
r11253 | havoc | 2011-07-24 17:17:54 -0700 (Sun, 24 Jul 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

disable VorteX's gamma corrected 2D drawing because it is broken with
vid_sRGB 1, the patch needs more work before it will be used

------------------------------------------------------------------------
r11252 | vortex | 2011-07-24 05:34:21 -0700 (Sun, 24 Jul 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/draw.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_sprite.c
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/shader_glsl.h
   M /trunk/darkplaces/shader_hlsl.h

Fix gl_texturecompression_sprites to check for gl_texturecompression. Rough patch to make v_glslgamma work with 2d graphics (hud, menupics, video etc.).
------------------------------------------------------------------------
r11250 | havoc | 2011-07-22 23:08:50 -0700 (Fri, 22 Jul 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

added sv_namechangetimer cvar which allows the name change frequency to
be changed from the default 5 seconds

------------------------------------------------------------------------
r11249 | havoc | 2011-07-21 15:08:22 -0700 (Thu, 21 Jul 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

remove a redundant (and bugged) check

------------------------------------------------------------------------
r11247 | divverent | 2011-07-16 11:54:18 -0700 (Sat, 16 Jul 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_textures.c

fix two errors in DDS format as written by DP
------------------------------------------------------------------------
r11246 | havoc | 2011-07-13 09:37:38 -0700 (Wed, 13 Jul 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

added a FIXME comment - R_CompleteLightPoint should count bouncegrid

------------------------------------------------------------------------
r11245 | eihrul | 2011-07-11 02:17:39 -0700 (Mon, 11 Jul 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

handle IQM models with no blend weights

------------------------------------------------------------------------
r11244 | eihrul | 2011-07-10 12:14:37 -0700 (Sun, 10 Jul 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

tab formatting fix

------------------------------------------------------------------------
r11243 | eihrul | 2011-07-10 12:10:32 -0700 (Sun, 10 Jul 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

build static frame for IQM models with no animations

------------------------------------------------------------------------
r11242 | havoc | 2011-07-09 13:27:07 -0700 (Sat, 09 Jul 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

added -developer3 for crazy debugging sessions (gl_printcheckerror spew)

------------------------------------------------------------------------
r11241 | havoc | 2011-07-09 13:25:49 -0700 (Sat, 09 Jul 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

print shader compile and link logs always if developer_extra 1 (you get
this with -developer2 on the commandline)

------------------------------------------------------------------------
r11240 | divverent | 2011-07-09 07:08:53 -0700 (Sat, 09 Jul 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

Update the default values for the motionblur..... I think this is basically done at this point.

From: Samual <samual@xonotic.org>
------------------------------------------------------------------------
r11239 | divverent | 2011-07-09 07:08:49 -0700 (Sat, 09 Jul 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

Add/update cvars and such... Almost done now basically. Just a bit of testing left.

From: Samual <samual@xonotic.org>
------------------------------------------------------------------------
r11238 | divverent | 2011-07-09 07:08:45 -0700 (Sat, 09 Jul 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

Change how the factor is calculated and set it up to be finished

From: Samual <samual@xonotic.org>
------------------------------------------------------------------------
r11237 | divverent | 2011-07-09 07:08:41 -0700 (Sat, 09 Jul 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

Begin a quick re-write of how motionblur values are calculated

From: Samual <samual@xonotic.org>
------------------------------------------------------------------------
r11236 | divverent | 2011-07-09 06:56:23 -0700 (Sat, 09 Jul 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

Different fade rates for adapting to bright scenes and adapting to dark scenes

From: Samual <samual@xonotic.org>
------------------------------------------------------------------------
r11235 | havoc | 2011-07-09 00:35:47 -0700 (Sat, 09 Jul 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

changed qwmasters - kubus.rulez.pl is down, added qwmaster.fodquake.net

------------------------------------------------------------------------
r11234 | divverent | 2011-07-08 12:33:54 -0700 (Fri, 08 Jul 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_backend.c

fix gl_mesh_testmanualfeeding
------------------------------------------------------------------------
r11233 | divverent | 2011-07-08 01:27:05 -0700 (Fri, 08 Jul 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/BSDmakefile
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/makefile.inc

OS X compile: do not build the AGL target by default (use make cl-release to build it anyway)
------------------------------------------------------------------------
r11232 | divverent | 2011-07-05 12:48:04 -0700 (Tue, 05 Jul 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/cvar.c
   M /trunk/darkplaces/cvar.h
   M /trunk/darkplaces/dpdefs/dpextensions.qc
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/sound.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/svvm_cmds.c

DP_SND_SOUND7_WIP1

sound7() function, supporting more sound channels (-128 to 127, negative ones being additional auto-channels, positive ones being additional single-channels)
------------------------------------------------------------------------
r11231 | divverent | 2011-07-02 08:23:35 -0700 (Sat, 02 Jul 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/dpdefs/dpextensions.qc
   M /trunk/darkplaces/dpdefs/menudefs.qc

move gecko builtins to menudefs.qc
------------------------------------------------------------------------
r11230 | havoc | 2011-06-30 22:42:57 -0700 (Thu, 30 Jun 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

effectinfo velocitymultiplier defaults to 0 again

------------------------------------------------------------------------
r11229 | havoc | 2011-06-30 22:40:29 -0700 (Thu, 30 Jun 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

fix default effectinfo gravity and size

------------------------------------------------------------------------
r11228 | havoc | 2011-06-30 22:25:04 -0700 (Thu, 30 Jun 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

default effectinfo velocitymultiplier to 0 in nexuiz mode

------------------------------------------------------------------------
r11227 | havoc | 2011-06-29 21:55:23 -0700 (Wed, 29 Jun 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

fix some loading errors on effectinfo.txt where variables were not being
cleared properly
changed default effectinfo velocitymultiplier from 0 to 1

------------------------------------------------------------------------
r11226 | havoc | 2011-06-28 01:12:15 -0700 (Tue, 28 Jun 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c

fix offsetmapping without a q3 shader on Q1BSP and MDL

------------------------------------------------------------------------
r11225 | havoc | 2011-06-27 17:55:10 -0700 (Mon, 27 Jun 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_sdl.c

don't spam joy_active notices with developer_extra

------------------------------------------------------------------------
r11224 | divverent | 2011-06-27 07:05:26 -0700 (Mon, 27 Jun 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/filematch.c

prevent segfault caused by stringlistsort
------------------------------------------------------------------------
r11223 | havoc | 2011-06-26 19:20:27 -0700 (Sun, 26 Jun 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

fix C++ compile errors

------------------------------------------------------------------------
r11222 | havoc | 2011-06-26 19:15:09 -0700 (Sun, 26 Jun 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

fix the solid water bug for real

------------------------------------------------------------------------
r11221 | havoc | 2011-06-26 19:10:35 -0700 (Sun, 26 Jun 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

another attempt at fixing solid water in the dedicated server

------------------------------------------------------------------------
r11220 | havoc | 2011-06-26 15:37:13 -0700 (Sun, 26 Jun 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/dpdefs/dpextensions.qc
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/prvm_offsets.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/svvm_cmds.c

implemented DP_ENT_TRAILEFFECTNUM extension, which allows
self.traileffectnum = particleeffectnum("mycustomeffect") on server
entities, rather than requiring csqc for trailparticles()

------------------------------------------------------------------------
r11219 | divverent | 2011-06-26 12:50:50 -0700 (Sun, 26 Jun 2011) | 5 lines
Changed paths:
   M /trunk/darkplaces/protocol.c

fix a bug in EntityFrame5 stats delta bits handling

It forgot to memset the stats delta bits to 0, so it marked stats as being sent
in the database that were not. This clearly caused too large resend data when
packet loss occurred.
------------------------------------------------------------------------
r11218 | divverent | 2011-06-26 12:07:03 -0700 (Sun, 26 Jun 2011) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c

funny feature: cl_lerpexcess

Hides the effect of packet loss for linear motion. Mispredicts nonlinear
motion, of course. Can be configured to a max number of server packets lost
that it will try to compensate for. Of course off by default.
------------------------------------------------------------------------
r11217 | divverent | 2011-06-26 02:09:15 -0700 (Sun, 26 Jun 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/vid_glx.c

add a workaround to make the ^ key work on some X.org systems
------------------------------------------------------------------------
r11216 | divverent | 2011-06-26 02:09:13 -0700 (Sun, 26 Jun 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/vid_glx.c

work around broken XLookupKeysym returning "" on XK_asciicircum
------------------------------------------------------------------------
r11215 | havoc | 2011-06-25 21:52:15 -0700 (Sat, 25 Jun 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

cleaned up the fix for solid water in q1bsp dedicated servers

------------------------------------------------------------------------
r11214 | havoc | 2011-06-25 21:50:41 -0700 (Sat, 25 Jun 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fix q1bsp dedicated server collisions, a simplification of the q1bsp
loading code was breaking the material information and thus water was
made solid

------------------------------------------------------------------------
r11213 | havoc | 2011-06-23 18:38:21 -0700 (Thu, 23 Jun 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/draw.h
   M /trunk/darkplaces/gl_draw.c

fixed gfx/menuplyr handling - Draw_NewPic now flags the cachepic_t with
CACHEPICFLAG_NEWPIC which disables texflags comparisons

------------------------------------------------------------------------
r11212 | havoc | 2011-06-23 00:21:55 -0700 (Thu, 23 Jun 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

draw weapons on sbar at full opacity like they are in mission packs

------------------------------------------------------------------------
r11211 | havoc | 2011-06-22 22:41:53 -0700 (Wed, 22 Jun 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

fix model loading memory corruption errors related to
r_enableshadowvolumes 0, and also potential memory corruption errors
related to numvertices <= 65536

------------------------------------------------------------------------
r11210 | havoc | 2011-06-22 20:12:27 -0700 (Wed, 22 Jun 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c

more rework of r_shadow_bouncegrid, now dynamic mode performs somewhat
better, but still without the artifacts it used to have
added more static mode cvars to differentiate optimal settings

------------------------------------------------------------------------
r11209 | havoc | 2011-06-22 19:44:24 -0700 (Wed, 22 Jun 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c

added r_shadow_bouncegrid 2 which disables rtlights and just renders the
bouncegrid
reworked several aspects of bouncegrid, it has less grid artifacts now

------------------------------------------------------------------------
r11208 | havoc | 2011-06-22 13:13:42 -0700 (Wed, 22 Jun 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c

added sv_gameplayfix_q1bsptracelinereportstexture cvar (default 1), to
allow people to disable the surface-based traceline if they so desire

------------------------------------------------------------------------
r11207 | divverent | 2011-06-21 13:33:09 -0700 (Tue, 21 Jun 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/utf8lib.c
   M /trunk/darkplaces/utf8lib.h

"real" Unicode upper/lowercase (only 1:1 mappings, though)
------------------------------------------------------------------------
r11206 | havoc | 2011-06-19 22:29:39 -0700 (Sun, 19 Jun 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/dpdefs/dpextensions.qc
   M /trunk/dpmod/qc/dpextensions.qc

fix two typos in DP_PHYSICS_ODE explanation (thanks FrikaC for pointing
these out)
synchronize dpextensions.qc files (for anyone reading the dpmod one)

------------------------------------------------------------------------
r11204 | havoc | 2011-06-19 12:40:06 -0700 (Sun, 19 Jun 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

change default r_texture_dds_load_logfailure to 0 as was intended

------------------------------------------------------------------------
r11200 | divverent | 2011-06-14 11:55:08 -0700 (Tue, 14 Jun 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/protocol.c

fix entity networking AGAIN

Do NOT inhibit sending EntityState5 removes for CSQC entities!
These entities may be needed for state changes.
------------------------------------------------------------------------
r11199 | divverent | 2011-06-13 11:34:50 -0700 (Mon, 13 Jun 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

fix wrong array sizes in MODE_WATER in softrast causing an overrun
------------------------------------------------------------------------
r11198 | divverent | 2011-06-13 11:34:46 -0700 (Mon, 13 Jun 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_video_jamdecode.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/snd_mix.c

fix some warnings about useless code (unsigned < 0, x = x)
------------------------------------------------------------------------
r11197 | divverent | 2011-06-13 11:28:06 -0700 (Mon, 13 Jun 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/vid_shared.c

fix detection of multisampling for ATC
------------------------------------------------------------------------
r11196 | havoc | 2011-06-13 10:31:58 -0700 (Mon, 13 Jun 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/common.c

refactored MSG_ReadString to be nicer code (and fix a potentially uninitialized variable warning)
------------------------------------------------------------------------
r11195 | divverent | 2011-06-13 00:10:08 -0700 (Mon, 13 Jun 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/common.c

MSG_ReadString: if hitting the max length of the string, continue to read until NUL anyway (prevents msg_badread when reading an overlong string)
------------------------------------------------------------------------
r11194 | divverent | 2011-06-12 12:59:24 -0700 (Sun, 12 Jun 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/cmd.c

make "exec" accept wildcards
------------------------------------------------------------------------
r11193 | divverent | 2011-06-12 12:59:21 -0700 (Sun, 12 Jun 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/filematch.c
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/menu.c

remove duplicate names from file search results
------------------------------------------------------------------------
r11192 | havoc | 2011-06-08 13:32:11 -0700 (Wed, 08 Jun 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

fix a crash on saving a game

------------------------------------------------------------------------
r11191 | divverent | 2011-06-08 12:35:54 -0700 (Wed, 08 Jun 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/vid_shared.c

use subtractive blend equation to support negative v_brightness; support smaller-than-1 contrast
------------------------------------------------------------------------
r11190 | havoc | 2011-06-08 12:23:52 -0700 (Wed, 08 Jun 2011) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/clprogdefs.h
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/mprogdefs.h
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/sv_demo.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_move.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sv_user.c
   M /trunk/darkplaces/svvm_cmds.c
   M /trunk/darkplaces/todo
   M /trunk/darkplaces/world.c

reworked progs loading so that entvars_t and globalvars_t are no longer
required to match (if they do match, the relevant fields will match the
structs, otherwise name lookups are used), this means the PROGHEADER_CRC
no longer has to match either...  and same for csqc and menuqc

------------------------------------------------------------------------
r11189 | havoc | 2011-06-08 11:03:19 -0700 (Wed, 08 Jun 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/cd_shared.c
   M /trunk/darkplaces/cl_video_jamdecode.c
   M /trunk/darkplaces/dpvsimpledecode.c
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_main.h
   M /trunk/darkplaces/snd_mix.c
   M /trunk/darkplaces/snd_null.c
   M /trunk/darkplaces/sound.h

eliminated S_LockSfx and S_UnlockSfx which were not thread-safe and
could cause sounds to leak across multiple levels, cd play/loop now
immediately unload previous music track

------------------------------------------------------------------------
r11188 | havoc | 2011-06-08 10:36:16 -0700 (Wed, 08 Jun 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_shared.c

implemented r_transparent_alphatocoverage 2 which promotes alphablend if
desired to ATC, the default is 1 (only promotes alphatest)
enable GL_MULTISAMPLE during extension detection to make things work

------------------------------------------------------------------------
r11187 | havoc | 2011-06-08 08:47:32 -0700 (Wed, 08 Jun 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

disable sv_gameplayfix_nudgeoutofsolid by default until we figure out
how to handle multiple plane intersections

------------------------------------------------------------------------
r11186 | havoc | 2011-06-08 06:33:46 -0700 (Wed, 08 Jun 2011) | 5 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c
   M /trunk/darkplaces/dpsoftrast.h
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_shared.c

reworked use of alphatest - now only GL11/GL13/GLES1 paths use it, other
paths use SHADERPERMUTATION_ALPHAKILL (including the SOFT path)
reworked r_transparent_alphatocoverage, it no longer needs
vid_multisampling

------------------------------------------------------------------------
r11185 | havoc | 2011-06-08 06:20:59 -0700 (Wed, 08 Jun 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_wgl.c

reduce cvar spam when using developer_extra

------------------------------------------------------------------------
r11184 | divverent | 2011-06-07 02:32:30 -0700 (Tue, 07 Jun 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/cap_ogg.c

theora encoding: simplify; bump default quality to 48 as that is what encoder_example uses
------------------------------------------------------------------------
r11183 | divverent | 2011-06-07 02:22:17 -0700 (Tue, 07 Jun 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/cap_ogg.c

theora encoding: allow both bitrate and quality to be -1 for insane quality
------------------------------------------------------------------------
r11182 | divverent | 2011-06-07 00:22:54 -0700 (Tue, 07 Jun 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/cap_ogg.c

theora encoding: set VP3 compatibility mode. This SHOULD fix issues with youtube.
------------------------------------------------------------------------
r11181 | divverent | 2011-06-05 07:55:41 -0700 (Sun, 05 Jun 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/shader_hlsl.h

initial attempt do do r_trippy in HLSL
------------------------------------------------------------------------
r11180 | divverent | 2011-06-05 07:55:40 -0700 (Sun, 05 Jun 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/shader_glsl.h

fix r_trippy compile with DRI/Mesa
------------------------------------------------------------------------
r11179 | divverent | 2011-06-04 13:06:13 -0700 (Sat, 04 Jun 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_backend.c

enable alpha test in dpsoftrast. Why was it turned off?
------------------------------------------------------------------------
r11178 | divverent | 2011-06-03 21:43:55 -0700 (Fri, 03 Jun 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/snd_null.c

add the new S_ function to snd_null.c too
------------------------------------------------------------------------
r11177 | divverent | 2011-06-03 13:18:37 -0700 (Fri, 03 Jun 2011) | 6 lines
Changed paths:
   M /trunk/darkplaces/cd_shared.c
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/sound.h

new cvars: snd_startloopingsounds, snd_startnonloopingsounds

Use cases:
1. playing mods with bugs where looping sounds never end, annoying
2. implementing demo seeking via cfg file tricks (turn off non-looping sounds
   during high slowmo values used for seeking)
------------------------------------------------------------------------
r11176 | havoc | 2011-06-02 23:40:06 -0700 (Thu, 02 Jun 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/vid_shared.c

check OpenGL 2.0 version again, rather than supporting fragment shaders
on 1.4, as it's just not performant on these chips and sometimes buggy

------------------------------------------------------------------------
r11175 | eihrul | 2011-06-01 04:56:46 -0700 (Wed, 01 Jun 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_iqm.h

iqm version 1 compatibility

------------------------------------------------------------------------
r11174 | divverent | 2011-06-01 03:47:42 -0700 (Wed, 01 Jun 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/makefile.inc

the git describe option --dirty is too new, so don't use it
------------------------------------------------------------------------
r11173 | eihrul | 2011-05-31 16:19:44 -0700 (Tue, 31 May 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_iqm.h

support for version 2 of iqm

------------------------------------------------------------------------
r11172 | divverent | 2011-05-31 13:25:01 -0700 (Tue, 31 May 2011) | 8 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/view.c

viewmodel matrix fixes:

- have two separate viewmodel matrices, one that only applies the viewmodel
  scale (for EF_NOGUNBOB), and one that contains bobbing etc. effects
- recalculate both matrices properly when using R_SetView() from CSQC
- make sure view parameters are consistent between whether R_SetView() is
  called or not
- fix missing viewmodel scale in intermission
------------------------------------------------------------------------
r11171 | divverent | 2011-05-29 09:56:25 -0700 (Sun, 29 May 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/view.c

fix calculation of viewangles to include v_idlescale
------------------------------------------------------------------------
r11170 | havoc | 2011-05-29 04:06:42 -0700 (Sun, 29 May 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/dpsoftrast.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/shader_glsl.h
   M /trunk/darkplaces/sv_main.c

added r_trippy cvar

------------------------------------------------------------------------
r11169 | havoc | 2011-05-28 10:50:38 -0700 (Sat, 28 May 2011) | 6 lines
Changed paths:
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c

reworked sv_gameplayfix_nudgeoutofsolid, it now begins with an enlarged
start position test and nudges out of solids, then does the move, this
should reduce collision issues with triangle mesh brushes in steelstorm,
renamed sv_gameplayfix_nudgeoutofsolid_bias to
sv_gameplayfix_nudgeoutofsolid_separation with 0.03125 as default

------------------------------------------------------------------------
r11168 | divverent | 2011-05-27 09:58:46 -0700 (Fri, 27 May 2011) | 11 lines
Changed paths:
   M /trunk/darkplaces/sys_shared.c

call SetDllDirectory on Win32 too

Usage: put DLLs in a bin32/ subdir for that
If not done, binaries work as before.

This is the only way to have a 32bit and 64bit executable version in the same
directory! Otherwise Windows will abort DLL search at the 32bit DLL, which
fails to load into a 64bit process.

NOTE: this requires WinXP SP1 and above. To compile with this functionality
disabled, compile with -DDONT_USE_SETDLLDIRECTORY added to the CFLAGS.
------------------------------------------------------------------------
r11167 | havoc | 2011-05-27 00:44:27 -0700 (Fri, 27 May 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/image.h
   M /trunk/darkplaces/view.c

apply vid_sRGB correction to viewblends and particles

------------------------------------------------------------------------
r11166 | havoc | 2011-05-24 18:46:42 -0700 (Tue, 24 May 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

r_speeds now shows without being connected (in menu for example),
showfps also does

------------------------------------------------------------------------
r11165 | havoc | 2011-05-24 18:13:13 -0700 (Tue, 24 May 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix bugs with deformvertexes autosprite in GL11/GL13/GLES1 paths

------------------------------------------------------------------------
r11164 | havoc | 2011-05-23 08:49:45 -0700 (Mon, 23 May 2011) | 6 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/render.h

honor ent->shadertime in all material handling (tcmod, etc)
do frame looping properly on q3 shader animmap (no more precision issues)
wrap tcmod scroll so that it does not have precision breakdown
changed rsurface.ent_shadertime to rsurface.shadertime which is now
relative time (what should be used)

------------------------------------------------------------------------
r11163 | havoc | 2011-05-23 08:46:32 -0700 (Mon, 23 May 2011) | 5 lines
Changed paths:
   M /trunk/darkplaces/mathlib.c
   M /trunk/darkplaces/mathlib.h

added LoopingFrameNumberFromDouble function to do this operation
correctly (using divide, floor, and multiply), since doing it the lazy
way (cast to int, use modulus operator) breaks down after a certain
amount of time in the level

------------------------------------------------------------------------
r11162 | havoc | 2011-05-23 04:08:46 -0700 (Mon, 23 May 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/csprogs.c

fix steelstorm animated shader timing (shadertime was not declared in
this csprogs.dat and the old code checked for that, no longer possible)

------------------------------------------------------------------------
r11161 | havoc | 2011-05-23 02:41:52 -0700 (Mon, 23 May 2011) | 6 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_main.h
   M /trunk/darkplaces/snd_mix.c

fix a crash in debug builds where the compiler did not optimize
ch->sfx-> to use a local variable holding the unchanging value of sfx
(the crash occurs when the mixer thread clears ch->sfx while the main
thread is deciding whether to merge a sound onto an existing channel -
if the channel dies during this code, the sfx pointer must be preserved)

------------------------------------------------------------------------
r11160 | vortex | 2011-05-21 09:59:30 -0700 (Sat, 21 May 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_sprite.c

Move some sprite-related cvars to model_sprite.c.
------------------------------------------------------------------------
r11159 | vortex | 2011-05-20 13:28:46 -0700 (Fri, 20 May 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/dpdefs/csprogsdefs.qc

add precache_cubemap() builtin
------------------------------------------------------------------------
r11158 | vortex | 2011-05-20 13:27:10 -0700 (Fri, 20 May 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/model_sprite.c

Added "loadcubemap" builtin to allow preload cubemaps level can use, added experimental "r_water_lowquality" which reduces options while rendering water planes, this can help a bit. Added "gl_texturecompression_sprites" cvar.
------------------------------------------------------------------------
r11157 | havoc | 2011-05-18 18:33:42 -0700 (Wed, 18 May 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/keys.h
   M /trunk/darkplaces/vid_shared.c

added JOY_UP/DOWN/LEFT/RIGHT keys which are a more general form of the joy_axiskeyevents cvar (which when set to 1 will turn these into UPARROW/DOWNARROW/etc as before, but this way a menu qc can respond to them correctly)
------------------------------------------------------------------------
r11156 | havoc | 2011-05-18 18:21:10 -0700 (Wed, 18 May 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/vid_shared.c

XInput code path no longer emulates arrow keys in menu by default, instead this is based purely on the joy_axiskeyevents cvar (and no longer cares if it is the menu or not)
------------------------------------------------------------------------
r11155 | havoc | 2011-05-18 06:32:46 -0700 (Wed, 18 May 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/vid_shared.c

disable VorteX's multisample setup code because it crashes vid_restart
and looks like it does not work anyway

------------------------------------------------------------------------
r11154 | havoc | 2011-05-18 06:18:43 -0700 (Wed, 18 May 2011) | 5 lines
Changed paths:
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/keys.h
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_agl.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_null.c
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c

implemented support for Windows XInput (using different keys/cvars to allow non-conflicting configs) in vid_shared.c, usable in WGL and SDL clients on Windows
redesigned joystick code to encode any joystick data into a vid_joystate_t struct and use a common code path for all handling of axes and button events (also rewrote joy_axiskeyevents as part of this)
changed joystick deadzone handling to make values start at 0 at the edge of the deadzone
removed legacy joystick code in vid_wgl.c because it was too annoying to maintain
removed some hacky SDL 1.3 iOS code that is no longer needed
------------------------------------------------------------------------
r11153 | havoc | 2011-05-18 06:08:01 -0700 (Wed, 18 May 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/world.c

fix a bug where the wrong PRVM_ macro was being used
------------------------------------------------------------------------
r11152 | divverent | 2011-05-17 11:12:08 -0700 (Tue, 17 May 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/sv_main.c

new movement cvar and stat: sv_airaccel_qw_stretchfactor
------------------------------------------------------------------------
r11151 | havoc | 2011-05-14 10:58:56 -0700 (Sat, 14 May 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

don't crash in dedicated server when parsing shaders with dpreflectcube

------------------------------------------------------------------------
r11150 | divverent | 2011-05-14 09:16:08 -0700 (Sat, 14 May 2011) | 5 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

A temporary hack for GAME_XONOTIC only

this commit adds getplayerkey(..., "TEMPHACK_origin") to get a networked
player's origin from csqc; it returns the empty string if the extension is not
supported, or the player is not known to the engine at the moment
------------------------------------------------------------------------
r11149 | divverent | 2011-05-14 06:06:28 -0700 (Sat, 14 May 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/draw.h

add a missing declaration in last commit
------------------------------------------------------------------------
r11148 | divverent | 2011-05-14 06:03:44 -0700 (Sat, 14 May 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

Attempt to make loading screens not stay cached, to avoid loading GPU memory when having high resolution loading images.

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r11147 | vortex | 2011-05-13 14:37:16 -0700 (Fri, 13 May 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_shared.c

Multisampling initialisation moved from vid_sdl to gl_backend. Make cubemaps array dynamic (segments are allocated on load), this uses less memory, and MAX_CUBEMAPS was raised.
------------------------------------------------------------------------
r11146 | vortex | 2011-05-11 15:59:39 -0700 (Wed, 11 May 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/vid_sdl.c

OpenGL 2.0 path: Make handling of Alpha-To-Coverage same as AlphaTest (enabling before surface render and disabling after), instead of hacky R_ShadowMode_Begin force-to-disable, this also fixes shadowmap bug with ATI hardware. Also made vid_multisampling (if enabled) to force minimal vid_samples 2.
------------------------------------------------------------------------
r11145 | havoc | 2011-05-09 13:20:37 -0700 (Mon, 09 May 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_gecko.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/prvm_exec.c
   A /trunk/darkplaces/prvm_offsets.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sv_user.c
   M /trunk/darkplaces/svvm_cmds.c

added prvm_offsets.h which centralizes field/global/function lookups for
easier maintenance, this file is included with a huge set of macros for
each different purpose...

------------------------------------------------------------------------
r11144 | havoc | 2011-05-09 10:56:56 -0700 (Mon, 09 May 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/prvm_exec.c
   M /trunk/darkplaces/prvm_execprogram.h
   M /trunk/darkplaces/sv_demo.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sv_user.c
   M /trunk/darkplaces/svvm_cmds.c
   M /trunk/darkplaces/world.c

reworked PRVM_EDICTFIELD* and PRVM_GLOBALFIELD* usage to have more
specific naming of the macros, and allow code analysis to audit the used
fields/globals for better maintenance

------------------------------------------------------------------------
r11143 | havoc | 2011-05-09 08:44:40 -0700 (Mon, 09 May 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c

added pmove_onground to get this value from the engine prediction
added pmove_inwater to get this value from the engine prediction

------------------------------------------------------------------------
r11142 | havoc | 2011-05-09 06:35:35 -0700 (Mon, 09 May 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/csprogs.c

fix missing .string message fielddef

------------------------------------------------------------------------
r11141 | havoc | 2011-05-09 06:35:20 -0700 (Mon, 09 May 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

add the prvm_badvalue variable needed by the last commit

------------------------------------------------------------------------
r11140 | havoc | 2011-05-09 06:32:31 -0700 (Mon, 09 May 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/progsvm.h

added debugging code for PRVM_EDICTFIELD*/PRVM_GLOBALFIELD* macros,
these now warn if the fieldoffset is invalid, and do not crash

------------------------------------------------------------------------
r11139 | vortex | 2011-05-09 04:28:12 -0700 (Mon, 09 May 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c

Move Alpha-To-Coverage stuff to gl_backend.c, fix bug with shadows rendering.
------------------------------------------------------------------------
r11138 | havoc | 2011-05-08 15:52:32 -0700 (Sun, 08 May 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

fix a crash

------------------------------------------------------------------------
r11137 | havoc | 2011-05-08 15:28:44 -0700 (Sun, 08 May 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

mac builds now detect if the gamedir exists in the .app/Contents/Resources/ folder

------------------------------------------------------------------------
r11136 | vortex | 2011-05-08 14:55:18 -0700 (Sun, 08 May 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_shared.c

GL_ARB_multisampling defs (vid_multisampling) and alpha-to-coverage effect (r_transparent_alphatocoverage) for alphaTest surfaces, which dont use multisampling yet but looks better for most cases, especially for overhead games.
------------------------------------------------------------------------
r11135 | havoc | 2011-05-08 14:02:54 -0700 (Sun, 08 May 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

lovely untested OSX code for detecting gamedir inside .app

------------------------------------------------------------------------
r11134 | havoc | 2011-05-08 14:02:21 -0700 (Sun, 08 May 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_shared.c

don't bother using GL_ARB_texture_non_power_of_two on OSX, too buggy

------------------------------------------------------------------------
r11133 | vortex | 2011-05-08 13:33:48 -0700 (Sun, 08 May 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/dpdefs/csprogsdefs.qc

renabe builtin particle->spawnparticle (DP_CSQC_SPAWNPARTICLE) because it conflicts with quake's particle().
------------------------------------------------------------------------
r11132 | havoc | 2011-05-08 13:23:04 -0700 (Sun, 08 May 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/SDLMain.m

updated to SDL1.2.14 version of OSX main code

------------------------------------------------------------------------
r11131 | havoc | 2011-05-08 12:51:49 -0700 (Sun, 08 May 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

fix another warning

------------------------------------------------------------------------
r11130 | havoc | 2011-05-08 12:49:05 -0700 (Sun, 08 May 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

fix a C++ compile error

------------------------------------------------------------------------
r11129 | havoc | 2011-05-08 11:37:26 -0700 (Sun, 08 May 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/prvm_exec.c
   M /trunk/darkplaces/sv_user.c

a few more PRVM_EDICTFIELDVALUE/PRVM_GLOBALFIELDVALUE uses fixed

------------------------------------------------------------------------
r11128 | havoc | 2011-05-08 11:34:47 -0700 (Sun, 08 May 2011) | 6 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/cvar.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/pr_comp.h
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/prvm_exec.c
   M /trunk/darkplaces/prvm_execprogram.h
   M /trunk/darkplaces/sv_demo.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sv_user.c
   M /trunk/darkplaces/svvm_cmds.c
   M /trunk/darkplaces/todo
   M /trunk/darkplaces/world.c

removed NULL checks for PRVM_EDICTFIELDVALUE/GLOBALFIELDVALUE
added PRVM_EDICTFIELDFLOAT/VECTOR/STRING/EDICT/FUNCTION variants
added PRVM_GLOBALFIELDFLOAT/VECTOR/STRING/EDICT/FUNCTION variants
this should improve performance slightly, and make code audits easier
updated required fields lists, added required globals lists

------------------------------------------------------------------------
r11127 | divverent | 2011-05-08 08:25:44 -0700 (Sun, 08 May 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/dpdefs/source_compare.txt
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/sv_user.c

fix naming of two fields
------------------------------------------------------------------------
r11126 | divverent | 2011-05-08 08:21:45 -0700 (Sun, 08 May 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/dpdefs/source_compare.pl
   M /trunk/darkplaces/dpdefs/source_compare.txt

fix parsing in more places
------------------------------------------------------------------------
r11125 | divverent | 2011-05-08 08:17:06 -0700 (Sun, 08 May 2011) | 1 line
Changed paths:
   A /trunk/darkplaces/dpdefs/source_compare.pl
   A /trunk/darkplaces/dpdefs/source_compare.txt

add a compare tool for dpdefs (not really complete!)
------------------------------------------------------------------------
r11124 | divverent | 2011-05-08 07:42:45 -0700 (Sun, 08 May 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/progsvm.h

fix annotation of crypto fields
------------------------------------------------------------------------
r11123 | havoc | 2011-05-08 06:49:35 -0700 (Sun, 08 May 2011) | 6 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/view.c

fixed RF_VIEWMODEL really good this time
renamed cl.csqc_origin to cl.csqc_vieworigin, cl.csqc_angles to
cl.csqc_viewangles, and added cl.csqc_vieworiginfromengine and
cl.csqc_viewanglesfromengine which are used to restore the view
parameters when R_ClearScene is used in csqc 

------------------------------------------------------------------------
r11122 | havoc | 2011-05-08 06:16:54 -0700 (Sun, 08 May 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/csprogs.c

fix bug in last patch, fix RF_USEAXIS handling

------------------------------------------------------------------------
r11121 | havoc | 2011-05-08 05:56:22 -0700 (Sun, 08 May 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/csprogs.c

fix RF_VIEWMODEL by using CL_GetTagMatrix on self rather than
self.tag_entity

------------------------------------------------------------------------
r11120 | divverent | 2011-05-08 04:25:14 -0700 (Sun, 08 May 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/dpdefs/dpextensions.qc

fix double declarations of ODE stuff
------------------------------------------------------------------------
r11119 | divverent | 2011-05-07 14:00:32 -0700 (Sat, 07 May 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/dpdefs/dpextensions.qc

add buttons 9 to 16; improve autocvar description
------------------------------------------------------------------------
r11118 | divverent | 2011-05-07 09:12:22 -0700 (Sat, 07 May 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix water renders with r_viewscale
------------------------------------------------------------------------
r11117 | divverent | 2011-05-07 08:21:57 -0700 (Sat, 07 May 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/makefile.inc

try harder to get a version string out of git
------------------------------------------------------------------------
r11116 | havoc | 2011-05-07 05:36:28 -0700 (Sat, 07 May 2011) | 6 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c

added vid_sRGB cvar, this replaces the r_texture_sRGB* cvars and
modifies all texture loading (including bsp, mdl, spr, lmp, as well as
external textures) and the output gamma to achieve sRGB corrected
rendering, not all renderpaths support this and the feature will be
automatically disabled on such renderpaths

------------------------------------------------------------------------
r11115 | divverent | 2011-05-06 13:56:35 -0700 (Fri, 06 May 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/protocol.c

add 2 missing casts
------------------------------------------------------------------------
r11114 | divverent | 2011-05-06 12:31:50 -0700 (Fri, 06 May 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/ft2.c

we can enable NPOT fonts, there seems to be no slowdown from it
------------------------------------------------------------------------
r11113 | divverent | 2011-05-06 11:34:10 -0700 (Fri, 06 May 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/ft2.c

new cvar: r_font_nonpoweroftwo (to save GPU VRAM for fonts)
------------------------------------------------------------------------
r11112 | divverent | 2011-05-06 11:33:35 -0700 (Fri, 06 May 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/ft2.c

add a debug print about font map use
------------------------------------------------------------------------
r11111 | divverent | 2011-05-06 11:33:10 -0700 (Fri, 06 May 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/ft2.c

FINALLY use the mapidx right
------------------------------------------------------------------------
r11110 | divverent | 2011-05-06 11:32:45 -0700 (Fri, 06 May 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/ft2.c

to resolve the format string madness once and for all: write explicit casts for all args in this printf
------------------------------------------------------------------------
r11109 | havoc | 2011-05-06 06:39:22 -0700 (Fri, 06 May 2011) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/sv_main.c

added .float sendcomplexanimation server qc field which if TRUE will
send .frame .frame2 .frame3 .frame4 .frame1time .frame2time .frame3time
.frame4time .lerpfrac .lerpfrac3 .lerpfrac4 OR .skeletonindex if set
(BANDWIDTH HOG, skeletal networking inadvisable in multiplayer)

------------------------------------------------------------------------
r11108 | havoc | 2011-05-06 06:05:29 -0700 (Fri, 06 May 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/ft2.c

fix a format error in map_identifier (load_flags needs to be u, not g)

------------------------------------------------------------------------
r11107 | havoc | 2011-05-06 02:08:29 -0700 (Fri, 06 May 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix bug with iqm models by removing pose 0 optimization (as it
represents the basepose in iqm, not the first pose)

------------------------------------------------------------------------
r11106 | havoc | 2011-05-05 04:49:33 -0700 (Thu, 05 May 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/ft2.c

fix serious error in font caching

------------------------------------------------------------------------
r11105 | havoc | 2011-05-04 20:44:49 -0700 (Wed, 04 May 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/fs.c

avoid creating an empty config.cfg in the basedir folder unless doing
the historical compatibility mode (only for id1 on Windows)

------------------------------------------------------------------------
r11104 | vortex | 2011-05-04 14:08:05 -0700 (Wed, 04 May 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/meshqueue.c

Removed mqt_viewmindist as it messes up order and don't give much.
------------------------------------------------------------------------
r11103 | divverent | 2011-05-03 22:02:10 -0700 (Tue, 03 May 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/ft2.c

avoid rendering the glyphs when not needed
------------------------------------------------------------------------
r11102 | divverent | 2011-05-03 22:02:07 -0700 (Tue, 03 May 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/ft2.c

free the data allocated by font rendering, even if the image is not to be used
------------------------------------------------------------------------
r11101 | divverent | 2011-05-03 22:02:04 -0700 (Tue, 03 May 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/ft2.c

also calculate padding if the font glyph is not to be rendered
------------------------------------------------------------------------
r11100 | divverent | 2011-05-03 22:02:02 -0700 (Tue, 03 May 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/ft2.c

add a third mode to call Font_Postprocess (NULL image, but pitch set)

This performs the same padding calculation as if the image were set, but does not actually process
------------------------------------------------------------------------
r11099 | havoc | 2011-05-03 11:33:50 -0700 (Tue, 03 May 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

fix screenshot prefix updates on gamedir change

------------------------------------------------------------------------
r11098 | havoc | 2011-05-03 11:03:22 -0700 (Tue, 03 May 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c

fix loading of quake lmp/wad textures

------------------------------------------------------------------------
r11097 | havoc | 2011-05-03 10:41:59 -0700 (Tue, 03 May 2011) | 6 lines
Changed paths:
   M /trunk/darkplaces/ft2.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/r_textures.h

gl_texturecompression is no longer required for TEXF_COMPRESS flag to
work - this cvar is now checked by the callers, so r_font_compress is
independent of it now
added r_texture_dds_save 2 setting which saves dds files even for
uncompressed textures, allowing one to completely skip source art files

------------------------------------------------------------------------
r11096 | havoc | 2011-05-03 06:34:49 -0700 (Tue, 03 May 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/ft2.c

avoid bugs introduced by the attempt to skip image processing - a closer
look is needed

------------------------------------------------------------------------
r11095 | havoc | 2011-05-03 04:42:49 -0700 (Tue, 03 May 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/draw.h
   M /trunk/darkplaces/ft2.c
   M /trunk/darkplaces/ft2_fontdefs.h
   M /trunk/darkplaces/gl_draw.c

don't upload the same ft2 font texture more than once
added r_font_diskcache (can read/write tga and dds)
added r_font_compress (saves memory by compressing the texture)

------------------------------------------------------------------------
r11094 | havoc | 2011-05-03 00:57:10 -0700 (Tue, 03 May 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_shared.c

check GL_ARB_fragment_shader

------------------------------------------------------------------------
r11093 | havoc | 2011-05-03 00:29:39 -0700 (Tue, 03 May 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_shared.c

reworked GL shader detection a bit, now works on Mac with Intel GMA 945 again

------------------------------------------------------------------------
r11092 | havoc | 2011-05-02 17:59:44 -0700 (Mon, 02 May 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/meshqueue.c

fix two compile errors in C++ mode
------------------------------------------------------------------------
r11091 | havoc | 2011-05-02 17:59:01 -0700 (Mon, 02 May 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/fs.c

fix two bugs with the Windows handling of GAMEDIRMODE_SAVEDGAMES, it now works properly
------------------------------------------------------------------------
r11090 | vortex | 2011-05-01 19:09:59 -0700 (Sun, 01 May 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/meshqueue.c
   M /trunk/darkplaces/meshqueue.h
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h

Transparent sorting: added maxdist and array size cvars which can be tweaked to increase performance (can give up to 10-20% with no quality loss on scenes with large amount of blended surfaces). Added "dpnortlight" shader keyword which disables full rtlight rendering on a surface, useful with grass which (when blended) can cause deadly speed loss.
------------------------------------------------------------------------
r11089 | divverent | 2011-05-01 13:24:33 -0700 (Sun, 01 May 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/makefile.inc

shells are too stupid to understand precedence of && and ||, so let's group explicitly
------------------------------------------------------------------------
r11088 | havoc | 2011-05-01 13:23:49 -0700 (Sun, 01 May 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_sdl.c

fix a compile error in my last edit for OSX

------------------------------------------------------------------------
r11087 | havoc | 2011-05-01 13:05:17 -0700 (Sun, 01 May 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_sdl.c

don't override dock icon on OSX

------------------------------------------------------------------------
r11086 | divverent | 2011-05-01 11:58:04 -0700 (Sun, 01 May 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/makefile.inc

detect git revision too, not just svn version
------------------------------------------------------------------------
r11085 | havoc | 2011-05-01 09:33:10 -0700 (Sun, 01 May 2011) | 12 lines
Changed paths:
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/fs.c

reworked userdir path selection, now has 4 "tiers":
NOHOME - uses basedir for configs
HOME - uses basedir on Windows, ~/.gamename/ on OSX and Linux
MYGAMES - uses My Games on Windows, ~/.gamename/ on Linux and OSX
SAVEDGAMES - uses Saved Games/gamename/ on Vista+, ~/.gamename/ on Linux
and ~/Library/Application Support/gamename/ on OSX
The tiers are tried in reverse order and any existing one will be used,
new ones will always be the last one.
If gamedirname1 is "id1" then Windows will use NOHOME rather than create
a new userdir when none are found. (but you can still create one or use
-mygames or -savedgames commandline options to make it do so)

------------------------------------------------------------------------
r11084 | divverent | 2011-04-29 13:32:35 -0700 (Fri, 29 Apr 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/svvm_cmds.c

CL_RotateMoves: helper builtin for Xonotic for perfect warpzone prediction
------------------------------------------------------------------------
r11083 | havoc | 2011-04-29 01:09:43 -0700 (Fri, 29 Apr 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/vid_sdl.c

changed vid_hasfocus check to use SDL_APPINPUTFOCUS only, not checking
SDL_APPMOUSEFOCUS

------------------------------------------------------------------------
r11082 | havoc | 2011-04-29 01:07:37 -0700 (Fri, 29 Apr 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

on OSX use ~/Library/Application Support/<gamename> instead of ~/.gamename

------------------------------------------------------------------------
r11081 | havoc | 2011-04-29 01:06:37 -0700 (Fri, 29 Apr 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/vid_sdl.c

refactored the SDL_WM_SetCaption and SDL_WM_SetIcon logic into a single
wrapper function for each platform (VID_WrapSDL_SetVideoMode), moved
caption setting before SDL_SetVideoMode to prevent the "SDL_app" title

------------------------------------------------------------------------
r11080 | divverent | 2011-04-27 03:50:48 -0700 (Wed, 27 Apr 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/shader_glsl.h

use highp by default
------------------------------------------------------------------------
r11079 | divverent | 2011-04-27 03:35:15 -0700 (Wed, 27 Apr 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/shader_glsl.h

do NOT use mediump explicitly for GLSL130 because this seems incompatible with inout

0(97) : error C7538: OpenGL does not allow 'mediump' after 'inout'
------------------------------------------------------------------------
r11078 | divverent | 2011-04-27 02:19:10 -0700 (Wed, 27 Apr 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/shader_glsl.h

in glsl130, add "precision mediump float"
------------------------------------------------------------------------
r11077 | havoc | 2011-04-26 18:54:45 -0700 (Tue, 26 Apr 2011) | 6 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

added r_transparent cvar to turn off transparent rendering for
performance testing
added r_deformvertexes cvar to turn off deforms for performance testing
neither of these settings are meant to be performance improvements, only
testing methods

------------------------------------------------------------------------
r11076 | divverent | 2011-04-25 12:15:53 -0700 (Mon, 25 Apr 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/libcurl.c

evaluate sv_curl_serverpackages changes immediately, not on map restart
------------------------------------------------------------------------
r11075 | vortex | 2011-04-22 17:40:44 -0700 (Fri, 22 Apr 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c

R_LightPoint: fix glitch. Add checking for worldmodel->lit to R_LightPoint and R_CompleteLightPoint.
------------------------------------------------------------------------
r11074 | divverent | 2011-04-20 07:01:29 -0700 (Wed, 20 Apr 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

really fix csprogs.dat.??.po loading
------------------------------------------------------------------------
r11073 | divverent | 2011-04-20 06:56:53 -0700 (Wed, 20 Apr 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

do NOT use the crc inside the file name for .po file loading
------------------------------------------------------------------------
r11072 | divverent | 2011-04-20 00:32:01 -0700 (Wed, 20 Apr 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/crypto.c

fix compile failure in crypto.c
------------------------------------------------------------------------
r11071 | havoc | 2011-04-19 11:15:09 -0700 (Tue, 19 Apr 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/shader_glsl.h

fix a comment about ftransform

------------------------------------------------------------------------
r11070 | divverent | 2011-04-19 09:32:54 -0700 (Tue, 19 Apr 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/menu.c

fix a segfault in menu routing when switching gamedirs
------------------------------------------------------------------------
r11069 | divverent | 2011-04-19 09:32:51 -0700 (Tue, 19 Apr 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/cvar.c

fix a bug in cvar hash handling

causing loadconfig to mess up cvar hashing
------------------------------------------------------------------------
r11068 | divverent | 2011-04-19 08:31:26 -0700 (Tue, 19 Apr 2011) | 12 lines
Changed paths:
   M /trunk/darkplaces/crypto.c

crypto: avoid generating control-like packets

In non-AES mode, we now replace packets whose hash starts with FFFFFFFF by
7FFFFFFF, and 8000LLLL by 0000LLLL. When decoding, packets with these prefixes
have two attempts.

AES encrypted mode is unaffected by this, as there packets always start with a
byte from 00 to 0F.

Also, no longer whine about receiving packets that fail the HMAC test when the
packets look like control packets (the NQ CONNECT packet DP sends when
connecting sometimes was received in time for this to match).
------------------------------------------------------------------------
r11067 | havoc | 2011-04-18 09:16:15 -0700 (Mon, 18 Apr 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/vid_sdl.c

disabled glBegin, glEnd, glPolygonMode wrapper functions in GLES2 init
because the r_showtris/r_shownormals code now checks if these are NULL

------------------------------------------------------------------------
r11066 | havoc | 2011-04-18 09:09:41 -0700 (Mon, 18 Apr 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c

added RENDERPATH_GLES1

------------------------------------------------------------------------
r11065 | havoc | 2011-04-18 09:07:13 -0700 (Mon, 18 Apr 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/quakedef.h

fix typo in last commit

------------------------------------------------------------------------
r11064 | havoc | 2011-04-18 08:38:32 -0700 (Mon, 18 Apr 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/quakedef.h

move iphone detection above macosx detection

------------------------------------------------------------------------
r11063 | havoc | 2011-04-18 08:35:46 -0700 (Mon, 18 Apr 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/vid_sdl.c

separate out the GLES2 stuff from the iphone stuff

------------------------------------------------------------------------
r11062 | havoc | 2011-04-17 13:05:27 -0700 (Sun, 17 Apr 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

made r_showoverdraw honor material face culling settings

------------------------------------------------------------------------
r11061 | havoc | 2011-04-17 11:22:30 -0700 (Sun, 17 Apr 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/render.h

added r_showoverdraw cvar which allows you to see how many draws per
pixel, white = 8 surfaces on the pixel (can be varied by changing cvar
to 0.5 or similar)

------------------------------------------------------------------------
r11060 | havoc | 2011-04-17 11:07:58 -0700 (Sun, 17 Apr 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fix cullentities trace on q1bsp, it was broken by the
TraceLineAgainstSurfaces patch

------------------------------------------------------------------------
r11059 | havoc | 2011-04-14 10:33:02 -0700 (Thu, 14 Apr 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_sdl.c

undo an accidental r_test commit in vid_sdl.c

------------------------------------------------------------------------
r11058 | divverent | 2011-04-13 12:24:39 -0700 (Wed, 13 Apr 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

make dpoffsetscale apply again
------------------------------------------------------------------------
r11057 | divverent | 2011-04-13 10:05:59 -0700 (Wed, 13 Apr 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/shader_glsl.h

fix a typo causing moire with offsetmapping
------------------------------------------------------------------------
r11056 | divverent | 2011-04-13 09:07:26 -0700 (Wed, 13 Apr 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/shader_glsl.h
   M /trunk/darkplaces/shader_hlsl.h

new cvar: r_glsl_offsetmapping_reliefmapping_refinesteps (default 5)
------------------------------------------------------------------------
r11055 | divverent | 2011-04-12 13:34:40 -0700 (Tue, 12 Apr 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/model_brush.c

fix loading "g"-less .obj files
------------------------------------------------------------------------
r11054 | divverent | 2011-04-12 13:05:04 -0700 (Tue, 12 Apr 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/model_brush.c

avoid some crashes when recursing BIHs
------------------------------------------------------------------------
r11053 | havoc | 2011-04-12 07:10:10 -0700 (Tue, 12 Apr 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

fix a typo

------------------------------------------------------------------------
r11052 | divverent | 2011-04-11 22:12:58 -0700 (Mon, 11 Apr 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/vid_glx.c

oops, fix last fix
------------------------------------------------------------------------
r11051 | divverent | 2011-04-11 21:53:57 -0700 (Mon, 11 Apr 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/vid_glx.c

fix an engine crash in vid_glx
------------------------------------------------------------------------
r11050 | divverent | 2011-04-10 23:51:56 -0700 (Sun, 10 Apr 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

fix mingw breakage on Ubuntu
------------------------------------------------------------------------
r11049 | havoc | 2011-04-10 22:18:12 -0700 (Sun, 10 Apr 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

remove the never-finished first incarnation of obj loading code, the
second incarnation is alive and well

------------------------------------------------------------------------
r11048 | divverent | 2011-04-10 12:23:57 -0700 (Sun, 10 Apr 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

fix compilation of dpsoftrast on mingw32 (use Interlocked* instead of __sync_*)
------------------------------------------------------------------------
r11047 | divverent | 2011-04-10 12:07:28 -0700 (Sun, 10 Apr 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/host.c

break the net connection AFTER calling ClientDisconnect; this fixes issues with clienttype(self) in ClientDisconnect
------------------------------------------------------------------------
r11046 | havoc | 2011-04-10 09:00:21 -0700 (Sun, 10 Apr 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_mix.c

don't infinite loop if a sound has total_length 0

------------------------------------------------------------------------
r11045 | havoc | 2011-04-10 05:50:11 -0700 (Sun, 10 Apr 2011) | 8 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/image.h
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_sprite.c
   M /trunk/darkplaces/r_lightning.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/r_textures.h
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c

implemented support for GL_EXT_texture_sRGB to preserve precision if
supported (otherwise it just converts to linear and uses regular texture
formats)
renamed r_texture_convertsRGB_ cvars to r_texture_sRGB_ and broke out
the individual skin textures as separate cvars
added vid.forcetextype which allows particular renderpaths to force
desired texture component layouts (GL_RGBA for GLES, otherwise GL_BGRA)

------------------------------------------------------------------------
r11044 | divverent | 2011-04-09 22:26:56 -0700 (Sat, 09 Apr 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

fix the same bugs as before in strireplace
------------------------------------------------------------------------
r11043 | divverent | 2011-04-09 22:21:59 -0700 (Sat, 09 Apr 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

r_showsurfaces 3: render sky (appears as average-colored box sides)
------------------------------------------------------------------------
r11042 | havoc | 2011-04-09 10:11:18 -0700 (Sat, 09 Apr 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

correct a cvar comment now that directional shading uses 8x data

------------------------------------------------------------------------
r11041 | havoc | 2011-04-09 10:09:18 -0700 (Sat, 09 Apr 2011) | 6 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/shader_glsl.h

redesigned r_shadow_bouncegrid_static_directionalshading - it now uses 6
vectors per pixel instead of 3, giving much more accurate shading
added r_shadow_bouncegrid_includedirectlighting cvar - if turned on this
enables direct lighting in the bouncegrid
cleaned up directionalshading code significantly

------------------------------------------------------------------------
r11040 | havoc | 2011-04-08 21:17:36 -0700 (Fri, 08 Apr 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

don't use GL_RGBA internalformat on opaque textures (thanks to Rock for
reporting this bug)

------------------------------------------------------------------------
r11039 | divverent | 2011-04-08 10:49:18 -0700 (Fri, 08 Apr 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

clang has _mm_cvtss_f32 but not __builtin_ia32_vec_ext_v4sf
------------------------------------------------------------------------
r11038 | havoc | 2011-04-08 09:38:11 -0700 (Fri, 08 Apr 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

some cleanup of offsetmapping setup code

------------------------------------------------------------------------
r11037 | havoc | 2011-04-08 09:37:50 -0700 (Fri, 08 Apr 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c

added mod_noshader_default_offsetmapping to allow separate control over
external textures that have no q3 shader

------------------------------------------------------------------------
r11036 | havoc | 2011-04-08 09:10:44 -0700 (Fri, 08 Apr 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

when loading q1bsp textures, do not allow q3 shader loading to overwrite
default parameters

------------------------------------------------------------------------
r11035 | havoc | 2011-04-08 08:23:10 -0700 (Fri, 08 Apr 2011) | 6 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

rewrote mod_collision_bih tracing code, the functions are no longer
recursive (small speed boost), line traces are about 12% faster due to
more precise culling of leafs (the code is however huge and nasty), BIH
TraceBrush is now considerably faster due to the same techniques, it was
previously very unoptimized 

------------------------------------------------------------------------
r11034 | divverent | 2011-04-06 13:24:30 -0700 (Wed, 06 Apr 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

fix multiple bugs in strreplace

bug 1: if search string is empty, an endless loop occurs
bug 2: searching for "foo" in "fo" is actually found, and replaced!
------------------------------------------------------------------------
r11033 | eihrul | 2011-04-06 09:37:31 -0700 (Wed, 06 Apr 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

more concise version of Texture2DBGRA8

------------------------------------------------------------------------
r11032 | divverent | 2011-04-06 09:32:03 -0700 (Wed, 06 Apr 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

implement MODE_WATER
------------------------------------------------------------------------
r11031 | divverent | 2011-04-06 09:32:00 -0700 (Wed, 06 Apr 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

make MODE_REFRACTION not use TEXCOORD1..3 to help MODE_WATER use the same code
------------------------------------------------------------------------
r11030 | divverent | 2011-04-06 08:26:08 -0700 (Wed, 06 Apr 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

preparation for MODE_WATER: refactor the pixel getting out of MODE_REFRACTION
------------------------------------------------------------------------
r11029 | eihrul | 2011-04-05 11:40:01 -0700 (Tue, 05 Apr 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_sdl.c

use ASYNCBLIT by default

------------------------------------------------------------------------
r11028 | divverent | 2011-04-05 11:06:10 -0700 (Tue, 05 Apr 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/vid_glx.c

make vid_glx also clear fullscreen properly
------------------------------------------------------------------------
r11027 | divverent | 2011-04-05 10:41:10 -0700 (Tue, 05 Apr 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/vid_glx.c

only use ONE buffer for non-Xshm
------------------------------------------------------------------------
r11026 | divverent | 2011-04-05 10:28:32 -0700 (Tue, 05 Apr 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/vid_glx.c

sanity check the visual obtained
------------------------------------------------------------------------
r11025 | divverent | 2011-04-05 10:19:56 -0700 (Tue, 05 Apr 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/makefile.inc
   A /trunk/darkplaces/thread_pthread.c
   M /trunk/darkplaces/vid_glx.c

XShm and pthreads support for vid_glx dpsoftrast
------------------------------------------------------------------------
r11024 | eihrul | 2011-04-05 01:57:38 -0700 (Tue, 05 Apr 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

workaround for missing _mm_cvtss_f32 on some gcc versionsx

------------------------------------------------------------------------
r11023 | havoc | 2011-04-05 00:51:52 -0700 (Tue, 05 Apr 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_rmain.c

added backface culling optimization to cl_decals_newsystem, this helps
in many cases

------------------------------------------------------------------------
r11022 | eihrul | 2011-04-04 14:21:49 -0700 (Mon, 04 Apr 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

optimize scanning for 0 alpha in FinishBGRA8

------------------------------------------------------------------------
r11021 | eihrul | 2011-04-04 13:21:15 -0700 (Mon, 04 Apr 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

FinishBGRA8 optimization and fixes

------------------------------------------------------------------------
r11020 | eihrul | 2011-04-04 12:51:25 -0700 (Mon, 04 Apr 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c
   M /trunk/darkplaces/gl_rmain.c

fix some clipping plane bugs and FinishBGRA8 bug introduced in r11015

------------------------------------------------------------------------
r11019 | havoc | 2011-04-04 08:47:46 -0700 (Mon, 04 Apr 2011) | 6 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

removed unused function DPSOFTRAST_Draw_Span_Finish
refactored parts of DPSOFTRAST_Draw_ProcessSpans into two functions -
DPSOFTRAST_Draw_DepthTest and DPSOFTRAST_Draw_DepthWrite
moved stack variable pixelmask to thread->pixelmaskarray
added depthbase and depthslope to span structure, computed at creation

------------------------------------------------------------------------
r11018 | eihrul | 2011-04-04 07:53:06 -0700 (Mon, 04 Apr 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

clipplane validation fix

------------------------------------------------------------------------
r11017 | havoc | 2011-04-04 07:41:28 -0700 (Mon, 04 Apr 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

added simple affine check to accelerate texture fetches on 2D art

------------------------------------------------------------------------
r11016 | eihrul | 2011-04-04 07:31:32 -0700 (Mon, 04 Apr 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c
   M /trunk/darkplaces/dpsoftrast.h
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_rmain.c

initial support for user clipping plane in dpsoftrast

------------------------------------------------------------------------
r11015 | havoc | 2011-04-04 05:30:15 -0700 (Mon, 04 Apr 2011) | 6 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

changed pixelmask processing in DPSOFTRAST_Draw_Span_FinishBGRA8 to
clear pixelmask values when doing alphablend if the pixels have zero
alpha, and also to use a double loop approach which removes the checks
from the blending inner loops...  this seems to have only a slight fps
gain in Quake though

------------------------------------------------------------------------
r11014 | eihrul | 2011-04-02 13:29:18 -0700 (Sat, 02 Apr 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix flipped scissor coordinates in dpsoftrast render path

------------------------------------------------------------------------
r11013 | havoc | 2011-04-02 09:55:32 -0700 (Sat, 02 Apr 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

slight optimization to 2D rendering - if triangle wslope is 0, don't
bother doing any math, just fill the zf array

------------------------------------------------------------------------
r11012 | havoc | 2011-04-01 21:38:13 -0700 (Fri, 01 Apr 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.inc

enable SSE2 instructions when compiling dpsoftrast.c

------------------------------------------------------------------------
r11011 | divverent | 2011-04-01 16:07:04 -0700 (Fri, 01 Apr 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/vid_glx.c

very basic softrast support in vid_glx.c. VERY SLOW, as it doesn't use an Xtension yet.
------------------------------------------------------------------------
r11010 | eihrul | 2011-04-01 14:05:36 -0700 (Fri, 01 Apr 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

fix the 0.5-fix

------------------------------------------------------------------------
r11009 | divverent | 2011-04-01 14:00:18 -0700 (Fri, 01 Apr 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

dpsoftrast: fix off-by-0.5 in GL_NEAREST
------------------------------------------------------------------------
r11008 | divverent | 2011-04-01 13:50:40 -0700 (Fri, 01 Apr 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

fix texture filtering accuracy bugs in the C variant (12bit vs 16bit) in softrast
------------------------------------------------------------------------
r11007 | divverent | 2011-04-01 13:16:53 -0700 (Fri, 01 Apr 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_screen.c

possibly fix offset calc for infobar
------------------------------------------------------------------------
r11006 | havoc | 2011-04-01 08:02:51 -0700 (Fri, 01 Apr 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/quakedef.h

fix compilation when SSE2_PRESENT, also fix compilation without SSE_POSSIBLE

------------------------------------------------------------------------
r11005 | havoc | 2011-04-01 07:59:17 -0700 (Fri, 01 Apr 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/darkplaces-wgl.vcproj
   M /trunk/darkplaces/dpsoftrast.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/sys_shared.c
   A /trunk/darkplaces/thread_win.c
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c

WGL client can now use DPSOFTRAST, added thread_win.c to avoid SDL dependency for WGL client
added Sys_HaveSSE and Sys_HaveSSE2 functions in sys_shared.c and cleaned up that mess in model_alias.c
dpsoftrast now compiles if SSE_POSSIBLE rather than SSE2_PRESENT, and uses Sys_HaveSSE2 for runtime detection on x86

------------------------------------------------------------------------
r11004 | eihrul | 2011-04-01 07:40:48 -0700 (Fri, 01 Apr 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

fix Vertex_BoundY params

------------------------------------------------------------------------
r11003 | havoc | 2011-04-01 02:40:57 -0700 (Fri, 01 Apr 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/vid_agl.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_sdl.c

added GL_Finish function in backend, to centralize all the qglFinish
calls and accommodate other render paths in such cases

------------------------------------------------------------------------
r11002 | eihrul | 2011-04-01 02:09:10 -0700 (Fri, 01 Apr 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

fb validation fix

------------------------------------------------------------------------
r11001 | havoc | 2011-04-01 02:08:39 -0700 (Fri, 01 Apr 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

enable gloss texture loading in GLES2 path

------------------------------------------------------------------------
r11000 | havoc | 2011-04-01 01:42:00 -0700 (Fri, 01 Apr 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

make r_hdr behave like r_bloom when r_viewfbo is on

------------------------------------------------------------------------
r10999 | havoc | 2011-04-01 01:11:16 -0700 (Fri, 01 Apr 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

added support for dpsoftrast synchronization for fpsscaling

------------------------------------------------------------------------
r10998 | havoc | 2011-04-01 00:23:17 -0700 (Fri, 01 Apr 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

don't crash on NULL texture upload in dpsoftrast

------------------------------------------------------------------------
r10997 | havoc | 2011-04-01 00:09:51 -0700 (Fri, 01 Apr 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

changed default r_viewscale_fpsscaling_min from 0.25 (25% pixels, 50%
width/height) to 0.0625 (6.25% pixels, 25% width/height)

------------------------------------------------------------------------
r10996 | havoc | 2011-04-01 00:06:28 -0700 (Fri, 01 Apr 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

changed default r_viewscale_fpsscaling_target from 90 to 70, this still
works well with vid_vsync

------------------------------------------------------------------------
r10995 | havoc | 2011-04-01 00:04:58 -0700 (Fri, 01 Apr 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_rmain.c

reworked r_viewscale_fpsscaling to use the time of SCR_DrawScreen
wrapped in glFinish calls (REALLY should use GL_EXT_timery_query), this
means that vid_vsync now works fine with it

------------------------------------------------------------------------
r10994 | havoc | 2011-03-31 22:46:28 -0700 (Thu, 31 Mar 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

added r_viewscale_fpsscaling and various cvars for it, this enables
variable resolution rendering based on framerate (does not work properly
with vsync)

------------------------------------------------------------------------
r10993 | havoc | 2011-03-31 18:04:12 -0700 (Thu, 31 Mar 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_rmain.c

r_viewscale now works (with or without r_viewfbo), this allows reduced
resolution rendering for higher performance, at native screen
resolutions

------------------------------------------------------------------------
r10992 | havoc | 2011-03-31 18:03:30 -0700 (Thu, 31 Mar 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

upload NULL textures as NULL textures, rather than creating a big array
of zeros to upload

------------------------------------------------------------------------
r10991 | havoc | 2011-03-31 16:58:16 -0700 (Thu, 31 Mar 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fixed viewsize issues with r_viewfbo

------------------------------------------------------------------------
r10990 | divverent | 2011-03-31 11:14:20 -0700 (Thu, 31 Mar 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/sys_linux.c
   M /trunk/darkplaces/sys_sdl.c
   M /trunk/darkplaces/vid_sdl.c

sys_linux, sys_sdl: support options -noterminal and -stderr to define which fd gets output. Helps when using vid_soft/SDL/libcaca/ncurses ;)
------------------------------------------------------------------------
r10989 | havoc | 2011-03-31 06:17:15 -0700 (Thu, 31 Mar 2011) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/dpsoftrast.h
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_textures.h

added r_viewfbo and r_viewscale cvars - the former allows use of
GL_RGBA16F and GL_RGBA32F framebuffer rendering for 3D views (the main
refresh is not altered), the latter will allow scaling view rendering
resolution independently of video resolution, when implemented

------------------------------------------------------------------------
r10988 | divverent | 2011-03-30 14:27:16 -0700 (Wed, 30 Mar 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

fix the alpha bug in dpsoftrast.c
------------------------------------------------------------------------
r10987 | divverent | 2011-03-30 14:17:19 -0700 (Wed, 30 Mar 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c
   M /trunk/darkplaces/shader_glsl.h

a fix for dpsoftrast refractions by eihrul
------------------------------------------------------------------------
r10986 | divverent | 2011-03-30 14:17:16 -0700 (Wed, 30 Mar 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c
   M /trunk/darkplaces/shader_glsl.h

start implementing REFRACTION
------------------------------------------------------------------------
r10985 | divverent | 2011-03-29 22:47:58 -0700 (Tue, 29 Mar 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c
   M /trunk/darkplaces/dpsoftrast.h
   M /trunk/darkplaces/gl_rmain.c

dpsoftrast: support r_shadow_glossexact
------------------------------------------------------------------------
r10984 | divverent | 2011-03-29 22:47:53 -0700 (Tue, 29 Mar 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

dpsoftrast: speed up deluxemapping a bit; support tangentspace deluxemapping too; support fakelight too
------------------------------------------------------------------------
r10983 | havoc | 2011-03-29 16:15:08 -0700 (Tue, 29 Mar 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/shader_glsl.h

r_shadow_deferred now checks for r_shadow_gloss 0 and does not use the
second color attachment if so, giving a modest speed boost for testing
but deferred is still way too slow for practical use even with this...

------------------------------------------------------------------------
r10982 | havoc | 2011-03-29 15:40:25 -0700 (Tue, 29 Mar 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix bouncegrid intensity so it reacts to r_hdr_scenebrightness and r_hdr

------------------------------------------------------------------------
r10981 | havoc | 2011-03-28 18:32:20 -0700 (Mon, 28 Mar 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_sdl.c

hush some unrecognized SDL event type warnings

------------------------------------------------------------------------
r10980 | havoc | 2011-03-28 16:00:30 -0700 (Mon, 28 Mar 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_wgl.c

added joy_axiskeyevents_deadzone cvar which makes the arrow key
emulation far less sensitive

------------------------------------------------------------------------
r10979 | havoc | 2011-03-28 04:48:21 -0700 (Mon, 28 Mar 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/collision.c

make sure collision cache parameter struct is the same every frame by
using memset first

------------------------------------------------------------------------
r10978 | havoc | 2011-03-28 04:36:41 -0700 (Mon, 28 Mar 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

r_shadow_bouncegrid_particleintensity changed from 2 to 1 because it was
overwhelming (still is quite bright...)

------------------------------------------------------------------------
r10977 | havoc | 2011-03-28 03:48:22 -0700 (Mon, 28 Mar 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/gl_rsurf.c

fix some warnings

------------------------------------------------------------------------
r10976 | havoc | 2011-03-28 03:47:53 -0700 (Mon, 28 Mar 2011) | 6 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

restore the active rtlights check in bouncegrid
memset the bouncegrid settings struct to make it consistently pass the
memcmp check even if some bytes are not set
improved bouncegrid dynamic mode size check to compare pixel count
rather than individual dimensions

------------------------------------------------------------------------
r10975 | havoc | 2011-03-28 03:18:01 -0700 (Mon, 28 Mar 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

remove check for active rtlights in bouncegrid because it was not
working

------------------------------------------------------------------------
r10974 | havoc | 2011-03-28 02:59:12 -0700 (Mon, 28 Mar 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

better detection of active rtlights in bouncegrid code

------------------------------------------------------------------------
r10973 | havoc | 2011-03-28 00:16:34 -0700 (Mon, 28 Mar 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

do not use light scissoring on deferred lighting mode, it often yields
strange artifacts on shadowless lights

------------------------------------------------------------------------
r10972 | havoc | 2011-03-28 00:15:19 -0700 (Mon, 28 Mar 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

disallow r_shadow_bouncegrid on renderpaths that do not support it

------------------------------------------------------------------------
r10971 | havoc | 2011-03-27 23:56:32 -0700 (Sun, 27 Mar 2011) | 7 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

added r_shadow_bouncegrid_static cvar which makes a proper static mode
and this is now the default, its framerate cost is very low and it makes
realtime world lighting look nicer, tweaked all relevant cvars for this
detect whether any lights warrant bouncegrid each frame - this means
that the cvar could be defaulted on and still do nothing when realtime
world lighting is turned off

------------------------------------------------------------------------
r10970 | divverent | 2011-03-26 23:20:51 -0700 (Sat, 26 Mar 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix a crash in RSurf_DrawBatch_GL11_MakeFogColor
------------------------------------------------------------------------
r10969 | divverent | 2011-03-26 12:12:04 -0700 (Sat, 26 Mar 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/shader_glsl.h

last commit was a bad fix - fix it correctly, preventing reliefmapping artifacts on these pesky reflections
------------------------------------------------------------------------
r10968 | divverent | 2011-03-26 11:59:26 -0700 (Sat, 26 Mar 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/shader_glsl.h

fix a compile error in refractions
------------------------------------------------------------------------
r10967 | divverent | 2011-03-25 14:39:02 -0700 (Fri, 25 Mar 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/shader_glsl.h

fix another dp_shadow2D call
------------------------------------------------------------------------
r10966 | havoc | 2011-03-25 14:32:17 -0700 (Fri, 25 Mar 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/shader_glsl.h

fix some GLSL warnings

------------------------------------------------------------------------
r10965 | havoc | 2011-03-25 14:11:04 -0700 (Fri, 25 Mar 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

prevent crashes on BIH code

------------------------------------------------------------------------
r10964 | divverent | 2011-03-25 13:57:26 -0700 (Fri, 25 Mar 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/protocol.c

speed up packet loss handling by changing EntityFrame5_LostFrame from O(states^2*edictsperstate^2) to O(MAX_EDICTS + states*edictsperstate)
------------------------------------------------------------------------
r10963 | vortex | 2011-03-24 16:13:40 -0700 (Thu, 24 Mar 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h
   M /trunk/darkplaces/r_sprites.c

Add R_LightPoint which is fast version of R_CompleteLightPoint that only grabs ambient color to use with litsprites and particles. Fix bug in R_CompleteLightPoint (RTWORLD and DYNLIGHT wasnt processed if LP_LIGHTMAP flag is there). New trick for SPR_OVERHEAD (a bit of additional rotation).
------------------------------------------------------------------------
r10962 | divverent | 2011-03-23 13:09:21 -0700 (Wed, 23 Mar 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/model_brush.c

make the endless loop run in 3 milliseconds (fixes BIH TracePoint)
------------------------------------------------------------------------
r10961 | divverent | 2011-03-23 12:57:52 -0700 (Wed, 23 Mar 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_execprogram.h

fix PRVM error and warning backtrace display
------------------------------------------------------------------------
r10960 | divverent | 2011-03-23 03:36:16 -0700 (Wed, 23 Mar 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/shader_glsl.h

we need one more glsl 130 compat ifdef...
------------------------------------------------------------------------
r10959 | havoc | 2011-03-22 14:44:18 -0700 (Tue, 22 Mar 2011) | 5 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

changed default r_useportalculling from 1 to 2, this forces use of it on
vised maps, because although it only gives minor gains (and sometimes
minor losses) in quake maps, it gives substantial gains in outdoor maps,
particularly when viewed from overhead, such as in steelstorm

------------------------------------------------------------------------
r10958 | vortex | 2011-03-22 08:15:59 -0700 (Tue, 22 Mar 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/shader_glsl.h

GLSL shader: make dp_waterscroll work with dp_reflect and dp_refract
------------------------------------------------------------------------
r10957 | havoc | 2011-03-21 00:10:16 -0700 (Mon, 21 Mar 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

enable another AABB overlap check, this time on point tests

------------------------------------------------------------------------
r10956 | havoc | 2011-03-21 00:08:25 -0700 (Mon, 21 Mar 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

increased bih traceline speed by nearly 50% by enabling an additional
AABB overlap check

------------------------------------------------------------------------
r10955 | havoc | 2011-03-20 23:57:28 -0700 (Sun, 20 Mar 2011) | 7 lines
Changed paths:
   M /trunk/darkplaces/bih.c
   M /trunk/darkplaces/bih.h
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c

BIH building and recursion no longer directly links leaf nodes into the
hierarchy, they are only used by unordered children group nodes
changed BIH_MAXUNORDEREDCHILDREN to 8 and removed
mod_collision_bih_childrengrouping cvar because this seems to be the
optimal value (values up to 16 sometimes yield minor gains but not
consistent)

------------------------------------------------------------------------
r10954 | havoc | 2011-03-20 23:14:02 -0700 (Sun, 20 Mar 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/bih.c
   M /trunk/darkplaces/bih.h
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c

added mod_collision_bih_childrengrouping cvar (default 16), this
accelerates BIH traces by using a shallower tree

------------------------------------------------------------------------
r10953 | havoc | 2011-03-20 23:11:48 -0700 (Sun, 20 Mar 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c

fix some disabled code so that it could compile again

------------------------------------------------------------------------
r10952 | eihrul | 2011-03-20 14:17:01 -0700 (Sun, 20 Mar 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

swap out some _mm_stream_ps usage

------------------------------------------------------------------------
r10951 | divverent | 2011-03-20 12:44:49 -0700 (Sun, 20 Mar 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

fix GL20TU list for deluxemapping
------------------------------------------------------------------------
r10950 | divverent | 2011-03-20 10:31:23 -0700 (Sun, 20 Mar 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

deluxemapping support for dpsoftrast
------------------------------------------------------------------------
r10949 | eihrul | 2011-03-20 09:00:58 -0700 (Sun, 20 Mar 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

saturated bloom subtract

------------------------------------------------------------------------
r10948 | eihrul | 2011-03-20 08:23:27 -0700 (Sun, 20 Mar 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

fix post-process shader using invalid texcoord array

------------------------------------------------------------------------
r10947 | eihrul | 2011-03-20 07:32:43 -0700 (Sun, 20 Mar 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

fix row order of screen to texture copies

------------------------------------------------------------------------
r10946 | eihrul | 2011-03-20 07:14:47 -0700 (Sun, 20 Mar 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

fix some redundant shuffles

------------------------------------------------------------------------
r10945 | havoc | 2011-03-20 06:32:18 -0700 (Sun, 20 Mar 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_video.c

make it easier to benchmark steelstorm by stopping video playback when
a serverinfo packet is received, and ignoring attempts to connect to a
server when -benchmark is used

------------------------------------------------------------------------
r10944 | havoc | 2011-03-19 16:41:58 -0700 (Sat, 19 Mar 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c

default vid_netwmfullscreen to 0 again because it doesn't work with
XVideMode, and XRandR isn't implemented yet

------------------------------------------------------------------------
r10943 | havoc | 2011-03-19 15:36:02 -0700 (Sat, 19 Mar 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

added r_usesurfaceculling cvar which defaults on, this new code reduces
the number of surfaces drawn each frame, which is not always a speed
gain but is usually helpful

------------------------------------------------------------------------
r10942 | vortex | 2011-03-19 15:13:11 -0700 (Sat, 19 Mar 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/gl_rmain.c

add "r_fog_clear" cvar which allows to disable framebuffer clearing to fog color (helps to fix bad borders on water reflections if fog is used), still, some old maps may want r_fog_clear = 1
------------------------------------------------------------------------
r10941 | havoc | 2011-03-19 14:47:01 -0700 (Sat, 19 Mar 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/todo

fix an array index out of bounds error on
SHADERSTATICPARM_VERTEXTEXTUREBLEND_USEBOTHALPHAS

------------------------------------------------------------------------
r10940 | divverent | 2011-03-19 14:03:09 -0700 (Sat, 19 Mar 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/shader_glsl.h

fix a syntax error in the non-glsl13 case
------------------------------------------------------------------------
r10939 | divverent | 2011-03-19 14:02:35 -0700 (Sat, 19 Mar 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_video_jamdecode.c
   M /trunk/darkplaces/shader_glsl.h
   M /trunk/darkplaces/shader_hlsl.h

remove CRLFs added by last commit
------------------------------------------------------------------------
r10938 | vortex | 2011-03-19 13:47:35 -0700 (Sat, 19 Mar 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_video.c
   A /trunk/darkplaces/cl_video_jamdecode.c

Added JAM video decoder plugin, used by Blood Omnicide

------------------------------------------------------------------------
r10937 | vortex | 2011-03-19 13:26:54 -0700 (Sat, 19 Mar 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/shader_glsl.h
   M /trunk/darkplaces/shader_hlsl.h

Add "Both Alphas" technique for VertexTextureBlend (use both layer alpha's for microblending), toggled globally by "r_glsl_vertextextureblend_usebothalphas" cvar.
------------------------------------------------------------------------
r10936 | vortex | 2011-03-19 13:24:43 -0700 (Sat, 19 Mar 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/r_shadow.c

Add "originscale" parameter to r_editlights (may be useful if map was scaled)
------------------------------------------------------------------------
r10935 | vortex | 2011-03-19 13:23:39 -0700 (Sat, 19 Mar 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/client.h

dynamically grow maxtempentities
------------------------------------------------------------------------
r10934 | havoc | 2011-03-19 11:50:30 -0700 (Sat, 19 Mar 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c

use vid_netwmfullscreen 1 by default (yes I know auto-detection is not
coded, but xorg supports it so I don't really care...)

------------------------------------------------------------------------
r10933 | vortex | 2011-03-19 10:37:07 -0700 (Sat, 19 Mar 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_main.c

add -maxtempents switch to increase starting 256/4000 tempentities limit.
------------------------------------------------------------------------
r10932 | divverent | 2011-03-19 08:44:19 -0700 (Sat, 19 Mar 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/shader_glsl.h

define GLSL version explicitly to work around a problem with ATI/AMD drivers not getting __VERSION__ right (?)

From: Maik Merten <maikmerten@googlemail.com>
------------------------------------------------------------------------
r10931 | divverent | 2011-03-19 05:47:55 -0700 (Sat, 19 Mar 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/shader_glsl.h

fix a possible glsl compile error (no idea why it didn't throw any yet, weird cpp on nvidia?)
------------------------------------------------------------------------
r10930 | divverent | 2011-03-19 05:23:09 -0700 (Sat, 19 Mar 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_execprogram.h

turn "assignment to world" from dprint into warning (so backtraces can work)
------------------------------------------------------------------------
r10929 | divverent | 2011-03-18 04:03:31 -0700 (Fri, 18 Mar 2011) | 5 lines
Changed paths:
   M /trunk/darkplaces/keys.c

new con_closeontoggleconsole logic:

1 now only works at the start of the line, for all toggleconsole keys
2 works anywhere, if the key is not ^
3 works anywhere, even if the key is ^
------------------------------------------------------------------------
r10928 | havoc | 2011-03-17 10:52:31 -0700 (Thu, 17 Mar 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

change default r_shadow_deferred_8bitrange to 4 to reduce saturating
artifacts in common usage

------------------------------------------------------------------------
r10927 | havoc | 2011-03-17 10:34:47 -0700 (Thu, 17 Mar 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/shader_glsl.h

fixes for GLSL syntax errors in the deferred geometry shader

------------------------------------------------------------------------
r10926 | havoc | 2011-03-17 09:50:33 -0700 (Thu, 17 Mar 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

avoid a crash when creating model decals if RSurf_ActiveModel does not
produce normals (why not?)

------------------------------------------------------------------------
r10925 | havoc | 2011-03-14 05:34:49 -0700 (Mon, 14 Mar 2011) | 5 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h
   M /trunk/darkplaces/shader_glsl.h

added r_shadow_bouncegrid_directionalshading cvar, if enabled this uses
a much larger texture to store first-order spherical harmonics data
(average color and directional gradients) for bumpmapped diffuse shading
which also reduces light-bleed issues on thin walls

------------------------------------------------------------------------
r10924 | havoc | 2011-03-14 05:29:33 -0700 (Mon, 14 Mar 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix a crash on r_restart related to collision caching

------------------------------------------------------------------------
r10923 | havoc | 2011-03-14 01:43:27 -0700 (Mon, 14 Mar 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/vid_sdl.c

improved vid_touchscreen - it now adapts to screen shape (using
corner-relative values) and is compatible with mouse input for testing

------------------------------------------------------------------------
r10922 | divverent | 2011-03-13 11:08:47 -0700 (Sun, 13 Mar 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/dpsoftrast.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/shader_glsl.h
   M /trunk/darkplaces/shader_hlsl.h

add cvars r_glsl_offsetmapping_steps and r_glsl_offsetmapping_reliefmapping_steps
------------------------------------------------------------------------
r10921 | divverent | 2011-03-13 10:19:32 -0700 (Sun, 13 Mar 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/shader_glsl.h

huge glsl change: avoid #defining reserved keywords
------------------------------------------------------------------------
r10920 | divverent | 2011-03-13 10:19:24 -0700 (Sun, 13 Mar 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/shader_glsl.h

fix some warnings in the shader
------------------------------------------------------------------------
r10919 | divverent | 2011-03-13 10:19:18 -0700 (Sun, 13 Mar 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_shared.c

properly detect glsl 1.3 support
------------------------------------------------------------------------
r10918 | divverent | 2011-03-13 07:21:35 -0700 (Sun, 13 Mar 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/shader_glsl.h

better support non-GLSL130 in offsetmapping
------------------------------------------------------------------------
r10917 | havoc | 2011-03-13 03:43:03 -0700 (Sun, 13 Mar 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/shader_glsl.h

reduced number of varying variables required in a certain case in
steelstorm by 1, to bring the shader within limits of older cards

------------------------------------------------------------------------
r10916 | havoc | 2011-03-13 03:23:00 -0700 (Sun, 13 Mar 2011) | 6 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

r_shadow_bouncegrid now uses floats for accumulating photons, to allow
higher photon counts without issues
minor optimization to r_shadow_bouncegrid pixel conversion (now does a
batch conversion on the array rather than on each photon contribution)
removed r_shadow_bouncegrid_nolerpsplat cvar to reduce code

------------------------------------------------------------------------
r10915 | havoc | 2011-03-12 23:39:13 -0800 (Sat, 12 Mar 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/shader_hlsl.h

fix an HLSL warning

------------------------------------------------------------------------
r10914 | havoc | 2011-03-12 23:23:48 -0800 (Sat, 12 Mar 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/shader_hlsl.h

fix a typo (Fogcolor should be FogColor)

------------------------------------------------------------------------
r10913 | divverent | 2011-03-12 12:46:27 -0800 (Sat, 12 Mar 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/shader_glsl.h
   M /trunk/darkplaces/shader_hlsl.h
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_shared.c

fix offset/reliefmapping by using the proper miplevel - NOTE: this makes use of a GLSL 1.30 function in offsetmapping, non-GLSL 1.30 drivers will have to degrade
------------------------------------------------------------------------
r10912 | havoc | 2011-03-12 06:42:17 -0800 (Sat, 12 Mar 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/collision.c

slight speedup to collision_cache by using individual field compares
rather than memcmp

------------------------------------------------------------------------
r10911 | havoc | 2011-03-12 06:01:11 -0800 (Sat, 12 Mar 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/collision.c

redesigned most of collision_cache code, cleaner and faster

------------------------------------------------------------------------
r10910 | havoc | 2011-03-12 02:56:44 -0800 (Sat, 12 Mar 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/collision.c
   M /trunk/darkplaces/todo

significant speed gain on collision_cache 1 by tweaking some numbers

------------------------------------------------------------------------
r10909 | havoc | 2011-03-11 21:40:32 -0800 (Fri, 11 Mar 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/shader_glsl.h

reduce number of varying variables required in shaders by 1

------------------------------------------------------------------------
r10908 | havoc | 2011-03-11 14:56:02 -0800 (Fri, 11 Mar 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/collision.c

fix two C++ errors

------------------------------------------------------------------------
r10907 | havoc | 2011-03-11 02:12:14 -0800 (Fri, 11 Mar 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/collision.c
   M /trunk/darkplaces/collision.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/todo

cache collision trace results from frame to frame
increased r_shadow_bouncegrid_photons from 2000 to 5000 (same
performance, thanks to the collision cache)

------------------------------------------------------------------------
r10906 | havoc | 2011-03-09 01:25:55 -0800 (Wed, 09 Mar 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

actually the culling in
Mod_Q1BSP_TraceLineAgainstSurfacesFindTextureOnNode is a slight speed
loss compared to having it entirely disabled...  so disable it.

------------------------------------------------------------------------
r10905 | havoc | 2011-03-09 01:13:52 -0800 (Wed, 09 Mar 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fixed a flaw in the culling in
Mod_Q1BSP_TraceLineAgainstSurfacesFindTextureOnNode which was preventing
culling from working in most cases, minor speed gain

------------------------------------------------------------------------
r10904 | havoc | 2011-03-07 12:53:53 -0800 (Mon, 07 Mar 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/todo

fixed bug with toggling r_shadow_bouncegrid where the texture binding
state was incorrect, causing bouncegrid to not work after being toggled
once

------------------------------------------------------------------------
r10903 | havoc | 2011-03-06 12:59:46 -0800 (Sun, 06 Mar 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_sdl.c

fix a warning about an unsigned array on ios

------------------------------------------------------------------------
r10902 | divverent | 2011-03-06 11:21:05 -0800 (Sun, 06 Mar 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/fogeval.pl

improve the evaluation script
------------------------------------------------------------------------
r10901 | divverent | 2011-03-06 10:42:35 -0800 (Sun, 06 Mar 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/dpsoftrast.h
   M /trunk/darkplaces/fogeval.pl
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/shader_glsl.h
   M /trunk/darkplaces/shader_hlsl.h

add a hack to support fog on premultiplied alpha surfaces too
------------------------------------------------------------------------
r10900 | divverent | 2011-03-06 10:25:02 -0800 (Sun, 06 Mar 2011) | 1 line
Changed paths:
   A /trunk/darkplaces/fogeval.pl
   M /trunk/darkplaces/gl_rmain.c

fix fog/colormodability evaluation
------------------------------------------------------------------------
r10899 | divverent | 2011-03-06 09:36:37 -0800 (Sun, 06 Mar 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix fog for GL_SRC_ALPHA GL_ONE
------------------------------------------------------------------------
r10898 | havoc | 2011-03-06 09:28:14 -0800 (Sun, 06 Mar 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_draw.c

fix drawclipsetarea in D3D9, this fixes the minimap in steelstorm and also the menu scrolling
------------------------------------------------------------------------
r10897 | havoc | 2011-03-06 09:27:39 -0800 (Sun, 06 Mar 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/darkplaces-dedicated.vcproj
   M /trunk/darkplaces/darkplaces-sdl.vcproj
   M /trunk/darkplaces/darkplaces-wgl.vcproj

added shader_glsl.h and shader_hlsl.h to the project files
------------------------------------------------------------------------
r10896 | divverent | 2011-03-06 07:51:39 -0800 (Sun, 06 Mar 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

also turn off fog on blendfuncs that cannot handle it
------------------------------------------------------------------------
r10895 | havoc | 2011-03-05 15:38:23 -0800 (Sat, 05 Mar 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   A /trunk/darkplaces/shader_glsl.h
   A /trunk/darkplaces/shader_hlsl.h

move glsl/default.glsl embedded file out to its own header file
move hlsl/default.hlsl embedded file out to its own header file

------------------------------------------------------------------------
r10894 | divverent | 2011-03-05 06:59:14 -0800 (Sat, 05 Mar 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/darkplaces-dedicated.dev
   M /trunk/darkplaces/darkplaces-dedicated.dsp
   M /trunk/darkplaces/darkplaces-dedicated.vcproj
   M /trunk/darkplaces/darkplaces-sdl.dev
   M /trunk/darkplaces/darkplaces-sdl.dsp
   M /trunk/darkplaces/darkplaces-sdl.vcproj
   M /trunk/darkplaces/darkplaces-wgl.vcproj
   M /trunk/darkplaces/darkplaces.dev
   M /trunk/darkplaces/darkplaces.dsp
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/makefile.inc
   M /trunk/darkplaces/quakedef.h

instead, define the FILE_OFFSET_BITS part in the build environment, and remove it from quakedef.h as it is not reliable there
------------------------------------------------------------------------
r10893 | divverent | 2011-03-04 22:46:23 -0800 (Fri, 04 Mar 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/fs.c

fix compile problem on win32
------------------------------------------------------------------------
r10892 | divverent | 2011-03-04 15:36:37 -0800 (Fri, 04 Mar 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/fs.c

move the "quakedef.h" include, which gives us _FILE_OFFSET_BITS=64, above all system header includes
------------------------------------------------------------------------
r10891 | divverent | 2011-03-04 15:36:34 -0800 (Fri, 04 Mar 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/fs.c

put back the changes that make >2GB work (fix signedness)
------------------------------------------------------------------------
r10890 | divverent | 2011-03-04 15:36:31 -0800 (Fri, 04 Mar 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/fs.c

Revert "properly use lseek64 on Linux for files larger than 2GB" because it breaks compilation on FreeBSD (no lseek64 there, file offsets are always 64bit)

This reverts commit 6095a33fdc4a434d11de102b445515021847cfce.
------------------------------------------------------------------------
r10889 | havoc | 2011-03-03 16:36:36 -0800 (Thu, 03 Mar 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix zfighting on decals in D3D9 (where negative polygon offset isn't possible)
------------------------------------------------------------------------
r10888 | havoc | 2011-03-03 09:53:37 -0800 (Thu, 03 Mar 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

update HLSL shader to no longer swap R/B color components on vertex
colors, as they are no longer being sent as D3DCOLOR

------------------------------------------------------------------------
r10887 | havoc | 2011-03-03 09:48:26 -0800 (Thu, 03 Mar 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h

eliminated color4ub vertex formats, now everything is float, this fixes color wrapping/clamping issues in D3D9 renderer
------------------------------------------------------------------------
r10886 | havoc | 2011-03-03 07:56:55 -0800 (Thu, 03 Mar 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/snd_mem.c

fix rounding error that caused a memory block overflow in steelstorm when loading certain sound files
------------------------------------------------------------------------
r10885 | havoc | 2011-03-02 17:43:32 -0800 (Wed, 02 Mar 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

bouncegrid now uses interpolated photon accumulation, looks better

------------------------------------------------------------------------
r10884 | havoc | 2011-03-02 16:48:23 -0800 (Wed, 02 Mar 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

skip backfaces in surface traceline

------------------------------------------------------------------------
r10883 | havoc | 2011-03-02 16:41:14 -0800 (Wed, 02 Mar 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

replaced r_shadow_bouncegrid_particlespacing with
r_shadow_bouncegrid_photons which makes the number of photons traced per
frame completely uniform, fixing performance issues in some maps

------------------------------------------------------------------------
r10882 | havoc | 2011-03-02 15:58:20 -0800 (Wed, 02 Mar 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/todo

fixed surface traceline code, bouncegrid looks a lot better now

------------------------------------------------------------------------
r10881 | havoc | 2011-03-02 12:31:33 -0800 (Wed, 02 Mar 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

make r_shadow_shadowmapping 1 by default, this loses some fps but the
quality is worth it

------------------------------------------------------------------------
r10880 | havoc | 2011-03-02 10:51:56 -0800 (Wed, 02 Mar 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_sdl.c

we don't like typos in cvar descriptions

------------------------------------------------------------------------
r10879 | havoc | 2011-03-01 15:02:05 -0800 (Tue, 01 Mar 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_sdl.c

fix two compile errors in D3D9 build

------------------------------------------------------------------------
r10878 | havoc | 2011-03-01 10:16:44 -0800 (Tue, 01 Mar 2011) | 6 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/cl_collision.h
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/collision.c
   M /trunk/darkplaces/collision.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/view.c

q1bsp traceline code now hits surfaces, this comes at a performance cost
but was necessary for bouncegrid to acquire color of surfaces, it also
means that quakec code can now use trace_dphittexture on q1bsp maps
disabled bouncegrid on fullbright surfaces (fixes bright coronas bug)
tweaked bouncegrid settings again now that texture color works

------------------------------------------------------------------------
r10877 | havoc | 2011-02-28 23:24:43 -0800 (Mon, 28 Feb 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c
   M /trunk/darkplaces/dpsoftrast.h
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/model_shared.h

remove more r_shadow_particletrace code I missed in the last commit

------------------------------------------------------------------------
r10876 | havoc | 2011-02-28 23:23:37 -0800 (Mon, 28 Feb 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/render.h

removed r_shadow_particletrace code and shader because it was never
usable performance, made obsolete by r_shadow_bouncegrid which looks
much nicer

------------------------------------------------------------------------
r10875 | havoc | 2011-02-28 21:33:58 -0800 (Mon, 28 Feb 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

fix two typos (one a compile error, one a code error)

------------------------------------------------------------------------
r10874 | havoc | 2011-02-28 19:42:36 -0800 (Mon, 28 Feb 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

bouncegrid particles now scale by 0.5 if texture is not reported

------------------------------------------------------------------------
r10873 | havoc | 2011-02-28 17:18:10 -0800 (Mon, 28 Feb 2011) | 7 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

bouncegrid now uses high precision 48bpp accumulation array while also
updating the 32bpp low precision texture, so low particleintensity
values no longer break, and high maxbounces values actually do work,
bouncegrid maxbounces reduced to 3 and particleintensity adjusted,
bouncegrid no longer reallocates the pixel array every update (this
fixed the black flicker bug... odd)

------------------------------------------------------------------------
r10872 | havoc | 2011-02-28 15:46:50 -0800 (Mon, 28 Feb 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

only update r_shadow_bouncegridmatrix when a texture update occurs -
otherwise it can render very weirdly while moving if the updateinterval
is greater than the frametime

------------------------------------------------------------------------
r10871 | havoc | 2011-02-28 12:34:51 -0800 (Mon, 28 Feb 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

changed offsetmapping to use forward step math, greatly improved quality
changed HLSL shader offsetmapping to 2 sample to match GLSL

------------------------------------------------------------------------
r10870 | havoc | 2011-02-28 11:48:49 -0800 (Mon, 28 Feb 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/fs.c

properly use lseek64 on Linux for files larger than 2GB
fix pak and pk3 loading to use unsigned int to allow 4GB archives rather
than erroring on files beyond 2GB

------------------------------------------------------------------------
r10869 | havoc | 2011-02-28 11:33:00 -0800 (Mon, 28 Feb 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_sdl.c

fix compilation on SDL 1.2 again

------------------------------------------------------------------------
r10868 | havoc | 2011-02-27 10:38:25 -0800 (Sun, 27 Feb 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/screen.h
   M /trunk/darkplaces/vid_sdl.c

experimental touchscreen support, intended for mobile devices, not very playable yet
some hacks for keyboard input on ios because SDL 1.3 has some bugs still

------------------------------------------------------------------------
r10867 | havoc | 2011-02-26 10:02:16 -0800 (Sat, 26 Feb 2011) | 7 lines
Changed paths:
   M /trunk/darkplaces/keys.h
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_shared.c

added support for SDL_Window API but it is disabled by default until SDL
1.3 is more mature (this API's mouse input seems to be broken on Linux)
rewrote MapKey to use a switch statement on the actual SDLK_ enum values
rather than a lookup table (the lookup table did not work with SDL 1.3
events because SDLK_ values changed)
added vid_touchscreen cvar as part of mobile device support

------------------------------------------------------------------------
r10866 | havoc | 2011-02-26 09:55:03 -0800 (Sat, 26 Feb 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

fix a crash with non-power-of-two particle textures

------------------------------------------------------------------------
r10865 | havoc | 2011-02-26 09:54:18 -0800 (Sat, 26 Feb 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/common.c

a fix for the gamemode table if someone edits it to have a "" prog_name
match string in a position after the first slot

------------------------------------------------------------------------
r10864 | havoc | 2011-02-25 11:05:21 -0800 (Fri, 25 Feb 2011) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/cmd.h
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/cvar.c
   M /trunk/darkplaces/cvar.h
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/sbar.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/view.c
   M /trunk/darkplaces/zone.c

reworked the entire config loading system for the gamedir command
gamedir switch now fully resets command/alias/cvar state
FS_Rescan function now automatically switches gamemode based on
first specified gamedir (mission pack hud, gameplayfix cvars, etc)

------------------------------------------------------------------------
r10863 | eihrul | 2011-02-25 04:37:49 -0800 (Fri, 25 Feb 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

typo fix

------------------------------------------------------------------------
r10862 | eihrul | 2011-02-25 03:50:01 -0800 (Fri, 25 Feb 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

attempted fix for macosx compilation issues

------------------------------------------------------------------------
r10860 | havoc | 2011-02-24 00:36:56 -0800 (Thu, 24 Feb 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

fix two compile errors on D3D9

------------------------------------------------------------------------
r10859 | havoc | 2011-02-24 00:31:48 -0800 (Thu, 24 Feb 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

fix compile error on D3D9

------------------------------------------------------------------------
r10858 | havoc | 2011-02-24 00:02:39 -0800 (Thu, 24 Feb 2011) | 7 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/todo

use dynamic eye position-centered bouncegrid when rendering in dynamic
mode, to reduce upload memory usage on large maps (albeit at a cost of
not covering the entire map in some cases)
changed back to specular reflection (true mirror) bouncing of particles
(can be changed with the r_shadow_bouncegrid_bounceanglediffuse cvar)
because it gets rid of some dark corner artifacts

------------------------------------------------------------------------
r10857 | havoc | 2011-02-23 09:02:03 -0800 (Wed, 23 Feb 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

oops, forgot to include the shader code for the r_shadow_bouncegrid feature

------------------------------------------------------------------------
r10856 | havoc | 2011-02-23 08:13:24 -0800 (Wed, 23 Feb 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_gecko.c
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/dpsoftrast.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h
   M /trunk/darkplaces/r_textures.h

added r_shadow_bouncegrid cvar, this feature does realtime global
illumination by particle tracing and uploading a new 3D texture every
frame containing the lighting

------------------------------------------------------------------------
r10854 | havoc | 2011-02-21 02:57:49 -0800 (Mon, 21 Feb 2011) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/dpsoftrast.c
   M /trunk/darkplaces/dpsoftrast.h
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/mathlib.h
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/render.h

implemented r_shadow_particletrace cvar which enables an exceptionally
slow realtime global illumination deferred rendering technique,
UNPLAYABLE framerates with this option on, some rendering artifacts,
experimental only

------------------------------------------------------------------------
r10853 | divverent | 2011-02-20 13:32:47 -0800 (Sun, 20 Feb 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/server.h

CSQC entity database: keep size, but reduce entity count to 256 (before: 1024) per frame; to compensate, increase max frames from 64 to 256.
------------------------------------------------------------------------
r10852 | divverent | 2011-02-20 07:50:40 -0800 (Sun, 20 Feb 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/server.h

CSQC entity networking: if a frame BEFORE the last packetlog reset got lost, this needs not trigger a new resend!
------------------------------------------------------------------------
r10851 | divverent | 2011-02-19 12:00:18 -0800 (Sat, 19 Feb 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/cvar.c
   M /trunk/darkplaces/keys.c

add missing args to Cmd_QuoteString in other files
------------------------------------------------------------------------
r10850 | divverent | 2011-02-19 08:36:39 -0800 (Sat, 19 Feb 2011) | 5 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

Fix bad ipv6 support in status 1 and 2 commands:

header not adapted to the new layout and overall ipv6 IPs not fully displayed

Signed-off-by: terencehill <piuntn@gmail.com>
------------------------------------------------------------------------
r10849 | divverent | 2011-02-19 08:31:16 -0800 (Sat, 19 Feb 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/cmd.h

Cmd_QuoteString: make it also able to put the enclosing quotation marks
------------------------------------------------------------------------
r10848 | divverent | 2011-02-16 02:47:47 -0800 (Wed, 16 Feb 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

fix an unused variable
------------------------------------------------------------------------
r10847 | divverent | 2011-02-16 02:41:47 -0800 (Wed, 16 Feb 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

fix compile error, sorry
------------------------------------------------------------------------
r10846 | divverent | 2011-02-14 22:46:02 -0800 (Mon, 14 Feb 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

because Quake is insane, do NOT save vars matching _? even if not _x, _y, _z
------------------------------------------------------------------------
r10845 | divverent | 2011-02-14 22:31:53 -0800 (Mon, 14 Feb 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

fix some instances detecting vector component names to ONLY match _x, _y, _z, but not e.g. _a; also fixes a bad memory access on one-letter global variable names
------------------------------------------------------------------------
r10844 | divverent | 2011-02-14 22:28:25 -0800 (Mon, 14 Feb 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/dpdefs/dpextensions.qc

document autocvar _x, _y, _z issue
------------------------------------------------------------------------
r10843 | divverent | 2011-02-14 05:51:19 -0800 (Mon, 14 Feb 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/view.c

Use the proper frametime calculation for model animations, this way they work in demo recording and such.

From: Samual <samual@xonotic.org>
------------------------------------------------------------------------
r10842 | havoc | 2011-02-13 00:56:55 -0800 (Sun, 13 Feb 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

fix a compile error where an int was being assigned to an enum variable

------------------------------------------------------------------------
r10841 | eihrul | 2011-02-11 14:23:27 -0800 (Fri, 11 Feb 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

always force a flush on copy to texture

------------------------------------------------------------------------
r10840 | havoc | 2011-02-11 11:20:12 -0800 (Fri, 11 Feb 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/todo


------------------------------------------------------------------------
r10839 | havoc | 2011-02-11 10:59:09 -0800 (Fri, 11 Feb 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/render.h

added iris adaptation experiment

------------------------------------------------------------------------
r10838 | havoc | 2011-02-09 01:35:12 -0800 (Wed, 09 Feb 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/makefile.inc
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_shared.c

removed unmaintained CgGL rendering path

------------------------------------------------------------------------
r10837 | havoc | 2011-02-09 01:20:05 -0800 (Wed, 09 Feb 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

variables referring to cg in a way that is used by both CGGL and D3D9
paths are now called hlsl instead

------------------------------------------------------------------------
r10836 | havoc | 2011-02-09 01:13:34 -0800 (Wed, 09 Feb 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix an error in the HLSL shader (unintentional use of mix rather than lerp function)

------------------------------------------------------------------------
r10835 | havoc | 2011-02-09 00:27:05 -0800 (Wed, 09 Feb 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/dpsoftrast.h
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_shadow.c

GL20 path now uses same shader as GLES2 (albeit with the precision
modifiers disabled), this means vertex attrib arrays instead of the
legacy pointers...  one side effect is that colors are no longer clamped

------------------------------------------------------------------------
r10834 | havoc | 2011-02-08 23:02:14 -0800 (Tue, 08 Feb 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/README.iOS

revised SDL iOS instructions again now that SDL has GLES2 support

------------------------------------------------------------------------
r10833 | havoc | 2011-02-08 18:04:58 -0800 (Tue, 08 Feb 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_rmain.c

fixed iOS rendering (set the vertex attribute bindings before attaching the shaders to the program)

------------------------------------------------------------------------
r10832 | havoc | 2011-02-08 18:04:03 -0800 (Tue, 08 Feb 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

changed the fs_userdir on iOS

------------------------------------------------------------------------
r10831 | havoc | 2011-02-08 10:25:42 -0800 (Tue, 08 Feb 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

added GLES2 GLSL shader, work in progress (no warnings/errors in basic usage)

------------------------------------------------------------------------
r10830 | havoc | 2011-02-08 10:23:47 -0800 (Tue, 08 Feb 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/DPiOS.xcodeproj/project.pbxproj
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_shared.c

DPiOS almost works now...
Side effects: had to change the internalformat hints on the GL texture formats, because values 3 and 4 are not supported on GLES, using GL_RGB and GL_RGBA instead (same meaning).

------------------------------------------------------------------------
r10829 | divverent | 2011-02-08 01:24:19 -0800 (Tue, 08 Feb 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/view.c

Ooops, forgot to update the description so the cvar makes more sense
------------------------------------------------------------------------
r10828 | divverent | 2011-02-08 01:24:03 -0800 (Tue, 08 Feb 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/view.c

Fix a typo with declaration of the cvar and default it to off so it can be decided upon by games specifically
------------------------------------------------------------------------
r10827 | divverent | 2011-02-08 01:23:58 -0800 (Tue, 08 Feb 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/view.c

Add smoothing to the viewheight so that things such as crouching have a smooth transition - implemented in the engine because it's the best way to do it.
------------------------------------------------------------------------
r10826 | eihrul | 2011-02-07 15:07:10 -0800 (Mon, 07 Feb 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces-dedicated.vcproj
   M /trunk/darkplaces/darkplaces-sdl.vcproj
   M /trunk/darkplaces/darkplaces-wgl.vcproj

add missing thread files to vcprojs

------------------------------------------------------------------------
r10825 | eihrul | 2011-02-07 06:56:47 -0800 (Mon, 07 Feb 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces-sdl.vcproj
   M /trunk/darkplaces/dpsoftrast.c
   M /trunk/darkplaces/dpsoftrast.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/makefile.inc
   A /trunk/darkplaces/thread.h
   A /trunk/darkplaces/thread_null.c
   A /trunk/darkplaces/thread_sdl.c
   M /trunk/darkplaces/vid_sdl.c

factor out thread interface from dpsoftrast

------------------------------------------------------------------------
r10824 | eihrul | 2011-02-07 02:26:04 -0800 (Mon, 07 Feb 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.inc

add dpsoftrast to some missing targets

------------------------------------------------------------------------
r10823 | eihrul | 2011-02-06 23:07:56 -0800 (Sun, 06 Feb 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

ensure dynamic textures get updated even if they are currently bound

------------------------------------------------------------------------
r10822 | eihrul | 2011-02-06 22:37:54 -0800 (Sun, 06 Feb 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

fix for span endpoint interpolation

------------------------------------------------------------------------
r10821 | eihrul | 2011-02-06 21:49:54 -0800 (Sun, 06 Feb 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

clamping for FlatColor shader (to fix gl_flashblend)

------------------------------------------------------------------------
r10820 | havoc | 2011-02-06 19:55:13 -0800 (Sun, 06 Feb 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_sdl.c

made GLES2 gl call wrappers compile again

------------------------------------------------------------------------
r10819 | havoc | 2011-02-06 19:45:51 -0800 (Sun, 06 Feb 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_sdl.c

added qglVertexAttrib and other missing functions on GLES2 path

------------------------------------------------------------------------
r10818 | havoc | 2011-02-06 19:32:23 -0800 (Sun, 06 Feb 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.h
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_shared.c

added RENDERPATH_GLES2

------------------------------------------------------------------------
r10817 | havoc | 2011-02-06 14:24:38 -0800 (Sun, 06 Feb 2011) | 2 lines
Changed paths:
   D /trunk/darkplaces/DPiOS.xcodeproj/havoc.mode1v3
   D /trunk/darkplaces/DPiOS.xcodeproj/havoc.pbxuser

I don't think anyone needs my user files for the xcode project

------------------------------------------------------------------------
r10816 | eihrul | 2011-02-06 04:47:26 -0800 (Sun, 06 Feb 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

fixed missing break statement

------------------------------------------------------------------------
r10815 | eihrul | 2011-02-06 04:44:54 -0800 (Sun, 06 Feb 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

implemented scissoring of triangles and extra necessary blendmode for xonotic hud

------------------------------------------------------------------------
r10814 | eihrul | 2011-02-06 02:46:59 -0800 (Sun, 06 Feb 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.h

committing missing function prototype

------------------------------------------------------------------------
r10813 | eihrul | 2011-02-05 23:51:29 -0800 (Sat, 05 Feb 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c
   M /trunk/darkplaces/vid_sdl.c

band interlacing option (vid_soft_interlace)

------------------------------------------------------------------------
r10812 | havoc | 2011-02-05 21:35:14 -0800 (Sat, 05 Feb 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/README.iOS

updated readme for iOS compilation with instructions on how to modify SDL to use OpenGL ES 2.0 (as required by darkplaces)

------------------------------------------------------------------------
r10811 | havoc | 2011-02-05 19:25:42 -0800 (Sat, 05 Feb 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_sdl.c

iOS support closer to working

------------------------------------------------------------------------
r10810 | havoc | 2011-02-05 18:58:52 -0800 (Sat, 05 Feb 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/glquake.h

remove a couple unused declarations

------------------------------------------------------------------------
r10809 | havoc | 2011-02-05 18:58:13 -0800 (Sat, 05 Feb 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_shared.c

iOS support in progress - accommodating GLES...

------------------------------------------------------------------------
r10808 | havoc | 2011-02-05 18:14:51 -0800 (Sat, 05 Feb 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_shared.c

changed use of GL_ARB_fragment_shader and friends to the core GL 2.0
functionality instead, for better GL ES 2.0 compatibility

------------------------------------------------------------------------
r10807 | eihrul | 2011-02-05 05:29:09 -0800 (Sat, 05 Feb 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

correctly copy in all of quadelement3s to quadelement3i

------------------------------------------------------------------------
r10806 | eihrul | 2011-02-05 04:22:27 -0800 (Sat, 05 Feb 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

ensure UndoCommand wraps properly at 0

------------------------------------------------------------------------
r10805 | eihrul | 2011-02-04 16:28:14 -0800 (Fri, 04 Feb 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

remove errant debugging code... again

------------------------------------------------------------------------
r10804 | eihrul | 2011-02-04 16:26:14 -0800 (Fri, 04 Feb 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

attempted fix for VC compile errors

------------------------------------------------------------------------
r10803 | eihrul | 2011-02-04 16:20:48 -0800 (Fri, 04 Feb 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

remove debugging code

------------------------------------------------------------------------
r10802 | eihrul | 2011-02-04 16:19:12 -0800 (Fri, 04 Feb 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

optimized MultiplyVaryingBGRA8 and VaryingBGRA8

------------------------------------------------------------------------
r10801 | eihrul | 2011-02-04 14:22:31 -0800 (Fri, 04 Feb 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

use short indices when available instead of int (fixes xonotic console weirdness)

------------------------------------------------------------------------
r10800 | eihrul | 2011-02-04 13:55:45 -0800 (Fri, 04 Feb 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

clear scissor fix

------------------------------------------------------------------------
r10799 | eihrul | 2011-02-04 12:28:42 -0800 (Fri, 04 Feb 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

more fine-grained locking amongst backend threads

------------------------------------------------------------------------
r10798 | eihrul | 2011-02-04 06:36:31 -0800 (Fri, 04 Feb 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

distribute draw calls based on bounding box

------------------------------------------------------------------------
r10797 | eihrul | 2011-02-03 13:15:16 -0800 (Thu, 03 Feb 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c
   M /trunk/darkplaces/dpsoftrast.h
   M /trunk/darkplaces/vid_sdl.c

only force flushing on a texture update if a texture is already bound (for quake)

------------------------------------------------------------------------
r10796 | eihrul | 2011-02-03 03:37:13 -0800 (Thu, 03 Feb 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

nearest filtering fix

------------------------------------------------------------------------
r10795 | eihrul | 2011-02-03 01:14:53 -0800 (Thu, 03 Feb 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces-sdl.vcproj

USE_SDL define

------------------------------------------------------------------------
r10794 | eihrul | 2011-02-03 01:05:39 -0800 (Thu, 03 Feb 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c
   M /trunk/darkplaces/makefile.inc
   M /trunk/darkplaces/vid_sdl.c

detect whether dpsoftrast is being built with SDL

------------------------------------------------------------------------
r10793 | eihrul | 2011-02-03 00:33:03 -0800 (Thu, 03 Feb 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c
   M /trunk/darkplaces/dpsoftrast.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/vid_sdl.c

threading and more SSE2 optimizations for dpsoftrast

------------------------------------------------------------------------
r10792 | havoc | 2011-02-02 10:44:36 -0800 (Wed, 02 Feb 2011) | 2 lines
Changed paths:
   A /trunk/darkplaces/DPiOS.xcodeproj
   A /trunk/darkplaces/DPiOS.xcodeproj/havoc.mode1v3
   A /trunk/darkplaces/DPiOS.xcodeproj/havoc.pbxuser
   A /trunk/darkplaces/DPiOS.xcodeproj/project.pbxproj
   A /trunk/darkplaces/Info.plist
   A /trunk/darkplaces/README.iOS

added xcode project for building DarkPlaces on iOS using SDL 1.3

------------------------------------------------------------------------
r10791 | havoc | 2011-02-02 10:35:57 -0800 (Wed, 02 Feb 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_sdl.c

don't use MacOSX-specific code with __IPHONEOS__ defined

------------------------------------------------------------------------
r10790 | eihrul | 2011-02-01 06:14:04 -0800 (Tue, 01 Feb 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

implemented Texture_UpdatePartial

------------------------------------------------------------------------
r10789 | divverent | 2011-01-30 22:05:54 -0800 (Sun, 30 Jan 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/snd_main.c

also apply volume.value to ambient sounds (is this really right?)
------------------------------------------------------------------------
r10788 | havoc | 2011-01-30 20:40:45 -0800 (Sun, 30 Jan 2011) | 5 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/r_shadow.c

enable mod_bsp_portalize by default
enable r_shadow_realtime_world_compileportalculling by default
this is intended to restore lost rtworld performance, however it may not
be optimal on some q3bsp maps

------------------------------------------------------------------------
r10787 | havoc | 2011-01-30 19:37:10 -0800 (Sun, 30 Jan 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

default gl_nopartialtextureupdates to 0 because it hurts fps a lot

------------------------------------------------------------------------
r10786 | havoc | 2011-01-30 19:33:06 -0800 (Sun, 30 Jan 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/darkplaces-dedicated.vcproj
   M /trunk/darkplaces/darkplaces-sdl.vcproj
   M /trunk/darkplaces/darkplaces-wgl.vcproj

clean up the Compile as C and Compile as C++ options on the files in the projects, thanks to Willis for advice on how to make this a project setting rather than a per file setting.
------------------------------------------------------------------------
r10785 | havoc | 2011-01-30 16:57:09 -0800 (Sun, 30 Jan 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/darkplaces-wgl.vcproj
   M /trunk/darkplaces/dpsoftrast.c

fix compilation of dpsoftrast.c in MSVC - it doesn't seem to like initializers on __m128 variables - and set it to compile as C++ in wgl build (like all other files in wgl build)
------------------------------------------------------------------------
r10784 | havoc | 2011-01-30 13:52:03 -0800 (Sun, 30 Jan 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces-dedicated.vcproj
   M /trunk/darkplaces/darkplaces-sdl.vcproj
   M /trunk/darkplaces/darkplaces-wgl.vcproj
   M /trunk/darkplaces/darkplaces.sln

added dpsoftrast to project files
added x64 build mode but it does not compile yet (dpsoftrast issues)
------------------------------------------------------------------------
r10783 | divverent | 2011-01-30 12:15:44 -0800 (Sun, 30 Jan 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/netconn.c

sv_status_privacy: also apply to CCREQ_PLAYER_INFO
------------------------------------------------------------------------
r10782 | havoc | 2011-01-30 09:29:37 -0800 (Sun, 30 Jan 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/cd_sdl.c
   M /trunk/darkplaces/vid_sdl.c

added SDL 1.3 support

------------------------------------------------------------------------
r10781 | divverent | 2011-01-29 14:19:48 -0800 (Sat, 29 Jan 2011) | 9 lines
Changed paths:
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/dpdefs/dpextensions.qc
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/sv_main.c

Squashed commit of the following:

commit 5c70a0cf78ecde6a1da9fe73516f8d2fe2251c81
Author: terencehill <piuntn@gmail.com>
Date:   Mon Jan 24 00:39:13 2011 +0100

    Fix a bunch of typos

    Signed-off-by: terencehill <piuntn@gmail.com>
------------------------------------------------------------------------
r10780 | divverent | 2011-01-29 14:05:24 -0800 (Sat, 29 Jan 2011) | 7 lines
Changed paths:
   M /trunk/darkplaces/console.c

Squashed commit of the following:

commit 4eece1a8617ec2e21dbc8732af65727792e432fb
Author: terencehill <piuntn@gmail.com>
Date:   Thu Jan 13 17:26:51 2011 +0100

    Color directories with blue when using autocompletion in the console. Improves readability.
------------------------------------------------------------------------
r10779 | havoc | 2011-01-29 06:08:38 -0800 (Sat, 29 Jan 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/Darkplaces.app/Contents/Resources/English.lproj/InfoPlist.strings

update copyright year

------------------------------------------------------------------------
r10778 | divverent | 2011-01-29 02:14:13 -0800 (Sat, 29 Jan 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/model_brush.c

prevent a segfault in case a bsp file has zero nodes (happens on broken input to q3map2)
------------------------------------------------------------------------
r10777 | divverent | 2011-01-29 00:32:32 -0800 (Sat, 29 Jan 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

fix a crash on edict_num(32767)
------------------------------------------------------------------------
r10776 | eihrul | 2011-01-28 23:13:28 -0800 (Fri, 28 Jan 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

added _USE_MATH_DEFINES for weird MSVC problem

------------------------------------------------------------------------
r10775 | havoc | 2011-01-28 16:08:39 -0800 (Fri, 28 Jan 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix a C++ error

------------------------------------------------------------------------
r10774 | havoc | 2011-01-28 15:56:56 -0800 (Fri, 28 Jan 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

fix some C++ warnings

------------------------------------------------------------------------
r10773 | eihrul | 2011-01-28 14:31:05 -0800 (Fri, 28 Jan 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

optimized VertexColor shader

------------------------------------------------------------------------
r10772 | eihrul | 2011-01-28 14:07:29 -0800 (Fri, 28 Jan 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_sdl.c

don't report texture compression support in softrast renderpath

------------------------------------------------------------------------
r10771 | eihrul | 2011-01-28 07:19:29 -0800 (Fri, 28 Jan 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

ensure cull face state is committed in softrast path

------------------------------------------------------------------------
r10770 | eihrul | 2011-01-28 01:52:15 -0800 (Fri, 28 Jan 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

fix clipping and backface culling bugs

------------------------------------------------------------------------
r10769 | eihrul | 2011-01-27 21:21:59 -0800 (Thu, 27 Jan 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

faster attribute interpolation in ProcessTriangles

------------------------------------------------------------------------
r10768 | eihrul | 2011-01-27 20:01:12 -0800 (Thu, 27 Jan 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

more texturing optimizations

------------------------------------------------------------------------
r10767 | eihrul | 2011-01-27 18:35:28 -0800 (Thu, 27 Jan 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

removing one more reciprocal...

------------------------------------------------------------------------
r10766 | eihrul | 2011-01-27 18:19:24 -0800 (Thu, 27 Jan 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

switch usage of reciprocals back to division (precision is way too low)

------------------------------------------------------------------------
r10765 | eihrul | 2011-01-27 17:31:11 -0800 (Thu, 27 Jan 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

SSE2 blending optimizations

------------------------------------------------------------------------
r10764 | eihrul | 2011-01-27 15:09:23 -0800 (Thu, 27 Jan 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

delay backface culling till after near plane test

------------------------------------------------------------------------
r10763 | eihrul | 2011-01-27 13:48:02 -0800 (Thu, 27 Jan 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

fix mipedgetc typo

------------------------------------------------------------------------
r10762 | eihrul | 2011-01-27 06:55:30 -0800 (Thu, 27 Jan 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

replace some divisions with reciprocals

------------------------------------------------------------------------
r10761 | eihrul | 2011-01-27 06:19:05 -0800 (Thu, 27 Jan 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

added in some basic polygon offset compatibility (though using w buffer units)

------------------------------------------------------------------------
r10760 | eihrul | 2011-01-27 05:34:01 -0800 (Thu, 27 Jan 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

fix accessing of bottom mip level in Texture2DVaryingBGRA8

------------------------------------------------------------------------
r10759 | eihrul | 2011-01-27 04:21:23 -0800 (Thu, 27 Jan 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

ProcessTriangles SSE2 optimizations

------------------------------------------------------------------------
r10758 | eihrul | 2011-01-26 15:24:48 -0800 (Wed, 26 Jan 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

try to keep inter-span variables for texturing in sse registers

------------------------------------------------------------------------
r10757 | eihrul | 2011-01-26 07:45:07 -0800 (Wed, 26 Jan 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

remove unneeded "fast" case for nearest filtering

------------------------------------------------------------------------
r10756 | eihrul | 2011-01-26 07:35:52 -0800 (Wed, 26 Jan 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

SSE2 opts for nearest filtering

------------------------------------------------------------------------
r10755 | eihrul | 2011-01-26 06:55:04 -0800 (Wed, 26 Jan 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

fix for lightmap glow path to use one less multiply

------------------------------------------------------------------------
r10754 | eihrul | 2011-01-26 06:44:45 -0800 (Wed, 26 Jan 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

SSE2 optimized lightmap shader

------------------------------------------------------------------------
r10753 | eihrul | 2011-01-26 05:40:21 -0800 (Wed, 26 Jan 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

SSE2 optimized Texture2DVaryingBGRA8

------------------------------------------------------------------------
r10752 | eihrul | 2011-01-26 05:00:02 -0800 (Wed, 26 Jan 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

initial obfuscation of ProcessTriangles with SSE2 code for testing

------------------------------------------------------------------------
r10751 | eihrul | 2011-01-26 04:24:09 -0800 (Wed, 26 Jan 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c
   M /trunk/darkplaces/vid_sdl.c

only respect vid_soft variable if SSE2_PRESENT is defined

------------------------------------------------------------------------
r10750 | eihrul | 2011-01-26 04:15:42 -0800 (Wed, 26 Jan 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/quakedef.h

added SSE2_PRESENT define

------------------------------------------------------------------------
r10749 | havoc | 2011-01-26 03:48:27 -0800 (Wed, 26 Jan 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

change DPSOFTRAST default texture filter to linear, it hurts fps some
but looks substantially better

------------------------------------------------------------------------
r10748 | havoc | 2011-01-26 03:46:12 -0800 (Wed, 26 Jan 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

optimized SHADERMODE_LIGHTSOURCE to do some early-out checks

------------------------------------------------------------------------
r10747 | havoc | 2011-01-26 03:33:58 -0800 (Wed, 26 Jan 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

implemented SHADERMODE_LIGHTSOURCE with specular, shadowmapping and
cubefilter are not yet implemented

------------------------------------------------------------------------
r10746 | divverent | 2011-01-25 12:50:25 -0800 (Tue, 25 Jan 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix the bug that affects showsurfaces 3 entirely now, hopefully
------------------------------------------------------------------------
r10745 | havoc | 2011-01-25 07:02:49 -0800 (Tue, 25 Jan 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

added glow texture support in SHADERMODE_LIGHTMAP

------------------------------------------------------------------------
r10744 | havoc | 2011-01-25 05:40:50 -0800 (Tue, 25 Jan 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

added SHADERMODE_LIGHTDIRECTION code (model rendering) with specular,
glow and colormapping support

------------------------------------------------------------------------
r10743 | havoc | 2011-01-25 05:39:10 -0800 (Tue, 25 Jan 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

changed the texture bind code for the RENDERPATH_SOFT to work like the
RENDERPATH_D3D9 code

------------------------------------------------------------------------
r10742 | eihrul | 2011-01-25 05:00:25 -0800 (Tue, 25 Jan 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

fix overrun test for optimized texture routines

------------------------------------------------------------------------
r10741 | havoc | 2011-01-25 04:42:07 -0800 (Tue, 25 Jan 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

fix crash on texturing a span that starts at the bottom row of a texture
but does not end on the bottom row of the texture, which was passing a
check for an optimized fill routine but should not have been

------------------------------------------------------------------------
r10740 | havoc | 2011-01-24 22:38:59 -0800 (Mon, 24 Jan 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix two errors related to the R_FrameData_Alloc use in batching

------------------------------------------------------------------------
r10739 | havoc | 2011-01-24 06:36:44 -0800 (Mon, 24 Jan 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

failed attempt at improving performance of bilinear filter routines by
using less integer multiplies, no apparent effect on benchmarks,
abandoned but posted here for reference (disabled)

------------------------------------------------------------------------
r10738 | havoc | 2011-01-24 04:39:26 -0800 (Mon, 24 Jan 2011) | 5 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

changed DPSOFTRAST to use bgra8 intermediate storage while rendering,
the float support code remains and will not be going away (and some
shaders are simply too complex to use bgra8 anyway), this gains a few
fps in most situations

------------------------------------------------------------------------
r10737 | havoc | 2011-01-24 04:34:27 -0800 (Mon, 24 Jan 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

change q1bsp lightmap to vertex color conversion to scale colors
correctly

------------------------------------------------------------------------
r10736 | havoc | 2011-01-24 04:33:45 -0800 (Mon, 24 Jan 2011) | 5 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c
   M /trunk/darkplaces/gl_rmain.c

added an experimental alternate code path in DPSOFTRAST where all the
span fillers use bgra8 instead of floats for intermediate storage, only
small gains observed but still good, this mode has to be activated by
the r_test cvar at this time

------------------------------------------------------------------------
r10735 | havoc | 2011-01-23 21:48:21 -0800 (Sun, 23 Jan 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_sdl.c

fix some compile errors on vid_sdl.c when compiling it as C++

------------------------------------------------------------------------
r10734 | havoc | 2011-01-23 09:24:06 -0800 (Sun, 23 Jan 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

draw things as black if no shader code exists yet

------------------------------------------------------------------------
r10733 | havoc | 2011-01-23 09:08:47 -0800 (Sun, 23 Jan 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

fix log(2) compile error as C++, should have been log(2.0f)

------------------------------------------------------------------------
r10732 | havoc | 2011-01-23 08:43:37 -0800 (Sun, 23 Jan 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/r_shadow.c

fix several conversion warnings

------------------------------------------------------------------------
r10731 | havoc | 2011-01-23 08:30:02 -0800 (Sun, 23 Jan 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix another void conversion

------------------------------------------------------------------------
r10730 | havoc | 2011-01-23 08:28:57 -0800 (Sun, 23 Jan 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

fix a couple void conversions

------------------------------------------------------------------------
r10729 | havoc | 2011-01-23 08:25:25 -0800 (Sun, 23 Jan 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

enabled more features for SHADERMODE_GENERIC
added texcoord matrix transforms (sky scrolls now)

------------------------------------------------------------------------
r10728 | havoc | 2011-01-23 07:57:55 -0800 (Sun, 23 Jan 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

added support for disabling mipmapping using the non-MIPMAP filters

------------------------------------------------------------------------
r10727 | havoc | 2011-01-23 07:55:26 -0800 (Sun, 23 Jan 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

fix bugs in DPSOFTRAST_CalculateMipmaps
implemented per-triangle mipmap selection

------------------------------------------------------------------------
r10726 | havoc | 2011-01-23 06:26:30 -0800 (Sun, 23 Jan 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

tabs, not spaces for indenting

------------------------------------------------------------------------
r10725 | eihrul | 2011-01-23 05:32:49 -0800 (Sun, 23 Jan 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

faster texture mapper

------------------------------------------------------------------------
r10724 | eihrul | 2011-01-22 15:37:08 -0800 (Sat, 22 Jan 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

move double break in pseudoalpha case to the right case...

------------------------------------------------------------------------
r10723 | havoc | 2011-01-22 15:33:26 -0800 (Sat, 22 Jan 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

fix particle blending

------------------------------------------------------------------------
r10722 | havoc | 2011-01-22 15:28:01 -0800 (Sat, 22 Jan 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

use texel center sampling on textures

------------------------------------------------------------------------
r10721 | eihrul | 2011-01-22 15:06:44 -0800 (Sat, 22 Jan 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

only bind needed textures in softrast path (to avoid texunit conflicts)

------------------------------------------------------------------------
r10720 | havoc | 2011-01-22 14:14:29 -0800 (Sat, 22 Jan 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

removed numtexcoords parameter in DPSOFTRAST_Draw_LoadVertices

------------------------------------------------------------------------
r10719 | havoc | 2011-01-22 14:02:45 -0800 (Sat, 22 Jan 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpsoftrast.c

reworking DPSOFTRAST array copying to automatically detect used arrays

------------------------------------------------------------------------
r10718 | eihrul | 2011-01-22 13:38:07 -0800 (Sat, 22 Jan 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_sdl.c

fix some crashes related to video subsystem not being reinitialized on vid_restart in SDL backend

------------------------------------------------------------------------
r10717 | havoc | 2011-01-22 13:00:49 -0800 (Sat, 22 Jan 2011) | 2 lines
Changed paths:
   A /trunk/darkplaces/dpsoftrast.c
   A /trunk/darkplaces/dpsoftrast.h
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/makefile.inc
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c

added DPSOFTRAST software rasterizer, a work in progress

------------------------------------------------------------------------
r10716 | havoc | 2011-01-22 12:55:05 -0800 (Sat, 22 Jan 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix a crash with tcmod turbulent where it was not requesting texcoords

------------------------------------------------------------------------
r10715 | divverent | 2011-01-22 11:09:48 -0800 (Sat, 22 Jan 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/ft2.c
   M /trunk/darkplaces/ft2.h
   M /trunk/darkplaces/ft2_fontdefs.h

cache multiple loaded instances of the same font (TODO: can we also cache the freetype object itself? probably not without major changes, as these are size specific); saves about 150M memory use in Xonotic
------------------------------------------------------------------------
r10714 | divverent | 2011-01-20 22:02:20 -0800 (Thu, 20 Jan 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/BSDmakefile

sync libjpeg support from makefile to BSDmakefile
------------------------------------------------------------------------
r10713 | havoc | 2011-01-20 06:24:23 -0800 (Thu, 20 Jan 2011) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

fix some missing changes in the D3D path when r_vertexposition_t was
removed

------------------------------------------------------------------------
r10712 | divverent | 2011-01-19 22:33:18 -0800 (Wed, 19 Jan 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

VM_sprintf: properly handle "%02d"
------------------------------------------------------------------------
r10711 | havoc | 2011-01-18 10:37:35 -0800 (Tue, 18 Jan 2011) | 11 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c

reduced memory usage by around 20MB (no longer allocates interleaved
vertex arrays unless running D3D renderpath, now uses R_FrameData_Alloc
a lot more to avoid large static arrays)
R_FrameData system now never fails an alloc request (resizing as
needed), and has a mark system allowing space to be relinquished after
brief uses such as batch buffers
removed r_vertexposition_t as it was redundant (just use vertex3f)
gl_mesh_separatearrays cvar removed (vid.useinterleavedarrays is now used instead)
audited RSurf_PrepareVertices calls to make sure BATCHNEED_NOGAPS is
properly used

------------------------------------------------------------------------
r10710 | havoc | 2011-01-18 10:22:23 -0800 (Tue, 18 Jan 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/quakedef.h

lower particle limit when using DP_SMALLMEMORY builds

------------------------------------------------------------------------
r10709 | havoc | 2011-01-18 09:29:54 -0800 (Tue, 18 Jan 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

fix a major performance issue with the GL11/GL13 path for rtlights where
it did not request BATCHNEED_NOGAPS and thus processed a huge number of
unnecessary vertices

------------------------------------------------------------------------
r10708 | divverent | 2011-01-18 00:51:05 -0800 (Tue, 18 Jan 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix wateralpha
------------------------------------------------------------------------
r10707 | havoc | 2011-01-17 10:00:43 -0800 (Mon, 17 Jan 2011) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix a typo in the cg shader setup

------------------------------------------------------------------------
r10706 | divverent | 2011-01-17 07:28:28 -0800 (Mon, 17 Jan 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

make prvm_language saved
------------------------------------------------------------------------
r10705 | divverent | 2011-01-17 07:28:26 -0800 (Mon, 17 Jan 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_screen.c

fix console margin calculation
------------------------------------------------------------------------
r10704 | divverent | 2011-01-16 21:44:00 -0800 (Sun, 16 Jan 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

fix description of prvm_language dumping mode
------------------------------------------------------------------------
r10703 | divverent | 2011-01-15 10:12:24 -0800 (Sat, 15 Jan 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/cmd.c

fix alias word combining
------------------------------------------------------------------------
r10702 | divverent | 2011-01-14 15:51:56 -0800 (Fri, 14 Jan 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_textures.c

make it possible to turn off missing DDS file logging
------------------------------------------------------------------------
r10701 | divverent | 2011-01-14 13:01:28 -0800 (Fri, 14 Jan 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

use the proper filename.pot instead of filename.dump.po for the empty .po file
------------------------------------------------------------------------
r10700 | havoc | 2011-01-13 16:24:59 -0800 (Thu, 13 Jan 2011) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_shadow.c

added r_enableshadowvolumes cvar, this defaults to 1 but can be turned
off to save a small amount of memory and speed up loading (shadowmaps
still work with it off)

------------------------------------------------------------------------
r10699 | divverent | 2011-01-12 22:57:04 -0800 (Wed, 12 Jan 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix a memory leak of glsl shader permutations
------------------------------------------------------------------------
r10698 | havoc | 2011-01-12 19:49:30 -0800 (Wed, 12 Jan 2011) | 5 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

added cvar mod_bsp_portalize to decide whether to generate portals for
culling purposes, this now defaults to 0, reducing load time but
disabling certain features (the only visible feature affected is
r_drawportals)

------------------------------------------------------------------------
r10697 | divverent | 2011-01-12 11:41:24 -0800 (Wed, 12 Jan 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_screen.c

make infobar height configurable
------------------------------------------------------------------------
r10696 | divverent | 2011-01-11 13:49:22 -0800 (Tue, 11 Jan 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/ft2.c

fix the latest fix to Font_IndexForSize
------------------------------------------------------------------------
r10695 | divverent | 2011-01-11 13:40:57 -0800 (Tue, 11 Jan 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/ft2.c

fix a data type in Font_IndexForSize
------------------------------------------------------------------------
r10694 | vortex | 2011-01-07 13:51:34 -0800 (Fri, 07 Jan 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/dpdefs/csprogsdefs.qc
   M /trunk/darkplaces/dpdefs/menudefs.qc
   M /trunk/darkplaces/draw.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/prvm_cmds.c

drawcolorcodedstring: support full 6 parms (added starting rgb) and returns color of the last character so colortags can affect multiline draw.
------------------------------------------------------------------------
r10693 | vortex | 2011-01-07 10:31:37 -0800 (Fri, 07 Jan 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.c

Added wasfreed() to menuqc builtinlist. Hushed "VM_bufstr_get: invalid string index" warning.
------------------------------------------------------------------------
r10692 | divverent | 2011-01-02 23:19:48 -0800 (Sun, 02 Jan 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/protocol.c

get rid of more clang warnings
------------------------------------------------------------------------
r10691 | divverent | 2011-01-02 23:19:41 -0800 (Sun, 02 Jan 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/model_brush.h

get rid of clang warnings for SETPVSBIT/CLEARPVSBIT
------------------------------------------------------------------------
r10690 | divverent | 2011-01-02 14:51:37 -0800 (Sun, 02 Jan 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/model_brush.h

fix a warning by clang
------------------------------------------------------------------------
r10689 | vortex | 2011-01-02 08:48:22 -0800 (Sun, 02 Jan 2011) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_sprites.c

Better perspective effect for SPR_OVERHEAD, added global xy scale for them.
------------------------------------------------------------------------
r10688 | divverent | 2010-12-29 10:09:55 -0800 (Wed, 29 Dec 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix a stupid extra declaration in the glsl shader
------------------------------------------------------------------------
r10687 | divverent | 2010-12-29 02:59:30 -0800 (Wed, 29 Dec 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/snd_modplug.c
   M /trunk/darkplaces/snd_ogg.c

fix the overflow checks in snd_ogg to handle different input and output sampling rates
------------------------------------------------------------------------
r10686 | divverent | 2010-12-27 03:00:57 -0800 (Mon, 27 Dec 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/console.c

fix a bug in special character translation leading to console spam
------------------------------------------------------------------------
r10685 | divverent | 2010-12-26 12:14:31 -0800 (Sun, 26 Dec 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_parse.c

fix handling of the restart-animation bit
------------------------------------------------------------------------
r10684 | divverent | 2010-12-26 01:59:49 -0800 (Sun, 26 Dec 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_textures.c

avgcolor calculation: also calculate alpha for DXT3
------------------------------------------------------------------------
r10683 | divverent | 2010-12-25 09:51:28 -0800 (Sat, 25 Dec 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/sbar.c

shut down a lot of startup developer spam
------------------------------------------------------------------------
r10682 | divverent | 2010-12-25 09:43:37 -0800 (Sat, 25 Dec 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/console.c

less unix terminal spam if developer <= 0 (should this get an option or not? probably not, anyone who wants to see this can do developer 1); developer stuff still by default ends up in logfile, rcon replies, condump
------------------------------------------------------------------------
r10681 | divverent | 2010-12-25 08:55:15 -0800 (Sat, 25 Dec 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_textures.c

fix a C++ error
------------------------------------------------------------------------
r10680 | divverent | 2010-12-25 08:48:06 -0800 (Sat, 25 Dec 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_textures.c

fix avgcolor calculation with fake S3TC decoding
------------------------------------------------------------------------
r10679 | divverent | 2010-12-25 08:22:57 -0800 (Sat, 25 Dec 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_textures.c

add a trivial quarter-res S3TC decoder to DDS loading
------------------------------------------------------------------------
r10678 | divverent | 2010-12-22 17:30:56 -0800 (Wed, 22 Dec 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/menu.c

also make the darkplaces menu able to enter up to 127 chars in the name field
------------------------------------------------------------------------
r10677 | divverent | 2010-12-22 17:29:43 -0800 (Wed, 22 Dec 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/quakedef.h

also make MAX_SCOREBOARDNAME 128 in the small memory profile, as it doesn't mean much memory usage
------------------------------------------------------------------------
r10676 | divverent | 2010-12-22 17:27:02 -0800 (Wed, 22 Dec 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/draw.h

allow more font sizes
------------------------------------------------------------------------
r10675 | divverent | 2010-12-21 12:33:12 -0800 (Tue, 21 Dec 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/quakedef.h

allow longer player names
------------------------------------------------------------------------
r10674 | divverent | 2010-12-18 13:58:45 -0800 (Sat, 18 Dec 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

r_showsurfaces: fix "ghost normals"
------------------------------------------------------------------------
r10673 | divverent | 2010-12-18 12:12:02 -0800 (Sat, 18 Dec 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

equalize entities: desaturate the lightgrid when equalizing fullbright entities
------------------------------------------------------------------------
r10672 | divverent | 2010-12-18 12:06:14 -0800 (Sat, 18 Dec 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/vid_wgl.c

fix a warning
------------------------------------------------------------------------
r10671 | divverent | 2010-12-18 09:38:01 -0800 (Sat, 18 Dec 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cd_linux.c

glx build, Linux: remove one source of message spam (when /dev/cdrom is not readable)
------------------------------------------------------------------------
r10670 | divverent | 2010-12-18 03:12:36 -0800 (Sat, 18 Dec 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix display of r_shownormals < 0
------------------------------------------------------------------------
r10669 | divverent | 2010-12-17 01:15:31 -0800 (Fri, 17 Dec 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_particles.c

do not crash if loading a particlefont texture fails
------------------------------------------------------------------------
r10668 | vortex | 2010-12-16 10:14:21 -0800 (Thu, 16 Dec 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/dpdefs/dpextensions.qc
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.h
   M /trunk/darkplaces/svvm_cmds.c
   M /trunk/darkplaces/world.c

torgue->torque
------------------------------------------------------------------------
r10667 | vortex | 2010-12-16 09:49:24 -0800 (Thu, 16 Dec 2010) | 8 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/dpdefs/dpextensions.qc
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.h
   M /trunk/darkplaces/svvm_cmds.c
   M /trunk/darkplaces/world.c
   M /trunk/darkplaces/world.h

ODE improvements:
- physics_enable builtin (enable/disable objects)
- physics_addforce (add force to certain point in object)
- physics_addtorgue (add relative torgue)
- extension documented as "DP_PHYSICS_ODE", added additional check if lib is enabled in checextension()
- #ifdef'ed usage of dWorldStepFast1 and make it off by default as it's been removed from ODE trunk
- added "collision" mesh support, if there is some mesh with "collision" texture, all other meshes are ignored and that mesh is used.

------------------------------------------------------------------------
r10666 | vortex | 2010-12-16 09:42:36 -0800 (Thu, 16 Dec 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix glgl water trick that doesnt work well (it was doing 0.5 alphamod near egges)
------------------------------------------------------------------------
r10665 | divverent | 2010-12-15 22:46:40 -0800 (Wed, 15 Dec 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/r_sky.c

if a skyboxskinframe is missing, don't draw that sky surface (fixes crash if some but not all skybox files exist; also allows a quicker "partial skybox" where e.g. the bottom side isn't even drawn at all)
------------------------------------------------------------------------
r10664 | divverent | 2010-12-15 22:39:02 -0800 (Wed, 15 Dec 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_main.c

When reallocating CSQC render entity space, make sure existing render edicts referencing them are adjusted
------------------------------------------------------------------------
r10663 | divverent | 2010-12-15 04:01:47 -0800 (Wed, 15 Dec 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_textures.c

care for the premultiplied-alpha flag when handling DDS files (use DXT2/DXT4 FOURCC when writing, and show a warning when loading if the type is wrong)
------------------------------------------------------------------------
r10662 | divverent | 2010-12-14 09:57:32 -0800 (Tue, 14 Dec 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

found out why the water plane issue happend: namely, when a water plane is backface culled, R_Water_FindPlane may not find ANY plane. Remove the print, ignore the damage it causes (as the damage only consists of some additional tris being rendered that should not, but instead less batches).
------------------------------------------------------------------------
r10661 | divverent | 2010-12-14 07:23:30 -0800 (Tue, 14 Dec 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

remove another useless check
------------------------------------------------------------------------
r10660 | divverent | 2010-12-14 07:20:29 -0800 (Tue, 14 Dec 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix a case where r_hdr 1 can cause message spam (previously: crashes) for not existing but referenced waterplanes
------------------------------------------------------------------------
r10659 | divverent | 2010-12-14 06:17:41 -0800 (Tue, 14 Dec 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

do not crash if no matching water plane could be found (BUT WHY DOES THIS HAPPEN TO BEGIN WITH)
------------------------------------------------------------------------
r10658 | divverent | 2010-12-12 12:50:15 -0800 (Sun, 12 Dec 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/console.c

fix sys_specialcharactertranslation for utf-8 mode
------------------------------------------------------------------------
r10657 | divverent | 2010-12-12 11:46:39 -0800 (Sun, 12 Dec 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

turn another print into a dprint
------------------------------------------------------------------------
r10656 | divverent | 2010-12-12 11:44:32 -0800 (Sun, 12 Dec 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/fs.c

be more silent about self-pack
------------------------------------------------------------------------
r10655 | divverent | 2010-12-12 11:37:58 -0800 (Sun, 12 Dec 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cmd.c

do not parse $variable stuff inside //comments
------------------------------------------------------------------------
r10654 | divverent | 2010-12-12 11:25:06 -0800 (Sun, 12 Dec 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/ft2.c

fix some stupid ft2.c warnings
------------------------------------------------------------------------
r10653 | divverent | 2010-12-12 09:59:25 -0800 (Sun, 12 Dec 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_screen.c

simplify it, and make it a bit nicer to the GPU
------------------------------------------------------------------------
r10652 | divverent | 2010-12-12 09:46:27 -0800 (Sun, 12 Dec 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_screen.c

fix loading screen handling (prevent self-overdraw)
------------------------------------------------------------------------
r10651 | divverent | 2010-12-12 05:37:51 -0800 (Sun, 12 Dec 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_screen.c

customizable loading screen picture scale, including limiting to screen bounds in different modes
------------------------------------------------------------------------
r10650 | divverent | 2010-12-10 12:40:03 -0800 (Fri, 10 Dec 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/crypto.c

fix a terminologic bug
------------------------------------------------------------------------
r10649 | divverent | 2010-12-09 03:04:30 -0800 (Thu, 09 Dec 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/server.h

use MAX_SCOREBOARDNAME instead of a hardcoded 64 bytes length in one struct definition
------------------------------------------------------------------------
r10648 | vortex | 2010-12-04 06:24:55 -0800 (Sat, 04 Dec 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/cl_video.h
   M /trunk/darkplaces/dpvsimpledecode.c
   M /trunk/darkplaces/dpvsimpledecode.h

maked cl_video to have module playback, so several video formats can be implemented. Quite nasty yet, as streaming audio is not supported and all videos have extension .dpv (as set by playvideo command).
------------------------------------------------------------------------
r10647 | divverent | 2010-12-03 13:39:51 -0800 (Fri, 03 Dec 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

allow rtdlight off, rtworld on
------------------------------------------------------------------------
r10646 | divverent | 2010-12-03 02:26:23 -0800 (Fri, 03 Dec 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cvar.c

cvar saving: do not save all ALLOCATED cvars (seta), only save all cvars that were not locked in by cvar_lockdefaults, so default.cfg-created cvars do not always spam the config file
------------------------------------------------------------------------
r10645 | divverent | 2010-12-01 00:12:17 -0800 (Wed, 01 Dec 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/snd_main.c

100% untested: additionally apply mastervolume to ambient sound channels
------------------------------------------------------------------------
r10644 | divverent | 2010-11-30 11:18:25 -0800 (Tue, 30 Nov 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix random white pixels with r_shadow_glossexact caused by unnormalized VectorS/T/R
------------------------------------------------------------------------
r10643 | vortex | 2010-11-29 11:01:22 -0800 (Mon, 29 Nov 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/world.c
   M /trunk/darkplaces/world.h

Attempt to stabilize ODE. Now using constant step (sys_ticrate set steptime) - on by default, recommended by ODE Manual, reduces jitter alot. Added object autodisabling, makes stacks to be faster. NaN fixing is optional now (on by default) on me it doesnt help with ODE double precision DLL, moreover it makes objects jitter and blink to '0 0 0' origin sometimes. Added simple physics stats printing (via physics_ode_printstats), added world damping controls (cvars, on by default). Reworked worldstep* cvars to use 2 cvars instead of 4.
------------------------------------------------------------------------
r10642 | divverent | 2010-11-28 09:11:17 -0800 (Sun, 28 Nov 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

handle a missing key more gracefully in crypto_uri_postbuf
------------------------------------------------------------------------
r10641 | divverent | 2010-11-28 06:36:29 -0800 (Sun, 28 Nov 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/utf8lib.c

strlennocol: fix color codes :P
------------------------------------------------------------------------
r10640 | divverent | 2010-11-26 13:02:42 -0800 (Fri, 26 Nov 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

also support signed GET requests. We will always sign the [postdata, "\0"], query string
------------------------------------------------------------------------
r10639 | divverent | 2010-11-26 03:58:41 -0800 (Fri, 26 Nov 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/crypto-keygen-standalone.c

remove a stupid buf2file call
------------------------------------------------------------------------
r10638 | divverent | 2010-11-25 22:02:05 -0800 (Thu, 25 Nov 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/crypto-keygen-standalone.c

fix stdio mode
------------------------------------------------------------------------
r10637 | divverent | 2010-11-25 21:57:28 -0800 (Thu, 25 Nov 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/crypto-keygen-standalone.c

fix typo
------------------------------------------------------------------------
r10636 | divverent | 2010-11-25 21:56:23 -0800 (Thu, 25 Nov 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/crypto-keygen-standalone.c

crypto-keygen-standalone: allow reading from file descriptors
------------------------------------------------------------------------
r10635 | divverent | 2010-11-25 12:30:49 -0800 (Thu, 25 Nov 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

fix two typos
------------------------------------------------------------------------
r10634 | divverent | 2010-11-25 12:30:46 -0800 (Thu, 25 Nov 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

use detached signatures for http post (more compatible to PHP)
------------------------------------------------------------------------
r10633 | divverent | 2010-11-25 12:30:42 -0800 (Thu, 25 Nov 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/crypto-keygen-standalone.c
   M /trunk/darkplaces/crypto.c
   M /trunk/darkplaces/crypto.h

initial work for DETACHED signatures
------------------------------------------------------------------------
r10632 | divverent | 2010-11-25 11:51:49 -0800 (Thu, 25 Nov 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/crypto.c

fix a cast
------------------------------------------------------------------------
r10631 | divverent | 2010-11-25 11:51:46 -0800 (Thu, 25 Nov 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/crypto.c

move base64 to common code
------------------------------------------------------------------------
r10630 | vortex | 2010-11-25 11:23:41 -0800 (Thu, 25 Nov 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/crypto.c
   M /trunk/darkplaces/prvm_cmds.c

fix warnings by adding type casts
------------------------------------------------------------------------
r10629 | divverent | 2010-11-25 10:59:39 -0800 (Thu, 25 Nov 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/libcurl.c
   M /trunk/darkplaces/libcurl.h
   M /trunk/darkplaces/prvm_cmds.c

support passing extra headers in POST requests; but this is not used yet
------------------------------------------------------------------------
r10628 | divverent | 2010-11-25 10:46:32 -0800 (Thu, 25 Nov 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/crypto.h

fix a typo
------------------------------------------------------------------------
r10627 | divverent | 2010-11-25 04:56:30 -0800 (Thu, 25 Nov 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/crypto-keygen-standalone.c
   M /trunk/darkplaces/crypto.c
   M /trunk/darkplaces/crypto.h
   M /trunk/darkplaces/dpdefs/csprogsdefs.qc
   M /trunk/darkplaces/dpdefs/dpextensions.qc
   M /trunk/darkplaces/dpdefs/menudefs.qc
   M /trunk/darkplaces/libcurl.c
   M /trunk/darkplaces/libcurl.h
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/svvm_cmds.c

DP_QC_URI_POST extension (uri_post, uri_postbuf, crypto_uri_postbuf)
------------------------------------------------------------------------
r10626 | divverent | 2010-11-24 12:58:27 -0800 (Wed, 24 Nov 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/screen.h

move r_stereo adjustments into R_RenderView so that it executes AFTER CSQC may have adjusted the view. Makes redblue stereo work even in steel storm.
------------------------------------------------------------------------
r10625 | divverent | 2010-11-24 12:35:56 -0800 (Wed, 24 Nov 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/common.h

fix a stupid warning on OS X
------------------------------------------------------------------------
r10624 | havoc | 2010-11-21 16:57:14 -0800 (Sun, 21 Nov 2010) | 9 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_shadow.c

refactored and optimized the R_Q1BSP_RecursiveGetLightInfo function
properly clear the leaf, surface, and triangle visibility data on a
light, this might fix performance issues with the SVBSP culling method
added a BIH (bounding interval hierarchy) culling method for lights
rather than just the BSP method used by default, however this has
yielded no performance gains outside of .obj maps, so by default it only
uses this new method on .obj maps (where the lack of vis culling is
unimportant)

------------------------------------------------------------------------
r10623 | havoc | 2010-11-21 04:34:31 -0800 (Sun, 21 Nov 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c

fix a couple error messages on shutdown of dedicated server

------------------------------------------------------------------------
r10622 | havoc | 2010-11-21 04:30:54 -0800 (Sun, 21 Nov 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

fix D3D9 build

------------------------------------------------------------------------
r10621 | havoc | 2010-11-21 04:26:19 -0800 (Sun, 21 Nov 2010) | 5 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c

use r_smoothnormals_areaweighting cvar on all calls to Mod_BuildNormals
and Mod_BuildTextureVectorsFromNormals - rather than assuming the artist
wanted area weighted, as if the normalmap was baked for
non-area-weighted tangents this just yields wrong results

------------------------------------------------------------------------
r10620 | havoc | 2010-11-21 04:25:55 -0800 (Sun, 21 Nov 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

someone broke R_CompleteLightPoint, fix this call

------------------------------------------------------------------------
r10619 | vortex | 2010-11-20 15:59:28 -0800 (Sat, 20 Nov 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/dpdefs/csprogsdefs.qc
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h

CL_VM_GetLight: allow 2'nd optional parm which sets sampling mask: 1 lightmap (default one), 2 worldrtlight, 4 - dlight. Added getlights2 to the csprogdefs.qc.
------------------------------------------------------------------------
r10618 | havoc | 2010-11-20 06:14:59 -0800 (Sat, 20 Nov 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_user.c

print more useful data when a corrupt input packet comes from a client

------------------------------------------------------------------------
r10617 | divverent | 2010-11-19 23:38:25 -0800 (Fri, 19 Nov 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix camera texture colors
------------------------------------------------------------------------
r10616 | havoc | 2010-11-19 07:14:53 -0800 (Fri, 19 Nov 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_wav.c

don't load corrupt wav files

------------------------------------------------------------------------
r10615 | havoc | 2010-11-19 05:55:20 -0800 (Fri, 19 Nov 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

fix fog on particles (premultiplied alpha change was doing it wrong)

------------------------------------------------------------------------
r10614 | havoc | 2010-11-19 05:53:04 -0800 (Fri, 19 Nov 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

allow loading DXT2 and DXT4 dds files

------------------------------------------------------------------------
r10613 | havoc | 2010-11-19 05:42:14 -0800 (Fri, 19 Nov 2010) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/r_textures.h

particle rendering now uses premultiplied alpha (texture is
automatically converted on load, however dds may need to be DXT4 rather
than DXT5 now)
this should give an fps boost

------------------------------------------------------------------------
r10612 | havoc | 2010-11-19 04:31:55 -0800 (Fri, 19 Nov 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

now that performance of cl_decals_newsystem is not terrible, enable it
by default

------------------------------------------------------------------------
r10611 | havoc | 2010-11-19 04:24:34 -0800 (Fri, 19 Nov 2010) | 5 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

do not generate vertexposition/vertexmesh arrays in
RSurf_ActiveCustomEntity, this is a major fps aid
use vertex3f rather than vertexposition array in entity decal handling
make fewer calls to R_Mesh_ResizeArrays

------------------------------------------------------------------------
r10610 | havoc | 2010-11-19 04:23:03 -0800 (Fri, 19 Nov 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_mix.c

optimize prologic inversion, it was really showing up in profiles

------------------------------------------------------------------------
r10609 | havoc | 2010-11-19 02:36:06 -0800 (Fri, 19 Nov 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c

match sound radius in Quake 1.01, where it was effectively 1200

------------------------------------------------------------------------
r10608 | havoc | 2010-11-19 02:10:43 -0800 (Fri, 19 Nov 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c

change default snd_soundradius back to 1000, matching Quake

------------------------------------------------------------------------
r10607 | havoc | 2010-11-18 07:47:52 -0800 (Thu, 18 Nov 2010) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/netconn.c

for purposes of better compatibility with proquake servers, darkplaces
client now pretends to be proquake 3.40 when connecting to quake
protocol servers, this enables precise aim and the proquake NAT fix
(which the server only supports on proquake clients...  grr)

------------------------------------------------------------------------
r10606 | havoc | 2010-11-18 06:09:20 -0800 (Thu, 18 Nov 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

changed default status output to match ProQuake 4.51

------------------------------------------------------------------------
r10605 | havoc | 2010-11-17 18:45:31 -0800 (Wed, 17 Nov 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

don't spam warnings about bogus frame numbers in states, because FvF
does this all the time, developer_extra 1 will reenable these

------------------------------------------------------------------------
r10604 | havoc | 2010-11-17 17:53:31 -0800 (Wed, 17 Nov 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c

fix proquake rcon replies - use NetConn_Write, not NetConn_WriteString

------------------------------------------------------------------------
r10603 | havoc | 2010-11-17 17:44:07 -0800 (Wed, 17 Nov 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/console.h
   M /trunk/darkplaces/netconn.c

added server support for proquake rcon when running quake protocol

------------------------------------------------------------------------
r10602 | divverent | 2010-11-17 13:05:48 -0800 (Wed, 17 Nov 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/model_alias.c

developer_extra: also spam some messages during model loading regarding .skin file parsing
------------------------------------------------------------------------
r10601 | vortex | 2010-11-16 14:14:27 -0800 (Tue, 16 Nov 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_video.c

playvideo: cl_video_keepaspectratio == 2 will do clip instead of stretch, added simple fadein/fadeout effects via cl_video_fadein and cl_video_fadeout cvars (which sets seconds).
------------------------------------------------------------------------
r10599 | havoc | 2010-11-14 05:24:27 -0800 (Sun, 14 Nov 2010) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_shadow.c

illuminated surfaces are now sorted by texture, giving a good fps
increase, especially in realtime world lighting, this can be turned off
with the r_shadow_sortsurfaces cvar if desired

------------------------------------------------------------------------
r10598 | havoc | 2010-11-14 05:23:32 -0800 (Sun, 14 Nov 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_backend.c

rename meshes to draws in r_speeds report
added drawn vertices count alongside the triangles count

------------------------------------------------------------------------
r10597 | havoc | 2010-11-13 07:32:14 -0800 (Sat, 13 Nov 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/ft2.c
   M /trunk/darkplaces/gl_rmain.c

fix some HLSL errors
fix a warning on some ft2 code
------------------------------------------------------------------------
r10596 | divverent | 2010-11-13 06:07:13 -0800 (Sat, 13 Nov 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/model_brush.c

avoid NULL pointer access if a surface had an unsupported type
------------------------------------------------------------------------
r10595 | divverent | 2010-11-13 06:05:04 -0800 (Sat, 13 Nov 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/model_brush.c

show more detail in "has no triangles" and "has no vertexes" warning
------------------------------------------------------------------------
r10594 | havoc | 2010-11-13 04:39:52 -0800 (Sat, 13 Nov 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

skip zero triangle batches, for good measure

------------------------------------------------------------------------
r10593 | havoc | 2010-11-13 04:35:42 -0800 (Sat, 13 Nov 2010) | 5 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix wrong-texture rendering in stonekeep where a 0-triangles patch
(probably degenerate) was causing the surface batcher to give up early,
and render the previous batch instead (drawing over a perfectly good
piece of geometry with the wrong texture...)

------------------------------------------------------------------------
r10592 | havoc | 2010-11-13 03:07:20 -0800 (Sat, 13 Nov 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_explosion.c

use less R_Mesh_ResetTextureState calls for more performance

------------------------------------------------------------------------
r10591 | havoc | 2010-11-13 01:03:09 -0800 (Sat, 13 Nov 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/draw.h
   M /trunk/darkplaces/gl_draw.c

render shownetgraph much faster by drawing an entire batch of lines at a
time

------------------------------------------------------------------------
r10590 | havoc | 2010-11-13 01:02:45 -0800 (Sat, 13 Nov 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/world.c

fix some warnings

------------------------------------------------------------------------
r10589 | divverent | 2010-11-12 10:40:51 -0800 (Fri, 12 Nov 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/ft2.c

fix leaked font fallbacks
------------------------------------------------------------------------
r10588 | divverent | 2010-11-12 10:40:47 -0800 (Fri, 12 Nov 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/ft2.c
   M /trunk/darkplaces/ft2.h

Store the data pointer and free it on Font_UnloadFont
------------------------------------------------------------------------
r10587 | divverent | 2010-11-12 10:40:44 -0800 (Fri, 12 Nov 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/ft2.c

Free the data of each font attachment in Font_UnloadFont
------------------------------------------------------------------------
r10586 | divverent | 2010-11-11 06:05:27 -0800 (Thu, 11 Nov 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/snd_ogg.c

be more clear in the overflow message of OGG_FetchSound
------------------------------------------------------------------------
r10585 | havoc | 2010-11-10 16:39:20 -0800 (Wed, 10 Nov 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

fix serious bug with stencil shadows from world caused by a mysterious #if 0

------------------------------------------------------------------------
r10584 | vortex | 2010-11-09 11:04:48 -0800 (Tue, 09 Nov 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_wgl.c

add joy_axiskeyevents cvar which turns on engine-side emulation of arrow button events since not all drivers generate button events for movement axes. Also made wgl joystick code a bit more similar to SDL one.
------------------------------------------------------------------------
r10583 | divverent | 2010-11-07 10:37:40 -0800 (Sun, 07 Nov 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/lhnet.c

DPrint the LHNET_Read and LHNET_Write errors (as they may just indicate lack of IPv6 connectivity and don't mean DP won't work)
------------------------------------------------------------------------
r10582 | divverent | 2010-11-07 05:09:01 -0800 (Sun, 07 Nov 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/darkplaces.txt
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h

new shader parameter "dppolygonoffset <factor> <offset>"; new cvars mod_q3shader_default_polygonoffset and mod_q3shader_default_polygonfactor
------------------------------------------------------------------------
r10581 | divverent | 2010-11-06 08:08:44 -0700 (Sat, 06 Nov 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/view.c

fix a small bug regarding bobfall
------------------------------------------------------------------------
r10580 | divverent | 2010-11-05 07:32:07 -0700 (Fri, 05 Nov 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/makefile.inc

add -framework IOKit to allow changing mouse acceleration parameters
------------------------------------------------------------------------
r10579 | divverent | 2010-11-05 06:27:13 -0700 (Fri, 05 Nov 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/vid_sdl.c

copy the apple_mouse_noaccel hack into vid_sdl too
------------------------------------------------------------------------
r10578 | divverent | 2010-11-04 12:38:13 -0700 (Thu, 04 Nov 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_screen.c

remove some stupid \n chars in infobar strings
------------------------------------------------------------------------
r10577 | divverent | 2010-11-04 01:10:10 -0700 (Thu, 04 Nov 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/sys_shared.c

win32: don't use select() for waiting, use Sleep() again
------------------------------------------------------------------------
r10576 | vortex | 2010-10-31 16:04:24 -0700 (Sun, 31 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/menu.h
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c

new m_newmap() MenuQC function which gets executed each time client goes new level. +Option for Blood Omnicide which lets menu QC to control keys while playing video.
------------------------------------------------------------------------
r10575 | vortex | 2010-10-30 20:11:58 -0700 (Sat, 30 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_video.c

remove unnecessary Con_Printf
------------------------------------------------------------------------
r10574 | vortex | 2010-10-30 16:10:35 -0700 (Sat, 30 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/r_shadow.c

R_CompleteLightPoint: more correct sampling
------------------------------------------------------------------------
r10573 | vortex | 2010-10-30 11:55:47 -0700 (Sat, 30 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix SHADERSTATICPARMS_COUNT to right value
------------------------------------------------------------------------
r10572 | vortex | 2010-10-30 11:24:09 -0700 (Sat, 30 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_brush.c

For lightgrid sampling move lightstyle[0] applying to shader domain as it seems to be far more precise here (see http://omnicide.legacy-of-kain.ru/work/cbo_glslgridlightchangecomp.gif), while leaving the default way for < GL2 paths, dunno why it happens and i cant find any reasons for that, current approach 'just works'. Also added "_enable" cvars for all r_glsl_postprocess_uservec* which will toggle their usage (also creates USERVEC* define once enabled).
------------------------------------------------------------------------
r10571 | divverent | 2010-10-30 11:19:38 -0700 (Sat, 30 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

offsetmapping: make it work on ATI Radeon 9500-9800/X300 again
------------------------------------------------------------------------
r10570 | divverent | 2010-10-29 13:19:14 -0700 (Fri, 29 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/crypto-keygen-standalone.c

fix some warnings
------------------------------------------------------------------------
r10569 | divverent | 2010-10-29 13:19:10 -0700 (Fri, 29 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/crypto-keygen-standalone.c

add a "dummy protocol" support
------------------------------------------------------------------------
r10568 | vortex | 2010-10-29 10:54:59 -0700 (Fri, 29 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_video.c

oops, video texture unlinking was accidentally removed, restore it
------------------------------------------------------------------------
r10567 | vortex | 2010-10-29 10:50:35 -0700 (Fri, 29 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/cl_video.h

cvar "cl_video_keepaspectratio" which scales fullscreen video to keep original aspect ratio on widescreen resolutions
------------------------------------------------------------------------
r10566 | divverent | 2010-10-29 07:30:24 -0700 (Fri, 29 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_draw.c

I suppose 0xE000 is a valid fontmap char... so render it as charmap item 0
------------------------------------------------------------------------
r10565 | divverent | 2010-10-29 07:27:07 -0700 (Fri, 29 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/keys.c

don't translate \0 to \uE000 when receiving that keycode (as it simply is a nonprintable key then)
------------------------------------------------------------------------
r10564 | divverent | 2010-10-29 07:25:45 -0700 (Fri, 29 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_draw.c

fix one issue with textshadow moving oddly around in an unknown situation
------------------------------------------------------------------------
r10563 | havoc | 2010-10-28 14:54:15 -0700 (Thu, 28 Oct 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/crypto.c
   M /trunk/darkplaces/darkplaces-dedicated.vcproj
   M /trunk/darkplaces/darkplaces-sdl.vcproj
   M /trunk/darkplaces/darkplaces-wgl.vcproj
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/world.c

fix MSVC2008 compilation again
fix some warnings in MSVC2008
------------------------------------------------------------------------
r10562 | divverent | 2010-10-22 15:23:53 -0700 (Fri, 22 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/world.c

explain more why physics_ode is 0 by default
------------------------------------------------------------------------
r10561 | divverent | 2010-10-22 15:20:34 -0700 (Fri, 22 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/world.c

fix a warning in ODE code
------------------------------------------------------------------------
r10560 | divverent | 2010-10-22 15:18:59 -0700 (Fri, 22 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/world.c

ODE: if we enable it by default on Win32, we should do so anywhere; also add a cvar physics_ode as master switch for ODE physics (0 by default)
------------------------------------------------------------------------
r10559 | vortex | 2010-10-22 14:56:14 -0700 (Fri, 22 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_draw.c

Fix nasty bug with dp_fonts structure expanding, once dp_fonts.f being reallocated, their corresponding ft2 settings links was messed up causing crash or postprocess to be lost.
------------------------------------------------------------------------
r10558 | havoc | 2010-10-22 11:49:53 -0700 (Fri, 22 Oct 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h

added GAME_MOONHELM

------------------------------------------------------------------------
r10557 | havoc | 2010-10-22 11:05:57 -0700 (Fri, 22 Oct 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/world.c

enable ODE dll support by default on windows

------------------------------------------------------------------------
r10556 | divverent | 2010-10-21 09:11:33 -0700 (Thu, 21 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/.gitattributes

new .gitattributes file, no visible change
------------------------------------------------------------------------
r10555 | divverent | 2010-10-19 12:13:39 -0700 (Tue, 19 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/sv_phys.c

fix in entity teleport detection of FlyMove
------------------------------------------------------------------------
r10554 | divverent | 2010-10-19 06:45:22 -0700 (Tue, 19 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_screen.c

new r_stereo modes (horiz and vert split)
------------------------------------------------------------------------
r10553 | divverent | 2010-10-18 23:29:53 -0700 (Mon, 18 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix a D3D compile error
------------------------------------------------------------------------
r10552 | divverent | 2010-10-18 23:24:42 -0700 (Mon, 18 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

make getsurface* not animate vertices if the model is not animated
------------------------------------------------------------------------
r10551 | divverent | 2010-10-18 13:27:16 -0700 (Mon, 18 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/quakedef.h

as the SSE bug seems fixed now, use SSE in MSVC builds now too again
------------------------------------------------------------------------
r10550 | divverent | 2010-10-18 00:29:59 -0700 (Mon, 18 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

experimental: do not auto allocate a skeletonobject when a CSQC model just uses frame based animation (NOTE: this MAY even cause crashes, please test, I just can't find any case where that object is really required); this moves blending of frame based animations back into Mod_Skeletal_AnimateVertices again (if this commit causes worse performance, a different course of action may be reverting it, and making sure a skeletonobject is ALWAYS created, even for SVQC managed legacy entities)
------------------------------------------------------------------------
r10549 | divverent | 2010-10-18 00:29:44 -0700 (Mon, 18 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/model_alias.c

fix a Mem_Free(NULL) warning
------------------------------------------------------------------------
r10548 | vortex | 2010-10-17 18:26:27 -0700 (Sun, 17 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/r_shadow.c

fix a crash in R_CompleteLightPoint during rtworld sampling
------------------------------------------------------------------------
r10547 | vortex | 2010-10-17 18:07:41 -0700 (Sun, 17 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_video.c

Properly unlink video texture and suspend videos on r_restart, so they actually survive it.
------------------------------------------------------------------------
r10546 | vortex | 2010-10-17 17:47:19 -0700 (Sun, 17 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h
   M /trunk/darkplaces/r_sprites.c

R_CompleteLightPoint bugfixed, dynamic lights actually matter for lit particles, lit sprites now sample lightning from rtlights and dlights instead of just lightgrid (by using R_CompleteLightPoint).
------------------------------------------------------------------------
r10545 | vortex | 2010-10-17 15:26:24 -0700 (Sun, 17 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/r_sprites.c

Fix sprites whose name begins from ! (assumed lit sprites) to be actually lit with modellight/lightgrid, they are still not lit by realtime lightning at all.
------------------------------------------------------------------------
r10544 | vortex | 2010-10-17 12:23:27 -0700 (Sun, 17 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_move.c

add sv_gameplayfix_nostepmoveonsteepslopes which prevents MOVETYPE_STEP monsters (no FL_SWIM or FL_FLY ones) from walking very steep slopes
------------------------------------------------------------------------
r10543 | divverent | 2010-10-17 07:15:06 -0700 (Sun, 17 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/crypto.c
   M /trunk/darkplaces/netconn.c

fix two types to hopefulyl compile on MSVC
------------------------------------------------------------------------
r10542 | divverent | 2010-10-17 06:19:52 -0700 (Sun, 17 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix typo
------------------------------------------------------------------------
r10541 | divverent | 2010-10-17 06:18:40 -0700 (Sun, 17 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

quick and dirty fix of allocation of array buffers
------------------------------------------------------------------------
r10540 | divverent | 2010-10-16 12:30:17 -0700 (Sat, 16 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/clvm_cmds.c

extension (does this need a QC extension name?): allow legacy networked entities to be attached to CSQC entities added using R_AddEntities with a draw mask. Helps with adopting CSQC networked players in an otherwise legacy networked game.
------------------------------------------------------------------------
r10539 | divverent | 2010-10-16 01:54:06 -0700 (Sat, 16 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/mod_skeletal_animatevertices_sse.c

try fixing the SSE skeletonobjects case
------------------------------------------------------------------------
r10538 | divverent | 2010-10-16 01:41:21 -0700 (Sat, 16 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/quakedef.h

only enable SSE if __GNUC__ for the moment... needs fixing later
------------------------------------------------------------------------
r10537 | divverent | 2010-10-15 15:40:02 -0700 (Fri, 15 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

PolygonBegin: support a third argument "is2d"; fix a depth range bug
------------------------------------------------------------------------
r10536 | divverent | 2010-10-15 15:39:58 -0700 (Fri, 15 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

R_BeginPolygon: if done in 3D stage, make sure depth test is done
------------------------------------------------------------------------
r10535 | divverent | 2010-10-15 07:23:12 -0700 (Fri, 15 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/makefile.inc

only apply the CFLAGS_CRYPTO to the crypto compile; helps in the Xonotic build system
------------------------------------------------------------------------
r10534 | divverent | 2010-10-15 06:47:19 -0700 (Fri, 15 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/client.h
   A /trunk/darkplaces/crypto-keygen-standalone-brute.sh
   A /trunk/darkplaces/crypto-keygen-standalone.c
   A /trunk/darkplaces/crypto.c
   A /trunk/darkplaces/crypto.h
   M /trunk/darkplaces/dpdefs/dpextensions.qc
   M /trunk/darkplaces/dpdefs/menudefs.qc
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/fs.h
   M /trunk/darkplaces/hmac.c
   M /trunk/darkplaces/hmac.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/makefile.inc
   M /trunk/darkplaces/mdfour.c
   M /trunk/darkplaces/mdfour.h
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/menu.h
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/netconn.h
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/svvm_cmds.c

Cryptographic authentication support for the d0_blind_id library available on http://github.com/divVerent/d0_blind_id
------------------------------------------------------------------------
r10533 | divverent | 2010-10-13 23:15:03 -0700 (Wed, 13 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

move EXACTSPECULARMATH to the "lightweight" permutation system too, as there is no need to have it able to degrade
------------------------------------------------------------------------
r10532 | divverent | 2010-10-13 23:14:59 -0700 (Wed, 13 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

add back VorteX's "lightweight shader parameter" system, but have it detect cvar changes and recompile all glsl shaders if any changed so these can be changed at runtime still
------------------------------------------------------------------------
r10531 | vortex | 2010-10-13 15:49:54 -0700 (Wed, 13 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

remove r_glsl_saturation_redcompensate, as it's considered a hack and can be done with postprocess customizing
------------------------------------------------------------------------
r10530 | vortex | 2010-10-13 15:00:16 -0700 (Wed, 13 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h

Added dp_waterscroll <scale> <speed> shader keyword as simple simulation of water movement, use with dp_water. Works only with r_water 1.
------------------------------------------------------------------------
r10529 | vortex | 2010-10-13 13:57:26 -0700 (Wed, 13 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

add r_glsl_saturation_redcompensate optional effect to r_glsl_saturate (only works when saturate is below 1), will produce desaturation with red channel compensated. Tweaked water shader parms, added slight water animation by counter-scrolling 2 water normalmap layers in shader.
------------------------------------------------------------------------
r10528 | divverent | 2010-10-13 13:45:36 -0700 (Wed, 13 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/r_shadow.c

hope the scissor code is fine now
------------------------------------------------------------------------
r10527 | vortex | 2010-10-13 13:33:30 -0700 (Wed, 13 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/r_shadow.c

bring old R_Shadow_ScissorForBBox code (new code still there, commented out), since new code is broken on ATI cards, a temporary solution
------------------------------------------------------------------------
r10526 | divverent | 2010-10-13 12:57:13 -0700 (Wed, 13 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

oops, scissormode wasn't meant to be CVAR_SAVE
------------------------------------------------------------------------
r10525 | divverent | 2010-10-13 12:46:10 -0700 (Wed, 13 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

shut up a gcc warning
------------------------------------------------------------------------
r10524 | divverent | 2010-10-13 12:32:40 -0700 (Wed, 13 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix D3D scissoring
------------------------------------------------------------------------
r10523 | divverent | 2010-10-13 10:42:50 -0700 (Wed, 13 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix another typo in the water rendering improvement
------------------------------------------------------------------------
r10522 | divverent | 2010-10-13 10:22:56 -0700 (Wed, 13 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

r_water_scissormode: 0 = none, 1 = scissor only, 2 = cull only, 3 = both
------------------------------------------------------------------------
r10521 | divverent | 2010-10-13 10:18:55 -0700 (Wed, 13 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

adjust for left handed coordinate system in a reflected view
------------------------------------------------------------------------
r10520 | divverent | 2010-10-13 09:08:13 -0700 (Wed, 13 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/render.h

r_water_scissormode: 0 = none, 1 = glScissor, 2 = glScissor and frustum culling
------------------------------------------------------------------------
r10519 | divverent | 2010-10-13 02:56:29 -0700 (Wed, 13 Oct 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

"cl_movement_replay 0" to disable the built-in prediction

From: Jānis Rūcis <parasti@gmail.com>
------------------------------------------------------------------------
r10518 | divverent | 2010-10-10 09:36:44 -0700 (Sun, 10 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/r_shadow.c

I have no idea why, but R_Viewport_TransformToScreen apparently should NOT invert y, as doing so breaks dynamic light rendering in size-reduced views (HDR, water)
------------------------------------------------------------------------
r10517 | divverent | 2010-10-08 10:54:16 -0700 (Fri, 08 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/makefile.inc
   A /trunk/darkplaces/mod_skeletal_animatevertices_generic.c
   A /trunk/darkplaces/mod_skeletal_animatevertices_generic.h
   A /trunk/darkplaces/mod_skeletal_animatevertices_sse.c
   A /trunk/darkplaces/mod_skeletal_animatevertices_sse.h
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_alias.h
   M /trunk/darkplaces/quakedef.h

SSE patch by kyre, with runtime CPU detection and a cvar r_skeletal_use_sse if SSE is detected
------------------------------------------------------------------------
r10516 | divverent | 2010-10-06 04:20:45 -0700 (Wed, 06 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/netconn.c

fix another warning
------------------------------------------------------------------------
r10515 | divverent | 2010-10-06 04:19:27 -0700 (Wed, 06 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/lhnet.c

fix a syntax error. Why didn't my gcc catch it? clang does...
------------------------------------------------------------------------
r10514 | divverent | 2010-10-06 02:48:53 -0700 (Wed, 06 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/lhnet.c

fix misparsing of portless IPv6 addresses
------------------------------------------------------------------------
r10513 | divverent | 2010-10-06 02:48:52 -0700 (Wed, 06 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/netconn.c

adding my own IPv6 master server: dpmaster.div0.qc.to - default master server 4 (admin: divVerent) (only enabled if SUPPORTIPV6)
------------------------------------------------------------------------
r10512 | divverent | 2010-10-03 06:59:29 -0700 (Sun, 03 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/netconn.c

turn off the weird "%interface_name" thing in IPv6 addresses, as it won't compare right
------------------------------------------------------------------------
r10511 | divverent | 2010-10-03 06:59:19 -0700 (Sun, 03 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/netconn.c

make IPv6 addresses actually work in server queries
------------------------------------------------------------------------
r10510 | divverent | 2010-10-03 06:06:58 -0700 (Sun, 03 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/host_cmd.c

make "status" support IPv6
------------------------------------------------------------------------
r10509 | divverent | 2010-10-02 12:20:48 -0700 (Sat, 02 Oct 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/lhnet.c

fix a stupid and trivial IPv6 bug that causes a v6 supporting engine to HANG
------------------------------------------------------------------------
r10508 | havoc | 2010-09-30 13:35:12 -0700 (Thu, 30 Sep 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

don't crash in obj loading if v, vt, or vn are NULL or the indices are
invalid

------------------------------------------------------------------------
r10507 | divverent | 2010-09-29 00:23:15 -0700 (Wed, 29 Sep 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

depthonly, prepass: do not compare lightmap texture for batching (less meshes)
------------------------------------------------------------------------
r10506 | divverent | 2010-09-29 00:10:49 -0700 (Wed, 29 Sep 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix lightmap switching/batching in fakelight
------------------------------------------------------------------------
r10505 | divverent | 2010-09-29 00:10:44 -0700 (Wed, 29 Sep 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

Revert "for some reason, it's faster to always set the lightmaptexture (more than double fps) even if fakelight is enabled. LordHavoc, any idea why?"

This reverts commit 1a2ab86f0789c4b473dad83368c86634e4b7eb2c.
------------------------------------------------------------------------
r10504 | divverent | 2010-09-28 05:04:38 -0700 (Tue, 28 Sep 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

for some reason, it's faster to always set the lightmaptexture (more than double fps) even if fakelight is enabled. LordHavoc, any idea why?
------------------------------------------------------------------------
r10503 | divverent | 2010-09-28 05:04:33 -0700 (Tue, 28 Sep 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h

r_fakelight: 1 = use "fake" lighting (falloff-less light source at eye origin) if the loaded worldmodel is unlit, 2 = always use "fake" lighting; controlling cvar r_fakelight_intensity (0.75 is an empiric default value that on average seems to match the lightmap brightness of a selection of nexuiz maps)
------------------------------------------------------------------------
r10502 | havoc | 2010-09-26 19:44:16 -0700 (Sun, 26 Sep 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/svbsp.c

avoid crashes if MAX_SVBSP_POLYGONPOINTS would be exceeded

------------------------------------------------------------------------
r10501 | divverent | 2010-09-26 10:48:31 -0700 (Sun, 26 Sep 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/sv_main.c

cameras: when new eye pos == old eye pos, do not create a network eye
------------------------------------------------------------------------
r10500 | divverent | 2010-09-26 10:37:40 -0700 (Sun, 26 Sep 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix alpha in water rendering
------------------------------------------------------------------------
r10499 | divverent | 2010-09-26 09:45:18 -0700 (Sun, 26 Sep 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_draw.c

fix autoload semantics of drawpics
------------------------------------------------------------------------
r10498 | divverent | 2010-09-26 05:14:21 -0700 (Sun, 26 Sep 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix a display issue with warpzone decals I caused in my last change
------------------------------------------------------------------------
r10497 | divverent | 2010-09-25 23:40:31 -0700 (Sat, 25 Sep 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/keys.c

fix warnings in terencehill's code
------------------------------------------------------------------------
r10496 | divverent | 2010-09-25 12:48:30 -0700 (Sat, 25 Sep 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

allow .alpha to fade out water/refraction/reflection surfaces (only tested on refraction at the moment, sorry)
------------------------------------------------------------------------
r10495 | divverent | 2010-09-25 01:39:40 -0700 (Sat, 25 Sep 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/view.c

Fix a typo (v_idlescale is always 0 there)

Signed-off-by: terencehill <piuntn@gmail.com>
------------------------------------------------------------------------
r10494 | divverent | 2010-09-25 01:39:37 -0700 (Sat, 25 Sep 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

Fix showsound that cannot be shown alone cause of a missing check Simplify a bit the code to avoid redundant checks

Signed-off-by: terencehill <piuntn@gmail.com>
------------------------------------------------------------------------
r10493 | divverent | 2010-09-25 01:39:33 -0700 (Sat, 25 Sep 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c

loadfont now prints a warning if it gets more than MAX_FONT_SIZES sizes and skips duplicated sizes

Signed-off-by: terencehill <piuntn@gmail.com>
------------------------------------------------------------------------
r10492 | divverent | 2010-09-25 01:39:29 -0700 (Sat, 25 Sep 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/utf8lib.c

Fix again u8_COM_StringLengthNoColors returning always 0 if end is NULL (strlennocol case), and counting 1 less character if the last character is multibyte and end is not NULL

Signed-off-by: terencehill <piuntn@gmail.com>
------------------------------------------------------------------------
r10491 | divverent | 2010-09-25 01:35:59 -0700 (Sat, 25 Sep 2010) | 13 lines
Changed paths:
   M /trunk/darkplaces/keys.c

New command 'history' and new shortcuts to search through the commands history

ctrl-, goes to the first command of the history
ctrl-. goes to the last command of the history

type a string (wildcards allowed) and
ctrl-f prints all the matching commands
ctrl-r searches backwards
ctrl-shift-r searches forwards

The last 2 shortcuts also point the history's index to the matching command but without fetching it to let one continue the search. To fetch it, it suffices to just press UP or DOWN.

Signed-off-by: terencehill <piuntn@gmail.com>
------------------------------------------------------------------------
r10490 | divverent | 2010-09-24 14:37:43 -0700 (Fri, 24 Sep 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

Fix a possible crash when an invalid skinframe gets accessed after cl.time steps backwards (e.g. due to time syncing) right after an entity has been created. Might fix the steel storm crash, but certainly IS a segfault on unstable network connection. Note that a%b can be negative for a<0, b>0 (unlike mathematical 'mod' operation, C '%' is based on rounding towards zero)
------------------------------------------------------------------------
r10489 | divverent | 2010-09-24 04:21:33 -0700 (Fri, 24 Sep 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

comment out another unused var
------------------------------------------------------------------------
r10488 | divverent | 2010-09-24 04:11:11 -0700 (Fri, 24 Sep 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c

remove more unused code
------------------------------------------------------------------------
r10487 | divverent | 2010-09-24 04:07:38 -0700 (Fri, 24 Sep 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/model_brush.c

remove another unused variable
------------------------------------------------------------------------
r10486 | divverent | 2010-09-24 04:07:27 -0700 (Fri, 24 Sep 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/vid_wgl.c

remove two unused vars
------------------------------------------------------------------------
r10485 | divverent | 2010-09-24 03:36:53 -0700 (Fri, 24 Sep 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/snd_main.c

fix another bug in the prologic patch :)
------------------------------------------------------------------------
r10484 | divverent | 2010-09-22 22:17:14 -0700 (Wed, 22 Sep 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/snd_main.c

allow bgmvolume to be > 1 to be able to exceed mastervolume (but this and other "> 1" values are still clamped to 10, i.e. 10 dB); apply ReplayGain in SND_Spatialize instead of early when setting channel volume to better guard against clipping
------------------------------------------------------------------------
r10483 | divverent | 2010-09-22 22:17:09 -0700 (Wed, 22 Sep 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/snd_main.c

change clamping logic
------------------------------------------------------------------------
r10482 | divverent | 2010-09-22 22:17:05 -0700 (Wed, 22 Sep 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_main.h
   M /trunk/darkplaces/snd_mix.c

expand volume accuracy from 8bit to 16bit; allow channel volume values to be > 1, and clamp the resulting volume
------------------------------------------------------------------------
r10481 | divverent | 2010-09-22 21:40:22 -0700 (Wed, 22 Sep 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/snd_main.c

fix ambient sounds in prologic
------------------------------------------------------------------------
r10480 | havoc | 2010-09-22 09:21:11 -0700 (Wed, 22 Sep 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

fix a compile error and some warnings

------------------------------------------------------------------------
r10479 | divverent | 2010-09-22 09:11:52 -0700 (Wed, 22 Sep 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_main.h
   M /trunk/darkplaces/snd_mix.c

ProLogic patch by Joris Nijnuis, with some fixes
------------------------------------------------------------------------
r10478 | vortex | 2010-09-21 14:49:23 -0700 (Tue, 21 Sep 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/dpdefs/csprogsdefs.qc
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c

Fix GAME_XONOTIC beging misplaced in gamemode_t->gamemode_info causing "gamemode" to be initialized wrong. CSQC now knows "view_punchvector" and "view_punchangle" globals which is what it used to be.
------------------------------------------------------------------------
r10477 | tomaz | 2010-09-21 12:35:20 -0700 (Tue, 21 Sep 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/r_shadow.c

Fixed dynamic light shadowmapping in D3D, still gotta fix them in deferred
------------------------------------------------------------------------
r10476 | tomaz | 2010-09-18 15:45:49 -0700 (Sat, 18 Sep 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/r_shadow.c

Fixed the x axis flipped shadows, 1 step closer to getting all this to work perfecty in d3d9
------------------------------------------------------------------------
r10475 | havoc | 2010-09-18 05:47:03 -0700 (Sat, 18 Sep 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/vid_wgl.c

don't use D3DPRESENTFLAG_DISCARD_DEPTHSTENCIL because it clears the backbuffer depth on SetDepthStencilSurface calls
------------------------------------------------------------------------
r10474 | tomaz | 2010-09-17 15:58:16 -0700 (Fri, 17 Sep 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

Fix a couple HLSL shader warnings
------------------------------------------------------------------------
r10473 | tomaz | 2010-09-17 15:47:57 -0700 (Fri, 17 Sep 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

Forgot to put back the paranoid code
------------------------------------------------------------------------
r10472 | tomaz | 2010-09-17 15:47:20 -0700 (Fri, 17 Sep 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

More debug code for shaders, this time it preprocesses the shader before saving it as an .fx file
------------------------------------------------------------------------
r10471 | havoc | 2010-09-17 07:19:14 -0700 (Fri, 17 Sep 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/render.h

fix some bugs in the HLSL shader, mostly to do with r_shadow_deferred
change texture unit for shadowmaps to 15 rather than 11 because this fixes a conflict between r_shadow_deferred 1 and r_shadows 2 
------------------------------------------------------------------------
r10470 | havoc | 2010-09-17 04:28:24 -0700 (Fri, 17 Sep 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/r_shadow.c

in D3D9 mode do not use the VSDCT cubemap because the ShadowMap_Parameters are completely incompatible in the D3D9 renderer
------------------------------------------------------------------------
r10469 | havoc | 2010-09-17 04:24:52 -0700 (Fri, 17 Sep 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix a crash in D3D9 with r_sky 0
cleaned up some shadowmap debugging code in D3D9 shader
------------------------------------------------------------------------
r10468 | havoc | 2010-09-17 02:16:30 -0700 (Fri, 17 Sep 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/glquake.h

enable Tomaz's PIX-friendly shader debugging code if gl_paranoid is 1
made CHECKGLERROR not crash if qglGetError is NULL (as in D3D9 renderer for example)
------------------------------------------------------------------------
r10467 | havoc | 2010-09-17 01:56:55 -0700 (Fri, 17 Sep 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_textures.h
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_shared.c

remove r_shadow_texturetype cvar (now always uses 2D textures), remove shadowmap cube and rect support
removed GL_ARB_texture_rectangle texture support throughout engine (nothing using it)
refactored D3D9 path in R_Mesh_SetRenderTargets in unsuccessful attempt to fix D3D9 shadowmapping
------------------------------------------------------------------------
r10466 | tomaz | 2010-09-16 15:20:24 -0700 (Thu, 16 Sep 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

Added debug shaderflags used by the shader compiler which is needed to debug the shaders in pix
Also added saving of vertstring and fragstring to disk and D3DXCompileShaderFromFileA to load them, this helps when debugging shaders in pix ( all commented out )

------------------------------------------------------------------------
r10465 | havoc | 2010-09-16 03:58:28 -0700 (Thu, 16 Sep 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/r_textures.h

change D3D9 implementation of TEXTYPE_SHADOWMAP textures to use CreateDepthStencilSurface instead of CreateTexture, this fixes lots of errors (PIX works, REF rasterizer works, etc)
implement freeing of D3D9 textures
disable the texture size padding on D3D9 as it was not the cause of PIX trouble
------------------------------------------------------------------------
r10464 | havoc | 2010-09-16 02:14:39 -0700 (Thu, 16 Sep 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_textures.c

restructure the previous fix so it actually does something
------------------------------------------------------------------------
r10463 | havoc | 2010-09-16 01:45:34 -0700 (Thu, 16 Sep 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_textures.c

on D3D9 renderer do not allow textures to be uploaded with a size smaller than 2xN or Nx2 because the REF rasterizer refuses these (which makes PIX debugging hard)
------------------------------------------------------------------------
r10462 | tomaz | 2010-09-14 13:49:41 -0700 (Tue, 14 Sep 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/r_shadow.c

Set r_shadow_shadowmap2dcolortexture as first rendertarget when doing shadowmaps, sadly this didn't fix the shadowmaps but it at least fixed the white sky.
------------------------------------------------------------------------
r10461 | divverent | 2010-09-14 12:17:37 -0700 (Tue, 14 Sep 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

fix leaktest
------------------------------------------------------------------------
r10460 | divverent | 2010-09-14 11:46:45 -0700 (Tue, 14 Sep 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/matrixlib.c

add comments so I know which plane type is which
------------------------------------------------------------------------
r10459 | divverent | 2010-09-14 11:46:41 -0700 (Tue, 14 Sep 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/collision.c
   M /trunk/darkplaces/model_brush.c

TraceBrush: use in Collision_ClipToGenericEntity
------------------------------------------------------------------------
r10458 | divverent | 2010-09-14 11:46:37 -0700 (Tue, 14 Sep 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h

add a TraceBrush function to all model types, and implement it for BIH and Q3BSP
------------------------------------------------------------------------
r10457 | tomaz | 2010-09-11 18:38:43 -0700 (Sat, 11 Sep 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_backend.c

Fix stencil shadows in D3D9
------------------------------------------------------------------------
r10456 | tomaz | 2010-09-11 02:54:18 -0700 (Sat, 11 Sep 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces
   M /trunk/darkplaces/model_brush.c

Ignored MSVC build directories
Silenced a warning in MSVC 2008
------------------------------------------------------------------------
r10455 | divverent | 2010-09-10 17:20:09 -0700 (Fri, 10 Sep 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/zone.c

fix an inverted return value
------------------------------------------------------------------------
r10454 | divverent | 2010-09-10 16:23:22 -0700 (Fri, 10 Sep 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/snd_main.c

add a type cast for C++
------------------------------------------------------------------------
r10453 | divverent | 2010-09-10 04:42:56 -0700 (Fri, 10 Sep 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/zone.c

make the win32 case compile too (hope it doesn't break TOO horribly above 4G RAM, someone please test)
------------------------------------------------------------------------
r10452 | divverent | 2010-09-10 04:26:57 -0700 (Fri, 10 Sep 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/zone.c

add sys_memsize_virtual and sys_memsize_physical info cvars
------------------------------------------------------------------------
r10451 | divverent | 2010-09-09 00:37:50 -0700 (Thu, 09 Sep 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/snd_main.c

do sound occlusion only once per sound, not once per listener channel
------------------------------------------------------------------------
r10450 | divverent | 2010-09-08 23:55:01 -0700 (Wed, 08 Sep 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_particles.c

remove sparks if slower than sqrt(0.03)
------------------------------------------------------------------------
r10449 | divverent | 2010-09-08 23:54:58 -0700 (Wed, 08 Sep 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/snd_main.c

sound occlusion: use PVS by default, make the cvar able to toggle between PVS and LineOfSight occlusion
------------------------------------------------------------------------
r10448 | divverent | 2010-09-08 23:54:55 -0700 (Wed, 08 Sep 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix two warpzone related PVS bugs
------------------------------------------------------------------------
r10447 | divverent | 2010-09-07 00:37:02 -0700 (Tue, 07 Sep 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_demo.c

new option -benchmarkruns - if specified, the given number of benchmark runs is performed for -benchmark
------------------------------------------------------------------------
r10446 | divverent | 2010-09-05 23:21:51 -0700 (Sun, 05 Sep 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/progsvm.h

fix CSQC being unable to use the "effects" field as its fieldoffset never got initialized
------------------------------------------------------------------------
r10445 | divverent | 2010-09-05 22:09:56 -0700 (Sun, 05 Sep 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/keys.c

Allow to type the utf8 Euro currency sign (to work around windows-1252 encoding)
------------------------------------------------------------------------
r10444 | divverent | 2010-09-05 22:09:53 -0700 (Sun, 05 Sep 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/keys.c

make ctrl-key shortcuts in message mode display chars from the charmap even with utf8 enabled
------------------------------------------------------------------------
r10443 | divverent | 2010-09-05 10:34:29 -0700 (Sun, 05 Sep 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_particles.c

new cvars: r_drawparticles_nearclip_min and r_drawparticles_nearclip_max, use a range and fading for near clip of particles for speed optimization (fade them out before they become fullscreen)
------------------------------------------------------------------------
r10442 | divverent | 2010-09-05 08:48:51 -0700 (Sun, 05 Sep 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/netconn.c

reorganize sv_public code; add a level -3 that blocks at getchallenge level, but -2 blocks at connect level (srcon needs getchallenge, so -3 also blocks srcon); also sv_public -2 will make connect attempts show the string in sv_public_rejectreason
------------------------------------------------------------------------
r10441 | divverent | 2010-09-04 08:39:43 -0700 (Sat, 04 Sep 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

optimize R_AnimCache_UpdateEntityMeshBuffers to use memcpy instead of VectorCopy, Steel Storm 150fps -> 167fps (now only effective in D3D mode, as this path is usually not used any more in OpenGL)
------------------------------------------------------------------------
r10440 | divverent | 2010-09-04 08:32:12 -0700 (Sat, 04 Sep 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/utf8lib.c

clean up u8_StringLengthNoColors
------------------------------------------------------------------------
r10439 | divverent | 2010-09-04 08:32:09 -0700 (Sat, 04 Sep 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/keys.c

Since u8_prevbyte skips invalid chars on purpose, it can go before the ] if invalid utf8 chars get pasted in the console edit line. It's even possible to delete the ].
Fix this bug by giving to u8_prevbyte the edit line without ].
------------------------------------------------------------------------
r10438 | divverent | 2010-09-04 08:32:06 -0700 (Sat, 04 Sep 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/utf8lib.c

Fix u8_COM_StringLengthNoColors not counting many ASCII chars (up to '?')

Better handling of invalid chars in u8_COM_StringLengthNoColors
------------------------------------------------------------------------
r10437 | divverent | 2010-09-04 07:47:52 -0700 (Sat, 04 Sep 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/jpeg.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/sbar.c
   M /trunk/darkplaces/sv_main.c

Adding GAME_XONOTIC and recognizing xonotic executable names
------------------------------------------------------------------------
r10436 | divverent | 2010-09-02 22:32:15 -0700 (Thu, 02 Sep 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/netconn.c

build the string correctly
------------------------------------------------------------------------
r10435 | divverent | 2010-09-02 22:23:15 -0700 (Thu, 02 Sep 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/host_cmd.c

fix connect help
------------------------------------------------------------------------
r10434 | divverent | 2010-09-02 22:20:33 -0700 (Thu, 02 Sep 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/netconn.c

added arg: connect-userinfo; works like this: "connect server password foobar" will connect to server, and add \password\foobar to the infostring (works to connect to FTEQW passworded servers)
------------------------------------------------------------------------
r10432 | divverent | 2010-08-31 03:53:54 -0700 (Tue, 31 Aug 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

generate s- and t-vector of deformVertexes only if really needed (optimization for depthfirst pass mainly)
------------------------------------------------------------------------
r10431 | divverent | 2010-08-31 00:28:24 -0700 (Tue, 31 Aug 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

get rid of calculating vertexmesh animcache buffers if we do not need the vertexmesh... fixes performance of steel storm
------------------------------------------------------------------------
r10430 | havoc | 2010-08-29 17:36:32 -0700 (Sun, 29 Aug 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_rmain.c

fix components parameter on a few TexCoordPointer normal3f calls, thanks
to kyre for reporting this bug

------------------------------------------------------------------------
r10429 | divverent | 2010-08-29 11:33:06 -0700 (Sun, 29 Aug 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/libcurl.c

curl: strip user/pass from URLs on display
------------------------------------------------------------------------
r10428 | havoc | 2010-08-29 04:02:44 -0700 (Sun, 29 Aug 2010) | 4 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h

overhauled mod_q3bsp_lightmapmergepower code, to fix very weird bugs
with misnumbered lightmaps, and make all textures in the set the same
size (better performance on drivers that dislike texture size changes)

------------------------------------------------------------------------
r10427 | divverent | 2010-08-27 14:58:41 -0700 (Fri, 27 Aug 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/makefile.inc

fix a -lX11 typo
------------------------------------------------------------------------
r10426 | divverent | 2010-08-27 12:21:43 -0700 (Fri, 27 Aug 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/sv_main.c

fix nogravityonground description
------------------------------------------------------------------------
r10425 | havoc | 2010-08-27 12:18:33 -0700 (Fri, 27 Aug 2010) | 4 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

don't use sv_gameplayfix_stepmultipletimes by default (except in Nexuiz)
this fixes an sv_jumpstep-like behavior seen in quake dm2 where you have
difficulty falling into lava pits

------------------------------------------------------------------------
r10424 | divverent | 2010-08-27 09:48:41 -0700 (Fri, 27 Aug 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/BSDmakefile
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/makefile.inc
   M /trunk/darkplaces/vid_sdl.c

PROPERLY load the icon in SDL/X11
------------------------------------------------------------------------
r10423 | divverent | 2010-08-27 07:18:30 -0700 (Fri, 27 Aug 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/vid_sdl.c

vid_sdl: also upload a smooth netwm icon if possible, by fetching the X11 window ID and using Xlib code on it (code is inactive on SDL 1.3+, as 1.3 supports NETWM icons natively)
------------------------------------------------------------------------
r10422 | divverent | 2010-08-26 22:43:12 -0700 (Thu, 26 Aug 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/vid_sdl.c

SDL: also use a non-XPM icon darkplaces-icon.tga but only if SDL is >= 1.3 (SDL 1.2 doesn't support smooth alpha transparency on window icons)
------------------------------------------------------------------------
r10421 | divverent | 2010-08-26 22:43:07 -0700 (Thu, 26 Aug 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/vid_glx.c

GLX: use _NET_WM_ICON additionally to the xpm icon for most current window managers
_NET_WM_ICON is generated from darkplaces-icon.tga, darkplaces-icon2.tga, darkplaces-icon3.tga in this order
NOTE: at least GNOME displays the first icon only, so this one should have a nice resolution like 64x64
------------------------------------------------------------------------
r10420 | divverent | 2010-08-26 22:43:03 -0700 (Thu, 26 Aug 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/model_brush.c

do not use partial lightmap updates for lightmap merging
------------------------------------------------------------------------
r10419 | havoc | 2010-08-24 10:26:01 -0700 (Tue, 24 Aug 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/vid_wgl.c

overhauled dynamic vertex rendering in DX9 based on research by mh that showed the DrawIndexedPrimitiveUP function is many times faster than using dynamic vertex buffers
applied a patch from mh to the D3D Present handling to better cope with lost devices
------------------------------------------------------------------------
r10418 | havoc | 2010-08-24 10:19:14 -0700 (Tue, 24 Aug 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix some HLSL shader compile errors
disable check for gl_vbo in one part of surface setup code
------------------------------------------------------------------------
r10417 | havoc | 2010-08-24 10:16:29 -0700 (Tue, 24 Aug 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/lhnet.c

fix previous warning fix that only worked properly for MINGW
------------------------------------------------------------------------
r10416 | havoc | 2010-08-23 08:09:37 -0700 (Mon, 23 Aug 2010) | 6 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

split and overhauled R_Upload into two functions:
R_UploadPartialTexture - does a partial update for real, not used by
anything if gl_nopartialtextureupdates is on
R_UploadFullTexture - takes only new pixel data, does appropriate
scaling and uploads to video memory

------------------------------------------------------------------------
r10415 | havoc | 2010-08-23 08:07:35 -0700 (Mon, 23 Aug 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_gecko.c
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_textures.h

don't use TEXF_ALLOWUPDATES on fully-updated textures such as video

------------------------------------------------------------------------
r10413 | havoc | 2010-08-22 09:52:33 -0700 (Sun, 22 Aug 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/makefile

disable USE_WSPIAPI_H by default, since it only works with -DSUPPORTIPV6
which is also disabled

------------------------------------------------------------------------
r10412 | havoc | 2010-08-22 09:48:29 -0700 (Sun, 22 Aug 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

change R_Upload error from Host_error to Sys_Error, added texture name
to the message

------------------------------------------------------------------------
r10411 | divverent | 2010-08-22 08:13:36 -0700 (Sun, 22 Aug 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/sv_main.c

support more level network eyes, and make them static instead of on-stack. Now 8k of memory are used for warpzones.
------------------------------------------------------------------------
r10410 | havoc | 2010-08-21 15:11:10 -0700 (Sat, 21 Aug 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/host.c

fix errors related to cl_rollangle on dedicated servers where the cvar
was not being registered

------------------------------------------------------------------------
r10409 | havoc | 2010-08-20 05:50:53 -0700 (Fri, 20 Aug 2010) | 4 lines
Changed paths:
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/makefile.inc

migrate the libjpeg options to per-target scripting, and default the
libjpeg linking off on Mac OS X because we have to provide our own in
the .app

------------------------------------------------------------------------
r10408 | divverent | 2010-08-20 05:30:43 -0700 (Fri, 20 Aug 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/makefile

remove DP_LINK_TO_JPEG from makefile, as this is default now
------------------------------------------------------------------------
r10407 | havoc | 2010-08-19 10:44:57 -0700 (Thu, 19 Aug 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c

fix compilation of sdl and server builds when SUPPORTD3D is defined

------------------------------------------------------------------------
r10406 | havoc | 2010-08-19 10:34:47 -0700 (Thu, 19 Aug 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/makefile.inc

fixed some issues with how D3D=1 worked in the makefile

------------------------------------------------------------------------
r10405 | havoc | 2010-08-19 08:47:13 -0700 (Thu, 19 Aug 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/cap_ogg.c
   M /trunk/darkplaces/ft2.c
   M /trunk/darkplaces/image_png.c
   M /trunk/darkplaces/snd_ogg.c

add versioned dll names for a bunch of things

------------------------------------------------------------------------
r10404 | havoc | 2010-08-19 08:46:48 -0700 (Thu, 19 Aug 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.inc

link to libjpeg by default when built with gcc or mingw

------------------------------------------------------------------------
r10403 | havoc | 2010-08-19 08:15:32 -0700 (Thu, 19 Aug 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/sys_sdl.c

fix a compile error

------------------------------------------------------------------------
r10402 | havoc | 2010-08-19 07:38:49 -0700 (Thu, 19 Aug 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/bih.h
   M /trunk/darkplaces/cap_ogg.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/cvar.c
   M /trunk/darkplaces/cvar.h
   M /trunk/darkplaces/dpvsimpledecode.c
   M /trunk/darkplaces/dpvsimpledecode.h
   M /trunk/darkplaces/draw.h
   M /trunk/darkplaces/filematch.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/image_png.c
   M /trunk/darkplaces/lhnet.c
   M /trunk/darkplaces/lhnet.h
   M /trunk/darkplaces/libcurl.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/menu.h
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/prvm_exec.c
   M /trunk/darkplaces/r_modules.c
   M /trunk/darkplaces/r_modules.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_textures.h
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/snd_ogg.c
   M /trunk/darkplaces/snd_wav.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/svvm_cmds.c
   M /trunk/darkplaces/sys_linux.c
   M /trunk/darkplaces/sys_shared.c
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_wgl.c

fix almost all g++ -pedantic warnings

------------------------------------------------------------------------
r10401 | havoc | 2010-08-19 07:36:01 -0700 (Thu, 19 Aug 2010) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

load d3dx9_*.dll dynamically to get D3DXCompileShader to fix a compile
error with mingw headers, this also means it doesn't matter which
version is present on the user's system

------------------------------------------------------------------------
r10400 | havoc | 2010-08-19 07:33:10 -0700 (Thu, 19 Aug 2010) | 5 lines
Changed paths:
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/makefile.inc

reworked makefile a little bit to support DX9 renderer, add D3D=1 to
your make line to use it
now WIN32RELEASE and WIN64RELEASE do something useful (correct options
for 32bit and 64bit compiles)

------------------------------------------------------------------------
r10399 | divverent | 2010-08-19 05:28:30 -0700 (Thu, 19 Aug 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_textures.c

check the proper texture compression extension for deciding whether to S3TC compress
------------------------------------------------------------------------
r10398 | divverent | 2010-08-19 00:31:49 -0700 (Thu, 19 Aug 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

cs_*project: as both 2D and 3D rendering are confined to the viewport, it SHOULD be right to totally ignore the viewport in these functions. I may be wrong here though.
------------------------------------------------------------------------
r10397 | divverent | 2010-08-19 00:21:30 -0700 (Thu, 19 Aug 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/draw.h
   M /trunk/darkplaces/gl_draw.c

recalc the 2D view if changing view parameters with R_SetView
------------------------------------------------------------------------
r10396 | divverent | 2010-08-18 22:35:16 -0700 (Wed, 18 Aug 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_draw.c

Draw_CachePic_Flags: ignore TEXF_COMPRESS when comparing, because fallback pics remove the flag
------------------------------------------------------------------------
r10395 | divverent | 2010-08-18 22:35:13 -0700 (Wed, 18 Aug 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/view.c

use cl.movevars_stepheight for stair smoothing
------------------------------------------------------------------------
r10390 | divverent | 2010-08-13 11:42:44 -0700 (Fri, 13 Aug 2010) | 4 lines
Changed paths:
   M /trunk/darkplaces/cmd.c

In the apropos command exclude \n from being filtered by wildcards for alias values (an alias value always got a final \n).
For example, apropos ? returned a bunch of aliases with empty definitions

From: terencehill <piuntn@gmail.com>
------------------------------------------------------------------------
r10389 | divverent | 2010-08-13 11:42:41 -0700 (Fri, 13 Aug 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/cmd.c

Get rid of an unused variable

From: terencehill <piuntn@gmail.com>
------------------------------------------------------------------------
r10388 | divverent | 2010-08-13 11:42:38 -0700 (Fri, 13 Aug 2010) | 6 lines
Changed paths:
   M /trunk/darkplaces/filematch.c

Fix issues with matchpattern_with_separator
Wrong results in case wildcard_least_one is:
- false: *rc*.cfg finds quake.rc
- true: quake.*rc finds quake.rc

From: terencehill <piuntn@gmail.com>
------------------------------------------------------------------------
r10387 | havoc | 2010-08-12 05:00:54 -0700 (Thu, 12 Aug 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

fix a warning

------------------------------------------------------------------------
r10386 | havoc | 2010-08-11 23:27:17 -0700 (Wed, 11 Aug 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

set registered cvar consistently regardless of game mode

------------------------------------------------------------------------
r10385 | havoc | 2010-08-11 20:45:36 -0700 (Wed, 11 Aug 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix crash in steelstorm on a ent with no model

------------------------------------------------------------------------
r10384 | havoc | 2010-08-09 10:35:36 -0700 (Mon, 09 Aug 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/snd_win.c
   M /trunk/darkplaces/sys_win.c

improved include order to fix some compile errors using mingw g++

------------------------------------------------------------------------
r10383 | havoc | 2010-08-09 10:32:26 -0700 (Mon, 09 Aug 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

fix a few warnings

------------------------------------------------------------------------
r10382 | havoc | 2010-08-09 10:29:15 -0700 (Mon, 09 Aug 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fix a C++ void pointer error

------------------------------------------------------------------------
r10381 | divverent | 2010-08-09 06:27:54 -0700 (Mon, 09 Aug 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/sys_shared.c

Win64 builds: search for DLLs in bin64/
------------------------------------------------------------------------
r10380 | divverent | 2010-08-09 06:03:41 -0700 (Mon, 09 Aug 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/common.c

VM tokenizer: remove a duplicate condition in a long &&-expression
------------------------------------------------------------------------
r10379 | divverent | 2010-08-08 23:59:50 -0700 (Sun, 08 Aug 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_textures.c

actually look into DXT1 pixel data to check if it has a 3 in base 4, to check if the transparent pixel value is REALLY used; also enable alpha autodetection again
------------------------------------------------------------------------
r10378 | divverent | 2010-08-08 23:40:45 -0700 (Sun, 08 Aug 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/model_alias.c

Mod_BuildAliasSkinsFromSkinFile: strip image extension
------------------------------------------------------------------------
r10377 | divverent | 2010-08-06 13:41:56 -0700 (Fri, 06 Aug 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/snd_main.c

fix a seldom sound related segfault
------------------------------------------------------------------------
r10376 | divverent | 2010-08-06 12:22:21 -0700 (Fri, 06 Aug 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/r_textures.h

use the DDPF_ALPHAPIXELS flag for DDS reading, at least works for ATI Compressonator
------------------------------------------------------------------------
r10375 | divverent | 2010-08-06 11:48:30 -0700 (Fri, 06 Aug 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

cvar: r_texture_dds_load_dxt1_noalpha; if set, DXT1 alpha detection is disabled, and DXT1 is assumed to have no alpha.
Rationale is that ATI Compressonator sometimes picks the alpha'd compression mode [a, (a+b)/2, b, transparent] and then never uses the transparent color value 3, as it sometimes can yield better results than the non-alpha'd compression mode [a, (2a+b)/3, (a+2b)/3, b], and this throws off alpha detection on loading
------------------------------------------------------------------------
r10374 | divverent | 2010-08-06 10:57:09 -0700 (Fri, 06 Aug 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_textures.c

make sure the return value of R_PicmipForFlags can't get negative
------------------------------------------------------------------------
r10373 | divverent | 2010-08-04 09:33:55 -0700 (Wed, 04 Aug 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_input.c

only send prydoncursor related buttons, if cl_prydoncursor is 1
------------------------------------------------------------------------
r10372 | divverent | 2010-08-03 12:55:56 -0700 (Tue, 03 Aug 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

Merge remote branch 'origin/divVerent/clevercolormod'
------------------------------------------------------------------------
r10371 | havoc | 2010-08-02 22:54:37 -0700 (Mon, 02 Aug 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/image.c

also allow 32768x32768 pcx files

------------------------------------------------------------------------
r10370 | havoc | 2010-08-02 22:53:49 -0700 (Mon, 02 Aug 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/jpeg.c

allow tga, wal and jpg images to be 32768x32768 rather than 4096x4096,
fixes minimap creation in steelstorm at 8064x1600 resolution

------------------------------------------------------------------------
r10369 | havoc | 2010-07-29 23:22:01 -0700 (Thu, 29 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

a different fix for colormod on unusual blendfuncs than the last one
(unusual being anything other than add or alpha)

------------------------------------------------------------------------
r10368 | havoc | 2010-07-29 22:26:39 -0700 (Thu, 29 Jul 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

don't apply colormod to shaders that use unusual custom blendfuncs

------------------------------------------------------------------------
r10367 | havoc | 2010-07-28 13:12:11 -0700 (Wed, 28 Jul 2010) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

use TE_EXPLOSION in effectinfo.txt when encountering svc_particle with
count 1024 (exploboxes) rather than calling the internal
CL_ParticleExplosion directly, this allows people to override the effect

------------------------------------------------------------------------
r10366 | divverent | 2010-07-27 12:22:30 -0700 (Tue, 27 Jul 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/sys_shared.c

Library loading: if a DLL succeeds to load but a function is missing, also continue to the next one but warn.
------------------------------------------------------------------------
r10365 | divverent | 2010-07-26 05:05:38 -0700 (Mon, 26 Jul 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/snd_modplug.c

bump modplug version to libmodplug-1.dll (only supports 0.8.8 upwards, sorry, but any versions before are broken on 64bit platforms anyway)
------------------------------------------------------------------------
r10364 | divverent | 2010-07-25 12:39:19 -0700 (Sun, 25 Jul 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_screen.c

make prydon cursor absolute, not relative
------------------------------------------------------------------------
r10363 | divverent | 2010-07-25 11:42:31 -0700 (Sun, 25 Jul 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_backend.c

fix v_flipped with near clip plane (water, warpzone)
------------------------------------------------------------------------
r10362 | divverent | 2010-07-25 10:10:11 -0700 (Sun, 25 Jul 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_sdl.c

Linux SDL/GLX: allow loading the icon from .xpm at runtime (darkplaces-icon.xpm). Allows for easier branding.
------------------------------------------------------------------------
r10361 | divverent | 2010-07-25 07:56:25 -0700 (Sun, 25 Jul 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix a nasty bug in refraction/water renders. It is evil that GL20TU_FIRST must be matching, out of all texture units, the one of normalmaps.
------------------------------------------------------------------------
r10360 | divverent | 2010-07-25 05:20:39 -0700 (Sun, 25 Jul 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/draw.h
   M /trunk/darkplaces/gl_draw.c

track if a cachepic has alpha, and turn off depth write if it does; also use alpha-less blendfuncs if all alpha values are >= 1 and the texture has no alpha (might be a slight performance increase, but mainly to help R_BeginPolygon in 3D space)
------------------------------------------------------------------------
r10359 | divverent | 2010-07-24 23:14:44 -0700 (Sat, 24 Jul 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_draw.c

PROPERLY handle roundoff errors in drawsetcliparea
------------------------------------------------------------------------
r10358 | divverent | 2010-07-23 12:14:21 -0700 (Fri, 23 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/prvm_cmds.c

Fix the usage of the CACHEPICFLAGS_NOTPERSISTENT flag in Draw_CachePic calls

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10357 | divverent | 2010-07-21 02:46:58 -0700 (Wed, 21 Jul 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/.gitattributes

CRLF fixes, .gitattributes file updated
------------------------------------------------------------------------
r10356 | divverent | 2010-07-20 10:54:56 -0700 (Tue, 20 Jul 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_input.c

make airstopaccelerate less accidentally epic ;)
------------------------------------------------------------------------
r10355 | divverent | 2010-07-20 10:19:35 -0700 (Tue, 20 Jul 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/view.c

Merge remote branch 'origin/mirceakitsune/landing_viewshake_fix'
------------------------------------------------------------------------
r10354 | divverent | 2010-07-20 10:16:30 -0700 (Tue, 20 Jul 2010) | 5 lines
Changed paths:
   M /trunk/darkplaces/view.c

And my third intended change: Remove view bobbing dependencies from the gun model bobbing. It has its own cvar and imo there's no reason to block this effect when the normal bobbing is disabled. Their intensities could also be different, which is another reason why I think this doesn't make sense.

I don't believe it should change anything for Quake players since this just allows you to disable both effects individually. If the core developers disagree please revert this change.

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10353 | divverent | 2010-07-20 10:16:27 -0700 (Tue, 20 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/view.c

Second change: Use cos for the horizontal view bobbing while leaving sin for the vertical (old) one. This makes the view bobbing look rounder and prettier when both are enabled.

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10352 | divverent | 2010-07-20 10:16:24 -0700 (Tue, 20 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/view.c

Sort this space in a more correct way while I'm at it

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10351 | divverent | 2010-07-20 10:16:21 -0700 (Tue, 20 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt
   M /trunk/darkplaces/view.c

Fix some final things on my list for my effects in Darkplaces. First change: Use the highpass / lowpass values in Xonotic for gun leaning / following, which are much better.

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10350 | divverent | 2010-07-20 00:07:23 -0700 (Tue, 20 Jul 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c

sv_aircontrol_penalty
------------------------------------------------------------------------
r10349 | divverent | 2010-07-19 20:51:50 -0700 (Mon, 19 Jul 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

VM_stringtokeynum: return a float, not an int
------------------------------------------------------------------------
r10348 | divverent | 2010-07-16 15:25:31 -0700 (Fri, 16 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt
   M /trunk/darkplaces/view.c

Oops, must be framerate dependent

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10347 | divverent | 2010-07-16 15:25:25 -0700 (Fri, 16 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt
   M /trunk/darkplaces/view.c

Fix the final details and disable by default. Use cl_bobfall 0.05 to test at a good value. Ready for testing and merging.

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10346 | divverent | 2010-07-16 15:25:19 -0700 (Fri, 16 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt
   M /trunk/darkplaces/view.c

Minimum necessary speed for fall-bobbing to occur

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10345 | divverent | 2010-07-16 15:25:12 -0700 (Fri, 16 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/view.c

Bounds

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10344 | divverent | 2010-07-16 15:25:06 -0700 (Fri, 16 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt
   M /trunk/darkplaces/view.c

Cvars. Enabled by default just for testing until everything is done.

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10343 | divverent | 2010-07-16 15:25:00 -0700 (Fri, 16 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/view.c

The code works as intended! Change some names and comments in the meantime.

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10342 | divverent | 2010-07-16 15:24:54 -0700 (Fri, 16 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/view.c

Very close to getting the correct maths done. It now works as intended, just need to separate the swing's length and speed.

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10341 | divverent | 2010-07-16 15:24:42 -0700 (Fri, 16 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/view.c

Even closer to a senseful code. We need to get just one swing using sin()

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10340 | divverent | 2010-07-16 15:24:35 -0700 (Fri, 16 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/view.c

Use sin() for the the view going up / down. Now it needs to be arranged in a correct way.

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10339 | divverent | 2010-07-16 15:24:29 -0700 (Fri, 16 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/view.c

More progress, still nothing considerable

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10338 | divverent | 2010-07-16 15:24:23 -0700 (Fri, 16 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/view.c

Some comments and a view bound on the speed, which should match xyspeed's for the bobbing

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10337 | divverent | 2010-07-16 15:24:17 -0700 (Fri, 16 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/view.c

Make the view slowly go back after hitting the ground. We need to do the same for both up and down. Also use reasonable values until cvars are done.

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10336 | divverent | 2010-07-16 15:24:11 -0700 (Fri, 16 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/view.c

Attempt to implement landing viewshake effect (the camera lowering and going back up when you hit the ground with speed). Code very primitive at this point, and just gets the basic calculation in place.

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10335 | havoc | 2010-07-16 09:29:13 -0700 (Fri, 16 Jul 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fix uninitialized variable warning

------------------------------------------------------------------------
r10334 | divverent | 2010-07-16 02:07:42 -0700 (Fri, 16 Jul 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_textures.c

fix ~TEXF_PICMIP in DDS loading, and fix TEXF_ALPHA generation (there was a bug that caused TEXF_ALPHA to never be set, now it is set if the caller requested it AND the texture has alpha)
------------------------------------------------------------------------
r10333 | divverent | 2010-07-16 01:42:48 -0700 (Fri, 16 Jul 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h

cvar: r_mipnormalmaps
------------------------------------------------------------------------
r10332 | divverent | 2010-07-15 12:11:48 -0700 (Thu, 15 Jul 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/model_shared.c

fix ISWORLD and ISSPRITE texture flags (making r_picmipworld actually work again)
------------------------------------------------------------------------
r10331 | havoc | 2010-07-15 05:39:14 -0700 (Thu, 15 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

fix r_shadows 2 shadowmapping by rendering to the correct depth range in
GL again

------------------------------------------------------------------------
r10330 | havoc | 2010-07-15 05:38:52 -0700 (Thu, 15 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

improved r_shadows 2 shadowmapping setup code a bit, especially the
debugging code snippets

------------------------------------------------------------------------
r10329 | havoc | 2010-07-15 05:09:36 -0700 (Thu, 15 Jul 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

better error message when map load fails

------------------------------------------------------------------------
r10328 | havoc | 2010-07-15 05:08:38 -0700 (Thu, 15 Jul 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

fix map loading in Nexuiz

------------------------------------------------------------------------
r10327 | havoc | 2010-07-15 03:04:30 -0700 (Thu, 15 Jul 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/svbsp.c

raise SVBSP polygon points limit to avoid crashes with portal tests

------------------------------------------------------------------------
r10326 | havoc | 2010-07-14 03:18:23 -0700 (Wed, 14 Jul 2010) | 4 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

reworked .obj loader to work as a world model (SLOWLY though, no vis, no
surface clustering!), now also interprets o (object name) commands as
submodel number

------------------------------------------------------------------------
r10325 | havoc | 2010-07-14 03:15:46 -0700 (Wed, 14 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

changed modeldecompile's obj output to not negate an axis, this makes it
consistent with the OBJ loader

------------------------------------------------------------------------
r10324 | havoc | 2010-07-14 03:14:07 -0700 (Wed, 14 Jul 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

fix a mingw warning

------------------------------------------------------------------------
r10323 | havoc | 2010-07-14 03:13:50 -0700 (Wed, 14 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

allow loading non-bsp files as world models (no longer always appends
.bsp suffix)

------------------------------------------------------------------------
r10322 | havoc | 2010-07-14 03:13:17 -0700 (Wed, 14 Jul 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

fix a mingw warning

------------------------------------------------------------------------
r10321 | havoc | 2010-07-14 03:13:01 -0700 (Wed, 14 Jul 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

fix more mingw warnings

------------------------------------------------------------------------
r10320 | havoc | 2010-07-14 03:12:46 -0700 (Wed, 14 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix a warning in mingw
changed a model->brush.data_nodes check to data_leafs instead

------------------------------------------------------------------------
r10319 | havoc | 2010-07-14 03:11:44 -0700 (Wed, 14 Jul 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/lhnet.c
   M /trunk/darkplaces/sys_shared.c

fix more warnings in mingw

------------------------------------------------------------------------
r10318 | havoc | 2010-07-14 03:11:20 -0700 (Wed, 14 Jul 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_wgl.c

fix a warning in mingw

------------------------------------------------------------------------
r10317 | havoc | 2010-07-14 03:11:05 -0700 (Wed, 14 Jul 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/sys_sdl.c

fix a warning in mingw

------------------------------------------------------------------------
r10316 | havoc | 2010-07-14 03:10:46 -0700 (Wed, 14 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

fix a bug with svbsp compiled lights when a leaf has no portals -
however the leaf is assumed visible, not good

------------------------------------------------------------------------
r10315 | divverent | 2010-07-14 02:12:56 -0700 (Wed, 14 Jul 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/snd_modplug.c

add q prefix to modplug functions
------------------------------------------------------------------------
r10314 | divverent | 2010-07-12 11:09:19 -0700 (Mon, 12 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/view.c

Make cl_bobmodel work if cl_bob2 is enabled too. Although I don't see why bobmodel depends on view bobbing, given it has its own cvar.

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10313 | divverent | 2010-07-12 11:09:16 -0700 (Mon, 12 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/view.c

Bound the side bobbing's speed as well

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10312 | divverent | 2010-07-12 11:09:13 -0700 (Mon, 12 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/view.c

Remove xyspeed from the side bobbing. The speed is calculated separately for it, so we were multiplying the speed two times and dividing to match the proper intensity.

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10311 | divverent | 2010-07-12 11:09:08 -0700 (Mon, 12 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/view.c

Comments

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10310 | divverent | 2010-07-12 11:09:03 -0700 (Mon, 12 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/view.c

Place / move a speed bound, to avoid bobbing getting stronger if sv_maxspeed is over 400

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10309 | divverent | 2010-07-12 11:08:51 -0700 (Mon, 12 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/view.c

Bound cvar values instead of bounding how far the view can go. This also fixes the original view bobbing, where setting a high value for cl_bob would cause the view to instantly go up and down.

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10308 | divverent | 2010-07-12 11:08:43 -0700 (Mon, 12 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt
   M /trunk/darkplaces/view.c

Get rid of cl_bob2up. It's not good for -sideways- movement

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10307 | divverent | 2010-07-12 11:08:33 -0700 (Mon, 12 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt
   M /trunk/darkplaces/view.c

Cvar description grammar fix :P

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10306 | divverent | 2010-07-12 11:08:10 -0700 (Mon, 12 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/view.c

Code, name and comment cleanups

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10305 | divverent | 2010-07-12 11:08:00 -0700 (Mon, 12 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/view.c

Center the effect, as this isn't the vertical bobbing

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10304 | divverent | 2010-07-12 11:07:55 -0700 (Mon, 12 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/darkplaces.txt
   M /trunk/darkplaces/view.c

Tweak a definition and cvar

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10303 | divverent | 2010-07-12 11:07:51 -0700 (Mon, 12 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/darkplaces.txt
   M /trunk/darkplaces/view.c

Better name for the cvar set

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10302 | divverent | 2010-07-12 11:07:40 -0700 (Mon, 12 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/darkplaces.txt
   M /trunk/darkplaces/view.c

Remove the rolling in favor of the side-bobbing. I don't believe both effects would make sense to keep, and imo the side bobbing looks better than the rolling and simulates steps better. This can be reverted if anyone misses the rolling too much, but I don't think we need to load the code with both effects.

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10301 | divverent | 2010-07-12 11:07:10 -0700 (Mon, 12 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/view.c

Better bounds for the view rolling, and fix a comment

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10300 | divverent | 2010-07-12 11:06:44 -0700 (Mon, 12 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/view.c

Better bounds

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10299 | divverent | 2010-07-12 11:06:24 -0700 (Mon, 12 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/view.c

Sorry, this is more correct

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10298 | divverent | 2010-07-12 11:06:04 -0700 (Mon, 12 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/view.c

Add bounds. Tweak the bounds of the default bobbing as well (I hope this is alright, I tested the new values and they look good). Should allow more bobbing to be set from cvars.

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10297 | divverent | 2010-07-12 11:05:58 -0700 (Mon, 12 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt
   M /trunk/darkplaces/view.c

Code cleanup, disable by default (set cl_bobside to 0.02 for optimal intensity, larger values to see the effect better). I think this can be considered ready and working :) Please post comments on http://forums.xonotic.org/showthread.php?tid=583&pid=8527

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10296 | divverent | 2010-07-12 11:05:52 -0700 (Mon, 12 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/view.c

Add a bobside_airtime like for the bobroll, to prevent the effect while in the air or bunny-hopping

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10295 | divverent | 2010-07-12 11:05:47 -0700 (Mon, 12 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/view.c

Make the sideways bobbing speed-based. Not ready but should be safe to use and test.

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10294 | divverent | 2010-07-12 11:05:44 -0700 (Mon, 12 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/view.c

Code now in its place, but still doesn't work as indented

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10293 | divverent | 2010-07-12 11:05:40 -0700 (Mon, 12 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/view.c

Got the correct formula working. Code still not in place and doesn't do what it should, fixing that next.

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10292 | divverent | 2010-07-12 11:05:21 -0700 (Mon, 12 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/view.c

System to calculate the walking direction properly. The code is very dirty and not in the right place yet! Thanks parasti for the helpful suggestions.

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10291 | divverent | 2010-07-12 11:05:16 -0700 (Mon, 12 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/view.c

Remove this, not needed

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10290 | divverent | 2010-07-12 11:05:07 -0700 (Mon, 12 Jul 2010) | 5 lines
Changed paths:
   M /trunk/darkplaces/view.c

Attempt to implement sideway view bobbing as well, for better simulation of steps (a copy of the current view bobbing code with its own cvars, meant to bob to the side of the player).

This is not ready yet! The commit before this is stable. Still trying to figure out how to make the X and Y axes both work as the player's side.

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10289 | divverent | 2010-07-12 11:04:55 -0700 (Mon, 12 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/view.c

Suspend the effect when the jump button is pressed. Fixes the bunny-hopping twitches.

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10288 | divverent | 2010-07-12 11:04:36 -0700 (Mon, 12 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt
   M /trunk/darkplaces/view.c

Slightly better cycle default

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10287 | divverent | 2010-07-12 11:04:25 -0700 (Mon, 12 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt
   M /trunk/darkplaces/view.c

Disable by default

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10286 | divverent | 2010-07-12 11:04:14 -0700 (Mon, 12 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/view.c

Use += instead. You never know what else might change the view roll someday :)

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10285 | divverent | 2010-07-12 11:04:07 -0700 (Mon, 12 Jul 2010) | 5 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt
   M /trunk/darkplaces/view.c

Set better defaults and fix final comments. I think this should be ready for testing and merging if approved.

NOTE: If anyone wishes to see the effect better, set cl_bobroll to a higher value (eg. 0.01)

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10284 | divverent | 2010-07-12 11:03:54 -0700 (Mon, 12 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/view.c

Optimize cvars

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10283 | divverent | 2010-07-12 11:03:42 -0700 (Mon, 12 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/view.c

Cap speed to sv_maxspeed, so this looks right when bunny-hopping (makes more sense too)

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10282 | divverent | 2010-07-12 11:03:29 -0700 (Mon, 12 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/view.c

Unground smoothing. The roll slowly returns to normal when untouching the ground.

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10281 | divverent | 2010-07-12 11:03:12 -0700 (Mon, 12 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/view.c

cl_bobroll should only be a switch

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10280 | divverent | 2010-07-12 11:03:02 -0700 (Mon, 12 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/view.c

Fix centering, works exactly as intended now

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10279 | divverent | 2010-07-12 11:02:44 -0700 (Mon, 12 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/view.c

Use independent cycle float

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10278 | divverent | 2010-07-12 11:02:28 -0700 (Mon, 12 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/view.c

Half fix TODO 2 with a simple check. The view doesn't roll when not touching the ground, but needs to return to 0 smoothly rather than instantly when you jump / fall.

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10277 | divverent | 2010-07-12 11:02:20 -0700 (Mon, 12 Jul 2010) | 7 lines
Changed paths:
   M /trunk/darkplaces/view.c

Attempt to implement Q4engine style bob-rolling (the view discretely rolls to the sides as you walk). Things to do before it is ready:

TODO 1: Make it work around the center rather than the left side
TODO 2: Don't bob roll when not touching the ground
TODO 3: Write cvars in darkplaces.txt, set better defaults and possibly disable by default once the first TODOs are ready.

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10276 | divverent | 2010-07-09 10:21:51 -0700 (Fri, 09 Jul 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/model_shared.c

cleanup mempool use when generating a shadow mesh (one instance that used "loadmodel->mempool" that shouldn't)
------------------------------------------------------------------------
r10275 | divverent | 2010-07-07 13:16:53 -0700 (Wed, 07 Jul 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_draw.c

fix font loading bug causing E0xx glyphs to get zero size
------------------------------------------------------------------------
r10274 | havoc | 2010-07-05 01:30:22 -0700 (Mon, 05 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

remove the #define list at the start of the embedded default.glsl, it
was unintended (this list is prepended by r_glsl_dumpshader)

------------------------------------------------------------------------
r10273 | divverent | 2010-07-04 12:49:03 -0700 (Sun, 04 Jul 2010) | 14 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/dpdefs/csprogsdefs.qc
   M /trunk/darkplaces/dpdefs/menudefs.qc
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/keys.h
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.h
   M /trunk/darkplaces/svvm_cmds.c

finalize DP_CSQC_BINDMAPS:
functions:
	string(float key[, float bindmap]) getkeybind = #342;
	float(float key, string bind[, float bindmap]) setkeybind = #630;
	vector(void) getbindmaps = #631;
	float(vector bm) setbindmaps(vector bm) = #632;
	string findkeysforcommand(string command[, float bindmap]) = #610; /* DEPRECATED csqc: #521 */
	string keynumtostring(float keynum) = #340; /* menu: #609, DEPRECATED csqc: #520 */
	float stringtokeynum(string key) = #341; /* DEPRECATED menu: #614 */

The bindmap argument is OPTIONAL, and maybe should be declared as ... in the definitons.
The old alternative builtin numbers are hereby deprecated; they come from esteel's unofficial extension to csqc to provide findkeysforcommand with a different builtin number than the menuqc one, and from menuqc builtins that now are part of the "more official" csqc spec in other builtin number, apart from #609 in menuqc which was documented as part of menuqc before.

From: Rudolf Polzer <divverent@alientrap.org>
------------------------------------------------------------------------
r10272 | divverent | 2010-07-04 12:49:00 -0700 (Sun, 04 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

use a default bindmap of 0 in the PRVM commands, and the arg -1 means "current bindmap". Still need a QC way to get the current bindmap.

From: Rudolf Polzer <divverent@alientrap.org>
------------------------------------------------------------------------
r10271 | divverent | 2010-07-04 12:48:56 -0700 (Sun, 04 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/prvm_cmds.c

make -1 as bindmap argument also work, to mean "current bindmap" (same as leaving out). Helps when the user wants to avoid the varargs declaration.

From: Rudolf Polzer <divverent@alientrap.org>
------------------------------------------------------------------------
r10270 | divverent | 2010-07-04 12:48:53 -0700 (Sun, 04 Jul 2010) | 4 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/keys.h
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.c

- fix a bug in Quake menu when in_bindmap was not "0 0"
- key bind editing QC builtins: add an optional second argument of the bindmap number to query

From: Rudolf Polzer <divverent@alientrap.org>
------------------------------------------------------------------------
r10269 | divverent | 2010-07-04 12:44:08 -0700 (Sun, 04 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/pr_comp.h
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/prvm_exec.c
   M /trunk/darkplaces/prvm_execprogram.h

a simple time profiler for prvm_profile, cvar: prvm_timeprofiling

From: Rudolf Polzer <divverent@alientrap.org>
------------------------------------------------------------------------
r10268 | havoc | 2010-07-03 03:33:30 -0700 (Sat, 03 Jul 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

updated glsl and cg (now also directly compiled as hlsl) shaders - integrated the r_bloom_colorsubtract behavior into the shader rather than relying on fixed function blending in an extra pass, this should be a little faster...
------------------------------------------------------------------------
r10267 | havoc | 2010-07-03 03:27:16 -0700 (Sat, 03 Jul 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/builddate.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/darkplaces-wgl.vcproj
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_textures.h
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c

implemented Direct3D9 renderer (off by default), not very optimized but almost completely functional
------------------------------------------------------------------------
r10266 | havoc | 2010-07-02 02:00:08 -0700 (Fri, 02 Jul 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/darkplaces-dedicated.vcproj
   M /trunk/darkplaces/darkplaces-sdl.vcproj
   A /trunk/darkplaces/darkplaces-wgl.vcproj
   M /trunk/darkplaces/darkplaces.sln
   D /trunk/darkplaces/darkplaces.vcproj
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/sys_sdl.c

created new MSVC2008 project files and solution from scratch
fixed several warnings in MSVC2008
------------------------------------------------------------------------
r10265 | divverent | 2010-07-02 01:46:17 -0700 (Fri, 02 Jul 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_screen.c

fix minor typo in doc-string
------------------------------------------------------------------------
r10264 | havoc | 2010-07-01 19:44:03 -0700 (Thu, 01 Jul 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

fix a crash in particlefont.txt parser when given no texcoords

------------------------------------------------------------------------
r10263 | havoc | 2010-07-01 19:39:31 -0700 (Thu, 01 Jul 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_gecko.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/palette.c
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_lightning.c
   M /trunk/darkplaces/r_modules.c
   M /trunk/darkplaces/r_modules.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/sbar.c
   M /trunk/darkplaces/vid_sdl.c

add DeviceLost and DeviceRestored functions to R_Modules system
------------------------------------------------------------------------
r10262 | havoc | 2010-07-01 19:24:32 -0700 (Thu, 01 Jul 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/ft2.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/lhnet.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/svvm_cmds.c
   M /trunk/darkplaces/sys_shared.c
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c
   M /trunk/darkplaces/zone.c

fix a bunch of warnings if compiling darkplaces as C++ in MSVC2008
------------------------------------------------------------------------
r10261 | havoc | 2010-07-01 17:20:59 -0700 (Thu, 01 Jul 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

grow svbsp allocation limit much faster (*16 rather than *2) to speed up
rtlight compiling on large lights

------------------------------------------------------------------------
r10260 | divverent | 2010-07-01 11:37:16 -0700 (Thu, 01 Jul 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/screen.h

a third console picture layer. NOW we should be able to do about anything remotely sensible with console backgrounds.
------------------------------------------------------------------------
r10259 | divverent | 2010-07-01 11:37:11 -0700 (Thu, 01 Jul 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/sbar.c

new cvar r_draw2d to turn off all 2D drawing (except for console, r_speeds and showfps)
------------------------------------------------------------------------
r10258 | divverent | 2010-06-30 08:05:44 -0700 (Wed, 30 Jun 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.h

menuqc += +VM_getkeybind, // #342 string(float keynum) getkeybind (EXT_CSQC)
------------------------------------------------------------------------
r10257 | divverent | 2010-06-29 07:47:18 -0700 (Tue, 29 Jun 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_screen.c

fix a cvar name typo
------------------------------------------------------------------------
r10256 | divverent | 2010-06-29 07:46:47 -0700 (Tue, 29 Jun 2010) | 7 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/screen.h

new cvars:

scr_conalpha2factor (relative alpha for gfx/conback2)
scr_conscroll_x (like tcmod scroll on console background)
scr_conscroll_y
scr_conscroll2_x (like tcmod scroll on second console background)
scr_conscroll2_y
------------------------------------------------------------------------
r10255 | divverent | 2010-06-29 00:08:53 -0700 (Tue, 29 Jun 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

fix getsurfaceneartexture() returning no useful data
------------------------------------------------------------------------
r10254 | divverent | 2010-06-28 23:34:05 -0700 (Mon, 28 Jun 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/bih.c
   M /trunk/darkplaces/bih.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h

speed up decal creation in newdecalsystem by using BIH for finding the affected triangles
------------------------------------------------------------------------
r10253 | havoc | 2010-06-26 13:46:57 -0700 (Sat, 26 Jun 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

make sure dynamicvertex gets set by deformvertexes commands

------------------------------------------------------------------------
r10252 | havoc | 2010-06-25 07:05:05 -0700 (Fri, 25 Jun 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

fix a warning

------------------------------------------------------------------------
r10251 | havoc | 2010-06-25 07:03:32 -0700 (Fri, 25 Jun 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/bih.h
   M /trunk/darkplaces/model_brush.c

add surfaceindex to bih_leaf_t and initialize it

------------------------------------------------------------------------
r10250 | havoc | 2010-06-25 04:53:41 -0700 (Fri, 25 Jun 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/bih.c
   M /trunk/darkplaces/bih.h

added BIH_GetTriangleListForBox function

------------------------------------------------------------------------
r10249 | divverent | 2010-06-24 08:04:59 -0700 (Thu, 24 Jun 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_particles.c

allow immediate stains in the new particle system to be turned off
------------------------------------------------------------------------
r10248 | divverent | 2010-06-24 05:30:14 -0700 (Thu, 24 Jun 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

TEXF_CLAMP cubemap textures to fix seams (hack alert)
------------------------------------------------------------------------
r10247 | divverent | 2010-06-24 05:30:09 -0700 (Thu, 24 Jun 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

cameras: invert the correct coordinate to fix up texcoords
------------------------------------------------------------------------
r10246 | divverent | 2010-06-23 04:39:12 -0700 (Wed, 23 Jun 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/console.c

r_font_disable_freetype 0: don't replace the char by the cursor on console, but overdraw with a cursor image instead
------------------------------------------------------------------------
r10245 | divverent | 2010-06-23 04:39:08 -0700 (Wed, 23 Jun 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_input.c

fix a minor typo causing a slight misprediction
------------------------------------------------------------------------
r10244 | divverent | 2010-06-22 08:25:09 -0700 (Tue, 22 Jun 2010) | 1 line
Changed paths:
   D /trunk/darkplaces/.cvsignore
   A /trunk/darkplaces/.gitignore (from /trunk/darkplaces/.cvsignore:10243)

cvsignore no longer used for ages, but we can make it into a .gitignore file
------------------------------------------------------------------------
r10243 | divverent | 2010-06-21 04:22:07 -0700 (Mon, 21 Jun 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/r_textures.h

DDS picmip support (similar to JPEG one)
------------------------------------------------------------------------
r10242 | divverent | 2010-06-21 04:21:48 -0700 (Mon, 21 Jun 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_gecko.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/ft2.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/image.h
   M /trunk/darkplaces/image_png.c
   M /trunk/darkplaces/image_png.h
   M /trunk/darkplaces/jpeg.c
   M /trunk/darkplaces/jpeg.h
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/r_textures.h

jpeg: perform picmip levels 1, 2, 3 accelerated by telling libjpeg to decode at smaller resolution
------------------------------------------------------------------------
r10241 | divverent | 2010-06-20 10:01:19 -0700 (Sun, 20 Jun 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix a bug in userwavefuncs, they now work 100% fine in div0-stable branch (without DX vertex formats) and work fine here for animated models only
------------------------------------------------------------------------
r10240 | divverent | 2010-06-20 08:26:32 -0700 (Sun, 20 Jun 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/image.c

Catch bad pointers when loading corrupt TGAs
------------------------------------------------------------------------
r10239 | divverent | 2010-06-19 12:01:17 -0700 (Sat, 19 Jun 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/console.c

allow to freely place the chat panel when con_chatrect is 1 (squashed commit of fruitiex/newpanelhud branch without cl_blockinput stuff)

From: FruitieX <rasse@rasse-lappy.localdomain>
------------------------------------------------------------------------
r10238 | divverent | 2010-06-17 14:53:45 -0700 (Thu, 17 Jun 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

optimize away NOP wave functions in one more case
------------------------------------------------------------------------
r10237 | divverent | 2010-06-17 14:39:12 -0700 (Thu, 17 Jun 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/makefile.inc

support user install of SDL framework

From: Merlijn Hofstra <merlijnhofstra@mh.local>
------------------------------------------------------------------------
r10236 | divverent | 2010-06-17 14:39:09 -0700 (Thu, 17 Jun 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/render.h

user (csqc) controllable wavefuncs

From: Rudolf Polzer <divverent@alientrap.org>
------------------------------------------------------------------------
r10235 | divverent | 2010-06-15 02:55:17 -0700 (Tue, 15 Jun 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_sprite.c
   M /trunk/darkplaces/r_textures.h

new cvars:
gl_picmip_world, gl_picmip_sprites, gl_picmip_other: offsets relative to gl_picmip for different kinds of textures (i.e. world stuff renders at gl_picmip + gl_picmip_world)
r_picmipworld, r_picmipsprites are kind of obsolete with this, but stay supported (setting them to 0 is essentially equivalent to setting gl_picmip_foo to -9999)
------------------------------------------------------------------------
r10234 | divverent | 2010-06-13 11:26:25 -0700 (Sun, 13 Jun 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/image_png.c

it is libpng14.14.dylib on OSX

From: Merlijn Hofstra <merlijnhofstra@mh.local>
------------------------------------------------------------------------
r10233 | havoc | 2010-06-09 14:05:14 -0700 (Wed, 09 Jun 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

fix pqrcon rcon_password bug introduced in r9420 (was not
nul-terminating a string)

------------------------------------------------------------------------
r10232 | divverent | 2010-06-09 02:58:16 -0700 (Wed, 09 Jun 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/dpdefs/dpextensions.qc
   M /trunk/darkplaces/prvm_cmds.c

VM_sprintf(): make %i treat the input as QC integer, as opposed to float. %d of course continues to expect a QC float.
------------------------------------------------------------------------
r10231 | divverent | 2010-06-06 11:22:16 -0700 (Sun, 06 Jun 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/image_png.c

oops, should use 1.4.0 in the libpng14 version string to be sure
------------------------------------------------------------------------
r10230 | divverent | 2010-06-06 11:21:23 -0700 (Sun, 06 Jun 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/image_png.c

libpng14's .so name is libpng14.so.14, not .0 as usual
------------------------------------------------------------------------
r10229 | divverent | 2010-06-06 11:11:12 -0700 (Sun, 06 Jun 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/image_png.c

experimental libpng14 support
------------------------------------------------------------------------
r10228 | divverent | 2010-06-06 10:50:13 -0700 (Sun, 06 Jun 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/image_png.c

png: no longer use png_set_gray_1_2_4_to_8? (N/A in libpng14, and redundant anyway as png_set_expand does the same)
------------------------------------------------------------------------
r10227 | vortex | 2010-06-06 09:33:45 -0700 (Sun, 06 Jun 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/model_shared.c

support for q3map2's custinfoparms.txt in Mod_LoadQ3Shaders, so now you can create custom surfaceparms that works with BIH.
------------------------------------------------------------------------
r10226 | divverent | 2010-06-05 09:55:35 -0700 (Sat, 05 Jun 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

if a dotranslate_ variable exists, ALWAYS assume the opt-in way of translating
------------------------------------------------------------------------
r10225 | divverent | 2010-06-04 14:55:25 -0700 (Fri, 04 Jun 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c

sv_airspeedlimit_nonqw: a soft speedlimit for games using sv_airaccel_qw
------------------------------------------------------------------------
r10224 | eihrul | 2010-06-01 12:54:39 -0700 (Tue, 01 Jun 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

iqmbounds loading fix

------------------------------------------------------------------------
r10223 | eihrul | 2010-06-01 12:52:53 -0700 (Tue, 01 Jun 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

sanity checking of most header offsets/sizes in IQM

------------------------------------------------------------------------
r10222 | vortex | 2010-06-01 12:24:45 -0700 (Tue, 01 Jun 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_draw.c

fix defaultfont scale bug (which makes it invisible)
------------------------------------------------------------------------
r10221 | havoc | 2010-05-28 02:35:33 -0700 (Fri, 28 May 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/quakedef.h

raise MAX_STATICENTITIES for a new map goldenboy is making

------------------------------------------------------------------------
r10220 | divverent | 2010-05-27 13:13:30 -0700 (Thu, 27 May 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/zone.c

fix some sentinel related error messages
------------------------------------------------------------------------
r10219 | divverent | 2010-05-26 14:54:45 -0700 (Wed, 26 May 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/darkplaces.txt
   M /trunk/darkplaces/view.c

Merge remote branch 'origin/mirceakitsune/gunmodel_effects'
------------------------------------------------------------------------
r10218 | vortex | 2010-05-24 11:20:25 -0700 (Mon, 24 May 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/draw.h
   M /trunk/darkplaces/gl_draw.c

fix a bug with font scale/voffset not surviving r_restart by moving this settings to dp_font->settings. Added "scale" and "voffset" custom switches to loadfont console command.
------------------------------------------------------------------------
r10217 | divverent | 2010-05-24 00:43:45 -0700 (Mon, 24 May 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

Mod_Alias_GetTagIndexForName returns an 1-based index, not 0-based, so fix skel_find_bone for that
------------------------------------------------------------------------
r10216 | vortex | 2010-05-23 05:11:33 -0700 (Sun, 23 May 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_draw.c

try fix a warning
------------------------------------------------------------------------
r10215 | divverent | 2010-05-23 04:53:42 -0700 (Sun, 23 May 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_input.c

remove a superfluous and possibly harmful block in cl_input.qc
------------------------------------------------------------------------
r10214 | vortex | 2010-05-22 16:52:10 -0700 (Sat, 22 May 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/dpdefs/csprogsdefs.qc
   M /trunk/darkplaces/draw.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/prvm_cmds.c

DP_GFX_FONTS: add 2 additional parms to loadfont() - char scale and vertical offset, scale are identical to .width file "scale" parm (per-character center-oriented scale that doesn't change line height), vertical offset are added to each char during render, it's a multiplier to character height.
------------------------------------------------------------------------
r10213 | vortex | 2010-05-22 15:50:34 -0700 (Sat, 22 May 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/ft2.c
   M /trunk/darkplaces/gl_draw.c

bugfix recent font additions
------------------------------------------------------------------------
r10212 | vortex | 2010-05-22 15:22:17 -0700 (Sat, 22 May 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/dpdefs/csprogsdefs.qc
   M /trunk/darkplaces/dpdefs/dpextensions.qc

documented DP_GFX_FONTS/DP_GFX_FONTS_FREETYPE/DP_UTF8
------------------------------------------------------------------------
r10211 | vortex | 2010-05-22 15:18:08 -0700 (Sat, 22 May 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/draw.h
   M /trunk/darkplaces/ft2.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.h
   M /trunk/darkplaces/svvm_cmds.c

formed DP_GFX_FONTS/DP_GFX_FONTS_FREETYPE/DP_UTF8 extensions, add loadfont()/findfont() builtins. Font structure is now expandable (grows by 8), so new fonts could be added at no limits, just use new names for loadfont. When loading font, check for given file path before add extensions, this make "loadfont user1 myfont.ttf 10" work correctly.
------------------------------------------------------------------------
r10210 | divverent | 2010-05-22 11:41:10 -0700 (Sat, 22 May 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c

sv_airstrafeaccel_qw cvar for tuning CPMA-style physics
------------------------------------------------------------------------
r10209 | motorsep | 2010-05-22 08:18:44 -0700 (Sat, 22 May 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h

+Added Urre's game, "Strap-on-bomb Car"

------------------------------------------------------------------------
r10208 | divverent | 2010-05-21 14:12:08 -0700 (Fri, 21 May 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/model_alias.c

fix a wrong mempool use in Mod_Alias_AnimateVertices that crashed on dedicated server due to r_main_mempool not existing there
------------------------------------------------------------------------
r10207 | divverent | 2010-05-21 04:57:57 -0700 (Fri, 21 May 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix a typo in default deluxemap setup
------------------------------------------------------------------------
r10206 | divverent | 2010-05-20 22:41:38 -0700 (Thu, 20 May 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/view.c

Make another replacement

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10205 | divverent | 2010-05-20 22:41:27 -0700 (Thu, 20 May 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/view.c

Oops, forgot something

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10204 | divverent | 2010-05-20 22:41:25 -0700 (Thu, 20 May 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/view.c

Attempt to fix issues with spectating / demos

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10203 | divverent | 2010-05-18 23:23:22 -0700 (Tue, 18 May 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

fix warning
------------------------------------------------------------------------
r10202 | divverent | 2010-05-18 23:10:33 -0700 (Tue, 18 May 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/view.c

fix stairsmoothing annoyance through warpzones
------------------------------------------------------------------------
r10201 | vortex | 2010-05-18 12:06:45 -0700 (Tue, 18 May 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/gl_rsurf.c

remove some Blood Omnicide related hacks, fixed video stippling on ATI (always draw black pic behind)
------------------------------------------------------------------------
r10200 | divverent | 2010-05-18 11:46:29 -0700 (Tue, 18 May 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cvar.c
   M /trunk/darkplaces/cvar.h
   M /trunk/darkplaces/host_cmd.c

autocvars: update to current value after loading a savegame, to always fulfill the invariant "autocvar = cvar value"
------------------------------------------------------------------------
r10199 | divverent | 2010-05-18 03:03:09 -0700 (Tue, 18 May 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/jpeg.c

fix a double free problem in jpeg.c
------------------------------------------------------------------------
r10198 | divverent | 2010-05-18 02:54:35 -0700 (Tue, 18 May 2010) | 2 lines
Changed paths:
   A /trunk/darkplaces/dpdefs
   A /trunk/darkplaces/dpdefs/README.txt
   A /trunk/darkplaces/dpdefs/csprogsdefs.qc
   A /trunk/darkplaces/dpdefs/dpextensions.qc
   A /trunk/darkplaces/dpdefs/menudefs.qc
   A /trunk/darkplaces/dpdefs/progsdefs.qc

start of "dpdefs", QC files that define all current DP features

------------------------------------------------------------------------
r10197 | vortex | 2010-05-16 14:05:13 -0700 (Sun, 16 May 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

made cprogs.dat builtin #303 (setproperty) accept 1 parm, in this case it will return a value of property stored in engine struct instead of setting it. Pretty useful with several viewports code + 2d drawing. Curently the only property that can't be returned is VF_VIEWPORT (will give a warning) as it stored in 2 vectors (VF_MIN and VF_SIZE). To use new feature define 2 more builtins:
float(float property) getproperty = #303;
vector(float property) getpropertyvec = #303;
------------------------------------------------------------------------
r10196 | divverent | 2010-05-15 11:33:54 -0700 (Sat, 15 May 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/view.c

attempt at better defaults for gunmodel effects; try to make jumping look more natural

From: FruitieX <rasse@rasse-lappy.localdomain>
------------------------------------------------------------------------
r10195 | divverent | 2010-05-12 00:59:29 -0700 (Wed, 12 May 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/mathlib.h
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/svvm_cmds.c

DP_CSQC_BOXPARTICLES
allow particles to be tinted, and trails to be modded in their spacing by the particle count factor
------------------------------------------------------------------------
r10194 | havoc | 2010-05-11 14:40:35 -0700 (Tue, 11 May 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

really fix multiple effectinfo.txt file loading

------------------------------------------------------------------------
r10193 | havoc | 2010-05-11 14:06:21 -0700 (Tue, 11 May 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fix loading of q1bsp sky replacement textures to also check
textures/mapname/sky4 and such

------------------------------------------------------------------------
r10192 | divverent | 2010-05-11 08:51:15 -0700 (Tue, 11 May 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/sv_main.c

two more obvious bugs in worldnamenoextension
------------------------------------------------------------------------
r10191 | divverent | 2010-05-11 08:47:26 -0700 (Tue, 11 May 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_parse.c

properly strip the / from worldbasename
------------------------------------------------------------------------
r10190 | havoc | 2010-05-11 02:35:29 -0700 (Tue, 11 May 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

append maps/mapname_effectinfo.txt as intended

------------------------------------------------------------------------
r10189 | havoc | 2010-05-11 02:35:09 -0700 (Tue, 11 May 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

somehow I missed this edit in the other maps/ checks

------------------------------------------------------------------------
r10188 | divverent | 2010-05-11 02:11:48 -0700 (Tue, 11 May 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_particles.c

particles: apply rotation so that in the initial display frame of the particle, the start rotation min/max are shown
------------------------------------------------------------------------
r10187 | divverent | 2010-05-09 23:57:49 -0700 (Sun, 09 May 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/sv_main.c

anoth'error bites the dust
------------------------------------------------------------------------
r10186 | divverent | 2010-05-09 23:54:13 -0700 (Sun, 09 May 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_parse.c

fix compile error
------------------------------------------------------------------------
r10185 | havoc | 2010-05-09 23:29:56 -0700 (Sun, 09 May 2010) | 9 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/sbar.c
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c

fixed bug with effectinfo.txt loading so that it now loads the proper
name for the map
added cl.worldmessage, cl.worldname, cl.worldbasename,
cl.worldnamenoextension strings (and sv. versions) as well as cvars

audited all use of these variables in the engine for consistent behavior
basename generation for maps now strips only maps/ prefix (allowing
subdirectory paths to be preserved)

------------------------------------------------------------------------
r10184 | divverent | 2010-05-09 06:21:40 -0700 (Sun, 09 May 2010) | 4 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

stringbuffers: allow "" strings, keep disallowing NULL strings.

Now, bufstr_set'ing an item to string_null will yield string_null on bufstr_get,
and bufstr_set'ing an item to "" will yield "" on bufstr_get.
------------------------------------------------------------------------
r10183 | divverent | 2010-05-09 06:08:56 -0700 (Sun, 09 May 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

fix segfault on empty slots in a stringbuffer on buf_sort
------------------------------------------------------------------------
r10182 | divverent | 2010-05-09 03:52:43 -0700 (Sun, 09 May 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_screen.c

fix funny loading screen breakage with DX vertex formats
------------------------------------------------------------------------
r10181 | divverent | 2010-05-09 03:34:50 -0700 (Sun, 09 May 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/jpeg.c

add a missing include
------------------------------------------------------------------------
r10180 | divverent | 2010-05-09 03:28:26 -0700 (Sun, 09 May 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/fs.h
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/image.h
   M /trunk/darkplaces/image_png.c
   M /trunk/darkplaces/image_png.h
   M /trunk/darkplaces/render.h

screenshot: get rid of the 3*w*h+18 TGA buffer; instead however always capture as BGRA from the GPU;
also cvar: r_drawworld (when 0, turns off world drawing), and scr_screenshot_alpha (try to save alpha channel with screenshot).
Together, with this one can make nice alpha transparent screenshots of player models.
------------------------------------------------------------------------
r10179 | havoc | 2010-05-08 17:17:27 -0700 (Sat, 08 May 2010) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

changed R_Mesh_PrepareVertices_*_Unlock and _Lock functions to always
use the rsurface.preparevertices_ arrays, rather than having an
unnecessary renderpath check

------------------------------------------------------------------------
r10178 | havoc | 2010-05-08 17:16:01 -0700 (Sat, 08 May 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

use rsurface.modelelement3i variable instead of
model->surfmesh.data_element3i for consistency sake

------------------------------------------------------------------------
r10177 | havoc | 2010-05-08 17:13:51 -0700 (Sat, 08 May 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

fix a stencil shadowvolume bug with models that use dynamic batches

------------------------------------------------------------------------
r10176 | divverent | 2010-05-08 05:37:48 -0700 (Sat, 08 May 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_screen.h
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/jpeg.c

WritePicture: also support png input images :P
------------------------------------------------------------------------
r10175 | divverent | 2010-05-08 05:37:44 -0700 (Sat, 08 May 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/makefile.inc

makefile: we need to link to image loading libs in the dedicated server too
------------------------------------------------------------------------
r10173 | divverent | 2010-05-05 23:45:32 -0700 (Wed, 05 May 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cd_shared.c
   M /trunk/darkplaces/snd_3dras.c
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_mix.c
   M /trunk/darkplaces/snd_null.c
   M /trunk/darkplaces/sound.h

new cvar: mastervolume (controlling both volume and bgmvolume)
------------------------------------------------------------------------
r10172 | vortex | 2010-05-05 11:55:49 -0700 (Wed, 05 May 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/r_shadow.c

add r_editlights_lock command which will lock selection on current selected light (or unlock if already locked)
------------------------------------------------------------------------
r10171 | divverent | 2010-05-04 04:08:40 -0700 (Tue, 04 May 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_demo.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c

demo deleting: switch the meaning of the values 2 and 3 in cl_autodemo_delete, so & 1 would check if the CURRENT demo is to be deleted, and & 2 would check if any future demos are to be deleted
------------------------------------------------------------------------
r10170 | divverent | 2010-05-04 00:31:52 -0700 (Tue, 04 May 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/sv_main.c

properly declare the aircontrol power cvar
------------------------------------------------------------------------
r10169 | divverent | 2010-05-03 22:14:45 -0700 (Mon, 03 May 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/sv_main.c

fix the EndIncreaseEdicts handlers as edicts beyond num_edicts are not initialized yet
------------------------------------------------------------------------
r10168 | divverent | 2010-05-03 12:43:20 -0700 (Mon, 03 May 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c

sv_aircontrol_power - customizing the response curve of CPMA style air control
------------------------------------------------------------------------
r10167 | vortex | 2010-05-02 12:43:54 -0700 (Sun, 02 May 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/host_cmd.c

call m_hide() on loadgame/map/changelevel/restart if keydest is menu one (menu or menu_grabbed), since we are going to force it to key_game (which if not forcing to m_hide leads to menu drawn but not reacting to key events). 
------------------------------------------------------------------------
r10166 | havoc | 2010-05-02 11:17:14 -0700 (Sun, 02 May 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

don't generate vertex colors in q1bsp format for shader path

------------------------------------------------------------------------
r10165 | havoc | 2010-05-02 10:33:00 -0700 (Sun, 02 May 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/cmd.c

added -noconfig commandline option for benchmarking purposes

------------------------------------------------------------------------
r10164 | havoc | 2010-05-02 08:08:22 -0700 (Sun, 02 May 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix water/reflection/camera surface rendering

------------------------------------------------------------------------
r10163 | havoc | 2010-05-02 07:19:27 -0700 (Sun, 02 May 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix a crash on deformvertexes wave

------------------------------------------------------------------------
r10162 | divverent | 2010-05-02 07:11:12 -0700 (Sun, 02 May 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/view.c

for now, turn off gun lean and follow effects by default

From: Rudolf Polzer <divverent@alientrap.org>
------------------------------------------------------------------------
r10161 | divverent | 2010-05-02 07:10:40 -0700 (Sun, 02 May 2010) | 5 lines
Changed paths:
   M /trunk/darkplaces/view.c

Revert "gunangles[ROLL] = cl.viewangles[ROLL] rather than 0, because the view may roll sometimes.", as this contains the difference in roll angle, not the roll angle itself

This reverts commit 7ef836e6b9fb5a58e0c10978efbb83a5430b5905.

From: Rudolf Polzer <divverent@alientrap.org>
------------------------------------------------------------------------
r10160 | divverent | 2010-05-02 07:10:12 -0700 (Sun, 02 May 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/view.c

fix most of the guneffect issues with warpzones

From: Rudolf Polzer <divverent@alientrap.org>
------------------------------------------------------------------------
r10159 | divverent | 2010-05-02 07:09:57 -0700 (Sun, 02 May 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/view.c

gunangles[ROLL] = cl.viewangles[ROLL] rather than 0, because the view may roll sometimes.

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10158 | divverent | 2010-05-02 07:09:46 -0700 (Sun, 02 May 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt
   M /trunk/darkplaces/view.c

Use only one pair of toggle cvars.

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10157 | divverent | 2010-05-02 07:09:34 -0700 (Sun, 02 May 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/view.c

attempted fix for teleports

From: Rudolf Polzer <divverent@alientrap.org>
------------------------------------------------------------------------
r10156 | divverent | 2010-05-02 07:09:29 -0700 (Sun, 02 May 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt
   M /trunk/darkplaces/view.c

Better following limits for the new code. Added new cvars to darkplaces.txt

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10155 | divverent | 2010-05-02 07:09:17 -0700 (Sun, 02 May 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/view.c

hopefully fix issues with mouse motion (shivering) and warpzones

From: Rudolf Polzer <divverent@alientrap.org>
------------------------------------------------------------------------
r10154 | divverent | 2010-05-02 07:09:09 -0700 (Sun, 02 May 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt

Add the highpass cvars to darkplaces.txt

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10153 | divverent | 2010-05-02 07:09:01 -0700 (Sun, 02 May 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/view.c

simplify and clean up the gun model effects code a bit

From: Rudolf Polzer <divverent@alientrap.org>
------------------------------------------------------------------------
r10152 | divverent | 2010-05-02 07:08:57 -0700 (Sun, 02 May 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/view.c

Very minor renaming

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10151 | divverent | 2010-05-02 07:08:51 -0700 (Sun, 02 May 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt
   M /trunk/darkplaces/view.c

Use cl.realframetime properly again

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10150 | divverent | 2010-05-02 07:08:35 -0700 (Sun, 02 May 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/view.c

Actually, why not persist gunorg and gunangles and work with them directly, rather than using intermediary vectors and replacing with them?

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10149 | divverent | 2010-05-02 07:08:30 -0700 (Sun, 02 May 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/view.c

Minor optimizations

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10148 | divverent | 2010-05-02 07:08:23 -0700 (Sun, 02 May 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt
   M /trunk/darkplaces/view.c

Weapon following: Subtract player velocity from gun origin rather than making the gun follow the player. Reduces a huge code to a few lines and works much better. How could I not realize this until now? :P

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10147 | divverent | 2010-05-02 07:08:01 -0700 (Sun, 02 May 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt
   M /trunk/darkplaces/view.c

Use averaging for calculating the leaning speed. Most of the credits go to FruitieX for this code.

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10146 | divverent | 2010-05-02 07:07:45 -0700 (Sun, 02 May 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt
   M /trunk/darkplaces/view.c

Make leaning even faster (more discrete). Fix typos from previous commit.

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10145 | divverent | 2010-05-02 07:07:39 -0700 (Sun, 02 May 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt
   M /trunk/darkplaces/view.c

Tweak limits, to make this more like in Half-Life 2 :)

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10144 | divverent | 2010-05-02 07:07:30 -0700 (Sun, 02 May 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt
   M /trunk/darkplaces/view.c

Faster speeds and tighter limits by default

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10143 | divverent | 2010-05-02 07:07:13 -0700 (Sun, 02 May 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/view.c

Fix slowmo speed

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10142 | divverent | 2010-05-02 07:07:02 -0700 (Sun, 02 May 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/view.c

Minor comment arrangements

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10141 | divverent | 2010-05-02 07:06:49 -0700 (Sun, 02 May 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/view.c

try to fix the gun origin for view bobbing

From: Rudolf Polzer <divverent@alientrap.org>
------------------------------------------------------------------------
r10140 | divverent | 2010-05-02 07:06:38 -0700 (Sun, 02 May 2010) | 5 lines
Changed paths:
   M /trunk/darkplaces/view.c

Revert "More arrangements"

This reverts commit 06694fee2275d36160c2948be3fd1f224842d800.

From: Rudolf Polzer <divverent@alientrap.org>
------------------------------------------------------------------------
r10139 | divverent | 2010-05-02 07:06:22 -0700 (Sun, 02 May 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/view.c

More arrangements

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10138 | divverent | 2010-05-02 07:06:14 -0700 (Sun, 02 May 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/view.c

Fix some comments

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10137 | divverent | 2010-05-02 07:06:08 -0700 (Sun, 02 May 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/view.c

fix a typo in the last commit

From: Rudolf Polzer <divverent@alientrap.org>
------------------------------------------------------------------------
r10136 | divverent | 2010-05-02 07:06:02 -0700 (Sun, 02 May 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/view.c

move the new globals into the cl struct

From: Rudolf Polzer <divverent@alientrap.org>
------------------------------------------------------------------------
r10135 | divverent | 2010-05-02 07:05:53 -0700 (Sun, 02 May 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/view.c

some fixes to Taoki's code regarding axis-independence

From: Rudolf Polzer <divverent@alientrap.org>
------------------------------------------------------------------------
r10134 | divverent | 2010-05-02 07:05:43 -0700 (Sun, 02 May 2010) | 5 lines
Changed paths:
   M /trunk/darkplaces/view.c

Final checking and cleanup on my end. Imo this should be ready for testing.

I'm not very good with C and this is my first code for Darkplaces. Therefore my coding may not be that great, so if anyone with more experience could check and optimize this I would be grateful. Please message me on IRC for anything regarding this patch (Taoki).

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10133 | divverent | 2010-05-02 07:05:33 -0700 (Sun, 02 May 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt
   M /trunk/darkplaces/view.c

Cvars for part 2. Added safety checks and fixed gunmodel bobbing.

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10132 | divverent | 2010-05-02 07:05:27 -0700 (Sun, 02 May 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/view.c

Limits for part 2.

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10131 | divverent | 2010-05-02 07:05:16 -0700 (Sun, 02 May 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt
   M /trunk/darkplaces/view.c

Part 2 of the viewmodel effects. Gunmodel now "follows" the player, causing it to also push back when you're walking forward and get pulled when you're walking back. To be limited and cvared like the first part.

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10130 | divverent | 2010-05-02 07:04:58 -0700 (Sun, 02 May 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/view.c

Add cl.movevars_timescale into the mix so this works correctly with slowmo. Previous commit stays (if the leaning speed is too high, slowmo is too fast and framerate is too low, the effect is temporarily disabled).

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10129 | divverent | 2010-05-02 07:04:50 -0700 (Sun, 02 May 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/view.c

Disable when cl.realframetime * speed_cvar go over 1, otherwise angles go crazy and the gun spins at very low FPS. By default this only affects very low framerates, unless setting the speed to high values. Can't think of a better way to avoid the braking angles, but imo this is alright.

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10128 | divverent | 2010-05-02 07:04:40 -0700 (Sun, 02 May 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt
   M /trunk/darkplaces/view.c

Base animation on cl.frametime

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10127 | divverent | 2010-05-02 07:04:31 -0700 (Sun, 02 May 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt
   M /trunk/darkplaces/view.c

TODO 3 done. Cvared everything and added better defaults. Still not ready yet.

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10126 | divverent | 2010-05-02 07:04:22 -0700 (Sun, 02 May 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/view.c

TODO 2 done. View model rotation is now limited. Will do the cvars tomorrow.

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10125 | divverent | 2010-05-02 07:04:15 -0700 (Sun, 02 May 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/view.c

Remove reference comment

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10124 | divverent | 2010-05-02 07:03:49 -0700 (Sun, 02 May 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/view.c

TODO 1 done. Gun no longer spins when when passing the 0 <-> 360 border (I miss such obvious maths :P)

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10123 | divverent | 2010-05-02 07:03:31 -0700 (Sun, 02 May 2010) | 9 lines
Changed paths:
   M /trunk/darkplaces/view.c

Gun model leaning effect when looking around (eg. the faster you look up the more your weapon model lowers itself). Things that need to be done before this is ready:

TODO 1: Fix bug where model does a 360* turn when YAW jumps around the 0 - 360 rotation border.
TODO 2: Implement limits (weapon model must not lean past a certain limit)
TODO 3: Cvar everything once the first TODOs are ready.

Sister project (can be separate and done some other time): Push / pull the weapon model based on the direction you are running in.

From: MirceaKitsune <sonichedgehog_hyperblast00@yahoo.com>
------------------------------------------------------------------------
r10122 | divverent | 2010-05-02 05:34:15 -0700 (Sun, 02 May 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

use 1 + uservec2.x

From: Wolfgang (Blub) Bumiller <blub@speed.at>
------------------------------------------------------------------------
r10121 | divverent | 2010-05-02 05:34:12 -0700 (Sun, 02 May 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

this supposedly is faster on older cards (or with badly optimizing drivers)

From: Wolfgang (Blub) Bumiller <blub@speed.at>
------------------------------------------------------------------------
r10120 | divverent | 2010-05-02 05:34:08 -0700 (Sun, 02 May 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

removing the comments

From: Wolfgang (Blub) Bumiller <blub@speed.at>
------------------------------------------------------------------------
r10119 | divverent | 2010-05-02 05:34:05 -0700 (Sun, 02 May 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

using float for sobel value

From: Wolfgang (Blub) Bumiller <blub@speed.at>
------------------------------------------------------------------------
r10118 | divverent | 2010-05-02 05:34:01 -0700 (Sun, 02 May 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

get rid of a warning in the shader

From: Wolfgang (Blub) Bumiller <blub@speed.at>
------------------------------------------------------------------------
r10117 | divverent | 2010-05-02 05:33:58 -0700 (Sun, 02 May 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

uservec2.x is now the scene, .y the sobel strength, .z the threshold for sobel

From: Wolfgang (Blub) Bumiller <blub@speed.at>
------------------------------------------------------------------------
r10116 | divverent | 2010-05-02 05:33:54 -0700 (Sun, 02 May 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

uservec2 now combines the possibly-blurred scene and the sobel output

From: Wolfgang (Blub) Bumiller <blub@speed.at>
------------------------------------------------------------------------
r10115 | divverent | 2010-05-02 05:33:51 -0700 (Sun, 02 May 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

first draft of sobel operator, use r_glsl_postprocess_uservec1 with an x value > 100

From: Wolfgang (Blub) Bumiller <blub@speed.at>
------------------------------------------------------------------------
r10114 | divverent | 2010-05-02 05:32:18 -0700 (Sun, 02 May 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/cvar.c
   M /trunk/darkplaces/cvar.h

unset command

From: Blub <blub@donotreply>
------------------------------------------------------------------------
r10113 | divverent | 2010-05-02 05:22:31 -0700 (Sun, 02 May 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/svvm_cmds.c

DP_SV_DISCARDABLEDEMO
------------------------------------------------------------------------
r10112 | divverent | 2010-05-02 05:16:28 -0700 (Sun, 02 May 2010) | 8 lines
Changed paths:
   M /trunk/darkplaces/cl_demo.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/fs.h
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/sv_demo.c
   M /trunk/darkplaces/sv_main.c

Add QC/cfg facilities to control deletion of automatically recorded demos

This patch adds two new cvars, cl_autodemo_delete and
sv_autodemo_perclient_discardable, as well as an entity field for use
by game code, .float discardabledemo.  See the cvar descriptions for
more details.

From: Jānis Rūcis <parasti@gmail.com>
------------------------------------------------------------------------
r10111 | divverent | 2010-05-01 10:22:09 -0700 (Sat, 01 May 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/darkplaces-dedicated.dev

same modification to the darkplaces-dedicated project
------------------------------------------------------------------------
r10110 | divverent | 2010-05-01 10:10:00 -0700 (Sat, 01 May 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/darkplaces.dev

updated darkplaces.dev project (new files added)
------------------------------------------------------------------------
r10109 | havoc | 2010-05-01 09:48:33 -0700 (Sat, 01 May 2010) | 7 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/mathlib.h
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_shared.c

overhauled vertex formats, now supports 100% interleaved arrays
rendering mode, reworked vertexbuffer management to be a more robust
system, added fully vertex buffered rendering options
(gl_vbo_dynamicvertex, gl_vbo_dynamicindex) which are off by default
(they seem to hurt fps in tests here)
centralized handling of "generic" mesh rendering (fixed function stuff)

------------------------------------------------------------------------
r10108 | divverent | 2010-05-01 05:21:29 -0700 (Sat, 01 May 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_particles.c

fix stain alpha
------------------------------------------------------------------------
r10107 | vortex | 2010-04-28 13:19:55 -0700 (Wed, 28 Apr 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/cl_video.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/screen.h

Two more options for videos - vertical align (if video is scaled) and stipple effect (static one, no annoying scrolling), it looks nice with some low res videos. Do not render 3D view when video is played.
------------------------------------------------------------------------
r10106 | vortex | 2010-04-26 15:33:36 -0700 (Mon, 26 Apr 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_screen.c

a bit of loading screen bar customization: new cvars scr_loadingscreen_barcolor, scr_loadingscreen_barheight
------------------------------------------------------------------------
r10105 | vortex | 2010-04-26 12:29:19 -0700 (Mon, 26 Apr 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_video.c

fix a warning
------------------------------------------------------------------------
r10104 | divverent | 2010-04-25 11:24:54 -0700 (Sun, 25 Apr 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/makefile

in MSYS, the WINDIR env variable is uppercase, so let's change the check to that. In case anyone complains, I'll add the lowercase version too again.
------------------------------------------------------------------------
r10103 | divverent | 2010-04-24 13:42:51 -0700 (Sat, 24 Apr 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/libcurl.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_user.c
   M /trunk/darkplaces/zone.c

mode "developer -1" that behaves like old "developer 0" (also suppresses logging and buffering the messages)
------------------------------------------------------------------------
r10102 | vortex | 2010-04-24 11:30:51 -0700 (Sat, 24 Apr 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_video.c

fix another bug in subtitles parsing (badly parsed negative length)
------------------------------------------------------------------------
r10101 | vortex | 2010-04-24 09:45:22 -0700 (Sat, 24 Apr 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_video.c

subtitles: fix a bug with last subtitle now showing sometimes
------------------------------------------------------------------------
r10099 | vortex | 2010-04-24 08:22:01 -0700 (Sat, 24 Apr 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/cl_video.h
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.h
   M /trunk/darkplaces/svvm_cmds.c

simple video subtitles support, defined in external text files, added a couple of cvars controlling subtitles (cl_video_*). Added video scaling (video will not be drawn fullscreen but less size and centered) and brightness cvar. Added videoplaying() builtin for menuvm and csqc. Changed isdemo() function to be shared between menuvm and csqc (since it is same). Subtitles uses NOTIFY font.
------------------------------------------------------------------------
r10098 | havoc | 2010-04-24 01:36:45 -0700 (Sat, 24 Apr 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.vcproj

fix VorteX's modification of darkplaces.vcproj that made it build
../omnicide.exe instead of darkplaces.exe as it is supposed to

------------------------------------------------------------------------
r10097 | eihrul | 2010-04-21 01:01:20 -0700 (Wed, 21 Apr 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

fix IQM format to use relative base pose

------------------------------------------------------------------------
r10096 | havoc | 2010-04-17 23:35:20 -0700 (Sat, 17 Apr 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

allow saving multiplayer games from the menu, rather than refusing

------------------------------------------------------------------------
r10095 | divverent | 2010-04-17 12:08:46 -0700 (Sat, 17 Apr 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/darkplaces.txt

fix CRLF on darkplaces.txt
------------------------------------------------------------------------
r10094 | divverent | 2010-04-17 12:08:20 -0700 (Sat, 17 Apr 2010) | 1 line
Changed paths:
   A /trunk/darkplaces/.gitattributes

add a .gitattributes file to define CRLF rules
------------------------------------------------------------------------
r10092 | havoc | 2010-04-16 14:42:15 -0700 (Fri, 16 Apr 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/svvm_cmds.c

fix serious bug in DP_SV_CLIENTCAMERA that made it break in multiplayer
added DP_SV_CLIENTCAMERA extension name

------------------------------------------------------------------------
r10091 | divverent | 2010-04-16 01:18:27 -0700 (Fri, 16 Apr 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

uri_escape: remove * from the set of allowed chars. It now can be used to escape file names for use by Windows. Note that you still need to add a prefix, as Windows does not like file names starting with a dot.
------------------------------------------------------------------------
r10090 | eihrul | 2010-04-15 14:46:01 -0700 (Thu, 15 Apr 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_iqm.h

unused IQM scaling

------------------------------------------------------------------------
r10089 | vortex | 2010-04-15 04:13:22 -0700 (Thu, 15 Apr 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_null.c
   M /trunk/darkplaces/sound.h

S_GetEntChallelPosition -> S_GetEntChannelPosition
------------------------------------------------------------------------
r10088 | vortex | 2010-04-15 03:53:00 -0700 (Thu, 15 Apr 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/snd_null.c

add stubs for S_SoundLength, S_GetEntChallelPosition, dedicated server should compile now
------------------------------------------------------------------------
r10087 | divverent | 2010-04-15 03:09:45 -0700 (Thu, 15 Apr 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/keys.h

block key events while in the event handler called from loading screens - might fix crashes in some cases
------------------------------------------------------------------------
r10084 | vortex | 2010-04-14 11:45:19 -0700 (Wed, 14 Apr 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

getsoundtime: cant query CHAN_AUTO, so print warning
------------------------------------------------------------------------
r10082 | vortex | 2010-04-14 11:40:16 -0700 (Wed, 14 Apr 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/darkplaces.vcproj
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.h
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/sound.h
   M /trunk/darkplaces/svvm_cmds.c

DP_SND_GETSOUNDTIME extension (query sound progress on entities and length of sound files)
------------------------------------------------------------------------
r10080 | vortex | 2010-04-14 08:04:28 -0700 (Wed, 14 Apr 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/svvm_cmds.c

DP_CSQC_SETPAUSE (clientside pause that only works in local games, similar to pause set when console is active or main menu is popped up), does not stop sounds
------------------------------------------------------------------------
r10077 | vortex | 2010-04-12 09:39:17 -0700 (Mon, 12 Apr 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

beta version of DP_CSQC_QUERYRENDERENTITY, explanation here: http://ftp.razorwind.ru/DP_CSQC_QUERYRENDERENTITY.txt

------------------------------------------------------------------------
r10076 | eihrul | 2010-04-12 00:38:54 -0700 (Mon, 12 Apr 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

IQM loading animation frames fix

------------------------------------------------------------------------
r10075 | havoc | 2010-04-11 13:52:35 -0700 (Sun, 11 Apr 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/prvm_edict.c

fix some warnings

------------------------------------------------------------------------
r10074 | havoc | 2010-04-09 11:59:41 -0700 (Fri, 09 Apr 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/lhnet.c

patch from Ozkan Sezer for compatibility with mingw64 (changed #include
order)

------------------------------------------------------------------------
r10073 | divverent | 2010-04-07 23:39:33 -0700 (Wed, 07 Apr 2010) | 14 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt

Put the Thanks block in the readme at the end, where it belonged. My bad for adding something after it some months (or years?) ago.

This commit has sharp edges. Also,

diff -u a/r10072.txt b/r10072.txt
--- a/r10072.txt	2010-04-08 08:35:55.619618796 +0200
+++ b/r10072.txt	2010-04-08 08:37:38.417107779 +0200
@@ -1,5 +1,5 @@
 Fix a premature optimization in Mod_CollisionBIH_TraceLine, which broke tZork's test case.

-As Bjarne Stroustrup said, "Premature optimization is the root of all evil."
+As Donald Ervin Knuth said, "Premature optimization is the root of all evil."

 BIH collision might actually WORK now.
------------------------------------------------------------------------
r10072 | divverent | 2010-04-07 23:19:54 -0700 (Wed, 07 Apr 2010) | 5 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

Fix a premature optimization in Mod_CollisionBIH_TraceLine, which broke tZork's test case.

As Bjarne Stroustrup said, "Premature optimization is the root of all evil."

BIH collision might actually WORK now.
------------------------------------------------------------------------
r10071 | eihrul | 2010-04-07 16:44:10 -0700 (Wed, 07 Apr 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

make IQM loading import animation sequences rather than individual frames (thus not requiring framegroups anymore)

------------------------------------------------------------------------
r10070 | vortex | 2010-04-07 12:16:19 -0700 (Wed, 07 Apr 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cd_shared.c

additional <start_position> parm to "cd play" and "cd loop", could be useful with DP_QC_GETTIME_CDTRACK
------------------------------------------------------------------------
r10069 | divverent | 2010-04-05 06:47:58 -0700 (Mon, 05 Apr 2010) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c

1. network sv_gameplayfix_gravityunaffectedbyticrate to the client, and predict properly
2. new cvar sv_gameplayfix_nogravityonground (also supported by cl_movement)

When that cvar is activated, walking on downward slopes is a little bumpy.
------------------------------------------------------------------------
r10068 | havoc | 2010-04-04 16:28:13 -0700 (Sun, 04 Apr 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

use multiple prints for ProQuake compatibility in status commands
(default layout only)

------------------------------------------------------------------------
r10067 | havoc | 2010-04-04 16:20:56 -0700 (Sun, 04 Apr 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

use 3 spaces before IP address in status output, not 2, must be proquake
compatible

------------------------------------------------------------------------
r10066 | havoc | 2010-04-04 16:14:40 -0700 (Sun, 04 Apr 2010) | 5 lines
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

change representation of string offsets for allocated strings and engine
buffers to use 0x4000000 as base offset instead of using negative
values, to reduce possibility of && and || operators (which do float
compares to 0 in the vm) breaking on string variables

------------------------------------------------------------------------
r10065 | havoc | 2010-04-03 18:52:46 -0700 (Sat, 03 Apr 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/mvm_cmds.c

looks like there was a missing return in VM_M_getserverliststat

------------------------------------------------------------------------
r10064 | havoc | 2010-04-03 15:40:43 -0700 (Sat, 03 Apr 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

disable sv_gameplayfix_consistentplayerprethink by default because it
breaks id1 multiplayer (important!)

------------------------------------------------------------------------
r10063 | divverent | 2010-03-29 08:27:13 -0700 (Mon, 29 Mar 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/fs.c

APPEND forced args, not PREPEND, as earlier arguments win in most DP options.
------------------------------------------------------------------------
r10062 | divverent | 2010-03-29 00:43:07 -0700 (Mon, 29 Mar 2010) | 4 lines
Changed paths:
   M /trunk/darkplaces/common.c

custom branding:
like:
	-nexuiz -customgamename Offendix -customgamedirname1 offendix -customgamedirname2 "" -customgamescreenshotname offendix -customgameuserdirname offendix
in an attached-to-the-executable darkplaces.opt
------------------------------------------------------------------------
r10061 | divverent | 2010-03-27 06:08:42 -0700 (Sat, 27 Mar 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/snd_sdl.c

fix 6ch channel layout in SDL on Linux (it no longer uses SND_CHANNELLAYOUT_ALSA)
------------------------------------------------------------------------
r10060 | divverent | 2010-03-26 04:42:05 -0700 (Fri, 26 Mar 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

new %v conversion in sprintf (uses %g conversions to build a vector)
------------------------------------------------------------------------
r10059 | divverent | 2010-03-26 04:42:01 -0700 (Fri, 26 Mar 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

use the safer %.9g format for storing floats e.g. in savegame or prvm_edict command (which is read back in properly)
------------------------------------------------------------------------
r10058 | divverent | 2010-03-26 04:41:58 -0700 (Fri, 26 Mar 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/host.c

host_maxwait cvar to possibly work around timing trouble regarding broken nanosleep etc
------------------------------------------------------------------------
r10057 | divverent | 2010-03-18 12:20:33 -0700 (Thu, 18 Mar 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/model_shared.c

make model decompiling more robus regarding anim names (if name is pain1_4, treat this as pain1 frame 4, not pain frame 1_4)
------------------------------------------------------------------------
r10056 | havoc | 2010-03-17 20:45:40 -0700 (Wed, 17 Mar 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

make q3 shader settings work on dedicated servers (dpmeshcollisions for
example)

------------------------------------------------------------------------
r10055 | divverent | 2010-03-14 12:20:30 -0700 (Sun, 14 Mar 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/libcurl.c
   M /trunk/darkplaces/libcurl.h
   M /trunk/darkplaces/prvm_cmds.c

sv_curl_maxspeed: maximum speed for the curl downloads recommended by this server (incompatible with clients not having this commit, so do not use yet)
------------------------------------------------------------------------
r10054 | divverent | 2010-03-14 11:08:39 -0700 (Sun, 14 Mar 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/console.c

fix how plural of alias works
wrong: sg. aliases, pl. aliasess
right: sg. alias, pl. aliases
------------------------------------------------------------------------
r10053 | divverent | 2010-03-13 10:27:09 -0800 (Sat, 13 Mar 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_iqm.h
   M /trunk/darkplaces/model_shared.c

modeldecompile: also write a framegroups file if possible
------------------------------------------------------------------------
r10052 | eihrul | 2010-03-13 10:08:41 -0800 (Sat, 13 Mar 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_iqm.h

made IQM framerate a float

------------------------------------------------------------------------
r10051 | divverent | 2010-03-13 08:31:58 -0800 (Sat, 13 Mar 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_screen.c

randomized loadingscreen pic (cvar: scr_loadingscreen_count, when 2 or above, randomized gfx/loading{,2-n} pic is used, not recommended for general use as it costs GPU memory)
------------------------------------------------------------------------
r10050 | eihrul | 2010-03-08 18:58:06 -0800 (Mon, 08 Mar 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fixes for entity caching when r_shadows == 1

------------------------------------------------------------------------
r10049 | eihrul | 2010-03-08 18:51:39 -0800 (Mon, 08 Mar 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c

use stencil shadows if r_shadows == 1

------------------------------------------------------------------------
r10048 | havoc | 2010-03-08 18:17:08 -0800 (Mon, 08 Mar 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

okay, don't use shadow sampler in Cg

------------------------------------------------------------------------
r10047 | eihrul | 2010-03-08 18:03:47 -0800 (Mon, 08 Mar 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c

fixed bug in vsdct in cg

------------------------------------------------------------------------
r10046 | havoc | 2010-03-08 17:59:20 -0800 (Mon, 08 Mar 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

change texcoord assignments in Cg shader back to the way it was, because
there was a conflict on TEXCOORD5 in one situation

------------------------------------------------------------------------
r10045 | eihrul | 2010-03-08 17:44:20 -0800 (Mon, 08 Mar 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fixed ShadowMap_Parameters usage in GetShadowMapTCCube in builtincgshaderstring

------------------------------------------------------------------------
r10044 | havoc | 2010-03-08 17:33:41 -0800 (Mon, 08 Mar 2010) | 6 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/mathlib.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/render.h

implemented a new type of height fog using a texture to describe
multiple fog layers, some visual issues due to the method used.
new command and worldspawn property - identical extra for a new
texturename parameter at the end
fixed some issues with shadowmapping in Cg shaders

------------------------------------------------------------------------
r10043 | eihrul | 2010-03-08 00:50:03 -0800 (Mon, 08 Mar 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_iqm.h

IQM base pose cleanups

------------------------------------------------------------------------
r10042 | eihrul | 2010-03-07 21:16:27 -0800 (Sun, 07 Mar 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

more IQM loading fixes

------------------------------------------------------------------------
r10041 | eihrul | 2010-03-07 19:08:08 -0800 (Sun, 07 Mar 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

misc IQM loading fixes

------------------------------------------------------------------------
r10040 | eihrul | 2010-03-07 18:30:20 -0800 (Sun, 07 Mar 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_iqm.h

added per frame bounds to IQM format

------------------------------------------------------------------------
r10039 | eihrul | 2010-03-07 13:50:15 -0800 (Sun, 07 Mar 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

build IQM inverse base pose from joints if necessary

------------------------------------------------------------------------
r10038 | eihrul | 2010-03-07 13:13:06 -0800 (Sun, 07 Mar 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_alias.h
   A /trunk/darkplaces/model_iqm.h
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h

experimental IQM model format support

------------------------------------------------------------------------
r10037 | divverent | 2010-03-06 07:37:45 -0800 (Sat, 06 Mar 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_input.c

properly support huge sideways friction
------------------------------------------------------------------------
r10036 | eihrul | 2010-02-28 12:52:44 -0800 (Sun, 28 Feb 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

cast Mem_Allocs in FS_Init_SelfPack

------------------------------------------------------------------------
r10035 | divverent | 2010-02-28 11:35:36 -0800 (Sun, 28 Feb 2010) | 15 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/csprogs.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c

WarpZones:
- entities with a camera_transform function field
  arguments: vector origin, vector angles
  global input: v_forward, v_right, v_up = camera orientation
  return value: new origin
  global output: v_forward, v_right, v_up = new camera orientation
  global output: trace_endpos = origin on "remote side" for culling purposes
- on server, only the trace_endpos return value is used, and '0 0 0' angles are passed, and only the trace_endpos is used (this may be subject to change)
- a warpzone is an above described entity that contains a surface of a shader that uses the keywords dp_camera AND dp_refract
- a camera is an above described entity that contains a surface of a shader that JUST uses the keyword dp_camera
- in case of a camera, preferably the camera_transform function shall not use the input values (except for use for certain special effects)
- rendering of these warpzones is not recursive (yet)
- the warpzones do not have any impact on gameplay - QC support code is needed both on client and server
- example support code will be committed to Nexuiz SVN
- the interface is not stable yet and may be subject to change
------------------------------------------------------------------------
r10034 | divverent | 2010-02-28 11:10:37 -0800 (Sun, 28 Feb 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/fs.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/sys.h
   M /trunk/darkplaces/sys_linux.c
   M /trunk/darkplaces/sys_sdl.c
   M /trunk/darkplaces/sys_shared.c
   M /trunk/darkplaces/sys_win.c

Detect appended data to the DP executable.
If it's a pk3, it is added FIRST (TODO: should this be LAST) into the search path.
If it contains a darkplaces.opt text file, its contents are parsed and used as extra command line arguments.
------------------------------------------------------------------------
r10033 | eihrul | 2010-02-27 15:30:08 -0800 (Sat, 27 Feb 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

GetShadowMapTCCube fixes

------------------------------------------------------------------------
r10032 | havoc | 2010-02-27 13:12:40 -0800 (Sat, 27 Feb 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

fix a bug that prevented coronas from being rendered for lights with no
diffuse or specular intensity

------------------------------------------------------------------------
r10031 | havoc | 2010-02-27 13:11:04 -0800 (Sat, 27 Feb 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix bug that prevented reflection cubemaps from working with Cg shaders

------------------------------------------------------------------------
r10030 | havoc | 2010-02-27 13:10:42 -0800 (Sat, 27 Feb 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

don't apply motionblur when rendering to an envmap

------------------------------------------------------------------------
r10029 | havoc | 2010-02-27 13:10:14 -0800 (Sat, 27 Feb 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

use a larger triangle buffer for r_batchmode 2

------------------------------------------------------------------------
r10028 | havoc | 2010-02-27 13:08:14 -0800 (Sat, 27 Feb 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

minor cleanup to R_DrawSurface_TransparentCallback

------------------------------------------------------------------------
r10027 | havoc | 2010-02-27 10:31:15 -0800 (Sat, 27 Feb 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_win.c

changed r_speeds labels again, less csqc monitoring and more consistent
label order from frame to frame

------------------------------------------------------------------------
r10026 | divverent | 2010-02-27 10:11:31 -0800 (Sat, 27 Feb 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/sys_shared.c

make some cvars static, to help the compiler a bit
------------------------------------------------------------------------
r10025 | havoc | 2010-02-27 10:09:54 -0800 (Sat, 27 Feb 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/sbar.c

added cl_prydoncursor_notrace cvar
added support for cl_prydoncursor < 0 as no visible cursor

------------------------------------------------------------------------
r10024 | divverent | 2010-02-27 10:08:26 -0800 (Sat, 27 Feb 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/darkplaces-sdl.dev
   M /trunk/darkplaces/darkplaces-sdl.dsp
   M /trunk/darkplaces/darkplaces-sdl.vcproj

try to fix all project files (to add winmm)
------------------------------------------------------------------------
r10023 | divverent | 2010-02-27 10:02:50 -0800 (Sat, 27 Feb 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/sys_shared.c

shut up a (in this case wrong) warning about possibly uninitialized variable
------------------------------------------------------------------------
r10022 | divverent | 2010-02-27 10:01:33 -0800 (Sat, 27 Feb 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/makefile.inc

add -lwinmm to win32 sdl
------------------------------------------------------------------------
r10021 | divverent | 2010-02-27 08:39:44 -0800 (Sat, 27 Feb 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/sys_shared.c

yet another include fix, this time for MSVC
------------------------------------------------------------------------
r10020 | divverent | 2010-02-27 07:12:13 -0800 (Sat, 27 Feb 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/sys_shared.c

another include
------------------------------------------------------------------------
r10019 | divverent | 2010-02-27 07:09:43 -0800 (Sat, 27 Feb 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/sys_shared.c

attempt to fix the includes for win32
------------------------------------------------------------------------
r10018 | divverent | 2010-02-27 07:07:21 -0800 (Sat, 27 Feb 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/sys_win.c

fix another win32 time typo
------------------------------------------------------------------------
r10017 | divverent | 2010-02-27 07:04:07 -0800 (Sat, 27 Feb 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/sys_shared.c

fix two remaining uses of sys_usetimegettime
------------------------------------------------------------------------
r10016 | eihrul | 2010-02-26 18:04:38 -0800 (Fri, 26 Feb 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

added 6x6 pcf option for people with too much framerate

------------------------------------------------------------------------
r10015 | divverent | 2010-02-26 12:32:24 -0800 (Fri, 26 Feb 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

fix strstrofs with unicode
------------------------------------------------------------------------
r10014 | divverent | 2010-02-26 07:44:03 -0800 (Fri, 26 Feb 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/sys_shared.c

also: sys_usesdldelay for using SDL_Delay() for sleeping instead of something better system provided
------------------------------------------------------------------------
r10013 | divverent | 2010-02-26 07:43:58 -0800 (Fri, 26 Feb 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/sys.h
   M /trunk/darkplaces/sys_linux.c
   M /trunk/darkplaces/sys_sdl.c
   M /trunk/darkplaces/sys_shared.c
   M /trunk/darkplaces/sys_win.c

refactor timing, so that timing code is in sys_shared.c.
Changes in behaviour: Win32 now prefers select() (PLEASE TEST), SDL timers can be overridden by sys_usequeryperformancecounter or sys_useclockgettime, new cvar sys_debugtime
------------------------------------------------------------------------
r10012 | divverent | 2010-02-26 07:43:54 -0800 (Fri, 26 Feb 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/sys_sdl.c

Revert "added linux timing code to SDL client for more accurate r_speeds reports"

This reverts commit ef4adee42c844523c889cbc6c19d2da940f00ec6.
------------------------------------------------------------------------
r10011 | havoc | 2010-02-26 05:58:35 -0800 (Fri, 26 Feb 2010) | 5 lines
Changed paths:
   M /trunk/darkplaces/sys_sdl.c

added linux timing code to SDL client for more accurate r_speeds reports
(sys_usetimegettime and sys_useclockgettime apply, set both to 0 to use
SDL_GetTicks instead)
added support for sys_usenoclockbutbenchmark in SDL client

------------------------------------------------------------------------
r10010 | havoc | 2010-02-26 04:30:07 -0800 (Fri, 26 Feb 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/collision.c

don't bother calling Collision_ValidateBrush when creating box brushes

------------------------------------------------------------------------
r10009 | havoc | 2010-02-26 04:03:37 -0800 (Fri, 26 Feb 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/collision.c

undo an edit in r9537 that caused it to be possible to walk through a
narrow gap in toxic in Nexuiz near the rocket launcher

------------------------------------------------------------------------
r10008 | havoc | 2010-02-25 15:10:15 -0800 (Thu, 25 Feb 2010) | 4 lines
Changed paths:
   M /trunk/darkplaces/collision.c

added collision_debug_tracelineasbox cvar to work around problems with
traceline on q3bsp, disabled by default due to performance being worse
but should aid in debugging the traceline problems

------------------------------------------------------------------------
r10007 | eihrul | 2010-02-25 10:47:26 -0800 (Thu, 25 Feb 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

magical instruction sequence that works on both GL_ARB_texture_gather and GL_AMD_texture_texture4

------------------------------------------------------------------------
r10006 | havoc | 2010-02-25 08:16:46 -0800 (Thu, 25 Feb 2010) | 6 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h

added dpmeshcollisions keyword in shader parsing, this causes all
rendering triangles of the affected surfaces to be added to the BIH
system, so that q3map2's misc_model collision flag can be turned off,
greatly reducing bsp size and memory usage, as well as possibly
improving collisions (no need to reconstruct points from planes)

------------------------------------------------------------------------
r10005 | havoc | 2010-02-25 08:14:13 -0800 (Thu, 25 Feb 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

make sure r_glsl_permutation and r_cg_permutation variables are NULL
when renderer is started or shuts down

------------------------------------------------------------------------
r10004 | eihrul | 2010-02-25 08:12:37 -0800 (Thu, 25 Feb 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

attempting workaround for coord rounding incompatibilities between GL_ARB_texture_gather (nvidia) and GL_AMD_texture_texture4 (ati)

------------------------------------------------------------------------
r10003 | havoc | 2010-02-25 08:11:50 -0800 (Thu, 25 Feb 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

fix crash when MAX_DLIGHTS is hit and a trail effect tries to add a
dlight

------------------------------------------------------------------------
r10002 | havoc | 2010-02-25 08:11:13 -0800 (Thu, 25 Feb 2010) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clvm_cmds.c

particle geometry can now be rotated for more variety, and can spin too
added rotate command in effectinfo.txt which specifies min/max starting
angle and min/max rotation speed (spin)

------------------------------------------------------------------------
r10001 | havoc | 2010-02-25 08:09:49 -0800 (Thu, 25 Feb 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

don't bother checking if bsp file has been modified on a level change if
developer is 0

------------------------------------------------------------------------
r10000 | havoc | 2010-02-25 08:01:54 -0800 (Thu, 25 Feb 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/quakedef.h

use CONFIGFILENAME and STARTCONFIGFILENAME macros instead of config.cfg
and quake.rc

------------------------------------------------------------------------
r9999 | havoc | 2010-02-25 07:58:10 -0800 (Thu, 25 Feb 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

added cl_particles_collisions cvar to allow collisions to be turned off
for performance testing

------------------------------------------------------------------------
r9998 | havoc | 2010-02-25 07:55:47 -0800 (Thu, 25 Feb 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/netconn.c

add several more R_TimeReport calls for better analysis of csqc time

------------------------------------------------------------------------
r9997 | havoc | 2010-02-25 07:50:24 -0800 (Thu, 25 Feb 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

don't bother calling Mod_ForName in client precache parsing if server
already loaded them in a local game

------------------------------------------------------------------------
r9996 | havoc | 2010-02-24 23:32:04 -0800 (Wed, 24 Feb 2010) | 7 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

changes to rtlight surface culling:
SVBSP culling mode now also checks PVS (not sure why this helps)
no longer rejects backfaces in light culling (fixes several glitches in
start.bsp and elsewhere - not sure why the light would be considered
behind these triangles though)
optimized svbsp building conditions a bit

------------------------------------------------------------------------
r9995 | eihrul | 2010-02-24 22:31:44 -0800 (Wed, 24 Feb 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

fix signed vs. unsigned comparison warning in GL_TextureMode_f

------------------------------------------------------------------------
r9994 | divverent | 2010-02-22 10:33:57 -0800 (Mon, 22 Feb 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/model_brush.c

fix degenerate triangle elimination
------------------------------------------------------------------------
r9993 | vortex | 2010-02-20 17:52:02 -0800 (Sat, 20 Feb 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/model_sprite.c

Offsetmapping now could be customized on per-texture basis. Added mod_q3shader_default_offsetmapping cvar which is 1 by default (offsetmapping is on by default on all surfs), and 0 (only shader-set). New q3shader keyword "dp_offsetmapping <type> <scale>". Typical example: "dp_offsetmapping default 2". Types are "off", "default" (legacy cvar-based behavior), "linear" and "relief". Linear/relief is forced modes that ignores r_glsl_offsetmapping_reliefmapping. 
------------------------------------------------------------------------
r9992 | motorsep | 2010-02-20 10:31:50 -0800 (Sat, 20 Feb 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/common.c

+some tune ups for Steel Storm screenshot prefix
------------------------------------------------------------------------
r9991 | havoc | 2010-02-20 06:03:14 -0800 (Sat, 20 Feb 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fixed BIH line clipping and enabled it, BIH is now faster than BSP

------------------------------------------------------------------------
r9990 | havoc | 2010-02-20 05:31:40 -0800 (Sat, 20 Feb 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

slight improvement to BIH recursion speeds by checking for box overlap
on every node (in addition to the side check)

------------------------------------------------------------------------
r9989 | havoc | 2010-02-20 04:42:59 -0800 (Sat, 20 Feb 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/host.c

added server and client timing data to r_speeds 2

------------------------------------------------------------------------
r9988 | havoc | 2010-02-19 07:10:54 -0800 (Fri, 19 Feb 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix more cg shader errors

------------------------------------------------------------------------
r9987 | havoc | 2010-02-19 06:45:49 -0800 (Fri, 19 Feb 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix two compile errors in cg shader

------------------------------------------------------------------------
r9986 | havoc | 2010-02-18 04:11:48 -0800 (Thu, 18 Feb 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

don't error out if external lightmap sizes mismatch, just print a
warning and ignore the mismatching one and any later ones

------------------------------------------------------------------------
r9985 | divverent | 2010-02-18 03:39:49 -0800 (Thu, 18 Feb 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_textures.c

new argument "force" to gl_texturemode for more augenkrebs fun (and e.g. debugging lightmaps)
------------------------------------------------------------------------
r9984 | havoc | 2010-02-17 22:25:26 -0800 (Wed, 17 Feb 2010) | 5 lines
Changed paths:
   M /trunk/darkplaces/bih.c
   M /trunk/darkplaces/bih.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_brush.c

moved BIH_LEAF from bih_nodetype_t to bih_leaftype_t
renamed BIH_LEAF to BIH_BRUSH
renamed BIH_LEAF + 1 to BIH_COLLISIONTRIANGLE
renamed BIH_LEAF + 2 to BIH_RENDERTRIANGLE

------------------------------------------------------------------------
r9983 | havoc | 2010-02-17 22:23:28 -0800 (Wed, 17 Feb 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/qtypes.h

move RESTRICT keyword define to qtypes.h and add it to all the
AnimateVertices functions to hush a warning in MSVC

------------------------------------------------------------------------
r9982 | havoc | 2010-02-17 22:10:59 -0800 (Wed, 17 Feb 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/csprogs.h

added RF_FULLBRIGHT and RF_NOSHADOW renderflags for CSQC

------------------------------------------------------------------------
r9981 | havoc | 2010-02-17 22:10:03 -0800 (Wed, 17 Feb 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

fix a couple enum mixed with int warnings

------------------------------------------------------------------------
r9980 | havoc | 2010-02-17 22:09:40 -0800 (Wed, 17 Feb 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces-dedicated.vcproj
   M /trunk/darkplaces/darkplaces-sdl.vcproj
   M /trunk/darkplaces/darkplaces.vcproj

add bih.[ch] to MSVC projects

------------------------------------------------------------------------
r9979 | havoc | 2010-02-17 20:36:46 -0800 (Wed, 17 Feb 2010) | 4 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

changed default value of mod_collision_bih from 0 to 1 because it seems
fine but more testing is needed (and nothing gets tested if it has to be
done manually)

------------------------------------------------------------------------
r9978 | havoc | 2010-02-17 20:01:53 -0800 (Wed, 17 Feb 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_sprite.c

set supercontents and surfaceflags on models not using shaders

------------------------------------------------------------------------
r9977 | havoc | 2010-02-17 19:57:04 -0800 (Wed, 17 Feb 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c

make model collisions work when q3 shaders are used (by calculating
supercontents based on surfaceparm)

------------------------------------------------------------------------
r9976 | havoc | 2010-02-17 17:02:28 -0800 (Wed, 17 Feb 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

added some #if 0 test cases for BSP collision culling, to allow testing
the accuracy of the culling code by bypassing the optimized code

------------------------------------------------------------------------
r9975 | havoc | 2010-02-17 16:51:09 -0800 (Wed, 17 Feb 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

made the old BSP collision code check bounding boxes of brushes and
triangle meshes (curves) before colliding with them

------------------------------------------------------------------------
r9974 | havoc | 2010-02-17 16:25:56 -0800 (Wed, 17 Feb 2010) | 4 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

disable broken Mod_CollisionBIH_TracePoint_Mesh and
Mod_CollisionBIH_PointSuperContents_Mesh, they need more advanced
triangle checks to function properly

------------------------------------------------------------------------
r9973 | havoc | 2010-02-17 16:23:50 -0800 (Wed, 17 Feb 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

made BIH collision culling support the mod_q3bsp_curves_collisions cvar

------------------------------------------------------------------------
r9972 | havoc | 2010-02-17 16:22:51 -0800 (Wed, 17 Feb 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

added mod_recalculatenodeboxes cvar to allow this behavior to be
disabled (but it defaults 1 as before)

------------------------------------------------------------------------
r9971 | havoc | 2010-02-17 16:20:36 -0800 (Wed, 17 Feb 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

don't check mod_collision_bih in r_showcollisionbrushes because the old
code path was removed

------------------------------------------------------------------------
r9970 | havoc | 2010-02-17 10:27:58 -0800 (Wed, 17 Feb 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

deal with colbrushf == NULL cases in Mod_MakeCollisionBIH

------------------------------------------------------------------------
r9969 | divverent | 2010-02-17 06:35:33 -0800 (Wed, 17 Feb 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

fix getsurfacetriangle on a submodel
------------------------------------------------------------------------
r9968 | havoc | 2010-02-17 01:19:46 -0800 (Wed, 17 Feb 2010) | 6 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h

added mod_q1bsp_polygoncollisions cvar (off by default, because it
disables clip brushes in the bsp)
added BIH collision optimization to all model formats if the model is
not animated, this should mean that model collisions are much faster
(when used with SOLID_BSP and such)

------------------------------------------------------------------------
r9967 | eihrul | 2010-02-17 00:45:57 -0800 (Wed, 17 Feb 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

Mod_Decompile_SMD blend weight fixes

------------------------------------------------------------------------
r9966 | eihrul | 2010-02-16 23:21:41 -0800 (Tue, 16 Feb 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h

store blend weights as unsigned char data

------------------------------------------------------------------------
r9965 | havoc | 2010-02-16 22:55:00 -0800 (Tue, 16 Feb 2010) | 5 lines
Changed paths:
   M /trunk/darkplaces/bih.c
   M /trunk/darkplaces/bih.h
   M /trunk/darkplaces/collision.c
   M /trunk/darkplaces/collision.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_brush.c

implemented and debugged BIH (Bounding Interval Hierarchy) code, more
optimizations possible but this is a good start
mod_collision_bih cvar added, defaults to 0 because it is not yet
consistently faster than q3bsp collisions

------------------------------------------------------------------------
r9964 | eihrul | 2010-02-16 22:23:18 -0800 (Tue, 16 Feb 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

don't use dummy entries for single-bone blend palette entries

------------------------------------------------------------------------
r9963 | havoc | 2010-02-16 20:22:08 -0800 (Tue, 16 Feb 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

don't crash if the model produces no shadowmesh (no geometry)

------------------------------------------------------------------------
r9962 | motorsep | 2010-02-16 19:32:40 -0800 (Tue, 16 Feb 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/darkplaces-sdl.dev

+ added bih.c and bih.h files into SDL project file for DevCPP
------------------------------------------------------------------------
r9961 | havoc | 2010-02-16 19:14:12 -0800 (Tue, 16 Feb 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

don't error out when Mod_Q3BSP_LoadTriangles is called on a map with no
vertexes

------------------------------------------------------------------------
r9960 | havoc | 2010-02-16 19:03:55 -0800 (Tue, 16 Feb 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fix two typos in Mod_Q3BSP_LoadTriangles errors

------------------------------------------------------------------------
r9959 | havoc | 2010-02-16 18:40:15 -0800 (Tue, 16 Feb 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

fix unaligned memory access crash on skeletal models (allocating things
in the wrong order in a large block allocation)

------------------------------------------------------------------------
r9958 | eihrul | 2010-02-16 06:21:39 -0800 (Tue, 16 Feb 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

make R_Shadow_CullFrustumSides assume infinite far clip

------------------------------------------------------------------------
r9957 | havoc | 2010-02-15 04:56:48 -0800 (Mon, 15 Feb 2010) | 3 lines
Changed paths:
   A /trunk/darkplaces/bih.c
   A /trunk/darkplaces/bih.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/makefile.inc
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h

implementing Bounding Interval Hierarchy collision culling trees for
q3bsp, not used yet

------------------------------------------------------------------------
r9956 | vortex | 2010-02-14 15:10:49 -0800 (Sun, 14 Feb 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c

r_shadows_shadowmapscale cvar which as a multiple to r_shadow_shadowmapping_precision for fake shadows. Useful since otho shadowmaps likes high resolution (to get rid of pixel bleeding effect) and quite cheap.
------------------------------------------------------------------------
r9955 | divverent | 2010-02-12 07:04:54 -0800 (Fri, 12 Feb 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/render.h

hide one's own refraction (NOT reflection)
------------------------------------------------------------------------
r9954 | havoc | 2010-02-10 21:33:20 -0800 (Wed, 10 Feb 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

more statics...

------------------------------------------------------------------------
r9953 | havoc | 2010-02-10 21:01:56 -0800 (Wed, 10 Feb 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clvm_cmds.c

rearrange particle_t fields to save memory
disabled delayedcollisions support on particles to save memory

------------------------------------------------------------------------
r9952 | havoc | 2010-02-10 20:44:36 -0800 (Wed, 10 Feb 2010) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/quakedef.h

added texturename parameter in particles/particlefont.txt
fixed bug where alphatest was sometimes used on particles as a result of
previous transparent materials rendered before it
changed MAX_PARTICLETEXTURES to 256 because a byte index is used

------------------------------------------------------------------------
r9951 | havoc | 2010-02-10 19:46:30 -0800 (Wed, 10 Feb 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clvm_cmds.c

sort particles by effect origin rather than particle origin, this
improves fps in bigass1 by 8.3% in my tests

------------------------------------------------------------------------
r9950 | motorsep | 2010-02-10 13:16:52 -0800 (Wed, 10 Feb 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/cd_shared.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/darkplaces-sdl.dev

+ Added Steel Storm game
+ Added ability to play fake CD tracks from /music or /music/cdtracks
------------------------------------------------------------------------
r9949 | vortex | 2010-02-10 12:05:46 -0800 (Wed, 10 Feb 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/zone.c
   M /trunk/darkplaces/zone.h

Experimental feature of saving buffers within savegame files (in extended section). Code needs cleaning (since i'm not really understand concept of expandable arrays). Upgraded buf_create() to optional buf_create(string,float) string being a buffer format (yet another experimental feature that will be tested in future), should be "string" if presented. Second float is buffer flags, currently only flag 1 (save in savegames) are used. There is idea for another buffer flag which will allow buffer to pass across levels, saving handle number and contents (bufhandle could be passed as one of parm*).  
------------------------------------------------------------------------
r9948 | eihrul | 2010-02-09 19:53:27 -0800 (Tue, 09 Feb 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

fix missing restrict keyword

------------------------------------------------------------------------
r9947 | eihrul | 2010-02-08 20:53:49 -0800 (Mon, 08 Feb 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c

yet faster VSDCT instruction sequences

------------------------------------------------------------------------
r9946 | vortex | 2010-02-08 12:33:11 -0800 (Mon, 08 Feb 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/keys.c

Workaround F1/F12 binding for GAME_BLOODOMNICIDE
------------------------------------------------------------------------
r9945 | eihrul | 2010-02-07 14:54:30 -0800 (Sun, 07 Feb 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

shorter non-VSDCT GetShadowMapTC

------------------------------------------------------------------------
r9944 | divverent | 2010-02-07 12:13:08 -0800 (Sun, 07 Feb 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix r_showsurfaces 3 again
------------------------------------------------------------------------
r9943 | eihrul | 2010-02-07 11:04:11 -0800 (Sun, 07 Feb 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

attempting cheaper non-VSDCT projection

------------------------------------------------------------------------
r9942 | eihrul | 2010-02-06 22:56:16 -0800 (Sat, 06 Feb 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c

apply bias to orthographic shadowmaps

------------------------------------------------------------------------
r9941 | eihrul | 2010-02-05 14:32:56 -0800 (Fri, 05 Feb 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

don't shift the shadowmapping focus based on view angle when r_shadows_focus is used

------------------------------------------------------------------------
r9940 | divverent | 2010-02-05 04:15:31 -0800 (Fri, 05 Feb 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/model_shared.c

fix 9924 REALLY, this time transforming dp_ into dp in ALL shader parsing instances
------------------------------------------------------------------------
r9939 | eihrul | 2010-02-04 20:17:40 -0800 (Thu, 04 Feb 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

fix r_shadows_focus cvar so it is properly relative to view directions

------------------------------------------------------------------------
r9938 | eihrul | 2010-02-04 19:41:01 -0800 (Thu, 04 Feb 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

flip projection and sample matrices for R_DrawModelShadowMaps to avoid cull face usage

------------------------------------------------------------------------
r9937 | eihrul | 2010-02-04 19:02:29 -0800 (Thu, 04 Feb 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

invert cull face settings when drawing model shadowmaps

------------------------------------------------------------------------
r9936 | eihrul | 2010-02-04 18:49:23 -0800 (Thu, 04 Feb 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix unseen ents + r_shadows check in R_View_UpdateEntityLight

------------------------------------------------------------------------
r9935 | eihrul | 2010-02-04 18:17:29 -0800 (Thu, 04 Feb 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c

added r_shadows_focus cvar that allows a vector offset to be added to the r_shadows shadowmapping focus

------------------------------------------------------------------------
r9934 | eihrul | 2010-02-04 17:09:58 -0800 (Thu, 04 Feb 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h

try to cache fewer animations for entities when r_shadows is used by using cull box

------------------------------------------------------------------------
r9933 | eihrul | 2010-02-04 15:42:46 -0800 (Thu, 04 Feb 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h

faster skeletal animation based on blend-palettes

------------------------------------------------------------------------
r9932 | eihrul | 2010-02-04 01:16:02 -0800 (Thu, 04 Feb 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

fixed calculation of model shadowmap cull origin

------------------------------------------------------------------------
r9931 | eihrul | 2010-02-03 20:02:48 -0800 (Wed, 03 Feb 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

more accurate cull boxes on R_DrawModelShadowMaps

------------------------------------------------------------------------
r9930 | eihrul | 2010-02-03 18:34:54 -0800 (Wed, 03 Feb 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

don't render shadowmaportho onto noselfshadow entities to prevent hudgun ugliness and such

------------------------------------------------------------------------
r9929 | eihrul | 2010-02-03 18:10:43 -0800 (Wed, 03 Feb 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/render.h

moved pants to 7, reflectmask to 5, reflectcube to 6, shadowmaportho to 15

------------------------------------------------------------------------
r9928 | eihrul | 2010-02-03 17:45:36 -0800 (Wed, 03 Feb 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/render.h

reuse screenspace depth texture unit for orthographic shadowmaps so they can coexist with deferred lightmapping

------------------------------------------------------------------------
r9927 | eihrul | 2010-02-03 16:46:03 -0800 (Wed, 03 Feb 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

update CG shader for shadowmaportho

------------------------------------------------------------------------
r9926 | eihrul | 2010-02-03 16:18:13 -0800 (Wed, 03 Feb 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h

when r_shadow_shadowmapping is enabled, r_shadows uses shadowmaps instead of stencils

------------------------------------------------------------------------
r9925 | divverent | 2010-02-03 06:23:24 -0800 (Wed, 03 Feb 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/model_shared.c

fix typo in previous commit
------------------------------------------------------------------------
r9924 | divverent | 2010-02-03 06:22:41 -0800 (Wed, 03 Feb 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/model_shared.c

fix some inconsistent naming: some shader parameters are named like "dpshadow", some others like "dp_glossintensitymod". Add code to make all of these parameters work both with "dp" and "dp_" prefix. New shader scripts should use "dpshadow" notation.
------------------------------------------------------------------------
r9923 | divverent | 2010-02-02 22:35:45 -0800 (Tue, 02 Feb 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_parse.c

strip proquake QC messages if in Quake protocol
------------------------------------------------------------------------
r9922 | havoc | 2010-02-02 18:12:30 -0800 (Tue, 02 Feb 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

change default cl_netfps from 20 to 72

------------------------------------------------------------------------
r9921 | eihrul | 2010-02-02 18:09:11 -0800 (Tue, 02 Feb 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

factored R_Shadow_MakeShadowMap out of R_Shadow_RenderMode_ShadowMap so it can be reused

------------------------------------------------------------------------
r9920 | eihrul | 2010-02-02 17:00:36 -0800 (Tue, 02 Feb 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

reuse batchsurfacelist between R_Q1BSP_DrawShadowMap and R_Q1BSP_DrawLight

------------------------------------------------------------------------
r9919 | eihrul | 2010-02-01 14:46:03 -0800 (Mon, 01 Feb 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

when using PBLEND_INVMOD or PBLEND_ADD modes for particles/decals, make sure alpha is clamped to <= 1 when multiplying color

------------------------------------------------------------------------
r9918 | eihrul | 2010-02-01 02:15:46 -0800 (Mon, 01 Feb 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h

check if a model's textures have deforms that need normals/tangents at load-time, and pass in appropriate flags to RSurf_ActiveModelEntity based on this when rendering models with depthonly (fixes Nexuiz flag z-fighting)

------------------------------------------------------------------------
r9917 | divverent | 2010-02-01 01:58:33 -0800 (Mon, 01 Feb 2010) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clvm_cmds.c

ATTN VorteX: add a new field stainsize and stainalpha to effectinfo - TODO: particle spawners need that global declared in QC now, make that global optional somehow maybe
Declarations to be added:
var float particle_stainalpha = 1;
var float particle_stainsize = 1;
------------------------------------------------------------------------
r9916 | eihrul | 2010-02-01 00:02:27 -0800 (Mon, 01 Feb 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/matrixlib.c

make Matrix_ToBonePose6s check the podality of quaternions rather than assuming they are always positive from Matrix4x4_ToOrigin3Quat4Float

------------------------------------------------------------------------
r9915 | divverent | 2010-01-31 23:29:57 -0800 (Sun, 31 Jan 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_sky.c

fix sky drawing really this tiem
------------------------------------------------------------------------
r9914 | eihrul | 2010-01-31 22:38:02 -0800 (Sun, 31 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/csprogs.c

unsigned long vs. size_t printf format warning fix

------------------------------------------------------------------------
r9913 | eihrul | 2010-01-31 22:34:00 -0800 (Sun, 31 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

size vs. int warning fix

------------------------------------------------------------------------
r9912 | eihrul | 2010-01-31 22:29:40 -0800 (Sun, 31 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_mix.c

fix unsigned vs. signed comparison warnings

------------------------------------------------------------------------
r9911 | eihrul | 2010-01-31 22:18:26 -0800 (Sun, 31 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/matrixlib.c

handle case where trace is zero in Matrix4x4_ToOrigin3Quat4Float

------------------------------------------------------------------------
r9910 | havoc | 2010-01-31 19:49:01 -0800 (Sun, 31 Jan 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

increase sv_areagrid_mingridsize from 64 to 128 to reduce culling
overhead in most cases

------------------------------------------------------------------------
r9909 | havoc | 2010-01-31 19:45:11 -0800 (Sun, 31 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/svvm_cmds.c

fix off-by-one bug with bone numbers in skel_build

------------------------------------------------------------------------
r9908 | havoc | 2010-01-31 17:37:52 -0800 (Sun, 31 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

use less stack space

------------------------------------------------------------------------
r9907 | havoc | 2010-01-31 15:29:51 -0800 (Sun, 31 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/csprogs.h

fix a compile error

------------------------------------------------------------------------
r9906 | havoc | 2010-01-31 15:27:11 -0800 (Sun, 31 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/snd_mix.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/svbsp.c
   M /trunk/darkplaces/svvm_cmds.c

fix more warnings

------------------------------------------------------------------------
r9905 | havoc | 2010-01-31 15:15:03 -0800 (Sun, 31 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/cap_avi.c
   M /trunk/darkplaces/cl_demo.c
   M /trunk/darkplaces/cl_gecko.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/dpvsimpledecode.c
   M /trunk/darkplaces/ft2.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/lhnet.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/prvm_cmds.c

fix a bunch of warnings

------------------------------------------------------------------------
r9904 | havoc | 2010-01-31 15:12:33 -0800 (Sun, 31 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

fix some bugs with skeletonindex handling

------------------------------------------------------------------------
r9903 | divverent | 2010-01-31 13:01:13 -0800 (Sun, 31 Jan 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/netconn.c

fix a return value
------------------------------------------------------------------------
r9902 | divverent | 2010-01-31 12:57:54 -0800 (Sun, 31 Jan 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/mvm_cmds.c

fix some useless use of PRVM_G_STRING in mvm_cmds.c
------------------------------------------------------------------------
r9901 | divverent | 2010-01-31 11:50:38 -0800 (Sun, 31 Jan 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

make ClientTime available to ALL shader permutations, not just postprocess, if the shader defines it
------------------------------------------------------------------------
r9900 | havoc | 2010-01-31 11:05:20 -0800 (Sun, 31 Jan 2010) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/image.h
   M /trunk/darkplaces/jpeg.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/render.h

added r_texture_convertsRGB_* cvars (default: OFF) which allow automatic
conversion of sRGB textures to linear at load (only affects external
textures - anything embedded in q1 formats is untouched because they
were authored in linear)

------------------------------------------------------------------------
r9899 | havoc | 2010-01-31 10:43:13 -0800 (Sun, 31 Jan 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/svvm_cmds.c

fix a bug with skel_create where it returned a bone number instead of a
skeleton number

------------------------------------------------------------------------
r9898 | havoc | 2010-01-30 20:16:11 -0800 (Sat, 30 Jan 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

added a check in r_cullentities_trace to always show entities if the eye
is inside their culling box

------------------------------------------------------------------------
r9897 | havoc | 2010-01-30 19:26:44 -0800 (Sat, 30 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/svvm_cmds.c

bugfix for skel_build returning the wrong value

------------------------------------------------------------------------
r9896 | havoc | 2010-01-30 16:26:30 -0800 (Sat, 30 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c

allow multiple steps in one move

------------------------------------------------------------------------
r9895 | havoc | 2010-01-30 15:28:10 -0800 (Sat, 30 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

better fix for r_drawviewmodel

------------------------------------------------------------------------
r9894 | havoc | 2010-01-30 15:26:56 -0800 (Sat, 30 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix r_drawviewmodel

------------------------------------------------------------------------
r9893 | havoc | 2010-01-30 13:56:54 -0800 (Sat, 30 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/cd_shared.c

don't call StartPlaylist if index is -1 (disables playlists)

------------------------------------------------------------------------
r9892 | divverent | 2010-01-30 12:33:29 -0800 (Sat, 30 Jan 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/world.c

fix areagrid mins/maxs calculation (improves fps on peace6dot5 a LOT)
------------------------------------------------------------------------
r9891 | divverent | 2010-01-30 10:27:17 -0800 (Sat, 30 Jan 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_input.c

fix missing sqrt in sideways friction
------------------------------------------------------------------------
r9890 | divverent | 2010-01-30 10:08:12 -0800 (Sat, 30 Jan 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_input.c

make CPMA air control code more logical
------------------------------------------------------------------------
r9889 | divverent | 2010-01-30 01:46:47 -0800 (Sat, 30 Jan 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_input.c

make CPMA_PM_AirControl more gamepad friendly. Otherwise unchanged.
------------------------------------------------------------------------
r9888 | divverent | 2010-01-30 00:11:50 -0800 (Sat, 30 Jan 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_input.c

fix a minor code bug that should never occur in the last commit ;)
------------------------------------------------------------------------
r9887 | divverent | 2010-01-30 00:10:29 -0800 (Sat, 30 Jan 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/sv_main.c

speed clamping: sideways friction < 0 clamps against minimum possible backwards speed, airaccel_qw clamps against maximum possible forward speed, can behave like CPMA but with no strafejump bug
------------------------------------------------------------------------
r9886 | havoc | 2010-01-29 13:15:54 -0800 (Fri, 29 Jan 2010) | 4 lines
Changed paths:
   M /trunk/darkplaces/progsvm.h

enable the separate CLVM_ and MVM_ExecuteProgram functions unless
DP_SMALLMEMORY is defined, because these functions are necessary for
proper profiling

------------------------------------------------------------------------
r9885 | havoc | 2010-01-29 12:12:43 -0800 (Fri, 29 Jan 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/world.h

increase world culling grid dimensions back to 128 (192KB 32bit, 384KB
64bit), was 64 (48KB 32bit, 96KB 64bit)

------------------------------------------------------------------------
r9884 | havoc | 2010-01-29 12:10:58 -0800 (Fri, 29 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

reduce world culling grid size back to what it was before (64 again)

------------------------------------------------------------------------
r9883 | havoc | 2010-01-29 11:03:08 -0800 (Fri, 29 Jan 2010) | 6 lines
Changed paths:
   M /trunk/darkplaces/cd_shared.c
   M /trunk/darkplaces/cdaudio.h
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_null.c
   M /trunk/darkplaces/sound.h

implemented music playlist system with 10 playlists, automatic track
resume when switching between playlists (setting sampleposition to 0
will cause it to save and resume the position in the track, -1 restarts)
and random play options for each playlist
playlist system overrides normal cd console commands if index is not -1

------------------------------------------------------------------------
r9882 | divverent | 2010-01-29 06:35:27 -0800 (Fri, 29 Jan 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

disable showdebug while drawing sky, yields more flexibility when using showsurfaces (one can turn off sky separately using r_drawsky if one wishes so)
------------------------------------------------------------------------
r9881 | havoc | 2010-01-29 04:22:56 -0800 (Fri, 29 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix a typo

------------------------------------------------------------------------
r9880 | havoc | 2010-01-29 04:22:18 -0800 (Fri, 29 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/protocol.c

fix a typo

------------------------------------------------------------------------
r9879 | havoc | 2010-01-29 03:39:46 -0800 (Fri, 29 Jan 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/protocol.c

change protocol version table so that multiple numbers could correspond
to the same protocolversion_t if desired

------------------------------------------------------------------------
r9878 | havoc | 2010-01-29 01:59:56 -0800 (Fri, 29 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_dyntexture.c
   M /trunk/darkplaces/cl_dyntexture.h
   M /trunk/darkplaces/cl_gecko.h

fix line endings (CRLF -> LF)

------------------------------------------------------------------------
r9877 | havoc | 2010-01-29 01:47:28 -0800 (Fri, 29 Jan 2010) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

patch from Paul Jackson for per-pixel varying specular power in textures
(gloss alpha channel controls this), it is a simple fraction of the
current gloss exponent for the material

------------------------------------------------------------------------
r9876 | havoc | 2010-01-29 01:45:05 -0800 (Fri, 29 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

another dprintf

------------------------------------------------------------------------
r9875 | divverent | 2010-01-28 08:18:59 -0800 (Thu, 28 Jan 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

perform animation in getsurface* functions, to allow fully enumerating a model's current pose. CSQC-drawn model using polygon drawing and engine-side drawn model are now fully equivalent in geometry.
------------------------------------------------------------------------
r9874 | divverent | 2010-01-27 02:12:51 -0800 (Wed, 27 Jan 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/sv_phys.c

nudgeoutofsolid: check for bmodelstartsolid, not startsolid. Allows multiple player entities to occupy the same spot, and then VOLUNTARILY walk out of each other (like before), and doesn't perform a forced high-velocity nudge.
------------------------------------------------------------------------
r9873 | divverent | 2010-01-26 22:10:18 -0800 (Tue, 26 Jan 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/menu.c

REALLY fix the ESC menu toggle
------------------------------------------------------------------------
r9872 | divverent | 2010-01-26 22:10:12 -0800 (Tue, 26 Jan 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/keys.c

Revert "aaahh! let me use the menu, div0!"

This reverts commit 0c3fb702e1f1fac82c3b50c06664913fa05c8e8f.
------------------------------------------------------------------------
r9871 | havoc | 2010-01-26 21:30:44 -0800 (Tue, 26 Jan 2010) | 5 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h
   M /trunk/darkplaces/r_textures.h
   M /trunk/darkplaces/render.h

implemented fake reflection cubemaps...  requires that a .shader
specifies dpreflectcube with a cubemap prefix, and requires that the
material textures include a _reflect.tga image to mask the reflection
(roughly similar to _gloss texture)

------------------------------------------------------------------------
r9870 | divverent | 2010-01-26 21:23:20 -0800 (Tue, 26 Jan 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/ft2.c

Try to fix a warning motorsep gets
------------------------------------------------------------------------
r9869 | havoc | 2010-01-26 15:51:37 -0800 (Tue, 26 Jan 2010) | 4 lines
Changed paths:
   M /trunk/darkplaces/ft2.c

don't use pp = {};
don't use pp = {0};
use pp;

------------------------------------------------------------------------
r9868 | sajt | 2010-01-26 15:51:20 -0800 (Tue, 26 Jan 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/keys.c

aaahh! let me use the menu, div0!
------------------------------------------------------------------------
r9867 | sajt | 2010-01-26 15:42:17 -0800 (Tue, 26 Jan 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/ft2.c

fix compile error in visual c++
------------------------------------------------------------------------
r9866 | eihrul | 2010-01-26 14:51:39 -0800 (Tue, 26 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

always use fetch4 path for filtering if available

------------------------------------------------------------------------
r9865 | eihrul | 2010-01-26 14:31:14 -0800 (Tue, 26 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/ft2.c

fix uninitialized vars

------------------------------------------------------------------------
r9864 | divverent | 2010-01-26 08:50:05 -0800 (Tue, 26 Jan 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/ft2.c

in FT2 postprocess code, fix an integer overflow and a coordinate reversal
------------------------------------------------------------------------
r9863 | divverent | 2010-01-26 07:10:37 -0800 (Tue, 26 Jan 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/ft2.c

fix a typo in FT2 font code
------------------------------------------------------------------------
r9862 | divverent | 2010-01-26 03:32:14 -0800 (Tue, 26 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/clvm_cmds.h
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.h
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/svvm_cmds.c

make getsurface* functions shared between VMs
add getsurfacenumtriangles, getsurfacetriangle
------------------------------------------------------------------------
r9861 | divverent | 2010-01-26 03:21:20 -0800 (Tue, 26 Jan 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/ft2.c

fix padding calculation in freetype postprocessing filter, saves memory as possibly smaller font maps can be used with baked text shadow
------------------------------------------------------------------------
r9860 | divverent | 2010-01-25 22:23:53 -0800 (Mon, 25 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/menu.h

fix funny menu bug (why did it never happen for me)?
BTW, who would ever call a _f function from other stuff than console commands... that's sick.
------------------------------------------------------------------------
r9859 | havoc | 2010-01-25 17:07:13 -0800 (Mon, 25 Jan 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c

some bugfixes to mod_generatelightmaps that make it run on q1bsp
(doesn't look right though)

------------------------------------------------------------------------
r9858 | havoc | 2010-01-25 11:51:58 -0800 (Mon, 25 Jan 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/quakedef.h

changed DP_SMALLMEMORY compiles to use the standard NET_MAXMESSAGE value
because otherwise they can not play back demos

------------------------------------------------------------------------
r9857 | havoc | 2010-01-25 11:51:04 -0800 (Mon, 25 Jan 2010) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

faster surface culling check in light processing
added the beginnings of code for caching Cg shaders on disk, the actual
caching is not implemented yet

------------------------------------------------------------------------
r9856 | havoc | 2010-01-25 11:49:31 -0800 (Mon, 25 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_ogg.c

allow linking to libvorbis

------------------------------------------------------------------------
r9855 | havoc | 2010-01-25 11:49:08 -0800 (Mon, 25 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/lhnet.c

a slightly more robust error return check

------------------------------------------------------------------------
r9854 | havoc | 2010-01-25 11:48:39 -0800 (Mon, 25 Jan 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h

fix a bug where submodels are not uploaded in a VBO which can cause bad
performance on some drivers

------------------------------------------------------------------------
r9853 | havoc | 2010-01-25 07:29:42 -0800 (Mon, 25 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.h

shuffle fields in msurface_t to reduce memory usage on 64bit

------------------------------------------------------------------------
r9852 | havoc | 2010-01-25 07:10:40 -0800 (Mon, 25 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix water rendering bugs (was rendering water surface over its own view)

------------------------------------------------------------------------
r9851 | divverent | 2010-01-25 07:04:25 -0800 (Mon, 25 Jan 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/ft2.c

fix sign errors in shadows
------------------------------------------------------------------------
r9850 | divverent | 2010-01-25 07:02:56 -0800 (Mon, 25 Jan 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/draw.h
   M /trunk/darkplaces/ft2.c
   M /trunk/darkplaces/ft2.h
   M /trunk/darkplaces/gl_draw.c

apply the font parameters at loadfont time, not map generation time
------------------------------------------------------------------------
r9849 | divverent | 2010-01-25 05:51:19 -0800 (Mon, 25 Jan 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/ft2.c

only run the outline code if actually outlining :P
------------------------------------------------------------------------
r9848 | divverent | 2010-01-25 05:42:58 -0800 (Mon, 25 Jan 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/ft2.c

r_font_postprocess_* cvars to render fonts similar to mplayer subtitles with a blurred outline (not default)
------------------------------------------------------------------------
r9847 | divverent | 2010-01-25 00:12:29 -0800 (Mon, 25 Jan 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/ft2.c

add a missing parameter to that function :P
------------------------------------------------------------------------
r9846 | divverent | 2010-01-25 00:09:30 -0800 (Mon, 25 Jan 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/ft2.c

freetype: add a function yet to be filled for font image postprocessing
------------------------------------------------------------------------
r9845 | havoc | 2010-01-24 10:19:03 -0800 (Sun, 24 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

attempt to fix white flicker when r_water is toggled

------------------------------------------------------------------------
r9844 | havoc | 2010-01-24 09:02:53 -0800 (Sun, 24 Jan 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/netconn.h

don't store pointers for serverlist_viewlist, because they become
invalid after serverlist_cache is reallocated

------------------------------------------------------------------------
r9843 | divverent | 2010-01-24 05:43:31 -0800 (Sun, 24 Jan 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.c

fix enginestring use in mvm_cmds.c causing a crash regarding server list
------------------------------------------------------------------------
r9842 | blub | 2010-01-24 05:09:13 -0800 (Sun, 24 Jan 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/ft2.c

don't try to load kerning information when only checking for a working size to load
------------------------------------------------------------------------
r9841 | divverent | 2010-01-20 01:39:52 -0800 (Wed, 20 Jan 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_draw.c

fix the bug I just fixed another time :P slight speedup, no other change from this
------------------------------------------------------------------------
r9840 | divverent | 2010-01-19 22:58:45 -0800 (Tue, 19 Jan 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/utf8lib.c

fix typo in utf8 lib making characters U+1XXXX impossible
------------------------------------------------------------------------
r9839 | divverent | 2010-01-19 12:55:06 -0800 (Tue, 19 Jan 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/ft2.c
   M /trunk/darkplaces/gl_draw.c

fix off-by-one bug rendering characters like U+0100
------------------------------------------------------------------------
r9838 | havoc | 2010-01-18 02:11:10 -0800 (Mon, 18 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/keys.c

fix a warning

------------------------------------------------------------------------
r9837 | vortex | 2010-01-17 13:41:49 -0800 (Sun, 17 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clvm_cmds.c

Two new cvars for blood particles: decal alpha, decal random scaling (min/max)
Protect against float values on stain colors in DP_CSQC_SPAWNPARTICLE
------------------------------------------------------------------------
r9836 | divverent | 2010-01-17 10:59:57 -0800 (Sun, 17 Jan 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

fix VM_sprintf "%s" conversion when passed ""
------------------------------------------------------------------------
r9835 | havoc | 2010-01-16 08:21:11 -0800 (Sat, 16 Jan 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

don't reject render entities from being added just because of
chase_active value, the renderer will filter them

------------------------------------------------------------------------
r9832 | havoc | 2010-01-12 23:15:57 -0800 (Tue, 12 Jan 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/console.c

don't draw conback when the file is missing, behave as if
scr_conbrightness is 0 in this case

------------------------------------------------------------------------
r9831 | divverent | 2010-01-12 02:55:37 -0800 (Tue, 12 Jan 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/cmd.c

add new pseudo variable $# containing the number of arguments to the alias
------------------------------------------------------------------------
r9830 | havoc | 2010-01-12 01:54:07 -0800 (Tue, 12 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix black models in fixed function rendering path

------------------------------------------------------------------------
r9829 | divverent | 2010-01-11 23:32:05 -0800 (Mon, 11 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/svvm_cmds.c

fix typo in SV_GetEntityLocalTagMatrix, should fix attachment on MD3
models
------------------------------------------------------------------------
r9828 | vortex | 2010-01-11 13:45:06 -0800 (Mon, 11 Jan 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_sprites.c

patch from div0 for SPR_OVERHEAD sprites 'virtual perspective', looks better. Move some parms into cvars (see r_overheadsprites*).
------------------------------------------------------------------------
r9827 | vortex | 2010-01-11 12:23:59 -0800 (Mon, 11 Jan 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/r_sprites.c

sorry, forgot to remove debug prints, fixing
------------------------------------------------------------------------
r9826 | vortex | 2010-01-11 12:17:06 -0800 (Mon, 11 Jan 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/r_sprites.c
   M /trunk/darkplaces/spritegn.h

add new SPR_OVERHEAD (ident 7), a derivative of SPR_VP_PARALLEL with couple of hacks for better use with overhead-mode sprite monsters.
------------------------------------------------------------------------
r9825 | eihrul | 2010-01-11 09:29:19 -0800 (Mon, 11 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

optimized pose math to not use intermediate matrix

------------------------------------------------------------------------
r9824 | havoc | 2010-01-09 12:47:13 -0800 (Sat, 09 Jan 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

fix model scaling on old zym and dpm files where the root bone was
scaled

------------------------------------------------------------------------
r9823 | havoc | 2010-01-09 11:09:19 -0800 (Sat, 09 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

fix compile warning

------------------------------------------------------------------------
r9822 | divverent | 2010-01-09 10:52:47 -0800 (Sat, 09 Jan 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/fs.c

fix compile error
------------------------------------------------------------------------
r9821 | eihrul | 2010-01-09 10:48:38 -0800 (Sat, 09 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

silence warning about using uninitialized pose var

------------------------------------------------------------------------
r9820 | divverent | 2010-01-09 10:47:00 -0800 (Sat, 09 Jan 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/fs.c

.dir -> .pk3dir only
------------------------------------------------------------------------
r9819 | divverent | 2010-01-09 10:46:56 -0800 (Sat, 09 Jan 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/fs.c

also support the .dir and .d extensions for virtual packs
------------------------------------------------------------------------
r9818 | divverent | 2010-01-09 10:46:52 -0800 (Sat, 09 Jan 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/fs.c

fix vpack support to actually work; use a pack_s structure for vpack items
------------------------------------------------------------------------
r9817 | divverent | 2010-01-09 10:46:49 -0800 (Sat, 09 Jan 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/fs.c

fix some compile errors. Now it should work.
------------------------------------------------------------------------
r9816 | divverent | 2010-01-09 10:46:43 -0800 (Sat, 09 Jan 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/fs.c

first vpack stuff
------------------------------------------------------------------------
r9815 | havoc | 2010-01-09 00:41:34 -0800 (Sat, 09 Jan 2010) | 6 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/mathlib.h
   M /trunk/darkplaces/matrixlib.c
   M /trunk/darkplaces/matrixlib.h
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/svvm_cmds.c

redesigned skeletal model animation bone pose format - instead of
float[12] matrix data it is now short[6] origin+quat data with
appropriate scale factors detected at load to preserve full range of
motion, this does however lose the ability to scale bones in a model...
this reduces memory usage significantly in some games

------------------------------------------------------------------------
r9814 | havoc | 2010-01-09 00:38:20 -0800 (Sat, 09 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

log dds texture load failures (only happens with r_texture_dds_load 1)

------------------------------------------------------------------------
r9813 | havoc | 2010-01-08 00:53:30 -0800 (Fri, 08 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/quakedef.h

more memory savings

------------------------------------------------------------------------
r9812 | havoc | 2010-01-08 00:52:59 -0800 (Fri, 08 Jan 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

texture management now uses a memexpandablearray_t instead of individual
allocations

------------------------------------------------------------------------
r9811 | havoc | 2010-01-07 23:20:27 -0800 (Thu, 07 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/protocol.c

fix compile error

------------------------------------------------------------------------
r9810 | havoc | 2010-01-07 23:19:20 -0800 (Thu, 07 Jan 2010) | 6 lines
Changed paths:
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c

fix size of entity_state_t (it was 98 bytes, now 96 bytes)
reduce memory usage by having server update render flags on
exteriormodeltoclient entities for each player they are sent to rather
than copying the entire entity_state_t array and modifying it, now the
EntityFrame*_WriteFrame functions take a pointer array

------------------------------------------------------------------------
r9809 | havoc | 2010-01-07 22:57:50 -0800 (Thu, 07 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/world.h

more reductions in memory usage

------------------------------------------------------------------------
r9808 | havoc | 2010-01-07 22:45:55 -0800 (Thu, 07 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/quakedef.h

don't set DP_SMALLMEMORY by default

------------------------------------------------------------------------
r9807 | havoc | 2010-01-07 22:19:23 -0800 (Thu, 07 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/keys.h
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/snd_main.h

reduce memory usage by several more megabytes

------------------------------------------------------------------------
r9806 | havoc | 2010-01-07 21:40:19 -0800 (Thu, 07 Jan 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

limit vertex lighting path (GL11/GL13) to 4 passes per light rather than
64

------------------------------------------------------------------------
r9805 | havoc | 2010-01-07 21:38:48 -0800 (Thu, 07 Jan 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/prvm_exec.c
   M /trunk/darkplaces/prvm_execprogram.h

significantly reduce code size in prvm_exec.c by simplifying the
prvm_execprogram.h includes

------------------------------------------------------------------------
r9804 | havoc | 2010-01-07 21:04:05 -0800 (Thu, 07 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/world.h

reduce memory usage by several megabytes

------------------------------------------------------------------------
r9803 | havoc | 2010-01-07 19:13:40 -0800 (Thu, 07 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

reorganize textypeinfo_t

------------------------------------------------------------------------
r9802 | divverent | 2010-01-07 04:40:34 -0800 (Thu, 07 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/sv_phys.c

fix bug in tracebox->line and traceline->point redirection causing endposnudge to be applied multiple times

------------------------------------------------------------------------
r9801 | havoc | 2010-01-06 18:50:13 -0800 (Wed, 06 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

fix TEXTYPE_COLORBUFFER

------------------------------------------------------------------------
r9800 | havoc | 2010-01-06 17:42:33 -0800 (Wed, 06 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces-dedicated.vcproj
   M /trunk/darkplaces/darkplaces-sdl.vcproj
   M /trunk/darkplaces/darkplaces.vcproj

added ft2 and utf8lib files

------------------------------------------------------------------------
r9799 | havoc | 2010-01-06 17:17:13 -0800 (Wed, 06 Jan 2010) | 6 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_textures.h

no longer uses rectangle textures for deferred rendering (reduces
extension requirements)
fixed several bugs with Cg shader
added TEXTYPE_COLORBUFFER for textures intended to be copied into, so
that it can be set to match the framebuffer

------------------------------------------------------------------------
r9798 | havoc | 2010-01-06 17:12:33 -0800 (Wed, 06 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/svbsp.c

reduce stack requirements

------------------------------------------------------------------------
r9797 | eihrul | 2010-01-06 11:29:45 -0800 (Wed, 06 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

only clear depth buffer bit for shadowmaps

------------------------------------------------------------------------
r9796 | eihrul | 2010-01-06 11:15:31 -0800 (Wed, 06 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

only issue one clear for 2D/rect shadowmaps

------------------------------------------------------------------------
r9795 | havoc | 2010-01-05 15:52:37 -0800 (Tue, 05 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix some bugs with cgGL path

------------------------------------------------------------------------
r9794 | blub | 2010-01-05 12:12:41 -0800 (Tue, 05 Jan 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

I used the code from before the utf8 changed but it used to allow to access invalid memory - fixed that
------------------------------------------------------------------------
r9793 | blub | 2010-01-05 12:10:00 -0800 (Tue, 05 Jan 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

with utf8 disabled, str2chr should now behave the way it used to
------------------------------------------------------------------------
r9792 | blub | 2010-01-05 12:04:38 -0800 (Tue, 05 Jan 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

with utf8 disabled VM_str2chr should not use U+E0xx codes
------------------------------------------------------------------------
r9790 | eihrul | 2010-01-05 10:54:24 -0800 (Tue, 05 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

textureGatherOffset fix - take #2

------------------------------------------------------------------------
r9789 | eihrul | 2010-01-05 10:48:57 -0800 (Tue, 05 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

don't use textureGatherOffset as Catalyst GLSL doesn't appear to implement it

------------------------------------------------------------------------
r9787 | eihrul | 2010-01-05 10:37:00 -0800 (Tue, 05 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c

fixed signed vs. unsigned warning

------------------------------------------------------------------------
r9786 | eihrul | 2010-01-05 10:34:06 -0800 (Tue, 05 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fixed missing \n"

------------------------------------------------------------------------
r9785 | blub | 2010-01-05 10:21:52 -0800 (Tue, 05 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c

fixing a possible invalid memory access spotted by a_grue

------------------------------------------------------------------------
r9784 | havoc | 2010-01-05 10:21:35 -0800 (Tue, 05 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix some shader compile errors related to MODE_LIGHTDIRECTION

------------------------------------------------------------------------
r9783 | blub | 2010-01-05 09:20:09 -0800 (Tue, 05 Jan 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

Make SHADERPERMUTATION_COUNT be the actual size of the array.
------------------------------------------------------------------------
r9782 | havoc | 2010-01-05 01:33:35 -0800 (Tue, 05 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_shared.c

remove support for GL_EXT_compiled_vertex_array extension

------------------------------------------------------------------------
r9781 | havoc | 2010-01-05 01:16:24 -0800 (Tue, 05 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix r_hdr intensity problems

------------------------------------------------------------------------
r9780 | havoc | 2010-01-04 21:49:58 -0800 (Mon, 04 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/mathlib.h
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h

implemented obj model loading

------------------------------------------------------------------------
r9779 | havoc | 2010-01-04 15:02:37 -0800 (Mon, 04 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix GLSL compile error on cubemap lights with deferred rendering

------------------------------------------------------------------------
r9778 | havoc | 2010-01-04 12:06:03 -0800 (Mon, 04 Jan 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

renamed r_frame to r_textureframe for better readability and made it
increment on every scene render

------------------------------------------------------------------------
r9777 | havoc | 2010-01-04 11:29:33 -0800 (Mon, 04 Jan 2010) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c

moved R_Mesh_TexCoordPointer, R_Mesh_ColorPointer, GL_BlendFunc, and
GL_AlphaTest calls to R_SetupShader_Surface for a slight speed gain
(less texcoord arrays active now in some cases)

------------------------------------------------------------------------
r9776 | blub | 2010-01-04 02:56:38 -0800 (Mon, 04 Jan 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/vid_glx.c

patch by a_grue: fix some memory leaks in the GLX client - the manpages confirm that the data has to be freed by the caller
------------------------------------------------------------------------
r9775 | divverent | 2010-01-03 12:50:16 -0800 (Sun, 03 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

allow entity number reuse during PRVM_ED_LoadFromFile to get consistent entity numbering on map loading

------------------------------------------------------------------------
r9774 | divverent | 2010-01-03 12:28:52 -0800 (Sun, 03 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

When loading savegames, unlink all edicts first. This prevents bugs from happening on loading games when an entity number was used by the spawnfunctions of the map, but not by the savegame.

------------------------------------------------------------------------
r9773 | blub | 2010-01-03 07:02:04 -0800 (Sun, 03 Jan 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

r_glsl_dumpshader: shaderpermutationinfo[i].pretext needs to be checked, otherwise it tries to use NULL in FS_Write and segfaults
------------------------------------------------------------------------
r9772 | blub | 2010-01-03 03:46:38 -0800 (Sun, 03 Jan 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_draw.c

width_of_factor is now useless since it's always equal to dw - replaced it
------------------------------------------------------------------------
r9771 | blub | 2010-01-03 03:43:08 -0800 (Sun, 03 Jan 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/ft2.c
   M /trunk/darkplaces/ft2.h
   M /trunk/darkplaces/gl_draw.c

Do not load sizes < 0 at all.
Trying a different snapping approach for width_of which doesn't ignore fnt->scale in DrawQ_* functions.

------------------------------------------------------------------------
r9770 | blub | 2010-01-02 09:13:23 -0800 (Sat, 02 Jan 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/ft2.c
   M /trunk/darkplaces/gl_draw.c

load the freetype library in Font_Init already, and don't call Font_Init twice
------------------------------------------------------------------------
r9769 | havoc | 2010-01-02 09:03:26 -0800 (Sat, 02 Jan 2010) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h

upload all q1bsp lightmaps on first frame, rather than waiting for
surfaces to become visible

------------------------------------------------------------------------
r9768 | blub | 2010-01-02 08:33:02 -0800 (Sat, 02 Jan 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/ft2.c

on mac it's libfreetype.dylib and/or libfreetype.6.dylib
------------------------------------------------------------------------
r9767 | blub | 2010-01-02 08:03:02 -0800 (Sat, 02 Jan 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/ft2.c

with mingw I get a libfreetype-6.dll so I guess the win32 DLL list for freetype should contain it
------------------------------------------------------------------------
r9766 | divverent | 2010-01-01 13:42:19 -0800 (Fri, 01 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/image_png.c

speed up PNG saving by about factor 4 by using fastest zlib mode, and no filters. Who cares for this small increase of file size.

------------------------------------------------------------------------
r9765 | blub | 2010-01-01 09:04:55 -0800 (Fri, 01 Jan 2010) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_draw.c

reset prevch after drawing the shadow to not kern the last shadow-character with the first normal character
------------------------------------------------------------------------
r9764 | divverent | 2010-01-01 05:57:28 -0800 (Fri, 01 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/ft2.c

again, a stupid fix for stupid MSVC not supporting a 11 years old C standard

------------------------------------------------------------------------
r9763 | divverent | 2010-01-01 05:56:07 -0800 (Fri, 01 Jan 2010) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c

fix a typo in the pixel snapping

------------------------------------------------------------------------
r9762 | divverent | 2010-01-01 05:35:40 -0800 (Fri, 01 Jan 2010) | 6 lines
Changed paths:
   M /trunk/darkplaces/ft2.c
   M /trunk/darkplaces/ft2_fontdefs.h
   M /trunk/darkplaces/gl_draw.c

patch by Blub and me:
- width_of: separate snapped character width array per-size
- snap fonts at load time, not at render time (saves on render time)
- fix font size snapping to both compare width and height
- r_font_kerning cvar

------------------------------------------------------------------------
r9761 | divverent | 2009-12-31 06:47:18 -0800 (Thu, 31 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/jpeg.c

make the JPEGs progressive

------------------------------------------------------------------------
r9760 | divverent | 2009-12-31 06:44:18 -0800 (Thu, 31 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/image_png.c
   M /trunk/darkplaces/image_png.h

new cvar: scr_screenshot_png (and obvious PNG screenshotting code to support it)

------------------------------------------------------------------------
r9759 | blub | 2009-12-31 01:56:34 -0800 (Thu, 31 Dec 2009) | 1 line
Changed paths:
   M /trunk/darkplaces/snd_main.c

Check sfx->fetcher instead of ch_ind < 0 before freeing an sfx, since ch_ind < 0 does NOT mean the sfx file didn't exist, but that it failed to play for other (unlikely) reasons.
------------------------------------------------------------------------
r9758 | divverent | 2009-12-31 01:32:14 -0800 (Thu, 31 Dec 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

notice the input data has no useful data on the alpha channel, and fall back to RGB texture compression (DXT1).
Saves GPU memory when compressing textures.

------------------------------------------------------------------------
r9757 | havoc | 2009-12-30 16:19:08 -0800 (Wed, 30 Dec 2009) | 6 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_main.h
   M /trunk/darkplaces/snd_ogg.c

due to performance issues with streaming ogg decoding of all sounds, the
cvar snd_streaming has been brought back from r9487 and defaults to 1
(decode small sounds at load), a new mode of 2 has been added
snd_streaming 0 = always load entire sound, 1 = decode small sounds, 2 =
never decode at load (least memory, slow)

------------------------------------------------------------------------
r9756 | havoc | 2009-12-30 14:33:59 -0800 (Wed, 30 Dec 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

do not set hasalphaflag on dds images that have alpha but were loaded
without TEXF_ALPHA

------------------------------------------------------------------------
r9755 | havoc | 2009-12-30 12:03:51 -0800 (Wed, 30 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

default r_lerpsprites to 0 because it causes flickering

------------------------------------------------------------------------
r9754 | havoc | 2009-12-30 11:40:42 -0800 (Wed, 30 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/protocol.c

remove an unused variable

------------------------------------------------------------------------
r9753 | havoc | 2009-12-30 11:37:33 -0800 (Wed, 30 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile

change WIN64RELEASE options

------------------------------------------------------------------------
r9752 | havoc | 2009-12-30 11:27:03 -0800 (Wed, 30 Dec 2009) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/protocol.c

buffer up to 32 recent frame numbers for clc_ack to prevent entity
resyncs on the server when the client framerate is much lower than the
server framerate, repeat frame numbers of previous input packet
(cl_netrepeatinput cvar, just like clc_move repeats)

------------------------------------------------------------------------
r9751 | havoc | 2009-12-30 08:42:21 -0800 (Wed, 30 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_rmain.c

fix water rendering bugs where the clipping plane was not being used

------------------------------------------------------------------------
r9750 | divverent | 2009-12-30 05:37:17 -0800 (Wed, 30 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c

fix engine version display

------------------------------------------------------------------------
r9749 | havoc | 2009-12-30 04:19:31 -0800 (Wed, 30 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile

added WIN64RELEASE flags

------------------------------------------------------------------------
r9748 | havoc | 2009-12-30 04:19:15 -0800 (Wed, 30 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix water rendering

------------------------------------------------------------------------
r9747 | divverent | 2009-12-30 03:27:53 -0800 (Wed, 30 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/sv_user.c

remove some unwanted debug prints

------------------------------------------------------------------------
r9746 | divverent | 2009-12-30 03:24:51 -0800 (Wed, 30 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c

don't spatialize twice :P

------------------------------------------------------------------------
r9745 | divverent | 2009-12-30 03:24:10 -0800 (Wed, 30 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/sv_user.c

hopefully fix a race condition in S_StartSound

------------------------------------------------------------------------
r9744 | blub | 2009-12-30 03:09:00 -0800 (Wed, 30 Dec 2009) | 1 line
Changed paths:
   M /trunk/darkplaces/utf8lib.c

get rid of a warning
------------------------------------------------------------------------
r9743 | havoc | 2009-12-30 03:05:08 -0800 (Wed, 30 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.inc

add back -fno-strict-aliasing to hush warnings

------------------------------------------------------------------------
r9742 | divverent | 2009-12-30 01:26:56 -0800 (Wed, 30 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/draw.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/sbar.c

more redundant suffix elimination

------------------------------------------------------------------------
r9741 | divverent | 2009-12-30 01:14:48 -0800 (Wed, 30 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/draw.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/sbar.c

remove redundant _Size suffix from textwidth functions, as now all of them would have it

------------------------------------------------------------------------
r9740 | divverent | 2009-12-30 01:10:19 -0800 (Wed, 30 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/draw.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/sbar.c
   M /trunk/darkplaces/utf8lib.c

fix alignment of fps counter with ft2 fonts, and other alignment issues

------------------------------------------------------------------------
r9739 | divverent | 2009-12-29 23:54:24 -0800 (Tue, 29 Dec 2009) | 2 lines
Changed paths:
   A /trunk/darkplaces/intoverflow.h

add the intoverflow lib

------------------------------------------------------------------------
r9738 | divverent | 2009-12-29 23:54:06 -0800 (Tue, 29 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

handle integer overflow when DDS loading

------------------------------------------------------------------------
r9737 | divverent | 2009-12-29 23:40:48 -0800 (Tue, 29 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

fix the overflow checks :(

------------------------------------------------------------------------
r9736 | divverent | 2009-12-29 23:38:47 -0800 (Tue, 29 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

DDS: handle file size errors

------------------------------------------------------------------------
r9735 | havoc | 2009-12-29 18:21:16 -0800 (Tue, 29 Dec 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/image.h
   M /trunk/darkplaces/r_textures.h
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_shared.c

implemented support for caching compressed textures (.dds files),
disabled by default

------------------------------------------------------------------------
r9734 | blub | 2009-12-29 06:04:29 -0800 (Tue, 29 Dec 2009) | 1 line
Changed paths:
   M /trunk/darkplaces/utf8lib.c

using tables for u8_analyze to speed it up
------------------------------------------------------------------------
r9733 | divverent | 2009-12-29 04:11:00 -0800 (Tue, 29 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/quakedef.h

fix declaration of buildstring

------------------------------------------------------------------------
r9732 | divverent | 2009-12-29 03:33:58 -0800 (Tue, 29 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/utf8lib.h

make the utf8 casting strict aliasing-safe

------------------------------------------------------------------------
r9731 | divverent | 2009-12-28 23:09:06 -0800 (Mon, 28 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/utf8lib.h

improve the just added macros to not cause anything unexpected if passed a wrong pointer type

------------------------------------------------------------------------
r9730 | divverent | 2009-12-28 23:06:37 -0800 (Mon, 28 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/utf8lib.c
   M /trunk/darkplaces/utf8lib.h

factor out the non-utf8 part of u8_get*char into macros

------------------------------------------------------------------------
r9729 | eihrul | 2009-12-28 13:16:27 -0800 (Mon, 28 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

don't explicitly enable GL_ARB_shadow extension in GLSL code (shouldn't be necessary according to spec)

------------------------------------------------------------------------
r9728 | havoc | 2009-12-28 11:54:16 -0800 (Mon, 28 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix a NULL free attempt

------------------------------------------------------------------------
r9727 | eihrul | 2009-12-28 11:53:04 -0800 (Mon, 28 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix stray semicolon

------------------------------------------------------------------------
r9726 | blub | 2009-12-28 09:16:44 -0800 (Mon, 28 Dec 2009) | 1 line
Changed paths:
   M /trunk/darkplaces/ft2.c

added developer_font, set > 100 to also dump the generated images
------------------------------------------------------------------------
r9725 | havoc | 2009-12-28 06:29:05 -0800 (Mon, 28 Dec 2009) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/r_textures.h

removed TEXF_MANUALFLUSHUPDATES flag, now bufferpixels flushing occurs
automatically when R_Mesh_TexBind uses the texture
changed default value of gl_nopartialtextureupdates from 0 to 1

------------------------------------------------------------------------
r9724 | havoc | 2009-12-28 06:04:06 -0800 (Mon, 28 Dec 2009) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c

moved almost all R_GetTexture calls into R_Mesh_TexBind
removed R_Mesh_TexBindAll
R_Mesh_TexBind now only takes one texture parameter, an rtexture_t *

------------------------------------------------------------------------
r9723 | havoc | 2009-12-28 06:03:46 -0800 (Mon, 28 Dec 2009) | 5 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/r_textures.h

exposed two more fields in rtexture_t, now texnum is always non-zero but
there is a dirty flag, and there is a gltexturetypeenum for use by
binding code
eliminated internal flags GLTEXF_UPLOAD and GLTEXF_DESTROYED

------------------------------------------------------------------------
r9722 | divverent | 2009-12-28 06:02:15 -0800 (Mon, 28 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/ft2.c

fix font glyph loading coordinates - now unhinted works

------------------------------------------------------------------------
r9721 | havoc | 2009-12-28 05:21:36 -0800 (Mon, 28 Dec 2009) | 5 lines
Changed paths:
   M /trunk/darkplaces/makefile.inc

reduced the options in LDFLAGS_WINCOMMON and added them to their
respective builds instead, so that LDFLAGS_WINCOMMON can easily be set
to nothing on the commandline for mingw64 builds
(where --large-address-aware produces a compile error)

------------------------------------------------------------------------
r9720 | divverent | 2009-12-28 05:21:19 -0800 (Mon, 28 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/ft2.c

more cvars: r_font_antialias (0, 1)

------------------------------------------------------------------------
r9719 | blub | 2009-12-28 04:08:54 -0800 (Mon, 28 Dec 2009) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_draw.c

try using imagefont from fallbacks as well (.tga and .width)
------------------------------------------------------------------------
r9718 | divverent | 2009-12-28 04:05:09 -0800 (Mon, 28 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c

remove a no longer applying fixme comment

------------------------------------------------------------------------
r9717 | divverent | 2009-12-28 03:47:55 -0800 (Mon, 28 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c

added masking to Con_DrawConsole, and removed it from the height and draw functions; switched back to the old backscroll code as it was faster with long consoles (less wordwrap invocations)

------------------------------------------------------------------------
r9716 | blub | 2009-12-28 03:40:41 -0800 (Mon, 28 Dec 2009) | 1 line
Changed paths:
   M /trunk/darkplaces/ft2.c

r_font_hinting cvar makes more sense: 0 no hinting, 1 force autohinting, 2 fullhinting, default: 2
------------------------------------------------------------------------
r9715 | blub | 2009-12-28 03:34:09 -0800 (Mon, 28 Dec 2009) | 1 line
Changed paths:
   M /trunk/darkplaces/ft2.c

cvar: r_font_autohinting added
------------------------------------------------------------------------
r9714 | blub | 2009-12-28 03:00:24 -0800 (Mon, 28 Dec 2009) | 1 line
Changed paths:
   M /trunk/darkplaces/console.c

DrawQ_TextWidth_Font_Size for the engineversion string in the console
------------------------------------------------------------------------
r9713 | blub | 2009-12-28 02:24:32 -0800 (Mon, 28 Dec 2009) | 1 line
Changed paths:
   M /trunk/darkplaces/utf8lib.c

fixed an inconsistency in u8_analyze
------------------------------------------------------------------------
r9712 | blub | 2009-12-27 14:17:13 -0800 (Sun, 27 Dec 2009) | 1 line
Changed paths:
   M /trunk/darkplaces/utf8lib.c

with utf8 disabled, u8_byteofs must still behave correctly, also u8_bytelen w/o utf8 should not behave differently
------------------------------------------------------------------------
r9711 | havoc | 2009-12-27 12:13:15 -0800 (Sun, 27 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

fix developer_extra and developer_insane cvar declarations

------------------------------------------------------------------------
r9710 | havoc | 2009-12-27 05:12:57 -0800 (Sun, 27 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/ft2.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/netconn.c

fix a bunch of type-punned pointer warnings

------------------------------------------------------------------------
r9709 | havoc | 2009-12-27 05:11:08 -0800 (Sun, 27 Dec 2009) | 4 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h

added StoreBigShort
added StoreLittleLong
added StoreLittleShort

------------------------------------------------------------------------
r9708 | havoc | 2009-12-27 05:05:57 -0800 (Sun, 27 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

hush a warning

------------------------------------------------------------------------
r9707 | havoc | 2009-12-27 05:04:00 -0800 (Sun, 27 Dec 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/keys.c

reworked console rendering, now uses con_backscroll in a much more
direct way and has no glitches with developer cvar being toggled

------------------------------------------------------------------------
r9706 | havoc | 2009-12-27 04:14:43 -0800 (Sun, 27 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.inc

use less options, for compatibility with old gcc

------------------------------------------------------------------------
r9705 | havoc | 2009-12-27 04:02:58 -0800 (Sun, 27 Dec 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/cd_shared.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/sv_main.c

changed several Con_Printf calls to Con_DPrintf
added q3bsp stats printing (like q1bsp stats) and added mesh info

------------------------------------------------------------------------
r9704 | havoc | 2009-12-27 03:33:49 -0800 (Sun, 27 Dec 2009) | 6 lines
Changed paths:
   M /trunk/darkplaces/cd_shared.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/console.h
   M /trunk/darkplaces/cvar.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sys_shared.c

added Con_MaskPrintf, Con_Printf/Con_DPrintf and friends are now just
wrappers for these
added console text filtering - the developer cvar now shows/hides
developer prints (Con_DPrintf) on the fly, these are still logged to
files and terminal output regardless of the cvar though

------------------------------------------------------------------------
r9703 | havoc | 2009-12-27 02:49:34 -0800 (Sun, 27 Dec 2009) | 4 lines
Changed paths:
   M /trunk/darkplaces/cd_shared.c
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/cl_gecko.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/collision.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/cvar.c
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/ft2.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/libcurl.c
   M /trunk/darkplaces/makefile.inc
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/prvm_exec.c
   M /trunk/darkplaces/prvm_execprogram.h
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/snd_alsa.c
   M /trunk/darkplaces/snd_coreaudio.c
   M /trunk/darkplaces/snd_sdl.c
   M /trunk/darkplaces/snd_win.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/svvm_cmds.c
   M /trunk/darkplaces/vid_wgl.c
   M /trunk/darkplaces/world.c
   M /trunk/darkplaces/zone.c

changed a ton of developer cvar checks into developer_extra/insane
checks, or simply Con_DPrintf calls
made developer a saved cvar

------------------------------------------------------------------------
r9702 | blub | 2009-12-27 01:52:49 -0800 (Sun, 27 Dec 2009) | 1 line
Changed paths:
   M /trunk/darkplaces/ft2.c

reducing error output in font loading (use developer != 0 to re-enable)
------------------------------------------------------------------------
r9701 | blub | 2009-12-27 01:51:49 -0800 (Sun, 27 Dec 2009) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_draw.c

use real pixels for r_textshadow instead of virtual ones
------------------------------------------------------------------------
r9700 | divverent | 2009-12-26 10:59:15 -0800 (Sat, 26 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/ft2.c
   M /trunk/darkplaces/gl_draw.c

freetype: "loadfont" now uses virtual pixels, not real pixels, for font sizes, to be screen resolution independent. Requires loadfont commands to come after config.cfg.

------------------------------------------------------------------------
r9699 | blub | 2009-12-26 05:45:04 -0800 (Sat, 26 Dec 2009) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

these checks are now superfluous, u8_fromchar doesn't return values <0 anymore
------------------------------------------------------------------------
r9698 | blub | 2009-12-26 05:42:27 -0800 (Sat, 26 Dec 2009) | 1 line
Changed paths:
   M /trunk/darkplaces/utf8lib.c
   M /trunk/darkplaces/vid_glx.c

set the unicode value to 0 if no value exists, also changing u8_fromchar to not return values < 0 but just 0 - it's easier to use that way
------------------------------------------------------------------------
r9697 | divverent | 2009-12-26 05:27:55 -0800 (Sat, 26 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

fix  asign error in a mostly unused physics code part :P

------------------------------------------------------------------------
r9696 | motorsep | 2009-12-25 19:16:57 -0800 (Fri, 25 Dec 2009) | 1 line
Changed paths:
   M /trunk/darkplaces/darkplaces-sdl.dev

added missing .h and .c files to the project
------------------------------------------------------------------------
r9695 | blub | 2009-12-25 10:49:21 -0800 (Fri, 25 Dec 2009) | 1 line
Changed paths:
   M /trunk/darkplaces/vid_glx.c

get rid of the warning
------------------------------------------------------------------------
r9694 | divverent | 2009-12-25 10:11:18 -0800 (Fri, 25 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

stringwidth(): if 3rd arg is not given, always yield the size for 8x8 text, unsnapped, divided by 8

------------------------------------------------------------------------
r9693 | blub | 2009-12-25 09:50:49 -0800 (Fri, 25 Dec 2009) | 1 line
Changed paths:
   A /trunk/darkplaces/keysym2ucs.c
   M /trunk/darkplaces/makefile.inc
   M /trunk/darkplaces/vid_glx.c

unicode character input handling in the GLX client
------------------------------------------------------------------------
r9692 | havoc | 2009-12-25 09:19:22 -0800 (Fri, 25 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/svbsp.c

more optimizations to SVBSP code

------------------------------------------------------------------------
r9691 | blub | 2009-12-25 08:50:12 -0800 (Fri, 25 Dec 2009) | 1 line
Changed paths:
   M /trunk/darkplaces/utf8lib.c

u8_get{n,}char should advance the end-ptr even if no valid character was found so it at least points to the \0 or to after maxlen
------------------------------------------------------------------------
r9690 | divverent | 2009-12-25 07:14:09 -0800 (Fri, 25 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/draw.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_edict.c

add a menu/csqc field .drawfontscale to scale the font drawn by drawfont but not change the bitmap - useful for smoothly changing font size if snapping is active

------------------------------------------------------------------------
r9689 | havoc | 2009-12-25 05:53:26 -0800 (Fri, 25 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/svbsp.c

improved performance of SVBSP code

------------------------------------------------------------------------
r9688 | divverent | 2009-12-25 03:52:59 -0800 (Fri, 25 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/gl_draw.c

improve text word wrapping

------------------------------------------------------------------------
r9687 | blub | 2009-12-25 01:29:35 -0800 (Fri, 25 Dec 2009) | 1 line
Changed paths:
   M /trunk/darkplaces/utf8lib.c

'<=' fail: '< 0xC2' means invalid '== 0xC2' does not, I had it right in the comment...
------------------------------------------------------------------------
r9686 | blub | 2009-12-25 01:17:45 -0800 (Fri, 25 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/utf8lib.c

fix u8_COM_StringLengthNoColors the same way other functions handle signedness

------------------------------------------------------------------------
r9685 | divverent | 2009-12-25 00:49:38 -0800 (Fri, 25 Dec 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/utf8lib.c
   M /trunk/darkplaces/utf8lib.h

utf8: add VM_sprintf support
now sprintf("%#10s", s) pads to 10 bytes, and sprintf("%10s", s) pads to 10 characters, if utf8 is enabled

------------------------------------------------------------------------
r9684 | havoc | 2009-12-24 15:34:41 -0800 (Thu, 24 Dec 2009) | 4 lines
Changed paths:
   M /trunk/darkplaces/svbsp.c

added back the old method of comparing points to the parent planes,
because it is faster, more research needed for optimizations
fix a few warnings about double to float conversion

------------------------------------------------------------------------
r9683 | eihrul | 2009-12-24 13:49:04 -0800 (Thu, 24 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/svbsp.c

fixed plane test typo

------------------------------------------------------------------------
r9682 | havoc | 2009-12-24 13:44:40 -0800 (Thu, 24 Dec 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

use svbsp for rtlight compilation instead of portal culling, for
quality reasons

------------------------------------------------------------------------
r9681 | havoc | 2009-12-24 13:42:49 -0800 (Thu, 24 Dec 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/svbsp.c
   M /trunk/darkplaces/svbsp.h

changed svbsp code to use floats instead of doubles
optimized the parent node checks in svbsp occluder insertion

------------------------------------------------------------------------
r9680 | havoc | 2009-12-24 09:06:38 -0800 (Thu, 24 Dec 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/qtypes.h
   M /trunk/darkplaces/sys_linux.c

don't use ssize_t
removed ssize_t from qtypes.h

------------------------------------------------------------------------
r9679 | havoc | 2009-12-24 08:36:41 -0800 (Thu, 24 Dec 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/cap_ogg.c
   M /trunk/darkplaces/cl_gecko.c
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/ft2.c
   M /trunk/darkplaces/image_png.c
   M /trunk/darkplaces/jpeg.c
   M /trunk/darkplaces/libcurl.c
   M /trunk/darkplaces/qtypes.h
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/snd_3dras.c
   M /trunk/darkplaces/snd_modplug.c
   M /trunk/darkplaces/snd_ogg.c
   M /trunk/darkplaces/world.c

change a few WIN64 checks to _WIN64 (which actually works), and remove
the rest (dll names are the same, and ssize_t needs to be declared)

------------------------------------------------------------------------
r9678 | havoc | 2009-12-24 08:23:40 -0800 (Thu, 24 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/clvm_cmds.c

fix some warnings about a variable being used twice in a line, with ++

------------------------------------------------------------------------
r9677 | havoc | 2009-12-24 08:22:47 -0800 (Thu, 24 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/zone.c

fix a printf where a size_t was being printed as a long

------------------------------------------------------------------------
r9676 | havoc | 2009-12-24 08:21:59 -0800 (Thu, 24 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/curves.c

fix a warning about possibly uninitialized variables

------------------------------------------------------------------------
r9675 | havoc | 2009-12-24 08:21:42 -0800 (Thu, 24 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_wgl.c

fix some 64bit printf errors

------------------------------------------------------------------------
r9674 | havoc | 2009-12-24 08:21:11 -0800 (Thu, 24 Dec 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/makefile.inc

changed Cg shader support to check DP_CG_LIBDIR instead of trying to
detect /usr/lib

------------------------------------------------------------------------
r9673 | havoc | 2009-12-24 08:20:02 -0800 (Thu, 24 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/ft2.c

disabled WIN64 error, perhaps we should use the name freetype6_x64.dll

------------------------------------------------------------------------
r9672 | havoc | 2009-12-24 08:00:19 -0800 (Thu, 24 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h

renamed a parameter, removed some unused cvars

------------------------------------------------------------------------
r9671 | havoc | 2009-12-24 05:09:03 -0800 (Thu, 24 Dec 2009) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h

removed r_shadow_culltriangles - the only useful part of it (shadow
caster culling on dlights when using shadow volumes) is preserved, the
nasty part (changes in lighting) are gone

------------------------------------------------------------------------
r9670 | havoc | 2009-12-24 05:00:30 -0800 (Thu, 24 Dec 2009) | 4 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

turn off r_shadow_culltriangles by default, because it was lowering
performance and in the case of shadowmapping or shadowless lights it
looks rather bad on models

------------------------------------------------------------------------
r9669 | havoc | 2009-12-24 04:21:52 -0800 (Thu, 24 Dec 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

reorganized GLSL shader
added Cg shader

------------------------------------------------------------------------
r9668 | havoc | 2009-12-24 04:14:38 -0800 (Thu, 24 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

improved Cg error reporting

------------------------------------------------------------------------
r9667 | divverent | 2009-12-24 03:51:31 -0800 (Thu, 24 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c

same fix in DrawQ_String

------------------------------------------------------------------------
r9666 | divverent | 2009-12-24 03:48:32 -0800 (Thu, 24 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c

fix text width function

------------------------------------------------------------------------
r9665 | havoc | 2009-12-24 01:54:27 -0800 (Thu, 24 Dec 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

don't project shadows so far - this fixes broken shadows with
r_useinfinitefarclip 0

------------------------------------------------------------------------
r9664 | blub | 2009-12-24 01:48:37 -0800 (Thu, 24 Dec 2009) | 1 line
Changed paths:
   M /trunk/darkplaces/console.c

take utf8_enable into account when printing the dots for a multiline chatmessage
------------------------------------------------------------------------
r9663 | divverent | 2009-12-24 00:30:07 -0800 (Thu, 24 Dec 2009) | 6 lines
Changed paths:
   M /trunk/darkplaces/sv_user.c

fix detection of timeout-based lost packets.
Now movementloss detection beats all test cases:
- it is 0 in local games :P
- when temporarily setting 100% packetloss, PL and movementloss are about equal
- when permanently setting 50% packetloss, movementloss is about 25% (due to cl_netrepeatinput 1)

------------------------------------------------------------------------
r9662 | divverent | 2009-12-24 00:15:39 -0800 (Thu, 24 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_user.c

try to notice uncompensated packet loss due to timeouts

------------------------------------------------------------------------
r9661 | eihrul | 2009-12-23 15:44:41 -0800 (Wed, 23 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

fixing sizeof(data) of pointer to particle texture data introduced in r9614

------------------------------------------------------------------------
r9660 | divverent | 2009-12-23 13:10:11 -0800 (Wed, 23 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/utf8lib.h

remove unneeded include

------------------------------------------------------------------------
r9659 | divverent | 2009-12-23 12:59:57 -0800 (Wed, 23 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

fix typo in last commit

------------------------------------------------------------------------
r9658 | divverent | 2009-12-23 12:58:12 -0800 (Wed, 23 Dec 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

do not TOTALLY block translation with csprogs, but restrict it to globals named dotranslate_*.
In other progs, all names that do not start with notranslate_* can be translated.

------------------------------------------------------------------------
r9657 | divverent | 2009-12-23 12:41:36 -0800 (Wed, 23 Dec 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c

progs loading: allow translation of strings using a .po-format string table, named menu.dat.de.po for language "de", if prvm_language is set to "de".
A template "menu.dat.dump.po" is written if you set prvm_language "dump".

------------------------------------------------------------------------
r9656 | divverent | 2009-12-23 12:38:11 -0800 (Wed, 23 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/ft2.c

add DLL name for win32

------------------------------------------------------------------------
r9655 | divverent | 2009-12-23 10:40:41 -0800 (Wed, 23 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

improve sprintf a bit to match with documentation

------------------------------------------------------------------------
r9654 | divverent | 2009-12-23 10:33:12 -0800 (Wed, 23 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.h
   M /trunk/darkplaces/svvm_cmds.c

DP_QC_SPRINTF :P

------------------------------------------------------------------------
r9653 | blub | 2009-12-23 09:24:32 -0800 (Wed, 23 Dec 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/ft2.c
   M /trunk/darkplaces/ft2_defs.h

Using MAX_QPATH for filenames in ft2.
__uint32 is actually unsigned __int32

------------------------------------------------------------------------
r9652 | blub | 2009-12-23 09:10:10 -0800 (Wed, 23 Dec 2009) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_draw.c

MSVC doesn't support 'inline'
------------------------------------------------------------------------
r9651 | divverent | 2009-12-23 07:55:25 -0800 (Wed, 23 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/ft2.c

oops, a float I meant

------------------------------------------------------------------------
r9650 | divverent | 2009-12-23 07:55:04 -0800 (Wed, 23 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/ft2.c

turn font size snapping into a float

------------------------------------------------------------------------
r9649 | blub | 2009-12-23 06:45:59 -0800 (Wed, 23 Dec 2009) | 1 line
Changed paths:
   M /trunk/darkplaces/ft2_defs.h

stdint.h and uint32_t instead of u_int32_t
------------------------------------------------------------------------
r9648 | divverent | 2009-12-23 04:56:33 -0800 (Wed, 23 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/utf8lib.h

additionally include stdint.h on non-MSVC too

------------------------------------------------------------------------
r9647 | havoc | 2009-12-23 04:48:50 -0800 (Wed, 23 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

make CgGL render path work

------------------------------------------------------------------------
r9646 | divverent | 2009-12-23 04:15:47 -0800 (Wed, 23 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/utf8lib.c
   M /trunk/darkplaces/utf8lib.h

make utf8 functions safer: give them a size limit in memory, to allow working with non-NUL-terminated strings

------------------------------------------------------------------------
r9645 | divverent | 2009-12-23 03:54:07 -0800 (Wed, 23 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/console.c

get utf8lib out of common.c by moving the u8_strnlen call into console.c - keeps the word wrap function encoding agnostic

------------------------------------------------------------------------
r9644 | blub | 2009-12-23 03:46:09 -0800 (Wed, 23 Dec 2009) | 1 line
Changed paths:
   M /trunk/darkplaces/common.c

this should work without strlen as well
------------------------------------------------------------------------
r9643 | blub | 2009-12-23 02:51:55 -0800 (Wed, 23 Dec 2009) | 1 line
Changed paths:
   M /trunk/darkplaces/common.c

do not use non-standard strnlen function
------------------------------------------------------------------------
r9642 | blub | 2009-12-23 02:48:04 -0800 (Wed, 23 Dec 2009) | 1 line
Changed paths:
   A /trunk/darkplaces/ft2.c
   A /trunk/darkplaces/ft2.h
   A /trunk/darkplaces/ft2_defs.h
   A /trunk/darkplaces/ft2_fontdefs.h
   A /trunk/darkplaces/utf8lib.c
   A /trunk/darkplaces/utf8lib.h

... forgot to add the files, I'm too used to git now :P
------------------------------------------------------------------------
r9641 | blub | 2009-12-23 02:43:52 -0800 (Wed, 23 Dec 2009) | 7 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/draw.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/makefile.inc
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/r_textures.h
   M /trunk/darkplaces/vid_sdl.c

Adding FreeType2 and UTF-8 Support.
UTF-8 is disabled by default, FreeType is enabled.
new cvars: utf8_enable (0)
           r_font_disable_freetype (1)
	   r_font_use_alpha_textures (0, not really finished yet)
	   r_font_size_snapping (1 - 0 looks bad when vid_conwidth/height and vid_width/height are too different)

------------------------------------------------------------------------
r9640 | havoc | 2009-12-23 01:39:34 -0800 (Wed, 23 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix SUPPORTCG checks

------------------------------------------------------------------------
r9639 | divverent | 2009-12-23 01:35:16 -0800 (Wed, 23 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.inc

fix detection of cg libs

------------------------------------------------------------------------
r9638 | divverent | 2009-12-23 00:48:36 -0800 (Wed, 23 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/prvm_exec.c
   M /trunk/darkplaces/sv_user.c
   M /trunk/darkplaces/svvm_cmds.c

DP_SV_PING_PACKETLOSS: expose packet loss to server QC

------------------------------------------------------------------------
r9637 | havoc | 2009-12-23 00:32:07 -0800 (Wed, 23 Dec 2009) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/makefile.inc
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_shared.c

the beginnings of a cgGL rendering path experiment, does not work yet
overhauled GL20 rendering path to bind textures during shader setup
copy to texture is now done by calling R_Mesh_CopyToTexture instead of
calling GL functions directly

------------------------------------------------------------------------
r9636 | havoc | 2009-12-22 23:43:05 -0800 (Tue, 22 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/sv_main.c

load maps/levelname_effectinfo.txt in addition to effectinfo.txt

------------------------------------------------------------------------
r9635 | havoc | 2009-12-21 18:06:10 -0800 (Mon, 21 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fix a crash on non-deluxemapped q3bsp loading

------------------------------------------------------------------------
r9634 | havoc | 2009-12-21 06:20:16 -0800 (Mon, 21 Dec 2009) | 6 lines
Changed paths:
   M /trunk/darkplaces/cl_gecko.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_sprite.c
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_lightning.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/r_textures.h

removed r_precachetextures cvar
removed TEXF_PRECACHE flag
removed TEXF_ALWAYSPRECACHE flag
all textures are now always uploaded immediately (deferring was made
unnecessary by the selective skinframe uploading, and cachepic unloading)

------------------------------------------------------------------------
r9633 | havoc | 2009-12-21 06:01:32 -0800 (Mon, 21 Dec 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_lightning.c

fix some issues with r_hdr 1 (or r_hdr_scenebrightness) where
r_refdef.view.colorscale was being misused

------------------------------------------------------------------------
r9632 | havoc | 2009-12-21 05:37:08 -0800 (Mon, 21 Dec 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

force R_GetCurrentTexture to regenerate data when
r_refdef.view.colorscale is changed by r_hdr 1 rendering

------------------------------------------------------------------------
r9631 | divverent | 2009-12-21 04:44:14 -0800 (Mon, 21 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/sv_user.c

fix movement loss tracking

------------------------------------------------------------------------
r9630 | divverent | 2009-12-21 04:31:10 -0800 (Mon, 21 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_user.c

movement packet loss tracking

------------------------------------------------------------------------
r9629 | havoc | 2009-12-21 03:52:18 -0800 (Mon, 21 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

fix typo in StoreBigLong calls on NETFLAG_ACK packets

------------------------------------------------------------------------
r9628 | havoc | 2009-12-21 01:09:54 -0800 (Mon, 21 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/keys.c

print unknown keys a little differently, to avoid escape characters

------------------------------------------------------------------------
r9627 | havoc | 2009-12-21 01:07:55 -0800 (Mon, 21 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

change how compression hint check works

------------------------------------------------------------------------
r9626 | havoc | 2009-12-21 01:02:32 -0800 (Mon, 21 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/vid_shared.c

remove some gl functions that are not used

------------------------------------------------------------------------
r9625 | havoc | 2009-12-21 01:01:24 -0800 (Mon, 21 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_rmain.c

use floats rather than doubles for view matrix stuff

------------------------------------------------------------------------
r9624 | havoc | 2009-12-21 01:00:00 -0800 (Mon, 21 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

added LINK_TO_ZLIB define checks, to allow direct linking

------------------------------------------------------------------------
r9623 | havoc | 2009-12-21 00:57:25 -0800 (Mon, 21 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/keys.h

added K_PRINTSCREEN, not actually used by any platforms though

------------------------------------------------------------------------
r9622 | havoc | 2009-12-21 00:56:36 -0800 (Mon, 21 Dec 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/lhnet.c

added SUPPORTIPV6 define checks - not defined by default, this should
help platforms that do not provide ipv6 network headers at all

------------------------------------------------------------------------
r9621 | havoc | 2009-12-21 00:54:40 -0800 (Mon, 21 Dec 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/quakedef.h

increase NET_MAXMESSAGE in DP_SMALLMEMORY configuration, 16KB was too
low for signons in some cases

------------------------------------------------------------------------
r9620 | havoc | 2009-12-21 00:53:48 -0800 (Mon, 21 Dec 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/sys_shared.c

added SUPPORTDLL define and checks, if any platforms lack support for
dynamic loading they could alter this define

------------------------------------------------------------------------
r9619 | havoc | 2009-12-21 00:49:22 -0800 (Mon, 21 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/sys_linux.c

check if FNDELAY is defined instead of checking WIN32

------------------------------------------------------------------------
r9618 | havoc | 2009-12-21 00:47:02 -0800 (Mon, 21 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/zone.c

print memlist if out of memory error occurs

------------------------------------------------------------------------
r9617 | havoc | 2009-12-21 00:46:20 -0800 (Mon, 21 Dec 2009) | 8 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/model_alias.h
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/snd_bsd.c
   M /trunk/darkplaces/snd_ogg.c
   M /trunk/darkplaces/snd_wav.c
   M /trunk/darkplaces/sv_demo.c
   M /trunk/darkplaces/zone.c
   M /trunk/darkplaces/zone.h

added mem_bigendian variable
made LittleLong/Short/Float and BigLong/Short/Float functions pass a
pointer to the variable to BuffBigLong/BuffLittleLong and friends to
avoid unaligned memory access crashes on some platforms even if a file
has unaligned data in it
added StoreBigLong function to help the netconn.c code
removed BYTE_ORDER compile-time detection

------------------------------------------------------------------------
r9616 | havoc | 2009-12-20 23:45:40 -0800 (Sun, 20 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fix big endian loading of patches

------------------------------------------------------------------------
r9615 | havoc | 2009-12-20 23:38:14 -0800 (Sun, 20 Dec 2009) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_gecko.c
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/r_textures.h

added gl_nopartialtextureupdates cvar which disables use of
glTexSubImage2D calls (in case this hits bad paths on some drivers?)
added R_Mesh_TexBound function which returns the currently bound texture
on a given unit (avoids a slow qglGetIntegerv)

------------------------------------------------------------------------
r9614 | havoc | 2009-12-20 23:11:36 -0800 (Sun, 20 Dec 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/meshqueue.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/svvm_cmds.c

allocate memory for big temporary storage arrays rather than using the
stack

------------------------------------------------------------------------
r9612 | divverent | 2009-12-20 10:27:38 -0800 (Sun, 20 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

allocate the right byte count for PVS data in framedata

------------------------------------------------------------------------
r9611 | havoc | 2009-12-20 07:18:44 -0800 (Sun, 20 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

disable r_transparentdepthmasking by default until issues are resolved

------------------------------------------------------------------------
r9610 | havoc | 2009-12-20 06:53:53 -0800 (Sun, 20 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

GLSL shaders no longer use gl_TexCoord[] varying variables

------------------------------------------------------------------------
r9609 | havoc | 2009-12-20 06:46:43 -0800 (Sun, 20 Dec 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c

GLSL shaders no longer use gl_TextureMatrix, now all matrix parameters
are passed as uniforms

------------------------------------------------------------------------
r9608 | havoc | 2009-12-20 06:20:26 -0800 (Sun, 20 Dec 2009) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_shadow.c

eliminated R_Mesh_TextureState function and rmeshstate_t struct because
rmeshstate_t was excessively slow to memset and process (1984 bytes on
64bit systems)

------------------------------------------------------------------------
r9607 | havoc | 2009-12-20 05:19:54 -0800 (Sun, 20 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fixed cl_decals_models 1 rendering

------------------------------------------------------------------------
r9606 | havoc | 2009-12-20 05:11:18 -0800 (Sun, 20 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

implemented fogging for cl_decals_newsystem 1

------------------------------------------------------------------------
r9605 | havoc | 2009-12-20 05:00:23 -0800 (Sun, 20 Dec 2009) | 5 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_sprites.c
   M /trunk/darkplaces/render.h

fix GL11/GL13 fogged sprite rendering and q1bsp sky rendering - the
FOGDARKEN flag was not implemented properly
changed sprite rendering to use a new function that takes a texture_t
instead of a skinframe

------------------------------------------------------------------------
r9604 | havoc | 2009-12-20 04:19:15 -0800 (Sun, 20 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix fog mask scrolling on q1bsp sky

------------------------------------------------------------------------
r9603 | havoc | 2009-12-20 04:07:18 -0800 (Sun, 20 Dec 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix bug with cl_decals_newsystem where submodels and other static models
would not render decals

------------------------------------------------------------------------
r9602 | havoc | 2009-12-20 03:30:25 -0800 (Sun, 20 Dec 2009) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix bug where r_shadow_deferred 1 caused transparent entities being lit
by rtlights to be darker than they should be (the transparent mesh was
being rendered over the light passes instead of before them)

------------------------------------------------------------------------
r9601 | havoc | 2009-12-20 02:20:40 -0800 (Sun, 20 Dec 2009) | 5 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_brush.h

added r_transparentdepthmasking cvar (defaults to 1), this causes alpha
fading of opaque materials to look much better, while still not altering
transparent materials (like blended tree foliage - but that should be
alpha test anyway)

------------------------------------------------------------------------
r9600 | divverent | 2009-12-20 02:09:44 -0800 (Sun, 20 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

don't need it twice...

------------------------------------------------------------------------
r9599 | divverent | 2009-12-20 01:54:44 -0800 (Sun, 20 Dec 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_sprite.c

- fix specular stuff on Q1BSP
- cl_lerpanim_maxdelta_server, cl_lerpanim_maxdelta_framegroups to customize lerping deltas

------------------------------------------------------------------------
r9598 | divverent | 2009-12-20 00:46:01 -0800 (Sun, 20 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

slowmo: when slowmo is < 1, restrict sys_ticrate not to 0.1 but to 0.1 / slowmo. Helps with seeing what lerping does.

------------------------------------------------------------------------
r9597 | divverent | 2009-12-20 00:32:55 -0800 (Sun, 20 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/svvm_cmds.c

DP_EF_RESTARTANIM_BIT

------------------------------------------------------------------------
r9596 | divverent | 2009-12-20 00:32:26 -0800 (Sun, 20 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

maxidlefps fix for maxfps 0

------------------------------------------------------------------------
r9595 | havoc | 2009-12-19 23:26:01 -0800 (Sat, 19 Dec 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix bug with deluxemapping (I thought GLSL had a recip function but it
does not)

------------------------------------------------------------------------
r9594 | havoc | 2009-12-19 22:29:36 -0800 (Sat, 19 Dec 2009) | 9 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/render.h

force shadowmapping when deferred rendering is on
reworked lighting code a bit to ensure consistent behavior
fixed multiple bugs with r_ambient, .colormod, r_fullbright,
r_shadow_gloss 2, and other lighting parameters
overhauled GLSL shader to ensure consistency
fixed bug with deferred rendering of polygonoffset on submodels
deferred rendering path now checks for transparent surfaces and uses the
forward rendering path on them

------------------------------------------------------------------------
r9593 | havoc | 2009-12-19 22:23:28 -0800 (Sat, 19 Dec 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c

fix lack of specular on q1 mdl, and a possible case where it would not
have specular on q1 bsp

------------------------------------------------------------------------
r9592 | havoc | 2009-12-19 22:22:59 -0800 (Sat, 19 Dec 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

avoid a permanent memory leak on lightmap allocation in q1bsp - no time
to investigate the underlying cause

------------------------------------------------------------------------
r9591 | samual | 2009-12-19 21:23:16 -0800 (Sat, 19 Dec 2009) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_main.c

Update cl_deathfade cvar description
------------------------------------------------------------------------
r9590 | divverent | 2009-12-19 11:04:20 -0800 (Sat, 19 Dec 2009) | 11 lines
Changed paths:
   M /trunk/darkplaces/libcurl.c

useful stuff for server admins: curl command now allows the host name to be
left out, like this:

http:///~nexuiz/files/
http://:8080/~nexuiz/files/

allows setting up the HTTP server for map downloads on the same machine as the
DP server on a dynamic IP without using dyndns.

Client needs to support this.

------------------------------------------------------------------------
r9589 | havoc | 2009-12-17 23:35:07 -0800 (Thu, 17 Dec 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

change sv_cullentities_trace_samples from 1 to 2 - 1 is completely
unacceptable (hides monsters in quake if their origin is not visible...)

------------------------------------------------------------------------
r9588 | havoc | 2009-12-17 01:14:03 -0800 (Thu, 17 Dec 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_lightning.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/r_sprites.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_shared.c

implemented deferred rendering (r_shadow_deferred cvar) to accelerate
lighting in scenes with many lights

------------------------------------------------------------------------
r9587 | havoc | 2009-12-16 00:49:20 -0800 (Wed, 16 Dec 2009) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/r_textures.h

fix a bug where gl_max_lightmapsize cvar was not registered (and hence
always behaved like a value of 0, causing lightmaps to be small)
added R_LoadTextureRectangle function

------------------------------------------------------------------------
r9586 | eihrul | 2009-12-14 14:41:55 -0800 (Mon, 14 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c

make Draw_FreePic set pic->tex to NULL to prevent reuse of invalid texture

------------------------------------------------------------------------
r9585 | havoc | 2009-12-13 22:35:00 -0800 (Sun, 13 Dec 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c

reworked animcache code to store information in ent->animcache_vertex3f
and similar fields rather than having a separate info array

------------------------------------------------------------------------
r9584 | havoc | 2009-12-13 21:08:20 -0800 (Sun, 13 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

increase r_framedatasize in increments instead of by a percentage

------------------------------------------------------------------------
r9583 | havoc | 2009-12-13 21:02:40 -0800 (Sun, 13 Dec 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

allocate portals differently to reduce Mem_Alloc reports in
developer_memory 1 mode

------------------------------------------------------------------------
r9582 | havoc | 2009-12-13 21:02:15 -0800 (Sun, 13 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix crash when r_framedatasize increases

------------------------------------------------------------------------
r9581 | havoc | 2009-12-13 20:13:04 -0800 (Sun, 13 Dec 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/console.h

fix a crash on shutdown when using developer_memory 1 (the conbuffer_t
is being freed and prints messages while doing so)

------------------------------------------------------------------------
r9580 | havoc | 2009-12-13 17:04:10 -0800 (Sun, 13 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix void * arithmetic error on MSVC

------------------------------------------------------------------------
r9578 | havoc | 2009-12-13 13:03:04 -0800 (Sun, 13 Dec 2009) | 6 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h
   M /trunk/darkplaces/render.h

added R_FrameData_Alloc and Store functions (a per-frame heap allocator
for temporary rendering data)
all animated model geometry is now cached before rendering begins
(rtlights are processed in two stages now)
reworked animcache and rtlight processing to use R_FrameData_Store

------------------------------------------------------------------------
r9577 | havoc | 2009-12-09 05:04:42 -0800 (Wed, 09 Dec 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_shared.c

removed GL_NV_blend_square detection because it is no longer used
without the dot3 lighting code

------------------------------------------------------------------------
r9576 | havoc | 2009-12-09 04:47:10 -0800 (Wed, 09 Dec 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_shared.c

removed DOT3 lighting path (bumpmapped lighting on pre-shader cards)
added 3D texture attenuation support to vertex lighting path

------------------------------------------------------------------------
r9575 | havoc | 2009-12-09 04:26:15 -0800 (Wed, 09 Dec 2009) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/vid_shared.c

renderer now uses vid.renderpath to select rendering techniques instead
of r_glsl and gl_combine cvars (which are now read-only), use vid_gl13
and vid_gl20 to select a rendering path at startup

------------------------------------------------------------------------
r9574 | havoc | 2009-12-08 15:17:17 -0800 (Tue, 08 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_shared.c

some cleanup

------------------------------------------------------------------------
r9573 | havoc | 2009-12-08 14:58:52 -0800 (Tue, 08 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/vid_shared.c

minor cleanup

------------------------------------------------------------------------
r9572 | havoc | 2009-12-08 14:57:14 -0800 (Tue, 08 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/glquake.h

remove a couple useless lines

------------------------------------------------------------------------
r9571 | havoc | 2009-12-08 14:56:53 -0800 (Tue, 08 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

use gl_max_lightmapsize

------------------------------------------------------------------------
r9570 | havoc | 2009-12-08 14:56:20 -0800 (Tue, 08 Dec 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

added gl_max_lightmapsize
minor cleanup to TEXF_PICMIP handling

------------------------------------------------------------------------
r9569 | havoc | 2009-12-08 14:18:57 -0800 (Tue, 08 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

removed r_glsl_usegeneric cvar (always on now)

------------------------------------------------------------------------
r9568 | havoc | 2009-12-08 14:09:52 -0800 (Tue, 08 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

more cleanup

------------------------------------------------------------------------
r9567 | havoc | 2009-12-08 14:02:05 -0800 (Tue, 08 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

changed R_Mesh_TexCombine to use GL_COMBINE_ARB mode only when necessary

------------------------------------------------------------------------
r9566 | havoc | 2009-12-08 13:28:20 -0800 (Tue, 08 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

initialize GL state only once at video start, rather than every frame

------------------------------------------------------------------------
r9565 | havoc | 2009-12-08 13:17:13 -0800 (Tue, 08 Dec 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/r_shadow.c

removed R_Mesh_TexBind3D, R_Mesh_TexBindCubeMap, R_Mesh_TexBindRectangle
(now all code using these must use R_Mesh_TexBindAll)

------------------------------------------------------------------------
r9564 | havoc | 2009-12-07 20:42:15 -0800 (Mon, 07 Dec 2009) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/vid_shared.c

converted all code using gl_support_* variables to use vid.support.*
instead
a few other cleanups

------------------------------------------------------------------------
r9563 | havoc | 2009-12-07 20:33:18 -0800 (Mon, 07 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_explosion.c

don't upload a fog texture for explosion shells if r_loadfog is false

------------------------------------------------------------------------
r9562 | havoc | 2009-12-07 19:19:42 -0800 (Mon, 07 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c

increase _snd_mixahead to 0.15 to fix crackling sound on Vista

------------------------------------------------------------------------
r9561 | havoc | 2009-12-07 17:46:18 -0800 (Mon, 07 Dec 2009) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

moved gl_state definition higher in the code
replaced backendunits, backendimageunits, and backendarrayunits
references with vid.texunits, vid.teximageunits, vid.texarrayunits

------------------------------------------------------------------------
r9560 | havoc | 2009-12-07 17:25:38 -0800 (Mon, 07 Dec 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/snd_win.c

an attempt to fix waveOut sound on Vista
added snd_wav_partitionsize cvar (default 1024)

------------------------------------------------------------------------
r9559 | havoc | 2009-12-07 12:33:32 -0800 (Mon, 07 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h

remove unused tex1d parameters

------------------------------------------------------------------------
r9558 | havoc | 2009-12-07 12:28:17 -0800 (Mon, 07 Dec 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_shared.c

added vid.support struct containing extension detection flags, to
replace gl_support_* variables

------------------------------------------------------------------------
r9557 | havoc | 2009-12-07 12:25:57 -0800 (Mon, 07 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_agl.c

remove a vid.support line I did not intend to be in here

------------------------------------------------------------------------
r9556 | havoc | 2009-12-07 12:21:30 -0800 (Mon, 07 Dec 2009) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

R_UpdateTexture no longer calls R_RealGetTexture, and now causes a
Host_Error if the texture has not been precached already, this should
fix a crash with dpv video playback

------------------------------------------------------------------------
r9555 | havoc | 2009-12-07 12:09:08 -0800 (Mon, 07 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_textures.h

remove an unneeded comment

------------------------------------------------------------------------
r9554 | havoc | 2009-12-07 08:04:50 -0800 (Mon, 07 Dec 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_agl.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c

removed gl_videosyncavailable variable because on all known platforms it
is always true, and its only purpose was to ghost a menu item

------------------------------------------------------------------------
r9553 | havoc | 2009-12-07 08:00:13 -0800 (Mon, 07 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_shared.c

renamed gl_stencil to vid.stencil

------------------------------------------------------------------------
r9552 | havoc | 2009-12-07 07:50:45 -0800 (Mon, 07 Dec 2009) | 4 lines
Changed paths:
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_agl.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_null.c
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c

changed VID_InitMode to take a viddef_mode_t structure which contains
the desired parameters, and allows it to modify them (previously only
width/height could be modified)

------------------------------------------------------------------------
r9551 | havoc | 2009-12-07 07:35:03 -0800 (Mon, 07 Dec 2009) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

load fog textures in all cases again
load gloss/normalmap based on hardware capabilities, rather than r_glsl
and gl_combine cvars

------------------------------------------------------------------------
r9550 | havoc | 2009-12-07 07:27:09 -0800 (Mon, 07 Dec 2009) | 10 lines
Changed paths:
   M /trunk/darkplaces/cl_gecko.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/model_sprite.c
   M /trunk/darkplaces/palette.c
   M /trunk/darkplaces/palette.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_textures.h
   M /trunk/darkplaces/render.h

mdl skin loading is now more memory-efficient (now stores the original
pixels and uploads textures on demand - many skins are never used, so
this saves some system memory)
added palette_featureflags[] for use by mdl skin loading
added TEXF_PRECACHE to all texture uploads that did not use it
added skinframe->hasalpha flag to clean up code
removed R_TextureHasAlpha function
r_glsl 1 no longer uploads fog textures
r_glsl 0, gl_combine 0 no longer loads gloss/normalmaps

------------------------------------------------------------------------
r9549 | divverent | 2009-12-07 06:48:55 -0800 (Mon, 07 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

scr_loadingscreen_background cvar: when set, show loading screen with previous background, when not set, show loading screen on black screen

------------------------------------------------------------------------
r9548 | havoc | 2009-12-07 06:18:15 -0800 (Mon, 07 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_shared.c

fix a warning (gl_driver is not a pointer)

------------------------------------------------------------------------
r9547 | divverent | 2009-12-06 10:51:22 -0800 (Sun, 06 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

if gridsize is parsed wrong and DP would normally abort when loading the map, instead make it ignore the lightgrid and spit out a warning

------------------------------------------------------------------------
r9546 | divverent | 2009-12-06 10:48:16 -0800 (Sun, 06 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

parse gridsize like q3map2 does (less strict)

------------------------------------------------------------------------
r9545 | divverent | 2009-12-06 09:58:43 -0800 (Sun, 06 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

we cannot skip the next 3 vars after encounting a vector - so we instead have to filter for names that end with _x, _y or _z. Sucks.

------------------------------------------------------------------------
r9544 | divverent | 2009-12-06 05:09:55 -0800 (Sun, 06 Dec 2009) | 12 lines
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

now autocvars can have default values when the progs are compiled with fteqcc
or a similar compiler:

var float autocvar_foo = 3;
var string autocvar_whatever = "foo";

will create the cvar with value 3, or foo, if it does not exist, and otherwise
take over the value from the cvar into the global.

NOTE: THE var KEYWORD IS NECESSARY HERE! NOT USING IT MEANS THE COMPILER WILL
MERGE WITH CONSTANTS, AND YIELD VERY UNFUNNY RESULTS!

------------------------------------------------------------------------
r9543 | divverent | 2009-12-06 04:06:16 -0800 (Sun, 06 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

forgot the downtrace cvar

------------------------------------------------------------------------
r9542 | divverent | 2009-12-05 12:18:23 -0800 (Sat, 05 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_phys.c

turn this into sv_gameplayfix_downtracesupportsongroundflag

------------------------------------------------------------------------
r9541 | divverent | 2009-12-05 12:14:22 -0800 (Sat, 05 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

fix onground clearing by ANDing it with a downtrace by 1 unit - this does NOT cause any doublejump bugs, as it is just for CLEARING the onground flag, and fixes problems with short moves (high netfps)

------------------------------------------------------------------------
r9540 | divverent | 2009-12-05 11:04:20 -0800 (Sat, 05 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/sv_phys.c

fix endposnudge

------------------------------------------------------------------------
r9539 | vortex | 2009-12-05 09:49:50 -0800 (Sat, 05 Dec 2009) | 1 line
Changed paths:
   M /trunk/darkplaces/vid_shared.c

Add several gl_info_ cvars which holds gl_vendor, gl_driver, gl_platform, extensions found by engine and some other. QC can read them and use. Example of use: locking or restricting certain controls in menu if feature is not supported.
------------------------------------------------------------------------
r9538 | divverent | 2009-12-05 07:33:56 -0800 (Sat, 05 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cvar.c
   M /trunk/darkplaces/cvar.h
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/svvm_cmds.c

DP_QC_AUTOCVARS: declare a QC variable float/vector/string autocvar_foo, and it will always reflect the cvar "foo" when read

------------------------------------------------------------------------
r9537 | havoc | 2009-12-04 08:13:26 -0800 (Fri, 04 Dec 2009) | 7 lines
Changed paths:
   M /trunk/darkplaces/collision.c
   M /trunk/darkplaces/sv_main.c

fixed a bug with sv_gameplayfix_nudgeoutofsolid where the player might
get put on the opposite side of a brush because of being very near the
plane that should be used for nudging, which caused it not to be
considered as a nudging plane
added some checks to ensure more consistency on trace direction (should
be able to swap start and end without startsolid trouble, at least less)

------------------------------------------------------------------------
r9536 | havoc | 2009-12-04 08:11:14 -0800 (Fri, 04 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix Mem_Free NULL pointer warnings

------------------------------------------------------------------------
r9535 | divverent | 2009-12-04 04:32:45 -0800 (Fri, 04 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/collision.c
   M /trunk/darkplaces/collision.h
   M /trunk/darkplaces/sv_phys.c

make the endpos-in-solid workaround a cvar collision_endposnudge

------------------------------------------------------------------------
r9534 | havoc | 2009-12-03 22:29:45 -0800 (Thu, 03 Dec 2009) | 5 lines
Changed paths:
   M /trunk/darkplaces/collision.h

disable COLLISION_STUPID_TRACE_ENDPOS_IN_SOLID_WORKAROUND because it
breaks quake (radius damage is not affecting exploboxes if the rocket is
shot at a wall - but does work if shot at the floor, proximity mines in
mission pack 1 don't stick to walls, only floors)

------------------------------------------------------------------------
r9533 | havoc | 2009-12-03 21:51:37 -0800 (Thu, 03 Dec 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/prvm_execprogram.h

clean up field offset handling a bit, now uses vec_t instead of float,
and does not assume anything about the size of it

------------------------------------------------------------------------
r9532 | havoc | 2009-12-03 19:50:55 -0800 (Thu, 03 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

remove const qualifiers on Mem_Free calls on r_surfacelist

------------------------------------------------------------------------
r9531 | havoc | 2009-12-01 20:21:33 -0800 (Tue, 01 Dec 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

add support for a filename parameter on screenshot command

------------------------------------------------------------------------
r9530 | havoc | 2009-11-29 09:19:08 -0800 (Sun, 29 Nov 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

added a few more CHECKGLERROR lines, and the possibility of not having
qglPolygonStipple

------------------------------------------------------------------------
r9529 | havoc | 2009-11-29 09:05:26 -0800 (Sun, 29 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/r_textures.h
   M /trunk/darkplaces/vid_shared.c

removed 1D texture management code, not used by anything

------------------------------------------------------------------------
r9528 | havoc | 2009-11-29 03:16:25 -0800 (Sun, 29 Nov 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/zone.c
   M /trunk/darkplaces/zone.h

added Mem_Memalign function
added Mem_Realloc function

------------------------------------------------------------------------
r9527 | vortex | 2009-11-28 16:49:51 -0800 (Sat, 28 Nov 2009) | 1 line
Changed paths:
   M /trunk/darkplaces/sbar.c

GAME_BLOODOMNICIDE: disable quake gfx precaches
------------------------------------------------------------------------
r9526 | vortex | 2009-11-28 16:31:15 -0800 (Sat, 28 Nov 2009) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

r_replacemaptexture: no printings for GAME_BLOODOMNICIDE
------------------------------------------------------------------------
r9525 | havoc | 2009-11-28 01:02:11 -0800 (Sat, 28 Nov 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/lhnet.c

compile without IPV6 support by default (-DSUPPORTIPV6 to reenable) for
better platform compatibility

------------------------------------------------------------------------
r9524 | havoc | 2009-11-27 07:31:58 -0800 (Fri, 27 Nov 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

more work on mod_generatelightmaps:
don't accept lights behind a surface, they mess up shading

------------------------------------------------------------------------
r9523 | havoc | 2009-11-27 07:18:56 -0800 (Fri, 27 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

changed mod_generatelightmaps_* cvar defaults to better settings

------------------------------------------------------------------------
r9522 | havoc | 2009-11-27 07:15:34 -0800 (Fri, 27 Nov 2009) | 5 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

more work on mod_generatelightmaps:
now uses svbsp shadow testing instead of traceline, much faster
fixed several bugs in lightmap/lightgrid brightness and tuned parameters
to match realtime lighting as closely as possible

------------------------------------------------------------------------
r9521 | havoc | 2009-11-27 02:29:15 -0800 (Fri, 27 Nov 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/r_shadow.c

more work on mod_generatelightmaps:
migrated light sampling code from r_shadow.c to model_shared.c

------------------------------------------------------------------------
r9520 | havoc | 2009-11-27 01:21:50 -0800 (Fri, 27 Nov 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/r_shadow.c

more work on mod_generatedlightmaps:
implemented multi-sample raytraced shadows (SLOW!)

------------------------------------------------------------------------
r9519 | havoc | 2009-11-26 23:42:13 -0800 (Thu, 26 Nov 2009) | 4 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/r_shadow.c

more work on mod_generatelightmaps:
calculate bent normal for light dir instead of trying to convert sh1
use half-angle shading (soft lighting) instead of hard shading

------------------------------------------------------------------------
r9518 | havoc | 2009-11-26 02:55:15 -0800 (Thu, 26 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

more work on mod_generatelightmaps

------------------------------------------------------------------------
r9517 | havoc | 2009-11-24 04:23:53 -0800 (Tue, 24 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/r_shadow.c

more work on mod_generatelightmaps

------------------------------------------------------------------------
r9516 | havoc | 2009-11-24 01:48:23 -0800 (Tue, 24 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/r_shadow.c

mod_generatelightmaps is much closer to usable now

------------------------------------------------------------------------
r9515 | havoc | 2009-11-23 22:09:22 -0800 (Mon, 23 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h

more work on mod_generatelightmaps command

------------------------------------------------------------------------
r9514 | divverent | 2009-11-22 23:47:20 -0800 (Sun, 22 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

fix another typo

------------------------------------------------------------------------
r9513 | divverent | 2009-11-22 22:36:45 -0800 (Sun, 22 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c

fix typo

------------------------------------------------------------------------
r9512 | divverent | 2009-11-22 22:36:19 -0800 (Sun, 22 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/snd_main.c

fix sound spatialization of edited sounds

------------------------------------------------------------------------
r9511 | havoc | 2009-11-22 14:57:55 -0800 (Sun, 22 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

beginning work on mod_generatelightmaps command

------------------------------------------------------------------------
r9510 | havoc | 2009-11-22 13:06:10 -0800 (Sun, 22 Nov 2009) | 7 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/collision.c
   M /trunk/darkplaces/collision.h
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/csprogs.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/r_lerpanim.c
   M /trunk/darkplaces/r_lerpanim.h
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/svvm_cmds.c
   M /trunk/darkplaces/world.c

implemented FTE_CSQC_SKELETONOBJECTS (clientside support)
implemented DP_SKELETONOBJECTS (serverside support)
reworked all tag queries to support animation lerp and skeletonindex
MOVE_HITMODEL / SOLID_BSP now support animation lerp and skeletonindex
server qc now has identical animation fields to that of csqc (engine
networking still only networks .frame however)

------------------------------------------------------------------------
r9508 | divverent | 2009-11-21 07:03:21 -0800 (Sat, 21 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/collision.c
   M /trunk/darkplaces/model_brush.c

patches: experimental mode that allows setting collision stride to -1 to avoid ANY bounding box tests on curves. Slows down things a lot, merely for debugging to see whether the bbox test may cause any harm.

------------------------------------------------------------------------
r9507 | havoc | 2009-11-19 21:43:07 -0800 (Thu, 19 Nov 2009) | 8 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_rmain.c

reworked decal system to limit the number of decal splats active at once
rather than simply allowing things to timeout, this does not directly
limit the number of triangles (because decal events on models may
produce hundreds or thousands of triangles) but it does reduce
worst-case performance issues
implemented compacting code for the new decal system, so there are no
wasted triangles when decals expire

------------------------------------------------------------------------
r9506 | havoc | 2009-11-19 18:04:59 -0800 (Thu, 19 Nov 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix crash on Nexuiz demos/demo2 with new decal system enabled - now
defers new decal splats until the rendering code

------------------------------------------------------------------------
r9505 | havoc | 2009-11-17 14:48:08 -0800 (Tue, 17 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/csprogs.c

fix typo in lerpfrac fix

------------------------------------------------------------------------
r9504 | havoc | 2009-11-17 11:04:26 -0800 (Tue, 17 Nov 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

added timedemo_screenshotframelist cvar which lets you take screenshots
on specific frames during a timedemo, for image quality comparisons

------------------------------------------------------------------------
r9503 | havoc | 2009-11-17 10:28:44 -0800 (Tue, 17 Nov 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

implemented special showfps display of timedemo statistics while running
a timedemo (or the -benchmark option)

------------------------------------------------------------------------
r9502 | havoc | 2009-11-17 06:49:48 -0800 (Tue, 17 Nov 2009) | 6 lines
Changed paths:
   M /trunk/darkplaces/csprogs.c

fixed a bug with CSQC compatibility - .lerpfrac was wrong, it should
control blend strength of .frame2 but it controlled .frame instead,
which meant that mods with .lerpfrac at the default (0) value would
always have to set .frame2 as well as .frame to the same frame, which
was not the intention of the spec

------------------------------------------------------------------------
r9501 | divverent | 2009-11-17 06:31:29 -0800 (Tue, 17 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/netconn.h
   M /trunk/darkplaces/prvm_cmds.c

fix typo in extresponse handling

------------------------------------------------------------------------
r9499 | divverent | 2009-11-15 11:31:15 -0800 (Sun, 15 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/svvm_cmds.c

first preliminary version of DP_SND_SETPARAMS: let sound() calls with sample set to "" modify an existing sound on the given entity and channel

------------------------------------------------------------------------
r9498 | divverent | 2009-11-14 15:39:26 -0800 (Sat, 14 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/netconn.h
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.h
   M /trunk/darkplaces/svvm_cmds.c

extresponse: make svqc receive only those on the server socket, and csqc/menuqc only receive those on the client socket

------------------------------------------------------------------------
r9496 | divverent | 2009-11-14 15:08:37 -0800 (Sat, 14 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/world.c

ODE: add two missing symbols

------------------------------------------------------------------------
r9494 | divverent | 2009-11-14 14:58:44 -0800 (Sat, 14 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

extresponse: use double quotes, not single quotes, for the IP (makes ALL tokenizers happy)

------------------------------------------------------------------------
r9493 | divverent | 2009-11-14 14:40:32 -0800 (Sat, 14 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

put extresponse in server vm too

------------------------------------------------------------------------
r9492 | divverent | 2009-11-14 13:39:35 -0800 (Sat, 14 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/image.c

experimental feature to load the alpha channel of foo.jpg from foo_alpha.jpg (JPEG specific) to allow transparency even when using JPEG

------------------------------------------------------------------------
r9491 | havoc | 2009-11-14 11:30:37 -0800 (Sat, 14 Nov 2009) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/csprogs.c

make csqc render entities persistent (except the temp ones created by a
builtin), this enables r_cullentities_trace again on most csqc entities,
and allows decals to stick to csqc entities

------------------------------------------------------------------------
r9490 | havoc | 2009-11-14 11:28:56 -0800 (Sat, 14 Nov 2009) | 6 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/gl_rmain.c

no longer checking texture_t->currentalpha < 1 in
R_DecalSystem_SplatEntity because it is falsely (?) failing to apply
decals to player models in Nexuiz
added cl_decals_newsystem_intensitymultiplier cvar (default 2) to make
decals more visible

------------------------------------------------------------------------
r9489 | havoc | 2009-11-14 07:19:08 -0800 (Sat, 14 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/quakedef.h

increase some limits in DP_SMALLMEMORY

------------------------------------------------------------------------
r9488 | havoc | 2009-11-14 06:06:50 -0800 (Sat, 14 Nov 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/snd_3dras.c
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_main.h
   M /trunk/darkplaces/snd_modplug.c
   M /trunk/darkplaces/snd_ogg.c

always stream decode ogg, this reduces Nexuiz sound memory usage even
more

------------------------------------------------------------------------
r9487 | havoc | 2009-11-13 18:08:16 -0800 (Fri, 13 Nov 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/snd_main.h
   M /trunk/darkplaces/snd_mem.c
   M /trunk/darkplaces/snd_modplug.c
   M /trunk/darkplaces/snd_ogg.c

reduced memory usage of sound in Nexuiz by about 70MB by using shorter
ogg/modplug buffers

------------------------------------------------------------------------
r9486 | havoc | 2009-11-13 17:09:09 -0800 (Fri, 13 Nov 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/draw.h
   M /trunk/darkplaces/gl_draw.c

automatically load/unload cachepic_t textures from disk on demand, this
drops Nexuiz memory usage (and texture memory usage) by a huge amount

------------------------------------------------------------------------
r9485 | havoc | 2009-11-13 14:01:28 -0800 (Fri, 13 Nov 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/quakedef.h

increase MAX_CACHED_PICS in DP_SMALLMEMORY case back to the normal
level, it simply can't be reduced

------------------------------------------------------------------------
r9484 | havoc | 2009-11-13 13:47:36 -0800 (Fri, 13 Nov 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

avoid a memory allocation on each directly uploaded texture
resize deferred upload textures before storage if possible

------------------------------------------------------------------------
r9483 | havoc | 2009-11-13 12:09:49 -0800 (Fri, 13 Nov 2009) | 5 lines
Changed paths:
   M /trunk/darkplaces/zone.c
   M /trunk/darkplaces/zone.h

rewrote clump allocation system, added an experimental global clump
(note: clumping is still not on by default, and probably never will be)
reworked sentinel code to always use the MEMPARANOIA approach
(address-dependent sentinels)

------------------------------------------------------------------------
r9482 | havoc | 2009-11-13 11:26:44 -0800 (Fri, 13 Nov 2009) | 4 lines
Changed paths:
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/image.c

don't call Mem_CheckSentinelsGlobal in image loaders (wastes time)
call Mem_CheckSentinelsGlobal every frame if developer_memorydebug cvar
is on (or MEMPARANOIA is on)

------------------------------------------------------------------------
r9481 | havoc | 2009-11-13 10:46:34 -0800 (Fri, 13 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix two typos in last commit

------------------------------------------------------------------------
r9480 | havoc | 2009-11-13 10:45:54 -0800 (Fri, 13 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_rmain.c

separate handling of num_pvsclusterbytes in ViewCache code

------------------------------------------------------------------------
r9479 | havoc | 2009-11-13 03:14:41 -0800 (Fri, 13 Nov 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/quakedef.h

bump a few limits in DP_SMALLMEMORY (cachedpics was too low for even
Quake...)

------------------------------------------------------------------------
r9478 | havoc | 2009-11-12 06:00:48 -0800 (Thu, 12 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

move R_Main_ResizeViewCache call to fix a crash

------------------------------------------------------------------------
r9477 | havoc | 2009-11-12 05:01:02 -0800 (Thu, 12 Nov 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

no longer uses trace culling on csqc entities and other temp entities,
because they flicker too much

------------------------------------------------------------------------
r9476 | havoc | 2009-11-12 05:00:41 -0800 (Thu, 12 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/client.h

always VIEWCACHEDYNAMIC

------------------------------------------------------------------------
r9475 | havoc | 2009-11-12 04:58:14 -0800 (Thu, 12 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

resize view cache each frame instead of at newmap

------------------------------------------------------------------------
r9474 | havoc | 2009-11-12 04:44:23 -0800 (Thu, 12 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/quakedef.h

fix crash with predicted player locations

------------------------------------------------------------------------
r9473 | havoc | 2009-11-12 02:44:33 -0800 (Thu, 12 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_rsurf.c

fix bug with VIEWCACHEDYNAMIC

------------------------------------------------------------------------
r9472 | havoc | 2009-11-12 02:36:34 -0800 (Thu, 12 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_rmain.c

disable dynamic viewcache until bugs are fixed

------------------------------------------------------------------------
r9471 | havoc | 2009-11-12 02:30:20 -0800 (Thu, 12 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cvar.c

fix crash if CVAR_HASHSIZE was set to a value below 65536

------------------------------------------------------------------------
r9470 | havoc | 2009-11-11 14:55:40 -0800 (Wed, 11 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/collision.c

set the isaabb/hasaabbplanes fields on box brushes

------------------------------------------------------------------------
r9469 | havoc | 2009-11-11 11:54:45 -0800 (Wed, 11 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

reduce gl_rmain size a bit

------------------------------------------------------------------------
r9468 | havoc | 2009-11-11 08:40:26 -0800 (Wed, 11 Nov 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/render.h

rename R_MAX_OCCLUSION_QUERIES to MAX_OCCLUSION_QUERIES and move it to
quakedef.h

------------------------------------------------------------------------
r9467 | havoc | 2009-11-11 08:04:42 -0800 (Wed, 11 Nov 2009) | 4 lines
Changed paths:
   M /trunk/darkplaces/bspfile.h
   M /trunk/darkplaces/cd_shared.c
   M /trunk/darkplaces/cl_dyntexture.h
   M /trunk/darkplaces/cl_gecko.h
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_video.h
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/cvar.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/menu.h
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_modules.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_main.h
   M /trunk/darkplaces/svvm_cmds.c

migrated a large number of #define MAX values to quakedef.h and added a
#ifdef DP_SMALLMEMORY case which drops darkplaces-sdl from 42MB to 24MB
of reserved space (according to size command)

------------------------------------------------------------------------
r9466 | havoc | 2009-11-11 06:09:34 -0800 (Wed, 11 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

more work on the unfinished OBJ loading

------------------------------------------------------------------------
r9465 | havoc | 2009-11-11 06:09:08 -0800 (Wed, 11 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

some optimizations to model decals

------------------------------------------------------------------------
r9464 | havoc | 2009-11-11 06:08:41 -0800 (Wed, 11 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

better to use NET_MAXMESSAGE than 65536 for download buffering

------------------------------------------------------------------------
r9463 | havoc | 2009-11-11 06:08:17 -0800 (Wed, 11 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.h

comments

------------------------------------------------------------------------
r9462 | havoc | 2009-11-11 05:25:58 -0800 (Wed, 11 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/zone.h

improving MEMCLUMP handling

------------------------------------------------------------------------
r9461 | divverent | 2009-11-09 00:34:31 -0800 (Mon, 09 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

fix typo

------------------------------------------------------------------------
r9460 | havoc | 2009-11-08 14:04:38 -0800 (Sun, 08 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt

correct a typo in the ogg cdtracks installation instructions

------------------------------------------------------------------------
r9459 | havoc | 2009-11-08 11:57:10 -0800 (Sun, 08 Nov 2009) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/gl_rmain.c

added r_farclip_base and r_farclip_world cvars to control farclip
distance, also affects sky fogging, changed base from 4096 to 65536
added cl_decals_models cvar to decide whether to apply decals to non-bsp
models (requires cl_decals_newsystem 1)

------------------------------------------------------------------------
r9458 | havoc | 2009-11-08 11:14:11 -0800 (Sun, 08 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/world.c

fix typo in #ifdef ODE_DYNAMIC

------------------------------------------------------------------------
r9457 | havoc | 2009-11-08 10:45:59 -0800 (Sun, 08 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/render.h

fix bug with alt textures (pressed buttons in q1bsp)

------------------------------------------------------------------------
r9456 | divverent | 2009-11-08 10:01:05 -0800 (Sun, 08 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.h
   M /trunk/darkplaces/svvm_cmds.c

logarithm

------------------------------------------------------------------------
r9455 | havoc | 2009-11-08 09:06:13 -0800 (Sun, 08 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/render.h

new decal system (cl_decals_newsystem 1 to activate)

------------------------------------------------------------------------
r9454 | divverent | 2009-11-07 10:03:15 -0800 (Sat, 07 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

clmovement: do not replay less than 0.5ms sized movement data (should prevent NaNs)

------------------------------------------------------------------------
r9453 | divverent | 2009-11-07 05:09:06 -0800 (Sat, 07 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/csprogs.c

more error code fixing

------------------------------------------------------------------------
r9452 | divverent | 2009-11-07 05:04:52 -0800 (Sat, 07 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/csprogs.h

fix typo compile erorr

------------------------------------------------------------------------
r9451 | divverent | 2009-11-07 05:01:47 -0800 (Sat, 07 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/csprogs.h

more stupid error code passing

------------------------------------------------------------------------
r9450 | divverent | 2009-11-07 04:56:20 -0800 (Sat, 07 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/csprogs.c

and fix a NULL pointer causing typo...

------------------------------------------------------------------------
r9449 | divverent | 2009-11-07 04:54:39 -0800 (Sat, 07 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/csprogs.c

fix gettagmatrix error handling

------------------------------------------------------------------------
r9448 | divverent | 2009-11-07 04:47:29 -0800 (Sat, 07 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/csprogs.h

try fixing gettaginfo in client with frameblend etc. stuff

------------------------------------------------------------------------
r9447 | divverent | 2009-11-07 04:46:55 -0800 (Sat, 07 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

better default for fog

------------------------------------------------------------------------
r9446 | divverent | 2009-11-07 03:41:38 -0800 (Sat, 07 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cvar.c

prevent creation of a cvar named "", as that breaks cvar()

------------------------------------------------------------------------
r9445 | divverent | 2009-11-07 03:39:04 -0800 (Sat, 07 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/keys.c

add a comment to bind writing

------------------------------------------------------------------------
r9444 | divverent | 2009-11-07 03:37:56 -0800 (Sat, 07 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cvar.c

fix config.cfg writing (properly escape cvar names and values) to fix seta exploits

------------------------------------------------------------------------
r9443 | havoc | 2009-11-07 02:52:58 -0800 (Sat, 07 Nov 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_lightning.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/r_sprites.c
   M /trunk/darkplaces/render.h

laid groundwork for a new decal system
added color4f parameter to RSurf_ActiveCustomEntity

------------------------------------------------------------------------
r9442 | divverent | 2009-11-06 10:55:36 -0800 (Fri, 06 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

equalization: reduce min ambient, it was too high

------------------------------------------------------------------------
r9441 | havoc | 2009-11-06 07:05:39 -0800 (Fri, 06 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/r_lightning.c

fix a couple merging bugs

------------------------------------------------------------------------
r9440 | havoc | 2009-11-06 07:03:49 -0800 (Fri, 06 Nov 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

reenabled fake lightmap on water to fix r_glsl 0 rendering of water in
q1bsp

------------------------------------------------------------------------
r9439 | havoc | 2009-11-06 06:24:21 -0800 (Fri, 06 Nov 2009) | 4 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

fix two bugs introduced in r5828 (2005-11-25) that made monsters and
corpses slide off of groundentity
thanks to negke for reporting this bug and assisting in identifying it

------------------------------------------------------------------------
r9438 | havoc | 2009-11-06 05:22:20 -0800 (Fri, 06 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_lightning.c

remove some dead code

------------------------------------------------------------------------
r9437 | havoc | 2009-11-06 05:08:39 -0800 (Fri, 06 Nov 2009) | 9 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_lightning.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/r_sprites.c
   M /trunk/darkplaces/render.h

implemented fog height setting, along with fade depth setting - global
fog now has a ceiling and a gradient fade to prevent harsh artifacts at
the transition line
reworked sky rendering to accept fog by using the surface renderer
reworked sprite rendering to use the surface renderer
reworked corona rendering to use the surface renderer
reworked fogging a bit on nomodel entities
eliminated R_DrawSprite

------------------------------------------------------------------------
r9436 | havoc | 2009-11-06 05:05:26 -0800 (Fri, 06 Nov 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/render.h

msurface_t pointer arrays are now const, as are the vertex arrays in
rsurface

------------------------------------------------------------------------
r9435 | havoc | 2009-11-06 04:52:06 -0800 (Fri, 06 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

use larger batches for shadowmaps

------------------------------------------------------------------------
r9434 | havoc | 2009-11-06 04:49:09 -0800 (Fri, 06 Nov 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/draw.h
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_sky.c

renamed polygonelements, skyboxelements, skysphereelements, to add 3s
and 3i versions of each, since most processing functions need 3i

------------------------------------------------------------------------
r9433 | havoc | 2009-11-06 04:33:31 -0800 (Fri, 06 Nov 2009) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/r_lightning.c
   M /trunk/darkplaces/render.h

added fogging info to rsurface state so model scaling applies to fog
cleanup of EF_ bit checks in renderer - now only uses RENDER_ flags
eliminated reliance on rsurface.entity in most rendering code, now
mirrors the few important fields in rsurface state

------------------------------------------------------------------------
r9432 | havoc | 2009-11-06 04:30:54 -0800 (Fri, 06 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

fix compile error

------------------------------------------------------------------------
r9431 | havoc | 2009-11-06 03:49:32 -0800 (Fri, 06 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/render.h

changed sky rendering to occur after depthmask polygons, instead of before

------------------------------------------------------------------------
r9430 | havoc | 2009-11-06 03:42:21 -0800 (Fri, 06 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/render.h

added R_SkinFrame_LoadInternal8bit

------------------------------------------------------------------------
r9429 | havoc | 2009-11-06 03:36:27 -0800 (Fri, 06 Nov 2009) | 4 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/r_modules.c

reworked R_SkinFrame_Purge handling to encapsulate all modules, not just
the model system, this allows skinframes to be persistent across levels
without being associated with a model

------------------------------------------------------------------------
r9428 | havoc | 2009-11-06 03:16:10 -0800 (Fri, 06 Nov 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

allow non-standard sizes for quake sky textures (anything with two
square images side by side will work, width must be 2x height)

------------------------------------------------------------------------
r9427 | havoc | 2009-11-06 03:09:22 -0800 (Fri, 06 Nov 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/matrixlib.c

reworked Matrix4x4_TransformPositivePlane and
Matrix4x4_TransformStandardPlane to preserve unit length normal

------------------------------------------------------------------------
r9426 | divverent | 2009-11-06 00:14:12 -0800 (Fri, 06 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

light equalizing: minimum ambient level feature (prevents dark players in diffuselit-only areas when seen from the dark side)

------------------------------------------------------------------------
r9425 | divverent | 2009-11-05 23:00:06 -0800 (Thu, 05 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/protocol.h

entity light equalization as an alternative rendering of EF_FULLBRIGHT entities. Enable with r_equalize_entities_fullbright 1.

------------------------------------------------------------------------
r9424 | divverent | 2009-11-05 13:56:35 -0800 (Thu, 05 Nov 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

fix coronas for "realtime darks"
fix gl_flashblend

------------------------------------------------------------------------
r9423 | divverent | 2009-11-05 13:33:03 -0800 (Thu, 05 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/r_shadow.c

support for "realtime world/dynamic darks". Just for fun. Should impact nothing else, as it is just removing one check and adding a special case for negative light color values, which should be never happening in existing code.

------------------------------------------------------------------------
r9422 | divverent | 2009-11-03 13:14:10 -0800 (Tue, 03 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cvar.c

you can go hunter2 my hunter2-ing hunter2 (comment joke, sorry, had to be)

------------------------------------------------------------------------
r9421 | divverent | 2009-11-03 13:12:19 -0800 (Tue, 03 Nov 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/cvar.c

hide private cvars from the output of cvar name and cvarlist commands to prevent password sniffing by evil CSQC
tab completion still shows their value because that cannot be triggered by CSQC code

------------------------------------------------------------------------
r9420 | divverent | 2009-11-03 13:04:39 -0800 (Tue, 03 Nov 2009) | 20 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/netconn.c

first test of multi-account rcon:

	rcon_password "account1:1234 account2:2345"

Any of the space separated passwords can be matched - the string before the :
in each 'password' is printed to the log. So if that is set, clients can send
commands both with rcon_password "account1:1234" as well as with rcon_password
"account2:2345".

Fully backwards compatible: if rcon_password contains no space, user name
printing is not performed to keep the logs clean.

Also supported for rcon_restricted of course.

NOTE: anyone with rcon_password can read the passwords of the others by simply
sending the command "rcon_password". Of course this will get logged, but makes
all other passwords pointless. Better use this system only for RESTRICTED rcon,
is what I am saying. And WATCH YOUR LOGS.


------------------------------------------------------------------------
r9419 | havoc | 2009-11-02 21:29:39 -0800 (Mon, 02 Nov 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/r_lightning.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/render.h

replace FogPoint_* functions with RSurf_FogVertex
rename rsurface.modelorg to rsurface.localvieworigin

------------------------------------------------------------------------
r9418 | havoc | 2009-11-02 21:26:00 -0800 (Mon, 02 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/collision.h

remove prototypes for a couple functions that were removed

------------------------------------------------------------------------
r9417 | havoc | 2009-11-02 20:58:15 -0800 (Mon, 02 Nov 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/collision.c
   M /trunk/darkplaces/collision.h
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c

implemented a new preallocated "boxbrush" type for use with
Collision_BrushForBox rather than reusing a cyclic array

------------------------------------------------------------------------
r9416 | havoc | 2009-11-02 20:20:42 -0800 (Mon, 02 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/collision.c
   M /trunk/darkplaces/collision.h
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c

optimized AABB collision case for q3bsp, 14.5% faster than r9398

------------------------------------------------------------------------
r9415 | havoc | 2009-11-02 14:48:27 -0800 (Mon, 02 Nov 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/collision.c

optimized edgedir handling to use half as many, which reduces it from
84 tests per trace for box vs box, to 30

------------------------------------------------------------------------
r9414 | havoc | 2009-11-01 17:15:50 -0800 (Sun, 01 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/lhnet.c

fix USE_WSPIAPI_H

------------------------------------------------------------------------
r9413 | havoc | 2009-11-01 17:14:28 -0800 (Sun, 01 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile

another attempt at WIN32RELEASE

------------------------------------------------------------------------
r9412 | havoc | 2009-11-01 17:13:39 -0800 (Sun, 01 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile

another attempt at WIN32RELEASE

------------------------------------------------------------------------
r9411 | havoc | 2009-11-01 17:07:07 -0800 (Sun, 01 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile

fix WIN32RELEASE check

------------------------------------------------------------------------
r9410 | havoc | 2009-11-01 17:04:04 -0800 (Sun, 01 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile

adding a WIN32RELEASE flag which uses my build options

------------------------------------------------------------------------
r9409 | havoc | 2009-11-01 16:43:04 -0800 (Sun, 01 Nov 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/lhnet.c

fix compatibility with old windows versions when USE_WSPIAPI_H is
defined

------------------------------------------------------------------------
r9408 | havoc | 2009-11-01 15:07:12 -0800 (Sun, 01 Nov 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c

add a little bias to prevent constant contact cases with sv_gameplayfix_nudgeoutofsolid

------------------------------------------------------------------------
r9403 | divverent | 2009-10-30 11:10:15 -0700 (Fri, 30 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c

fix bug with bogus refresh rate info in xvidmode data

------------------------------------------------------------------------
r9402 | divverent | 2009-10-30 11:01:32 -0700 (Fri, 30 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/sys_linux.c

fix stupid console input bug

------------------------------------------------------------------------
r9401 | divverent | 2009-10-26 00:14:10 -0700 (Mon, 26 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.inc

fix makefile bug of DP_ODE_STATIC_LIBDIR combined with double-precision ODE

------------------------------------------------------------------------
r9400 | havoc | 2009-10-25 06:47:37 -0700 (Sun, 25 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/collision.c
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c

implemented sv_gameplayfix_nudgeoutofsolid

------------------------------------------------------------------------
r9399 | havoc | 2009-10-24 21:41:01 -0700 (Sat, 24 Oct 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/collision.c
   M /trunk/darkplaces/collision.h
   M /trunk/darkplaces/model_brush.c

reworked brush collisions to support edgedir cross products, this should
improve collisions with curves and triangle meshes in general

------------------------------------------------------------------------
r9398 | eihrul | 2009-10-24 13:49:47 -0700 (Sat, 24 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/r_shadow.c

sanity checks on shadowmap size relative to border size

------------------------------------------------------------------------
r9397 | divverent | 2009-10-24 10:42:41 -0700 (Sat, 24 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/world.c

fix handling of entities which change movetype at runtime

------------------------------------------------------------------------
r9396 | divverent | 2009-10-24 09:38:15 -0700 (Sat, 24 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.h
   M /trunk/darkplaces/svvm_cmds.c

DP_QC_ENTITYSTRING: menu builtins like reading/writing whole entities -> svqc, csqc too

------------------------------------------------------------------------
r9395 | divverent | 2009-10-24 07:27:02 -0700 (Sat, 24 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/world.c

ODE code cleanup; WARNING: interface change. Springs done with movedir need to be changed from movedir "x y z" to "x z 0" in your maps (the parameter y was previously unused).

------------------------------------------------------------------------
r9394 | divverent | 2009-10-24 05:30:31 -0700 (Sat, 24 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/world.c

add a missing VectorClear

------------------------------------------------------------------------
r9393 | havoc | 2009-10-23 11:26:25 -0700 (Fri, 23 Oct 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix a serious bug in R_Mesh_AddBrushMeshFromPlanes with maxdist not
using fabs

------------------------------------------------------------------------
r9392 | divverent | 2009-10-23 06:57:50 -0700 (Fri, 23 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/world.c

add support for fixed joints (jointtype -1), debug only according to ODE docs

------------------------------------------------------------------------
r9391 | divverent | 2009-10-23 06:23:17 -0700 (Fri, 23 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/world.c

fix FLT_MAX on visual studio sucky compiler

------------------------------------------------------------------------
r9390 | divverent | 2009-10-23 06:06:05 -0700 (Fri, 23 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/world.c

add missing dInfinity

------------------------------------------------------------------------
r9389 | divverent | 2009-10-23 06:03:02 -0700 (Fri, 23 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/world.c

add two missing functions

------------------------------------------------------------------------
r9388 | divverent | 2009-10-23 06:01:52 -0700 (Fri, 23 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/world.c

more ODE fixes

------------------------------------------------------------------------
r9387 | divverent | 2009-10-23 02:11:54 -0700 (Fri, 23 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/world.c

make ODE entities call touch functions

------------------------------------------------------------------------
r9386 | divverent | 2009-10-23 00:07:42 -0700 (Fri, 23 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/world.c

speed up ODE by not creating bodies for non-physics entities any more (only creating geoms now); fix speed limit code to no longer cause "butterfly flying"

------------------------------------------------------------------------
r9385 | vortex | 2009-10-22 15:54:35 -0700 (Thu, 22 Oct 2009) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/svvm_cmds.c
   M /trunk/dpmod/qc/dpextensions.qc

hacky and experimental DP_LIGHTSTYLE_STATICVALUE extension, allows alternative 'static' lightstyle syntax : "=value", examples: "=0.5", "=2.0", "=2.75". Could be safely used on CSQC side, but SVQC use is limited - other engines connecting to such server will misunderstand this style definition.
------------------------------------------------------------------------
r9384 | divverent | 2009-10-22 04:26:54 -0700 (Thu, 22 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.inc

fix ODE_DYNAMIC makefile stuff

------------------------------------------------------------------------
r9383 | divverent | 2009-10-22 02:02:17 -0700 (Thu, 22 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.inc

makefile: new flag DP_ODE_DYNAMIC

------------------------------------------------------------------------
r9382 | divverent | 2009-10-22 01:59:35 -0700 (Thu, 22 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/world.c

fix warning

------------------------------------------------------------------------
r9381 | divverent | 2009-10-22 01:58:55 -0700 (Thu, 22 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/world.c

due to huge slowdowns even in non-ODE using games (probably from body syncing), turn off ODE_DYNAMIC by default again until this is solved (e.g. by performing no ODE stuff if there is no single MOVETYPE_PHYSICS ent)

------------------------------------------------------------------------
r9380 | divverent | 2009-10-22 01:11:00 -0700 (Thu, 22 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/world.c

movedir stuff

------------------------------------------------------------------------
r9379 | divverent | 2009-10-22 01:08:29 -0700 (Thu, 22 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/world.c

make movedir_y fps independent

------------------------------------------------------------------------
r9378 | divverent | 2009-10-22 01:01:15 -0700 (Thu, 22 Oct 2009) | 5 lines
Changed paths:
   M /trunk/darkplaces/world.c

make springs use fps- and physics-engine independent movedir values:
_x = spring constant (also applies to internal constraints), set to -1 for "ultra-hard" joint
_y = maximum spring force to apply (0 = no spring)
_z = dampening (only works if _y is not 0)

------------------------------------------------------------------------
r9377 | divverent | 2009-10-22 00:49:55 -0700 (Thu, 22 Oct 2009) | 7 lines
Changed paths:
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/world.c

experimental support for springs:
movedir_x = joint CFM value (works for non-springs too)
movedir_y = spring force
movedir_z = spring ERP value

But maybe we should, instead of raw CFM and ERP, supply spring constant and dampening coefficient (see http://www.ode.org/old_list_archives/2006-January/017614.html)?

------------------------------------------------------------------------
r9376 | divverent | 2009-10-22 00:25:16 -0700 (Thu, 22 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/world.c

add missing declarations

------------------------------------------------------------------------
r9375 | divverent | 2009-10-22 00:19:57 -0700 (Thu, 22 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

change cl_lerping interpolation model from euler angles interpolation to forward/up vector interpolation to prevent problems near the singularity of euler angles

------------------------------------------------------------------------
r9374 | divverent | 2009-10-22 00:13:12 -0700 (Thu, 22 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/world.c

add cvars for world erp and cfm; remove pistons for ODE 0.9 support

------------------------------------------------------------------------
r9373 | divverent | 2009-10-21 23:42:34 -0700 (Wed, 21 Oct 2009) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/clvm_cmds.h
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/svvm_cmds.c
   M /trunk/darkplaces/world.c
   M /trunk/darkplaces/world.h

ODE: joints
fields: jointtype, origin, angles, and depending on joint type, velocity as secondary axis
also, clean up pitchsign code to make ODE work with bmodels

------------------------------------------------------------------------
r9372 | havoc | 2009-10-21 11:20:49 -0700 (Wed, 21 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

don't emit obj materials more than once

------------------------------------------------------------------------
r9371 | havoc | 2009-10-20 18:10:14 -0700 (Tue, 20 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/world.c

fix an error in the spinvelocity -> avelocity conversion

------------------------------------------------------------------------
r9370 | havoc | 2009-10-20 13:09:56 -0700 (Tue, 20 Oct 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/world.c

disabled use of WINAPI in ODE_API because ODE uses the default calling
convention on windows, and will have a runtime error if using WINAPI

------------------------------------------------------------------------
r9369 | divverent | 2009-10-20 11:36:29 -0700 (Tue, 20 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/world.c

support DP_SV_BOUNCEFACTOR and .float gravity for ODE objects (gravity however is on-off only, where values < 0.5 are off and > 0.5 are on)

------------------------------------------------------------------------
r9367 | divverent | 2009-10-20 08:31:00 -0700 (Tue, 20 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/world.c

comment out two unused functions (as ODE 0.9 does not have them)

------------------------------------------------------------------------
r9365 | havoc | 2009-10-20 07:53:52 -0700 (Tue, 20 Oct 2009) | 5 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/world.c

removed .axis_forward, .axis_left, .axis_up, .spinvelocity, now the only
new field is .mass
implemented a "hands off" approach to entity->rigidbody property
transfer, it should only lose precision when the QC edits something

------------------------------------------------------------------------
r9364 | havoc | 2009-10-20 05:46:20 -0700 (Tue, 20 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/protocol.c

fix last fix

------------------------------------------------------------------------
r9363 | havoc | 2009-10-20 05:45:02 -0700 (Tue, 20 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/protocol.c

fix typo

------------------------------------------------------------------------
r9362 | havoc | 2009-10-20 03:36:47 -0700 (Tue, 20 Oct 2009) | 4 lines
Changed paths:
   M /trunk/darkplaces/world.c

added automatic conversion from legacy entity angles/avelocity to
axis_*/spinvelocity for SOLID_PHYSICS_* types
use #ifdef ODE_DYNAMIC checks instead of #ifndef ODE_STATIC

------------------------------------------------------------------------
r9361 | havoc | 2009-10-20 03:34:29 -0700 (Tue, 20 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/sv_main.c

fix compile error with .avelocity

------------------------------------------------------------------------
r9360 | havoc | 2009-10-20 03:10:51 -0700 (Tue, 20 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/world.c

fix bug with rotating bmodels

------------------------------------------------------------------------
r9359 | havoc | 2009-10-20 02:59:38 -0700 (Tue, 20 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/world.c

use dInitODE instead of dInitODE2

------------------------------------------------------------------------
r9358 | divverent | 2009-10-20 02:47:06 -0700 (Tue, 20 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/world.c

fix two pointer bugs in ODE code

------------------------------------------------------------------------
r9357 | divverent | 2009-10-20 02:44:06 -0700 (Tue, 20 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

culling: fix culling of rotating entities... might help with greatwall bug?

------------------------------------------------------------------------
r9356 | divverent | 2009-10-20 02:35:44 -0700 (Tue, 20 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/world.c

move the ODE_API modifiers where they should be

------------------------------------------------------------------------
r9354 | havoc | 2009-10-19 15:32:54 -0700 (Mon, 19 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/makefile.inc
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/svvm_cmds.c
   M /trunk/darkplaces/world.c
   M /trunk/darkplaces/world.h

ODE physics engine support, needs more work, disabled by default

------------------------------------------------------------------------
r9353 | havoc | 2009-10-19 15:29:59 -0700 (Mon, 19 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt

added examples of installing ogg cd tracks

------------------------------------------------------------------------
r9352 | havoc | 2009-10-19 15:29:30 -0700 (Mon, 19 Oct 2009) | 4 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

fix a crash when r_shadow_lightattenuation* cvars are changed which was
not freeing shadowmaps before freeing the texture pool
fix a bug where flickering/switchable lights always showed coronas

------------------------------------------------------------------------
r9351 | divverent | 2009-10-18 12:53:53 -0700 (Sun, 18 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

more rcon_secure cleanup

------------------------------------------------------------------------
r9350 | divverent | 2009-10-18 12:53:06 -0700 (Sun, 18 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cvar.c
   M /trunk/darkplaces/host_cmd.c

clean up rcon_secure checks

------------------------------------------------------------------------
r9349 | havoc | 2009-10-18 11:12:43 -0700 (Sun, 18 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

replaced host_sleep with cl_maxfps_alwayssleep cvar (requires cl_maxfps)

------------------------------------------------------------------------
r9348 | havoc | 2009-10-17 14:17:29 -0700 (Sat, 17 Oct 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/image.h

implemented real support for QW skins (pants, shirt, glow, cropped pcx
decoding)

------------------------------------------------------------------------
r9347 | divverent | 2009-10-17 12:08:26 -0700 (Sat, 17 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

also support bouncefactor for MOVETYPE_BOUNCEMISSILE

------------------------------------------------------------------------
r9346 | eihrul | 2009-10-17 08:43:40 -0700 (Sat, 17 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

use r_shadow_shadowmapmaxsize instead of directly accessing cvar r_shadow_shadowmapping_maxsize to prevent weird snipping issues

------------------------------------------------------------------------
r9345 | eihrul | 2009-10-17 07:55:29 -0700 (Sat, 17 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

fix r_shadow_shadowmapping_maxsize validation to not reset each frame if it exceeds gl_max_size

------------------------------------------------------------------------
r9344 | havoc | 2009-10-17 04:21:37 -0700 (Sat, 17 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

limit shadowmap maxsize to a value based on gl_max_size

------------------------------------------------------------------------
r9343 | havoc | 2009-10-17 03:11:11 -0700 (Sat, 17 Oct 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

changed submodel polygonoffset from 2 to 4 to fix the lift to the quad
secret in e1m1

------------------------------------------------------------------------
r9342 | havoc | 2009-10-16 11:31:38 -0700 (Fri, 16 Oct 2009) | 6 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/vid_shared.c

added r_shadow_dot3 cvar to control whether GL1.3 hardware uses dot3
bumpmapping or not, since on older hardware it can be quite demanding it
defaults off
changed default of gl_combine back to 1 now that the only expensive
feature (dot3 bumpmapping) is on a separate cvar

------------------------------------------------------------------------
r9341 | havoc | 2009-10-16 09:31:44 -0700 (Fri, 16 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_shared.c

turn off gl_combine by default, it's just too nasty for old cards

------------------------------------------------------------------------
r9340 | havoc | 2009-10-16 08:28:36 -0700 (Fri, 16 Oct 2009) | 9 lines
Changed paths:
   M /trunk/darkplaces/bspfile.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c

reorganized sv.writeentitiestoclient handling of Mod_CanSeeBox, no
longer tests player prediction for every entity, reworked to accommodate
support for portals and other remote cameras at some point in the future
added mod_q3bsp_tracelineofsight_brushes cvar (defaults to 0)
added sv_cullentities_trace_entityocclusion cvar (defaults to 0) which
enables a form of visibility culling even in entirely dynamic scenes
(for example instanced buildings)
these cvars allow much more aggressive culling at a higher cost

------------------------------------------------------------------------
r9339 | havoc | 2009-10-16 08:07:57 -0700 (Fri, 16 Oct 2009) | 9 lines
Changed paths:
   M /trunk/darkplaces/prvm_exec.c
   M /trunk/darkplaces/prvm_execprogram.h

changed handling of forbidden world writes - they are now only a
warning, and still perform the actual write, additionally the check has
been moved from OP_ADDRESS to OP_STOREP_* and now prints what field is
being written
changed the nature of pointer fields (which are only written by
OP_ADDRESS and read by OP_STOREP_*) to use an index (like field offsets)
instead of a byte offset, this made it a little easier to print the
field offset on world write warnings

------------------------------------------------------------------------
r9337 | havoc | 2009-10-14 02:44:46 -0700 (Wed, 14 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

do not use VBOs when gl_mesh_testarrayelement is 1

------------------------------------------------------------------------
r9336 | havoc | 2009-10-14 02:20:11 -0700 (Wed, 14 Oct 2009) | 4 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c

fixed bug with gl_paranoid 1 when gl_vbo is 0 where element3s contained
no valid triangles because they were not initialized by Mod_BuildVBOs
moved unfinished OBJ loader from alias code to brush code

------------------------------------------------------------------------
r9335 | havoc | 2009-10-14 02:18:02 -0700 (Wed, 14 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

process particles/decals movement even if r_drawparticles/r_drawdecals is 0

------------------------------------------------------------------------
r9334 | havoc | 2009-10-14 02:13:35 -0700 (Wed, 14 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c

disable glLineWidth setting because it is producing gl errors on ATI

------------------------------------------------------------------------
r9333 | eihrul | 2009-10-12 13:03:55 -0700 (Mon, 12 Oct 2009) | 4 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

disabled old shadowmap lod formula entirely
renamed r_shadow_shadowmapping_precision cvar to r_shadow_shadowmapping_depthbits
r_shadow_shadowmapping_precision cvar now describes the ratio of shadowmap texels to world units

------------------------------------------------------------------------
r9332 | vortex | 2009-10-12 12:30:54 -0700 (Mon, 12 Oct 2009) | 1 line
Changed paths:
   M /trunk/darkplaces/r_shadow.c

Experimental r_shadow_shadowmapping_quality cvar which makes a lightradius-based shadowmap resolution calculation instead of LOD'ed one. Quality 1 will make shadowmapres 200 for light with radius 200, quality 0.5 will make 100 for same light. LOD is used, but in other manner, currently no parms for it.
------------------------------------------------------------------------
r9331 | eihrul | 2009-10-12 09:01:09 -0700 (Mon, 12 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

support slope-dependent shadowmap biasing with polygon offset

------------------------------------------------------------------------
r9330 | divverent | 2009-10-11 10:18:51 -0700 (Sun, 11 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/libcurl.c

restrict the protocols libcurl allows when redirecting for security reasons, and show a message if this fails

------------------------------------------------------------------------
r9329 | divverent | 2009-10-11 03:00:47 -0700 (Sun, 11 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

increase the accuracy of r_bloom_brighten a bit (or make high values work at all)

------------------------------------------------------------------------
r9328 | divverent | 2009-10-10 04:57:26 -0700 (Sat, 10 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/sys_linux.c

fix bug that caused newlines of console lines to be cut off (this made pasting fail)

------------------------------------------------------------------------
r9327 | divverent | 2009-10-10 04:52:40 -0700 (Sat, 10 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix r_bloom_blur logic to not change brightness any more

------------------------------------------------------------------------
r9326 | eihrul | 2009-10-08 07:54:05 -0700 (Thu, 08 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

rearrange r_shadow_shadowmap_texturetype settings so -1 = autoselect, 0 = 2D, 1 = rect, 2 = cubemap

------------------------------------------------------------------------
r9325 | eihrul | 2009-10-08 07:43:44 -0700 (Thu, 08 Oct 2009) | 4 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

use R_SHADOW_SHADOWMODE_ enum for shadowmode for readability
fix regression in cubemap texturetype for shadowmapping
only use one FBO per shadowmap cubemap lod and update depth attachment per side transition 

------------------------------------------------------------------------
r9324 | eihrul | 2009-10-08 06:40:14 -0700 (Thu, 08 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

only honor r_shadow_shadowmapping cvar if both GLSL & FBO support are available

------------------------------------------------------------------------
r9323 | havoc | 2009-10-08 06:38:07 -0700 (Thu, 08 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

check gl_support_fragment_shader before setting up shadowmode

------------------------------------------------------------------------
r9322 | eihrul | 2009-10-07 10:37:48 -0700 (Wed, 07 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

fix for noselfshadow entities no culling from shadowmap sides properly

------------------------------------------------------------------------
r9321 | eihrul | 2009-10-07 10:10:47 -0700 (Wed, 07 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

avoid repeatedly thrashing GL state when switching shadowmap sides

------------------------------------------------------------------------
r9320 | eihrul | 2009-10-07 06:18:13 -0700 (Wed, 07 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

improved culling of shadowmap sides against view frustum

------------------------------------------------------------------------
r9319 | eihrul | 2009-10-06 18:00:32 -0700 (Tue, 06 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/matrixlib.c
   M /trunk/darkplaces/matrixlib.h
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_shadow.c

use bounding boxes for shadowmap side culling instead of spheres for better accuracy

------------------------------------------------------------------------
r9318 | vortex | 2009-10-06 15:44:11 -0700 (Tue, 06 Oct 2009) | 1 line
Changed paths:
   M /trunk/darkplaces/model_brush.c

Added reliable Q3BSP tangentspace/modelspace deluxemaps detection method to support q3map2 FS-R8 (and maybe other q3map2 forks). Entity loader checks for "deluxeMaps" worldspawn key. It should be '1' if deluxemaps are modelspace, and '2' for tangentspace ones. Otherwise old modelspace deluxemaps detection is used.
------------------------------------------------------------------------
r9317 | eihrul | 2009-10-06 12:57:39 -0700 (Tue, 06 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

fixed biasing issue in shadowmap frustum culling

------------------------------------------------------------------------
r9316 | eihrul | 2009-10-06 12:24:41 -0700 (Tue, 06 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/matrixlib.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h

improved shadowmap side culling

------------------------------------------------------------------------
r9315 | eihrul | 2009-10-06 05:11:24 -0700 (Tue, 06 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/matrixlib.c

use cached matrix elements for calculating determinant

------------------------------------------------------------------------
r9314 | divverent | 2009-10-06 04:47:58 -0700 (Tue, 06 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/matrixlib.c

even better matrix inversion (will test it later), in benchmarks it was slightly faster than the mesa one

------------------------------------------------------------------------
r9313 | havoc | 2009-10-06 03:14:39 -0700 (Tue, 06 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

disable some slow code (clearing unused parameters in an array)

------------------------------------------------------------------------
r9312 | divverent | 2009-10-05 08:05:07 -0700 (Mon, 05 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/matrixlib.c

fix typo :P

------------------------------------------------------------------------
r9311 | divverent | 2009-10-05 07:25:57 -0700 (Mon, 05 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/matrixlib.c

fix typo elsif

------------------------------------------------------------------------
r9310 | divverent | 2009-10-05 07:07:09 -0700 (Mon, 05 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/matrixlib.c

add yet another (disabled) variant of determinants

------------------------------------------------------------------------
r9309 | eihrul | 2009-10-05 03:45:29 -0700 (Mon, 05 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

if(foo = false) -> if(foo == false) bug fix

------------------------------------------------------------------------
r9308 | havoc | 2009-10-05 02:55:00 -0700 (Mon, 05 Oct 2009) | 4 lines
Changed paths:
   M /trunk/darkplaces/matrixlib.c

faster Matrix4x4_Invert_Full based on David Moore code in Mesa 7.6
(SGI Free License B - which is MIT/X11-type), previous version was from
Mesa 5.0

------------------------------------------------------------------------
r9307 | divverent | 2009-10-05 01:25:22 -0700 (Mon, 05 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

rename them to dp_glossintensitymod and dp_glossexponentmod

------------------------------------------------------------------------
r9306 | divverent | 2009-10-05 01:01:43 -0700 (Mon, 05 Oct 2009) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h

while I am at it, also dp_specularscalemod
------------------------------------------------------------------------
r9305 | divverent | 2009-10-05 00:59:44 -0700 (Mon, 05 Oct 2009) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h

new shader keyword: dp_specularpowermod 2, makes gloss have 2x the usual specular power
------------------------------------------------------------------------
r9304 | vortex | 2009-10-04 15:38:47 -0700 (Sun, 04 Oct 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/csprogs.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h
   M /trunk/darkplaces/svvm_cmds.c

-added game Blood Omnicide
-added r_shadow_gloss2exponent (gloss exponent for forced gloss surfaces), this don't work for Dot3 pieline however, i'm used this to make "wet surfaces when rain falls" in Blood Omnicide
-added DP_CSQC_ENTITYTRANSPARENTSORTING_OFFSET, DP_CSQC_ENTITYNOCULL, DP_CSQC_SPAWNPARTICLE. Definitions are here: http://darkmaster.quakedev.com/work/csqc_new_ext.qc
------------------------------------------------------------------------
r9303 | divverent | 2009-10-04 11:35:00 -0700 (Sun, 04 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

also don't call PostThink on disconnected clients ;)

------------------------------------------------------------------------
r9302 | havoc | 2009-10-04 05:35:50 -0700 (Sun, 04 Oct 2009) | 7 lines
Changed paths:
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c

added sv_gameplayfix_consistentplayerprethink which defaults on - this
cvar causes SV_Physics to call all PlayerPreThink functions, then move
all players, then call PlayerPostThink functions, then move all
entities, to improve consistency of firing/moving in multiplayer
in singleplayer this has no effect at all (because there is only one
client)

------------------------------------------------------------------------
r9300 | havoc | 2009-10-04 04:35:47 -0700 (Sun, 04 Oct 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/svvm_cmds.c

added DP_ENT_GLOWMOD extension, like DP_ENT_COLORMOD but alters glow
color (fullbrights or glow texture) instead of diffuse

------------------------------------------------------------------------
r9299 | divverent | 2009-10-04 03:12:57 -0700 (Sun, 04 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/mvm_cmds.c

tell QC about pixelheight too

------------------------------------------------------------------------
r9298 | havoc | 2009-10-03 19:59:46 -0700 (Sat, 03 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

changed uniform GlowScale to GlowColor

------------------------------------------------------------------------
r9297 | havoc | 2009-10-03 19:10:35 -0700 (Sat, 03 Oct 2009) | 7 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_exec.c
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_move.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/svvm_cmds.c
   M /trunk/darkplaces/view.c
   M /trunk/darkplaces/world.c

duplicated PRVM_ExecuteProgram to become MVM_ExecuteProgram,
CLVM_ExecuteProgram, SVVM_ExecuteProgram - all identical but this
greatly improves profiling reports
split calls to SV_LinkEdict into SV_LinkEdict and
SV_LinkEdict_TouchAreaGrid because the SV_LinkEdict profile report
looked nasty but it was only SV_LinkEdict_TouchAreaGrid to blame

------------------------------------------------------------------------
r9296 | havoc | 2009-10-03 19:07:05 -0700 (Sat, 03 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

use one markframe variable

------------------------------------------------------------------------
r9295 | havoc | 2009-10-03 17:32:47 -0700 (Sat, 03 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/collision.c

audited trace.endpos code

------------------------------------------------------------------------
r9294 | havoc | 2009-10-03 17:31:48 -0700 (Sat, 03 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/collision.c

fix another case of Trace.endpos being set too early

------------------------------------------------------------------------
r9293 | havoc | 2009-10-03 17:31:17 -0700 (Sat, 03 Oct 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/collision.c

fix bug in last patch - must set trace.endpos AFTER calling TracePoint
function, because it memsets the trace

------------------------------------------------------------------------
r9292 | havoc | 2009-10-03 15:53:55 -0700 (Sat, 03 Oct 2009) | 7 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/cl_collision.h
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/collision.c
   M /trunk/darkplaces/collision.h
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_move.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sv_user.c
   M /trunk/darkplaces/svvm_cmds.c
   M /trunk/darkplaces/view.c

split CL_Move into CL_TracePoint, CL_TraceLine, CL_TraceBox and similar
for SV_Move
split code paths for tracing lines and points out from box code
this is for better profiling reports because single statistics for Box,
Line and Point traces are unfair to the performance of line and point
traces

------------------------------------------------------------------------
r9291 | havoc | 2009-10-03 15:47:13 -0700 (Sat, 03 Oct 2009) | 7 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/sbar.c
   M /trunk/darkplaces/vid_agl.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_wgl.c

added r_renderview cvar (similar to scr_refresh but disables only 3D
renders)
reworked scr_refresh and r_render cvars to only disable certain
rendering operations
changed where Sbar_ShowFPS code is called so that it appears even if
r_letterbox is on, and updates even while scr_refresh is 0

------------------------------------------------------------------------
r9290 | divverent | 2009-10-03 10:37:04 -0700 (Sat, 03 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/model_shared.c

fix two not freed search handles

------------------------------------------------------------------------
r9289 | divverent | 2009-10-03 04:44:02 -0700 (Sat, 03 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

remove now unneeded code

------------------------------------------------------------------------
r9288 | divverent | 2009-10-03 04:37:12 -0700 (Sat, 03 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

fix connect after getchallenge, rcon, getchallenge sequence

------------------------------------------------------------------------
r9287 | divverent | 2009-10-03 04:06:49 -0700 (Sat, 03 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/netconn.c

fix two bugs in srcon/rcon_secure 2. It now WORKS.

------------------------------------------------------------------------
r9286 | havoc | 2009-10-02 21:07:39 -0700 (Fri, 02 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

minor optimization to CL_RelinkLightFlashes

------------------------------------------------------------------------
r9285 | havoc | 2009-10-02 19:09:51 -0700 (Fri, 02 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

enable networking clients as legacy even with sv_onlycsqcnetworking

------------------------------------------------------------------------
r9284 | havoc | 2009-10-02 19:01:16 -0700 (Fri, 02 Oct 2009) | 4 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

added cvar sv_onlycsqcnetworking which disables legacy entity
networking, improving server performance for games that do not use
legacy entities

------------------------------------------------------------------------
r9283 | eihrul | 2009-10-02 18:20:51 -0700 (Fri, 02 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h

compile separate index lists for each cubemap shadowmap side

------------------------------------------------------------------------
r9282 | divverent | 2009-10-02 03:25:17 -0700 (Fri, 02 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/netconn.c

try making srcon work better with many rcon comamnds queued

------------------------------------------------------------------------
r9281 | havoc | 2009-10-02 02:57:06 -0700 (Fri, 02 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

another fix

------------------------------------------------------------------------
r9280 | havoc | 2009-10-02 02:44:41 -0700 (Fri, 02 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

possible bugfix for r_water bugs introduced recently

------------------------------------------------------------------------
r9279 | divverent | 2009-10-02 02:22:33 -0700 (Fri, 02 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/netconn.c

sorry for this 100% untested change... making srcon use the new challenge-based protocol (but rcon_secure 1 and rcon still uses the time-based one as that's faster and more reliable).

------------------------------------------------------------------------
r9278 | divverent | 2009-10-02 01:19:58 -0700 (Fri, 02 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

rcon_secure: alternative getchallenge-based authentication that doesn't rely on the system time (server side only at the moment)

------------------------------------------------------------------------
r9277 | eihrul | 2009-10-01 21:47:56 -0700 (Thu, 01 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_textures.h

added cvar r_shadow_shadowmapping_precision to control minimum shadowmap depth precision

------------------------------------------------------------------------
r9276 | eihrul | 2009-10-01 21:13:31 -0700 (Thu, 01 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

stub out face culling for shadowmapping temporarily

------------------------------------------------------------------------
r9275 | eihrul | 2009-10-01 19:55:06 -0700 (Thu, 01 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

enable backface culling for shadowmap rendering

------------------------------------------------------------------------
r9274 | eihrul | 2009-10-01 11:32:29 -0700 (Thu, 01 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

use nearest filtering on VSDCT

------------------------------------------------------------------------
r9273 | eihrul | 2009-10-01 10:30:00 -0700 (Thu, 01 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c

avoid unnecessary texture offset scaling in shadowmap lookups

------------------------------------------------------------------------
r9272 | eihrul | 2009-10-01 09:09:44 -0700 (Thu, 01 Oct 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_textures.h

better VSDCT transform

------------------------------------------------------------------------
r9271 | eihrul | 2009-09-30 23:31:41 -0700 (Wed, 30 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

GLSL compiler variable declaration workaround

------------------------------------------------------------------------
r9270 | eihrul | 2009-09-30 23:08:31 -0700 (Wed, 30 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

default to using texture rectangle shadowmaps when available

------------------------------------------------------------------------
r9269 | eihrul | 2009-09-30 22:43:23 -0700 (Wed, 30 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/vid_shared.c

automagically select best shadowmapping filter mode depending on hardware

------------------------------------------------------------------------
r9268 | havoc | 2009-09-30 20:05:06 -0700 (Wed, 30 Sep 2009) | 4 lines
Changed paths:
   M /trunk/darkplaces/snd_alsa.c

use 4 periods in ALSA instead of 2 for lower latency if possible
request a power of 2 buffer size in ALSA (maybe better compatibility)
thanks to Diablo-D3 for a patch I based this functionality on

------------------------------------------------------------------------
r9267 | eihrul | 2009-09-30 19:36:37 -0700 (Wed, 30 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c

added a cheaper 3x3 PCF settings for shadowmaps

------------------------------------------------------------------------
r9266 | eihrul | 2009-09-30 18:32:42 -0700 (Wed, 30 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

depth texture mode fixes

------------------------------------------------------------------------
r9265 | havoc | 2009-09-30 12:40:12 -0700 (Wed, 30 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fixed water rendering in shrunken views

------------------------------------------------------------------------
r9264 | eihrul | 2009-09-30 08:26:55 -0700 (Wed, 30 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_textures.h

shadowmap projection fixes

------------------------------------------------------------------------
r9263 | eihrul | 2009-09-30 05:49:54 -0700 (Wed, 30 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c

make use of virtual shadow depth cube texture optional

------------------------------------------------------------------------
r9262 | eihrul | 2009-09-30 04:39:12 -0700 (Wed, 30 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c

ALU cubemap indirection fixes

------------------------------------------------------------------------
r9261 | havoc | 2009-09-30 03:51:36 -0700 (Wed, 30 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

clarify surfedge handling with a comment about surfedge 0

------------------------------------------------------------------------
r9260 | eihrul | 2009-09-30 03:20:58 -0700 (Wed, 30 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c

added support for more shadowmap2D PCF modes and provisional fetch4 PCF

------------------------------------------------------------------------
r9259 | havoc | 2009-09-30 02:59:33 -0700 (Wed, 30 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

use hash lookups on shader permutations to greatly reduce memory usage

------------------------------------------------------------------------
r9258 | eihrul | 2009-09-30 02:05:19 -0700 (Wed, 30 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

disable compare mode on shadowmapcube when not using filtering

------------------------------------------------------------------------
r9257 | eihrul | 2009-09-30 01:59:11 -0700 (Wed, 30 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

added in stub permutations for shadowmap2d and shadowmapcube cases

------------------------------------------------------------------------
r9256 | eihrul | 2009-09-30 01:22:10 -0700 (Wed, 30 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_textures.h
   M /trunk/darkplaces/render.h

restoring scaffolding for cubemap and 2D shadowmaps

------------------------------------------------------------------------
r9255 | eihrul | 2009-09-29 23:00:37 -0700 (Tue, 29 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_textures.h
   M /trunk/darkplaces/render.h

added indirection cube map for shadowmapping and revised filtering modes

------------------------------------------------------------------------
r9254 | havoc | 2009-09-28 16:06:34 -0700 (Mon, 28 Sep 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

fix two bugs related to textype_t pointed out by Lee Salzman, both
affecting shadowmap setup

------------------------------------------------------------------------
r9253 | havoc | 2009-09-28 15:20:32 -0700 (Mon, 28 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

fix stencil clear 

------------------------------------------------------------------------
r9252 | havoc | 2009-09-28 15:09:19 -0700 (Mon, 28 Sep 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

fix allocation of 2D shadowmap textures when the first light LOD is
below maxsize

------------------------------------------------------------------------
r9251 | divverent | 2009-09-28 07:47:36 -0700 (Mon, 28 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

when fixing vertex indexes, reject the map instead of segfaulting if vertex index 0 is invalid too

------------------------------------------------------------------------
r9250 | divverent | 2009-09-27 13:23:44 -0700 (Sun, 27 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

fix screenshot hw gamma check

------------------------------------------------------------------------
r9249 | divverent | 2009-09-27 12:08:23 -0700 (Sun, 27 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

fix inverse logic in "important" local

------------------------------------------------------------------------
r9248 | havoc | 2009-09-27 11:09:38 -0700 (Sun, 27 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

change cl.time check back

------------------------------------------------------------------------
r9247 | havoc | 2009-09-27 10:59:14 -0700 (Sun, 27 Sep 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

fix outgoing netgraph anomalies (caused by cl_maxfps > cl_netfps)
made msecdelta checks a bit more sane

------------------------------------------------------------------------
r9246 | havoc | 2009-09-26 22:15:30 -0700 (Sat, 26 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

change MAX_CLIP_PLANES from 32 to 5 (back to old value)

------------------------------------------------------------------------
r9245 | havoc | 2009-09-26 11:40:01 -0700 (Sat, 26 Sep 2009) | 5 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c

fix several bugs with viewport code (r_shadows works again, r_water
works again)
fixed a bug where r_hdr might cause multiple reallocations of textures
every frame in r_water code

------------------------------------------------------------------------
r9244 | havoc | 2009-09-26 11:30:05 -0700 (Sat, 26 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c

rename r_shadows_drawafterrtlightning to r_shadows_drawafterrtlighting

------------------------------------------------------------------------
r9243 | divverent | 2009-09-26 11:15:41 -0700 (Sat, 26 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c

network CSQC and network entities separately (should prevent bugs when an entity suddenly gets SendEntity assigned, which can happen during entity reuse)

------------------------------------------------------------------------
r9242 | havoc | 2009-09-26 10:21:19 -0700 (Sat, 26 Sep 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

renamed prvm_startupreuseedicttime to prvm_reuseedicts_startuptime
added cvar prvm_reuseedicts_neverinsameframe

------------------------------------------------------------------------
r9241 | havoc | 2009-09-26 10:15:25 -0700 (Sat, 26 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

added prvm_startupreuseedicttime cvar

------------------------------------------------------------------------
r9240 | divverent | 2009-09-26 04:51:44 -0700 (Sat, 26 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

fix typo in cube side freeing

------------------------------------------------------------------------
r9239 | divverent | 2009-09-25 15:42:58 -0700 (Fri, 25 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

initilaize the lightscissor array before drawing r_shadows

------------------------------------------------------------------------
r9238 | divverent | 2009-09-25 14:35:45 -0700 (Fri, 25 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix more bugs in the reflection hack

------------------------------------------------------------------------
r9237 | divverent | 2009-09-25 14:21:50 -0700 (Fri, 25 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix a compile error FruitieX gets

------------------------------------------------------------------------
r9236 | divverent | 2009-09-25 14:11:15 -0700 (Fri, 25 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

improve the fix to work for reflection-only and refraction-only too

------------------------------------------------------------------------
r9235 | divverent | 2009-09-25 14:00:01 -0700 (Fri, 25 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

change the hack to work separately for reflection and refraction; MAY help a little

------------------------------------------------------------------------
r9234 | divverent | 2009-09-25 13:58:44 -0700 (Fri, 25 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

add an ugly hack to reflections/refractions to "behave" when otherwise black edges would appear

------------------------------------------------------------------------
r9233 | divverent | 2009-09-25 06:04:49 -0700 (Fri, 25 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_alsa.c

add a COMMANDLINEOPTION block for -sndseqin

------------------------------------------------------------------------
r9232 | divverent | 2009-09-25 05:59:45 -0700 (Fri, 25 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/keys.h
   M /trunk/darkplaces/snd_3dras.c
   M /trunk/darkplaces/snd_alsa.c
   M /trunk/darkplaces/snd_bsd.c
   M /trunk/darkplaces/snd_coreaudio.c
   M /trunk/darkplaces/snd_main.h
   M /trunk/darkplaces/snd_null.c
   M /trunk/darkplaces/snd_oss.c
   M /trunk/darkplaces/snd_sdl.c
   M /trunk/darkplaces/snd_win.c

snd_alsa: MIDI input support! MIDI events get mapped to MIDINOTE<n> events (n = 0 to 127)

------------------------------------------------------------------------
r9231 | divverent | 2009-09-23 22:40:19 -0700 (Wed, 23 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/csprogs.c

add misisng include

------------------------------------------------------------------------
r9230 | divverent | 2009-09-23 13:55:24 -0700 (Wed, 23 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/csprogs.h
   M /trunk/darkplaces/host.c

prevent information leakage from trace_ globals to prvm_global client to prevent very simple console in/out parsing based triggerbots

------------------------------------------------------------------------
r9229 | divverent | 2009-09-23 13:16:22 -0700 (Wed, 23 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

new commands: prvm_edictget, prvm_globalget - read values from edicts/globals into cvars

------------------------------------------------------------------------
r9228 | divverent | 2009-09-23 13:15:53 -0700 (Wed, 23 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.h

clear trace globals after CSQC execution, to prevent possible triggerbots working by parsing DP console output of "prvm_global client trace_networkentity" and issuing +attack/-attack based on result

------------------------------------------------------------------------
r9227 | divverent | 2009-09-23 03:21:38 -0700 (Wed, 23 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

unbreak v_flipped :(

------------------------------------------------------------------------
r9226 | havoc | 2009-09-23 01:59:37 -0700 (Wed, 23 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

reduce code a bit more

------------------------------------------------------------------------
r9225 | havoc | 2009-09-23 01:58:24 -0700 (Wed, 23 Sep 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/r_shadow.c

reduced shadowmaps from 32bit to 24bit depth format
some tweaks to shadowmap texture handling to reduce code

------------------------------------------------------------------------
r9224 | divverent | 2009-09-23 01:06:14 -0700 (Wed, 23 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

make shader permutatiosn eat less memory again. 864MB was justt oo much.

------------------------------------------------------------------------
r9223 | divverent | 2009-09-22 23:57:31 -0700 (Tue, 22 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

only skip input if time is actually increasing (should fix pause)

------------------------------------------------------------------------
r9222 | havoc | 2009-09-22 14:27:00 -0700 (Tue, 22 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

fix default values for the r_shadow_shadowmapping_lod cvars

------------------------------------------------------------------------
r9221 | havoc | 2009-09-22 14:16:27 -0700 (Tue, 22 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

disable an annoying debug print

------------------------------------------------------------------------
r9220 | havoc | 2009-09-22 13:20:53 -0700 (Tue, 22 Sep 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

changed r_shadow_shadowmapping values (now 1 = 2d, 2 = rect, 3 = cube)
disabled some debugging code for shadowmaps which produced large files

------------------------------------------------------------------------
r9219 | havoc | 2009-09-22 13:18:12 -0700 (Tue, 22 Sep 2009) | 6 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h
   M /trunk/darkplaces/r_textures.h
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/vid_shared.c

implemented omnidirectional shadowmapping using depth textures (2D, Rect
and Cube texture types supported)
overhauled viewport handling (now has r_refdef.view.viewport),
R_Viewport functions replace GL_SetupView_ functions, R_SetViewport
makes a viewport current

------------------------------------------------------------------------
r9218 | havoc | 2009-09-22 13:16:13 -0700 (Tue, 22 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/matrixlib.c
   M /trunk/darkplaces/matrixlib.h

added float GL/D3D array conversions

------------------------------------------------------------------------
r9217 | havoc | 2009-09-20 05:00:43 -0700 (Sun, 20 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fixed shadow culling bug caused by bad frustumcorner generation math

------------------------------------------------------------------------
r9215 | havoc | 2009-09-18 04:20:31 -0700 (Fri, 18 Sep 2009) | 5 lines
Changed paths:
   M /trunk/darkplaces/host.c

fix framerate limiting - when cl_maxfps is 0, run client frames even if
cl_timer has not advanced, this allows framerates above 1000, and
makes framerates very consistent (rather than chaotic) in the 200-1000
range as well

------------------------------------------------------------------------
r9214 | havoc | 2009-09-18 02:25:42 -0700 (Fri, 18 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

enable host_sleep 1 by default

------------------------------------------------------------------------
r9213 | divverent | 2009-09-18 02:21:51 -0700 (Fri, 18 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

fix red-coloring logic again

------------------------------------------------------------------------
r9212 | divverent | 2009-09-18 02:19:57 -0700 (Fri, 18 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

showfps 2: always show mspf

------------------------------------------------------------------------
r9211 | havoc | 2009-09-18 02:15:20 -0700 (Fri, 18 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

use different showfps math

------------------------------------------------------------------------
r9210 | divverent | 2009-09-18 00:24:41 -0700 (Fri, 18 Sep 2009) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_user.c

sv_gameplayfix_q2airaccelerate: use Quake2/3/Nexuiz-style air acceleration (clamped by maxairspeed, not by maxspeed as in Q1/Q2)
This is also supported by cl_movement
Mods that now experience prediction errors must set sv_gameplayfix_q2airaccelerate to 1 in their default configuration

------------------------------------------------------------------------
r9209 | havoc | 2009-09-17 09:42:55 -0700 (Thu, 17 Sep 2009) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/netconn.h

rewrote netgraph code
netgraph now uses line graph (doesn't look very good though)
netgraph now shows last 4 seconds (rather than 100 packets)
netgraph now shows rate estimate

------------------------------------------------------------------------
r9208 | havoc | 2009-09-17 05:20:45 -0700 (Thu, 17 Sep 2009) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

stop predicting movement when no server packets have been received for
300ms (by default), this prevents major performance issues with
prediction of long queues

------------------------------------------------------------------------
r9207 | havoc | 2009-09-17 05:11:49 -0700 (Thu, 17 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/client.h

reduce CL_MAX_USERCMDS to 128 (from 256)

------------------------------------------------------------------------
r9206 | divverent | 2009-09-17 03:14:17 -0700 (Thu, 17 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/prvm_exec.c

fix callprofile by making some CSQC builtins that call the renderer (or QC) exempt from prvm_callprofile

------------------------------------------------------------------------
r9205 | divverent | 2009-09-17 02:43:47 -0700 (Thu, 17 Sep 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/pr_comp.h
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/prvm_exec.c
   M /trunk/darkplaces/prvm_execprogram.h

make profile output more verbous (including time of child functions)
add new command prvm_childprofile to instead sort by the total time (including children)

------------------------------------------------------------------------
r9204 | havoc | 2009-09-16 22:31:05 -0700 (Wed, 16 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_win.c
   M /trunk/darkplaces/sys_win.c
   M /trunk/darkplaces/vid_wgl.c

fix more C++ warnings/errors in MSVC

------------------------------------------------------------------------
r9203 | divverent | 2009-09-16 06:31:06 -0700 (Wed, 16 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

fix TH's status patch to again send the same data as before

------------------------------------------------------------------------
r9202 | divverent | 2009-09-16 03:19:34 -0700 (Wed, 16 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cmd.c

fix descriptions of cmdlist and cvarlist

------------------------------------------------------------------------
r9201 | vortex | 2009-09-15 12:18:26 -0700 (Tue, 15 Sep 2009) | 8 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c

improved r_shadows mode, new cvars for better use with overhead camera mods:
- r_shadows_darken : how much shadowed areas will be darkened (was constant 0.5)
- r_shadows_throwdirection : override shadow direction for r_shadows 2 (was constant 0 0 -1)
- r_shadows_drawafterrtlightning : this change fake shadows to draw AFTER realtime lightning is drawn, may be useful for simulating faster sunlight on large outdoor maps with only one noshadow rtlight. The price is less realistic appearance of dynamic light shadows.
- r_shadows_castfrombmodels : allow to cast fake shadows from bmodels



------------------------------------------------------------------------
r9200 | havoc | 2009-09-15 06:09:09 -0700 (Tue, 15 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/curves.c
   M /trunk/darkplaces/cvar.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/lhnet.c
   M /trunk/darkplaces/libcurl.c
   M /trunk/darkplaces/mathlib.h
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_sprite.c
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h
   M /trunk/darkplaces/r_sprites.c
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_ogg.c
   M /trunk/darkplaces/sv_user.c
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_shared.c

fix errors and warnings in MSVC when compiling as C++

------------------------------------------------------------------------
r9199 | divverent | 2009-09-15 05:26:04 -0700 (Tue, 15 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

use correct type to fix a warning :P

------------------------------------------------------------------------
r9198 | havoc | 2009-09-15 03:08:02 -0700 (Tue, 15 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cap_ogg.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/image_png.c
   M /trunk/darkplaces/lhnet.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/sys_sdl.c

fixed compile errors and warnings using Dev-C++ in "Compile as C++" mode

------------------------------------------------------------------------
r9197 | divverent | 2009-09-14 22:57:37 -0700 (Mon, 14 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

also check ticrate movevar

------------------------------------------------------------------------
r9196 | divverent | 2009-09-14 22:28:30 -0700 (Mon, 14 Sep 2009) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

[04:31:11] <@LordHavoc> div0: 9179 (if (msecdelta <= 0) return;) wrecked connect time
[04:31:23] <@LordHavoc> div0: not enough packets coming in for the message exchange to work
[04:32:07] <@LordHavoc> div0: maybe if (msecdelta <= 0 && cl.movevars_ticrate > 0 && cls.signon == SIGNONS)
[04:32:34] <@LordHavoc> div0: maybe also && !cl.paused

------------------------------------------------------------------------
r9195 | samual | 2009-09-14 11:38:59 -0700 (Mon, 14 Sep 2009) | 1 line
Changed paths:
   M /trunk/darkplaces/csprogs.c

Patch by FruitieX -- fixes speed
------------------------------------------------------------------------
r9194 | divverent | 2009-09-14 07:56:46 -0700 (Mon, 14 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

if sideways friction is negative, make it never decrease total velocity (might be bad)

------------------------------------------------------------------------
r9193 | havoc | 2009-09-14 04:39:17 -0700 (Mon, 14 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces-dedicated.dev
   M /trunk/darkplaces/darkplaces.dev

use winsock2 to fix linker errors

------------------------------------------------------------------------
r9192 | divverent | 2009-09-13 23:43:06 -0700 (Sun, 13 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/view.c

better view blend math for death fade

------------------------------------------------------------------------
r9191 | havoc | 2009-09-13 22:22:44 -0700 (Sun, 13 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

tightly sync time if cl_nolerp is on

------------------------------------------------------------------------
r9190 | havoc | 2009-09-13 16:52:48 -0700 (Sun, 13 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c

added cvar sv_gameplayfix_noairborncorpse_allowsuspendeditems

------------------------------------------------------------------------
r9189 | samual | 2009-09-13 08:23:25 -0700 (Sun, 13 Sep 2009) | 1 line
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/sbar.c

remove r_motionblur_debug, and replace with showblur which has been added to sbar.c
------------------------------------------------------------------------
r9188 | vortex | 2009-09-13 07:50:20 -0700 (Sun, 13 Sep 2009) | 1 line
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

fix broken VM_CL_lightstyle (CSQC): it was using MSG_ReadString instead of value parm
------------------------------------------------------------------------
r9187 | samual | 2009-09-12 23:24:07 -0700 (Sat, 12 Sep 2009) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/view.c

cl_deathfade: new effect which makes the screen fade to dark red when you die... disabled by default
------------------------------------------------------------------------
r9186 | havoc | 2009-09-12 21:16:46 -0700 (Sat, 12 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/vid_shared.c

added detection of GL_EXT_framebuffer_object extension

------------------------------------------------------------------------
r9185 | havoc | 2009-09-12 19:21:04 -0700 (Sat, 12 Sep 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

implemented sv_gameplayfix_delayprojectiles -1 (force move on first
frame, even if spawned in earlier entity slot)

------------------------------------------------------------------------
r9184 | havoc | 2009-09-12 02:21:14 -0700 (Sat, 12 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

punctuation

------------------------------------------------------------------------
r9183 | havoc | 2009-09-12 00:51:31 -0700 (Sat, 12 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

try not to crash on num_bones 0 in Mod_BuildBaseBonePoses

------------------------------------------------------------------------
r9182 | havoc | 2009-09-11 07:38:34 -0700 (Fri, 11 Sep 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/client.h

do not allow cl_netfps to be below the server framerate (as indicated by
sys_ticrate) if possible, to avoid jerky player movement

------------------------------------------------------------------------
r9181 | havoc | 2009-09-11 05:34:07 -0700 (Fri, 11 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

doubled entity limit in animcache, we should never hit this

------------------------------------------------------------------------
r9180 | divverent | 2009-09-11 04:52:32 -0700 (Fri, 11 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_user.c

remove maxnetfps stuff (never worked anyway), instead reject <0.5ms moves

------------------------------------------------------------------------
r9179 | divverent | 2009-09-11 04:52:01 -0700 (Fri, 11 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

do not send zero-length moves at >1000fps

------------------------------------------------------------------------
r9178 | divverent | 2009-09-11 04:25:15 -0700 (Fri, 11 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

input: limit cl_netrepeatinput to 3

------------------------------------------------------------------------
r9177 | havoc | 2009-09-11 03:05:22 -0700 (Fri, 11 Sep 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

now generates animcaches for visible entities again like the original
code, this gives a slight speed gain in Nexuiz

------------------------------------------------------------------------
r9176 | havoc | 2009-09-11 02:45:33 -0700 (Fri, 11 Sep 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

refactored and reformatted animcache code, now generates caches on
demand (not ideal but never loses speed anymore)

------------------------------------------------------------------------
r9175 | havoc | 2009-09-11 02:42:12 -0700 (Fri, 11 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

Model_*_AnimateVertices functions no longer write to NULL vertex3f

------------------------------------------------------------------------
r9174 | havoc | 2009-09-11 02:39:55 -0700 (Fri, 11 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_mix.c

play silence during timedemos

------------------------------------------------------------------------
r9173 | havoc | 2009-09-11 00:59:59 -0700 (Fri, 11 Sep 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

reworked unreliable message queue to ALWAYS dequeue the first entry,
even if it does not fit (and throw it away if so)

------------------------------------------------------------------------
r9172 | havoc | 2009-09-09 12:05:10 -0700 (Wed, 09 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

use -developer automatically in debug builds

------------------------------------------------------------------------
r9171 | havoc | 2009-09-08 14:18:17 -0700 (Tue, 08 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/model_shared.c

fix C++ compilation errors

------------------------------------------------------------------------
r9170 | echon | 2009-09-08 09:01:25 -0700 (Tue, 08 Sep 2009) | 1 line
Changed paths:
   M /trunk/darkplaces/snd_main.c

Oops!
------------------------------------------------------------------------
r9169 | echon | 2009-09-08 08:59:10 -0700 (Tue, 08 Sep 2009) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

NULL out RSurf_ActiveModelEntity rsurface fields that aren't wanted with an animcached entity.
------------------------------------------------------------------------
r9168 | echon | 2009-09-06 10:31:47 -0700 (Sun, 06 Sep 2009) | 1 line
Changed paths:
   M /trunk/darkplaces/snd_main.c

Added an unreal-esque feature: snd_spatialization_occlusion, which when enabled uses a quick TraceLineOfSight to determine if a sound isn't "visibile" (blocked by world), and halves the volume.
------------------------------------------------------------------------
r9167 | echon | 2009-09-06 10:04:31 -0700 (Sun, 06 Sep 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/darkplaces-dedicated.vcproj
   M /trunk/darkplaces/darkplaces-sdl.vcproj
   M /trunk/darkplaces/darkplaces.vcproj
   M /trunk/darkplaces/vid_wgl.c

Compile as C code, not C++ (vcproj setting)
Include dinput8 libs if SUPPORTDIRECTX is defined
Default to defining SUPPORTDIRECTX on windows builds, otherwise you get crackly sound
------------------------------------------------------------------------
r9166 | echon | 2009-09-06 09:20:53 -0700 (Sun, 06 Sep 2009) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

Don't generate tangent vectors when GLSL is off, small improvement to anim caching..
------------------------------------------------------------------------
r9165 | divverent | 2009-09-06 02:47:42 -0700 (Sun, 06 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fixed two warnings

------------------------------------------------------------------------
r9164 | echon | 2009-09-06 00:45:28 -0700 (Sun, 06 Sep 2009) | 1 line
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_rmain.c

Added animation caching, which speeds up re-renders of all animated meshes
------------------------------------------------------------------------
r9163 | echon | 2009-09-06 00:13:55 -0700 (Sun, 06 Sep 2009) | 1 line
Changed paths:
   M /trunk/darkplaces/darkplaces-dedicated.vcproj
   M /trunk/darkplaces/darkplaces-sdl.vcproj
   M /trunk/darkplaces/darkplaces.sln
   M /trunk/darkplaces/darkplaces.vcproj

Added a Profile build option, which is simply release with symbols
------------------------------------------------------------------------
r9162 | echon | 2009-09-05 22:28:45 -0700 (Sat, 05 Sep 2009) | 1 line
Changed paths:
   M /trunk/darkplaces/darkplaces.sln

Update for 2k8 sp1... apparently they changed a comment in the solution file. Important stuff right here.
------------------------------------------------------------------------
r9161 | echon | 2009-09-05 22:24:59 -0700 (Sat, 05 Sep 2009) | 1 line
Changed paths:
   M /trunk/darkplaces

Ignore *.suo and *.user visual studio local files
------------------------------------------------------------------------
r9160 | divverent | 2009-09-03 00:48:28 -0700 (Thu, 03 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

another oops, sorry, forgot to commit this from at home

------------------------------------------------------------------------
r9159 | divverent | 2009-09-03 00:42:22 -0700 (Thu, 03 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/menu.h
   M /trunk/darkplaces/mvm_cmds.c

stuff I forgot to commit

------------------------------------------------------------------------
r9158 | divverent | 2009-09-02 22:47:07 -0700 (Wed, 02 Sep 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/mvm_cmds.c

Quake menu: show DP's weird resolution set in windowed mode, and really detected modes in fullscreen.
menu QC: getresolution() now has an optional second arg "forfullscreen", that if 0 queries the "hardcoded" resolution list and if 1 (or left out) queries the system-provided list.

------------------------------------------------------------------------
r9157 | divverent | 2009-09-02 22:25:55 -0700 (Wed, 02 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

as requested by LH, #if 0 out cycleweapon

------------------------------------------------------------------------
r9156 | divverent | 2009-09-02 06:08:52 -0700 (Wed, 02 Sep 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/sv_main.c

do not crash when zlib is missing, but instead do not use deflate/inflate

------------------------------------------------------------------------
r9155 | divverent | 2009-08-31 00:06:53 -0700 (Mon, 31 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

change two more MAX_QPATH to MAX_OSPATH

------------------------------------------------------------------------
r9154 | divverent | 2009-08-31 00:04:57 -0700 (Mon, 31 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/libcurl.c

s/QPATH/OSPATH/g in libcurl

------------------------------------------------------------------------
r9152 | divverent | 2009-08-28 09:21:42 -0700 (Fri, 28 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

bugfix

------------------------------------------------------------------------
r9151 | divverent | 2009-08-28 09:15:48 -0700 (Fri, 28 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/client.h

particles: allow a particlefont.txt file (same dir as particlefont.tga) to override the particle texcoords, so one can put more particles on the particle font

------------------------------------------------------------------------
r9149 | divverent | 2009-08-27 05:19:28 -0700 (Thu, 27 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/cl_screen.h
   M /trunk/darkplaces/gl_rmain.c

re-enable saturation on sidebyside and stereobuffer (it's harmless there), only keep it disabled in colormasked stereo

------------------------------------------------------------------------
r9148 | divverent | 2009-08-27 05:09:07 -0700 (Thu, 27 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/cl_screen.h
   M /trunk/darkplaces/gl_rmain.c

turn off saturation and motion/damage blur if a stereo rendering mode is active (as they do not work there)

------------------------------------------------------------------------
r9146 | divverent | 2009-08-24 07:08:03 -0700 (Mon, 24 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

change scr_screenshot_name_use_mapname to scr_screenshot_name_in_mapdir, and use mapname/nexuiz000001.jpg like names when set (idea by both r00t and Spaceman)

------------------------------------------------------------------------
r9145 | divverent | 2009-08-24 06:04:22 -0700 (Mon, 24 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

cvar scr_screenshot_name_use_mapname: if set to 1, saves screenshots as nexuizbasement00001.jpg (i.e. map name inside screenshot name)

------------------------------------------------------------------------
r9144 | divverent | 2009-08-24 02:54:41 -0700 (Mon, 24 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_execprogram.h

yet another typo :( typing with lag sucks

------------------------------------------------------------------------
r9143 | divverent | 2009-08-24 02:49:15 -0700 (Mon, 24 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_execprogram.h

fix typo

------------------------------------------------------------------------
r9142 | divverent | 2009-08-24 02:45:28 -0700 (Mon, 24 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_execprogram.h
   M /trunk/darkplaces/quakedef.h

okay, fix the latest fix :P

------------------------------------------------------------------------
r9141 | divverent | 2009-08-23 22:41:33 -0700 (Sun, 23 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_execprogram.h

chnage "negative zero" check to actually check the bit pattern of IEEE negative zeros; might fix motorsep's problems on Win32/SDL only (maybe SDL changes FPU parameters?)

------------------------------------------------------------------------
r9140 | divverent | 2009-08-23 22:39:51 -0700 (Sun, 23 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_execprogram.h

add bounds check on OP_ADDRESS

------------------------------------------------------------------------
r9139 | samual | 2009-08-23 02:07:07 -0700 (Sun, 23 Aug 2009) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

Change recommended value for motionblur to 0.5 due to 0.7 looking slightly excessive
------------------------------------------------------------------------
r9138 | divverent | 2009-08-21 07:04:09 -0700 (Fri, 21 Aug 2009) | 5 lines
Changed paths:
   M /trunk/darkplaces/vid_sdl.c


--Trninghis line, and those below, will be ignored--

M    vid_sdl.c

------------------------------------------------------------------------
r9137 | divverent | 2009-08-20 01:24:00 -0700 (Thu, 20 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

clean up lightmap merge  power code

------------------------------------------------------------------------
r9136 | divverent | 2009-08-20 00:53:38 -0700 (Thu, 20 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/jpeg.c

also rename these fields, so nobody starts using them

------------------------------------------------------------------------
r9135 | divverent | 2009-08-20 00:51:23 -0700 (Thu, 20 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/jpeg.c

shut up jpeg warnings another way

------------------------------------------------------------------------
r9134 | divverent | 2009-08-20 00:36:16 -0700 (Thu, 20 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cap_avi.c
   M /trunk/darkplaces/cap_avi.h
   M /trunk/darkplaces/cap_ogg.c
   M /trunk/darkplaces/cap_ogg.h
   M /trunk/darkplaces/cd_shared.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/console.h
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/jpeg.c
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/libcurl.c
   M /trunk/darkplaces/libcurl.h
   M /trunk/darkplaces/makefile.inc
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/netconn.h
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/prvm_exec.c
   M /trunk/darkplaces/sbar.c
   M /trunk/darkplaces/screen.h
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/vid_agl.c
   M /trunk/darkplaces/vid_sdl.c

fix all the () problems, and make gcc warn for them

------------------------------------------------------------------------
r9133 | divverent | 2009-08-20 00:34:50 -0700 (Thu, 20 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fix lightmap merging with external lightmaps

------------------------------------------------------------------------
r9132 | havoc | 2009-08-19 20:17:28 -0700 (Wed, 19 Aug 2009) | 1 line
Changed paths:
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/vid_sdl.c

Fix warnings in div0's commits using functions with () as parameter list but a prototype of (void), MSVC does not like this mistake.
------------------------------------------------------------------------
r9131 | havoc | 2009-08-19 01:29:31 -0700 (Wed, 19 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

fix glDrawRangeElements issue with mesa

------------------------------------------------------------------------
r9130 | divverent | 2009-08-18 23:23:22 -0700 (Tue, 18 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_wgl.c

snd_mutewhenidle 0: do NOT still mute when app is hidden (e.g. virtual desktop change)

------------------------------------------------------------------------
r9129 | divverent | 2009-08-18 23:21:14 -0700 (Tue, 18 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

fix that bounds check, it was stupid (< 0 = builtin)

------------------------------------------------------------------------
r9128 | divverent | 2009-08-18 23:20:31 -0700 (Tue, 18 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

fix typo in 9126

------------------------------------------------------------------------
r9127 | divverent | 2009-08-18 23:19:36 -0700 (Tue, 18 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_execprogram.h

bounds check function calls, and entity indexes in LOAD instructions

------------------------------------------------------------------------
r9126 | divverent | 2009-08-18 23:19:12 -0700 (Tue, 18 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

add comments for missing bounds checks; bounds check function start offsets

------------------------------------------------------------------------
r9125 | divverent | 2009-08-18 23:14:04 -0700 (Tue, 18 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

progs: require the last statement to be GOTO, DONE or RETURN. Ensures the statement pointer can never fall out of the progs.

------------------------------------------------------------------------
r9124 | divverent | 2009-08-18 23:11:51 -0700 (Tue, 18 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_agl.c

support mute-when-idle properly

------------------------------------------------------------------------
r9123 | samual | 2009-08-18 16:57:47 -0700 (Tue, 18 Aug 2009) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix motionblur cvar descriptions, also: First commit! :D
------------------------------------------------------------------------
r9122 | havoc | 2009-08-18 16:40:33 -0700 (Tue, 18 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_execprogram.h

fix div0's bug

------------------------------------------------------------------------
r9121 | divverent | 2009-08-18 09:27:16 -0700 (Tue, 18 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_execprogram.h

mark another place of missing bounds check

------------------------------------------------------------------------
r9120 | divverent | 2009-08-18 09:02:51 -0700 (Tue, 18 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_execprogram.h

identify two missing bounds checks (fix them later)

------------------------------------------------------------------------
r9119 | divverent | 2009-08-16 10:11:32 -0700 (Sun, 16 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/lhnet.c

fix two SOCKLEN_Ts

------------------------------------------------------------------------
r9118 | divverent | 2009-08-16 10:06:34 -0700 (Sun, 16 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/svvm_cmds.c

fix pitchsign warnings in dev-c++

------------------------------------------------------------------------
r9117 | divverent | 2009-08-16 09:28:46 -0700 (Sun, 16 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c

cvar con_chatsound (by Surb)

------------------------------------------------------------------------
r9116 | divverent | 2009-08-16 09:21:37 -0700 (Sun, 16 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

honor alpha in showsurfaces 3

------------------------------------------------------------------------
r9115 | divverent | 2009-08-16 04:26:44 -0700 (Sun, 16 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

fix reset of capturevideo fps

------------------------------------------------------------------------
r9114 | divverent | 2009-08-14 13:26:53 -0700 (Fri, 14 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_sdl.c

remove wait states for SDL

------------------------------------------------------------------------
r9113 | divverent | 2009-08-14 12:39:24 -0700 (Fri, 14 Aug 2009) | 12 lines
Changed paths:
   M /trunk/darkplaces/prvm_execprogram.h

experimental change: do a float compare for OP_IF and OP_IFNOT, so negative
zero float value counts as false. No other value in QC can have the bit pattern
0x80000000 as long as no int type is added.

I have verified that the only false floats on x86_64 and i386 are 0 and
0x80000000.  However, this may fail on other platforms! (but then, OR_F and
others would also fail in some cases, as fteqcc also uses it for "float ||
entity").

When an "int" type is introduced, we'll need a new IF_I and IFNOT_I instruction
as then this would REALLY have a bad impact.

------------------------------------------------------------------------
r9112 | divverent | 2009-08-14 12:29:03 -0700 (Fri, 14 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

fix a small bug in prvm_getstring (returning NULL instead of "")

------------------------------------------------------------------------
r9111 | divverent | 2009-08-14 05:02:31 -0700 (Fri, 14 Aug 2009) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

cvar cl_movecliptokeyboard: clip movement vectors to the keyboard states (1), or directions (2) (in case they are generated by an analog way, e.g. mouse move, or joystick).

Mostly for matching Nexuiz's anti-strafebot code.

------------------------------------------------------------------------
r9110 | divverent | 2009-08-13 22:29:50 -0700 (Thu, 13 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_sdl.c

SDL/Win32: queue a vid_restart if resized; this should fix vid_resizable issue on Win32 with SDL

------------------------------------------------------------------------
r9109 | havoc | 2009-08-11 18:29:45 -0700 (Tue, 11 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

493

------------------------------------------------------------------------
r9108 | havoc | 2009-08-08 17:31:17 -0700 (Sat, 08 Aug 2009) | 4 lines
Changed paths:
   M /trunk/darkplaces/makefile.inc

patch from Jason Hatton adding a release-profile build target that uses
the results of -fprofile-arcs on a previous run of the profile build,
and says it greatly improves framerates

------------------------------------------------------------------------
r9107 | divverent | 2009-08-08 08:42:09 -0700 (Sat, 08 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

new command line option -modname to override DP's idea of com_modname (useful to e.g. send another mod name to the master server)

------------------------------------------------------------------------
r9106 | havoc | 2009-08-08 01:50:16 -0700 (Sat, 08 Aug 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

disable sv_gameplayfix_slidemoveprojectiles in hipnotic mission pack
because it makes prox mines bounce off of surfaces

------------------------------------------------------------------------
r9105 | divverent | 2009-08-07 11:41:03 -0700 (Fri, 07 Aug 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

actually, set the threshold to 10.
If an entity receive function takes now 0.2222 seconds, and repeatedly does so when the ent is received, it's insane even at initialization.

------------------------------------------------------------------------
r9104 | divverent | 2009-08-07 11:39:53 -0700 (Fri, 07 Aug 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c

Stupid hack: force an entity frame once 5 frames were skipped.
Fixes issues with cl_movement replay taking longer and longer when standing still and nothing on the map moves, while not causing so many empty entity frames that replay of lost frames can cause problems (well, in theory it now can, if an entity takes 5+3 server frames to be processed on the client, that is 0.1sec at a sys_ticrate matching 72fps - so try to avoid doing overlong processing in CSQC entity receive functions).

------------------------------------------------------------------------
r9103 | divverent | 2009-08-06 22:55:43 -0700 (Thu, 06 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cvar.c
   M /trunk/darkplaces/cvar.h
   M /trunk/darkplaces/fs.c

add a fs_gamedir cvar containing the currently active gamedirs (for use by menu QC to know which one is active)

------------------------------------------------------------------------
r9102 | divverent | 2009-08-06 22:55:22 -0700 (Thu, 06 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/zone.h

for now, turn off MEMPARANOIA

------------------------------------------------------------------------
r9101 | divverent | 2009-08-06 21:35:21 -0700 (Thu, 06 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

fix use of variable name "dir"

------------------------------------------------------------------------
r9100 | divverent | 2009-08-06 12:14:30 -0700 (Thu, 06 Aug 2009) | 4 lines
Changed paths:
   M /trunk/darkplaces/mvm_cmds.c

menu QC builtin getgamedirinfo(float gamedirno, float index);
index = 0: directory name
index = 1: description (modinfo.txt content)

------------------------------------------------------------------------
r9099 | divverent | 2009-08-06 12:06:22 -0700 (Thu, 06 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/fs.h

provide a list of all gamedirs with modinfo.txt in fs_all_gamedirs for later use by menu

------------------------------------------------------------------------
r9098 | divverent | 2009-08-06 11:33:48 -0700 (Thu, 06 Aug 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/fs.h

restructuring for gamedir enumerating (cannot enumerate yet);
also accept "gamedir" when it only exists in the user home dir

------------------------------------------------------------------------
r9097 | divverent | 2009-08-05 11:41:55 -0700 (Wed, 05 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_agl.c

maybe it compiles now

------------------------------------------------------------------------
r9096 | divverent | 2009-08-05 11:41:01 -0700 (Wed, 05 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_agl.c

add missing functions

------------------------------------------------------------------------
r9095 | divverent | 2009-08-05 11:36:22 -0700 (Wed, 05 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_agl.c

add missing mainDisplay ina gl

------------------------------------------------------------------------
r9094 | divverent | 2009-08-05 11:13:34 -0700 (Wed, 05 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_agl.c

agl: experimental code to enumerate video modes (untested, uncompiled)

------------------------------------------------------------------------
r9093 | divverent | 2009-08-05 10:05:37 -0700 (Wed, 05 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_sdl.c

fix crash in SDL mode listing

------------------------------------------------------------------------
r9092 | divverent | 2009-08-05 06:36:58 -0700 (Wed, 05 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_wgl.c

fixes for vid_wgl

------------------------------------------------------------------------
r9091 | divverent | 2009-08-05 06:30:03 -0700 (Wed, 05 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

move resolution enumerating to the RIGHT point

------------------------------------------------------------------------
r9090 | divverent | 2009-08-05 06:04:50 -0700 (Wed, 05 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/vid_shared.c

add bounds check to menu function to query resolutions

------------------------------------------------------------------------
r9089 | divverent | 2009-08-05 05:55:45 -0700 (Wed, 05 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/menu.h
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_agl.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_null.c
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c

glx, sdl, wgl: autodetect all supported video modes, override the Quake menu's list by it

------------------------------------------------------------------------
r9088 | divverent | 2009-08-04 12:41:01 -0700 (Tue, 04 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

onground check: don't trace down by 2 units but just by one; now clientside doublejump bug cannot happen below 300fps

------------------------------------------------------------------------
r9087 | divverent | 2009-08-03 12:14:00 -0700 (Mon, 03 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

gameversion_min, gameversion_max, to support a RANGE of compatible game versions (off by default)

------------------------------------------------------------------------
r9086 | divverent | 2009-08-03 09:02:59 -0700 (Mon, 03 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/sv_phys.c

remove some unfounded warnings of some gcc versions :P

------------------------------------------------------------------------
r9085 | divverent | 2009-08-03 04:53:47 -0700 (Mon, 03 Aug 2009) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/collision.c
   M /trunk/darkplaces/collision.h
   M /trunk/darkplaces/sv_phys.c

Collision: insert a really stupid workaround: make every trace 1qu longer, and retroactively shrink the trace when done.

Bug this works around for: when doing a trace from A to B, B being just slightly inside solid, the trace ends "successfully" with fraction 1. However, a trace starting in B will be startsolid. This workaround removes this inconsistency, which sometimes causes map fallthrough, and should have no other side effects, not even a noticable performance impact.

------------------------------------------------------------------------
r9084 | divverent | 2009-08-02 03:44:55 -0700 (Sun, 02 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

unsticking: properly handle playerclip

------------------------------------------------------------------------
r9083 | divverent | 2009-08-01 13:31:24 -0700 (Sat, 01 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

abort ANY movetype_walk move once a touch function moved the player

------------------------------------------------------------------------
r9082 | divverent | 2009-08-01 12:42:54 -0700 (Sat, 01 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

fix typo in last commit

------------------------------------------------------------------------
r9081 | divverent | 2009-08-01 08:31:42 -0700 (Sat, 01 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

alias model: fix tracebox

------------------------------------------------------------------------
r9080 | divverent | 2009-08-01 08:20:46 -0700 (Sat, 01 Aug 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

properly handle the case that the touch fucntion teleported the player

------------------------------------------------------------------------
r9079 | divverent | 2009-07-31 05:54:17 -0700 (Fri, 31 Jul 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

fix a bug in the teleport detection that made it hit VERY often

------------------------------------------------------------------------
r9078 | divverent | 2009-07-31 04:45:28 -0700 (Fri, 31 Jul 2009) | 9 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

tiny behaviour changes to MOVETYPE_WALK (players) that need thorough testing:

- SV_LinkEntity gets called before calling touch handlers so findradius works in impact-caused touch function calls. However, area grid touching is only performed at the end of the move.
- the onground flag and the groundentity are updated after, not before, calling the touch functions (PLEASE TELL ME if this was a bad change!)
- the correct MOVE_ type is used for the touch (so spectators that have not gotten their MOVETYPE changed cannot cause projectiles to explode)
- a walk-moving SOLID_NOT therefore never causes touch functions to be called
- in case the touch function modifies the origin field, the move is aborted and a teleport is assumed; this should enable mods to make solid teleporters/portals that work at any impact velocity and are not bound by the area grid limitations of not working for big velocities


------------------------------------------------------------------------
r9077 | havoc | 2009-07-31 02:57:06 -0700 (Fri, 31 Jul 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

fix compile error

------------------------------------------------------------------------
r9076 | havoc | 2009-07-31 02:48:15 -0700 (Fri, 31 Jul 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_shared.c

made num_poses always be the number of poses in a model, not the amount
of animation bone data (this fixed psk loading crashes)

------------------------------------------------------------------------
r9075 | divverent | 2009-07-25 01:16:47 -0700 (Sat, 25 Jul 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

hopefully fix saturation without postprocess

------------------------------------------------------------------------
r9074 | divverent | 2009-07-25 00:37:39 -0700 (Sat, 25 Jul 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

unbound conwidth/conheight a little

------------------------------------------------------------------------
r9073 | divverent | 2009-07-23 11:31:08 -0700 (Thu, 23 Jul 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

this seems to fix autosprite2

------------------------------------------------------------------------
r9072 | divverent | 2009-07-22 14:10:50 -0700 (Wed, 22 Jul 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

improve collision stride parameters, improves server performance on testcase.pk3 by another 5%

------------------------------------------------------------------------
r9071 | divverent | 2009-07-22 05:11:32 -0700 (Wed, 22 Jul 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fixes for the latest commits

------------------------------------------------------------------------
r9070 | divverent | 2009-07-22 04:04:36 -0700 (Wed, 22 Jul 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

also optimize findbetterlocation-like functions to use combined bboxes on patches; SHOULD fix "low fps when shooting patch with machine gun" issue. Will test it later.

------------------------------------------------------------------------
r9069 | divverent | 2009-07-22 03:57:53 -0700 (Wed, 22 Jul 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

refactoring as preparation for upcoming optimization

------------------------------------------------------------------------
r9068 | divverent | 2009-07-22 03:52:09 -0700 (Wed, 22 Jul 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h

a minor cleanup; also generate the combined bboxes for the render patches (not used yet, will be used to fix slowness with findbetterlocation)

------------------------------------------------------------------------
r9067 | divverent | 2009-07-22 03:34:31 -0700 (Wed, 22 Jul 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/curves.c

curves: optimize their order for the bbox optimization

------------------------------------------------------------------------
r9066 | divverent | 2009-07-22 00:43:30 -0700 (Wed, 22 Jul 2009) | 4 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

mod_q3bsp_optimizedtraceline: also do a line trace if the mins/maxs of the trace are NOT the zero vector, but equal.
This fixes problems with grenades falling through patches in Nexuiz.
MAYBE this problem only affects zero size or very small bboxes?

------------------------------------------------------------------------
r9065 | divverent | 2009-07-21 12:23:09 -0700 (Tue, 21 Jul 2009) | 6 lines
Changed paths:
   M /trunk/darkplaces/collision.c
   M /trunk/darkplaces/collision.h
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h

Collision against patches: do some major optimizations.
Keep an array of combined mins and maxs of every 32 consecutive triangles of the patch mesh.
Always collide against the mins/maxs in this array first before actually trying the triangles.
Improves collision performance a LOT, testcase.pk3 (a huge 31x31 patch mesh) becomes playable.
mod_q3bsp_collision_curves_stride value still needs optimizing, I think.

------------------------------------------------------------------------
r9064 | divverent | 2009-07-20 08:30:38 -0700 (Mon, 20 Jul 2009) | 4 lines
Changed paths:
   M /trunk/darkplaces/BSDmakefile
   M /trunk/darkplaces/jpeg.c
   M /trunk/darkplaces/makefile

experimental makefile option make DP_LINK_TO_JPEG=1 - use libjpeg.h instead of dynamic loading of libjpeg at startup.

Can anyone test this against libjpeg7? 

------------------------------------------------------------------------
r9062 | divverent | 2009-07-17 01:17:31 -0700 (Fri, 17 Jul 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

cs_*project: return console/draw* coordinate space. No more multiplying by vid_conwidth/vid_width needed!

------------------------------------------------------------------------
r9061 | divverent | 2009-07-17 00:56:01 -0700 (Fri, 17 Jul 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

fix v_flipped in cs_unproject (it was correct in cs_project) if a view port is set up

------------------------------------------------------------------------
r9060 | divverent | 2009-07-16 12:44:18 -0700 (Thu, 16 Jul 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/libcurl.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/sbar.c
   M /trunk/darkplaces/zone.c

some typo fixes, + unalias command

------------------------------------------------------------------------
r9059 | divverent | 2009-07-15 23:45:10 -0700 (Wed, 15 Jul 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

rename internal var, no real change

------------------------------------------------------------------------
r9058 | divverent | 2009-07-15 23:38:27 -0700 (Wed, 15 Jul 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

motion blur/dmaage blur config change by Samual, and a fix for damage blur not working without motion blur

------------------------------------------------------------------------
r9057 | divverent | 2009-07-14 02:05:08 -0700 (Tue, 14 Jul 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h

only show "shader already defined" messages if the two shaders actually mismatch
for matching shaders, hide the message if developer is 0

------------------------------------------------------------------------
r9056 | havoc | 2009-07-12 15:25:50 -0700 (Sun, 12 Jul 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/zone.c

fix a compile error when MEMPARANOIA is off

------------------------------------------------------------------------
r9055 | havoc | 2009-07-12 15:25:26 -0700 (Sun, 12 Jul 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

stabilize showfps a bit

------------------------------------------------------------------------
r9054 | divverent | 2009-07-12 05:03:11 -0700 (Sun, 12 Jul 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/zone.c

get uintptr_t from vadefs.h on MSVC

------------------------------------------------------------------------
r9052 | divverent | 2009-07-08 08:32:32 -0700 (Wed, 08 Jul 2009) | 2 lines
Changed paths:
   A /trunk/darkplaces/Doxyfile
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/cmd.h
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/console.h
   M /trunk/darkplaces/cvar.h
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/fs.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/input.h
   M /trunk/darkplaces/jpeg.h
   M /trunk/darkplaces/mathlib.h
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/menu.h
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/netconn.h
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/sbar.h
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sys.h
   M /trunk/darkplaces/world.c
   M /trunk/darkplaces/world.h

doxygen comments and config file

------------------------------------------------------------------------
r9051 | divverent | 2009-07-08 08:29:20 -0700 (Wed, 08 Jul 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c

fix rounding of drawsetcliparea coordinates (but not using round(), as that is C99)

------------------------------------------------------------------------
r9050 | divverent | 2009-07-08 08:26:29 -0700 (Wed, 08 Jul 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_sdl.c

thanks

------------------------------------------------------------------------
r9049 | havoc | 2009-07-07 17:45:04 -0700 (Tue, 07 Jul 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_gecko.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/image_png.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/svvm_cmds.c
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/world.c
   M /trunk/darkplaces/zone.c

fixed several warnings that appear with -std=gnu99 -pedantic

------------------------------------------------------------------------
r9048 | divverent | 2009-07-07 13:09:30 -0700 (Tue, 07 Jul 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix saturation (how and why did this line disappear?)

------------------------------------------------------------------------
r9047 | havoc | 2009-07-07 12:22:28 -0700 (Tue, 07 Jul 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/prvm_execprogram.h

more _int changes, but these are only in the commented out integer
support

------------------------------------------------------------------------
r9046 | havoc | 2009-07-07 11:29:49 -0700 (Tue, 07 Jul 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_execprogram.h

use ivector for all vector copy instructions, not vector

------------------------------------------------------------------------
r9045 | divverent | 2009-07-05 23:56:39 -0700 (Sun, 05 Jul 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/quakedef.h

twice as many models loadable (for LOD and stuff)

------------------------------------------------------------------------
r9044 | divverent | 2009-07-05 11:49:21 -0700 (Sun, 05 Jul 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

add an error message

------------------------------------------------------------------------
r9043 | divverent | 2009-07-05 11:47:14 -0700 (Sun, 05 Jul 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/svvm_cmds.c

fix buffer overruns in sv.model_precache

------------------------------------------------------------------------
r9042 | divverent | 2009-07-05 10:18:52 -0700 (Sun, 05 Jul 2009) | 22 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_shadow.c

Support a separate texture matrix for the background layer.

Example shader stages using it:

{
	map textures/savdm6ish/#lava1.jpg
}
{
	map textures/final_rage/lava.blend.tga
	tcMod rotate 50
	tcMod scale 2 2
	tcMod scroll 0.05 0.05
	alphaGen vertex
	blendFunc GL_SRC_ALPHA GL_ONE_MINUS_SRC_ALPHA
}

NOTE: you still have to specify alphaGen vertex, or DP will not use the
secondary stage! To allow static mixing of two textures, the second texture
currently must have its own alpha channel.

Stuff also possible with this: detail textures...

------------------------------------------------------------------------
r9041 | divverent | 2009-07-04 08:04:46 -0700 (Sat, 04 Jul 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

fix typo in pqrcon

------------------------------------------------------------------------
r9040 | divverent | 2009-07-03 02:11:51 -0700 (Fri, 03 Jul 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

add a second trigger for the same incompatibility detection

------------------------------------------------------------------------
r9039 | divverent | 2009-07-03 01:48:29 -0700 (Fri, 03 Jul 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

CPMA physics: force airaccelqw=1 when strafing if using CPMA-style modded strafe acceleration (otherwise, it can be used as a weird movement exploit)

------------------------------------------------------------------------
r9037 | divverent | 2009-06-30 23:39:45 -0700 (Tue, 30 Jun 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

stringwidth(): add a third font size argument (optional) to help with later porting to freetype

------------------------------------------------------------------------
r9035 | divverent | 2009-06-27 13:07:30 -0700 (Sat, 27 Jun 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cmd.c

properly handle comments when looking for final ; of a line

------------------------------------------------------------------------
r9034 | divverent | 2009-06-27 13:04:06 -0700 (Sat, 27 Jun 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cmd.c

better expand variables inside comments than breaking lots of otherwise working stuff because of bad comment detection.

------------------------------------------------------------------------
r9033 | havoc | 2009-06-27 03:56:56 -0700 (Sat, 27 Jun 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

patch from Lardarse that makes monsters/secrets show up if they are
non-zero even if the total monsters/secrets is 0

------------------------------------------------------------------------
r9032 | divverent | 2009-06-23 12:11:15 -0700 (Tue, 23 Jun 2009) | 4 lines
Changed paths:
   M /trunk/darkplaces/cd_sdl.c
   M /trunk/darkplaces/cmd.c

* don't expand cvars in comments
* improve text definition of alias
* fix SDL cd loop bug

------------------------------------------------------------------------
r9031 | divverent | 2009-06-21 13:22:20 -0700 (Sun, 21 Jun 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

teleport bit: always reset animation there too

------------------------------------------------------------------------
r9030 | divverent | 2009-06-21 13:14:31 -0700 (Sun, 21 Jun 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

fix a crash in dpm + framegroups

------------------------------------------------------------------------
r9029 | divverent | 2009-06-21 12:49:11 -0700 (Sun, 21 Jun 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

fix framegroups file parsing out of bounds errors

------------------------------------------------------------------------
r9027 | divverent | 2009-06-21 12:34:24 -0700 (Sun, 21 Jun 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

Support frame groups for ALL model formats (a slightly extended version of animinfo, with a fourth element being 0 when the animation is not to be looped).
With this, all model formats can be self animated, but do not need to be (simply don't make a framegroups file if you wish it to be not self animated).

------------------------------------------------------------------------
r9025 | divverent | 2009-06-20 08:01:45 -0700 (Sat, 20 Jun 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c

messagemode/commandmode: clear the string on entering the mode

------------------------------------------------------------------------
r9024 | divverent | 2009-06-18 17:02:42 -0700 (Thu, 18 Jun 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

experimental motion blur code (original by Samual on http://dev.alientrap.org/attachments/220/Motion_Blur_RC2.diff), needs adjustments especially for damage blur

------------------------------------------------------------------------
r9022 | divverent | 2009-06-17 06:41:00 -0700 (Wed, 17 Jun 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/cvar.c
   M /trunk/darkplaces/cvar.h

when the engine is compiled with -DFILLALLCVARSWITHRUBBISH, there is an extra console command fillallcvarswithrubbish that can be used to check for buffer overruns by putting very large strings into all cvars

------------------------------------------------------------------------
r9021 | divverent | 2009-06-16 11:41:24 -0700 (Tue, 16 Jun 2009) | 5 lines
Changed paths:
   M /trunk/darkplaces/cap_avi.c
   M /trunk/darkplaces/cap_ogg.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/client.h

cl_capturevideo_framestep
example: when set to 4, and cl_capturevideo_fps is 30
then DP will run at 120fps and capture at 30fps
currently pointless, will be great once motion blur is done

------------------------------------------------------------------------
r9020 | divverent | 2009-06-16 08:19:46 -0700 (Tue, 16 Jun 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/zone.c
   M /trunk/darkplaces/zone.h

MUCH more paranoid memory checking (use random address dependent sentinels)

------------------------------------------------------------------------
r9019 | divverent | 2009-06-13 11:36:58 -0700 (Sat, 13 Jun 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/svvm_cmds.c

DP_SV_BOUNCEFACTOR

------------------------------------------------------------------------
r9018 | divverent | 2009-06-13 10:43:07 -0700 (Sat, 13 Jun 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/keys.c

shift netgraph up by sbar_info_pos;
fix printf vulnerability in terencehill's ctrl-tab code

------------------------------------------------------------------------
r9017 | divverent | 2009-06-11 03:38:05 -0700 (Thu, 11 Jun 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/palette.c

contrastboost: fix a division by zero that can never happen ;)

------------------------------------------------------------------------
r9016 | divverent | 2009-06-11 03:32:25 -0700 (Thu, 11 Jun 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_shared.c

v_contrastboost: unclamp

------------------------------------------------------------------------
r9015 | havoc | 2009-06-10 19:08:32 -0700 (Wed, 10 Jun 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/netconn.h

patch from RocketGuy for pqrcon command, to administrate proquake
servers

------------------------------------------------------------------------
r9014 | divverent | 2009-06-10 09:17:35 -0700 (Wed, 10 Jun 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

typo

------------------------------------------------------------------------
r9013 | divverent | 2009-06-10 08:31:19 -0700 (Wed, 10 Jun 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

sbar_info_pos

------------------------------------------------------------------------
r9012 | divverent | 2009-06-09 03:06:49 -0700 (Tue, 09 Jun 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

make tcgen environment work exactly like in Q3A (the previous code didn't just use pixels from the spheremap, it even left the bounds of it), but let it transform the reflected ray to worldspace so it can even be used on models

------------------------------------------------------------------------
r9011 | divverent | 2009-06-08 08:58:00 -0700 (Mon, 08 Jun 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

parentheses error in cs_unproject

------------------------------------------------------------------------
r9010 | divverent | 2009-06-08 06:52:04 -0700 (Mon, 08 Jun 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cmd.c

larger cbuf

------------------------------------------------------------------------
r9008 | divverent | 2009-06-06 06:02:26 -0700 (Sat, 06 Jun 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

simplify glsl code (we can do vec3(y))

------------------------------------------------------------------------
r9007 | divverent | 2009-06-06 04:05:04 -0700 (Sat, 06 Jun 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/keys.c

console enhancements finally ready (changed mouse wheel/page down behaviour, text zoom, cvar value insertion)

------------------------------------------------------------------------
r9006 | divverent | 2009-06-06 03:36:53 -0700 (Sat, 06 Jun 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

glsl: add a saturation adjustment r_glsl_saturation (set to 0 for grayscale, to 1 for unchanged (and highest fps), to 2 for extreme)

------------------------------------------------------------------------
r9005 | divverent | 2009-06-01 23:48:31 -0700 (Mon, 01 Jun 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/filematch.c

this time, actually commit the matchpattgern fix

------------------------------------------------------------------------
r9004 | divverent | 2009-06-01 08:30:11 -0700 (Mon, 01 Jun 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c

fix another race condition when stopping ALL sounds

------------------------------------------------------------------------
r9003 | divverent | 2009-06-01 08:25:29 -0700 (Mon, 01 Jun 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c

fix a race condition in DP's sound handling; note: there may be more of them

------------------------------------------------------------------------
r9001 | divverent | 2009-05-31 05:45:33 -0700 (Sun, 31 May 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c

make DP run in wine again

------------------------------------------------------------------------
r9000 | divverent | 2009-05-31 04:26:07 -0700 (Sun, 31 May 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_wgl.c

don't check for "wgl" as extension name

------------------------------------------------------------------------
r8999 | divverent | 2009-05-30 10:48:13 -0700 (Sat, 30 May 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/mvm_cmds.c

provide isdemo() to menu QC

------------------------------------------------------------------------
r8998 | divverent | 2009-05-29 11:55:17 -0700 (Fri, 29 May 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cmd.c

even nicer :P

------------------------------------------------------------------------
r8997 | divverent | 2009-05-29 11:53:45 -0700 (Fri, 29 May 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/cvar.c

colorize cvarlist and completion nicely

------------------------------------------------------------------------
r8995 | divverent | 2009-05-28 09:07:32 -0700 (Thu, 28 May 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/cvar.c

apropos command

------------------------------------------------------------------------
r8994 | divverent | 2009-05-28 08:38:36 -0700 (Thu, 28 May 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cmd.c

do not exit comment by ;, only by linefeed

------------------------------------------------------------------------
r8993 | divverent | 2009-05-28 03:49:43 -0700 (Thu, 28 May 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

s/random()/rand()/, sorry

------------------------------------------------------------------------
r8992 | divverent | 2009-05-26 22:45:34 -0700 (Tue, 26 May 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

effectinfo: properly handle staincolor and color together in PBLEND_INVMOD

------------------------------------------------------------------------
r8991 | divverent | 2009-05-26 22:19:35 -0700 (Tue, 26 May 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_shared.c

patch by parasti; changes to his patch: no per function dprint for now

------------------------------------------------------------------------
r8990 | divverent | 2009-05-26 01:30:50 -0700 (Tue, 26 May 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

give blood stains back

------------------------------------------------------------------------
r8989 | divverent | 2009-05-25 08:33:13 -0700 (Mon, 25 May 2009) | 4 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c


srcon: add random digits to the the time
goal is to prevent replay attacks in a later change and increasing the time sync threshold

------------------------------------------------------------------------
r8988 | divverent | 2009-05-24 13:21:43 -0700 (Sun, 24 May 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

add a note that for secure rcon, client and server clocks need to be synced

------------------------------------------------------------------------
r8987 | divverent | 2009-05-24 12:49:05 -0700 (Sun, 24 May 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

more improvements, making 0x808080 neutral stain color

------------------------------------------------------------------------
r8986 | divverent | 2009-05-24 12:41:40 -0700 (Sun, 24 May 2009) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/keys.c

particle effectinfo: new parameters
  staintex <first> <last>
  staincolor <mincolor> <maxcolor> (gets multiplied by color)

------------------------------------------------------------------------
r8985 | divverent | 2009-05-24 12:32:10 -0700 (Sun, 24 May 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/keys.c

line editing: new binds ctrl-q (push line to history) and ctrl-u (delete line), similar to zsh

------------------------------------------------------------------------
r8984 | havoc | 2009-05-22 03:32:45 -0700 (Fri, 22 May 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c

increased _snd_mixahead from 0.1 to 0.11 to fix static problems on Vista
when using the waveOut code

------------------------------------------------------------------------
r8983 | divverent | 2009-05-21 09:34:01 -0700 (Thu, 21 May 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c

fix bug in console backscroll overflow handlign

------------------------------------------------------------------------
r8982 | divverent | 2009-05-20 12:43:13 -0700 (Wed, 20 May 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/model_shared.c

add some missing casts

------------------------------------------------------------------------
r8981 | divverent | 2009-05-20 10:29:41 -0700 (Wed, 20 May 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/bspfile.h
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h

new supercontents flags: BOTCLIP (matching Q3's botclip), and OPAQUE (matching anything fully opaque, good for line-of-sight checks)

------------------------------------------------------------------------
r8980 | divverent | 2009-05-19 23:11:07 -0700 (Tue, 19 May 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/console.h

improve abstraction of console buffer access; remove now unnecessary accessor macros

------------------------------------------------------------------------
r8979 | divverent | 2009-05-19 22:53:12 -0700 (Tue, 19 May 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/console.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/keys.c

improve abstraction of the console buffers; console drawing still needs to be changed to not use the conbuffer_t struct directly

------------------------------------------------------------------------
r8978 | divverent | 2009-05-19 22:21:32 -0700 (Tue, 19 May 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/console.h
   M /trunk/darkplaces/keys.c

improved persistent input history; now independent buffers are used again, by factoring the buffer handling code out of console code

------------------------------------------------------------------------
r8976 | havoc | 2009-05-17 15:17:55 -0700 (Sun, 17 May 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

reworked default address cvars to be empty for default interfaces, this
avoids resolving an IP6 address using system calls

------------------------------------------------------------------------
r8975 | havoc | 2009-05-17 15:16:58 -0700 (Sun, 17 May 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/lhnet.c

fix an addrinfo leak when getaddrinfo returns an addrinfo that is not
inet or inet6

------------------------------------------------------------------------
r8974 | havoc | 2009-05-17 14:23:12 -0700 (Sun, 17 May 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

try only one port on ip6 if ip4 succeeded, this is to reduce console
spam

------------------------------------------------------------------------
r8973 | divverent | 2009-05-17 12:03:27 -0700 (Sun, 17 May 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/keys.c

also block lines starting with "quit " from the history

------------------------------------------------------------------------
r8972 | divverent | 2009-05-17 12:00:10 -0700 (Sun, 17 May 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/keys.c

argh, should be called darkplaces_history.txt (like darkplaces_iplog.txt)

------------------------------------------------------------------------
r8971 | divverent | 2009-05-17 11:59:45 -0700 (Sun, 17 May 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/console.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/keys.h

experimental new persistent console history (uses same buffer as console output), file name = dp_history.txt, similar to .bash_history

------------------------------------------------------------------------
r8970 | divverent | 2009-05-16 11:00:00 -0700 (Sat, 16 May 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

add a missing cast

------------------------------------------------------------------------
r8969 | divverent | 2009-05-16 10:58:44 -0700 (Sat, 16 May 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

fix another typo

------------------------------------------------------------------------
r8968 | divverent | 2009-05-16 10:54:17 -0700 (Sat, 16 May 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

fix latest commit :P

------------------------------------------------------------------------
r8967 | divverent | 2009-05-16 10:05:41 -0700 (Sat, 16 May 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

print something on "name" length overflow

------------------------------------------------------------------------
r8966 | havoc | 2009-05-15 01:46:20 -0700 (Fri, 15 May 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

don't allocate lightmaps for water surfaces without lightmaps, and do
not assign lightmap texture blocks to non-lightmapped surfaces

------------------------------------------------------------------------
r8965 | havoc | 2009-05-14 15:25:55 -0700 (Thu, 14 May 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/lhnet.c

add a couple more things back

------------------------------------------------------------------------
r8964 | havoc | 2009-05-14 14:23:59 -0700 (Thu, 14 May 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/lhnet.c

fix compatibility with pre-XP windows versions

------------------------------------------------------------------------
r8963 | divverent | 2009-05-14 12:28:47 -0700 (Thu, 14 May 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/lhnet.c

require WinXP or higher for molivier's latest changes.
Good bye, DP on Win2k and below.

------------------------------------------------------------------------
r8962 | divverent | 2009-05-14 12:03:43 -0700 (Thu, 14 May 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cd_shared.c

tiny code cleanups

------------------------------------------------------------------------
r8961 | molivier | 2009-05-14 11:39:25 -0700 (Thu, 14 May 2009) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_exec.c

Fixed a invalid use of the sizeof() operator. Thanks to OpenBSD's custom GCC for the warning.
------------------------------------------------------------------------
r8960 | divverent | 2009-05-14 07:46:06 -0700 (Thu, 14 May 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cd_shared.c

remove one unneeded cdPlaying check

------------------------------------------------------------------------
r8959 | divverent | 2009-05-14 02:08:13 -0700 (Thu, 14 May 2009) | 9 lines
Changed paths:
   M /trunk/darkplaces/cd_sdl.c
   M /trunk/darkplaces/cd_shared.c

Fixes by terrencehill and me:
- better remapping handling of mixed fake and real cdtrack remappings
- fixed bgmvolume handling with CDs
- resume CD audio before stopping (SDL requires that)
- "cd" command showing help
- "cd reset" now always stops
- "cd rescan" command (don't ask me what it's good for)
- apparently work around SDL bug with looping CD tracks after pause and resume

------------------------------------------------------------------------
r8958 | divverent | 2009-05-14 01:34:39 -0700 (Thu, 14 May 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/gl_rsurf.c

r_speeds: show current clusterindex
r_drawportals: draw cluster portals with more alpha than non-cluster portals (needs better visualization still)

------------------------------------------------------------------------
r8957 | molivier | 2009-05-13 22:41:03 -0700 (Wed, 13 May 2009) | 1 line
Changed paths:
   M /trunk/darkplaces/menu.c

Increased the size of the text box containing the name of the server to join, so it can now contain a full IPv6 address
------------------------------------------------------------------------
r8956 | molivier | 2009-05-13 22:40:38 -0700 (Wed, 13 May 2009) | 1 line
Changed paths:
   M /trunk/darkplaces/lhnet.c
   M /trunk/darkplaces/lhnet.h
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/netconn.h

Fixed IPv6 support, including the addition of the master server messages "getserversExt" and "getserversExtResponse"
------------------------------------------------------------------------
r8955 | divverent | 2009-05-12 04:55:14 -0700 (Tue, 12 May 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt
   M /trunk/darkplaces/fs.c

a new "which" command showing which pk3 a file is from

------------------------------------------------------------------------
r8954 | divverent | 2009-05-11 23:23:04 -0700 (Mon, 11 May 2009) | 12 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

m_accelerate_* cvars

My values for my Razer Diamondback 3G:

sensitivity 2
m_accelerate 1.7
m_accelerate_minspeed 5000
m_accelerate_maxspeed 10000
m_accelerate_filter 0.1

Does not interfere with regular aiming, but provides easier 180 degrees turns.

------------------------------------------------------------------------
r8952 | divverent | 2009-05-08 02:58:13 -0700 (Fri, 08 May 2009) | 6 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

simplifying Warsow-style physics code even more, as it now can use a common code path with Quake-style physics (the only difference there is is when moving forward only).

This could be done after the observation that CPMA-style acceleration never kicks in in Warsow mode.

The sv_aircontrol is now expected to be zero in Warsow-style mode, as it does nothing in that mode anyway! If you do set it, you get Warsow and CPMA air control added!

------------------------------------------------------------------------
r8951 | divverent | 2009-05-08 02:45:29 -0700 (Fri, 08 May 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

analyzing the movement algorithm from warsow yielded that CPM_PM_Aircontrol is called but never does anything. Removed the call then...

------------------------------------------------------------------------
r8950 | divverent | 2009-05-08 00:19:29 -0700 (Fri, 08 May 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cvar.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/netconn.h

net_slist_favorites: allow DNS names in the list (they are resolved whenever the cvar is changed)

------------------------------------------------------------------------
r8949 | divverent | 2009-05-07 01:42:34 -0700 (Thu, 07 May 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

oops, fix cvar default

------------------------------------------------------------------------
r8948 | divverent | 2009-05-07 01:24:38 -0700 (Thu, 07 May 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/sv_main.c

cl_input: movevars for "warsowbunny" mode, also implemented in Nexuiz cl_physics.qc soon

------------------------------------------------------------------------
r8947 | divverent | 2009-05-05 23:54:24 -0700 (Tue, 05 May 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

cl_movement: move crouch handling so that sv_maxairspeed*0.5 is maximum crouching speed, not sv_maxspeed*0.5 (matches Nexuiz)

------------------------------------------------------------------------
r8944 | divverent | 2009-05-05 00:55:47 -0700 (Tue, 05 May 2009) | 6 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c

CPMA-style cl_movement physics settings possible! Variables for it:
sv_aircontrol
sv_maxairstrafespeed
sv_airstrafeaccel
sv_airstopaccel

------------------------------------------------------------------------
r8943 | havoc | 2009-05-01 11:22:37 -0700 (Fri, 01 May 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

fix a couple compatibility issues with Nehahra

------------------------------------------------------------------------
r8942 | havoc | 2009-05-01 11:10:06 -0700 (Fri, 01 May 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

r_novis now disables sv_cullentities_pvs, mostly to be more
user-friendly

------------------------------------------------------------------------
r8941 | divverent | 2009-04-29 08:23:37 -0700 (Wed, 29 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_sdl.c

snd_sdl.c: lock the render buffer before running the threaded sound mixer

------------------------------------------------------------------------
r8937 | divverent | 2009-04-22 10:26:58 -0700 (Wed, 22 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

rewrote entity unsticking to be safe from world fallthrough for small entities too (by making the z offsets tried depend on the height of the entity)

------------------------------------------------------------------------
r8936 | divverent | 2009-04-22 02:57:30 -0700 (Wed, 22 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

update IP of dpmaster.tchr.no

------------------------------------------------------------------------
r8935 | divverent | 2009-04-20 08:26:50 -0700 (Mon, 20 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

fix typo in menu_restart command description

------------------------------------------------------------------------
r8934 | havoc | 2009-04-19 13:20:31 -0700 (Sun, 19 Apr 2009) | 1 line
Changed paths:
   M /trunk/darkplaces/todo


------------------------------------------------------------------------
r8933 | divverent | 2009-04-19 03:16:25 -0700 (Sun, 19 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h

fix error message about wrong light grid dimensions

------------------------------------------------------------------------
r8932 | divverent | 2009-04-17 06:56:55 -0700 (Fri, 17 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.h
   M /trunk/darkplaces/svvm_cmds.c

DP_QC_EXTRESPONSEPACKET - getextresponse() function now also in csqc and svqc (same builtin# 624 as in menu qc)

------------------------------------------------------------------------
r8930 | divverent | 2009-04-15 15:38:54 -0700 (Wed, 15 Apr 2009) | 4 lines
Changed paths:
   M /trunk/darkplaces/cd_shared.c
   M /trunk/darkplaces/cdaudio.h
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/snd_3dras.c
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_null.c
   M /trunk/darkplaces/sound.h
   M /trunk/darkplaces/svvm_cmds.c

DP_QC_GETTIME_CDTRACK: extension to query the playing time of the current cd track.

Beware: the timing is currently not exact. Might get improved later.

------------------------------------------------------------------------
r8929 | divverent | 2009-04-14 11:35:40 -0700 (Tue, 14 Apr 2009) | 6 lines
Changed paths:
   M /trunk/darkplaces/keys.c

add a rewrite of terencehill's bindlist commands
Usage:
"bindlist" shows all keys on bindmap 0
"in_bindlist <n>" shows all keys on bindmap n
"in_bindlist" shows all keys on all bindmaps

------------------------------------------------------------------------
r8928 | divverent | 2009-04-14 11:12:46 -0700 (Tue, 14 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c

nick completion bugfix by terencehill

------------------------------------------------------------------------
r8927 | divverent | 2009-04-14 11:09:09 -0700 (Tue, 14 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/keys.c

console enhancements and bug fixes by terencehill

------------------------------------------------------------------------
r8926 | divverent | 2009-04-14 04:43:25 -0700 (Tue, 14 Apr 2009) | 4 lines
Changed paths:
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/sv_phys.c

fix entity reuse of the very last entity before the entity reuse timer expires.

Fixes bug with Nexuiz muzzle flashes sticking to the gun, and some other "PL-like" bugs too.

------------------------------------------------------------------------
r8925 | divverent | 2009-04-14 04:18:19 -0700 (Tue, 14 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

remove accidentally committed debug code again :(

------------------------------------------------------------------------
r8924 | divverent | 2009-04-14 04:17:51 -0700 (Tue, 14 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/model_shared.c

fix r_picmipworld option

------------------------------------------------------------------------
r8923 | divverent | 2009-04-14 00:47:25 -0700 (Tue, 14 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c

fix SND_PickChannel bug choosing an in use channel

------------------------------------------------------------------------
r8922 | divverent | 2009-04-13 04:38:12 -0700 (Mon, 13 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

turn off sv_clmovement_maxnetfps for now, as it causes breakage of cl_netimmediatebuttons (which should be fixed in some way though)

------------------------------------------------------------------------
r8921 | divverent | 2009-04-13 03:38:47 -0700 (Mon, 13 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

up sv_clmovement_maxnetfps to 120, as the worst case issue - falling through solid - no longer can happen. Still gets lots of "unstuck entity" spam messages at high netfps on certain angled slopes due to an old collision bug (trace.endpos sometimes being inside solid when the trace ended very close to solid) which has to be fixed

------------------------------------------------------------------------
r8920 | divverent | 2009-04-13 03:16:49 -0700 (Mon, 13 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

entity unsticking: verify if the new position REALLY is not in solid (should hide and help debugging a pass-through-wall bug with high cl_netfps)

------------------------------------------------------------------------
r8919 | havoc | 2009-04-12 18:47:09 -0700 (Sun, 12 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cd_shared.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/snd_3dras.c
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_main.h
   M /trunk/darkplaces/snd_null.c
   M /trunk/darkplaces/sound.h

fix csqc sound precaches which were being freed after the level loaded

------------------------------------------------------------------------
r8918 | havoc | 2009-04-12 18:46:43 -0700 (Sun, 12 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

yet another check in sv_gameplayfix_slidemoveprojectiles

------------------------------------------------------------------------
r8917 | havoc | 2009-04-12 17:35:51 -0700 (Sun, 12 Apr 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

fix use of r_main_texturepool (it's a pointer, but this file imported it
as a struct)

------------------------------------------------------------------------
r8916 | havoc | 2009-04-12 16:22:57 -0700 (Sun, 12 Apr 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c

added safety checks in S_PlaySfxOnChannel due to a report of a crash
with ch->sfx == NULL in the mixer thread

------------------------------------------------------------------------
r8915 | divverent | 2009-04-12 12:16:00 -0700 (Sun, 12 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_user.c

add a small epsilon to the moveframetime check

------------------------------------------------------------------------
r8914 | divverent | 2009-04-12 12:13:11 -0700 (Sun, 12 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_user.c

sv_clmovement_maxnetfps (default: 80), should prevent issues with high netfps

------------------------------------------------------------------------
r8913 | divverent | 2009-04-12 12:12:33 -0700 (Sun, 12 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

add checkpvs() to client too (but could not add an extension name for it, as client and server extension strings are the same)

------------------------------------------------------------------------
r8912 | divverent | 2009-04-12 12:06:39 -0700 (Sun, 12 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

fix crash in substring()

------------------------------------------------------------------------
r8911 | havoc | 2009-04-12 03:29:30 -0700 (Sun, 12 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

fix mispredictions when paused, or when console is down in singleplayer

------------------------------------------------------------------------
r8910 | havoc | 2009-04-12 03:06:31 -0700 (Sun, 12 Apr 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/protocol.c

don't allocate packetlog entries if there is nothing to put in them -
fixes packetlog overflow messages when paused

------------------------------------------------------------------------
r8909 | havoc | 2009-04-12 02:52:57 -0700 (Sun, 12 Apr 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

tweak the start time of the level a bit to cause items to spawn before
clients join

------------------------------------------------------------------------
r8908 | havoc | 2009-04-12 02:17:30 -0700 (Sun, 12 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/svvm_cmds.c

clarify float() traceline comments to say void()

------------------------------------------------------------------------
r8907 | havoc | 2009-04-12 02:16:10 -0700 (Sun, 12 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces-dedicated.dev
   M /trunk/darkplaces/darkplaces-dedicated.vcproj
   M /trunk/darkplaces/darkplaces-sdl.vcproj
   M /trunk/darkplaces/darkplaces.dev
   M /trunk/darkplaces/darkplaces.vcproj

added hmac.[ch] and cap_avi.[ch] and cap_ogg.[ch] to some project files

------------------------------------------------------------------------
r8906 | havoc | 2009-04-12 01:45:03 -0700 (Sun, 12 Apr 2009) | 4 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

added a workaround to hopefully fix a precaching error in kleshik on
level changes with multiple players (where some of them appear without a
player model because the svc_precache message is being lost)

------------------------------------------------------------------------
r8905 | havoc | 2009-04-12 00:23:09 -0700 (Sun, 12 Apr 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

fix bug with sv_gameplayfix_slidemoveprojectiles not allowing proximity
mines to stick in hipnotic

------------------------------------------------------------------------
r8904 | sajt | 2009-04-11 21:44:34 -0700 (Sat, 11 Apr 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/draw.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.h

drawrotpic:
- 'org' is the point on the image to rotate around ('0 0' is top-left)
- 'angle' is in degrees, counter-clockwise
------------------------------------------------------------------------
r8903 | havoc | 2009-04-11 19:07:18 -0700 (Sat, 11 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

fixed getinputstate not returning success/failure

------------------------------------------------------------------------
r8901 | havoc | 2009-04-11 18:44:56 -0700 (Sat, 11 Apr 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/dpmod/qc/dpextensions.qc

implemented FTE_STRINGS compliant substring behavior (FRIK_FILE feature
but upgraded by FTE_STRINGS)

------------------------------------------------------------------------
r8900 | motorsep | 2009-04-11 13:07:47 -0700 (Sat, 11 Apr 2009) | 1 line
Changed paths:
   M /trunk/darkplaces/snd_main.c

In function `S_ServerSounds': unused variable `sfxnext' (commented it out).
------------------------------------------------------------------------
r8899 | motorsep | 2009-04-11 13:00:43 -0700 (Sat, 11 Apr 2009) | 1 line
Changed paths:
   M /trunk/darkplaces/darkplaces-sdl.dev

Updated project file for SDL build
------------------------------------------------------------------------
r8898 | divverent | 2009-04-10 13:16:39 -0700 (Fri, 10 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/libcurl.c

don't print "empty file" spam here

------------------------------------------------------------------------
r8897 | havoc | 2009-04-10 12:25:08 -0700 (Fri, 10 Apr 2009) | 4 lines
Changed paths:
   M /trunk/darkplaces/cd_shared.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_null.c
   M /trunk/darkplaces/sound.h
   M /trunk/darkplaces/sv_main.c

do not unload models/sounds until signon is done, this prevents the
reloading of music tracks on level change, as well as the reloading of
csqc-precached models and sounds

------------------------------------------------------------------------
r8896 | divverent | 2009-04-10 11:45:10 -0700 (Fri, 10 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

don't need to clear rcon_password on QW server reconnect, as *ip can't be written to by the user

------------------------------------------------------------------------
r8895 | divverent | 2009-04-10 11:01:43 -0700 (Fri, 10 Apr 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/cvar.c
   M /trunk/darkplaces/host_cmd.c

- be less paranoid about clearing rcon_password (only needed when connecting to another server as long as rcon_secure is 0, or when changing it to 0)
- default rcon_secure to 0, but introduce a new "srcon" command that always works in secure mode

------------------------------------------------------------------------
r8894 | divverent | 2009-04-10 10:56:04 -0700 (Fri, 10 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

clear mouse input at a better stage (should fix cl_maxfps issues)

------------------------------------------------------------------------
r8893 | divverent | 2009-04-10 08:11:26 -0700 (Fri, 10 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/snd_3dras.c
   M /trunk/darkplaces/snd_mem.c

less loading screen refreshs

------------------------------------------------------------------------
r8892 | divverent | 2009-04-10 07:37:23 -0700 (Fri, 10 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/jpeg.c

fix stupid endless loop

------------------------------------------------------------------------
r8891 | divverent | 2009-04-09 05:05:29 -0700 (Thu, 09 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

use "realtime", not the float time global, for entity allocation and freeing to protect the entity slot for 0.5 seconds (now 1 second). Should help entity networking a lot, as the time global doesn't grow monotonically when cl_movement is used on a client (basically, a client with 500ms latency can free an entity in PlayerPreThink, and that entity slot could get immediately reused in the next server frame or think function).

------------------------------------------------------------------------
r8890 | divverent | 2009-04-09 01:26:11 -0700 (Thu, 09 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

damn, set the RIGHT alpha to 1... to make the loading bar opaque

------------------------------------------------------------------------
r8889 | divverent | 2009-04-09 01:24:52 -0700 (Thu, 09 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cvar.c
   M /trunk/darkplaces/host_cmd.c

when changing rcon_secure, always clear rcon_password, to prevent a send-as-plaintext attack

------------------------------------------------------------------------
r8888 | divverent | 2009-04-09 00:59:14 -0700 (Thu, 09 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

clear the rcon password on "connect" command or QW-style reconnect, to prevent stuffcmd based vulnerabilities that could expose the rcon password

------------------------------------------------------------------------
r8887 | divverent | 2009-04-09 00:32:54 -0700 (Thu, 09 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/hmac.c
   M /trunk/darkplaces/hmac.h
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/netconn.c

better error handling for overlong srcon commands

------------------------------------------------------------------------
r8886 | divverent | 2009-04-09 00:30:53 -0700 (Thu, 09 Apr 2009) | 9 lines
Changed paths:
   M /trunk/darkplaces/hmac.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/netconn.c

adding "srcon" protocol, and new cvars:

rcon_secure - if enabled, client sends srcon requests instead of rcon, and server ONLY accepts secure (HMAC-MD4) rcon.
rcon_secure_maxdiff - maximum clock difference between srcon client and server in seconds (is used to protect against replay attacks)

In srcon, the command is included into the hashing, so one can still sniff the command and its replies - but what an attacker can't do in srcon is sniff the password, or change the command over the wire. There is still limited replaying potential (within 15 seconds, the command can be replayed), but I don't think this can cause much harm.

TODO: add some way to FORCE rcon_secure to be 1, as currently a malicious server could stuffcmd("rcon_secure 0\nrcon ...") and then issue a rcon command to get the password.

------------------------------------------------------------------------
r8885 | divverent | 2009-04-08 23:29:30 -0700 (Wed, 08 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/hmac.c

tiny fix regarding too long keys

------------------------------------------------------------------------
r8884 | divverent | 2009-04-08 23:23:27 -0700 (Wed, 08 Apr 2009) | 2 lines
Changed paths:
   A /trunk/darkplaces/hmac.c
   A /trunk/darkplaces/hmac.h
   M /trunk/darkplaces/makefile.inc

Add my own HMAC implementation (verified using the test vectors). Planning to use HMAC-MD4 for an alternate rcon authentication.

------------------------------------------------------------------------
r8883 | divverent | 2009-04-08 22:39:54 -0700 (Wed, 08 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

Fix spurious error message in CL_Locs_FreeNode - ID: 2742143

------------------------------------------------------------------------
r8882 | divverent | 2009-04-07 05:47:49 -0700 (Tue, 07 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

draw loading bar at 100% alpha again

------------------------------------------------------------------------
r8881 | divverent | 2009-04-06 22:14:38 -0700 (Mon, 06 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/svvm_cmds.c

pitch inversion in gettaginfo: also do the mod_alias check on the client

------------------------------------------------------------------------
r8879 | divverent | 2009-04-06 07:37:50 -0700 (Mon, 06 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

code-only change of the loading screen, no visual change

------------------------------------------------------------------------
r8878 | divverent | 2009-04-06 07:31:46 -0700 (Mon, 06 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

again a slight visual improvement(?) of the loading bar

------------------------------------------------------------------------
r8875 | havoc | 2009-04-06 05:50:30 -0700 (Mon, 06 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/zone.c

Mem_Free being passed NULL should be a warning, not a hard error

------------------------------------------------------------------------
r8874 | havoc | 2009-04-06 05:44:41 -0700 (Mon, 06 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

fix a crash if a model has no vertices

------------------------------------------------------------------------
r8873 | divverent | 2009-04-05 10:56:03 -0700 (Sun, 05 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

fix the name (DOWNLOADPROGRESS -> LOADPROGRESS)

------------------------------------------------------------------------
r8872 | divverent | 2009-04-05 10:55:23 -0700 (Sun, 05 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

fix weight of worldmodel init

------------------------------------------------------------------------
r8871 | divverent | 2009-04-05 03:53:43 -0700 (Sun, 05 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/screen.h

graceful handling of stack underflows, or host_abortframe, during loading

------------------------------------------------------------------------
r8870 | divverent | 2009-04-05 03:34:39 -0700 (Sun, 05 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

enable nonpoweroftwo support again (accidentalyl had it && 0'ed for testing)

------------------------------------------------------------------------
r8869 | divverent | 2009-04-05 03:32:23 -0700 (Sun, 05 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/gl_rmain.c

loading screen: properly handle the back buffer, by using a copy-to-texture of the previous screen as background

------------------------------------------------------------------------
r8868 | divverent | 2009-04-05 03:10:15 -0700 (Sun, 05 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

force screen clear when showing loading plaque

------------------------------------------------------------------------
r8867 | divverent | 2009-04-05 02:51:24 -0700 (Sun, 05 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

fix YUV tables

------------------------------------------------------------------------
r8866 | divverent | 2009-04-04 14:04:12 -0700 (Sat, 04 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_screen.c

more loading screen improvements (weighting for different content types; don't update too often for keepalives; only show model name)

------------------------------------------------------------------------
r8865 | divverent | 2009-04-04 13:49:12 -0700 (Sat, 04 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/screen.h

also enter the event loop during Q3 map load... should prevent Vista's not responding thing even on mikeeusa maps

------------------------------------------------------------------------
r8864 | divverent | 2009-04-04 13:41:45 -0700 (Sat, 04 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

fix tiny typo

------------------------------------------------------------------------
r8863 | divverent | 2009-04-04 13:40:38 -0700 (Sat, 04 Apr 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_screen.c

- fix Q3 shaders coming from a curled pk3
- drawing a black bar below the download bar to make sure

------------------------------------------------------------------------
r8862 | divverent | 2009-04-04 13:08:43 -0700 (Sat, 04 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

hopefully fix the crash issue on windows by hitting esc during loading by ignoring all key presses during loading plaque

------------------------------------------------------------------------
r8861 | divverent | 2009-04-04 13:01:58 -0700 (Sat, 04 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

fix crash when playing some demos

------------------------------------------------------------------------
r8860 | divverent | 2009-04-04 12:31:33 -0700 (Sat, 04 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

further loading screen improvement

------------------------------------------------------------------------
r8859 | divverent | 2009-04-04 08:59:11 -0700 (Sat, 04 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

don't draw loading plaque on dedicated server :(

------------------------------------------------------------------------
r8858 | divverent | 2009-04-04 08:56:10 -0700 (Sat, 04 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

experiemnt: call the event loop from loading plaque update. Does this fix the problems on Vista?

------------------------------------------------------------------------
r8857 | divverent | 2009-04-04 08:53:31 -0700 (Sat, 04 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

make Quake start again :P

------------------------------------------------------------------------
r8856 | divverent | 2009-04-04 08:50:31 -0700 (Sat, 04 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/screen.h

more loading screen stuff, now shows loading screen for connecting clients with progress indicator

------------------------------------------------------------------------
r8855 | divverent | 2009-04-04 08:05:38 -0700 (Sat, 04 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/screen.h

a nice improvement to the loading plaque: displaying the name of what's being loaded

------------------------------------------------------------------------
r8854 | havoc | 2009-04-04 07:53:35 -0700 (Sat, 04 Apr 2009) | 7 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/sv_main.c

it is now possible to have multiple map models loaded at once - removed
the isworldmodel flag, and submodel searches now use the mapname as a
second search key so submodels from multiple maps can coexist in memory
this is a cleanup that I had wanted to do for a long time...
added special modeldecompile support for submodels, they should now save
to a name based on the current map as well as the submodel number

------------------------------------------------------------------------
r8853 | divverent | 2009-04-04 06:42:09 -0700 (Sat, 04 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c

move csqc_progdata and csqc_progdata_deflated from sv to svs to fix a memory leak

------------------------------------------------------------------------
r8852 | divverent | 2009-04-04 06:02:13 -0700 (Sat, 04 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/sv_main.c

fix memory leaks in server csqc

------------------------------------------------------------------------
r8851 | divverent | 2009-04-04 05:48:05 -0700 (Sat, 04 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/jpeg.c

fix a memory leak in WriteImage

------------------------------------------------------------------------
r8850 | sajt | 2009-04-04 05:07:08 -0700 (Sat, 04 Apr 2009) | 1 line
Changed paths:
   M /trunk/darkplaces/menu.c

update crosshair slider
------------------------------------------------------------------------
r8849 | havoc | 2009-04-04 00:52:18 -0700 (Sat, 04 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

don't apply host_sleep when in a timedemo

------------------------------------------------------------------------
r8848 | havoc | 2009-04-04 00:50:42 -0700 (Sat, 04 Apr 2009) | 4 lines
Changed paths:
   M /trunk/darkplaces/host.c

added host_sleep cvar, defaults to 1 millisecond wait each frame, this
seems to have no impact on fps on my windows and Linux machines but
reduces cpu usage

------------------------------------------------------------------------
r8847 | havoc | 2009-04-04 00:49:18 -0700 (Sat, 04 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_agl.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_wgl.c

changed r_speeds glFinish to only occur when set to 2, not 1 or 3

------------------------------------------------------------------------
r8846 | havoc | 2009-04-02 02:13:09 -0700 (Thu, 02 Apr 2009) | 4 lines
Changed paths:
   M /trunk/darkplaces/r_lerpanim.c

fix severe animation bug with single-frame framegroups in zym models
slight tweak to framegroup interpolation in zym models (restored some
epsilon checks)

------------------------------------------------------------------------
r8845 | havoc | 2009-04-02 02:11:15 -0700 (Thu, 02 Apr 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

reset rsurface.entity in a couple more cases
fixed entity count on r_speeds - don't count models twice

------------------------------------------------------------------------
r8844 | divverent | 2009-04-02 00:10:06 -0700 (Thu, 02 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/svvm_cmds.c

fix the NaN checks

------------------------------------------------------------------------
r8843 | havoc | 2009-04-01 12:33:04 -0700 (Wed, 01 Apr 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

changed sv_masterextra cvars back to IP addresses to avoid gethostbyname
delays on startup of Nexuiz

------------------------------------------------------------------------
r8842 | havoc | 2009-04-01 11:16:13 -0700 (Wed, 01 Apr 2009) | 5 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sv_user.c

replaced sv_clmovement_waitforinput with sv_clmovement_inputtimeout
which takes a timeout inseconds rather than frames, this makes
sys_ticrate safer to modify in Nexuiz (which has a low cl_netfps that
breaks with a rapid sys_ticrate if the administrator tries that)

------------------------------------------------------------------------
r8841 | divverent | 2009-04-01 11:10:24 -0700 (Wed, 01 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

turn off exact specular math by default (it's better for fps, and sometimes looks less weird)

------------------------------------------------------------------------
r8840 | havoc | 2009-04-01 10:58:29 -0700 (Wed, 01 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_shadow.c

reset rsurface.entity to NULL after each entity is rendered

------------------------------------------------------------------------
r8839 | havoc | 2009-04-01 07:10:38 -0700 (Wed, 01 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix messed up r_hdr bloom rendering (wasn't setting view dimensions)

------------------------------------------------------------------------
r8838 | havoc | 2009-04-01 06:56:23 -0700 (Wed, 01 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_sprites.c

set rsurface.entity correctly before calling R_GetCurrentTexture

------------------------------------------------------------------------
r8837 | divverent | 2009-04-01 05:52:45 -0700 (Wed, 01 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

make cvar* functions unable to retrieve private cvars

------------------------------------------------------------------------
r8836 | divverent | 2009-04-01 04:13:50 -0700 (Wed, 01 Apr 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

slightly more exact "exact specular math", prevents white dots on a mikeeusa map

------------------------------------------------------------------------
r8835 | havoc | 2009-03-30 08:29:36 -0700 (Mon, 30 Mar 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/svvm_cmds.c

added extension names for DP_GFX_MODEL_INTERPOLATION and
DP_CSQC_MULTIFRAME_INTERPOLATION

------------------------------------------------------------------------
r8834 | havoc | 2009-03-30 08:22:57 -0700 (Mon, 30 Mar 2009) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/darkplaces.txt
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_sprite.c
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/r_lerpanim.c
   M /trunk/darkplaces/r_sprites.c
   M /trunk/darkplaces/render.h

reworked animation interpolation code - entity_render_t now has
framegroupblend[] instead of frame1/2/1time/2time/framelerp fields
implemented csqc 4-way frame interpolation (lerpfrac2 is inferred based
on the sum of lerpfrac+lerpfrac3+lerpfrac4, so it remains compatible)

------------------------------------------------------------------------
r8833 | havoc | 2009-03-29 22:35:50 -0700 (Sun, 29 Mar 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

fix a use of tempmempool to be loadmodel->mempool

------------------------------------------------------------------------
r8832 | havoc | 2009-03-29 06:29:01 -0700 (Sun, 29 Mar 2009) | 7 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_sprites.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/todo

compute sorted surface list at load of each model - this tripled
framerates in some outdoor q1bsp maps
cleaned up water rendering setup code so it at least makes sense now
model lighting is not computed for unseen models (major fps increase in
some q1bsp maps)
added an unfinished OBJ model loader (not enabled)

------------------------------------------------------------------------
r8831 | havoc | 2009-03-29 06:23:50 -0700 (Sun, 29 Mar 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/darkplaces-dedicated.vcproj
   M /trunk/darkplaces/darkplaces-sdl.vcproj
   M /trunk/darkplaces/darkplaces.sln
   M /trunk/darkplaces/darkplaces.vcproj

updated project files to include cap_avi.c and cap_ogg.c
note: these are MSVC++ 2008 files - I don't have 2005

------------------------------------------------------------------------
r8830 | divverent | 2009-03-27 05:31:04 -0700 (Fri, 27 Mar 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/csprogs.c

same fix for csqc

------------------------------------------------------------------------
r8829 | divverent | 2009-03-27 04:57:59 -0700 (Fri, 27 Mar 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/snd_main.c

properly let sounds come out of attached entities (currently for svqc only)

------------------------------------------------------------------------
r8828 | divverent | 2009-03-25 23:48:16 -0700 (Wed, 25 Mar 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_shared.c

only enable nonpoweroftwo textures if GL_MAX_VERTEX_TEXTURE_IMAGE_UNITS_ARB > 0 (as radeon HDs software emulate some use cases of nonpoweroftwo textures, e.g. repeating ones)

------------------------------------------------------------------------
r8827 | divverent | 2009-03-25 06:38:15 -0700 (Wed, 25 Mar 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

make r_showtris no longer use glVertex
same should be done to shownormals etc., but this would get more complex

------------------------------------------------------------------------
r8826 | divverent | 2009-03-23 11:16:30 -0700 (Mon, 23 Mar 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/curves.c

variable name fixes only, no change in behaviour

------------------------------------------------------------------------
r8825 | divverent | 2009-03-23 11:15:50 -0700 (Mon, 23 Mar 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_exec.c

oops, move the print for that string upwards, as other code there uses va() too

------------------------------------------------------------------------
r8824 | divverent | 2009-03-23 11:11:30 -0700 (Mon, 23 Mar 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/prvm_exec.c

in PRVM state dumps, also dump a special extra string if prvm_backtraceforwarnings = 1 that can be specified by other code
currently, this is used to be able to track down the invalid tempstrings in savegame saving

------------------------------------------------------------------------
r8823 | divverent | 2009-03-23 06:58:24 -0700 (Mon, 23 Mar 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/libcurl.c

libcurl: if a resume ended up with an invalid pack, redownload the FULL pack

------------------------------------------------------------------------
r8822 | motorsep | 2009-03-22 13:05:29 -0700 (Sun, 22 Mar 2009) | 1 line
Changed paths:
   M /trunk/darkplaces/darkplaces-sdl.dev

project file to build SDL executives
------------------------------------------------------------------------
r8821 | divverent | 2009-03-22 12:51:44 -0700 (Sun, 22 Mar 2009) | 8 lines
Changed paths:
   M /trunk/darkplaces/curves.c

change names of functions, and add comments.

The code is mathematically correct now, I added a proof of the missing link:
quadratic spline area = exactly 2/3 * area of the control points triangle!

The actual subdivisions stayed invariant, just the names of the functions make
more sense now.

------------------------------------------------------------------------
r8820 | divverent | 2009-03-22 12:31:07 -0700 (Sun, 22 Mar 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/libcurl.c

curl: delete the downloaded pk3 if adding it failed

------------------------------------------------------------------------
r8819 | divverent | 2009-03-22 12:26:19 -0700 (Sun, 22 Mar 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/libcurl.c

show correct percentage when resuming

------------------------------------------------------------------------
r8818 | divverent | 2009-03-21 15:09:45 -0700 (Sat, 21 Mar 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/svvm_cmds.c

DP_QC_GETTIME

------------------------------------------------------------------------
r8817 | divverent | 2009-03-21 14:45:12 -0700 (Sat, 21 Mar 2009) | 9 lines
Changed paths:
   M /trunk/darkplaces/curves.c

change the model of curves approximation to one that
a) almost matches the previous one, and
b) makes more sense, mathematically
now the inexactness of a patch is defined as the maximum over the inexactness of its quadratic splines;
the inexactness of such a quadratic spline is defined as the area between the spline and the line between its end points;
as that area is hard to calculate, the triangle area of the three control points is taken instead (which obviously is larger than the area between spline and the line between the end points, so this actually is a pessimistic approach to get some nicely defined tesselation)

not much should change for the user, though, but flat patches are now properly detected and handled

------------------------------------------------------------------------
r8816 | divverent | 2009-03-19 04:38:59 -0700 (Thu, 19 Mar 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/svvm_cmds.c

fix warning

------------------------------------------------------------------------
r8815 | divverent | 2009-03-19 03:38:06 -0700 (Thu, 19 Mar 2009) | 4 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/svvm_cmds.c

make gettaginfo actually work:
- now REALLY returns data in worldspace, as the description says
- handle bmodels' pitch angle correctly

------------------------------------------------------------------------
r8811 | divverent | 2009-03-18 04:22:48 -0700 (Wed, 18 Mar 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/svvm_cmds.c

FTE_QC_CHECKPVS

------------------------------------------------------------------------
r8810 | divverent | 2009-03-18 03:04:58 -0700 (Wed, 18 Mar 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/svvm_cmds.c

DP_QC_FINDCHAIN_TOFIELD (saves into another field than .chain)

------------------------------------------------------------------------
r8809 | divverent | 2009-03-15 13:41:06 -0700 (Sun, 15 Mar 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/protocol.c

force 32bit origin for player entiites (TODO: possibly for bmodels too?) to get better prediction

------------------------------------------------------------------------
r8808 | divverent | 2009-03-14 11:31:04 -0700 (Sat, 14 Mar 2009) | 9 lines
Changed paths:
   M /trunk/darkplaces/curves.c
   M /trunk/darkplaces/curves.h
   M /trunk/darkplaces/model_brush.c

Experimental new patch welding code by "someone", fixing the problem with seams when an X and a Y patch side touch.
Also adds a mode for flat patch sides (so they no longer get tesselated at all).

http://www.alientrap.org/forum/viewtopic.php?t=4200

The submitted patch cleaned up a little, but it's probably not perfect yet.

PLEASE READ, VERIFY AND TEST.

------------------------------------------------------------------------
r8806 | havoc | 2009-03-12 23:41:13 -0700 (Thu, 12 Mar 2009) | 5 lines
Changed paths:
   M /trunk/darkplaces/mathlib.h

made lhrandom never return MIN (it already never returned MAX), to fix
the "stone monster" bug from Quake, where occasionally a monster never
even spawns properly because its walkmonster_start_go function had a
nextthink value of exactly 0

------------------------------------------------------------------------
r8804 | divverent | 2009-03-12 04:04:27 -0700 (Thu, 12 Mar 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cap_avi.c

fix tiny bug in AVI writing

------------------------------------------------------------------------
r8803 | divverent | 2009-03-12 01:42:21 -0700 (Thu, 12 Mar 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

make bouncing also support the entity gravity

------------------------------------------------------------------------
r8802 | havoc | 2009-03-12 01:17:02 -0700 (Thu, 12 Mar 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c

added sv_gameplayfix_slidemoveprojectiles which avoids a sticking bug
with grenades where they kept accumulating gravity

------------------------------------------------------------------------
r8801 | havoc | 2009-03-12 01:16:04 -0700 (Thu, 12 Mar 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/protocol.c

don't use 16bit origin protocol for attachments

------------------------------------------------------------------------
r8800 | havoc | 2009-03-11 13:27:15 -0700 (Wed, 11 Mar 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

changed sv_gameplayfix_delayprojectiles to also delay think functions on
newly spawned entities, not just movement

------------------------------------------------------------------------
r8798 | divverent | 2009-03-11 07:09:38 -0700 (Wed, 11 Mar 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

some typecasts for g++

------------------------------------------------------------------------
r8797 | divverent | 2009-03-11 06:11:59 -0700 (Wed, 11 Mar 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

modeldecompile: detect skeletal models properly (no more crash on exporting MD3s)

------------------------------------------------------------------------
r8795 | divverent | 2009-03-11 01:44:48 -0700 (Wed, 11 Mar 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

decompile models written by pre-r8533 zmodel correctly

------------------------------------------------------------------------
r8790 | divverent | 2009-03-10 23:22:50 -0700 (Tue, 10 Mar 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

[ 2680901 ] Fix server/client crashes

------------------------------------------------------------------------
r8789 | havoc | 2009-03-10 18:39:05 -0700 (Tue, 10 Mar 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

minor code simplification

------------------------------------------------------------------------
r8788 | havoc | 2009-03-10 17:58:56 -0700 (Tue, 10 Mar 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

another obj fix

------------------------------------------------------------------------
r8787 | havoc | 2009-03-10 17:40:44 -0700 (Tue, 10 Mar 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

another obj fix (normals)

------------------------------------------------------------------------
r8786 | havoc | 2009-03-10 17:39:15 -0700 (Tue, 10 Mar 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

fix zmodel script to actually work

------------------------------------------------------------------------
r8785 | havoc | 2009-03-10 17:33:04 -0700 (Tue, 10 Mar 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

more fixes for obj export
smd export now saves two txt scripts, one for zmodel, one for dpmodel

------------------------------------------------------------------------
r8784 | havoc | 2009-03-10 16:44:49 -0700 (Tue, 10 Mar 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

more fixes for OBJ export

------------------------------------------------------------------------
r8783 | havoc | 2009-03-10 15:24:20 -0700 (Tue, 10 Mar 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

fix two problems in obj export

------------------------------------------------------------------------
r8782 | havoc | 2009-03-10 14:36:10 -0700 (Tue, 10 Mar 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

fix typo

------------------------------------------------------------------------
r8781 | havoc | 2009-03-10 14:22:06 -0700 (Tue, 10 Mar 2009) | 4 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

implemented modeldecompile command, saves .obj version of any model or
map (but not sprites), also saves dpmodel script and smd files for
skeletal models

------------------------------------------------------------------------
r8780 | divverent | 2009-03-09 02:21:51 -0700 (Mon, 09 Mar 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/mvm_cmds.c

change a cast, trying to fix DP in g++

------------------------------------------------------------------------
r8779 | divverent | 2009-03-07 05:45:46 -0800 (Sat, 07 Mar 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

fix the latest patch (print the right number)

------------------------------------------------------------------------
r8778 | divverent | 2009-03-07 05:41:21 -0800 (Sat, 07 Mar 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/server.h

allow maxplayers to be changed in game (it'll then be latched and the change will be applied on the next "map" (not "changelevel") command)

------------------------------------------------------------------------
r8777 | divverent | 2009-03-06 05:52:20 -0800 (Fri, 06 Mar 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

fix token endpos writng by tokenizebyseparator

------------------------------------------------------------------------
r8776 | divverent | 2009-03-06 02:54:02 -0800 (Fri, 06 Mar 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

tokenize: allow more tokens

------------------------------------------------------------------------
r8775 | divverent | 2009-03-03 09:37:30 -0800 (Tue, 03 Mar 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/sv_main.c

add a strftime reference to the cvar descriptions so one knows where to look how to make the %M:%D like date strings

------------------------------------------------------------------------
r8774 | divverent | 2009-03-03 07:13:43 -0800 (Tue, 03 Mar 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

particle culling: don't crash if r_refdef.scene.worldmodel is NULL

------------------------------------------------------------------------
r8773 | divverent | 2009-03-03 01:05:48 -0800 (Tue, 03 Mar 2009) | 8 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

bring back the stupid Matrix4x4_Invert call as it breaks on my gcc in release builds (but is fine in debug builds).

Using built-in specs.
Target: x86_64-linux-gnu
Configured with: ../src/configure -v --with-pkgversion='Ubuntu 4.3.2-1ubuntu11' --with-bugurl=file:///usr/share/doc/gcc-4.3/README.Bugs --enable-languages=c,c++,fortran,objc,obj-c++ --prefix=/usr --enable-shared --with-system-zlib --libexecdir=/usr/lib --without-included-gettext --enable-threads=posix --enable-nls --with-gxx-include-dir=/usr/include/c++/4.3 --program-suffix=-4.3 --enable-clocale=gnu --enable-libstdcxx-debug --enable-objc-gc --enable-mpfr --enable-checking=release --build=x86_64-linux-gnu --host=x86_64-linux-gnu --target=x86_64-linux-gnu
Thread model: posix
gcc version 4.3.2 (Ubuntu 4.3.2-1ubuntu11) 

------------------------------------------------------------------------
r8772 | divverent | 2009-03-02 23:42:03 -0800 (Mon, 02 Mar 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c

corona query: move the "all pixels" query to the center of the screen, so coronas fade out nicely when they leave the visible screen area

------------------------------------------------------------------------
r8771 | divverent | 2009-03-02 22:44:26 -0800 (Mon, 02 Mar 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

speed up cl_project (it can simply use the inverse view matrix, no need to invert in this function)

------------------------------------------------------------------------
r8770 | divverent | 2009-03-02 07:26:43 -0800 (Mon, 02 Mar 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c

work around ATI bug in corona occlusion testing (use glDepthFunc, not glEnable)

------------------------------------------------------------------------
r8769 | havoc | 2009-03-01 19:47:39 -0800 (Sun, 01 Mar 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

remove a debug line

------------------------------------------------------------------------
r8768 | havoc | 2009-03-01 17:55:26 -0800 (Sun, 01 Mar 2009) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/client.h

replaced cl_particles_novis with cl_particles_visculling and
cl_decals_visculling, which default to 0 and 1 respectively
optimized decal vis culling massively by storing the clusterindex

------------------------------------------------------------------------
r8767 | havoc | 2009-03-01 17:31:14 -0800 (Sun, 01 Mar 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

change default value for cl_particles_novis to 1 because 0 eats fps like
candy

------------------------------------------------------------------------
r8766 | divverent | 2009-02-27 03:18:18 -0800 (Fri, 27 Feb 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c

add three more places to send keepalives. No more disconnects for "redstarrepublic".

------------------------------------------------------------------------
r8765 | divverent | 2009-02-27 00:50:10 -0800 (Fri, 27 Feb 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/sv_main.c

improve keepalive handling (also send keepalives during map loading); but still not perfect (e.g. on redstarrepublic, client and server tend to send each other keepalive messages, and eventually the client gets dropped, no idea why)

------------------------------------------------------------------------
r8764 | divverent | 2009-02-25 23:19:43 -0800 (Wed, 25 Feb 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

count entities removed by SV_OnEntityPreSpawnFunction as inhibited, not as died

------------------------------------------------------------------------
r8763 | divverent | 2009-02-25 22:50:42 -0800 (Wed, 25 Feb 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/collision.c

fix typo in previous commit

------------------------------------------------------------------------
r8762 | divverent | 2009-02-25 22:26:22 -0800 (Wed, 25 Feb 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/collision.c

use trace_plane_normal to check whether the trace succeeded

------------------------------------------------------------------------
r8761 | divverent | 2009-02-25 06:14:32 -0800 (Wed, 25 Feb 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/client.h

scr_screenshot_hwgamma - makes the HW gamma table apply to screenshots/videos

------------------------------------------------------------------------
r8760 | divverent | 2009-02-25 06:13:02 -0800 (Wed, 25 Feb 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix v_color_enable with v_glslgamma

------------------------------------------------------------------------
r8759 | divverent | 2009-02-25 06:09:34 -0800 (Wed, 25 Feb 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/collision.c

never prefer an entity trace over a world trace if the trace fraction is 1 (not hit).
Fixes bug with SOLID_BSP entities sometimes being collided against "as box".

------------------------------------------------------------------------
r8757 | havoc | 2009-02-25 02:28:47 -0800 (Wed, 25 Feb 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/svvm_cmds.c

ZQ_PAUSE extension patch from GreEn`mArine

------------------------------------------------------------------------
r8756 | divverent | 2009-02-22 23:20:38 -0800 (Sun, 22 Feb 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cap_ogg.c
   M /trunk/darkplaces/mathlib.h
   M /trunk/darkplaces/model_alias.c

C++ compile fixes

------------------------------------------------------------------------
r8755 | divverent | 2009-02-21 12:18:26 -0800 (Sat, 21 Feb 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

cl_capturevideo_nameformat

------------------------------------------------------------------------
r8754 | divverent | 2009-02-21 11:13:28 -0800 (Sat, 21 Feb 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cap_ogg.c

add some casts for g++

------------------------------------------------------------------------
r8753 | divverent | 2009-02-21 11:08:10 -0800 (Sat, 21 Feb 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/matrixlib.h

clarify that the new matrixlib functions only are supposed to work for rotations and translations (transformation must be length invariant)

------------------------------------------------------------------------
r8752 | havoc | 2009-02-21 10:22:19 -0800 (Sat, 21 Feb 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/collision.c

fix ie

------------------------------------------------------------------------
r8751 | divverent | 2009-02-20 10:13:06 -0800 (Fri, 20 Feb 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/draw.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/host_cmd.c

some color tag cleanups by terencehill

------------------------------------------------------------------------
r8750 | havoc | 2009-02-20 10:07:40 -0800 (Fri, 20 Feb 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/collision.c

calculate plane dist in collision code so that it will be valid

------------------------------------------------------------------------
r8749 | havoc | 2009-02-20 09:50:03 -0800 (Fri, 20 Feb 2009) | 6 lines
Changed paths:
   M /trunk/darkplaces/collision.c
   M /trunk/darkplaces/matrixlib.c
   M /trunk/darkplaces/matrixlib.h

report a proper trace_plane_normal for trace_startsolid cases, this
allows QC physics code to nudge objects out of eachother using the
shortest vector, only valid if trace_fraction is 1 (works best for
stationary overlap tests)
properly transform trace_plane_dist rather than returning 0

------------------------------------------------------------------------
r8748 | havoc | 2009-02-20 09:45:53 -0800 (Fri, 20 Feb 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/sys_linux.c

fix a compile error on dedicated server in MSVC2008

------------------------------------------------------------------------
r8747 | divverent | 2009-02-20 05:20:14 -0800 (Fri, 20 Feb 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

made cl_capturevideo_ogg 1 by default and saved.

------------------------------------------------------------------------
r8746 | divverent | 2009-02-19 06:48:34 -0800 (Thu, 19 Feb 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cap_ogg.c

change vorbis default quality to 3 (before: 1), matches oggenc

------------------------------------------------------------------------
r8745 | divverent | 2009-02-19 03:35:05 -0800 (Thu, 19 Feb 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cap_ogg.c

fix multichannel vorbis channel mappings

------------------------------------------------------------------------
r8744 | divverent | 2009-02-19 02:11:16 -0800 (Thu, 19 Feb 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cap_ogg.c
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_main.h
   M /trunk/darkplaces/snd_mix.c

correctly swap the channels for vorbis audio encoding

------------------------------------------------------------------------
r8743 | divverent | 2009-02-19 00:16:22 -0800 (Thu, 19 Feb 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cap_ogg.c

also fix ti.keyframe_auto_p

------------------------------------------------------------------------
r8742 | divverent | 2009-02-19 00:14:59 -0800 (Thu, 19 Feb 2009) | 5 lines
Changed paths:
   M /trunk/darkplaces/cap_ogg.c

rename cl_capturevideo_ogg_theora_keyframe_frequency to cl_capturevideo_ogg_theora_keyframe_maxinterval
rename cl_capturevideo_ogg_theora_keyframe_mindistance to cl_capturevideo_ogg_theora_keyframe_mininterval (and subtract one)

this makes the two cvars have the same "units"

------------------------------------------------------------------------
r8741 | divverent | 2009-02-18 23:57:55 -0800 (Wed, 18 Feb 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.inc

make DP_PRELOAD_DEPENDENCIES=1: add theora to the dependencies (for Debian packaging)

------------------------------------------------------------------------
r8740 | divverent | 2009-02-18 21:33:26 -0800 (Wed, 18 Feb 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cap_avi.c
   M /trunk/darkplaces/cap_ogg.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/client.h

libogg sucks. Really does. Work around one of its shortcomings by storing the page to be interleaved in our OWN buffer, as libogg appears to overwrite it when calling some OTHER function in it.

------------------------------------------------------------------------
r8739 | havoc | 2009-02-18 14:31:39 -0800 (Wed, 18 Feb 2009) | 5 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c

fix bug introduced by div0 that made entities belonging to world play at
world origin
added special case for removed entities - channel entity is changed to
world when this is detected

------------------------------------------------------------------------
r8738 | divverent | 2009-02-18 14:19:23 -0800 (Wed, 18 Feb 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cap_ogg.c

fix typo causing an endless loop

------------------------------------------------------------------------
r8737 | divverent | 2009-02-18 14:10:47 -0800 (Wed, 18 Feb 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c

hopefully fix pointsound in csqc

------------------------------------------------------------------------
r8736 | divverent | 2009-02-18 13:18:33 -0800 (Wed, 18 Feb 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cap_ogg.c

avoid writing a duplicate last frame at the end

------------------------------------------------------------------------
r8735 | divverent | 2009-02-18 12:44:54 -0800 (Wed, 18 Feb 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cap_ogg.c

fix the stupid interleaving method

------------------------------------------------------------------------
r8734 | havoc | 2009-02-18 12:28:48 -0800 (Wed, 18 Feb 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

revert r8707 changes

------------------------------------------------------------------------
r8733 | havoc | 2009-02-18 12:15:35 -0800 (Wed, 18 Feb 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cap_ogg.c

disable use of stdint.h on MSVC2003 and earlier

------------------------------------------------------------------------
r8732 | divverent | 2009-02-18 12:08:31 -0800 (Wed, 18 Feb 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cap_ogg.c

also include <stdint.h> to get uint32_t on mingw

------------------------------------------------------------------------
r8731 | divverent | 2009-02-18 12:06:56 -0800 (Wed, 18 Feb 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cap_ogg.c

a debug printf I forgot to comment out

------------------------------------------------------------------------
r8730 | divverent | 2009-02-18 12:06:05 -0800 (Wed, 18 Feb 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cap_ogg.c

now, for mingw, use the uint32_t names instead of the u_int32_t ones

------------------------------------------------------------------------
r8729 | havoc | 2009-02-18 12:05:20 -0800 (Wed, 18 Feb 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cap_ogg.c

fix compile errors on MSVC2003 and earlier

------------------------------------------------------------------------
r8728 | divverent | 2009-02-18 11:42:02 -0800 (Wed, 18 Feb 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cap_ogg.c

bring back the old stupid interleaving, and leave this open for maybe someone from xiph to fix (stream badly interleaved, oggz-validate complains, other stuff appears to work)

------------------------------------------------------------------------
r8727 | divverent | 2009-02-18 07:09:18 -0800 (Wed, 18 Feb 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cap_ogg.c

try interleaving exactly like example_encode.c

------------------------------------------------------------------------
r8726 | divverent | 2009-02-18 06:29:13 -0800 (Wed, 18 Feb 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cap_ogg.c

increase default theora quality from 16 to 32; this about matches the compression ratio of MPEG2 on a DVD, and looks quite good

------------------------------------------------------------------------
r8725 | divverent | 2009-02-18 06:05:10 -0800 (Wed, 18 Feb 2009) | 2 lines
Changed paths:
   A /trunk/darkplaces/cap_avi.c
   A /trunk/darkplaces/cap_avi.h
   M /trunk/darkplaces/cap_ogg.c
   M /trunk/darkplaces/cap_ogg.h
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/makefile.inc

capturevideo refactoring, making AVI also "just a module" for it

------------------------------------------------------------------------
r8724 | divverent | 2009-02-18 03:54:05 -0800 (Wed, 18 Feb 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cap_ogg.c

Add some cvars for vorbis/theora video encoding; their defaults match the defaults of the example_encoder program in libtheora for now. Needs testing to find actually good values.

------------------------------------------------------------------------
r8723 | divverent | 2009-02-18 02:16:51 -0800 (Wed, 18 Feb 2009) | 2 lines
Changed paths:
   A /trunk/darkplaces/cap_ogg.c
   A /trunk/darkplaces/cap_ogg.h

forgot these two files

------------------------------------------------------------------------
r8722 | divverent | 2009-02-18 02:14:55 -0800 (Wed, 18 Feb 2009) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/makefile.inc
   M /trunk/darkplaces/snd_3dras.c
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_main.h
   M /trunk/darkplaces/snd_mix.c
   M /trunk/darkplaces/snd_null.c
   M /trunk/darkplaces/sound.h

Experimental theora capturevideo code.
Still contains known memory leaks, and no configurability at all.
Try out using scr_capturevideo_ogg 1 and then capturing a video.

------------------------------------------------------------------------
r8721 | divverent | 2009-02-17 12:36:58 -0800 (Tue, 17 Feb 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

capturevideo: prefill incomplete header fields a bit more defensively: 0xFFFFFFFF, not 0, for total frames

------------------------------------------------------------------------
r8720 | havoc | 2009-02-17 10:40:49 -0800 (Tue, 17 Feb 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c

fix bugs with missing shader replacements casting shadows
fix bugs with surfaceparm nodraw casting shadows

------------------------------------------------------------------------
r8719 | divverent | 2009-02-17 06:38:11 -0800 (Tue, 17 Feb 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/protocol.h

fix typo in some powers of two

------------------------------------------------------------------------
r8718 | divverent | 2009-02-17 05:59:46 -0800 (Tue, 17 Feb 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/svvm_cmds.c

add Q3A's EF_TELEPORT_BIT (toggle it when teleporting; interpolation gets skipped for a frame after doing so)

------------------------------------------------------------------------
r8716 | divverent | 2009-02-17 01:26:40 -0800 (Tue, 17 Feb 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/svvm_cmds.c

DP_QC_GETTAGINFO_BONEPROPERTIES

------------------------------------------------------------------------
r8715 | havoc | 2009-02-16 11:40:24 -0800 (Mon, 16 Feb 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

fix a compile error when using C++ mode

------------------------------------------------------------------------
r8714 | divverent | 2009-02-16 10:09:53 -0800 (Mon, 16 Feb 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

skip interpolation if tagentity changes

------------------------------------------------------------------------
r8713 | havoc | 2009-02-15 20:48:30 -0800 (Sun, 15 Feb 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_wgl.c

fix some mingw64 warnings (I hope)

------------------------------------------------------------------------
r8712 | havoc | 2009-02-15 20:45:04 -0800 (Sun, 15 Feb 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/svvm_cmds.c

added cvar sv_gameplayfix_gravityunaffectedbyticrate - off by default
but seems to work

------------------------------------------------------------------------
r8711 | havoc | 2009-02-15 20:20:35 -0800 (Sun, 15 Feb 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h

implemented zpass shadowing, not used yet

------------------------------------------------------------------------
r8710 | havoc | 2009-02-15 14:25:28 -0800 (Sun, 15 Feb 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/client.h

somehow this file was not committed in the last one

------------------------------------------------------------------------
r8709 | havoc | 2009-02-15 13:52:55 -0800 (Sun, 15 Feb 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

don't prepend textures/ on halflife wad loading

------------------------------------------------------------------------
r8708 | havoc | 2009-02-15 13:50:23 -0800 (Sun, 15 Feb 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

use nlerp for bone rotations in skeletal model rendering, and also
preserve (non-uniform) scaling while doing so

------------------------------------------------------------------------
r8707 | havoc | 2009-02-15 13:49:27 -0800 (Sun, 15 Feb 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

simplified tag info code

------------------------------------------------------------------------
r8706 | havoc | 2009-02-15 13:45:55 -0800 (Sun, 15 Feb 2009) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c

added shadertime field in csqc
added shadertime support in renderer
added shadertime support in client (defaults to last time model changed)
this means shader animMap commands are now time-synced to entity spawn

------------------------------------------------------------------------
r8705 | havoc | 2009-02-12 11:45:42 -0800 (Thu, 12 Feb 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_shadow.c

laying the groundwork for zpass shadow volume support (slightly faster
rendering)

------------------------------------------------------------------------
r8704 | havoc | 2009-02-11 22:35:31 -0800 (Wed, 11 Feb 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_lightning.c
   M /trunk/darkplaces/r_shadow.c

added TEXF_FORCELINEAR to many special effect textures

------------------------------------------------------------------------
r8703 | havoc | 2009-02-11 22:25:05 -0800 (Wed, 11 Feb 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/r_shadow.c

early steps toward support for persistent caching of dlight shadows

------------------------------------------------------------------------
r8702 | havoc | 2009-02-11 21:35:34 -0800 (Wed, 11 Feb 2009) | 5 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/vid_shared.c

implemented occlusion query support on corona rendering, this enables
coronas to fade according to the percentage of occluded pixels around
the light origin, giving a more realistic corona behavior
some minor cleanup on shadow volume construction code

------------------------------------------------------------------------
r8701 | divverent | 2009-02-11 06:27:23 -0800 (Wed, 11 Feb 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

fix memory corruption when using trailparticles with an effect that has a dlight

------------------------------------------------------------------------
r8700 | divverent | 2009-02-10 05:23:48 -0800 (Tue, 10 Feb 2009) | 10 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

remove two debug prints

Working way to encode from darkplaces using mencoder without writing a huge dpvideo...avi:

mkfifo ~/.nexuiz/data/video/dpvideo001.avi
perl -e 'while(read STDIN, my $var, 1048576) { print $var; }' < ~/.nexuiz/data/video/dpvideo001.avi | mencoder -o outfile.avi - .....options......

while running DarkPlaces with cl_capturevideo from another shell


------------------------------------------------------------------------
r8699 | divverent | 2009-02-10 05:13:50 -0800 (Tue, 10 Feb 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

fix a typo

------------------------------------------------------------------------
r8698 | divverent | 2009-02-10 05:11:02 -0800 (Tue, 10 Feb 2009) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/client.h

improved handling of non-seekable AVIs; also: do less seeking when capturing now.

However, still ffmpeg and mplayer fail to read it. No idea why.

------------------------------------------------------------------------
r8697 | divverent | 2009-02-10 03:22:47 -0800 (Tue, 10 Feb 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

make AVI writing a bit more robust; if seeking back fails, the block it wanted to write won't be written. MAYBE this allows streaming the AVI to ffmpeg?

------------------------------------------------------------------------
r8696 | divverent | 2009-02-09 05:04:39 -0800 (Mon, 09 Feb 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

CSQC traceline/tracebox: don't set hitnetworkplayers when MOVE_NOMONSTERS or MOVE_WORLDONLY are specified; don't set hitnetworkbrushmodels when MOVE_WORLDONLY is specified

------------------------------------------------------------------------
r8695 | divverent | 2009-02-07 00:52:07 -0800 (Sat, 07 Feb 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

bugfix for showtopspeed

------------------------------------------------------------------------
r8694 | divverent | 2009-02-06 06:48:41 -0800 (Fri, 06 Feb 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_lerpanim.c

fix a possible bug with zym model animation (this looks like a typo, and fixing it makes the shotgun anim in nexuiz appear more consistent)

------------------------------------------------------------------------
r8693 | divverent | 2009-02-05 23:09:42 -0800 (Thu, 05 Feb 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

[ 2566720 ] showtopspeed v3

------------------------------------------------------------------------
r8692 | havoc | 2009-02-01 16:52:34 -0800 (Sun, 01 Feb 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/filematch.c

At O.Sezer's recommendation filematch.c has been changed to use
FindFirstFile and friends instead of _findfirst and friends.

------------------------------------------------------------------------
r8691 | havoc | 2009-02-01 16:34:29 -0800 (Sun, 01 Feb 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/sys_win.c

disabled main in sys_win.c at O.Sezer's recommendation (vid_wgl.c
provides WinMain in the same build target - making this pointless)

------------------------------------------------------------------------
r8690 | havoc | 2009-02-01 16:25:06 -0800 (Sun, 01 Feb 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.inc

changed CC=gcc to CC?=gcc at O.Sezer's recommendation

------------------------------------------------------------------------
r8689 | divverent | 2009-02-01 00:35:49 -0800 (Sun, 01 Feb 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_wgl.c

fix two typos in vid_wgl code

------------------------------------------------------------------------
r8688 | divverent | 2009-01-31 03:12:13 -0800 (Sat, 31 Jan 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_agl.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_null.c
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c

more fullscreen cleanup

------------------------------------------------------------------------
r8687 | divverent | 2009-01-31 02:34:32 -0800 (Sat, 31 Jan 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c

cleanup of fullscreen code; do not use VidMode when NetWM fullscreen is active (to prevent problems with screen scrolling); TODO make DP render at a lower res and scale up when NetWM fullscreen is in use

------------------------------------------------------------------------
r8686 | divverent | 2009-01-28 06:04:37 -0800 (Wed, 28 Jan 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/builddate.c
   M /trunk/darkplaces/makefile.inc

damn, revert the accidental change to makefile.inc

------------------------------------------------------------------------
r8685 | divverent | 2009-01-28 05:55:38 -0800 (Wed, 28 Jan 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c

fix a type

------------------------------------------------------------------------
r8684 | divverent | 2009-01-28 04:41:41 -0800 (Wed, 28 Jan 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/cl_gecko.c
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/cvar.h
   M /trunk/darkplaces/filematch.c
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/jpeg.c
   M /trunk/darkplaces/libcurl.c
   M /trunk/darkplaces/makefile.inc
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_sprite.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/sbar.c
   M /trunk/darkplaces/snd_mem.c
   M /trunk/darkplaces/snd_mix.c
   M /trunk/darkplaces/snd_modplug.c
   M /trunk/darkplaces/snd_ogg.c
   M /trunk/darkplaces/snd_wav.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sv_user.c
   M /trunk/darkplaces/svvm_cmds.c
   M /trunk/darkplaces/sys_shared.c
   M /trunk/darkplaces/wad.c
   M /trunk/darkplaces/zone.c

make DP compile with C++ again

------------------------------------------------------------------------
r8683 | divverent | 2009-01-28 03:26:12 -0800 (Wed, 28 Jan 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c

oops, fixing syntax

------------------------------------------------------------------------
r8682 | divverent | 2009-01-28 03:24:24 -0800 (Wed, 28 Jan 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c

some fixes for NetWM fullscreen

------------------------------------------------------------------------
r8681 | divverent | 2009-01-28 00:26:37 -0800 (Wed, 28 Jan 2009) | 4 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c

try to improve netwm fullscreen mode

should now restore the video mode and iconify itself when unfocused, and set the game video mode when restored

------------------------------------------------------------------------
r8680 | havoc | 2009-01-27 21:24:10 -0800 (Tue, 27 Jan 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cd_win.c

fix another warning reported by O.Sezer

------------------------------------------------------------------------
r8679 | havoc | 2009-01-27 20:51:13 -0800 (Tue, 27 Jan 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

fix for a typo from O.Sezer

------------------------------------------------------------------------
r8678 | divverent | 2009-01-27 14:11:55 -0800 (Tue, 27 Jan 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c

handle FocusIn and FocusOut in NetWM fullscreen mode

------------------------------------------------------------------------
r8677 | divverent | 2009-01-27 14:09:24 -0800 (Tue, 27 Jan 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c

fix my last fullscreen change

------------------------------------------------------------------------
r8676 | divverent | 2009-01-27 13:47:55 -0800 (Tue, 27 Jan 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/sv_main.c

attempt to fix csqc entity networking by not sending empty entity frames if no csqc entity was sent

------------------------------------------------------------------------
r8675 | divverent | 2009-01-27 07:19:44 -0800 (Tue, 27 Jan 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c

beginning of vid_netwmfullscreen; does not work yet (apparently, the fullscreen window gets no focus)

------------------------------------------------------------------------
r8674 | havoc | 2009-01-25 21:17:20 -0800 (Sun, 25 Jan 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

remove an unused variable

------------------------------------------------------------------------
r8673 | divverent | 2009-01-25 10:48:07 -0800 (Sun, 25 Jan 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fix typos on sizing collision patches

------------------------------------------------------------------------
r8672 | divverent | 2009-01-25 10:15:48 -0800 (Sun, 25 Jan 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

actually use the cross product of two DIFFERENT vectors...

------------------------------------------------------------------------
r8671 | havoc | 2009-01-25 09:57:37 -0800 (Sun, 25 Jan 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

fix stupid degenerate triangle check, I don't have a clue what I was
thinking when I wrote it

------------------------------------------------------------------------
r8670 | divverent | 2009-01-24 09:39:29 -0800 (Sat, 24 Jan 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fix modelyawradius calculation

------------------------------------------------------------------------
r8667 | divverent | 2009-01-23 11:29:16 -0800 (Fri, 23 Jan 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/cvar.c
   M /trunk/darkplaces/prvm_cmds.c

cvarlist, buf_cvarlist: support wildcards if present (if not present, it's treated as a prefix)
fix two places where cvar names were treated case insensitively, while they usually are case sensitive (e.g. when hashed with crc32)

------------------------------------------------------------------------
r8666 | divverent | 2009-01-23 11:17:17 -0800 (Fri, 23 Jan 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cvar.c

fix typo in Set/SetA

------------------------------------------------------------------------
r8665 | divverent | 2009-01-23 02:45:03 -0800 (Fri, 23 Jan 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

do the skipping here too

------------------------------------------------------------------------
r8664 | divverent | 2009-01-23 02:32:27 -0800 (Fri, 23 Jan 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/svvm_cmds.c

add an argument to filter out a cvar prefix

------------------------------------------------------------------------
r8663 | divverent | 2009-01-23 01:34:48 -0800 (Fri, 23 Jan 2009) | 4 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/cvar.c
   M /trunk/darkplaces/cvar.h
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.h
   M /trunk/darkplaces/svvm_cmds.c

+"DP_QC_CVAR_DESCRIPTION "
+"DP_QC_STRINGBUFFERS_CVARLIST "
allowing menu QC (and other code) to list all cvars, and retrieve their descriptions

------------------------------------------------------------------------
r8662 | divverent | 2009-01-22 00:20:15 -0800 (Thu, 22 Jan 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/svvm_cmds.c

DP_SV_ONENTITYPREPOSTSPAWNFUNCTION - hooks before and after spawning an entity from a map/ent

------------------------------------------------------------------------
r8661 | havoc | 2009-01-20 11:21:34 -0800 (Tue, 20 Jan 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_wgl.c

fix bug with menu_mouse_absolute 1 in Nexuiz

------------------------------------------------------------------------
r8660 | havoc | 2009-01-20 10:58:27 -0800 (Tue, 20 Jan 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/fractalnoise.c

fixed a serious bug in initialization of frac[][]

------------------------------------------------------------------------
r8659 | havoc | 2009-01-20 10:47:41 -0800 (Tue, 20 Jan 2009) | 4 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fix bugs with q1bsp/hlbsp rotating submodels, caused by CLIP brushes not
creating surfaces (thus vertex-based calculation of modelradius failed),
and some really stupid bugs with using min where it should have been max

------------------------------------------------------------------------
r8658 | havoc | 2009-01-19 13:14:27 -0800 (Mon, 19 Jan 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/cd_bsd.c
   M /trunk/darkplaces/cd_linux.c
   M /trunk/darkplaces/cd_null.c
   M /trunk/darkplaces/cd_sdl.c
   M /trunk/darkplaces/cd_shared.c
   M /trunk/darkplaces/cd_win.c
   M /trunk/darkplaces/cdaudio.h
   M /trunk/darkplaces/conproc.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/keys.h
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/menu.h

fix a number of char types that should be int, to make them immune to
unsigned char vs signed char disputes on different operating systems

------------------------------------------------------------------------
r8657 | divverent | 2009-01-18 11:10:25 -0800 (Sun, 18 Jan 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c

GAME_NEXUIZ: skip player entities in hitnetworkplayers if they have -666 (spectator) or -616 (nonsolid player) frags

------------------------------------------------------------------------
r8656 | havoc | 2009-01-17 07:25:59 -0800 (Sat, 17 Jan 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c

disable DGA mouse by default

------------------------------------------------------------------------
r8655 | havoc | 2009-01-16 10:03:27 -0800 (Fri, 16 Jan 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/progsvm.h

added servertime, serverprevtime, serverdeltatime globals to csqc

------------------------------------------------------------------------
r8654 | divverent | 2009-01-16 01:04:59 -0800 (Fri, 16 Jan 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c

- fix tracing against networked players on the client (properly check if a client is actually active before colliding against him)
- add float trace_networkentity to client VM, which helped debugging this

------------------------------------------------------------------------
r8653 | divverent | 2009-01-15 05:19:07 -0800 (Thu, 15 Jan 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/csprogs.h
   M /trunk/darkplaces/snd_main.c

make csqc entity sounds follow their entity

------------------------------------------------------------------------
r8652 | havoc | 2009-01-14 17:43:00 -0800 (Wed, 14 Jan 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

remove templights change

------------------------------------------------------------------------
r8651 | havoc | 2009-01-14 17:01:31 -0800 (Wed, 14 Jan 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/client.h

fix for more missing stuff

------------------------------------------------------------------------
r8650 | havoc | 2009-01-14 12:33:27 -0800 (Wed, 14 Jan 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/client.h

forgot to include this file, fixes PBLEND_INVMOD error

------------------------------------------------------------------------
r8649 | havoc | 2009-01-14 08:23:32 -0800 (Wed, 14 Jan 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

added blend and orientation commands for effectinfo.txt (overrides the
defaults chosen by the particle type)

------------------------------------------------------------------------
r8648 | divverent | 2009-01-13 11:21:20 -0800 (Tue, 13 Jan 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

cl_demo_mousegrab

------------------------------------------------------------------------
r8647 | havoc | 2009-01-13 07:25:25 -0800 (Tue, 13 Jan 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

I noticed the edgefriction value was wrong in the QW support (QW has
broken edgefriction, so it should always be 1 - it was set to 2, oops)

------------------------------------------------------------------------
r8646 | divverent | 2009-01-13 03:29:57 -0800 (Tue, 13 Jan 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_exec.c

fix warning

------------------------------------------------------------------------
r8645 | divverent | 2009-01-13 01:15:13 -0800 (Tue, 13 Jan 2009) | 4 lines
Changed paths:
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/prvm_exec.c
   M /trunk/darkplaces/prvm_execprogram.h

remove the PRVM_BOUNDSCHECK_CVAR define
instead, add a -noboundscheck command line option (those who really want to make use of that in their mod can easily make a wrapper that adds this command, e.g. a lnk file in the start menu)
also add a -norunaway command line option that turns off the runaway loop counter

------------------------------------------------------------------------
r8644 | divverent | 2009-01-11 22:19:15 -0800 (Sun, 11 Jan 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

fix csqc code insertion in autodemos

------------------------------------------------------------------------
r8643 | divverent | 2009-01-10 11:46:57 -0800 (Sat, 10 Jan 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

rotate the blur pentagram by 180 degrees :P

------------------------------------------------------------------------
r8642 | divverent | 2009-01-10 11:40:52 -0800 (Sat, 10 Jan 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

add a second parameter to the blur to mix the pentagram blur with the main image

------------------------------------------------------------------------
r8641 | divverent | 2009-01-10 11:33:30 -0800 (Sat, 10 Jan 2009) | 6 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

remove the latest change (it was redundant, as a glsl shader sure can query the texture matrix), and instead add an example 6-tap blur filter to the glsl code.

To test:
r_glsl_postprocess 1
r_glsl_postprocess_uservec1 "3 0 0 0"

------------------------------------------------------------------------
r8640 | divverent | 2009-01-10 10:22:47 -0800 (Sat, 10 Jan 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

add a new vec2 LowerRightCorner to the glsl shader. The screen texture is in 0..LowerRightCorner

------------------------------------------------------------------------
r8639 | divverent | 2009-01-08 11:06:17 -0800 (Thu, 08 Jan 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/sv_main.c

Add a comment explaining how the compression algorithms are negotiated

------------------------------------------------------------------------
r8638 | divverent | 2009-01-08 10:58:13 -0800 (Thu, 08 Jan 2009) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/fs.h
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c

Blub's "deflate" extension to the download system.
Currently only provides csprogs.dat in deflated form.
Compatible in both directions, compression is only done if both client and server use this new code.

------------------------------------------------------------------------
r8637 | divverent | 2009-01-08 08:07:01 -0800 (Thu, 08 Jan 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/keys.c

commandmode: use Cmd_ExecuteString so semicolons don't start new commands

------------------------------------------------------------------------
r8636 | divverent | 2009-01-08 05:10:42 -0800 (Thu, 08 Jan 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

reject downloads of non-regular files

------------------------------------------------------------------------
r8635 | divverent | 2009-01-08 05:09:53 -0800 (Thu, 08 Jan 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

FS_LoadFile: don't segfault when trying to open a non-regular file

------------------------------------------------------------------------
r8634 | divverent | 2009-01-08 02:45:32 -0800 (Thu, 08 Jan 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c

making the new cvars saved ones

------------------------------------------------------------------------
r8633 | divverent | 2009-01-08 02:39:16 -0800 (Thu, 08 Jan 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c

better defaults for headphones

------------------------------------------------------------------------
r8632 | divverent | 2009-01-08 02:34:39 -0800 (Thu, 08 Jan 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c

snd_spatialization_control: earphone friendly mode, reduces spatialization for distant objects

------------------------------------------------------------------------
r8631 | divverent | 2009-01-08 00:39:30 -0800 (Thu, 08 Jan 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

now handle the SV_VM_Begin stuff correctly here

------------------------------------------------------------------------
r8630 | divverent | 2009-01-08 00:38:06 -0800 (Thu, 08 Jan 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

fix overrun in netconn.c when creating status replies (player names with 63 characters don't get a null terminator)

------------------------------------------------------------------------
r8629 | divverent | 2009-01-08 00:26:25 -0800 (Thu, 08 Jan 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

now also save the old prog... hope THIS works always

------------------------------------------------------------------------
r8628 | divverent | 2009-01-08 00:23:19 -0800 (Thu, 08 Jan 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

oops, this is in the server VM

------------------------------------------------------------------------
r8627 | divverent | 2009-01-07 23:36:59 -0800 (Wed, 07 Jan 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

be a little more strict with contents of worldstatus and clientstatus fields (skip more "forbidden" characters in them as they would make parsing the resulting string ambiguous), and also send a team number in Nexuiz team games (similar to SoF's team numbers in status replies, except that spectators are shown as team 0). This is already supported by qstat.

------------------------------------------------------------------------
r8626 | divverent | 2009-01-07 23:34:44 -0800 (Wed, 07 Jan 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

new cvar: sv_status_show_qcstatus
when 1, the ".string clientstatus" is used, atoi-ed, instead of the frags for the "status" reply (similar to netconn's handling of this field to replace the frags number)

------------------------------------------------------------------------
r8625 | divverent | 2009-01-06 03:10:19 -0800 (Tue, 06 Jan 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_ogg.c

support more different vorbis comment names for looped audio (someone please test this!)

------------------------------------------------------------------------
r8624 | divverent | 2009-01-04 19:12:03 -0800 (Sun, 04 Jan 2009) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/model_brush.c

hide the R_Mesh_Draw message unless developer is 100 or a vertex/face count is even negative;
instead, complain about empty surfaces when loading a Q3BSP map
as this seems to happen on some maps written by q3map2

------------------------------------------------------------------------
r8623 | divverent | 2009-01-03 12:17:02 -0800 (Sat, 03 Jan 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

SV_PushMove: ignore pushes from and to "owned" entities

------------------------------------------------------------------------
r8622 | divverent | 2009-01-03 11:58:58 -0800 (Sat, 03 Jan 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

fix cleanup of player names that use ^xRGB

------------------------------------------------------------------------
r8621 | divverent | 2009-01-03 05:48:31 -0800 (Sat, 03 Jan 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fix lod group comparing for pos/neg zeroes

------------------------------------------------------------------------
r8620 | divverent | 2009-01-02 06:03:51 -0800 (Fri, 02 Jan 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

made particle PVS culling only take the origin into account; that way, it actually is a minor performance gain without any visible quality loss

------------------------------------------------------------------------
r8619 | divverent | 2009-01-02 05:48:44 -0800 (Fri, 02 Jan 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

check BoxTouchingPVS, not PointInLeaf

------------------------------------------------------------------------
r8618 | divverent | 2009-01-02 05:48:04 -0800 (Fri, 02 Jan 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

Added vis culling of particles, and a new cvar cl_particles_novis.
However, it is 1 by default, as the vis culling appears to gain no performance.

------------------------------------------------------------------------
r8617 | divverent | 2009-01-01 10:17:26 -0800 (Thu, 01 Jan 2009) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

model_brush: use the same tesselation number for patches in the same LOD group
(q3map2 writes the same mins/maxs for any patch inside a LOD group, and this fact is used for identifying LOD groups)

------------------------------------------------------------------------
r8616 | divverent | 2009-01-01 09:01:49 -0800 (Thu, 01 Jan 2009) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

also support entity lumps that are NOT NUL terminated

------------------------------------------------------------------------
r8615 | divverent | 2008-12-30 00:30:17 -0800 (Tue, 30 Dec 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/console.c

fix two bugs in handling of invalid ^xRGB codes

------------------------------------------------------------------------
r8612 | divverent | 2008-12-29 01:32:47 -0800 (Mon, 29 Dec 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

for null models, respect the mins/maxs set by QC for culling

------------------------------------------------------------------------
r8611 | divverent | 2008-12-29 01:29:55 -0800 (Mon, 29 Dec 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/svvm_cmds.c

add DP_NULL_MODEL extension

------------------------------------------------------------------------
r8610 | divverent | 2008-12-29 01:28:22 -0800 (Mon, 29 Dec 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

only load the null model ONCE

------------------------------------------------------------------------
r8609 | divverent | 2008-12-29 01:20:51 -0800 (Mon, 29 Dec 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h

models: add a special built-in model name "null" that does not draw and has a zero bbox

------------------------------------------------------------------------
r8608 | havoc | 2008-12-28 16:20:33 -0800 (Sun, 28 Dec 2008) | 4 lines
Changed paths:
   M /trunk/darkplaces/host.c

open client sockets before video starts, so that the Windows Firewall
prompt will occur before video starts (it tends to screw up graphics
contexts otherwise)

------------------------------------------------------------------------
r8607 | divverent | 2008-12-28 11:20:49 -0800 (Sun, 28 Dec 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

bring back the static tokenize string buffer, because PRVM_SetTempString might mess up the PRVM_G_STRING returned char*

------------------------------------------------------------------------
r8606 | divverent | 2008-12-28 10:47:42 -0800 (Sun, 28 Dec 2008) | 6 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/sys_linux.c
   M /trunk/darkplaces/sys_win.c

fix whitespace handling:
treat ONLY the following characters as whitespace:
NUL, TAB, LF, CR, SPC
Alternatively, there is commented out macro code in quakedef.h to accept any chars in 0..32 as whitespace.
Previously: 0..32 and 128..255 (due to signed char)

------------------------------------------------------------------------
r8605 | divverent | 2008-12-27 06:35:13 -0800 (Sat, 27 Dec 2008) | 5 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.h
   M /trunk/darkplaces/svvm_cmds.c

new tokenizer tokenize_console that matches the console tokenizing
new builtins argv_start_index and argv_end_index
support negative indexes to argv* as indexes from the end of the argument list (similar to perl)
--> extension: DP_QC_TOKENIZE_CONSOLE

------------------------------------------------------------------------
r8604 | divverent | 2008-12-26 08:55:09 -0800 (Fri, 26 Dec 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c

fix interpretation of text brightness/contrast cvars when a color multiplier is set

------------------------------------------------------------------------
r8603 | divverent | 2008-12-25 14:16:19 -0800 (Thu, 25 Dec 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c

remove a redundant check fixing a gcc warning

------------------------------------------------------------------------
r8602 | divverent | 2008-12-25 10:03:49 -0800 (Thu, 25 Dec 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/draw.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/sv_main.c

terrencehill's color codes patch. Please test thoroughly! Syntax: ^xF00 = red

------------------------------------------------------------------------
r8601 | divverent | 2008-12-25 06:40:08 -0800 (Thu, 25 Dec 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/sys_linux.c

Remove disabling of stdin for the text console. Helps with interfacing scripts with the DarkPlaces client.

------------------------------------------------------------------------
r8600 | havoc | 2008-12-17 21:18:21 -0800 (Wed, 17 Dec 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

fixed a bug with "time" command in effectinfo.txt to use float parsing
instead of int parsing

------------------------------------------------------------------------
r8599 | havoc | 2008-12-17 20:35:42 -0800 (Wed, 17 Dec 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/protocol.h

forgot to commit this file in the DP_EF_NOSELFSHADOW extension patch

------------------------------------------------------------------------
r8598 | havoc | 2008-12-17 20:34:35 -0800 (Wed, 17 Dec 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/svvm_cmds.c
   M /trunk/darkplaces/todo

added DP_EF_NOSELFSHADOW extension

------------------------------------------------------------------------
r8597 | divverent | 2008-12-17 12:47:14 -0800 (Wed, 17 Dec 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

fix crash

------------------------------------------------------------------------
r8596 | divverent | 2008-12-17 06:14:27 -0800 (Wed, 17 Dec 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

fix warnings

------------------------------------------------------------------------
r8595 | divverent | 2008-12-16 23:16:16 -0800 (Tue, 16 Dec 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

more space for client numbers

------------------------------------------------------------------------
r8594 | divverent | 2008-12-16 23:10:27 -0800 (Tue, 16 Dec 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

new command by terrencehill: "status 1" and "status 2" as alternate, more readable status displays. "status" unchanged.

------------------------------------------------------------------------
r8593 | divverent | 2008-12-16 06:23:46 -0800 (Tue, 16 Dec 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/libcurl.c

curl: longer URLs

------------------------------------------------------------------------
r8592 | divverent | 2008-12-16 05:30:47 -0800 (Tue, 16 Dec 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

when loading a game, free "text" later

------------------------------------------------------------------------
r8591 | divverent | 2008-12-16 04:54:38 -0800 (Tue, 16 Dec 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

save game loading: abort when a token is NULL (might happen if the last line ends without newline)

------------------------------------------------------------------------
r8590 | divverent | 2008-12-15 23:01:36 -0800 (Mon, 15 Dec 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/prvm_edict.c

- add debug prints for saving/loading games for prvm_entityparsing
- make PRVM_UglyValueString escape " to \" (note that loading does not match that, as parsebackslash is off in the call to COM_ParseToken_Simple - why?)

------------------------------------------------------------------------
r8589 | divverent | 2008-12-15 01:31:55 -0800 (Mon, 15 Dec 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/cd_shared.c

1. also play sounds outside cdtracks/ as CD tracks
2. "cdaudio 4": play a random CD track for named tracks

------------------------------------------------------------------------
r8588 | divverent | 2008-12-15 01:15:32 -0800 (Mon, 15 Dec 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/cd_shared.c

add new cvar "cdaudio" to select priorities of CD and fake tracks;
turn off "Playing fake CD track" messages if only fake tracks could be used anyway

------------------------------------------------------------------------
r8587 | divverent | 2008-12-14 13:57:52 -0800 (Sun, 14 Dec 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

Fix alpha transparent textures (used by HLBSP maps) in HL/Q1 BSP maps

------------------------------------------------------------------------
r8586 | divverent | 2008-12-09 12:52:00 -0800 (Tue, 09 Dec 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix color averaging of palette images from quake

------------------------------------------------------------------------
r8585 | divverent | 2008-12-09 03:39:06 -0800 (Tue, 09 Dec 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

make color averaging use 64bit integers, instead of 32bit ones, as they wrap on 512x512 images

------------------------------------------------------------------------
r8584 | divverent | 2008-12-07 22:43:07 -0800 (Sun, 07 Dec 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

no idea why, but ambient needed halving in showsurfaces 3

------------------------------------------------------------------------
r8583 | divverent | 2008-12-07 22:33:36 -0800 (Sun, 07 Dec 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

r_showsurfaces 3 (needs a better cvar name, by the way): support r_fullbright correctly

------------------------------------------------------------------------
r8582 | divverent | 2008-12-07 11:37:24 -0800 (Sun, 07 Dec 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix color averaging

------------------------------------------------------------------------
r8581 | divverent | 2008-12-07 10:32:33 -0800 (Sun, 07 Dec 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix overbrightness :(

------------------------------------------------------------------------
r8580 | divverent | 2008-12-07 10:28:33 -0800 (Sun, 07 Dec 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

no, this way of colormapping looks best after all... sorry

------------------------------------------------------------------------
r8579 | divverent | 2008-12-07 10:23:15 -0800 (Sun, 07 Dec 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

better handling of color tints by colormap

------------------------------------------------------------------------
r8578 | divverent | 2008-12-07 10:09:09 -0800 (Sun, 07 Dec 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

factor out the pixel averaging code

------------------------------------------------------------------------
r8577 | divverent | 2008-12-07 03:51:23 -0800 (Sun, 07 Dec 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix showsurfaces 3 bugs on augenkrebs

------------------------------------------------------------------------
r8576 | divverent | 2008-12-07 03:32:52 -0800 (Sun, 07 Dec 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix rendering of fullbright stuff in showsurfaces 3

------------------------------------------------------------------------
r8575 | divverent | 2008-12-07 03:17:28 -0800 (Sun, 07 Dec 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

now support fog in the eeepc path

------------------------------------------------------------------------
r8574 | divverent | 2008-12-07 02:48:48 -0800 (Sun, 07 Dec 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

showsurfaces 3: allow depth sorting

------------------------------------------------------------------------
r8573 | divverent | 2008-12-07 00:06:38 -0800 (Sun, 07 Dec 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

showsurfaces 3: refactor it a bit; disable r_water in this mode

------------------------------------------------------------------------
r8572 | divverent | 2008-12-06 13:08:15 -0800 (Sat, 06 Dec 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

undo the last fix, and instead make a new fix that does not make dark stuff bright.

------------------------------------------------------------------------
r8571 | divverent | 2008-12-06 12:59:33 -0800 (Sat, 06 Dec 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix typo


------------------------------------------------------------------------
r8570 | divverent | 2008-12-06 12:54:56 -0800 (Sat, 06 Dec 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix a NULL

------------------------------------------------------------------------
r8569 | divverent | 2008-12-06 12:17:40 -0800 (Sat, 06 Dec 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

brighten up the averaged texture value by factor 2 to make it look right

------------------------------------------------------------------------
r8568 | divverent | 2008-12-06 12:12:41 -0800 (Sat, 06 Dec 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

support r_ambient in "eeepc mode"

------------------------------------------------------------------------
r8567 | divverent | 2008-12-06 12:06:53 -0800 (Sat, 06 Dec 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

r_showsurfaces 3 "eeepc mode": support blend funcs

------------------------------------------------------------------------
r8566 | divverent | 2008-12-06 05:58:48 -0800 (Sat, 06 Dec 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

improved r_showsurfaces 3. Should be PLAYABLE!!!1 now.

------------------------------------------------------------------------
r8565 | divverent | 2008-12-06 05:02:02 -0800 (Sat, 06 Dec 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_shared.h

experimental new mode "r_showsurfaces 3": shows faces in average texture color

------------------------------------------------------------------------
r8564 | divverent | 2008-12-03 05:12:31 -0800 (Wed, 03 Dec 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

Q3BSP: only generate the shadow mesh if on a client. Skip that part on the dedicated server. Reduces load time of redstarrepublic4.bsp from 21.6s to 12.3s on a dedicated server.

------------------------------------------------------------------------
r8563 | havoc | 2008-12-02 16:38:24 -0800 (Tue, 02 Dec 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

fix a signedness warning

------------------------------------------------------------------------
r8562 | havoc | 2008-12-02 16:34:17 -0800 (Tue, 02 Dec 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

fix for a crash in certain q1bsp maps with very large polygons when
cl_stainmaps is on, thanks to Andreas Dehmel for this fix

------------------------------------------------------------------------
r8561 | divverent | 2008-11-28 08:48:36 -0800 (Fri, 28 Nov 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

move texture compression disabling and picmip into LookupQ3Shader, based on the default flags that are used for shaderless textures. Reason: playermodels by leileilol used Q3 shaders, which made them exempt from picmip if r_picmipworld is used.

------------------------------------------------------------------------
r8560 | divverent | 2008-11-28 07:15:53 -0800 (Fri, 28 Nov 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/client.h

effectinfo: add "stretchfactor"

------------------------------------------------------------------------
r8559 | divverent | 2008-11-27 08:30:44 -0800 (Thu, 27 Nov 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/csprogs.c

UGLY HACK: intercept curl commands when playing back demos to immediately load all required pk3 files

------------------------------------------------------------------------
r8557 | havoc | 2008-11-20 00:09:29 -0800 (Thu, 20 Nov 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/csprogs.c

added some flag clearing in csqc render entity setup to make sure that
the shadow/light/noselfshadow flags are set correctly

------------------------------------------------------------------------
r8556 | havoc | 2008-11-11 12:40:57 -0800 (Tue, 11 Nov 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

grab mouse when in controls menu, so that mouse clicks can be captured

------------------------------------------------------------------------
r8555 | divverent | 2008-11-10 06:02:19 -0800 (Mon, 10 Nov 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c

r_shadows 2: cast shadows always DOWN, ignore level lighting

------------------------------------------------------------------------
r8554 | divverent | 2008-11-10 05:58:11 -0800 (Mon, 10 Nov 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/r_shadow.c

r_shadows: use the parent entity's light direction for shadowing attached entities. Prevents tearing apart the weapon from its holder.

------------------------------------------------------------------------
r8553 | divverent | 2008-11-10 03:18:36 -0800 (Mon, 10 Nov 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c

glx: support vid_stick_mouse (to always warp to the center, as opposed to only warp if half the screen size is crossed)

------------------------------------------------------------------------
r8552 | divverent | 2008-11-09 11:05:57 -0800 (Sun, 09 Nov 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c

sorry for this debug print

------------------------------------------------------------------------
r8551 | divverent | 2008-11-09 03:50:44 -0800 (Sun, 09 Nov 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c

add code to vid_glx to turn off mouse acceleration; also support vid_wgl's option -noforcemparms in X11 to turn off that new code
makes vid_dgamouse 0 a viable workaround for the ubuntu evdev problems

------------------------------------------------------------------------
r8550 | divverent | 2008-11-08 08:33:20 -0800 (Sat, 08 Nov 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

get rid of skinframe loading spam on dedicated servers

------------------------------------------------------------------------
r8549 | divverent | 2008-11-06 06:20:01 -0800 (Thu, 06 Nov 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

fix bug in cs_*project with v_flipped

------------------------------------------------------------------------
r8548 | havoc | 2008-11-06 04:55:19 -0800 (Thu, 06 Nov 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/sv_main.c

changed default edgefriction to 1 to match QW physics, so you don't lose
speed when running off a ledge

------------------------------------------------------------------------
r8547 | divverent | 2008-11-05 08:35:24 -0800 (Wed, 05 Nov 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

remove warning about signed/unsigned

------------------------------------------------------------------------
r8546 | divverent | 2008-11-04 11:16:07 -0800 (Tue, 04 Nov 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/sv_user.c

fix some format string errors, and return value of read() ignored warnings

------------------------------------------------------------------------
r8545 | divverent | 2008-11-04 02:45:10 -0800 (Tue, 04 Nov 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_alsa.c

ALSA: check return values to be < 0, not != 0. Fixes problem with pulseaudio (ALSA apparently decided to start returning, here, +1 for success). See https://bugs.helixcommunity.org/show_bug.cgi?id=7375&link=0

------------------------------------------------------------------------
r8544 | divverent | 2008-11-01 10:44:32 -0700 (Sat, 01 Nov 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_user.c

csqc packet log code (for entityframedatabase 5 only, i.e. DP5 and higher)

------------------------------------------------------------------------
r8543 | divverent | 2008-11-01 10:07:24 -0700 (Sat, 01 Nov 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.inc

add a note to the makefile that -ffast-math and -funsafe-math-optimizations must not be used with darkplaces (until further notice)

------------------------------------------------------------------------
r8542 | divverent | 2008-11-01 08:57:49 -0700 (Sat, 01 Nov 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/csprogs.c

fix broken demos with csqc code

------------------------------------------------------------------------
r8541 | divverent | 2008-10-31 03:07:43 -0700 (Fri, 31 Oct 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/keys.c

if in menu, make con_closeontoggleconsole.integer also enable the toggleconsole key

------------------------------------------------------------------------
r8540 | divverent | 2008-10-26 09:10:40 -0700 (Sun, 26 Oct 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_modplug.c

fix two warnings with statically linked-in libmodplug

------------------------------------------------------------------------
r8539 | divverent | 2008-10-25 03:37:40 -0700 (Sat, 25 Oct 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/snd_modplug.c

mod_q3bsp_nolightmaps: do not load lightmaps, use the bad q3map2-written vertex lighting instead (you have been warned). Mostly useful for maps with HUUUUGE lightmaps on low-end systems.
modplug: turn up the volume, if the installed libmodplug allows it.

------------------------------------------------------------------------
r8538 | havoc | 2008-10-23 03:49:39 -0700 (Thu, 23 Oct 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_textures.h

check texnum > 0 rather than >= 0

------------------------------------------------------------------------
r8537 | havoc | 2008-10-23 03:47:59 -0700 (Thu, 23 Oct 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

check GLTEXF_UPLOAD flag before deleting a texnum that may never have
been allocated

------------------------------------------------------------------------
r8536 | havoc | 2008-10-23 03:44:31 -0700 (Thu, 23 Oct 2008) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

changed default texnum value from -1 to 0 in rtexture_t, this is only a
safety measure against any possible feeding of -1 to drivers that crash
when given an invalid texnum

------------------------------------------------------------------------
r8535 | divverent | 2008-10-20 06:20:06 -0700 (Mon, 20 Oct 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

q3map2 is too stupid to calculate proper surface normals when q3map_nonplanar is used (the lightmap and deluxemap coords correspond to virtually random coordinates on that luxel, and NOT to its center, because recursive triangle subdivision is used to map the luxels to coordinates on the draw surfaces), which also causes deluxemaps to be wrong because light contributions from the wrong side of the surface are added up. To prevent divisions by zero or strong exaggerations, a max() nudge is done here at expense of some additional fps. This is ONLY needed for deluxemaps, tangentspace deluxemap avoid this problem by design.

------------------------------------------------------------------------
r8534 | havoc | 2008-10-19 19:07:00 -0700 (Sun, 19 Oct 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

don't pass a texnum of -1 to glDeleteTextures during shutdown, this has
been crashing ATI drivers

------------------------------------------------------------------------
r8532 | divverent | 2008-10-18 08:48:43 -0700 (Sat, 18 Oct 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

cvar mod_alias_supporttagscale to be able to turn off scaling of attached entities by the attachment tag matrix (fixes problems with zmodel generated zyms)

------------------------------------------------------------------------
r8531 | havoc | 2008-10-15 19:40:43 -0700 (Wed, 15 Oct 2008) | 4 lines
Changed paths:
   M /trunk/darkplaces/svvm_cmds.c

minor correction to some WriteByte calls that should be WriteChar in
te_spark and te_blood builtins - these worked fine already, but were not
the correct function to use

------------------------------------------------------------------------
r8530 | divverent | 2008-10-15 07:49:20 -0700 (Wed, 15 Oct 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/image_png.c

fix an obvious crash in PNG loading

------------------------------------------------------------------------
r8529 | havoc | 2008-10-14 12:30:02 -0700 (Tue, 14 Oct 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/mathlib.h

modified lhrandom (and hence the QC random builtin) to never return the
max value, reducing crashes in some mods and being more consistent

------------------------------------------------------------------------
r8528 | divverent | 2008-10-11 08:06:28 -0700 (Sat, 11 Oct 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/draw.h
   M /trunk/darkplaces/gl_draw.c

add DRAWFLAG_SCREEN (which basically is like invert-modulate-invert, equivalent to GIMP's "screen" layer operation, no idea how photoshop calls it)
Just like modulate always darkens, screen always brightens.

------------------------------------------------------------------------
r8527 | divverent | 2008-10-09 04:47:54 -0700 (Thu, 09 Oct 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fix map loading causing faces to not be rendered

------------------------------------------------------------------------
r8526 | divverent | 2008-10-06 10:26:35 -0700 (Mon, 06 Oct 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/protocol.c

fix warnings in my last change

------------------------------------------------------------------------
r8525 | divverent | 2008-10-06 09:09:34 -0700 (Mon, 06 Oct 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/protocol.c

add entity size profiling (currently spams the console with sizes of entity updates if developer_networkentities is >= 2, may later change it to collect statistics based on classname)

------------------------------------------------------------------------
r8524 | divverent | 2008-10-05 23:43:35 -0700 (Sun, 05 Oct 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/protocol.c

resend csqc entities COMPLETELY if they became inactive and later active again

------------------------------------------------------------------------
r8523 | divverent | 2008-10-05 13:08:16 -0700 (Sun, 05 Oct 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

fix engine crash when a polygon was left over and had a texture reference when switching maps

------------------------------------------------------------------------
r8522 | havoc | 2008-10-04 10:42:22 -0700 (Sat, 04 Oct 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/vid_shared.c

disabled GL_ARB_texture_non_power_of_two on Mac OS X because all the
drivers claim to support it, but it's often unaccelerated or crashes

------------------------------------------------------------------------
r8521 | havoc | 2008-10-04 10:38:02 -0700 (Sat, 04 Oct 2008) | 7 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

implemented Quake-compatible savegame saving (writes 64 or more styles)
enhanced savegame format with a large comment block at the end
containing the true lightstyle data (not padded with m lines), and model
and sound precaches, this should fix the famous Quake bug of reloading a
savegame with a different version of a mod, or a mod that randomly
precaches different monsters or similar

------------------------------------------------------------------------
r8520 | divverent | 2008-10-04 07:01:05 -0700 (Sat, 04 Oct 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/draw.h

use skinframes for R_BeginPolygon; helps with csqc 3D polygon rendering (e.g. mipmapping becomes possible, and no longer conflicts in the GL_CLAMP state between different kinds to draw stuff)

------------------------------------------------------------------------
r8519 | havoc | 2008-10-02 02:48:23 -0700 (Thu, 02 Oct 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/csprogs.c

added width and height parameters to CSQC_UpdateView (a feature from
EXT_CSQC_1 in FTEQW)

------------------------------------------------------------------------
r8518 | havoc | 2008-10-02 02:43:52 -0700 (Thu, 02 Oct 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

fix setview VF_VIEWPORT and variants to use screen coords rather than
draw coords, this matches FTEQW

------------------------------------------------------------------------
r8517 | havoc | 2008-10-02 02:14:53 -0700 (Thu, 02 Oct 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

fix cs_project and cs_unproject builtins, they were completely ignoring
the view rectangle and not centered

------------------------------------------------------------------------
r8516 | divverent | 2008-09-30 07:05:01 -0700 (Tue, 30 Sep 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

undo q3map2's directional light attenuation before deluxemapping. Now deluxemapping and non-deluxemapping have the same perceived brightness. May reduce fps in deluxemapping mode.

------------------------------------------------------------------------
r8515 | divverent | 2008-09-27 03:06:54 -0700 (Sat, 27 Sep 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fix a tiny leak

------------------------------------------------------------------------
r8511 | divverent | 2008-09-27 02:17:19 -0700 (Sat, 27 Sep 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

prefer INTERNAL lightmaps

------------------------------------------------------------------------
r8509 | divverent | 2008-09-21 22:50:55 -0700 (Sun, 21 Sep 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.h

new menu QC builtin string netaddress_resolve(string ip, float port). Not sure if the others QCs should get it too.

------------------------------------------------------------------------
r8508 | divverent | 2008-09-21 03:54:57 -0700 (Sun, 21 Sep 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/netconn.h

seta net_slist_favorites

------------------------------------------------------------------------
r8507 | havoc | 2008-09-20 05:10:26 -0700 (Sat, 20 Sep 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c

remove some unneeded code

------------------------------------------------------------------------
r8506 | havoc | 2008-09-16 06:36:21 -0700 (Tue, 16 Sep 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.h

patch from esteel making the findkeysforcommand builtin available in
csqc (formerly only available in menu qc)

------------------------------------------------------------------------
r8505 | divverent | 2008-09-13 02:15:36 -0700 (Sat, 13 Sep 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/libcurl.c
   M /trunk/darkplaces/libcurl.h
   M /trunk/darkplaces/model_brush.c

fix lightmap loading from TGAs; fix display of QC-initiated downloads

------------------------------------------------------------------------
r8504 | divverent | 2008-09-12 23:50:30 -0700 (Fri, 12 Sep 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h

experimental (not yet tested) support for q3map2 -lightmapsize written external higher-resolution lightmaps

------------------------------------------------------------------------
r8503 | divverent | 2008-09-12 01:18:19 -0700 (Fri, 12 Sep 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/libcurl.c

curl: reject file:// URLs

------------------------------------------------------------------------
r8502 | divverent | 2008-09-12 01:14:24 -0700 (Fri, 12 Sep 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/svvm_cmds.c

add extension DP_QC_URI_GET (downloads HTTP/whatever URLs to QC strings using a callback)

------------------------------------------------------------------------
r8501 | divverent | 2008-09-12 00:24:19 -0700 (Fri, 12 Sep 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h

new tcmod: "tcmod page <width> <height> <time>", as poor man's animmap alternative (stores all frames in ONE image in a <width>x<height> grid, and switches to the next frame every <time> seconds)

------------------------------------------------------------------------
r8500 | divverent | 2008-09-11 23:57:29 -0700 (Thu, 11 Sep 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/libcurl.c
   M /trunk/darkplaces/libcurl.h

added curl function: Curl_Begin_ToMemory; will later use this to load stuff into memory with HTTP

------------------------------------------------------------------------
r8499 | divverent | 2008-09-10 23:32:22 -0700 (Wed, 10 Sep 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h

support Q3BSP version 47 loading (format now written by q3map2 :( )

------------------------------------------------------------------------
r8498 | divverent | 2008-09-10 23:15:38 -0700 (Wed, 10 Sep 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h

add r_shadow_glossexact to toggle between old and new gloss code; the difference in glossexponent is compensated for.
To get the look like before this commit, multiply r_shadow_glossexponent by 4 and keep r_shadow_glossexact on 1.

------------------------------------------------------------------------
r8497 | divverent | 2008-09-10 02:57:24 -0700 (Wed, 10 Sep 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.inc
   M /trunk/darkplaces/vid_glx.c

Solaris compile fixes

------------------------------------------------------------------------
r8496 | divverent | 2008-09-10 00:42:36 -0700 (Wed, 10 Sep 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

add a missing normalize, fixing gloss issues

------------------------------------------------------------------------
r8495 | divverent | 2008-09-09 23:50:53 -0700 (Tue, 09 Sep 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/keys.h

add a half-baked "commandmode" (currently it has, like messagemode, no history, no line editing)

------------------------------------------------------------------------
r8494 | divverent | 2008-09-09 23:09:36 -0700 (Tue, 09 Sep 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_user.c

bound by 0.1 again (this bounding had its reason) AND by sv_clmovement_waitforinput * sys_ticrate

------------------------------------------------------------------------
r8493 | divverent | 2008-09-09 23:04:19 -0700 (Tue, 09 Sep 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sv_user.c

fix speedhack issue with low cl_netfps / packet loss on servers with sv_clmovement_waitforinput * sys_ticrate < 0.1

------------------------------------------------------------------------
r8492 | divverent | 2008-09-06 13:57:32 -0700 (Sat, 06 Sep 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

sv_status_privacy", "0", "do not show IP addresses in 'status' replies to clients

------------------------------------------------------------------------
r8491 | divverent | 2008-09-04 02:28:23 -0700 (Thu, 04 Sep 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/mathlib.c

fix the mathlib corner case vectoangles2('0 0 -1', '...')

------------------------------------------------------------------------
r8490 | havoc | 2008-09-03 23:12:34 -0700 (Wed, 03 Sep 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

482

------------------------------------------------------------------------
r8489 | havoc | 2008-09-03 23:06:07 -0700 (Wed, 03 Sep 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

fix id1 demos to not show deathmatch overlay (they incorrectly contain
gametype deathmatch)

------------------------------------------------------------------------
r8488 | havoc | 2008-09-03 22:56:33 -0700 (Wed, 03 Sep 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

fix crashes on Win64 builds caused by stack overflow in R_DrawRTLight
(reported by Willis)

------------------------------------------------------------------------
r8487 | havoc | 2008-09-03 22:51:51 -0700 (Wed, 03 Sep 2008) | 6 lines
Changed paths:
   M /trunk/darkplaces/cl_demo.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/dpvsimpledecode.c
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/fs.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/jpeg.c
   M /trunk/darkplaces/libcurl.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/sv_demo.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/wad.c

split FS_Open into FS_OpenRealFile and FS_OpenVirtualFile (read-only),
this allows the savegame menu to only display savegames from the current
save directory (not other directories in the virtual filesystem)
added b (binary) flag to a few FS_OpenRealFile calls, and removed from a
few others (so that logs and QuakeC-written files use OS line endings)

------------------------------------------------------------------------
r8486 | havoc | 2008-09-03 22:46:40 -0700 (Wed, 03 Sep 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/makefile.inc

use ?= operator for CPUOPTIMIZATIONS
added an experimental CPUOPTIMIZATIONS comment as a suggestion

------------------------------------------------------------------------
r8485 | divverent | 2008-09-02 02:10:32 -0700 (Tue, 02 Sep 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.inc

makefile: show usage note when someone is using the bin-release or the darkplaces-glx targets directly (to override this, pass LEVEL=1 or LEVEL=2 as make arguments)

------------------------------------------------------------------------
r8484 | molivier | 2008-08-28 03:30:38 -0700 (Thu, 28 Aug 2008) | 1 line
Changed paths:
   M /trunk/darkplaces/snd_coreaudio.c

Fixed threaded mode in the CoreAudio sound module
------------------------------------------------------------------------
r8483 | molivier | 2008-08-28 03:12:48 -0700 (Thu, 28 Aug 2008) | 1 line
Changed paths:
   M /trunk/darkplaces/makefile.inc

Fixed a typo that caused snd_coreaudio.c to be compiled at link time, without the usual compilation flags and warnings
------------------------------------------------------------------------
r8482 | havoc | 2008-08-28 02:50:37 -0700 (Thu, 28 Aug 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

changed default values for gl_texturecompression_2d and normalmaps and
q3bsp lightmaps to 0 (off), bringing the defaults in line with Nexuiz

------------------------------------------------------------------------
r8481 | havoc | 2008-08-28 02:38:27 -0700 (Thu, 28 Aug 2008) | 5 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

reworked specular lighting to use real reflection math instead of the
averaged-directions approximation that was used before
no longer normalizes deluxemap samples, this may help with some "bright
edge near shadow" interpolation issues

------------------------------------------------------------------------
r8480 | havoc | 2008-08-26 11:24:36 -0700 (Tue, 26 Aug 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

reworked mdl .skin file loading a bit to fix problems with not loading
.mdl_1.skin onward

------------------------------------------------------------------------
r8479 | havoc | 2008-08-25 08:07:15 -0700 (Mon, 25 Aug 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

fix support for time command in effectinfo.txt - it was not being passed
on to the CL_NewParticle calls

------------------------------------------------------------------------
r8478 | divverent | 2008-08-24 12:50:08 -0700 (Sun, 24 Aug 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/console.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/netconn.c

rcon: use multiple reply packets to fit any size (where "any" means "as big as the OS's socket buffer, about 32k on Linux)

------------------------------------------------------------------------
r8477 | divverent | 2008-08-24 12:15:27 -0700 (Sun, 24 Aug 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_sdl.c

no, my PC can't take 1024 bytes buffer size in SDL (clicks in background). Increased to 2048.

------------------------------------------------------------------------
r8476 | divverent | 2008-08-24 08:21:42 -0700 (Sun, 24 Aug 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c

fix NOCLAMP

------------------------------------------------------------------------
r8475 | divverent | 2008-08-24 08:03:26 -0700 (Sun, 24 Aug 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/draw.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/menu.c

new flag CACHEPICFLAG_NOCLAMP; use it for R_PolygonBegin polygons

------------------------------------------------------------------------
r8474 | divverent | 2008-08-24 07:57:06 -0700 (Sun, 24 Aug 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

add missing R_Mesh_ResetTextureState call (to fix CSQC polygon rendering)

------------------------------------------------------------------------
r8473 | divverent | 2008-08-24 03:58:46 -0700 (Sun, 24 Aug 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_sdl.c

SDL: reduce the sound buffer size (too much lag otherwise)

------------------------------------------------------------------------
r8472 | divverent | 2008-08-24 03:44:50 -0700 (Sun, 24 Aug 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_demo.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/csprogs.h

fix Sajt's errors (in Visual Studio, I assume) in a better way - by changing the variable types, not casting. Also, only record one instance of the same csprogs into the demo.

------------------------------------------------------------------------
r8471 | divverent | 2008-08-24 03:19:23 -0700 (Sun, 24 Aug 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

also consider vid_mouse cvar when key_dest is key_menu

------------------------------------------------------------------------
r8470 | divverent | 2008-08-24 03:09:15 -0700 (Sun, 24 Aug 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/keys.c

remove redundant repeat ignoring

------------------------------------------------------------------------
r8469 | divverent | 2008-08-24 03:07:57 -0700 (Sun, 24 Aug 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/keys.c

handle F key binds correctly (up event shall not go to CSQC)

------------------------------------------------------------------------
r8468 | sajt | 2008-08-23 21:08:43 -0700 (Sat, 23 Aug 2008) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_demo.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/csprogs.c

fix some errors and warnings
------------------------------------------------------------------------
r8467 | divverent | 2008-08-23 00:30:19 -0700 (Sat, 23 Aug 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/jpeg.c

jpeg: handle errors properly (with longjmp)

------------------------------------------------------------------------
r8466 | havoc | 2008-08-22 15:46:31 -0700 (Fri, 22 Aug 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.h

forgot to update this for dpshadow/dpnoshadow

------------------------------------------------------------------------
r8465 | havoc | 2008-08-22 14:48:45 -0700 (Fri, 22 Aug 2008) | 4 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

added shader keywords dpshadow and dpnoshadow (no parameters), these
modify the shadowing properties of a mesh, regardless of its other
properties

------------------------------------------------------------------------
r8464 | havoc | 2008-08-22 14:47:39 -0700 (Fri, 22 Aug 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

default cl_maxfps to 0 rather than 1000000

------------------------------------------------------------------------
r8463 | havoc | 2008-08-22 04:26:53 -0700 (Fri, 22 Aug 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/host.c

allow cl_maxfps and cl_maxidlefps to be 0, meaning unlimited (like in
many QW clients)

------------------------------------------------------------------------
r8462 | havoc | 2008-08-20 11:33:42 -0700 (Wed, 20 Aug 2008) | 7 lines
Changed paths:
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c

redesigned csqc shared entity .Version handling, now internally uses a
flags value instead, while keeping compatibility with .Version (simply
sets flags to 1), each frame the flags value is merged into the
per-client entity flags and cleared, the flags value is exposed to qc as
.float SendFlags, and is a complete alternative to .Version, allowing
multiple updatable properties on an entity to be independently tracked

------------------------------------------------------------------------
r8461 | havoc | 2008-08-19 06:29:33 -0700 (Tue, 19 Aug 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/lhnet.c
   M /trunk/darkplaces/lhnet.h

implemented an lhnetaddresstype_t enum instead of using #define's

------------------------------------------------------------------------
r8460 | havoc | 2008-08-19 06:16:27 -0700 (Tue, 19 Aug 2008) | 7 lines
Changed paths:
   M /trunk/darkplaces/lhnet.c
   M /trunk/darkplaces/lhnet.h

redesigned lhnetaddress_t struct to be a generic container for sockaddr,
this fixes runtime errors on FreeBSD where sockaddr_in does not match
the one that lhnet used to use
changed lhnetaddress_t struct to have a native port value rather than
having to poke at the sockaddr variants all the time to access port
values (now only a few places set/get the actual encoded port value)

------------------------------------------------------------------------
r8459 | havoc | 2008-08-19 06:11:59 -0700 (Tue, 19 Aug 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

allow disabling scoreboard ranking display left of sbar
allow disabling game time display left of sbar

------------------------------------------------------------------------
r8458 | havoc | 2008-08-19 03:46:00 -0700 (Tue, 19 Aug 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

only apply qw skins to progs/player.mdl

------------------------------------------------------------------------
r8457 | havoc | 2008-08-19 01:37:28 -0700 (Tue, 19 Aug 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

remove two unnecessary externs

------------------------------------------------------------------------
r8456 | havoc | 2008-08-19 01:10:46 -0700 (Tue, 19 Aug 2008) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

fix NaN velocity that always occurred when standing still because
VectorLength was being used in a divide without checking if it was
already 0

------------------------------------------------------------------------
r8455 | havoc | 2008-08-18 10:50:21 -0700 (Mon, 18 Aug 2008) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/portals.c
   M /trunk/darkplaces/portals.h
   M /trunk/darkplaces/r_shadow.c

fix crashes when recursing portals on maps with some bogus leafs (where
infinite recursion loops can occur, alternating between two leafs), such
as cmc.bsp for prozactf coop

------------------------------------------------------------------------
r8454 | havoc | 2008-08-17 22:34:53 -0700 (Sun, 17 Aug 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/prvm_cmds.c

fix three double semicolon typos

------------------------------------------------------------------------
r8453 | havoc | 2008-08-14 21:40:21 -0700 (Thu, 14 Aug 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

register disconnect command even on dedicated server

------------------------------------------------------------------------
r8452 | divverent | 2008-08-13 03:54:03 -0700 (Wed, 13 Aug 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

GAME_NEXUIZ: fix world model not getting initialized when it could not be found (e.g. 404)

------------------------------------------------------------------------
r8451 | divverent | 2008-08-13 02:59:36 -0700 (Wed, 13 Aug 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

also send MSG_ALL to people who are past ClientConnect, but not spawned yet (makes the invariant "he can receive MSG_ALL or he's not past ClientConnect yet" work, which CSQC may rely on).

------------------------------------------------------------------------
r8448 | divverent | 2008-08-13 02:45:58 -0700 (Wed, 13 Aug 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

partially fix ClientConnect handling
(fixes the slot between SpawnServer and ClientConnect (content download, signon) where a client that drops could have ClientDisconnect getting called without ClientConnect ever happening in that progs)

------------------------------------------------------------------------
r8447 | divverent | 2008-08-13 01:29:34 -0700 (Wed, 13 Aug 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

Only send the reliable (broadcast) datagram to SPAWNED clients - should fix client disconnects for CSQC temp entities sent to MSG_ALL. Hope this won't break anything else. Running my servers with this soon.

------------------------------------------------------------------------
r8445 | divverent | 2008-08-11 11:42:22 -0700 (Mon, 11 Aug 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/libcurl.c

damn, THIS fix wasn't need - the demo reading fix already did that

------------------------------------------------------------------------
r8444 | divverent | 2008-08-11 11:23:19 -0700 (Mon, 11 Aug 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/libcurl.c

quick hack to fix missing PK3s when loading demos with curl downloads (works for client side recorded demos ONLY)

------------------------------------------------------------------------
r8443 | divverent | 2008-08-11 11:12:51 -0700 (Mon, 11 Aug 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_demo.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/csprogs.h
   M /trunk/darkplaces/sv_main.c

demo recording: stuff csprogs.dat files into .dem files so demos can always be played back

------------------------------------------------------------------------
r8442 | havoc | 2008-08-10 18:54:26 -0700 (Sun, 10 Aug 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/matrixlib.c
   M /trunk/darkplaces/matrixlib.h

ported some features over from darkwar matrixlib.[ch]

------------------------------------------------------------------------
r8441 | divverent | 2008-08-08 23:38:22 -0700 (Fri, 08 Aug 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

fix double free in qcstatus

------------------------------------------------------------------------
r8440 | divverent | 2008-08-08 10:14:24 -0700 (Fri, 08 Aug 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

drawcolorcodedstring takes the flags in arg 4, not 5

------------------------------------------------------------------------
r8439 | divverent | 2008-08-08 01:13:13 -0700 (Fri, 08 Aug 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/netconn.h
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/svvm_cmds.c

make menu QC aware of player list; add extension DP_SV_QCSTATUS to allow QC to override fields in status responses (e.g. to display teams, or more than one score per player, or team scores)

------------------------------------------------------------------------
r8438 | divverent | 2008-08-06 03:51:45 -0700 (Wed, 06 Aug 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c

Even more snd channel cvars. I know this sucks, but having just one control for all auto-allocate channels DOES suck. Need to separate out world's autoallocate and item auto-allocate channels.

------------------------------------------------------------------------
r8437 | divverent | 2008-08-05 23:32:58 -0700 (Tue, 05 Aug 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c

independent volume control for the 8 entity channels

------------------------------------------------------------------------
r8436 | divverent | 2008-08-04 23:27:03 -0700 (Mon, 04 Aug 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

add TEXF_ALPHA when loading a normalmap

------------------------------------------------------------------------
r8435 | divverent | 2008-08-03 05:34:03 -0700 (Sun, 03 Aug 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

leaktest: also exclude csqc networked entities

------------------------------------------------------------------------
r8434 | divverent | 2008-08-02 03:02:19 -0700 (Sat, 02 Aug 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/keys.c

fix ESC in disconnected state. FINALLY!

------------------------------------------------------------------------
r8433 | divverent | 2008-08-02 02:44:10 -0700 (Sat, 02 Aug 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/keys.c

reintroduce the KEY_ESCAPE switch, but this time make sure it actually behaves right

------------------------------------------------------------------------
r8432 | divverent | 2008-08-01 02:32:08 -0700 (Fri, 01 Aug 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

special entity culling rules for players: 0.2 delay, 8 traces. Probably can be upped even more.

------------------------------------------------------------------------
r8431 | divverent | 2008-07-30 07:13:12 -0700 (Wed, 30 Jul 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

remove TEXF_ALPHA flag for any map textures, because Q3 mappers seem to suck and use textures with actual alpha channel as nontransparent ones without even writing a shader that says so

------------------------------------------------------------------------
r8430 | divverent | 2008-07-29 02:48:43 -0700 (Tue, 29 Jul 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c

fix font parsing so adding more properties in the future will make them ignored, not do stupid things

------------------------------------------------------------------------
r8429 | divverent | 2008-07-29 02:42:13 -0700 (Tue, 29 Jul 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/draw.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/sbar.c

add a new "scale" property in font files. Specifying, e.g., "scale 1.2" in a font means that it gets rendered at 1.2 the usual size (by using 10% more space to the top and to the bottom). This may cause overlap between characters of adjacent lines, so use this with care (e.g. to support a font with large over- or underlengths).

------------------------------------------------------------------------
r8428 | divverent | 2008-07-28 23:08:43 -0700 (Mon, 28 Jul 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/clvm_cmds.c

cl_readpicture_force: force the low quality jpeg image to be used even if the image exists on the file system (for testing)

------------------------------------------------------------------------
r8427 | divverent | 2008-07-24 00:01:54 -0700 (Thu, 24 Jul 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/cmd.c

fix ${* q}

------------------------------------------------------------------------
r8426 | havoc | 2008-07-23 18:37:38 -0700 (Wed, 23 Jul 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/csprogs.c

don't warn about CSQC_Ent_Remove on an already-removed entity (it could
be a repeated update)

------------------------------------------------------------------------
r8425 | havoc | 2008-07-23 18:27:30 -0700 (Wed, 23 Jul 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/sv_main.c

fixed rate limiting of csqc entities (they were overflowing easily)

------------------------------------------------------------------------
r8424 | divverent | 2008-07-23 04:25:52 -0700 (Wed, 23 Jul 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/wad.c
   M /trunk/darkplaces/zone.c

optimize many loops over expandable arrays by not repeatedly calling Mem_ExpandableArray_IndexRange (patch by Blub)

------------------------------------------------------------------------
r8423 | divverent | 2008-07-23 02:39:37 -0700 (Wed, 23 Jul 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/render.h

turn rev8420 "enable transparency on tga skins on mdl/md2/md3 when shader is not found" into what it actually WANTED to be (only enable the transparency if the TGA actually is transparent)

------------------------------------------------------------------------
r8422 | divverent | 2008-07-23 00:08:59 -0700 (Wed, 23 Jul 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/zone.c
   M /trunk/darkplaces/zone.h

add apparently not yet working optimization flags to Mem_ExpandableArray function (can't see what difference it causes in asm output)

------------------------------------------------------------------------
r8421 | havoc | 2008-07-22 20:53:37 -0700 (Tue, 22 Jul 2008) | 4 lines
Changed paths:
   M /trunk/darkplaces/keys.c

fix for Blub\0's strange change to toggleconsole handling which broke
the con_closeontoggleconsole feature (which is what allows you to close
the console with the same key that opens it, rather than using escape)

------------------------------------------------------------------------
r8420 | havoc | 2008-07-22 15:54:15 -0700 (Tue, 22 Jul 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

enable transparency on tga skins on mdl/md2/md3 when shader is not found

------------------------------------------------------------------------
r8419 | divverent | 2008-07-21 09:28:07 -0700 (Mon, 21 Jul 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/jpeg.c

sorry, did the last change to the wrong jpeg writing function. Fixed.

------------------------------------------------------------------------
r8418 | divverent | 2008-07-21 09:07:47 -0700 (Mon, 21 Jul 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/jpeg.c

fix jpeg upside down

------------------------------------------------------------------------
r8417 | divverent | 2008-07-19 12:31:03 -0700 (Sat, 19 Jul 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/prvm_exec.c

add feature "prvm_errordump" to make a savegame on PRVM_Crash - hopefully this helps me find the teambubble.owner==NULL crash bug

------------------------------------------------------------------------
r8416 | havoc | 2008-07-19 05:03:15 -0700 (Sat, 19 Jul 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/makefile

use -MMD instead of -MD for making dependencies, this skips system
headers

------------------------------------------------------------------------
r8415 | divverent | 2008-07-18 01:00:21 -0700 (Fri, 18 Jul 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/jpeg.c

fix "vid_restart forgets to reload jpeg" bug

------------------------------------------------------------------------
r8414 | divverent | 2008-07-16 02:24:37 -0700 (Wed, 16 Jul 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/keys.c

fix console escape togglemenu

------------------------------------------------------------------------
r8413 | divverent | 2008-07-15 08:23:26 -0700 (Tue, 15 Jul 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/keys.h

Blub's keyboard handling fixes (makes UP events go to the same handler as the corresponding DOWN event, and fix up the ASCII code in UP events for SDL)

------------------------------------------------------------------------
r8412 | divverent | 2008-07-15 08:22:51 -0700 (Tue, 15 Jul 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c

enable XkbSetDetectableAutoRepeat (TODO check if weird systems like Solaris support this, if not, ifdef it out for these)

------------------------------------------------------------------------
r8411 | divverent | 2008-07-15 06:38:19 -0700 (Tue, 15 Jul 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/csprogs.c

compile fix

------------------------------------------------------------------------
r8410 | divverent | 2008-07-15 04:33:05 -0700 (Tue, 15 Jul 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/csprogs.c

move the -1 setting of csqc_* to a better place (argh...)

------------------------------------------------------------------------
r8409 | divverent | 2008-07-15 03:48:51 -0700 (Tue, 15 Jul 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

and move the declaration for CL_VM_Shutdown up

------------------------------------------------------------------------
r8408 | divverent | 2008-07-15 03:47:48 -0700 (Tue, 15 Jul 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

call CSQC_Shutdown between levels too!

------------------------------------------------------------------------
r8407 | divverent | 2008-07-15 02:15:22 -0700 (Tue, 15 Jul 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

fix wrong cvar name 

------------------------------------------------------------------------
r8406 | divverent | 2008-07-15 02:11:08 -0700 (Tue, 15 Jul 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

add missing var

------------------------------------------------------------------------
r8404 | divverent | 2008-07-15 01:19:43 -0700 (Tue, 15 Jul 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c

small optimization to the leak check, to mark the entities faster

------------------------------------------------------------------------
r8403 | divverent | 2008-07-15 00:55:04 -0700 (Tue, 15 Jul 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/prvm_exec.c

prvm_leaktest - leak detector for QC objects (all but Gecko instances at the moment)
For entities, it uses a marking approach

------------------------------------------------------------------------
r8402 | divverent | 2008-07-14 06:17:47 -0700 (Mon, 14 Jul 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/netconn.c

fix out of range indices found by [-z-]

------------------------------------------------------------------------
r8401 | divverent | 2008-07-14 03:48:13 -0700 (Mon, 14 Jul 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

fix return value of FS_WhichPack to NOT include the -basedir

------------------------------------------------------------------------
r8400 | divverent | 2008-07-13 09:37:14 -0700 (Sun, 13 Jul 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

preserve host_client during rcon (should fix crash for rcon restart)

------------------------------------------------------------------------
r8399 | divverent | 2008-07-12 07:46:43 -0700 (Sat, 12 Jul 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/jpeg.c

load the JPEG dll when needed

------------------------------------------------------------------------
r8398 | divverent | 2008-07-11 04:58:11 -0700 (Fri, 11 Jul 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/jpeg.c

seems like it is better to use smaller sizes there

------------------------------------------------------------------------
r8396 | divverent | 2008-07-11 03:14:59 -0700 (Fri, 11 Jul 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/jpeg.c
   M /trunk/darkplaces/jpeg.h
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.h
   M /trunk/darkplaces/svvm_cmds.c

adding two new extensions: DP_QC_WHICHPACK (identify a pk3 containing a file), and DP_QC_WRITEIMAGE (writes a small low quality JPEG image from svqc to csqc)

------------------------------------------------------------------------
r8395 | havoc | 2008-07-10 12:33:59 -0700 (Thu, 10 Jul 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

tracked down another size check div0 left in

------------------------------------------------------------------------
r8394 | havoc | 2008-07-10 01:05:45 -0700 (Thu, 10 Jul 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

remove debugging code that was breaking skeletal model formats other
than psk, and was not meant to be committed

------------------------------------------------------------------------
r8393 | divverent | 2008-07-10 00:10:34 -0700 (Thu, 10 Jul 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

needed builtins for fonts in CSQC

------------------------------------------------------------------------
r8392 | divverent | 2008-07-09 12:27:26 -0700 (Wed, 09 Jul 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/sys_linux.c

Cvar sys_usenoclockbutbenchmark for the dedicated server. Replaces the regular clock by a simulated one, for server code benchmarking with bots.

------------------------------------------------------------------------
r8391 | divverent | 2008-07-08 10:41:08 -0700 (Tue, 08 Jul 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/model_alias.c

changed the Sys_Error to a Con_Printf. LordHavoc, please check if the equation REALLY is right - this errors out for e.g. lurk.zym in Nexuiz

------------------------------------------------------------------------
r8390 | divverent | 2008-07-08 09:15:27 -0700 (Tue, 08 Jul 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

make the weird != error message nonfatal and developer-only if it just hints to superfluous data in the model; only abort if it hints to an overrun. Haven't checked the actual equation though. Please report if the problem is fixed.

------------------------------------------------------------------------
r8387 | havoc | 2008-07-07 02:21:46 -0700 (Mon, 07 Jul 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.h
   M /trunk/darkplaces/svvm_cmds.c

patch from KrimZon adding DP_QC_ENTITYDATA extension

------------------------------------------------------------------------
r8386 | havoc | 2008-07-05 00:31:46 -0700 (Sat, 05 Jul 2008) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h

an attempt at optimizing msurface_t dlight_cache checks by moving them
to a separate array
added support for a Q3BSP format variant

------------------------------------------------------------------------
r8385 | havoc | 2008-07-05 00:29:11 -0700 (Sat, 05 Jul 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

changed default of r_depthfirst to 0, because in general it's a
performance loss rather than a gain

------------------------------------------------------------------------
r8382 | havoc | 2008-06-29 14:27:56 -0700 (Sun, 29 Jun 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

fix an error and a warning with my last commit

------------------------------------------------------------------------
r8381 | havoc | 2008-06-29 14:12:29 -0700 (Sun, 29 Jun 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

split out combined alloc for psk model data to make it easier to verify
that the combined alloc size is correct

------------------------------------------------------------------------
r8380 | havoc | 2008-06-29 13:22:10 -0700 (Sun, 29 Jun 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

declare local variables properly

------------------------------------------------------------------------
r8379 | divverent | 2008-06-28 08:47:26 -0700 (Sat, 28 Jun 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/keys.c

fix crash in keys.c clipboard handling

------------------------------------------------------------------------
r8378 | havoc | 2008-06-25 19:41:07 -0700 (Wed, 25 Jun 2008) | 5 lines
Changed paths:
   M /trunk/darkplaces/host.c

sync console command execution to the server timer or the client timer
depending on whether the server is running (previously when playing
online it would execute them on every main loop, which could mess up the
timing of multiple impulses in sequence)

------------------------------------------------------------------------
r8377 | havoc | 2008-06-25 19:38:33 -0700 (Wed, 25 Jun 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

always send a packet when an impulse is used, regardless of the
cl_netimmediatebuttons cvar

------------------------------------------------------------------------
r8376 | havoc | 2008-06-25 19:35:36 -0700 (Wed, 25 Jun 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c

fix two warnings

------------------------------------------------------------------------
r8374 | divverent | 2008-06-25 11:03:21 -0700 (Wed, 25 Jun 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

Add a new command "infobar" to temporarily display something in the infobar.
Useful for stuff like subtitles.

------------------------------------------------------------------------
r8373 | divverent | 2008-06-25 10:39:15 -0700 (Wed, 25 Jun 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/view.c

in "bf", make alpha and alphafade optional (if left out, they will default to the usual "bf" values)

------------------------------------------------------------------------
r8372 | divverent | 2008-06-25 10:35:38 -0700 (Wed, 25 Jun 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/view.c

"bf" now optionally takes arguments: red green blue alpha alphafade

------------------------------------------------------------------------
r8371 | havoc | 2008-06-23 05:48:56 -0700 (Mon, 23 Jun 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/common.c

patch from Blub\0 to fix InfoString_SetValue (my dpsnprintf size was
wrong)

------------------------------------------------------------------------
r8370 | havoc | 2008-06-19 02:34:37 -0700 (Thu, 19 Jun 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces-dedicated.vcproj
   M /trunk/darkplaces/darkplaces-sdl.vcproj
   M /trunk/darkplaces/darkplaces.sln
   M /trunk/darkplaces/darkplaces.vcproj

thanks to Willis for contributing a VS2005 x64 build target

------------------------------------------------------------------------
r8369 | divverent | 2008-06-19 01:02:30 -0700 (Thu, 19 Jun 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

Support file symlinks inside pk3 files. Directory symlinks, as well as symlinks with ../ not at their start, are not supported.

------------------------------------------------------------------------
r8368 | havoc | 2008-06-17 04:13:11 -0700 (Tue, 17 Jun 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

use %127s in the sscanf

------------------------------------------------------------------------
r8367 | havoc | 2008-06-17 04:09:52 -0700 (Tue, 17 Jun 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

fix crash in rtlights loader when compiled with VS2005 (I forgot that
does use a %s in an sscanf)

------------------------------------------------------------------------
r8366 | havoc | 2008-06-17 04:07:40 -0700 (Tue, 17 Jun 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces-dedicated.vcproj
   M /trunk/darkplaces/darkplaces-sdl.vcproj
   M /trunk/darkplaces/darkplaces.vcproj

changed build targets to all be in the darkplaces directory

------------------------------------------------------------------------
r8365 | havoc | 2008-06-17 03:46:24 -0700 (Tue, 17 Jun 2008) | 6 lines
Changed paths:
   M /trunk/darkplaces/cl_demo.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/cvar.c
   A /trunk/darkplaces/darkplaces-dedicated.vcproj
   A /trunk/darkplaces/darkplaces-sdl.vcproj
   A /trunk/darkplaces/darkplaces.sln
   A /trunk/darkplaces/darkplaces.vcproj
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/lhnet.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_sprite.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/sbar.c
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/sys_linux.c
   M /trunk/darkplaces/sys_sdl.c
   M /trunk/darkplaces/sys_shared.c
   M /trunk/darkplaces/todo

fixed all VS2005 deprecated function warnings
found one actual buffer overrun problem in GetMapList (map name
completion was using sprintf with a 64 character buffer, which is EASILY
overflowed)
added VS2005 projects

------------------------------------------------------------------------
r8364 | havoc | 2008-06-17 03:17:29 -0700 (Tue, 17 Jun 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_gecko.c

changed a number of sprintf's to dpsnprintf and removed the TODO
comments for doing this

------------------------------------------------------------------------
r8363 | havoc | 2008-06-17 03:17:04 -0700 (Tue, 17 Jun 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

hush a warning in Dev-C++

------------------------------------------------------------------------
r8362 | havoc | 2008-06-17 03:14:19 -0700 (Tue, 17 Jun 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces-dedicated.dev

fixed the .dev file for dedicated server

------------------------------------------------------------------------
r8361 | havoc | 2008-06-17 02:12:44 -0700 (Tue, 17 Jun 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/darkplaces-dedicated.dsp
   M /trunk/darkplaces/darkplaces-sdl.dsp
   M /trunk/darkplaces/darkplaces.dsp

added gl_gecko.[ch] and gl_dyntexture.[ch] dependencies
also added some lib files and removed the base ones

------------------------------------------------------------------------
r8355 | divverent | 2008-06-15 07:52:22 -0700 (Sun, 15 Jun 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/sys_linux.c
   M /trunk/darkplaces/sys_sdl.c
   M /trunk/darkplaces/sys_win.c

also reject time stepping > 30 minutes (this threshold is < 1 hour to reject daylight saving time changes, but > any "typical" load time of a map)

------------------------------------------------------------------------
r8354 | divverent | 2008-06-15 07:31:11 -0700 (Sun, 15 Jun 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.inc
   M /trunk/darkplaces/sys_linux.c

new cvar sys_useclockgettime (default 0) that makes DP use clock_gettime as time source (should fix bad timing on Solaris, and some Xen oddity). Only supported in the Solaris, Linux and BSD target.

------------------------------------------------------------------------
r8353 | divverent | 2008-06-11 04:20:33 -0700 (Wed, 11 Jun 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/builddate.c
   M /trunk/darkplaces/makefile.inc

also put svn revision (svnversion(1)) and build type into the version string

------------------------------------------------------------------------
r8352 | sajt | 2008-06-10 19:15:05 -0700 (Tue, 10 Jun 2008) | 1 line
Changed paths:
   M /trunk/darkplaces/fs.c

Fixed compile error in MSVC6 (its SDK is missing a key #define)
------------------------------------------------------------------------
r8347 | havoc | 2008-06-09 00:49:13 -0700 (Mon, 09 Jun 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/cd_shared.c

check if command is "remap" AFTER command is set to something!

------------------------------------------------------------------------
r8345 | havoc | 2008-06-09 00:08:20 -0700 (Mon, 09 Jun 2008) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

particle palette is now derived from the loaded palette (this fixes bugs
with .glow_trail colors not matching .glow_color colors when the palette
is replaced)

------------------------------------------------------------------------
r8332 | divverent | 2008-06-07 06:37:50 -0700 (Sat, 07 Jun 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/cd_shared.c

do NOT Host_StartVideo for a simple "cd remap"

------------------------------------------------------------------------
r8329 | motorsep | 2008-06-05 01:02:15 -0700 (Thu, 05 Jun 2008) | 1 line
Changed paths:
   M /trunk/darkplaces/view.c

changed bbox size for chase camera
------------------------------------------------------------------------
r8328 | havoc | 2008-06-05 00:41:03 -0700 (Thu, 05 Jun 2008) | 4 lines
Changed paths:
   M /trunk/darkplaces/view.c

add view_ofs before chase_active code, this should fix a bug in prophecy
where the camera trace starts at the player's feet and glitches on
stairs

------------------------------------------------------------------------
r8327 | motorsep | 2008-06-05 00:35:13 -0700 (Thu, 05 Jun 2008) | 1 line
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/view.c

added support for Prophecy game and new cvar for chase cam
------------------------------------------------------------------------
r8324 | divverent | 2008-06-01 06:25:12 -0700 (Sun, 01 Jun 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/svvm_cmds.c

make DP_SV_SPAWNFUNC_PREFIX an detectable extension

------------------------------------------------------------------------
r8321 | divverent | 2008-06-01 06:14:54 -0700 (Sun, 01 Jun 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/screen.h

some const fixes and type fixes found by gcc -combine

------------------------------------------------------------------------
r8320 | divverent | 2008-06-01 06:14:09 -0700 (Sun, 01 Jun 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

tiny DP extension: when a global named "require_spawnfunc_prefix" exists, ONLY spawn using functions whose name starts with spawnfunc_. Helps keeping QC code clean, but should not break anything (Google found no existing code with a variable require_spawnfunc_prefix)

------------------------------------------------------------------------
r8316 | divverent | 2008-05-28 01:49:25 -0700 (Wed, 28 May 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c

fix typo in r_textcontrast description

------------------------------------------------------------------------
r8315 | divverent | 2008-05-24 10:49:59 -0700 (Sat, 24 May 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix fog for scaled models (affects Nexuiz flags)

------------------------------------------------------------------------
r8311 | havoc | 2008-05-22 17:10:16 -0700 (Thu, 22 May 2008) | 1 line
Changed paths:
   M /trunk/darkplaces/todo


------------------------------------------------------------------------
r8310 | havoc | 2008-05-22 16:14:23 -0700 (Thu, 22 May 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/todo

simplified failed cubemap handling

------------------------------------------------------------------------
r8309 | havoc | 2008-05-22 16:10:55 -0700 (Thu, 22 May 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

don't try to free r_texture_whitecube just because it's stored in one of
the cubemap references

------------------------------------------------------------------------
r8301 | havoc | 2008-05-18 02:28:11 -0700 (Sun, 18 May 2008) | 4 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/svvm_cmds.c

don't try to send a svc_pointparticles or svc_trailparticles message if
the effectnum is negative (such as the -1 returned by particleeffectnum
when it fails to find a match)

------------------------------------------------------------------------
r8300 | havoc | 2008-05-17 19:12:14 -0700 (Sat, 17 May 2008) | 4 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c

fix problem with glx mouse not grabbing in nexuiz menu
fix glx mouse warp problem, now produces an extra xmotion event sent to
itself to indicate the warp happened before any real motions come in

------------------------------------------------------------------------
r8299 | havoc | 2008-05-17 19:11:14 -0700 (Sat, 17 May 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/vid_agl.c

audit of fullscreengrab in VID_SetMouse, getting rid of unnecessary
cases

------------------------------------------------------------------------
r8298 | havoc | 2008-05-17 18:36:14 -0700 (Sat, 17 May 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

fix return value of VM_strftime builtin, it was returning a string
offset as a float, it must return it as an int for QC to work

------------------------------------------------------------------------
r8296 | havoc | 2008-05-10 05:47:28 -0700 (Sat, 10 May 2008) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_agl.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_null.c
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_wgl.c

renamed VID_GrabMouse to VID_SetMouse as it now takes 3 parameters
(fullscreengrab, relative, hidecursor), this required reworking all the
implementations and the calls, but gives the correct behavior in all
cases

------------------------------------------------------------------------
r8295 | havoc | 2008-05-10 00:50:09 -0700 (Sat, 10 May 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c

fixed bug where vid_dgamouse cvar broke support for absolute mouse
positioning

------------------------------------------------------------------------
r8294 | havoc | 2008-05-10 00:22:15 -0700 (Sat, 10 May 2008) | 4 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c

warp mouse pointer every time it moves off-center instead of just when
it's halfway away from center, this hides the glitching that has been
reported, but the cause is still not understood

------------------------------------------------------------------------
r8293 | havoc | 2008-05-08 10:59:11 -0700 (Thu, 08 May 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/mvm_cmds.c

fixed drifting mouse pointer problems in menu

------------------------------------------------------------------------
r8292 | havoc | 2008-05-08 10:58:03 -0700 (Thu, 08 May 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

don't ungrab mouse in loading screens in fullscreen

------------------------------------------------------------------------
r8291 | havoc | 2008-05-08 10:29:51 -0700 (Thu, 08 May 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/host.c

fix nexuiz menu mouse input by resetting in_mouse_x/y variables in a
better place

------------------------------------------------------------------------
r8290 | havoc | 2008-05-08 10:22:08 -0700 (Thu, 08 May 2008) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.c

split VM_getmousepos into client and menu versions because they need to
check different variables to decide whether to return window coordinates
or delta mouse motions

------------------------------------------------------------------------
r8289 | havoc | 2008-05-08 10:05:39 -0700 (Thu, 08 May 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_agl.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_wgl.c

fixed several bugs with mouse grabbing

------------------------------------------------------------------------
r8288 | havoc | 2008-05-08 09:34:05 -0700 (Thu, 08 May 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c

ignore all potentially disruptive events when in fullscreen

------------------------------------------------------------------------
r8287 | havoc | 2008-05-08 09:20:25 -0700 (Thu, 08 May 2008) | 4 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/vid_shared.c

default in_client_mouse to true again to fix Nexuiz menu
added a comment in getmousepos about the fact it doesn't know how to
handle in_client_mouse

------------------------------------------------------------------------
r8286 | havoc | 2008-05-08 09:00:33 -0700 (Thu, 08 May 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

menu.dat needs to use mouse grab by default

------------------------------------------------------------------------
r8285 | havoc | 2008-05-08 02:10:10 -0700 (Thu, 08 May 2008) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/input.h
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/todo
   M /trunk/darkplaces/vid_agl.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c

implemented support for turning off mousegrab in csqc (feature existed
but was buggy in Windows build and not implemented in others)
cleaned up menu mousegrab handling, among other mousegrab state issues

------------------------------------------------------------------------
r8284 | havoc | 2008-05-07 17:05:43 -0700 (Wed, 07 May 2008) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_agl.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_null.c
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_wgl.c

renamed IN_Activate to VID_GrabMouse and made it a public function in
the VID API, this removed some shared logic from each VID_Finish
implementation, and allows disabling the mouse grab at the beginning of
a loading screen

------------------------------------------------------------------------
r8283 | havoc | 2008-05-07 16:48:11 -0700 (Wed, 07 May 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

added some checks for the possibility of a map having no portals

------------------------------------------------------------------------
r8282 | havoc | 2008-05-07 16:45:21 -0700 (Wed, 07 May 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/vid_agl.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_wgl.c

centralized GL_VENDOR/GL_RENDERER/etc printing code

------------------------------------------------------------------------
r8281 | havoc | 2008-05-07 16:38:15 -0700 (Wed, 07 May 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

bugfix for svc_particle colors
changed stainmap colors

------------------------------------------------------------------------
r8280 | havoc | 2008-05-07 00:25:00 -0700 (Wed, 07 May 2008) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

changed default gl_vbo from 1 to 3 to try to avoid stalls on certain ATI
cards, does not seem to have any significant effect on NVIDIA
performance either way (1 is faster on Radeon HD though, if it works)

------------------------------------------------------------------------
r8277 | havoc | 2008-05-04 15:55:54 -0700 (Sun, 04 May 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

fix bug with rtlights on vertex texture blend surfaces (such as in
pom.bsp) that was causing them to white out

------------------------------------------------------------------------
r8276 | divverent | 2008-05-04 08:32:45 -0700 (Sun, 04 May 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/cmd.c

fixes to "defer": Crash on Windows (non-ANSI C printf string), and order of execution of defers at the same time

------------------------------------------------------------------------
r8275 | havoc | 2008-05-04 01:13:42 -0700 (Sun, 04 May 2008) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

removed gl_workaround_mac_texmatrix cvar because it seems the entire
problem was solved by moving glActiveTexture calls above glMatrixMode
calls - this may still be an Apple bug, but not an important one

------------------------------------------------------------------------
r8274 | havoc | 2008-05-03 23:43:20 -0700 (Sat, 03 May 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

another attempt at identifying mac texmatrix bug

------------------------------------------------------------------------
r8273 | havoc | 2008-05-03 23:04:20 -0700 (Sat, 03 May 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

changed gl_workaround_mac_texmatrix to additionally call
GL_ActiveTexture everywhere it calls GL_ClientActiveTexture

------------------------------------------------------------------------
r8272 | havoc | 2008-05-03 22:32:28 -0700 (Sat, 03 May 2008) | 6 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h

changed behavior of gl_workaround_mac_texmatrix, reverting to previous
behavior (returning the texmatrix bugs), now the cvar causes a more
general change in behavior where all GL_ActiveTexture calls will also
call GL_ClientActiveTexture, this should make the bug easily toggleable
for debugging purposes

------------------------------------------------------------------------
r8271 | havoc | 2008-05-03 04:05:32 -0700 (Sat, 03 May 2008) | 6 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h

further attempt at workaround for Mac texmatrix bug,
gl_workaround_mac_texmatrix now has values in the range 0 to 7 with
different behaviors to try
eliminated GL_ClientActiveTexture function, now client active texture
always matches server active texture (in hopes of fixing Mac bug)

------------------------------------------------------------------------
r8270 | divverent | 2008-05-02 04:09:57 -0700 (Fri, 02 May 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

sanitize nicknames that start with a 0x01 or 0x02 (chat beep) by adding an extra ^7 at the beginning

------------------------------------------------------------------------
r8269 | divverent | 2008-05-01 00:47:10 -0700 (Thu, 01 May 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

re-add the multiplication by waterlevel for cls.protocol == PROTOCOL_QUAKEWORLD

------------------------------------------------------------------------
r8268 | divverent | 2008-04-30 13:53:49 -0700 (Wed, 30 Apr 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

remove weird multiplication of water friction by 1 (wet feet), 2 (swimming), 3 (submerged), as sv_user.c (which Quake uses) does not do that and it DOES break prediction

------------------------------------------------------------------------
r8267 | divverent | 2008-04-26 02:49:21 -0700 (Sat, 26 Apr 2008) | 29 lines
Changed paths:
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/filematch.c
   M /trunk/darkplaces/netconn.c

Extend rcon_restricted_commands to contain more complex patterns:

- Wildcards are supported. A * matches EXACTLY one arg. ? never matches
  whitespace. * wildcards match AT LEAST one character.
- Multi-word patterns are supported - they then match EXACTLY the command.
- Single-word non-wildcard patterns still match if the first word of the command matches.

Currently, there is no way to enforce that a command is used ONLY without any args.
Also, wildcard expressions currently NEVER match a command with quotes, as quotes
could subvert the argument restrictions.

Examples:

  foo * bar * *
  - matches: foo XXX bar XXX XXX
  - does not match: foo bar XXX XXX, foo XXX bar XXX XXX XXX, foo XXX bar XXX

  foo
  - matches: foo, foo XXX, foo XXX XXX
  - does not match: foobar

  foo bar
  - matches: foo bar
  - does not match: foo bar baz

  foo*bar
  - matches: foo42bar, foo1bar
  - does not match: foobar, foo bar

------------------------------------------------------------------------
r8265 | havoc | 2008-04-22 21:19:35 -0700 (Tue, 22 Apr 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

added gl_vbo 3 mode (which does not use EBO when firsttriangle is
non-zero), just for performance testing

------------------------------------------------------------------------
r8264 | divverent | 2008-04-22 04:07:19 -0700 (Tue, 22 Apr 2008) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

download system:
- Nexuiz: only download csprogs using it for now; always put downloads in dlcache/
- other games: make CSQC always go into dlcache/

------------------------------------------------------------------------
r8263 | divverent | 2008-04-22 03:43:19 -0700 (Tue, 22 Apr 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_sprites.c

fix label sprites if r_waterstate.renderingscene

------------------------------------------------------------------------
r8262 | divverent | 2008-04-22 01:25:29 -0700 (Tue, 22 Apr 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

oops, exteriormodeltoclient is NOT a kind of attachment

------------------------------------------------------------------------
r8261 | divverent | 2008-04-22 01:24:19 -0700 (Tue, 22 Apr 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix CSQC crash bug with r_showbboxes; try to hide bogus boxes near 0,0,0 for attached entities (but there are still some, like, on basement... odd)

------------------------------------------------------------------------
r8260 | divverent | 2008-04-21 12:16:59 -0700 (Mon, 21 Apr 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/cl_collision.h
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/collision.c
   M /trunk/darkplaces/collision.h
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/model_sprite.c
   M /trunk/darkplaces/portals.c
   M /trunk/darkplaces/portals.h
   M /trunk/darkplaces/r_lerpanim.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_sprites.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/svvm_cmds.c

globally rename model_t to dp_model_t for OpenSolaris. Sorry, guys who now have svn conflicts, but otherwise it just won't compile on OpenSolaris...

------------------------------------------------------------------------
r8259 | divverent | 2008-04-21 04:46:49 -0700 (Mon, 21 Apr 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_bsd.c
   M /trunk/darkplaces/vid_glx.c

this should fix some Solaris/NetBSD/OpenBSD compile problems, model_t still remaining

------------------------------------------------------------------------
r8258 | havoc | 2008-04-18 03:11:43 -0700 (Fri, 18 Apr 2008) | 8 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c

changed cl_stainmaps to be a loadtime cvar which decides whether to
allocate stainmaps at all, this saves some memory if it's 0 (which is
the default)
changed stainmap allocation to lump all allocations into one big one,
this saves 1.5MB of memory system overhead (tracking about 28000
allocations for stainmaps in cavetest2.bsp has a lot of overhead) and
probably a good deal more malloc overhead on top of that

------------------------------------------------------------------------
r8257 | havoc | 2008-04-18 02:55:37 -0700 (Fri, 18 Apr 2008) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

changed meaning of r_useportalculling 1 to only use it with r_novis 1
cases (it would be good to use it when no vis data is loaded also, but
that's not currently handled)

------------------------------------------------------------------------
r8256 | divverent | 2008-04-16 00:17:02 -0700 (Wed, 16 Apr 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

load SHGetFolderPath from shfolder.dll dynamically to remove the dependency (should make DP work on Win95 again)

------------------------------------------------------------------------
r8255 | divverent | 2008-04-13 07:17:10 -0700 (Sun, 13 Apr 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/sv_user.c

fix "wrong ping times" issue once and for all (I don't see another fix that wouldn't at the same time re-enable a speedhack)

------------------------------------------------------------------------
r8254 | havoc | 2008-04-12 02:22:04 -0700 (Sat, 12 Apr 2008) | 6 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

added gl_workaround_mac_texmatrix cvar to allow some testing to be done
on the osx GLSL texmatrix bug
modified R_Mesh_Draw to make gl_mesh_prefer_short_elements 0 apply to
element buffers as well as arrays, if both forms of element buffer are
provided (this is only a behavior improvement, no effect currently)

------------------------------------------------------------------------
r8253 | havoc | 2008-04-11 12:30:19 -0700 (Fri, 11 Apr 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/menu.c

added 1360x768 resolution (used by some TVs), slightly narrower than
1366x768 resolution which was already supported

------------------------------------------------------------------------
r8252 | havoc | 2008-04-10 00:03:36 -0700 (Thu, 10 Apr 2008) | 7 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/draw.h
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_lightning.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/render.h

implemented uint16 element array support, and use of it for all the
engine-generated geometry (particles, skybox, text, etc), as well as for
any map or model that fits the 65536 vertex limit (this can be disabled
for performance testing using the cvar gl_mesh_prefer_short_elements),
this hopefully improves performance on Radeon 9500-X300 cards and
GeForce1/2 cards which don't support uint32 elements 

------------------------------------------------------------------------
r8251 | havoc | 2008-04-09 21:26:21 -0700 (Wed, 09 Apr 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h

removed unused R_Mesh_Draw_ShowTris

------------------------------------------------------------------------
r8250 | havoc | 2008-04-09 20:48:29 -0700 (Wed, 09 Apr 2008) | 4 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

patch from esteel which moves icons to the right of numbers on the
nexuiz alternate hud to give a better impression of what the numbers
refer to

------------------------------------------------------------------------
r8249 | havoc | 2008-04-09 10:13:24 -0700 (Wed, 09 Apr 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

reload effectinfo.txt on each level

------------------------------------------------------------------------
r8248 | havoc | 2008-04-09 10:13:06 -0700 (Wed, 09 Apr 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

removed silly red dot on blood effects again

------------------------------------------------------------------------
r8247 | havoc | 2008-04-08 09:22:03 -0700 (Tue, 08 Apr 2008) | 4 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fix loading of q1bsp submodel bounding boxes, especially empty submodels
this fixes the disappearing doors bug in slave.bsp caused by empty
submodels having a bounding box as large as the entire map

------------------------------------------------------------------------
r8246 | havoc | 2008-04-07 23:18:33 -0700 (Mon, 07 Apr 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

patch from esteel which swaps the address and player number in the
naming of sv_autodemo_perclient demos, so that player number comes first

------------------------------------------------------------------------
r8245 | havoc | 2008-04-07 12:16:13 -0700 (Mon, 07 Apr 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/console.c

added con_completion_playdemo/timedemo/exec cvars, this enables
completion of playdemo, timedemo, and exec commands

------------------------------------------------------------------------
r8243 | havoc | 2008-04-06 10:48:33 -0700 (Sun, 06 Apr 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

fix div0's GL_BuildOrtho which break compilation on Windows
(near and far are keywords, not variable names)

------------------------------------------------------------------------
r8242 | divverent | 2008-04-03 15:00:13 -0700 (Thu, 03 Apr 2008) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

eliminate two calls to qglGetDoublev that possibly slow down rendering by doing a round trip to the GPU to request the matrices. However, on the tested system, this change does absolutely nothing (233fps vs 233fps), and Xnest, forcing indirect rendering and a ssh -Y localhost did not change that. On an actual network connection however, this new way is SURE faster, as it avoids a round trip over the network.

Infinite far clip already used this method, as there is no GL helper for using the infinite far clip matrix.

------------------------------------------------------------------------
r8241 | havoc | 2008-04-01 06:26:41 -0700 (Tue, 01 Apr 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h

renamed Q3FACETYPE_POLYGON to Q3FACETYPE_FLAT

------------------------------------------------------------------------
r8240 | havoc | 2008-04-01 06:09:21 -0700 (Tue, 01 Apr 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/makefile.inc
   M /trunk/darkplaces/sys_win.c

disabled QHOST by default (can be enabled with an edit to sys_win.c and
the re-addition of conproc.c), I don't think anyone ever uses it

------------------------------------------------------------------------
r8239 | havoc | 2008-04-01 04:41:33 -0700 (Tue, 01 Apr 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/sys_win.c

fixed Sys_Error popups in -dedicated console setup code so that they
actually do appear (by forcing cls.state to ca_disconnected)

------------------------------------------------------------------------
r8238 | havoc | 2008-04-01 02:06:47 -0700 (Tue, 01 Apr 2008) | 5 lines
Changed paths:
   M /trunk/darkplaces/sys_win.c

comment out a line to make the darkplaces.exe -dedicated console show
up, apparently the initial houtput is never 0 or invalid on Windows XP,
which causes it to never open a console - but then error out because the
hinput is invalid

------------------------------------------------------------------------
r8237 | havoc | 2008-04-01 02:01:43 -0700 (Tue, 01 Apr 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_win.c

clean up a couple warnings

------------------------------------------------------------------------
r8236 | havoc | 2008-03-30 03:17:16 -0700 (Sun, 30 Mar 2008) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

patch from Blub\0 which adds back the wrapping behavior on pitch when
in_pitch_min/max are set to very large values (this basically lets you
aim up or down so much that you wrap to the other direction)

------------------------------------------------------------------------
r8235 | havoc | 2008-03-29 17:46:57 -0700 (Sat, 29 Mar 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/csprogs.h

swap VF_SIZE_X and VF_SIZE_Y definitions to what they should be (this
has no effect on behavior, they were simply misnamed internally)

------------------------------------------------------------------------
r8234 | havoc | 2008-03-24 19:32:43 -0700 (Mon, 24 Mar 2008) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/gl_rmain.c

implemented r_refdef.view.isoverlay state, this corresponds to the
state of R_SetView VF_CLEARSCREEN and disables clearing and bloom when
rendering overlays

------------------------------------------------------------------------
r8233 | havoc | 2008-03-24 17:32:26 -0700 (Mon, 24 Mar 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/csprogs.c

in csqc set self to the client entity before calling most functions

------------------------------------------------------------------------
r8232 | havoc | 2008-03-24 13:47:24 -0700 (Mon, 24 Mar 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/makefile.inc
   A /trunk/darkplaces/snd_3dras.c
   A /trunk/darkplaces/snd_3dras.h
   A /trunk/darkplaces/snd_3dras_typedefs.h

Patch from Qantourisc adding support for his 3D sound library

------------------------------------------------------------------------
r8231 | havoc | 2008-03-23 22:24:52 -0700 (Sun, 23 Mar 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

made cl_particles_quake mode more authentic

------------------------------------------------------------------------
r8230 | havoc | 2008-03-23 17:13:43 -0700 (Sun, 23 Mar 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

implemented better \ parsing, matching stock Quake better

------------------------------------------------------------------------
r8229 | havoc | 2008-03-23 15:06:40 -0700 (Sun, 23 Mar 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

added lingering blood and gunshot/spike particles to make it clear where
shots hit

------------------------------------------------------------------------
r8228 | havoc | 2008-03-23 14:32:15 -0700 (Sun, 23 Mar 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

fix stupid bug in \n and \r parsing

------------------------------------------------------------------------
r8227 | havoc | 2008-03-23 14:21:44 -0700 (Sun, 23 Mar 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

use \n parsing on globals in savegames

------------------------------------------------------------------------
r8226 | havoc | 2008-03-23 14:20:30 -0700 (Sun, 23 Mar 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

added r_drawfog cvar at esteel's request

------------------------------------------------------------------------
r8225 | havoc | 2008-03-23 13:21:03 -0700 (Sun, 23 Mar 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

reenable the \r parsing for consistency sake

------------------------------------------------------------------------
r8224 | havoc | 2008-03-22 21:27:20 -0700 (Sat, 22 Mar 2008) | 7 lines
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

don't parse \ characters when reading sav files or map entities, let the
ParseEpair function take care of \n and nothing else (and not if it's a
wad key)
this should fix compatibility with the quake map solstart.bsp which has
a \ character at the end of the wad value, also affecting a couple other
maps but not as badly

------------------------------------------------------------------------
r8222 | dresk | 2008-03-22 20:20:49 -0700 (Sat, 22 Mar 2008) | 1 line
Changed paths:
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/svvm_cmds.c

Added server QC function "movetypesteplandevent".  This function, if assigned to a MOVETYPE_STEP (ie. monster) entity in QC, is called when the entity experiences a "land event" wherein normally the sound sv_sound_land is played.  If this function is assigned, the standard server sound is suppressed, allowing for full configuration by the QC.
------------------------------------------------------------------------
r8221 | havoc | 2008-03-20 13:02:03 -0700 (Thu, 20 Mar 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/cmd.c

patch from Blub that adds the command "defer" which executes a command
after a specified number of seconds, without interrupting normal play

------------------------------------------------------------------------
r8220 | havoc | 2008-03-20 12:57:23 -0700 (Thu, 20 Mar 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/cmd.c

patch from Blub adding cprint (centerprint) console command, similar to
echo

------------------------------------------------------------------------
r8219 | havoc | 2008-03-20 12:31:33 -0700 (Thu, 20 Mar 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

how did boxready survive?  oh well

------------------------------------------------------------------------
r8218 | divverent | 2008-03-20 03:42:12 -0700 (Thu, 20 Mar 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

damn, I accidentally committed this with the last fix... now that it HAS happened, at least if(... == GAME_NEXUIZ) it

------------------------------------------------------------------------
r8217 | divverent | 2008-03-19 07:10:21 -0700 (Wed, 19 Mar 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fix obvious bugs in r8214

------------------------------------------------------------------------
r8215 | havoc | 2008-03-18 19:24:09 -0700 (Tue, 18 Mar 2008) | 7 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

changed use of infinite farclip to depend on 32bpp modes instead of on
whether shadows are enabled
added r_useinfinitefarclip cvar to allow disabling this otherwise forced
feature if it causes problems for anyone (was on for most users already)
optimized farclip math a little bit (use model->radius * 2 instead of
VectorDistance from corner to corner)

------------------------------------------------------------------------
r8214 | havoc | 2008-03-18 19:16:57 -0700 (Tue, 18 Mar 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

enlarge q3bsp bounding box to include all geometry, this is necessary
because q3map2 sometimes lies (to alter the lightgrid box)

------------------------------------------------------------------------
r8213 | divverent | 2008-03-18 06:06:34 -0700 (Tue, 18 Mar 2008) | 6 lines
Changed paths:
   M /trunk/darkplaces/BSDmakefile

It seems that 2.4 BSDmakefile is missing some SDL defines, and thus is
broken (tested under FreeBSD). Also, last lines about dependencies are
probably gmake-leftovers and are not needed on BSD (in fact, they've been
causing errors since some older version). Please consider attached patch.
Thanks. -- danfe (FreeBSD port maintainer)

------------------------------------------------------------------------
r8212 | divverent | 2008-03-16 10:31:32 -0700 (Sun, 16 Mar 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/cmd.c

fix cmd again (fix by Blub and me)

------------------------------------------------------------------------
r8211 | divverent | 2008-03-15 15:17:33 -0700 (Sat, 15 Mar 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/cmd.c

fix segfault with long aliases

------------------------------------------------------------------------
r8210 | havoc | 2008-03-11 22:17:02 -0700 (Tue, 11 Mar 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

disable pitch drift when csqc wants mouse moves

------------------------------------------------------------------------
r8209 | havoc | 2008-03-11 17:05:31 -0700 (Tue, 11 Mar 2008) | 6 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/todo

added 3 optional parameters to the csqc R_AddDynamicLight builtin
(style, cubemapname, pflags) and made it read v_forward, v_right, and
v_up to orient the light (useful mainly with cubemaps), these can also
(at least in DarkPlaces) be used as an alternative to radius (pass in
radius = 1 if they are pre-scaled)

------------------------------------------------------------------------
r8208 | havoc | 2008-03-09 19:06:32 -0700 (Sun, 09 Mar 2008) | 8 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clvm_cmds.c

replaced cl.movement_queue with direct use of cl.movecmd array, this
saves a little memory but mostly it simplifies some logic
reworked much of the prediction system
now extrapolates latest movement gathered instead of interpolating
between the last two moves sent, this reduces visual latency by 50-99ms
and deals better (but not perfectly) with mismatched framerates like
cl_maxfps 30 and cl_netfps 20

------------------------------------------------------------------------
r8207 | divverent | 2008-03-09 12:26:39 -0700 (Sun, 09 Mar 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_win.c

go back to block counting, looks like we now know what's broken with waveOut

------------------------------------------------------------------------
r8206 | havoc | 2008-03-09 11:23:33 -0700 (Sun, 09 Mar 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

lower cl_netfps default from 72 to 20

------------------------------------------------------------------------
r8205 | havoc | 2008-03-09 10:20:10 -0700 (Sun, 09 Mar 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/client.h

fixed jerky cl_movement with cl_netfps below current fps, by making
packet interval operate in realtime rather than cl.time

------------------------------------------------------------------------
r8204 | havoc | 2008-03-08 17:09:35 -0800 (Sat, 08 Mar 2008) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

added cl_netimmediatebuttons cvar which causes additional input packets
(beyond cl_netfps) when buttons or impulse change, giving better timing
accuracy when it counts (pressing fire)

------------------------------------------------------------------------
r8203 | havoc | 2008-03-08 17:08:42 -0800 (Sat, 08 Mar 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c

slight improvement to sound latency math (moved it after new sound data
is added)

------------------------------------------------------------------------
r8202 | havoc | 2008-03-08 14:41:35 -0800 (Sat, 08 Mar 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/sbar.c
   M /trunk/darkplaces/snd_main.c

added showsound cvar which displays number of sounds actively being
mixed, and total sound sources, and latency

------------------------------------------------------------------------
r8201 | havoc | 2008-03-08 14:40:01 -0800 (Sat, 08 Mar 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/snd_win.c

added WAV_BUFFERTIME setting of 0.125 (used to be 0.5)
reduced WAV_BUFFERS from 64 to 16

------------------------------------------------------------------------
r8200 | divverent | 2008-03-08 13:24:27 -0800 (Sat, 08 Mar 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_win.c

try using waveOutGetPosition instead of block counting (revert or #ifdef this if it breaks anything)

------------------------------------------------------------------------
r8199 | havoc | 2008-03-08 12:24:58 -0800 (Sat, 08 Mar 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_win.c

fix MMSYSERRR_STILLPLAYING handling to not increment snd_sent

------------------------------------------------------------------------
r8198 | divverent | 2008-03-08 12:12:48 -0800 (Sat, 08 Mar 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/snd_win.c

only go ahead if WAVERR_STILLPLAYING is encountered, other errors are fatal to the sound system again.
TODO: handle WAVERR_STILLPLAYING in a better way (like, clearing the buffer?)

------------------------------------------------------------------------
r8197 | havoc | 2008-03-08 11:58:15 -0800 (Sat, 08 Mar 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/snd_win.c

made waveOutWrite overrun a non-fatal (if spammy) warning, and only with
developer 1000

------------------------------------------------------------------------
r8196 | havoc | 2008-03-08 10:57:54 -0800 (Sat, 08 Mar 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fix crash when q1bsp submodels are checked with PointSuperContents
(oops)

------------------------------------------------------------------------
r8195 | havoc | 2008-03-08 08:55:46 -0800 (Sat, 08 Mar 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

another attempt at fixing the Mac OSX rotating hud problem

------------------------------------------------------------------------
r8194 | havoc | 2008-03-07 19:58:11 -0800 (Fri, 07 Mar 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/snd_coreaudio.c

disable threaded mixing in coreaudio backend (still threaded callback
method since coreaudio always uses that) - why does it crash?

------------------------------------------------------------------------
r8193 | havoc | 2008-03-07 19:44:55 -0800 (Fri, 07 Mar 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

increased maxtempentities from 512 to 4096, this affects how many csqc
entities can be renderable at once (need to make this grow instead)

------------------------------------------------------------------------
r8192 | havoc | 2008-03-06 11:44:56 -0800 (Thu, 06 Mar 2008) | 4 lines
Changed paths:
   M /trunk/darkplaces/makefile.inc

added a -I option on Mac OSX SDL builds to include the relevant Headers
directory, added a reference to this in the relevant LIBS variables
(because SDLMain.m needs the includes as well)

------------------------------------------------------------------------
r8191 | havoc | 2008-03-06 06:34:17 -0800 (Thu, 06 Mar 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fix bug that makes lava bridge in e1m6 kill you (as if you're in the
lava it came out of), thanks to Lardarse for reporting this

------------------------------------------------------------------------
r8189 | havoc | 2008-03-03 14:35:10 -0800 (Mon, 03 Mar 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

up the default cl_netfps to 72, which is higher than vsync for most
people

------------------------------------------------------------------------
r8188 | havoc | 2008-03-03 05:55:53 -0800 (Mon, 03 Mar 2008) | 7 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

removed cl_netinputpacketsperserverpacket (now uses
cl_netinputpacketspersecond again)
removed cl_netinputpacketspersecond_qw (now uses the main one)
renamed cl_netinputpacketspersecond to cl_netfps
renamed cl_netinputpacketlosstolerance to cl_netrepeatinput
changed default cl_netfps to 60 (from 20)

------------------------------------------------------------------------
r8187 | havoc | 2008-03-03 05:25:38 -0800 (Mon, 03 Mar 2008) | 4 lines
Changed paths:
   M /trunk/darkplaces/fs.c

fix support for zip archives made by the standard Mac OSX archiver
(ignore bit 3 in the general flags - the fields ARE valid in the central
 directory, just not in the stream data)

------------------------------------------------------------------------
r8186 | black | 2008-03-02 14:31:03 -0800 (Sun, 02 Mar 2008) | 1 line
Changed paths:
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/mvm_cmds.c

Remove FS_FIX_PATHS again and disable model rendering in the menu until someone can do it correctly (both were hacks).
------------------------------------------------------------------------
r8184 | havoc | 2008-03-02 11:45:38 -0800 (Sun, 02 Mar 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_coreaudio.c

fix really stupid typo in coreaudio init (!= was supposed to be ==)

------------------------------------------------------------------------
r8183 | havoc | 2008-03-02 08:32:15 -0800 (Sun, 02 Mar 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

fix missing particles when you join a server late in the game

------------------------------------------------------------------------
r8182 | divverent | 2008-03-02 08:32:04 -0800 (Sun, 02 Mar 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_coreaudio.c

unconst something

------------------------------------------------------------------------
r8181 | havoc | 2008-03-02 08:03:47 -0800 (Sun, 02 Mar 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

improved CL_ParticleTrail's check for unknown effect numbers

------------------------------------------------------------------------
r8180 | havoc | 2008-03-02 07:28:42 -0800 (Sun, 02 Mar 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

added a dprint for unknown effect numbers

------------------------------------------------------------------------
r8179 | havoc | 2008-03-02 07:23:25 -0800 (Sun, 02 Mar 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/protocol.h

added svc_trailparticles, svc_pointparticles, and svc_pointparticles1 to
the list of svc_ code names for cl_shownet 2 prints

------------------------------------------------------------------------
r8178 | havoc | 2008-03-02 05:45:58 -0800 (Sun, 02 Mar 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/snd_coreaudio.c
   M /trunk/darkplaces/snd_sdl.c

added support for snd_blocked (related to the snd_mutewhenidle cvar) in
threaded mixers

------------------------------------------------------------------------
r8177 | havoc | 2008-03-02 04:28:33 -0800 (Sun, 02 Mar 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_coreaudio.c

threaded audio mixing for OSX

------------------------------------------------------------------------
r8176 | havoc | 2008-03-02 04:06:55 -0800 (Sun, 02 Mar 2008) | 5 lines
Changed paths:
   M /trunk/darkplaces/cd_shared.c
   M /trunk/darkplaces/dpvsimpledecode.c
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_mix.c
   M /trunk/darkplaces/snd_null.c
   M /trunk/darkplaces/sound.h

added a parameter to S_StopChannel to trigger a mutex lock, this fixes
crashes in the SDL audio callback when S_StopChannel clears fields while
they are being used in the mixer (this mostly crashed on level changes),
the mutex lock itself is done simply by calling SndSys_LockRenderBuffer

------------------------------------------------------------------------
r8175 | havoc | 2008-03-02 04:01:07 -0800 (Sun, 02 Mar 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_alsa.c

whitespace

------------------------------------------------------------------------
r8174 | havoc | 2008-03-02 03:58:50 -0800 (Sun, 02 Mar 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_bsd.c

whitespace

------------------------------------------------------------------------
r8173 | havoc | 2008-03-01 05:24:42 -0800 (Sat, 01 Mar 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

fix ev_field parser for savegames

------------------------------------------------------------------------
r8172 | havoc | 2008-03-01 01:43:09 -0800 (Sat, 01 Mar 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.inc

reenable stripping of release binaries

------------------------------------------------------------------------
r8171 | havoc | 2008-03-01 00:03:23 -0800 (Sat, 01 Mar 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c

fixed GL_CheckExtension to not even bother checking for an extension if
the name does not begin with GL_ or WGL_ or similar things

------------------------------------------------------------------------
r8170 | havoc | 2008-02-29 23:13:28 -0800 (Fri, 29 Feb 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/vid_wgl.c

init gl_extensions and gl_platformextensions to "" before fetching
wglfuncs

------------------------------------------------------------------------
r8169 | havoc | 2008-02-29 22:54:30 -0800 (Fri, 29 Feb 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/vid_wgl.c

don't bother doing two-pass window setup unless vid_samples is greater
than 1

------------------------------------------------------------------------
r8168 | havoc | 2008-02-29 22:45:32 -0800 (Fri, 29 Feb 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/vid_sdl.c

clear some variables when VID_Shutdown is called (the other 3 vid
modules already did this)

------------------------------------------------------------------------
r8167 | havoc | 2008-02-29 22:34:17 -0800 (Fri, 29 Feb 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_agl.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_wgl.c

make sure that gl_extensions and gl_platformextensions are not NULL

------------------------------------------------------------------------
r8166 | havoc | 2008-02-29 21:40:04 -0800 (Fri, 29 Feb 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/makefile.inc

no longer stripping darkplaces release executables, because debugging
symbols are too useful for crash reports

------------------------------------------------------------------------
r8165 | havoc | 2008-02-29 20:54:54 -0800 (Fri, 29 Feb 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix two-layer quake sky in r_glsl 1 mode (was blending the alpha layer wrongly)

------------------------------------------------------------------------
r8163 | havoc | 2008-02-29 07:17:39 -0800 (Fri, 29 Feb 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

default gl_texturecompression_q3bspdeluxemaps to 0

------------------------------------------------------------------------
r8162 | havoc | 2008-02-29 02:37:26 -0800 (Fri, 29 Feb 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/vid_wgl.c

use a better cast on a parameter in a ToAscii call, might fix a warning,
probably not

------------------------------------------------------------------------
r8161 | havoc | 2008-02-29 02:31:06 -0800 (Fri, 29 Feb 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_wgl.c

fix warnings on qglGetString calls

------------------------------------------------------------------------
r8160 | havoc | 2008-02-29 01:58:15 -0800 (Fri, 29 Feb 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

a fix from Black for prevseparator, hopefully the only bug

------------------------------------------------------------------------
r8159 | black | 2008-02-29 01:23:05 -0800 (Fri, 29 Feb 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/filematch.c
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/menu.c

Restored FS_Search patch.

------------------------------------------------------------------------
r8158 | divverent | 2008-02-28 13:38:08 -0800 (Thu, 28 Feb 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/filematch.c
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/menu.c

Reverted Black's filematch changes for now, because they were still broken and we need to release, and I don't see how to fix it. Issue: "ls *.cfg" doesn't show the cfgs from the file system, just from the pk3s (e.g. it missed config.cfg), and on Windows it even showed something even weirder: "*.cfgconfig.cfg".

------------------------------------------------------------------------
r8157 | havoc | 2008-02-28 02:35:29 -0800 (Thu, 28 Feb 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/fs.c

fix a bug in FS_ChangeGameDirs (it was doing a CL_Disconnect - can't do
that because when connecting to a QW server it disconnects)

------------------------------------------------------------------------
r8156 | havoc | 2008-02-28 02:01:04 -0800 (Thu, 28 Feb 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_demo.c
   M /trunk/darkplaces/client.h

reworked min/avg/max fps report in timedemo, now works again

------------------------------------------------------------------------
r8155 | havoc | 2008-02-27 19:35:17 -0800 (Wed, 27 Feb 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c

fixed a problem with snd_renderbuffer->endframe being updated in the
wrong place, causing windows waveOut audio to fail

------------------------------------------------------------------------
r8154 | black | 2008-02-27 14:59:43 -0800 (Wed, 27 Feb 2008) | 1 line
Changed paths:
   M /trunk/darkplaces/csprogs.c

I must have been smoking cannabis when I wrote this (a pity I dont smoke cannabis). Fix CSQC_Ent_Spawn handling.
------------------------------------------------------------------------
r8153 | black | 2008-02-27 14:11:08 -0800 (Wed, 27 Feb 2008) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

Don't try to render something when height or width are zero.
------------------------------------------------------------------------
r8152 | divverent | 2008-02-27 11:04:49 -0800 (Wed, 27 Feb 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/prvm_execprogram.h

Make the "no such builtin" message more descriptive

------------------------------------------------------------------------
r8151 | divverent | 2008-02-27 08:49:00 -0800 (Wed, 27 Feb 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/svvm_cmds.c

|sort

------------------------------------------------------------------------
r8149 | havoc | 2008-02-27 08:34:09 -0800 (Wed, 27 Feb 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.h
   M /trunk/darkplaces/svvm_cmds.c

DP_QC_NUM_FOR_EDICT extension implemented by Blub

------------------------------------------------------------------------
r8148 | havoc | 2008-02-27 08:05:58 -0800 (Wed, 27 Feb 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c

slight change in location of a piece of code, should have no effect
(this makes it closer to the way it was)

------------------------------------------------------------------------
r8147 | havoc | 2008-02-27 08:04:46 -0800 (Wed, 27 Feb 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_mix.c

fix a typo (but it was harmless)

------------------------------------------------------------------------
r8146 | havoc | 2008-02-27 07:22:17 -0800 (Wed, 27 Feb 2008) | 6 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_main.h
   M /trunk/darkplaces/snd_mix.c
   M /trunk/darkplaces/snd_sdl.c

implemented threaded audio mixing for SDL client (required some
minor clean up of S_PaintAndSubmit and the functions it called, the
buffer painting management makes a lot more sense now)
fixed bug with looping sounds mixing sound to the wrong part of the
buffer after looping (uses a pointer instead of paintbuffer now)

------------------------------------------------------------------------
r8145 | divverent | 2008-02-27 06:01:55 -0800 (Wed, 27 Feb 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

oops... double builtins suck

------------------------------------------------------------------------
r8144 | divverent | 2008-02-27 05:54:22 -0800 (Wed, 27 Feb 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

oops... use upper case hex, as that matches URI::Escape module (HTTP allows both)

------------------------------------------------------------------------
r8143 | divverent | 2008-02-27 05:51:57 -0800 (Wed, 27 Feb 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.h
   M /trunk/darkplaces/svvm_cmds.c

DP_QC_URI_ESCAPE

------------------------------------------------------------------------
r8142 | havoc | 2008-02-27 03:52:29 -0800 (Wed, 27 Feb 2008) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

one last try to beat the OSX texture scrolling bug (set activetexture
and clientactivetexture - even though only the former is needed, and do
so before switching the matrixmode to texture)

------------------------------------------------------------------------
r8141 | havoc | 2008-02-27 03:35:48 -0800 (Wed, 27 Feb 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/snd_wav.c

fix bug in wav loader that messed up loopstart, now looping sounds in
quake work properly

------------------------------------------------------------------------
r8140 | havoc | 2008-02-27 00:43:29 -0800 (Wed, 27 Feb 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/cmd.c

fix toggle command's error message for cvars that are not found (thanks
to metlslime for reporting this)

------------------------------------------------------------------------
r8139 | havoc | 2008-02-26 21:57:26 -0800 (Tue, 26 Feb 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c

disable adaptive mixahead when soundtimehack is non-zero (recording,
etc)

------------------------------------------------------------------------
r8138 | havoc | 2008-02-26 21:47:57 -0800 (Tue, 26 Feb 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c

implemented adaptive mixahead at low framerates (ones too low for the
current _snd_mixahead value)

------------------------------------------------------------------------
r8137 | havoc | 2008-02-26 04:28:33 -0800 (Tue, 26 Feb 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/vid_agl.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_wgl.c

audited PixelFormat setup code and made it request appropriate bit
depths

------------------------------------------------------------------------
r8136 | res | 2008-02-26 03:27:24 -0800 (Tue, 26 Feb 2008) | 1 line
Changed paths:
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_shared.c

Change GLX visual acquisition to also try without sample buffers if samples == 1 - some Mesa drivers don't provide visuals with any sample buffer
------------------------------------------------------------------------
r8135 | havoc | 2008-02-26 01:56:01 -0800 (Tue, 26 Feb 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_lightning.c

disabled cull face on lightning beams

------------------------------------------------------------------------
r8134 | havoc | 2008-02-26 01:55:47 -0800 (Tue, 26 Feb 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

made r_showbboxes disable cull face

------------------------------------------------------------------------
r8133 | divverent | 2008-02-25 09:06:33 -0800 (Mon, 25 Feb 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/nexuiz.xpm

oops... too many colors in xpm

------------------------------------------------------------------------
r8132 | divverent | 2008-02-25 07:09:03 -0800 (Mon, 25 Feb 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

remove misleading print from FS "My Games" code

------------------------------------------------------------------------
r8131 | black | 2008-02-25 05:07:10 -0800 (Mon, 25 Feb 2008) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/r_shadow.c

Move rt* states and the ambient value into r_refdef_scene. Menu now uses fullbright rendering as default.
------------------------------------------------------------------------
r8130 | havoc | 2008-02-25 02:29:30 -0800 (Mon, 25 Feb 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

fix fields.server reference in surface attribute code

------------------------------------------------------------------------
r8129 | havoc | 2008-02-24 23:49:34 -0800 (Sun, 24 Feb 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

475

------------------------------------------------------------------------
r8128 | havoc | 2008-02-24 23:49:10 -0800 (Sun, 24 Feb 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fix bug with r_novis 1 not enabling r_wateralpha support on unvised maps

------------------------------------------------------------------------
r8127 | havoc | 2008-02-24 23:48:46 -0800 (Sun, 24 Feb 2008) | 4 lines
Changed paths:
   M /trunk/darkplaces/zone.c

fix bug with rtlights not being imported from the map sometimes (caused
by previous level having a lot of lights, exposing a bug in
Mem_ExpandableArray_IndexRange)

------------------------------------------------------------------------
r8126 | havoc | 2008-02-24 16:24:12 -0800 (Sun, 24 Feb 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

patch from Blub that fixes csqc polygon rendering

------------------------------------------------------------------------
r8125 | divverent | 2008-02-23 13:44:51 -0800 (Sat, 23 Feb 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/jpeg.c

libjpeg writing: turn off chroma subsampling. Really improves how strong colors look on screenshots (like, red healthpack models or text no longer appear blurred)

------------------------------------------------------------------------
r8124 | black | 2008-02-23 02:27:46 -0800 (Sat, 23 Feb 2008) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_textures.c

Revert revisions 7946 and 7767. R_Upload now doesn't pass NULL data pointers on to GL (specs and drivers don't like it).
------------------------------------------------------------------------
r8123 | havoc | 2008-02-22 14:43:06 -0800 (Fri, 22 Feb 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.dsp

don't link dxguid.lib or dinput.lib anymore, since they're now unused

------------------------------------------------------------------------
r8122 | havoc | 2008-02-21 21:30:33 -0800 (Thu, 21 Feb 2008) | 7 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/world.c
   M /trunk/darkplaces/world.h

set csqc world.mins and world.maxs (reworked World_SetSize to make this
easier)
moved the qc SV_Shutdown in Host_ShutdownServer to before clients are
kicked off
added qc SV_Shutdown call in SV_SpawnServer (before the progs reset)
fixed a bug with failed changelevel (which was unloading world)

------------------------------------------------------------------------
r8121 | havoc | 2008-02-21 14:31:34 -0800 (Thu, 21 Feb 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c

patch from Blub that fixes DrawQ_Line with GLSL mode

------------------------------------------------------------------------
r8120 | havoc | 2008-02-21 03:50:57 -0800 (Thu, 21 Feb 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/vid_wgl.c

fix severe bug in my previous screensaver-disable patch that caused all
window widgets to be ignored (minimize, close, etc)

------------------------------------------------------------------------
r8119 | havoc | 2008-02-21 03:40:53 -0800 (Thu, 21 Feb 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

another todo item for csqc spec changes

------------------------------------------------------------------------
r8118 | havoc | 2008-02-21 02:21:41 -0800 (Thu, 21 Feb 2008) | 6 lines
Changed paths:
   M /trunk/darkplaces/snd_win.c
   M /trunk/darkplaces/sys_win.c
   M /trunk/darkplaces/vid_wgl.c

added #ifdef SUPPORTDIRECTX checks around all the dinput and dsound code
- this means that dinput and dsound is not removed but is disabled,
  making it easier to compile with Dev-C++ and stock MSVS, this may have
bad consequences (some people swear by -dinput, and dsound was used by
default unless -wavonly was specified, so this is a behavior change)

------------------------------------------------------------------------
r8116 | havoc | 2008-02-21 01:36:14 -0800 (Thu, 21 Feb 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/sys_sdl.c

go back to using main - apparently some platforms don't use SDL_main

------------------------------------------------------------------------
r8115 | havoc | 2008-02-21 01:25:11 -0800 (Thu, 21 Feb 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

made missing gamedir errors non-fatal warnings

------------------------------------------------------------------------
r8113 | havoc | 2008-02-20 23:49:06 -0800 (Wed, 20 Feb 2008) | 2 lines
Changed paths:
   A /trunk/darkplaces/darkplaces-sdl.dev

added Dev-C++ project for SDL client

------------------------------------------------------------------------
r8112 | havoc | 2008-02-20 23:48:46 -0800 (Wed, 20 Feb 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/sys_sdl.c

changed main to SDL_main for simplicity reasons

------------------------------------------------------------------------
r8111 | havoc | 2008-02-20 22:18:11 -0800 (Wed, 20 Feb 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/svvm_cmds.c

added DP_QC_EDICT_NUM extension to list

------------------------------------------------------------------------
r8108 | havoc | 2008-02-20 22:03:27 -0800 (Wed, 20 Feb 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/svvm_cmds.c

fix addstat type parameter, swapped 8 and 2

------------------------------------------------------------------------
r8107 | havoc | 2008-02-20 20:16:49 -0800 (Wed, 20 Feb 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/sbar.c

fix bug in csqc getplayerkey reported by Blub

------------------------------------------------------------------------
r8106 | divverent | 2008-02-19 22:04:12 -0800 (Tue, 19 Feb 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

fix warning

------------------------------------------------------------------------
r8105 | havoc | 2008-02-19 15:01:27 -0800 (Tue, 19 Feb 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

changed hostname for tchr's master from excalibur.nvg.ntnu.no to
dpmaster.tchr.no

------------------------------------------------------------------------
r8104 | havoc | 2008-02-18 11:15:33 -0800 (Mon, 18 Feb 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h

removed tag override support in .skin files - because Quake3 actually
doesn't do that (it doesn't use the tag names in .skin at all)

------------------------------------------------------------------------
r8101 | black | 2008-02-15 11:31:27 -0800 (Fri, 15 Feb 2008) | 1 line
Changed paths:
   M /trunk/darkplaces/filematch.c
   M /trunk/darkplaces/fs.c

Fix a parameter switch typo in the linux code.
------------------------------------------------------------------------
r8100 | black | 2008-02-15 07:03:06 -0800 (Fri, 15 Feb 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/filematch.c
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/menu.c

New attempt to change listdirectory.
FS_Search now also correctly processes wildcards everywhere (models/players/*/*.skin works now).
------------------------------------------------------------------------
r8099 | havoc | 2008-02-15 02:07:37 -0800 (Fri, 15 Feb 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_shared.h

split Mod_GetMesh_Vertices into 3 AnimateVertices functions, chosen by
model loaders, this should improve compile times a bit in MSVS

------------------------------------------------------------------------
r8098 | havoc | 2008-02-14 15:03:24 -0800 (Thu, 14 Feb 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_shared.c

fix a typo

------------------------------------------------------------------------
r8097 | havoc | 2008-02-14 15:03:11 -0800 (Thu, 14 Feb 2008) | 5 lines
Changed paths:
   M /trunk/darkplaces/vid_wgl.c

always call Sleep(0) at the end of each frame on Windows, I hope this
fixes problems with Logitech input drivers freezing the game for 50+
milliseconds every 3 seconds or so, and has no harm to framerate in
testing

------------------------------------------------------------------------
r8096 | havoc | 2008-02-14 15:01:28 -0800 (Thu, 14 Feb 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

remove cl_alwayssleep, it only does what we want on Windows

------------------------------------------------------------------------
r8095 | havoc | 2008-02-14 15:01:01 -0800 (Thu, 14 Feb 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/sys_linux.c

remove an unnecessary check in Sys_Sleep

------------------------------------------------------------------------
r8094 | black | 2008-02-14 12:57:01 -0800 (Thu, 14 Feb 2008) | 1 line
Changed paths:
   M /trunk/darkplaces/filematch.c
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/menu.c

Fix it.. nah I'm just reverting :D
------------------------------------------------------------------------
r8093 | black | 2008-02-14 12:41:07 -0800 (Thu, 14 Feb 2008) | 1 line
Changed paths:
   M /trunk/darkplaces/fs.c

Fix something Ive broken ofc.
------------------------------------------------------------------------
r8092 | black | 2008-02-14 12:12:35 -0800 (Thu, 14 Feb 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/filematch.c
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/menu.c

Append path in listdirectory automatically.
Remove .. and . from directory listings in the Win32 code, too.
------------------------------------------------------------------------
r8091 | havoc | 2008-02-14 10:21:54 -0800 (Thu, 14 Feb 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_sdl.c

slight cleanup of Sys_EventFilter

------------------------------------------------------------------------
r8090 | havoc | 2008-02-14 09:38:09 -0800 (Thu, 14 Feb 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_agl.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_null.c
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c

implemented vid_samples cvar (antialiasing samples per pixel)
oh and for the record, Windows multisample buffer setup is awful.

------------------------------------------------------------------------
r8089 | havoc | 2008-02-14 06:51:16 -0800 (Thu, 14 Feb 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_wgl.c

disable screensaver on windows while game window is active

------------------------------------------------------------------------
r8088 | havoc | 2008-02-14 06:29:58 -0800 (Thu, 14 Feb 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_sdl.c

added vid_vsync control in SDL

------------------------------------------------------------------------
r8087 | havoc | 2008-02-14 06:10:57 -0800 (Thu, 14 Feb 2008) | 5 lines
Changed paths:
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/sys_linux.c
   M /trunk/darkplaces/sys_sdl.c
   M /trunk/darkplaces/sys_win.c
   M /trunk/darkplaces/todo

added experimental cl_alwayssleep cvar which calls Sys_Sleep(0) at the
end of each frame
fixed a bug in the main loop that made Sys_Sleep be called with
milliseconds when it takes microseconds

------------------------------------------------------------------------
r8086 | havoc | 2008-02-14 06:09:14 -0800 (Thu, 14 Feb 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

changed now showfps calculates the fps - hopefully an improvement

------------------------------------------------------------------------
r8085 | divverent | 2008-02-14 03:08:08 -0800 (Thu, 14 Feb 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/nexuiz.ico

Nexuiz icon updated

------------------------------------------------------------------------
r8084 | havoc | 2008-02-13 17:29:14 -0800 (Wed, 13 Feb 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/svbsp.c

remove unnecessary #include of quakedef.h

------------------------------------------------------------------------
r8083 | divverent | 2008-02-13 13:45:49 -0800 (Wed, 13 Feb 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/nexuiz.xpm

new Nexuiz icon... still waiting for .ico

------------------------------------------------------------------------
r8082 | havoc | 2008-02-11 17:41:13 -0800 (Mon, 11 Feb 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/mathlib.h

changed ANGLEMOD to use floor instead of conversion to 16bit fixed-point

------------------------------------------------------------------------
r8081 | havoc | 2008-02-11 17:37:56 -0800 (Mon, 11 Feb 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

reworked cl.viewangles bounding of roll angle, and simplified pitch
handling

------------------------------------------------------------------------
r8080 | divverent | 2008-02-10 13:37:14 -0800 (Sun, 10 Feb 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

thanks to blub for locating the texture blending bug

------------------------------------------------------------------------
r8079 | divverent | 2008-02-08 02:16:22 -0800 (Fri, 08 Feb 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c

respect the conchars image width/height correctly, and only draw the needed part of the font rect - fixes connector characters in variable width fonts

------------------------------------------------------------------------
r8078 | divverent | 2008-02-06 10:44:53 -0800 (Wed, 06 Feb 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c

make "set con_completion_commandname map" a command complete as if it were the "map" command

------------------------------------------------------------------------
r8077 | divverent | 2008-02-06 08:51:02 -0800 (Wed, 06 Feb 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

hopefully fix engine crash with map-less shader stages

------------------------------------------------------------------------
r8076 | divverent | 2008-02-05 23:38:46 -0800 (Tue, 05 Feb 2008) | 4 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/cvar.c
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.h
   M /trunk/darkplaces/svvm_cmds.c
   M /trunk/darkplaces/vid_sdl.c

disable joystick by default, and make joy_enable saved;
add extension DP_QC_CVAR_TYPE that checks what type a cvar is (like, if the engine created it or the mod, or if it is saved)
will write dpextensions.qc block for it later, a start of its description is in mbuiltin.h in Nexuiz

------------------------------------------------------------------------
r8075 | black | 2008-02-05 10:15:09 -0800 (Tue, 05 Feb 2008) | 4 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/menu.c

Comment out a line in setmodel again (needs fixing but wasn't in there before anyway)
Always clear the depth buffer in R_RenderView.
Use realtime as scene time when rendering the menu scene.

------------------------------------------------------------------------
r8074 | black | 2008-02-05 08:20:23 -0800 (Tue, 05 Feb 2008) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

Fix the VM's clientstate builtin to do a correct mapping between the client state and the menu's constants (now that the client state values have changed in DP itself).
------------------------------------------------------------------------
r8073 | black | 2008-02-04 13:09:03 -0800 (Mon, 04 Feb 2008) | 1 line
Changed paths:
   M /trunk/darkplaces/snd_sdl.c

Fix a typo. Enjoy.
------------------------------------------------------------------------
r8072 | havoc | 2008-02-04 03:47:04 -0800 (Mon, 04 Feb 2008) | 8 lines
Changed paths:
   M /trunk/darkplaces/cd_shared.c
   M /trunk/darkplaces/cl_demo.c
   M /trunk/darkplaces/cl_dyntexture.c
   M /trunk/darkplaces/cl_gecko.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/draw.h
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/image_png.c
   M /trunk/darkplaces/jpeg.c
   M /trunk/darkplaces/libcurl.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/sbar.c
   M /trunk/darkplaces/snd_alsa.c
   M /trunk/darkplaces/snd_coreaudio.c
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_mem.c
   M /trunk/darkplaces/snd_modplug.c
   M /trunk/darkplaces/snd_ogg.c
   M /trunk/darkplaces/snd_sdl.c
   M /trunk/darkplaces/snd_wav.c
   M /trunk/darkplaces/snd_win.c
   M /trunk/darkplaces/vid_agl.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c
   M /trunk/darkplaces/wad.c

huge audit of dprints throughout engine, all notices of successfully
loading models/sounds/skins/etc are now tied to the cvar
developer_loading
added developer_loadfile cvar (prints every successful FS_LoadFile)
many improvements to consistency of loading notices, and some cleanups
to q3 shader handling
fixed annoying 'Bad dynamic texture name' spam at load

------------------------------------------------------------------------
r8071 | havoc | 2008-02-04 03:33:14 -0800 (Mon, 04 Feb 2008) | 4 lines
Changed paths:
   M /trunk/darkplaces/client.h

fix bug that caused early console messages to not be put in console
history (because cls.state defaulted to ca_dedicated - now it defaults
to ca_uninitialized)

------------------------------------------------------------------------
r8070 | havoc | 2008-02-04 03:24:42 -0800 (Mon, 04 Feb 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/world.c
   M /trunk/darkplaces/world.h

replaced World_Clear with World_SetSize and World_UnlinkAll

------------------------------------------------------------------------
r8069 | havoc | 2008-02-03 17:28:39 -0800 (Sun, 03 Feb 2008) | 6 lines
Changed paths:
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/svvm_cmds.c

modified droptofloor to try a downward trace from the bottom center of
the object if it is stuck, this manages to 'correctly' place many badly
placed entities in quake maps
additionally modified droptofloor to first try unsticking the entity
before dropping it (sv_gameplayfix_droptofloorstartsolid_nudgetocorrect)

------------------------------------------------------------------------
r8068 | havoc | 2008-02-03 04:42:04 -0800 (Sun, 03 Feb 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c

revert my change and fix the types on Black's changes, which were the
real problem (this revert only due to my change being slightly messier)

------------------------------------------------------------------------
r8067 | havoc | 2008-02-03 03:13:29 -0800 (Sun, 03 Feb 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h

added GAME_BLADEMASTER

------------------------------------------------------------------------
r8066 | havoc | 2008-02-03 03:12:42 -0800 (Sun, 03 Feb 2008) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c

fix Black's PRVM_EDICT_NUM_ERROR return type change which did not work
(0 is not the same as NULL, compilers get upset about that)
one other minor correction of the same kind

------------------------------------------------------------------------
r8064 | divverent | 2008-02-02 10:38:38 -0800 (Sat, 02 Feb 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_agl.c
   M /trunk/darkplaces/vid_glx.c

fix bugs with changing apple_mouse_noaccel and vid_dgamouse while grabbed (that previously could "destroy" mouse support until console gets pulled down and up)

------------------------------------------------------------------------
r8063 | black | 2008-02-01 08:21:37 -0800 (Fri, 01 Feb 2008) | 4 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c

Rewrite CSQC's setmodel a bit.
Add support for CSQC_Ent_Spawn to csqc. A function that is called when a entity packet from the server arrives that requires a new entity.
entity( float entnum ) CSQC_Ent_Spawn;
CSQC_Ent_Spawn needs to spawn a new entity and set its .entnum field accordingly or simply return another existing entity or world if it wants to ignore that server entity. Subsequent CSQC_Ent_Update calls are routed to that entity (or CSQC_Ent_Spawn is called again when .Version increases).
------------------------------------------------------------------------
r8061 | divverent | 2008-02-01 01:20:07 -0800 (Fri, 01 Feb 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

fix broken table length, and yet another hardcoded index

------------------------------------------------------------------------
r8060 | divverent | 2008-02-01 00:56:31 -0800 (Fri, 01 Feb 2008) | 4 lines
Changed paths:
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c

- vid_userefreshrate: when 0, a sane default is tried to be used
- win32: list valid modes, and use the closest match
- win32: vid_forcerefreshrate: don't do the listing, but just try to set it anyway

------------------------------------------------------------------------
r8059 | havoc | 2008-01-31 22:00:59 -0800 (Thu, 31 Jan 2008) | 6 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/render.h

renamed MATERIALFLAG_WATER to MATERIALFLAG_WATERSCROLL
changed all MATERIALFLAG_WATER materials to use MATERIALFLAG_WALL as
their primary material flag, this simplified some rendering code
did some more tweaks to fix issues with the mirror glass texture in
the tenebrae testmap

------------------------------------------------------------------------
r8058 | havoc | 2008-01-31 21:51:21 -0800 (Thu, 31 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/render.h

reassigned some GL20TU values to use only 11 texture slots

------------------------------------------------------------------------
r8057 | divverent | 2008-01-31 02:53:07 -0800 (Thu, 31 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

there was only a single way to mess it up, and I managed to find it... 1.0/int, not 1/int

------------------------------------------------------------------------
r8056 | divverent | 2008-01-31 01:21:25 -0800 (Thu, 31 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

new uniform "PixelSize" defined as (size_x, size_y) that is (1/texwidth, 1/texheight) for the postprocessing shader - user defined stuff may use it

------------------------------------------------------------------------
r8055 | divverent | 2008-01-30 14:19:13 -0800 (Wed, 30 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

oops, that should not have gone in there

------------------------------------------------------------------------
r8054 | divverent | 2008-01-30 14:18:16 -0800 (Wed, 30 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

hide centerprint immediately when scr_centertime is 0

------------------------------------------------------------------------
r8053 | divverent | 2008-01-30 00:41:03 -0800 (Wed, 30 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

make "stopdownload" also stop curl downloads

------------------------------------------------------------------------
r8052 | havoc | 2008-01-29 23:18:56 -0800 (Tue, 29 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/progdefs.h
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/sv_main.c

fixed -tenebrae support, added glass and mirror rendering and caulk

------------------------------------------------------------------------
r8051 | havoc | 2008-01-29 11:35:24 -0800 (Tue, 29 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix div0's weird MODE_WATER ModelViewProjectionPosition declarations

------------------------------------------------------------------------
r8050 | havoc | 2008-01-29 11:28:53 -0800 (Tue, 29 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix missing loc_Texture_GammaRamps lookup

------------------------------------------------------------------------
r8049 | divverent | 2008-01-29 11:19:41 -0800 (Tue, 29 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix compile bug in glsl shader first

------------------------------------------------------------------------
r8048 | havoc | 2008-01-29 10:53:55 -0800 (Tue, 29 Jan 2008) | 5 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/render.h

changed postprocess shader to use Texture_GammaRamps instead of
Texture_Attenuation to make the code more clear (no impact on
performance)
fixed bug with viewblend being applied inversely

------------------------------------------------------------------------
r8047 | divverent | 2008-01-29 09:44:34 -0800 (Tue, 29 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_shared.c

fix warning

------------------------------------------------------------------------
r8046 | divverent | 2008-01-29 08:56:15 -0800 (Tue, 29 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

oops, my fault - I kept two unused cvars in

------------------------------------------------------------------------
r8045 | divverent | 2008-01-29 08:55:43 -0800 (Tue, 29 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/vid_shared.c

v_glslgamma: make GLSL postprocessing take over the job of v_hwgamma completely, if set and glsl works. Costs here 1.6ms per frame, so I'll keep r_glsl_contrastboost.

------------------------------------------------------------------------
r8044 | divverent | 2008-01-29 04:41:02 -0800 (Tue, 29 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_shared.c

added variable vid_gammatables_trivial that is true if the gamma ramp is the identity map - so glsl doesn't need to waste time on that case later

------------------------------------------------------------------------
r8043 | divverent | 2008-01-29 04:29:14 -0800 (Tue, 29 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

add an extra unused #ifdef to the glsl shader so the shader can know if it was actually enabled by r_glsl_postprocessing or if it was just forced by bloom

------------------------------------------------------------------------
r8042 | divverent | 2008-01-29 04:20:10 -0800 (Tue, 29 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_shared.c

oops, wrong type... "int" has no ANSI C defined wraparound, "unsigned int" does

------------------------------------------------------------------------
r8041 | divverent | 2008-01-29 04:08:06 -0800 (Tue, 29 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_shared.c

make other parts of DP able to retrieve the gamma table, and add a serial field so other subsystems can poll if it has changed. Useful for handling it using glsl.

------------------------------------------------------------------------
r8040 | divverent | 2008-01-29 03:39:41 -0800 (Tue, 29 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/palette.c
   M /trunk/darkplaces/palette.h
   M /trunk/darkplaces/vid_shared.c

v_contrastboost, and support for the color control functions to fill the gamma table. Goal: remove USECONTRASTBOOST and USEGAMMA in the postprocess shader, replace it by USEGAMMARAMP, and let vid_shared build the gamma tables even if hw gamma is off when glsl needs them... then add a cvar r_glsl_hwgamma that lets glsl take over gamma ramp handling

------------------------------------------------------------------------
r8039 | divverent | 2008-01-29 01:14:13 -0800 (Tue, 29 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

by default, don't define UserVec1 to UserVec4 and ClientTime. People who want to use them shall uncomment their declaration in default.glsl.

------------------------------------------------------------------------
r8038 | divverent | 2008-01-29 01:12:06 -0800 (Tue, 29 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

add ClientTime and uservec1 to uservec4 parameters to postprocessing shader

------------------------------------------------------------------------
r8037 | divverent | 2008-01-29 00:07:48 -0800 (Tue, 29 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_sky.c

fix bug in skybox render + r_glsl_usegeneric + fog; add gamma to postprocessing shader

------------------------------------------------------------------------
r8036 | havoc | 2008-01-28 20:24:23 -0800 (Mon, 28 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix bug with r_glsl 1;r_hdr 1;r_bloom 0 that made the screen white

------------------------------------------------------------------------
r8035 | havoc | 2008-01-28 17:50:40 -0800 (Mon, 28 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

fixed VBO batching bug in rtlight rendering

------------------------------------------------------------------------
r8034 | divverent | 2008-01-28 14:45:43 -0800 (Mon, 28 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h

extra required parameter for dp_water: alpha modifier

------------------------------------------------------------------------
r8033 | divverent | 2008-01-28 03:44:27 -0800 (Mon, 28 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_demo.c

note to myself: skipping over data works better if you actually do it

------------------------------------------------------------------------
r8032 | divverent | 2008-01-28 01:40:11 -0800 (Mon, 28 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_demo.c
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/sv_demo.c
   M /trunk/darkplaces/sv_demo.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_user.c

add a DEMOMSG_CLIENT_TO_SERVER flag to demos (0x80000000) in the size field; packets with this flag will be ignored by playback. sv_autodemo_perclient 2 will record these packages for debugging purposes (like, recording a speedhacker's or other protocol exploiter's packets, and analyzing them with the data in the demo file manually)

------------------------------------------------------------------------
r8031 | havoc | 2008-01-27 22:52:37 -0800 (Sun, 27 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

some very slight optimization to rt light rendering setup code

------------------------------------------------------------------------
r8030 | havoc | 2008-01-27 19:36:03 -0800 (Sun, 27 Jan 2008) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

added r_glsl_postprocess cvar to apply a postprocessing pass over the
screen (currently only implements r_glsl_contrastboost)
this path is also activated if bloom or hdr is active with r_glsl 1

------------------------------------------------------------------------
r8029 | black | 2008-01-27 17:09:00 -0800 (Sun, 27 Jan 2008) | 1 line
Changed paths:
   M /trunk/darkplaces/fs.c

Clean up the FS_FIX_PATHS code a bit - should by faster now, too.
------------------------------------------------------------------------
r8028 | black | 2008-01-27 17:02:56 -0800 (Sun, 27 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/prvm_cmds.c

Make fgets always return the null string on error.
Add code to FS_Open to fix bad paths (replaces \ with /). The code is nasty and #ifdefed out - #define FS_FIX_PATHS to use it.
------------------------------------------------------------------------
r8027 | havoc | 2008-01-27 15:52:45 -0800 (Sun, 27 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

remove a bogus RSurf_SetupDepthAndCulling call that was crashing

------------------------------------------------------------------------
r8026 | black | 2008-01-27 10:49:34 -0800 (Sun, 27 Jan 2008) | 1 line
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/csprogs.h

R_SetView now supports VF_CLEARSCREEN which decides whether to clear the screen or not when rendering the view (this is of particular interest for rendering view in views or for the menu).
------------------------------------------------------------------------
r8025 | black | 2008-01-27 09:23:08 -0800 (Sun, 27 Jan 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_gecko.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/clvm_cmds.h
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/svvm_cmds.c
   M /trunk/dpmod/qc/dpextensions.qc

Pass the name of the instance to Gecko_Query, too.
Add setattachment, gettaginfo and gettagindex to menu builtin list, too.
Add DP_GECKO_SUPPORT and DP_QC_GETSURFACEPOINTATTRIB to dpextensions.qc.
------------------------------------------------------------------------
r8024 | havoc | 2008-01-27 00:39:42 -0800 (Sun, 27 Jan 2008) | 8 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/render.h

some surface rendering code cleanup
eliminated several redundant state calls
eliminated RSurf_CleanUp function
eliminated special gl_lightmaps rendering path
moved all but the basic material rendering from R_DrawTextureSurfaceList
to R_ProcessTextureSurfaceList, this simplifies the transparent callback
and allowed me to move the transparent queuing into this function

------------------------------------------------------------------------
r8023 | havoc | 2008-01-26 22:28:54 -0800 (Sat, 26 Jan 2008) | 6 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_lightning.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/render.h

implemented r_glsl_usegeneric cvar, this causes generic GLSL shaders to
be used in place of ALL conventional fixedfunction rendering, seems to
give about a 3% fps increase on NVIDIA drivers
this should fix zfighting issues involving r_depthfirst or shadows,
particularly on Mac OSX (may also fix the OSX rotating/scrolling hud)

------------------------------------------------------------------------
r8020 | black | 2008-01-26 18:18:54 -0800 (Sat, 26 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/render.h

Add R_SelectScene and R_GetScenePointer that encapsulate access to an array of r_refdef_scene_t that is swapped into r_refdef on need.
Change the menu to use it and fix a bug that was caused because of the menu's use of the stack for backing up the client's scene.
------------------------------------------------------------------------
r8019 | havoc | 2008-01-26 18:05:00 -0800 (Sat, 26 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/render.h

remove a dead prototype

------------------------------------------------------------------------
r8018 | havoc | 2008-01-26 18:03:54 -0800 (Sat, 26 Jan 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/vid_shared.c

added a TODO comment about blacklisting GL_ARB_texture_non_power_of_two
on Radeon X1600-X1950 cards

------------------------------------------------------------------------
r8017 | havoc | 2008-01-26 16:55:22 -0800 (Sat, 26 Jan 2008) | 4 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/svbsp.c

rewrote most of the VM_Polygon/DebugPolygon code, it should perform much
better now and has no upper limit on polygons, and only a 64 point limit
per polygon, and has transparent sorting again

------------------------------------------------------------------------
r8016 | havoc | 2008-01-26 16:46:45 -0800 (Sat, 26 Jan 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/host.c

added cl_minfps_qualitypower cvar to make particle quality drop more
sharply at lower framerates

------------------------------------------------------------------------
r8015 | divverent | 2008-01-26 07:06:01 -0800 (Sat, 26 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt

update docs for dp_reflect, dp_refract, dp_water

------------------------------------------------------------------------
r8014 | res | 2008-01-25 15:51:59 -0800 (Fri, 25 Jan 2008) | 1 line
Changed paths:
   M /trunk/darkplaces/sv_main.c

Fix uninitialized msg.allowoverflow in SV_SendClientDatagram
------------------------------------------------------------------------
r8013 | havoc | 2008-01-25 15:31:06 -0800 (Fri, 25 Jan 2008) | 4 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

disabled size throttling of packets if csqc is used (because it was very
easy to end up with >128 byte entity updates which can in some cases
never be sent at all due to the size throttling)

------------------------------------------------------------------------
r8012 | divverent | 2008-01-25 13:06:46 -0800 (Fri, 25 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

restricted rcon: actually display a different message if restricted rcon was used

------------------------------------------------------------------------
r8011 | havoc | 2008-01-25 11:47:02 -0800 (Fri, 25 Jan 2008) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/menu.c

vary r_drawparticles_drawdistance and r_drawdecals_drawdistance for
quality limiting according to FPS, instead of skipping particles, this
looks much better (but doesn't help FPS as much)

------------------------------------------------------------------------
r8010 | divverent | 2008-01-25 03:40:15 -0800 (Fri, 25 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c

fix warning

------------------------------------------------------------------------
r8009 | divverent | 2008-01-25 01:47:10 -0800 (Fri, 25 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c

fix tab completion spam

------------------------------------------------------------------------
r8008 | divverent | 2008-01-25 01:08:53 -0800 (Fri, 25 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/fs.h

tab completion now allows directories (PLEASE TEST ON WIN32)

------------------------------------------------------------------------
r8007 | havoc | 2008-01-25 00:53:00 -0800 (Fri, 25 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/host.c

renamed cl_minfps_expbase to cl_minfps_logbase

------------------------------------------------------------------------
r8006 | havoc | 2008-01-25 00:48:57 -0800 (Fri, 25 Jan 2008) | 8 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/menu.c

implemented framerate-dependent particle quality reduction to try to
smooth out fps swings in Ruiner in Nexuiz
added r_drawparticles_drawdistance (and one for decals)
particles and decals arrays now grow dynamically and have smaller
defaults than before
fixed bug with rain particles that made them live for about 4 minutes if
they fell out of the map

------------------------------------------------------------------------
r8005 | divverent | 2008-01-24 13:43:55 -0800 (Thu, 24 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/zone.c

Expandable arrays: memset to zero newly returned records (to be consistent with Mem_Alloc). Fixes bug with string buffers.

------------------------------------------------------------------------
r8004 | havoc | 2008-01-23 18:44:57 -0800 (Wed, 23 Jan 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_demo.c

changed timedemo one-second stats to sync to cl.time (which comes from
the demo) rather than realtime, so now they should be more consistent

------------------------------------------------------------------------
r8003 | res | 2008-01-23 17:56:18 -0800 (Wed, 23 Jan 2008) | 1 line
Changed paths:
   M /trunk/darkplaces/common.c

edu2p game: change 2nd game dir to 'edu2'
------------------------------------------------------------------------
r8002 | res | 2008-01-22 14:57:45 -0800 (Tue, 22 Jan 2008) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_gecko.c
   M /trunk/darkplaces/cl_gecko.h
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_edict.c

Gecko: added ability to call back into a QC entry point (Gecko_Entry) from JS inside a Gecko instance.
------------------------------------------------------------------------
r8000 | tomaz | 2008-01-22 13:05:53 -0800 (Tue, 22 Jan 2008) | 1 line
Changed paths:
   M /trunk/darkplaces/todo

458
------------------------------------------------------------------------
r7999 | tomaz | 2008-01-22 12:56:16 -0800 (Tue, 22 Jan 2008) | 1 line
Changed paths:
   M /trunk/darkplaces/todo

todo items went from 465 to 459 by finding items that was already done or duplicates
------------------------------------------------------------------------
r7996 | havoc | 2008-01-22 12:05:42 -0800 (Tue, 22 Jan 2008) | 8 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/netconn.h
   M /trunk/darkplaces/r_explosion.c

merged CL_MoveParticles, CL_MoveDecals, and R_MoveExplosions into their
respective Draw functions, this gave a small fps gain (due to better
cache behavior)
redesigned input packet timing (now based on cl.time instead of
realtime, which required compensating for slowmo), this takes advantage
of the time synchronization features of the cl.time code
replaced cls.movesequence with cls.netcon->outgoing_unreliable_sequence

------------------------------------------------------------------------
r7995 | havoc | 2008-01-22 12:03:47 -0800 (Tue, 22 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

some slight cleanup of SV_PushMove

------------------------------------------------------------------------
r7994 | havoc | 2008-01-22 11:56:33 -0800 (Tue, 22 Jan 2008) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/view.c

fixed sprites rendering incorrectly in reflections (the view vectors no
longer match the actual rendering matrix in the reflection case, fixing
such problems)

------------------------------------------------------------------------
r7993 | havoc | 2008-01-22 11:17:44 -0800 (Tue, 22 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/bspfile.h
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h

removed support for Sajt's unfinished McBSP format

------------------------------------------------------------------------
r7992 | havoc | 2008-01-22 11:15:55 -0800 (Tue, 22 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c

removed mcbsp map parsing

------------------------------------------------------------------------
r7991 | divverent | 2008-01-22 10:53:10 -0800 (Tue, 22 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_gecko.c

I really prefer code that actually compiles...

------------------------------------------------------------------------
r7990 | res | 2008-01-22 09:38:35 -0800 (Tue, 22 Jan 2008) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_gecko.c

Update OffscreenGecko headers again
------------------------------------------------------------------------
r7989 | res | 2008-01-22 07:12:18 -0800 (Tue, 22 Jan 2008) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_gecko.c

New OffscreenGecko scripting stuff
------------------------------------------------------------------------
r7988 | divverent | 2008-01-22 06:53:58 -0800 (Tue, 22 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/snd_main.c

make play/play2 dummies when -nosound

------------------------------------------------------------------------
r7987 | divverent | 2008-01-22 01:49:30 -0800 (Tue, 22 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sv_user.c

fix the "ping times for antilag/display wrong" issue, but increasing the problems of sv_clmovement_waitforinput a bit

------------------------------------------------------------------------
r7986 | divverent | 2008-01-20 22:16:47 -0800 (Sun, 20 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

remove superfluous newline after gl_vbostats text

------------------------------------------------------------------------
r7985 | divverent | 2008-01-20 11:45:25 -0800 (Sun, 20 Jan 2008) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

For some reason, cl_netinputpacketsperserverpacket > 1 causes choppiness when cl_movement is active and fps are high.

As workaround, disable the "replying to server frames" code for cl_netinputpacketsperserverpacket > 1, and make it ONLY respond to server frames (or after 0.1s when no server frame came) when set to 0. 0 MAY be a bit more smooth than 1, but something tells me it is LESS smooth when packet loss is involved.

------------------------------------------------------------------------
r7983 | divverent | 2008-01-19 03:20:21 -0800 (Sat, 19 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_exec.c
   M /trunk/darkplaces/svvm_cmds.c

damn... make sure Host_Error prevents SV_Shutdown from getting called, or it could result in a double fault that causes a hard edit

------------------------------------------------------------------------
r7982 | divverent | 2008-01-19 03:16:12 -0800 (Sat, 19 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/svvm_cmds.c

new SV progs function SV_Shutdown, gets called just before progs get unloaded/renewed. Useful to save data at the end of a level.

------------------------------------------------------------------------
r7981 | divverent | 2008-01-19 02:42:23 -0800 (Sat, 19 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/mvm_cmds.c

add missing FTE_STRINGS to menu QC

------------------------------------------------------------------------
r7980 | divverent | 2008-01-19 00:26:00 -0800 (Sat, 19 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.h
   M /trunk/darkplaces/svvm_cmds.c

rename VM_hash to VM_crc16, and the extension to DP_QC_CRC16. That way, it is specified that it has to be this specific hash function.

------------------------------------------------------------------------
r7979 | divverent | 2008-01-18 17:46:58 -0800 (Fri, 18 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.h
   M /trunk/darkplaces/svvm_cmds.c

Fix bug in stringbuffers with bufstr_set not updating num_strings; add a new builtin for QC called float hash(float caseinsensitive, string str) that returns the CRC of the string (possibly after lowercasing). Using this, a persistent database can be implemented quite efficiently (for a 1MB database file, it takes about 0.1 seconds to load and 0.3 seconds to save, which is quite acceptable). From QC, I use a string buffer of 16384 strings, indexed by hash of the key, containing an info string at each index to solve the collision issue. Possibly add hash() to the stringbuffer DP extension, or make a new extension for it?

------------------------------------------------------------------------
r7978 | havoc | 2008-01-18 07:47:26 -0800 (Fri, 18 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

buf_del builtin frees strings in the buffer now

------------------------------------------------------------------------
r7977 | res | 2008-01-18 07:38:00 -0800 (Fri, 18 Jan 2008) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_gecko.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/makefile.inc
   M /trunk/darkplaces/quakedef.h

Removed passing machine type from the makefile to the compiler; instead, determine that stuff through preprocessor conditions.
------------------------------------------------------------------------
r7976 | divverent | 2008-01-18 06:19:58 -0800 (Fri, 18 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.inc

fix quoting for machine type

------------------------------------------------------------------------
r7975 | havoc | 2008-01-18 04:39:58 -0800 (Fri, 18 Jan 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

lowered fresnel power in GLSL shader from 5.0 to 2.0 to make water
reflections more visible

------------------------------------------------------------------------
r7974 | havoc | 2008-01-18 03:45:39 -0800 (Fri, 18 Jan 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c

disable water clipping plane while rendering sky, this fixes the "black
sky" bug in reflection/refraction rendering

------------------------------------------------------------------------
r7973 | havoc | 2008-01-18 03:44:31 -0800 (Fri, 18 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

make GL_SetupView_Orientation_FromEntity not blow away the model matrix

------------------------------------------------------------------------
r7972 | black | 2008-01-17 05:39:55 -0800 (Thu, 17 Jan 2008) | 1 line
Changed paths:
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c

Add support for a clientcamera sqc field that automatically updates the view entity on the clients.
------------------------------------------------------------------------
r7971 | havoc | 2008-01-17 05:19:11 -0800 (Thu, 17 Jan 2008) | 6 lines
Changed paths:
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_edict.c

rewrote most of the DP_QC_STRINGBUFFERS implementation
string buffers are now associated with their parent progs (and no longer
leak when the progs is freed)
removed almost all limits on string buffers (there is a sanity limit of
a million strings per buffer)

------------------------------------------------------------------------
r7970 | havoc | 2008-01-17 03:05:39 -0800 (Thu, 17 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_gecko.c

hush unitialized warnings

------------------------------------------------------------------------
r7969 | havoc | 2008-01-17 01:14:25 -0800 (Thu, 17 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix a syntax error in the GLSL shader for vertextextureblend + specular

------------------------------------------------------------------------
r7968 | res | 2008-01-16 03:20:50 -0800 (Wed, 16 Jan 2008) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_gecko.c

set eol-style property
------------------------------------------------------------------------
r7967 | res | 2008-01-16 03:19:30 -0800 (Wed, 16 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_gecko.c
   M /trunk/darkplaces/makefile.inc

Gecko: add a platform-specific search path for XULrunner. This makes it possible to keep versions for different platforms side-by-side.

------------------------------------------------------------------------
r7966 | res | 2008-01-16 03:11:13 -0800 (Wed, 16 Jan 2008) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_gecko.c
   M /trunk/darkplaces/cl_gecko.h
   M /trunk/darkplaces/timing.h

GCC warning fixes
------------------------------------------------------------------------
r7965 | res | 2008-01-16 03:07:22 -0800 (Wed, 16 Jan 2008) | 1 line
Changed paths:
   M /trunk/darkplaces/makefile.inc

Add cl_gecko.c to Makefile
------------------------------------------------------------------------
r7964 | res | 2008-01-16 03:05:29 -0800 (Wed, 16 Jan 2008) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_gecko.h

Gecko: load OffscreenGecko dynamically
------------------------------------------------------------------------
r7963 | res | 2008-01-16 03:03:10 -0800 (Wed, 16 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/keys.c

Fix CL_VM_InputeEvent prototype in keys.c

------------------------------------------------------------------------
r7962 | res | 2008-01-16 02:52:17 -0800 (Wed, 16 Jan 2008) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_gecko.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.h

Gecko: load OffscreenGecko dynamically
------------------------------------------------------------------------
r7961 | divverent | 2008-01-15 15:31:45 -0800 (Tue, 15 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

fix stupid "using port 0" message

------------------------------------------------------------------------
r7959 | havoc | 2008-01-14 21:26:00 -0800 (Mon, 14 Jan 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/darkplaces-sdl.dsp
   M /trunk/darkplaces/darkplaces.dsp

added snd_modplug.[ch] to MSVS projects (thanks to Xandy for reporting
this)

------------------------------------------------------------------------
r7958 | divverent | 2008-01-14 11:28:28 -0800 (Mon, 14 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

make server name/map name sorting case insensitive

------------------------------------------------------------------------
r7957 | divverent | 2008-01-13 12:10:36 -0800 (Sun, 13 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix one typo and one uncleanness in the glsl shader, fixes compilation problems for Morphed

------------------------------------------------------------------------
r7956 | divverent | 2008-01-13 02:12:30 -0800 (Sun, 13 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

always look for spawnfunc_%s first when spawning an entity by classname (for Q3A map compatibility - ammo_rockets is used as classname in Q3A and as field in Q1)

------------------------------------------------------------------------
r7955 | havoc | 2008-01-13 00:55:59 -0800 (Sun, 13 Jan 2008) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.h

go back to using MATERIALFLAGMASK_DEPTHSORTED for transparent sorting
decisions
clear MATERIALFLAG_BLENDED on watershader materials

------------------------------------------------------------------------
r7954 | havoc | 2008-01-13 00:53:29 -0800 (Sun, 13 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix typo that broke rtlights on vertex texture blend materials

------------------------------------------------------------------------
r7953 | divverent | 2008-01-12 13:33:06 -0800 (Sat, 12 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

make packet_f work on dedicated servers too

------------------------------------------------------------------------
r7952 | divverent | 2008-01-12 08:41:34 -0800 (Sat, 12 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix r_glsl_dumpshader

------------------------------------------------------------------------
r7951 | divverent | 2008-01-11 12:52:19 -0800 (Fri, 11 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

net_slist_pause

------------------------------------------------------------------------
r7949 | black | 2008-01-10 07:42:09 -0800 (Thu, 10 Jan 2008) | 1 line
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/svvm_cmds.c

Fix some bugs in the getsurfacepointattribute code.
------------------------------------------------------------------------
r7948 | black | 2008-01-10 05:40:57 -0800 (Thu, 10 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/svvm_cmds.c

Fix the bmodel collision bug in csqc.
clvm's setmodel and setmodelindex also update the min, max and size now (just like they do in sqc).
------------------------------------------------------------------------
r7947 | black | 2008-01-10 02:07:32 -0800 (Thu, 10 Jan 2008) | 1 line
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/dpmod/qc/client/csqc_builtins.h

Fix a bug in the automatically generated builtin file.
------------------------------------------------------------------------
r7946 | res | 2008-01-10 01:05:03 -0800 (Thu, 10 Jan 2008) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_textures.c

Fix runaway mipmap upload when NULL texture data was specified.
------------------------------------------------------------------------
r7945 | havoc | 2008-01-09 19:08:33 -0800 (Wed, 09 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/render.h

implemented q3bsp vertex texture blending (GL20 path only)

------------------------------------------------------------------------
r7944 | havoc | 2008-01-09 19:05:29 -0800 (Wed, 09 Jan 2008) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/render.h

use GL20TU_ enum values instead of constant texture unit numbers, to
make maintenance easier
some cleanup

------------------------------------------------------------------------
r7943 | havoc | 2008-01-09 18:36:32 -0800 (Wed, 09 Jan 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.h

reworked transparent sorting of MATERIALFLAG_BLENDED to not sort water
surfaces with refraction rendering (which are opaque but use a texture)

------------------------------------------------------------------------
r7942 | havoc | 2008-01-09 18:25:34 -0800 (Wed, 09 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

remove unused allowedpermutations field

------------------------------------------------------------------------
r7941 | havoc | 2008-01-09 17:51:40 -0800 (Wed, 09 Jan 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

use cl.worldmodel in r_editlights_reload code as it is invoked from the
newmap callback

------------------------------------------------------------------------
r7940 | divverent | 2008-01-09 03:28:22 -0800 (Wed, 09 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/prvm_exec.c

remove prvm_boundscheck cvar (security hole) and force bounds check on unless DP is compiled with -DPRVM_BOUNDSCHECK_CVAR (for those who REALLY want to be able to turn it off)

------------------------------------------------------------------------
r7939 | havoc | 2008-01-08 17:36:06 -0800 (Tue, 08 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

changed hvec types to half types fixing warnings in GLSL shader

------------------------------------------------------------------------
r7938 | black | 2008-01-08 16:35:04 -0800 (Tue, 08 Jan 2008) | 1 line
Changed paths:
   M /trunk/darkplaces/common.c

Add an edu2 prototype gamemode.
------------------------------------------------------------------------
r7937 | divverent | 2008-01-08 11:37:10 -0800 (Tue, 08 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

remove -appdata option... make -mygames option instead (easier to find for users). As before, only use that path if explicitly specified or if there is no other way.

------------------------------------------------------------------------
r7936 | divverent | 2008-01-08 02:46:50 -0800 (Tue, 08 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

no O_APPEND here

------------------------------------------------------------------------
r7935 | divverent | 2008-01-08 01:50:19 -0800 (Tue, 08 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

make it use APPDATA right

------------------------------------------------------------------------
r7934 | divverent | 2008-01-08 01:30:48 -0800 (Tue, 08 Jan 2008) | 5 lines
Changed paths:
   M /trunk/darkplaces/fs.c

new options:
-appdata (Windows)
-nohome (Linux)
-userdir /path/to/userdir/to/be/used/instead/of/home/username/.darkplaces

------------------------------------------------------------------------
r7933 | havoc | 2008-01-07 19:50:09 -0800 (Mon, 07 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

fix warning

------------------------------------------------------------------------
r7932 | black | 2008-01-07 09:34:19 -0800 (Mon, 07 Jan 2008) | 1 line
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/dpmod/qc/client/csqc_builtins.h

Flush comment fixes and update dpmod's csqc_builtins.h.
------------------------------------------------------------------------
r7931 | black | 2008-01-07 08:49:50 -0800 (Mon, 07 Jan 2008) | 1 line
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/mvm_cmds.c

Add some builtin definitions to the builtin list (necessary for automated builtin qc creation).
------------------------------------------------------------------------
r7930 | black | 2008-01-07 06:28:25 -0800 (Mon, 07 Jan 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/r_lightning.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_sky.c

Move a part of r_refdef_t into a new r_refdef_scene_t struct and refactor the code to use it.
The menu now only uses its own scene. This fixes all issues I know of, but this is only the first step -
a bigger clean-up is still needed.
------------------------------------------------------------------------
r7929 | divverent | 2008-01-06 14:23:39 -0800 (Sun, 06 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

oops... fixed a security issue with expanding aliases

------------------------------------------------------------------------
r7928 | divverent | 2008-01-06 14:00:17 -0800 (Sun, 06 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

add rcon_restricted_password and rcon_restricted_commands - this allows to give out a "lesser" rcon password that can only be used to execute commands in a small list, instead of full console access

------------------------------------------------------------------------
r7927 | divverent | 2008-01-06 11:54:27 -0800 (Sun, 06 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c

add r_textcontrast to complement t_textbrightness

------------------------------------------------------------------------
r7925 | black | 2008-01-05 17:05:25 -0800 (Sat, 05 Jan 2008) | 1 line
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/mvm_cmds.c

Fix two bugs (everything should behave as usual now, when you're not using menu rendering).
------------------------------------------------------------------------
r7924 | divverent | 2008-01-05 16:11:01 -0800 (Sat, 05 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

make Nexuiz flag status icon position cvar defined

------------------------------------------------------------------------
r7923 | havoc | 2008-01-05 15:15:32 -0800 (Sat, 05 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/palette.c

fix black fog outline bug on quake sprites

------------------------------------------------------------------------
r7922 | black | 2008-01-05 14:46:48 -0800 (Sat, 05 Jan 2008) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/clvm_cmds.h
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/menu.h
   M /trunk/darkplaces/mvm_cmds.c

Add CSQC rendering support to the menu (uses the same interface as the CSQC VM).
Move temp entities to the renderer code (because only temporary render entities are needed).
Rework the polygon code to support multiple VMs.
Credits and thanks to res2k (and me ;)).
------------------------------------------------------------------------
r7920 | havoc | 2008-01-05 14:33:58 -0800 (Sat, 05 Jan 2008) | 5 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

rate limit the old quake protocols by frequency
raised packet size limit on DP1-4 protocols to what they were in those
old versions of the engine (since they can not handle packet size
limiting of any kind)

------------------------------------------------------------------------
r7919 | havoc | 2008-01-05 14:32:36 -0800 (Sat, 05 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/cmd.c

corrected a buffer size

------------------------------------------------------------------------
r7918 | havoc | 2008-01-05 14:32:22 -0800 (Sat, 05 Jan 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_gecko.c

added an optimization note (should be tracking number of active gecko
instances, not always iterating to max)

------------------------------------------------------------------------
r7917 | havoc | 2008-01-05 14:31:55 -0800 (Sat, 05 Jan 2008) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

the -profilegameonly option now stops profiling in CL_Disconnect to give
better results (especially if playing with it on, rather than just
profiling timedemos)
improved handling of cl.num_dlights

------------------------------------------------------------------------
r7916 | havoc | 2008-01-05 14:28:55 -0800 (Sat, 05 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

significant cleanup of GLSL setup code

------------------------------------------------------------------------
r7915 | havoc | 2008-01-05 14:25:08 -0800 (Sat, 05 Jan 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

GLSL code now prints the number of lines of leading text for warnings as
well as error messages (making warnings easier to fix)

------------------------------------------------------------------------
r7914 | havoc | 2008-01-05 14:23:27 -0800 (Sat, 05 Jan 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

added two missing CL_SignonReply calls in qw protocol parsing (this
fixes -profilegameonly on QW games)

------------------------------------------------------------------------
r7913 | havoc | 2008-01-05 14:22:32 -0800 (Sat, 05 Jan 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

load rtlights file sooner in map change process, to avoid it showing up
in -profilegameonly

------------------------------------------------------------------------
r7912 | havoc | 2008-01-04 21:37:43 -0800 (Fri, 04 Jan 2008) | 3 lines
Changed paths:
   M /trunk/darkplaces/r_explosion.c

keep track of number of active explosions rather than scanning up to
MAX_EXPLOSIONS every frame

------------------------------------------------------------------------
r7905 | molivier | 2008-01-04 15:20:54 -0800 (Fri, 04 Jan 2008) | 1 line
Changed paths:
   M /trunk/darkplaces/snd_coreaudio.c

Removed a bunch of warnings
------------------------------------------------------------------------
r7904 | molivier | 2008-01-04 15:13:27 -0800 (Fri, 04 Jan 2008) | 1 line
Changed paths:
   M /trunk/darkplaces/image.c

Moved initializations of the pixel_size and attributes fields in the TGA header ealier, so they would be properly set before the call to PrintTargaHeader()
------------------------------------------------------------------------
r7903 | black | 2008-01-04 14:15:36 -0800 (Fri, 04 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/meshqueue.c
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_lightning.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/r_sprites.c
   M /trunk/darkplaces/view.c

Refactor the code to make r_view and r_viewcache members of r_refdef,
Remove an unused variable from CL_VM_InputEvent.
------------------------------------------------------------------------
r7900 | res | 2008-01-04 10:06:31 -0800 (Fri, 04 Jan 2008) | 1 line
Changed paths:
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c

Changing passing of key event ASCII codes to CSQC to use an additional function argument for CSQC_InputEvent instead of a global.
------------------------------------------------------------------------
r7899 | res | 2008-01-04 09:45:53 -0800 (Fri, 04 Jan 2008) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_gecko.c

Made gecko bindings a bit more chatty in developer mode.
------------------------------------------------------------------------
r7897 | divverent | 2008-01-04 04:35:35 -0800 (Fri, 04 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/keys.h

make keys line up in keys.c and key.h for easier verifying

------------------------------------------------------------------------
r7896 | res | 2008-01-03 09:54:30 -0800 (Thu, 03 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c

Provide 'ascii' key input to CSQC.

------------------------------------------------------------------------
r7895 | res | 2008-01-03 09:52:28 -0800 (Thu, 03 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

Fix crash in MD3 loading when no animscenes are loaded

------------------------------------------------------------------------
r7894 | divverent | 2008-01-02 05:48:57 -0800 (Wed, 02 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/sv_main.c

before calling Mod_CanSeeBox_Trace or TraceLineOfSight, check if the model actually supports them (prevents crash with missing worldmodel)

------------------------------------------------------------------------
r7893 | divverent | 2008-01-02 01:38:35 -0800 (Wed, 02 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/host.c

fix bug in saveconfig that caused config to get saved to weird random file names on quit

------------------------------------------------------------------------
r7892 | res | 2008-01-01 17:08:11 -0800 (Tue, 01 Jan 2008) | 1 line
Changed paths:
   A /trunk/darkplaces/clvm_cmds.h
   M /trunk/darkplaces/csprogs.c

Made CSQC_AddRenderEdict compute the tag matrix if a tag is set.
------------------------------------------------------------------------
r7891 | res | 2008-01-01 17:03:41 -0800 (Tue, 01 Jan 2008) | 1 line
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

Fixed flawed comparison in VM_CL_gettagindex that always reported the first precached client model as not precached.
------------------------------------------------------------------------
r7890 | res | 2008-01-01 16:58:53 -0800 (Tue, 01 Jan 2008) | 1 line
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

Fixed crash in CL_GetTagMatrix when no 'scale' entity field is present.
------------------------------------------------------------------------
r7889 | divverent | 2008-01-01 13:42:44 -0800 (Tue, 01 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.dev

update of the Dev-C++ project

------------------------------------------------------------------------
r7888 | divverent | 2008-01-01 07:05:37 -0800 (Tue, 01 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

Nexuiz: play intro video on startup by QC now

------------------------------------------------------------------------
r7887 | divverent | 2008-01-01 06:19:44 -0800 (Tue, 01 Jan 2008) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_edict.c

add cvar prvm_backtraceforwarning

------------------------------------------------------------------------
r7886 | havoc | 2007-12-31 08:38:55 -0800 (Mon, 31 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/polygon.c

removed #include of quakedef.h as it doesn't seem necessary

------------------------------------------------------------------------
r7885 | havoc | 2007-12-31 08:36:14 -0800 (Mon, 31 Dec 2007) | 5 lines
Changed paths:
   M /trunk/darkplaces/polygon.c
   M /trunk/darkplaces/polygon.h

optimized PolygonF_Divide/PolygonD_Divide functions, now performing only
one dot-product per iteration rather than two
added PolygonF_Clip/PolygonD_Clip functions which keep only the front
side

------------------------------------------------------------------------
r7884 | res | 2007-12-31 05:49:54 -0800 (Mon, 31 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/csprogs.c

Made CSQC VM initialization prefer the program downloaded from the server over the local version.

------------------------------------------------------------------------
r7883 | divverent | 2007-12-31 05:37:32 -0800 (Mon, 31 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/keys.h
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/mvm_cmds.c

add a new key dest key_menu_grabbed that behaves like key_menu, but also passes function keys to the menu; useful for key bind editors

------------------------------------------------------------------------
r7882 | res | 2007-12-30 08:48:15 -0800 (Sun, 30 Dec 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

Revert r7881 since it's broken in it's current shape.
------------------------------------------------------------------------
r7881 | res | 2007-12-30 07:19:26 -0800 (Sun, 30 Dec 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

Add CSQC ReadEntity to mirror SVQC's WriteEntity.
------------------------------------------------------------------------
r7879 | havoc | 2007-12-28 15:04:18 -0800 (Fri, 28 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

fix Con_Print that should have been Con_Printf

------------------------------------------------------------------------
r7878 | divverent | 2007-12-28 11:25:12 -0800 (Fri, 28 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

missing %s

------------------------------------------------------------------------
r7877 | divverent | 2007-12-28 09:39:13 -0800 (Fri, 28 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_sprites.c

sprite tracking distance fix; update inverse view matrix before rendering a scene, as preceding code may have changed it

------------------------------------------------------------------------
r7876 | divverent | 2007-12-28 08:36:48 -0800 (Fri, 28 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_sprites.c

make SPR_LABEL use neither depth test nor fog; make R_Draw_Sprite not fog nodepthtest sprites at all because they can be treated as HUD items

------------------------------------------------------------------------
r7875 | divverent | 2007-12-28 08:22:03 -0800 (Fri, 28 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

oops, missed a "const"

------------------------------------------------------------------------
r7874 | divverent | 2007-12-28 07:12:27 -0800 (Fri, 28 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

extension to writeconfig command: also take a file name

------------------------------------------------------------------------
r7872 | res | 2007-12-28 04:55:02 -0800 (Fri, 28 Dec 2007) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_gecko.c

gecko:
- print gecko error code when embedding object init fails
- print message when browser object creation fails
- crash fix in CL_Gecko_NavigateToURI

------------------------------------------------------------------------
r7871 | res | 2007-12-27 10:55:59 -0800 (Thu, 27 Dec 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

csqc setmodel: print a warning when the given model was not precached
------------------------------------------------------------------------
r7870 | divverent | 2007-12-27 10:43:42 -0800 (Thu, 27 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

oops... could not have optimized this, putting back old code (fixes fog too bright bug at r_glsl 0, but contrastboost being set)

------------------------------------------------------------------------
r7867 | divverent | 2007-12-27 00:34:03 -0800 (Thu, 27 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

wrap skins >= numskins to 0 in Mod_Alias_GetTagIndexForName (consistent to how textures are chosen for an invlaid skin); prevents "big gun" bug in Nexuiz

------------------------------------------------------------------------
r7866 | divverent | 2007-12-25 10:02:44 -0800 (Tue, 25 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/protocol.c

fix "warping" bug MrBougo found in the protocol (namely, values near +4096 causing an integer overflow when errorneously sent as 13.3bit fixed points)

------------------------------------------------------------------------
r7865 | havoc | 2007-12-25 02:54:29 -0800 (Tue, 25 Dec 2007) | 5 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c

revert the vid_grabkeyboard 0 support in fullscreen, due to
CWOverrideRedirect the window is never focused and thus completely
unusable with this approach, maybe a different method of initializing
fullscreen will be implemented in the future

------------------------------------------------------------------------
r7864 | havoc | 2007-12-25 02:43:38 -0800 (Tue, 25 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

some minor cleanup

------------------------------------------------------------------------
r7863 | havoc | 2007-12-25 02:00:31 -0800 (Tue, 25 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c

vid_grabkeyboard 0 now works with fullscreen

------------------------------------------------------------------------
r7862 | divverent | 2007-12-25 00:58:02 -0800 (Tue, 25 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fog table now at developer >= 100

------------------------------------------------------------------------
r7861 | havoc | 2007-12-25 00:41:18 -0800 (Tue, 25 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix t->lightmapcolor on fullbright surfaces

------------------------------------------------------------------------
r7860 | havoc | 2007-12-25 00:36:36 -0800 (Tue, 25 Dec 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/sv_phys.c

don't call SV_CheckWaterTransition on MOVETYPE_STEP entities unless the
entity moves (or a pusher moves through the area)

------------------------------------------------------------------------
r7859 | havoc | 2007-12-24 22:10:31 -0800 (Mon, 24 Dec 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/collision.c
   M /trunk/darkplaces/collision.h
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_phys.c

implemented PointSuperContents model function as a lower-overhead
alternative to TraceBox, and this also makes profile reports more clear

------------------------------------------------------------------------
r7858 | havoc | 2007-12-24 22:09:39 -0800 (Mon, 24 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/world.c
   M /trunk/darkplaces/world.h

World_EntitiesInBox now takes const mins/maxs

------------------------------------------------------------------------
r7857 | havoc | 2007-12-24 22:09:02 -0800 (Mon, 24 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

one more cl_ignoremousemove change to cl_ignoremousemoves

------------------------------------------------------------------------
r7856 | havoc | 2007-12-24 22:08:32 -0800 (Mon, 24 Dec 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c

changed cl_ignoremousemove from a qboolean to an int named
cl_ignoremousemoves which is set to 2 whenever the mouse grab state
changes, the one-frame ignore was not working

------------------------------------------------------------------------
r7855 | havoc | 2007-12-24 18:48:38 -0800 (Mon, 24 Dec 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c

cl_prydoncursor traces now trace against the model bounding box before
testing the geometry itself, this gives a substantial speed increase in
maps with lots of monsters

------------------------------------------------------------------------
r7854 | divverent | 2007-12-23 21:09:55 -0800 (Sun, 23 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

consistently move scenebrightness after contrastboost

------------------------------------------------------------------------
r7853 | divverent | 2007-12-23 13:17:50 -0800 (Sun, 23 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

the formula for fog was right... note that it uses the unsimplified formula, as precalculating stuff isn't needed here

------------------------------------------------------------------------
r7852 | divverent | 2007-12-23 12:54:18 -0800 (Sun, 23 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

fix fog help text

------------------------------------------------------------------------
r7851 | divverent | 2007-12-23 12:53:29 -0800 (Sun, 23 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix fog after r_restart

------------------------------------------------------------------------
r7850 | divverent | 2007-12-23 12:33:44 -0800 (Sun, 23 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c

add default for fog_end too

------------------------------------------------------------------------
r7849 | divverent | 2007-12-23 10:14:19 -0800 (Sun, 23 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

sorry, that one was wrong

------------------------------------------------------------------------
r7848 | divverent | 2007-12-23 09:57:02 -0800 (Sun, 23 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

fix wrong conversion factor of knots (Wikipedia has another opinion than feh on this)

------------------------------------------------------------------------
r7847 | divverent | 2007-12-23 09:08:21 -0800 (Sun, 23 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix remaining fog bug with fixed function, r_view.colorscale != 0

------------------------------------------------------------------------
r7846 | havoc | 2007-12-23 07:05:09 -0800 (Sun, 23 Dec 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

improved NaN velocity/NaN origin warnings, they now print the entity
number

------------------------------------------------------------------------
r7845 | havoc | 2007-12-23 06:57:52 -0800 (Sun, 23 Dec 2007) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_sky.c

colormod values above 1 1 1 should work properly with r_glsl now
some optimizations and a major audit of the GLSL shader with respect to
colormod and fog handling
fixed nearly all bad interactions between fog and r_hdr 1 mode

------------------------------------------------------------------------
r7844 | divverent | 2007-12-23 03:05:54 -0800 (Sun, 23 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

update movement_velocity in demos too

------------------------------------------------------------------------
r7843 | divverent | 2007-12-22 09:16:34 -0800 (Sat, 22 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

forgot to add fog_start to the fog range... now it behaves right

------------------------------------------------------------------------
r7842 | divverent | 2007-12-22 09:05:23 -0800 (Sat, 22 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/client.h

oops, forgot this file

------------------------------------------------------------------------
r7841 | divverent | 2007-12-22 08:55:05 -0800 (Sat, 22 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

forgot to compare fog mask table range, too

------------------------------------------------------------------------
r7840 | havoc | 2007-12-22 07:21:50 -0800 (Sat, 22 Dec 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_rmain.c

implemented fog texture building support for the new fog start and alpha
parameters

------------------------------------------------------------------------
r7839 | havoc | 2007-12-22 07:17:25 -0800 (Sat, 22 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_sky.c

fix fog_alpha checking bug that makes sky disappear in the wrong situation

------------------------------------------------------------------------
r7838 | divverent | 2007-12-22 05:50:39 -0800 (Sat, 22 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_sky.c

first part of fog changes: no longer use a complex glsl equation; modify the table instead; replace fog_end by fog_alpha

------------------------------------------------------------------------
r7837 | divverent | 2007-12-22 02:40:20 -0800 (Sat, 22 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

qups -> qu/s, in Nexuiz in/s

------------------------------------------------------------------------
r7836 | divverent | 2007-12-22 02:17:43 -0800 (Sat, 22 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt
   M /trunk/darkplaces/sbar.c

showspeed cvar ;)

------------------------------------------------------------------------
r7835 | divverent | 2007-12-22 01:34:52 -0800 (Sat, 22 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c

this may fix the word wrap issue, hopefully

------------------------------------------------------------------------
r7834 | havoc | 2007-12-21 19:05:34 -0800 (Fri, 21 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

fix sprintf for savegame comment to not overflow on long map titles

------------------------------------------------------------------------
r7833 | divverent | 2007-12-21 12:17:01 -0800 (Fri, 21 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cd_shared.c

only CDAudio_SysStop if a CD was actually playing (fixes error message spam)

------------------------------------------------------------------------
r7832 | divverent | 2007-12-21 06:00:52 -0800 (Fri, 21 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/svvm_cmds.c

make precache_sound return the sound index (for using WriteStuff to send a sound just to some clients)

------------------------------------------------------------------------
r7831 | havoc | 2007-12-21 03:05:56 -0800 (Fri, 21 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_shadow.c

move R_UpdateAllTextureInfo call back to DrawLight

------------------------------------------------------------------------
r7830 | havoc | 2007-12-21 03:05:34 -0800 (Fri, 21 Dec 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix bug in RSurf_ActiveWorldEntity (now sets basepolygonoffset fields)
added a fixme note

------------------------------------------------------------------------
r7829 | divverent | 2007-12-20 02:16:04 -0800 (Thu, 20 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

a fs_offset_t is a fs_offset_t is a fs_offset_t is a fs_offset_t and not a long

------------------------------------------------------------------------
r7828 | divverent | 2007-12-20 02:12:27 -0800 (Thu, 20 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c

tab completion for arbitrary commands (works, but interface may be subject to change, currently uses a cvar con_completion_playermodel "models/player/*.zym models/player/*.md3")

------------------------------------------------------------------------
r7827 | havoc | 2007-12-20 01:49:37 -0800 (Thu, 20 Dec 2007) | 6 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/render.h

reenabled R_UpdateAllTextureInfo calls when lighting the world model
(necessary because of submodel entities sharing texture_t's with the
world model)
some tweaks and cleanup of R_UpdateAllTextureInfo calls
reworked texture_t->currentpolygonoffset stuff

------------------------------------------------------------------------
r7826 | havoc | 2007-12-20 01:35:59 -0800 (Thu, 20 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_demo.c
   M /trunk/darkplaces/client.h

minor cleanup of timedemo code

------------------------------------------------------------------------
r7825 | havoc | 2007-12-19 23:32:29 -0800 (Wed, 19 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_demo.c

fix miscounting of timedemo frames on cold/warm runs in the same session

------------------------------------------------------------------------
r7824 | havoc | 2007-12-19 14:00:38 -0800 (Wed, 19 Dec 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c

fix a crash introduced in my BGRA commit (was providing no palette for a
texture)

------------------------------------------------------------------------
r7823 | res | 2007-12-18 15:34:54 -0800 (Tue, 18 Dec 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_draw.c

Marked some gl_draw.c tables as "static const"
------------------------------------------------------------------------
r7822 | res | 2007-12-18 15:31:38 -0800 (Tue, 18 Dec 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/r_sky.c

Marked some sky tables as "static const"
------------------------------------------------------------------------
r7821 | divverent | 2007-12-18 13:08:08 -0800 (Tue, 18 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/model_shared.c

add a CRC_Block_CaseInsensitive that tolowers its input for use by hash functions for case insensitive hash tables; make the shader system use it (fixes accidentally introduced case sensitivity by res2k)

------------------------------------------------------------------------
r7820 | divverent | 2007-12-18 05:47:31 -0800 (Tue, 18 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/svvm_cmds.c

print ""gettagindex(entity #%i): tag \"%s\" not found" console spam only if developer >= 100

------------------------------------------------------------------------
r7819 | havoc | 2007-12-18 01:32:24 -0800 (Tue, 18 Dec 2007) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/palette.c

moved entity_render_t modellight_* field updates from renderer to client
merged entity_render_t colormap_pantscolor and shirtcolor updates to a
single function called CL_SetEntityColormapColors
other little cleanups

------------------------------------------------------------------------
r7818 | havoc | 2007-12-18 00:45:02 -0800 (Tue, 18 Dec 2007) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/model_shared.c

moved Mod_LoadQ3Shaders() call from CL_BeginDownloads to Mod_LoadModel
(but only when isworldmodel is true, which indicates a level change)
this fixes a bug where downloaded maps have missing shaders on the first
load, and also fixes a crash introduced by res on dedicated servers

------------------------------------------------------------------------
r7817 | res | 2007-12-17 18:41:46 -0800 (Mon, 17 Dec 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_gecko.c

Gecko: set a profile path
------------------------------------------------------------------------
r7816 | black | 2007-12-17 13:50:03 -0800 (Mon, 17 Dec 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/protocol.c

Add full support for csqc's sensitivityscale (no clamping yet, so you can actually lock the view by setting it to 0).
Minor cleanups in the csqc (very very minor).
Change Key_Event a bit (and probably break it again :()
------------------------------------------------------------------------
r7815 | havoc | 2007-12-17 00:54:54 -0800 (Mon, 17 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c

remove basealpha checks in DrawQ_String_Font

------------------------------------------------------------------------
r7814 | havoc | 2007-12-17 00:51:45 -0800 (Mon, 17 Dec 2007) | 5 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

don't R_UpdateAllTextureInfo when doing shadows or lighting on world,
because its texture info only really needs to be updated once per frame,
it doesn't change because it is not instanced and can not have alternate
textures or colormod

------------------------------------------------------------------------
r7813 | divverent | 2007-12-17 00:21:08 -0800 (Mon, 17 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/draw.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/sbar.c

split up DrawQ_String_Font_UntilX in DrawQ_TextWidth_Font_TrackColors and DrawQ_String_Font; the latter no longer needs to check if the text is too long, and the former no longer needs alpha checks (to be removed later perhaps)

------------------------------------------------------------------------
r7812 | havoc | 2007-12-16 22:24:19 -0800 (Sun, 16 Dec 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

redesigned box clipping code in R_Shadow_ScissorForBBox, now clips edges
against the nearplane rather than doing brush building (too slow)

------------------------------------------------------------------------
r7811 | havoc | 2007-12-16 19:59:35 -0800 (Sun, 16 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

fix two warnings

------------------------------------------------------------------------
r7810 | res | 2007-12-16 19:58:51 -0800 (Sun, 16 Dec 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/zone.c

use strlcpy() instead of strcpy()
------------------------------------------------------------------------
r7809 | res | 2007-12-16 19:37:43 -0800 (Sun, 16 Dec 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/zone.c
   M /trunk/darkplaces/zone.h

Move Mem_strdup into zone.c
------------------------------------------------------------------------
r7808 | res | 2007-12-16 19:34:31 -0800 (Sun, 16 Dec 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/zone.h

Dynamically allocate Q3 shader texture frames.
------------------------------------------------------------------------
r7807 | res | 2007-12-16 19:04:48 -0800 (Sun, 16 Dec 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h

Dynamically allocate Q3 shader texture frames.
------------------------------------------------------------------------
r7806 | res | 2007-12-16 18:41:34 -0800 (Sun, 16 Dec 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_draw.c

Fixed user font initialization writing beyond fonts array bounds.
------------------------------------------------------------------------
r7805 | res | 2007-12-16 18:19:50 -0800 (Sun, 16 Dec 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/model_shared.c

Fix use of wrong pointer in Q3 shader hash add.
------------------------------------------------------------------------
r7804 | res | 2007-12-16 17:50:47 -0800 (Sun, 16 Dec 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h

Changed Q3 shaders to use dynamic memory allocation (instead of a gargantuan static array). Also changed the Q3 shader lookup to use a hash while I was at it.
------------------------------------------------------------------------
r7803 | black | 2007-12-16 15:00:57 -0800 (Sun, 16 Dec 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/svvm_cmds.c

Add getsurfacepointattribute to svqc and csqc (untested yet).
------------------------------------------------------------------------
r7801 | divverent | 2007-12-15 06:53:43 -0800 (Sat, 15 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.inc

changed DP_MODPLUG_STATIC_PREFIX to DP_MODPLUG_STATIC_LIBDIR (so it works on Fedora too, which has libs in /usr/lib64 instead). Now append the /lib or /lib64 to the path too. Includes are assumed to be in ../include relative to the LIBDIR given, but are also searched in any other usual -I path.

------------------------------------------------------------------------
r7800 | divverent | 2007-12-14 08:37:32 -0800 (Fri, 14 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cd_shared.c

make "cd remap" also support named tracks

------------------------------------------------------------------------
r7799 | divverent | 2007-12-14 08:22:07 -0800 (Fri, 14 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cd_shared.c

CDAudio_Stop: also stop a paused track (fixes bgmvolume 0 related segfault)

------------------------------------------------------------------------
r7798 | black | 2007-12-13 17:45:07 -0800 (Thu, 13 Dec 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_gecko.c
   M /trunk/darkplaces/cl_gecko.h

Move the code around a bit in cl_gecko and add the console command gecko_movecursor.
------------------------------------------------------------------------
r7797 | havoc | 2007-12-13 14:17:02 -0800 (Thu, 13 Dec 2007) | 5 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fix detection of q3map2 deluxemapping in the case of one referenced but
4 existing in the bsp file (lightmap deluxemap blank blank), a variant
of the existing problem with 2 existing in a non-deluxemapped bsp (which
are lightmap blank)

------------------------------------------------------------------------
r7796 | divverent | 2007-12-13 14:02:38 -0800 (Thu, 13 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/makefile.inc

modplug improvement: DP_MODPLUG_STATIC_PREFIX=/usr/local makes it use the modplug installed in /usr/local statically

------------------------------------------------------------------------
r7795 | havoc | 2007-12-13 12:02:24 -0800 (Thu, 13 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

added gl_vbo 2 mode to test performance of vertex buffers without element buffers

------------------------------------------------------------------------
r7794 | havoc | 2007-12-13 08:33:57 -0800 (Thu, 13 Dec 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/makefile.inc

added -lmodplug if libmodplug.a is detected, and a corresponding #define
to tell the code about this linkage, openSUSE 10.3 does not include
libmodplug.so so this is sadly necessary

------------------------------------------------------------------------
r7793 | divverent | 2007-12-13 08:07:07 -0800 (Thu, 13 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_modplug.c

oops, should use <>, not ""

------------------------------------------------------------------------
r7792 | divverent | 2007-12-13 08:06:35 -0800 (Thu, 13 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_modplug.c

support the upcoming -DSND_MODPLUG_STATIC flag

------------------------------------------------------------------------
r7791 | divverent | 2007-12-13 07:49:20 -0800 (Thu, 13 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c

oops, forgot to include snd_modplug.h here

------------------------------------------------------------------------
r7790 | divverent | 2007-12-13 07:23:14 -0800 (Thu, 13 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cd_shared.c
   M /trunk/darkplaces/makefile.inc
   M /trunk/darkplaces/snd_mem.c

minor improvement to modplug (now cd loop 1 also would load a mod/it/xm/s3m/... file named track001 (without extension).

------------------------------------------------------------------------
r7789 | divverent | 2007-12-12 13:01:08 -0800 (Wed, 12 Dec 2007) | 2 lines
Changed paths:
   A /trunk/darkplaces/snd_modplug.h

oops... forgot this file, sorry

------------------------------------------------------------------------
r7788 | divverent | 2007-12-12 11:55:17 -0800 (Wed, 12 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cd_shared.c
   M /trunk/darkplaces/makefile.inc
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_mem.c
   A /trunk/darkplaces/snd_modplug.c

Add support for libmodplug (when found). Sound files with an extension are now all eligible for modplug, if neither vorbis nor wav recognizes them. CD tracks now try to append the .wav and .ogg extension first, and if that fails, the file name is used as is - but tracker extensions need to be explicitly stated. Example: "cd loop Ending.umx"

------------------------------------------------------------------------
r7787 | res | 2007-12-12 11:28:44 -0800 (Wed, 12 Dec 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_gecko.c

Gecko: forward mouse wheel input
------------------------------------------------------------------------
r7786 | res | 2007-12-11 16:08:17 -0800 (Tue, 11 Dec 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_gecko.c
   M /trunk/darkplaces/cl_gecko.h
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.h
   M /trunk/darkplaces/r_textures.h

Gecko resizing support
------------------------------------------------------------------------
r7785 | divverent | 2007-12-11 00:19:46 -0800 (Tue, 11 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

now really fix fog + HDR

------------------------------------------------------------------------
r7784 | divverent | 2007-12-11 00:03:24 -0800 (Tue, 11 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_sky.c

oops... fog is now colorscaled, so handle this correctly. Now fog + HDR works again.

------------------------------------------------------------------------
r7783 | black | 2007-12-09 16:04:37 -0800 (Sun, 09 Dec 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_gecko.c

Meh, stupid bug in cl_gecko. Sorry about that :-(
------------------------------------------------------------------------
r7782 | divverent | 2007-12-09 14:44:24 -0800 (Sun, 09 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cmd.c

CMDBUFSIZE increased to 128k. Hopefully it's enough this time.

------------------------------------------------------------------------
r7781 | divverent | 2007-12-09 12:59:57 -0800 (Sun, 09 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/darkplaces.txt
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_sky.c

fog gets additional parameters mindist and maxdist that specify where fog "starts" and "ends"; sky is only fogged as if it were distance "maxdist" away (example: fog 1 0.5 1 0 0 1 gives a slight greenish haze like a view tint)

------------------------------------------------------------------------
r7780 | divverent | 2007-12-08 01:51:10 -0800 (Sat, 08 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

making fog consistent with skybox fog when HDR, scenebrightness or contrastboost are involved

------------------------------------------------------------------------
r7779 | havoc | 2007-12-08 00:04:26 -0800 (Sat, 08 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

color r_shownromals white at the tips

------------------------------------------------------------------------
r7778 | havoc | 2007-12-07 23:32:19 -0800 (Fri, 07 Dec 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

made r_shownormals value control the length of the vectors shown, rather
than opacity, this also reduces the length by 8x compared to the
previous code

------------------------------------------------------------------------
r7777 | havoc | 2007-12-07 13:59:40 -0800 (Fri, 07 Dec 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix fog, it now matches GL_EXP2 fog as it was meant to (this makes
Nehahra look correct, which it hasn't for years)

------------------------------------------------------------------------
r7776 | res | 2007-12-07 01:18:34 -0800 (Fri, 07 Dec 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/sys_win.c

Changed Win32 console logic to only allocate a console when a dedicated server.
------------------------------------------------------------------------
r7775 | res | 2007-12-06 12:42:48 -0800 (Thu, 06 Dec 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/model_brush.c

Changed Q1 lightmap packing to put consecutive surfaces onto the same lightmap again.
------------------------------------------------------------------------
r7774 | havoc | 2007-12-06 09:32:45 -0800 (Thu, 06 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/mathlib.c
   M /trunk/darkplaces/mathlib.h
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/svvm_cmds.c

added DP_QC_VECTOANGLES_WITH_ROLL

------------------------------------------------------------------------
r7772 | black | 2007-12-06 09:12:10 -0800 (Thu, 06 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_gecko.c
   M /trunk/darkplaces/prvm_cmds.c

Fix a bug - tbh I dont understand why the other menu control worked at all yesterday :o

------------------------------------------------------------------------
r7771 | havoc | 2007-12-06 08:32:41 -0800 (Thu, 06 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix mistakes in the fix for the previous mistakes in default.glsl

------------------------------------------------------------------------
r7770 | havoc | 2007-12-06 07:55:58 -0800 (Thu, 06 Dec 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix two mistakes in glsl/default.glsl deluxemapping paths which broke on
ATI

------------------------------------------------------------------------
r7769 | black | 2007-12-06 05:52:53 -0800 (Thu, 06 Dec 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_dyntexture.c
   M /trunk/darkplaces/cl_gecko.c
   M /trunk/darkplaces/cl_gecko.h
   M /trunk/darkplaces/cl_video.h
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_cmds.c

Remove unused MP_Fallback from menu.c.
Add DP_GECKO_SUPPORT to the menu's extension string.
Automatically destroy gecko instances on restart.
Change the gecko builtins to take the full texture path always.
------------------------------------------------------------------------
r7768 | res | 2007-12-06 04:57:32 -0800 (Thu, 06 Dec 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/model_brush.c

Made Q1 face loading faster by using a faster lightmap packing algorithm.
------------------------------------------------------------------------
r7767 | res | 2007-12-05 21:19:25 -0800 (Wed, 05 Dec 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_textures.c

Changed R_Upload() to not allocate memory for a texture when a NULL texture data pointer is given. GL should cope with a NULL texture data pointer just fine, and it's slightly faster.
------------------------------------------------------------------------
r7766 | res | 2007-12-05 15:23:00 -0800 (Wed, 05 Dec 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_gecko.c

Lazily initialize Gecko - saves initialization when not used.
------------------------------------------------------------------------
r7765 | res | 2007-12-05 15:22:13 -0800 (Wed, 05 Dec 2007) | 1 line
Changed paths:
   A /trunk/darkplaces/timing.h

Add helper header to simplify measuring time spent in a block or statement.
------------------------------------------------------------------------
r7764 | res | 2007-12-05 15:21:08 -0800 (Wed, 05 Dec 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/sys_win.c

Changed Win32 code to also support compilation of the executable for the console subsystem.
------------------------------------------------------------------------
r7763 | black | 2007-12-05 14:02:42 -0800 (Wed, 05 Dec 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

Add the gecko builtins to csqc, too. (#ifdefed again)
------------------------------------------------------------------------
r7760 | black | 2007-12-03 07:04:04 -0800 (Mon, 03 Dec 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.h
   M /trunk/darkplaces/prvm_edict.c

Remove the NG_MENU additions as it has never really been used.
Remove unused code from progs.h.
Add gecko qc builtins (only for the menu right now).
They are untested though.
------------------------------------------------------------------------
r7759 | havoc | 2007-12-03 03:57:09 -0800 (Mon, 03 Dec 2007) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/r_shadow.c

added r_refdef.rtlightstylevalue which is a float version of the normal
lightstylevalue array, but this one is always interpolated (lightstyle
interpolation does not harm rtworld performance)
cleaned up Q1BSP LightPoint code

------------------------------------------------------------------------
r7758 | havoc | 2007-12-03 03:50:15 -0800 (Mon, 03 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix crash on entities with missing models (bug introduced by div0)

------------------------------------------------------------------------
r7757 | havoc | 2007-12-03 02:49:24 -0800 (Mon, 03 Dec 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c

reverted texel nudging code that was committed by divverent and credited
to Black, this was making all pics blurry in Quake (particularly the
crosshairs)

------------------------------------------------------------------------
r7756 | havoc | 2007-12-03 02:47:57 -0800 (Mon, 03 Dec 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/darkplaces-dedicated.dsp
   M /trunk/darkplaces/darkplaces-sdl.dsp
   M /trunk/darkplaces/darkplaces.dsp
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/makefile.inc
   M /trunk/darkplaces/palette.c
   M /trunk/darkplaces/palette.h
   D /trunk/darkplaces/r_light.c
   D /trunk/darkplaces/r_light.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/sbar.c

the light has been defeated by the shadow (r_light moved into r_shadow)
overhauled gl_draw.c draw_generate* code and embedded images
cleaned up and improved r_editlights light sprite handling

------------------------------------------------------------------------
r7755 | havoc | 2007-12-02 21:20:47 -0800 (Sun, 02 Dec 2007) | 5 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fixed bug that made r_water reflections use the wrong pvs origin, they
were using the r_view.origin rather than the surface center
changed r_water reflection surface center calculations to use bbox
instead of vertices to make the results more consistent

------------------------------------------------------------------------
r7754 | black | 2007-12-02 15:03:04 -0800 (Sun, 02 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_gecko.c
   M /trunk/darkplaces/cl_gecko.h
   M /trunk/darkplaces/keys.h

"Finish" cl_gecko.c (input handling is done now, too) for now. I need to update to a new offscreengecko release soon though..
I've also added a console command for text injection into a gecko browser.
------------------------------------------------------------------------
r7753 | divverent | 2007-12-02 14:56:48 -0800 (Sun, 02 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/mvm_cmds.c

add DP_FONT_VARIABLEWIDTH to menu extensions list; later plan: find a builtin number for it and add it to CSQC too

------------------------------------------------------------------------
r7749 | havoc | 2007-12-02 08:51:51 -0800 (Sun, 02 Dec 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/render.h

changed r_speeds 2 and 3 reports to only list time spent during a single
view render, no longer reports time spent on non-rendering stuff, this
makes the report easier to read (although it does have disadvantages)

------------------------------------------------------------------------
r7748 | havoc | 2007-12-02 08:49:17 -0800 (Sun, 02 Dec 2007) | 6 lines
Changed paths:
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/netconn.h

removed all but ocrana qw master as the rest were not responding
added 4 other qw masters from the quakeservers.net website
added player count on server browser
fixed bug in server browser that always showed number of players in red
(because numhumans was not being set by qw server query code)

------------------------------------------------------------------------
r7747 | havoc | 2007-12-02 05:33:08 -0800 (Sun, 02 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix r_waterscroll

------------------------------------------------------------------------
r7746 | havoc | 2007-12-02 02:03:46 -0800 (Sun, 02 Dec 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/render.h

added r_lerplightstyles cvar which now defaults off for performance
reasons (lightmap updates caused by the small adjustments in
interpolation eat 50-75% of framerate when little else is going on)

------------------------------------------------------------------------
r7745 | havoc | 2007-12-02 01:59:49 -0800 (Sun, 02 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_rsurf.c

r_speeds now shows number of lightmap updates (and pixels) each frame

------------------------------------------------------------------------
r7744 | havoc | 2007-12-02 01:55:26 -0800 (Sun, 02 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

added r_speeds 3 mode which does not use glFinish

------------------------------------------------------------------------
r7743 | havoc | 2007-12-02 01:49:30 -0800 (Sun, 02 Dec 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h

reworked lightstyle chains code to use a struct, and combine allocations
for all submodels of world (to reduce memory overhead), this also
cleaned up the code somewhat

------------------------------------------------------------------------
r7742 | havoc | 2007-12-01 22:17:19 -0800 (Sat, 01 Dec 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/sv_main.c

changed default value of sv_fixedframeratesingleplayer to 1, and default
sys_ticrate from 0.05 (20fps) to 0.0138889 (72fps)

------------------------------------------------------------------------
r7741 | havoc | 2007-12-01 20:07:37 -0800 (Sat, 01 Dec 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sv_user.c

renamed sv_gameplayfix_qwplayerphysics to sv_gameplayfix_easierwaterjump
and removed the bunnyhopping enhancement for low framerates (as QW does
not have this enhancement, and simply relies on high framerate instead)

------------------------------------------------------------------------
r7740 | sajt | 2007-12-01 17:25:31 -0800 (Sat, 01 Dec 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_draw.c

fix warning - this is still C, remember :)
------------------------------------------------------------------------
r7739 | divverent | 2007-12-01 06:29:38 -0800 (Sat, 01 Dec 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/darkplaces.txt
   M /trunk/darkplaces/draw.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/sbar.c

the big chat area/font patch... hope it works well. Tested in Nexuiz and Quake. Fonts and a font generator for it will follow. Font specification is: a TGA as usual, and a .width file defining all character widths (first line is character spacing, then width of 0, of 1, of 2, of 3, ..., of 65 == "A", ..., of 255). An existing font is in Nexuiz svn as gfx/font_user0

------------------------------------------------------------------------
r7738 | divverent | 2007-11-29 13:48:27 -0800 (Thu, 29 Nov 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_sprite.c

an x for an i... fixed (this bug made sprites disappear completely)

------------------------------------------------------------------------
r7737 | black | 2007-11-29 12:45:19 -0800 (Thu, 29 Nov 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_gecko.c
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/r_textures.h

Add TEXF_PERSISTENT and R_PurgeTexture which only frees textures if that flag isn't set. Changed the SkinFrame purging code accordingly (and the default texture creation calls).
Fixed a bug that caused dynamic textures not to survive map switches (LoadExternal would try to load pixel data because ->base was set to NULL - it now restores the pointer in SkinFrame_Find..)
------------------------------------------------------------------------
r7736 | divverent | 2007-11-29 08:24:00 -0800 (Thu, 29 Nov 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

fix access to shirt/pants palettes (they no longer have alpha!)

------------------------------------------------------------------------
r7735 | havoc | 2007-11-28 22:18:44 -0800 (Wed, 28 Nov 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/image_png.c

swizzle RGBA to BGRA in png loader

------------------------------------------------------------------------
r7734 | havoc | 2007-11-28 04:42:11 -0800 (Wed, 28 Nov 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

improved performance of dlight triangle batching in R_Q1BSP_DrawLight

------------------------------------------------------------------------
r7733 | havoc | 2007-11-28 04:38:54 -0800 (Wed, 28 Nov 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/r_shadow.c

patch from VorteX which makes r_editlights mode use different icons for
lights based on their attributes (such as shadowcasting, cubemap, etc)

------------------------------------------------------------------------
r7732 | havoc | 2007-11-28 03:19:00 -0800 (Wed, 28 Nov 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_shared.h

precalculate texture vectors on mdl/md2/md3 models, this improves
rendering performance with rtlights or q3bsp lightgrid

------------------------------------------------------------------------
r7731 | havoc | 2007-11-28 02:57:12 -0800 (Wed, 28 Nov 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

small optimization to use of texture_t->currenttexmatrix (no longer
setting it to identitymatrix when there are no tcmods, because
uninitialized matrices are optimized more in the backend than identity)

------------------------------------------------------------------------
r7730 | sajt | 2007-11-27 23:19:18 -0800 (Tue, 27 Nov 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_textures.c

fix warning
------------------------------------------------------------------------
r7729 | havoc | 2007-11-27 23:10:48 -0800 (Tue, 27 Nov 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/image.c

fix a mistake in the recent commit

------------------------------------------------------------------------
r7728 | havoc | 2007-11-27 23:03:10 -0800 (Tue, 27 Nov 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/vid_sdl.c

reverted code that used vid_grabkeyboard for SDL input grabbing, because
this allowed the mouse to leave the window which is unacceptable

------------------------------------------------------------------------
r7727 | havoc | 2007-11-27 22:56:32 -0800 (Tue, 27 Nov 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

patch from VorteX that makes GAME_DELUXEQUAKE mode reset a cvar in the
Map command

------------------------------------------------------------------------
r7726 | havoc | 2007-11-27 22:46:25 -0800 (Tue, 27 Nov 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/sbar.c

patch from VorteX which removes special menu behavior for
GAME_NETHERWORLD, and replaces GAME_NETHERWORLD with GAME_DELUXEQUAKE

------------------------------------------------------------------------
r7725 | havoc | 2007-11-27 21:22:48 -0800 (Tue, 27 Nov 2007) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/image.h
   M /trunk/darkplaces/image_png.c
   M /trunk/darkplaces/image_png.h
   M /trunk/darkplaces/jpeg.c
   M /trunk/darkplaces/jpeg.h
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_sprite.c
   M /trunk/darkplaces/palette.c
   M /trunk/darkplaces/palette.h
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_lightning.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/r_textures.h
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/sbar.c
   M /trunk/darkplaces/wad.c
   M /trunk/darkplaces/wad.h

changed texture formats from RGBA to BGRA, yes this is a massive change,
aimed solely at reducing load times, but it failed at that.
this contains several cleanups, and shouldn't reduce performance on any
hardware, so it still goes in.

------------------------------------------------------------------------
r7724 | havoc | 2007-11-27 20:05:33 -0800 (Tue, 27 Nov 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_dyntexture.h
   M /trunk/darkplaces/cl_gecko.h
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/gl_textures.c

fix warnings

------------------------------------------------------------------------
r7723 | havoc | 2007-11-27 20:02:30 -0800 (Tue, 27 Nov 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.inc

add cl_dyntexture.o to makefile

------------------------------------------------------------------------
r7722 | sajt | 2007-11-27 15:22:26 -0800 (Tue, 27 Nov 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/darkplaces.dsp

updated msvc6 project file
fixed some errors when compiling on windows
------------------------------------------------------------------------
r7721 | sajt | 2007-11-27 15:12:12 -0800 (Tue, 27 Nov 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_gecko.c

I believe this is what you meant... by the way, you're crazy
------------------------------------------------------------------------
r7720 | black | 2007-11-27 14:53:42 -0800 (Tue, 27 Nov 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_gecko.c

Use BGRA >_>
------------------------------------------------------------------------
r7719 | black | 2007-11-27 14:39:46 -0800 (Tue, 27 Nov 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/gl_textures.c

Woops - use -1 to mark dirty textures!
------------------------------------------------------------------------
r7718 | black | 2007-11-27 14:26:56 -0800 (Tue, 27 Nov 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_dyntexture.c
   M /trunk/darkplaces/cl_dyntexture.h
   A /trunk/darkplaces/cl_gecko.c
   A /trunk/darkplaces/cl_gecko.h
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/cl_video.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/r_textures.h
   M /trunk/darkplaces/render.h

Rework cl_video to use dyntextures.
Add cl_gecko (needs SUPPORT_GECKO to be activated).
Fix r_replacemaptexture and make it use matchpattern to replace multiple textures at once.
------------------------------------------------------------------------
r7717 | havoc | 2007-11-26 14:05:56 -0800 (Mon, 26 Nov 2007) | 6 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/r_textures.h

added support for TEXTYPE_BGRA (GL_BGRA format), this doesn't require
any difference in processing functions, but the initial data must be
encoded accordingly
this format was added because it uploads faster on some hardware, and
the engine will be migrating over to using it

------------------------------------------------------------------------
r7716 | havoc | 2007-11-26 13:54:11 -0800 (Mon, 26 Nov 2007) | 5 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/image.h
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_textures.h

removed support for TEXTYPE_RGB
renamed Image_Resample to Image_Resample32 and removed bpp param
renamed Image_MipReduce to Image_MipReduce32 and removed bpp param
changed q3bsp lightmap loader to convert to 32bit before upload

------------------------------------------------------------------------
r7715 | havoc | 2007-11-23 23:40:11 -0800 (Fri, 23 Nov 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

patch from Mario Schlack which fixes csqc precache_model

------------------------------------------------------------------------
r7714 | havoc | 2007-11-23 19:10:19 -0800 (Fri, 23 Nov 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/cd_shared.c

don't start up CD audio if -nocdaudio is given on commandline - it was
already not being initialized, but it was being started

------------------------------------------------------------------------
r7713 | black | 2007-11-22 16:26:10 -0800 (Thu, 22 Nov 2007) | 4 lines
Changed paths:
   A /trunk/darkplaces/cl_dyntexture.c
   A /trunk/darkplaces/cl_dyntexture.h

Add cl_dyntexture.h and .c (don't need to be added to the makefile or vc project yet). They expose a simple interface to manage dynamic textures.
It supports getting the current texture handle for a dynamic texture path, linking a dynamic texture path to a texture handle and unlinking a dynamic texture path.
This is pretty transparent and it could be used for arbitrary dynamic textures (even ones that aren't updated but only linked dynamically into the game world - alias texture names).
This works for both skinframes and cachepics. Still contains lots of todos.
------------------------------------------------------------------------
r7712 | divverent | 2007-11-22 14:23:48 -0800 (Thu, 22 Nov 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

botclients don't set spawned... so fix the -666 for Nexuiz downloaders feature to not show botclients as -666 frags

------------------------------------------------------------------------
r7711 | black | 2007-11-21 16:06:00 -0800 (Wed, 21 Nov 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/r_textures.h

Add support for dynamic textures to the low-level texture handler.
Use R_MakeTextureDynamic to make a standard texture dynamic and set its update callback, etc. and use R_MarkDirtyTexture to mark it dirty (ie. needs an update as soon as it is used again).
------------------------------------------------------------------------
r7710 | havoc | 2007-11-20 16:43:02 -0800 (Tue, 20 Nov 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/lhnet.c
   M /trunk/darkplaces/lhnet.h

fix some warnings

------------------------------------------------------------------------
r7709 | havoc | 2007-11-20 15:04:41 -0800 (Tue, 20 Nov 2007) | 5 lines
Changed paths:
   M /trunk/darkplaces/r_lightning.c

don't call lightning beam vertex fogging code BEFORE the vertex data is
initialized (this was causing crashes due to highly bogus numbers)
this bug came from refactoring the lightning beam code to be able to
render multiple beams in one transparent callback

------------------------------------------------------------------------
r7708 | havoc | 2007-11-20 12:43:35 -0800 (Tue, 20 Nov 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

changed FogPoint_World/Model code to use unsigned int instead of signed
int, this fixes a crash reported by Andreas Dehmel in certain quoth
maps, I have no idea how coordinates can be negative though

------------------------------------------------------------------------
r7707 | havoc | 2007-11-18 11:11:43 -0800 (Sun, 18 Nov 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/lhnet.h

fix an unsigned/signed comparison warning on lhnetsocket_t.inetsocket

------------------------------------------------------------------------
r7706 | havoc | 2007-11-18 10:33:32 -0800 (Sun, 18 Nov 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/vid_sdl.c

make vid_sdl compile on WIN32 again (it uses different icon code on
WIN32 and wasn't declaring an empty VID_SetIcon implementation)

------------------------------------------------------------------------
r7702 | havoc | 2007-11-18 05:51:18 -0800 (Sun, 18 Nov 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/todo

fix bug with loading a saved game while a demo is playing (such as the
demo loop when Quake starts up), thanks to Bill Pickett for giving a
clear and concise description of the problem

------------------------------------------------------------------------
r7701 | divverent | 2007-11-17 03:42:23 -0800 (Sat, 17 Nov 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/filematch.c

use strcasecmp for file name sorting

------------------------------------------------------------------------
r7700 | divverent | 2007-11-15 11:26:05 -0800 (Thu, 15 Nov 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/mvm_cmds.c

sorry, I can't live without strstrofs

------------------------------------------------------------------------
r7699 | divverent | 2007-11-15 07:54:32 -0800 (Thu, 15 Nov 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/mvm_cmds.c

add missing str*cmp builtins to mvm_cmds.c

------------------------------------------------------------------------
r7698 | divverent | 2007-11-15 07:07:16 -0800 (Thu, 15 Nov 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

fix tempstring allocation bug in VM_tokenize*

------------------------------------------------------------------------
r7697 | divverent | 2007-11-13 12:25:53 -0800 (Tue, 13 Nov 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_sdl.c

SDL icon support by Blub, messed up by me ;)

------------------------------------------------------------------------
r7696 | havoc | 2007-11-13 07:31:53 -0800 (Tue, 13 Nov 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/client.h

removed cl_particles_explosions_smoke cvar and code

------------------------------------------------------------------------
r7695 | havoc | 2007-11-13 07:30:55 -0800 (Tue, 13 Nov 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_particles.c

changed default value of cl_stainmaps to 0 (was 1)
changed default values of cl_decals to 1 (was 0), cl_decals_time to 20 (was 0), and
cl_decals_fadetime to 1 (was 20)

------------------------------------------------------------------------
r7694 | havoc | 2007-11-13 07:28:54 -0800 (Tue, 13 Nov 2007) | 6 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/render.h

added separate world surfaces and world triangles stats counters for
r_speeds display, cleaned up some incorrect stat increments
split particle system into particles and decals, this got a nice speed
gain due to smaller structs involved
increased blood alpha substantially

------------------------------------------------------------------------
r7693 | havoc | 2007-11-12 17:59:09 -0800 (Mon, 12 Nov 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/netconn.c

changed two memcpy calls to memmove after testing in valgrind (no other
errors found, and these are in original Quake code)

------------------------------------------------------------------------
r7692 | divverent | 2007-11-12 07:13:50 -0800 (Mon, 12 Nov 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_sdl.c

need to include quakedef.h later in the other vid_ files too. Damn glquake.h.

------------------------------------------------------------------------
r7691 | divverent | 2007-11-12 06:59:13 -0800 (Mon, 12 Nov 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_agl.c

can't move quakedef.h up in vid_agl.c (redefinition of OpenGL stuff)

------------------------------------------------------------------------
r7690 | divverent | 2007-11-12 06:37:32 -0800 (Mon, 12 Nov 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.h

add missing extern keyword

------------------------------------------------------------------------
r7689 | divverent | 2007-11-12 06:28:40 -0800 (Mon, 12 Nov 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cd_bsd.c
   M /trunk/darkplaces/cd_linux.c
   M /trunk/darkplaces/cd_win.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/conproc.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/curves.c
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/lhnet.c
   M /trunk/darkplaces/mathlib.c
   M /trunk/darkplaces/matrixlib.c
   M /trunk/darkplaces/mdfour.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/menu.h
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/polygon.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/snd_alsa.c
   M /trunk/darkplaces/snd_bsd.c
   M /trunk/darkplaces/snd_coreaudio.c
   M /trunk/darkplaces/snd_oss.c
   M /trunk/darkplaces/snd_sdl.c
   M /trunk/darkplaces/svbsp.c
   M /trunk/darkplaces/svvm_cmds.c
   M /trunk/darkplaces/sys_linux.c
   M /trunk/darkplaces/sys_sdl.c
   M /trunk/darkplaces/vid_agl.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_null.c
   M /trunk/darkplaces/vid_sdl.c

move two #defined to quakedef.h, and always include quakedef.h first before any other includes, even system headers. This is to make compilation with gcc -combine work. Also, fix some type mismatches between source files.

------------------------------------------------------------------------
r7688 | havoc | 2007-11-12 05:06:59 -0800 (Mon, 12 Nov 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/cl_screen.h
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/todo

optimized SHOWLMP code (only used by Nehahra) to not eat any CPU time
anymore

------------------------------------------------------------------------
r7687 | havoc | 2007-11-12 02:47:01 -0800 (Mon, 12 Nov 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/sys.h
   M /trunk/darkplaces/sys_shared.c

implemented a -profilegameonly commandline option for profile builds on
Linux/FreeBSD (others can be added if they have the moncontrol function)

------------------------------------------------------------------------
r7686 | havoc | 2007-11-12 02:45:37 -0800 (Mon, 12 Nov 2007) | 5 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/render.h

added a non-diffuse non-specular path for model lighting in the GLSL
shader, this fixes a bug that caused the engine to generate normals and
tangents for every model in q1bsp maps unnecessarily because of an
incorrect need for a normalmap

------------------------------------------------------------------------
r7685 | divverent | 2007-11-12 00:21:33 -0800 (Mon, 12 Nov 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/image.h
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/r_lightning.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_sky.c

added cvar r_fixtrans_auto to automatically call fixtrans on all textures that are loaded

------------------------------------------------------------------------
r7684 | havoc | 2007-11-11 18:22:53 -0800 (Sun, 11 Nov 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_rmain.c

avoid one viewclear each frame

------------------------------------------------------------------------
r7683 | havoc | 2007-11-11 18:07:28 -0800 (Sun, 11 Nov 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/netconn.h

fix SLIF_FREESLOTS to not be an out of bounds array access
hush an entry may be used uninitialized warning

------------------------------------------------------------------------
r7682 | havoc | 2007-11-11 17:54:14 -0800 (Sun, 11 Nov 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/gl_rmain.c

renamed a few r_speeds 2 timereport values to reduce confusion

------------------------------------------------------------------------
r7681 | divverent | 2007-11-10 04:00:36 -0800 (Sat, 10 Nov 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c

support vid_resizable in glx

------------------------------------------------------------------------
r7680 | divverent | 2007-11-10 01:34:18 -0800 (Sat, 10 Nov 2007) | 2 lines
Changed paths:
   A /trunk/darkplaces/darkplaces.xpm
   M /trunk/darkplaces/makefile.inc
   A /trunk/darkplaces/nexuiz.xpm
   M /trunk/darkplaces/vid_glx.c

XPM support for X11; WM_CLASS and WM_COMMAND are now set too

------------------------------------------------------------------------
r7679 | divverent | 2007-11-09 14:44:05 -0800 (Fri, 09 Nov 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

remove timed out servers from list

------------------------------------------------------------------------
r7678 | divverent | 2007-11-09 14:36:43 -0800 (Fri, 09 Nov 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

querycounters LOVE to be reset ;)

------------------------------------------------------------------------
r7677 | divverent | 2007-11-09 13:36:54 -0800 (Fri, 09 Nov 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_shared.c

update Blub's SDL patch

------------------------------------------------------------------------
r7676 | havoc | 2007-11-09 13:22:11 -0800 (Fri, 09 Nov 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

fix two warnings

------------------------------------------------------------------------
r7675 | havoc | 2007-11-09 13:19:17 -0800 (Fri, 09 Nov 2007) | 5 lines
Changed paths:
   M /trunk/darkplaces/host.c

increased minimum cl_maxfps value from 1 to 5 (but removed the value
changing code)
implemented minimum cl_maxidlefps value of 5
tweaked code that snaps very small or negative values of slowmo to 0

------------------------------------------------------------------------
r7674 | divverent | 2007-11-09 07:39:24 -0800 (Fri, 09 Nov 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

add Nexuiz-only cvar sbar_flagstatus_right (preparation for chat area + font patch)

------------------------------------------------------------------------
r7673 | divverent | 2007-11-09 07:16:30 -0800 (Fri, 09 Nov 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/image.c

make fixtrans use patterns instead, for batch fixing

------------------------------------------------------------------------
r7672 | divverent | 2007-11-09 07:03:13 -0800 (Fri, 09 Nov 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/image.h

add new console command "fixtrans", usage: fixtrans gfx/foo.tga - writes a new fixtrans/gfx/foo.tga with alpha-zero pixels changed to values around them. Helps with weird seams on badly made transparent images.

------------------------------------------------------------------------
r7671 | divverent | 2007-11-09 05:57:58 -0800 (Fri, 09 Nov 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_sprites.c
   M /trunk/darkplaces/view.c

add Blub's r_track_sprites for SPR_LABEL*

------------------------------------------------------------------------
r7670 | divverent | 2007-11-09 05:45:53 -0800 (Fri, 09 Nov 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/keys.c

Blub's nick completion

------------------------------------------------------------------------
r7669 | divverent | 2007-11-09 05:34:34 -0800 (Fri, 09 Nov 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/fs.h

Win32 largefile support (mostly for capturevideo)

------------------------------------------------------------------------
r7668 | divverent | 2007-11-09 05:33:44 -0800 (Fri, 09 Nov 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

add cvar cl_movement_track_canjump (when off, client prediction allows "pogoing" by holding the jump key all the time; this also seems to behave better than the current behaviour which too often sticks you to the floor)

------------------------------------------------------------------------
r7667 | divverent | 2007-11-09 05:25:10 -0800 (Fri, 09 Nov 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

(Nexuiz) show people who are still downloading as -666 (like spectators) in scoreboard. Should get replaced by some way to completely hide them from scoreboard, but still show them in status, ping etc.

------------------------------------------------------------------------
r7666 | divverent | 2007-11-09 05:23:35 -0800 (Fri, 09 Nov 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_sdl.c

SDL: parameters -resizable, -stick_mouse, -no_input_grabbing (Blub)

------------------------------------------------------------------------
r7665 | divverent | 2007-11-09 03:56:32 -0800 (Fri, 09 Nov 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

watch your memory :)

------------------------------------------------------------------------
r7664 | havoc | 2007-11-08 13:47:50 -0800 (Thu, 08 Nov 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_shared.c

hush a bogus warning on startup on pre-OpenGL 2.0 drivers

------------------------------------------------------------------------
r7663 | black | 2007-11-08 12:50:42 -0800 (Thu, 08 Nov 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/netconn.h

Clean-up the refresh code and remove the refresh field from serverlist_entry_t again (use a new query state instead).
------------------------------------------------------------------------
r7662 | black | 2007-11-08 12:23:50 -0800 (Thu, 08 Nov 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/netconn.h

- add support for server list refreshes to netconn (more refactoring will follow soon)
- change MQC's refreshserverlist builtin to refresh the serverlist by default (which actually does what the function name implies)
- also add a console command but it is kinda useless (except that it is probably faster because it doesnt wait for the master server's response to start querying)
------------------------------------------------------------------------
r7661 | divverent | 2007-11-05 05:39:06 -0800 (Mon, 05 Nov 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/netconn.h

add a "freeslots" field to the host cache

------------------------------------------------------------------------
r7660 | havoc | 2007-11-02 07:23:09 -0700 (Fri, 02 Nov 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

shorten the "watervisibility" title in r_speeds 2 mode because it is
messing up alignment of the remaining columns

------------------------------------------------------------------------
r7659 | divverent | 2007-10-31 02:01:25 -0700 (Wed, 31 Oct 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.inc

move SDLMain.m to the right place

------------------------------------------------------------------------
r7658 | divverent | 2007-10-31 01:54:22 -0700 (Wed, 31 Oct 2007) | 2 lines
Changed paths:
   A /trunk/darkplaces/SDLMain.h
   A /trunk/darkplaces/SDLMain.m
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/makefile.inc

add SDLMain stuff for OS X; make the Makefiles ready for OS X cross compilation (note: OS X doesn't use sdl-config)

------------------------------------------------------------------------
r7657 | divverent | 2007-10-31 01:11:27 -0700 (Wed, 31 Oct 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.inc

make STRIP a specifyable option in the Makefile

------------------------------------------------------------------------
r7656 | havoc | 2007-10-30 10:27:19 -0700 (Tue, 30 Oct 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

some reworking and cleanup of gravity handling in particles, this fixes
a bug with blood rarely sticking to surfaces (due to delayedcollisions),
the same bug also affected gib trails but was less noticable

------------------------------------------------------------------------
r7655 | divverent | 2007-10-27 05:40:28 -0700 (Sat, 27 Oct 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.h

add menu QC drawsubpic() to draw just part of an image; revert change to DrawQ_SuperPic

------------------------------------------------------------------------
r7654 | divverent | 2007-10-27 03:59:44 -0700 (Sat, 27 Oct 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.h

new menu QC builtin "stringwidth(string text, float handleColors)", does not do anything useful yet, but added for future expansion (variable width fonts); also add this to CSQC (see TODO in clvm_cmds.c)

------------------------------------------------------------------------
r7653 | divverent | 2007-10-26 04:44:28 -0700 (Fri, 26 Oct 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c

fix the picture drawing fix

------------------------------------------------------------------------
r7652 | divverent | 2007-10-24 14:59:53 -0700 (Wed, 24 Oct 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c

Change DrawQ_Pic and _SuperPic to be texel correct to fix bad clamping behavior.

------------------------------------------------------------------------
r7651 | divverent | 2007-10-23 07:36:48 -0700 (Tue, 23 Oct 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/fs.c

fix FS_Read when reading size 1 (it segfaulted sometimes then)
fix FS_Getc to allow 8bit data (by using unsigned char instead, like fgetc)

------------------------------------------------------------------------
r7650 | divverent | 2007-10-21 12:30:11 -0700 (Sun, 21 Oct 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c

added r_textbrightness to control color codes (so conchars can use black borders around text and color ^0 still stays readable)

------------------------------------------------------------------------
r7649 | divverent | 2007-10-21 06:48:50 -0700 (Sun, 21 Oct 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

fixed missing newline at end of some stufftext (breaking curl downloads a little)

------------------------------------------------------------------------
r7648 | havoc | 2007-10-21 04:21:47 -0700 (Sun, 21 Oct 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c

reverted the cleanup of entity state building because it was sapping
massive amounts of performance even with only 16 players, now it once
again builds them only once per frame and filters them per client

------------------------------------------------------------------------
r7647 | divverent | 2007-10-19 03:51:33 -0700 (Fri, 19 Oct 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_comp.h
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/prvm_exec.c

prvm_callprofile: a flat profile, time based, including subcalls

------------------------------------------------------------------------
r7646 | havoc | 2007-10-18 00:09:15 -0700 (Thu, 18 Oct 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c

fixed a bug in multiplayer savegame loading that caused all players
after the first one to respawn immediately after loading
(sv.loadgame and sv.paused were being cleared by the first player)

------------------------------------------------------------------------
r7645 | divverent | 2007-10-17 14:16:23 -0700 (Wed, 17 Oct 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

do contrastboost before reflection; move fog behind contrastboost (consistent with skybox)

------------------------------------------------------------------------
r7643 | divverent | 2007-10-17 02:41:01 -0700 (Wed, 17 Oct 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

We always <push> <PUSH> and <pop> <POP> like this... NOT.

------------------------------------------------------------------------
r7642 | havoc | 2007-10-17 01:35:40 -0700 (Wed, 17 Oct 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/menu.c

added back Always Run option (I forgot that the default speed was bad in
quake, oops!)

------------------------------------------------------------------------
r7641 | havoc | 2007-10-17 01:34:26 -0700 (Wed, 17 Oct 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

fixed cl.movement_origin being invalid on quake protocol (and others
before dp6), this fixes the loc messages in chat on quake servers

------------------------------------------------------------------------
r7640 | havoc | 2007-10-16 22:50:31 -0700 (Tue, 16 Oct 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

disable water rendering without r_glsl because the fallback path has
been removed

------------------------------------------------------------------------
r7639 | havoc | 2007-10-16 22:46:08 -0700 (Tue, 16 Oct 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_rmain.c

removed some code scraps from previous patch
removed SHADERPERMUTATION_WATER and REFRACTION (since those are now
SHADERMODE_ values)

------------------------------------------------------------------------
r7638 | havoc | 2007-10-16 21:51:47 -0700 (Tue, 16 Oct 2007) | 7 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/render.h

implemented a fixed function fallback for water, but it is disabled
because of extreme distortion artifacts (it would need to use a cubemap
for perspective correction)
implemented two-pass rendering of water and refraction surfaces, this
enables blendfunc of the first layer to work properly, the old path is
still present but disabled

------------------------------------------------------------------------
r7637 | divverent | 2007-10-16 15:10:26 -0700 (Tue, 16 Oct 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

oops... buffer overflow after a 640GB video file... fixed :P

------------------------------------------------------------------------
r7636 | divverent | 2007-10-16 14:58:45 -0700 (Tue, 16 Oct 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

oops

------------------------------------------------------------------------
r7635 | divverent | 2007-10-16 14:52:44 -0700 (Tue, 16 Oct 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/client.h

Write an OpenDML AVI index (indx... ix00, ix01... ixfsck... ixargh... ixhopethisworksnow)

------------------------------------------------------------------------
r7634 | havoc | 2007-10-15 05:07:28 -0700 (Mon, 15 Oct 2007) | 6 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/render.h

implemented MATERIALFLAG_REFRACTION
changed syntax of dp_refract, dp_reflect, added dp_water
moved SHADERPERMUTATION and friends to gl_rmain.c
eliminated SHADERPERMUTATION_MASK by separating out SHADERTYPE_USES
other cleanup

------------------------------------------------------------------------
r7633 | havoc | 2007-10-14 21:28:12 -0700 (Sun, 14 Oct 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/palette.c

fix a bug that caused glow textures to be made when they were not
needed, sapping rendering performance in q1bsp and q1 mdl rendering

------------------------------------------------------------------------
r7632 | havoc | 2007-10-14 21:10:38 -0700 (Sun, 14 Oct 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

renamed r_glsl_water* to r_water* because I am adding a fallback path

------------------------------------------------------------------------
r7631 | havoc | 2007-10-14 17:08:46 -0700 (Sun, 14 Oct 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/csprogs.c

set pmove_org and pmove_vel again in csqc because it's useless without
them

------------------------------------------------------------------------
r7630 | divverent | 2007-10-11 15:08:05 -0700 (Thu, 11 Oct 2007) | 8 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h

- fix SEGFAULT when a .shader file has more layers than allowed
- reduce number of layers from 8 to 2 to save memory (increase it later when additional layers are actually USED)
- parse ALL layers, even those behind the limit, to check for lightmap references and similar stuff
- when looking up a shader, only look through the actually DEFINED layers (not through all ALLOCATED ones), this means that the OS won't allocate pages more shaders than actually used
- increase maximum number of tcmods from 4 to 8 for Nexuiz

net: 1300MB -> 900MB vsize, and less RSS used too; so it won't swap any more on a 1GB system

------------------------------------------------------------------------
r7629 | divverent | 2007-10-11 07:31:44 -0700 (Thu, 11 Oct 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c

make more failed skin loads Prints

------------------------------------------------------------------------
r7628 | divverent | 2007-10-11 07:10:45 -0700 (Thu, 11 Oct 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

^1 is red, not ^4

------------------------------------------------------------------------
r7627 | divverent | 2007-10-11 07:06:13 -0700 (Thu, 11 Oct 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

only print the "missing texture for missing shader" message for developer or Q3BSP (as other formats contain their own textures, and don't NEED the actual texture file)

------------------------------------------------------------------------
r7626 | divverent | 2007-10-11 06:23:33 -0700 (Thu, 11 Oct 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

make messages about not existing textures colored and regular prints (not dpritns) as they are quite fatal to the appearance of a map

------------------------------------------------------------------------
r7625 | divverent | 2007-10-10 09:31:37 -0700 (Wed, 10 Oct 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sv_user.c

final speedhack fixes

------------------------------------------------------------------------
r7624 | havoc | 2007-10-09 21:21:01 -0700 (Tue, 09 Oct 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

fix typo in cl_netinputpacketspersecond_qw cvar name which caused
extreme slow motion on qw servers (1 packet per second or so)

------------------------------------------------------------------------
r7623 | sajt | 2007-10-09 15:19:31 -0700 (Tue, 09 Oct 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/model_brush.c

shut up compiler warning
------------------------------------------------------------------------
r7621 | sajt | 2007-10-09 14:58:08 -0700 (Tue, 09 Oct 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h

MCBSP kind of works now, i think
------------------------------------------------------------------------
r7620 | divverent | 2007-10-09 14:41:47 -0700 (Tue, 09 Oct 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

prevent speedhack 3.0: initialize the movetime, so a speedhack can't make use of the time before this client joined

------------------------------------------------------------------------
r7619 | divverent | 2007-10-09 14:35:38 -0700 (Tue, 09 Oct 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/sv_user.c

last patch by LH fixed speedhack 1.0: -20ms + 30ms = 10ms, but moves by 30ms
this patch fixed speedhack 2.0: (cl_movement 0) -10ms + (cl_movement 1) 20ms = 20ms client physics
and now also fixes speedhack 2.0a: (cl_movement 0) -10ms + (cl_movement 1) 20ms = 10ms server physics and 10ms client physics

------------------------------------------------------------------------
r7618 | sajt | 2007-10-09 14:12:24 -0700 (Tue, 09 Oct 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

oops
------------------------------------------------------------------------
r7616 | sajt | 2007-10-09 12:50:26 -0700 (Tue, 09 Oct 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

i'm sure there are plenty of bugs here for you guys to fix
------------------------------------------------------------------------
r7615 | sajt | 2007-10-09 12:48:13 -0700 (Tue, 09 Oct 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.h
   M /trunk/darkplaces/svvm_cmds.c

Added DP_QC_STRREPLACE - adds strreplace and strireplace functions (behave like str_replace and str_ireplace in PHP)
------------------------------------------------------------------------
r7614 | sajt | 2007-10-09 12:44:32 -0700 (Tue, 09 Oct 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_screen.c

fix a warning in msvc6
------------------------------------------------------------------------
r7613 | havoc | 2007-10-08 23:23:26 -0700 (Mon, 08 Oct 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_user.c

prevent backstepping of clc_move time from doing anything

------------------------------------------------------------------------
r7612 | dresk | 2007-10-08 23:04:45 -0700 (Mon, 08 Oct 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/cd_shared.c

Changed "fake cd track x playing..." console prints to console debug prints
------------------------------------------------------------------------
r7611 | havoc | 2007-10-08 22:30:35 -0700 (Mon, 08 Oct 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c

fix a warning (con_text is static, no need for an if check on it)

------------------------------------------------------------------------
r7610 | havoc | 2007-10-08 22:13:49 -0700 (Mon, 08 Oct 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix typo

------------------------------------------------------------------------
r7609 | havoc | 2007-10-08 22:11:47 -0700 (Mon, 08 Oct 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix water plane center calculation (it was never cleared)
fix water plane r_view corruption in error handling

------------------------------------------------------------------------
r7608 | divverent | 2007-10-07 06:48:11 -0700 (Sun, 07 Oct 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fix reflections not working when just reflective stuff, but no water, is on the map

------------------------------------------------------------------------
r7607 | divverent | 2007-10-07 02:30:52 -0700 (Sun, 07 Oct 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h

sorry... dp_refract parameters should work THAT way round

------------------------------------------------------------------------
r7606 | divverent | 2007-10-07 02:04:05 -0700 (Sun, 07 Oct 2007) | 5 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/render.h

changed reflect/refract keywords to
  dp_reflect <r> <g> <b>
  dp_refract <reflectmin> <reflectmax> <distort> <r> <g> <b>
made dp_reflect work additively again (so perfect mirrors shall use a black texture)

------------------------------------------------------------------------
r7605 | divverent | 2007-10-06 12:24:44 -0700 (Sat, 06 Oct 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/darkplaces.txt
   M /trunk/darkplaces/input.h
   M /trunk/darkplaces/svvm_cmds.c

make bestweapon customizable using a new register_bestweapon command (DP_CON_BESTWEAPON); add a new cycleweapon command that works similarily to bestweapon, but cycles among the weapons in the list

------------------------------------------------------------------------
r7603 | divverent | 2007-10-03 08:21:48 -0700 (Wed, 03 Oct 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/render.h

Cleaned up reflection and refraction a bit; added Q3 shader parameters dp_reflect and dp_refract for them; fixed simple reflection.

------------------------------------------------------------------------
r7602 | havoc | 2007-09-30 23:42:27 -0700 (Sun, 30 Sep 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix uninitialized variables

------------------------------------------------------------------------
r7601 | havoc | 2007-09-30 23:40:32 -0700 (Sun, 30 Sep 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

reworked R_Water_StartFrame to fix the bug that changes to
r_glsl_water_resolutionmultiplier didn't take effect until r_glsl_water
was toggled

------------------------------------------------------------------------
r7600 | havoc | 2007-09-30 20:39:40 -0700 (Sun, 30 Sep 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/todo

implemented support for more than 32768 clipnodes (again a case of
arguire qbsp producing files that violate the q1bsp format), this fixes
large monsters falling out of levels in warpspasm

------------------------------------------------------------------------
r7599 | havoc | 2007-09-30 20:37:39 -0700 (Sun, 30 Sep 2007) | 5 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/render.h

r_showtris/r_shownormals/r_showcollisionbrushes are no longer obscured
by bmodels and things that are drawn later, they now get their own
rendering stage, and have been moved after transparencies, also changed
them to use alpha blend, where their value controls the opacity

------------------------------------------------------------------------
r7598 | havoc | 2007-09-30 20:12:19 -0700 (Sun, 30 Sep 2007) | 7 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/sbar.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_user.c
   M /trunk/darkplaces/svvm_cmds.c

added support for arguire's strange protocols that expand
modelindex/soundindex to 16bit (sometimes), these protocols are
not recommended for mods as the more standard QUAKEDP protocol already
supported 16bit indices by use of additional svc_ codes and additional
entity update bits, however these protocols are used in the warpspasm
demos, so this makes them play

------------------------------------------------------------------------
r7597 | sajt | 2007-09-30 16:53:26 -0700 (Sun, 30 Sep 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/svvm_cmds.c

fix some errors
------------------------------------------------------------------------
r7596 | havoc | 2007-09-30 07:50:52 -0700 (Sun, 30 Sep 2007) | 5 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h

implemented pvs support in water reflection rendering, greatly improving
performance with r_glsl_water 1
implemented some checks to shut off r_glsl_water if texture creation
fails 

------------------------------------------------------------------------
r7595 | havoc | 2007-09-30 06:23:34 -0700 (Sun, 30 Sep 2007) | 5 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix a bug where map becomes invisible (just sky) when the nearclip plane
culls a portal, this bug was introduced by recent water shader rendering
features (using an extra clip plane for culling, accidentally activated
the view's nearclip plane as well, which culls portals accidentally)

------------------------------------------------------------------------
r7594 | divverent | 2007-09-30 05:58:34 -0700 (Sun, 30 Sep 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.inc

use $(WINDRES) variable for win32, don't hardcode the name

------------------------------------------------------------------------
r7593 | havoc | 2007-09-29 10:47:48 -0700 (Sat, 29 Sep 2007) | 7 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

changed q1bsp loader to allow more than 32768 nodes, as long as the
total of nodes+leafs is <= 65536, it also attempts to fix corrupt BSP
trees by changing invalid references to instead use the solid leaf (so
you can't walk into a corrupt area), this was done to allow loading of
maps compiled with arguire's qbsp utility that can produce corrupt bsp
files

------------------------------------------------------------------------
r7592 | divverent | 2007-09-26 10:16:08 -0700 (Wed, 26 Sep 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/keys.c

"" binds are removed binds (fix behaviour in conjunction with bindmaps not skipping over "" binds - note that unbind also binds to "")

------------------------------------------------------------------------
r7591 | havoc | 2007-09-25 22:21:04 -0700 (Tue, 25 Sep 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/view.c

implemented chase_overhead cvar

------------------------------------------------------------------------
r7590 | havoc | 2007-09-25 20:07:11 -0700 (Tue, 25 Sep 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c

changed SND_MAX_SPEED to 96000 and added corresponding threshold entry

------------------------------------------------------------------------
r7589 | havoc | 2007-09-25 13:37:46 -0700 (Tue, 25 Sep 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.dev

updated darkplaces.dev from m0rfar

------------------------------------------------------------------------
r7588 | havoc | 2007-09-25 12:23:39 -0700 (Tue, 25 Sep 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

attempt to fix unintentionally forced gloss problems

------------------------------------------------------------------------
r7587 | havoc | 2007-09-25 11:54:00 -0700 (Tue, 25 Sep 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

use even bigger primes actually

------------------------------------------------------------------------
r7586 | havoc | 2007-09-25 11:52:03 -0700 (Tue, 25 Sep 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

use bigger prime numbers in calculating vertex hash indices to improve
loading performance

------------------------------------------------------------------------
r7583 | havoc | 2007-09-24 11:52:39 -0700 (Mon, 24 Sep 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

patch for nexuiz from m0rfar to colorize health/armor according to amount

------------------------------------------------------------------------
r7582 | havoc | 2007-09-24 11:45:51 -0700 (Mon, 24 Sep 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/libcurl.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/sv_main.c

changed COM_ParseToken_Simple to have a parsebackslash option, usually
false, this fixes the problem with broken wad names in hlbsp

------------------------------------------------------------------------
r7581 | havoc | 2007-09-24 11:19:17 -0700 (Mon, 24 Sep 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix a crash in levels without water

------------------------------------------------------------------------
r7580 | havoc | 2007-09-24 10:35:55 -0700 (Mon, 24 Sep 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix incorrect casts in the default.glsl shader

------------------------------------------------------------------------
r7579 | havoc | 2007-09-24 08:29:15 -0700 (Mon, 24 Sep 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/r_sky.c

added GL_CullFace(GL_NONE); in sky rendering in an attempt to fix
problems with refraction/reflection of skybox

------------------------------------------------------------------------
r7578 | havoc | 2007-09-24 05:33:09 -0700 (Mon, 24 Sep 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.inc

correct a typo (-lws_32 should be -lws2_32)

------------------------------------------------------------------------
r7577 | havoc | 2007-09-24 04:52:50 -0700 (Mon, 24 Sep 2007) | 7 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/render.h

revised water shader, less refraction, more focus on reflections
added MODE_LIGHTMAP shader permutation flag, this simplified the shader
some other cleanup (q3 vertex shaded surfaces should now properly
respond to r_ambient)
implemented internal support for reflection surfaces (as opposed to full
refraction+reflection water effects)

------------------------------------------------------------------------
r7576 | havoc | 2007-09-23 03:12:09 -0700 (Sun, 23 Sep 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

replace strcpy use with strlcpy in some commented out code in menu

------------------------------------------------------------------------
r7575 | havoc | 2007-09-23 03:09:08 -0700 (Sun, 23 Sep 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/matrixlib.c

disable double/float conversion warnings in matrixlib on MSVS

------------------------------------------------------------------------
r7574 | havoc | 2007-09-23 03:06:36 -0700 (Sun, 23 Sep 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.inc

changed -lwsock32 to -lws2_32 in windows builds

------------------------------------------------------------------------
r7573 | havoc | 2007-09-23 03:02:22 -0700 (Sun, 23 Sep 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/darkplaces-dedicated.dsp
   M /trunk/darkplaces/darkplaces-sdl.dsp
   M /trunk/darkplaces/darkplaces.dsp

added dinput.lib requirement in darkplaces.dsp
changed wsock32.lib requirement to ws2_32.lib
removed many libs from dsp files

------------------------------------------------------------------------
r7572 | havoc | 2007-09-23 02:50:07 -0700 (Sun, 23 Sep 2007) | 6 lines
Changed paths:
   M /trunk/darkplaces/darkplaces-dedicated.dsp
   M /trunk/darkplaces/darkplaces-sdl.dsp
   M /trunk/darkplaces/darkplaces.dsp

moved resource.h and darkplaces.rc from Source Files group to Resource
Files group
added resource.h which was missing in some projects
renamed project configurations to be named darkplaces-sdl and
darkplaces-dedicated rather than merely sdl and dedicated

------------------------------------------------------------------------
r7571 | havoc | 2007-09-23 02:36:27 -0700 (Sun, 23 Sep 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/darkplaces-dedicated.dsp
   M /trunk/darkplaces/darkplaces-sdl.dsp
   M /trunk/darkplaces/darkplaces.dsp

added sv_demo.[ch] to MSVS6 projects
added svbsp.h to MSVS6 projects

------------------------------------------------------------------------
r7570 | havoc | 2007-09-22 00:46:30 -0700 (Sat, 22 Sep 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/matrixlib.c
   M /trunk/darkplaces/matrixlib.h
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/model_sprite.c
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/todo
   M /trunk/darkplaces/vid_shared.c

implemented r_glsl_water cvar (refraction and reflection rendering)

------------------------------------------------------------------------
r7569 | havoc | 2007-09-19 23:32:02 -0700 (Wed, 19 Sep 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

reduced default value of sv_clmovement_waitforinput from 16 to 4,
limiting the potential of lag-burst cheats, and causing lagging players
to start moving again a bit sooner

------------------------------------------------------------------------
r7568 | havoc | 2007-09-19 01:01:49 -0700 (Wed, 19 Sep 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/makefile.inc

changed sv_demo.c to sv_demo.o in object file list
moved sv_demo.o to its proper place in object file list

------------------------------------------------------------------------
r7567 | havoc | 2007-09-19 00:58:16 -0700 (Wed, 19 Sep 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

limit r_bloom_colorexponent to 32

------------------------------------------------------------------------
r7566 | havoc | 2007-09-19 00:56:26 -0700 (Wed, 19 Sep 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/menu.c

fix a typo in r_bloom_colorexponent which allowed it to get out of
bounds

------------------------------------------------------------------------
r7565 | dresk | 2007-09-16 16:20:50 -0700 (Sun, 16 Sep 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c

Added optional CSQC function CSQC_Event_Sound with the following parameters : float entitynum, float channel, string soundname, float volume, float attenuation, vector position .  This function, if provided, is called whenever a sound packet arrives from the server.  If the function returns true, the sound call is skipped in the engine, otherwise it is played as normal.  Function intention is to provide additional feedback on sound events (without touching the packet stream).
------------------------------------------------------------------------
r7564 | divverent | 2007-09-09 01:54:14 -0700 (Sun, 09 Sep 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/makefile.inc
   M /trunk/darkplaces/server.h
   A /trunk/darkplaces/sv_demo.c
   A /trunk/darkplaces/sv_demo.h
   M /trunk/darkplaces/sv_main.c

sv_autodemo_perclient - record client-like demos on the server (same format, lagged (no support of cl_movement), so basically, just like spectating)

------------------------------------------------------------------------
r7563 | divverent | 2007-09-09 01:15:29 -0700 (Sun, 09 Sep 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c

For now, ground snd_restart and snd_unloadallsounds if the client is still connected, because DP keeps references to the sfx_t * that are being freed in the precache list. A real fix however would be ditching snd_unloadallsounds completely, and making a snd_reload command that unloads the sounds that are not being used at the moment, and reloads the sounds that are referenced.

------------------------------------------------------------------------
r7562 | dresk | 2007-09-07 19:40:20 -0700 (Fri, 07 Sep 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/sbar.c

Added optional float global sb_showscores to CSQC that represents the engine's +showscores state.  To support this in your CSQC, simply add this :
float sb_showscores;
------------------------------------------------------------------------
r7561 | dresk | 2007-09-05 15:15:04 -0700 (Wed, 05 Sep 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.h

Added QC function drawcolorcodedstring (#326 CSQC, #467 MQC) which is similar to drawstring, instead it does not take in an RGB vector and instead colors the string based on the engine's coloring rules.

Useful for drawing colorized player names, centerprints, etc.
------------------------------------------------------------------------
r7560 | havoc | 2007-09-04 13:27:36 -0700 (Tue, 04 Sep 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c

made r_view.showdebug affect more r_show* features

------------------------------------------------------------------------
r7559 | havoc | 2007-09-04 13:27:12 -0700 (Tue, 04 Sep 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_ogg.c

remove unused variable

------------------------------------------------------------------------
r7558 | havoc | 2007-09-04 13:20:02 -0700 (Tue, 04 Sep 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_rmain.c

added r_view.showdebug flag, which is used to disable rendering of
r_shownormals and r_showtris and such features when rendering with HDR

------------------------------------------------------------------------
r7557 | havoc | 2007-09-04 13:18:27 -0700 (Tue, 04 Sep 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

remove a weird loop that was attempting to count the length of the
strings table in the progs

------------------------------------------------------------------------
r7556 | havoc | 2007-09-03 03:48:10 -0700 (Mon, 03 Sep 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.h

WIN32: changed stricmp and strnicmp to have an underscore prefix

------------------------------------------------------------------------
r7555 | havoc | 2007-09-03 03:46:11 -0700 (Mon, 03 Sep 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_wgl.c

added #ifndef MK_XBUTTON3

------------------------------------------------------------------------
r7554 | havoc | 2007-09-03 03:44:13 -0700 (Mon, 03 Sep 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.h

fix an array declaration that lacked extern

------------------------------------------------------------------------
r7553 | divverent | 2007-09-02 07:24:44 -0700 (Sun, 02 Sep 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_main.h
   M /trunk/darkplaces/snd_mem.c
   M /trunk/darkplaces/snd_ogg.c

ReplayGain support for OggVorbis files (mostly useful for fake CD tracks)

------------------------------------------------------------------------
r7552 | havoc | 2007-09-02 06:57:58 -0700 (Sun, 02 Sep 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/host.c

doubled cl_maxidlefps, this cures sound stuttering when the window is
inactive

------------------------------------------------------------------------
r7551 | havoc | 2007-09-01 05:23:14 -0700 (Sat, 01 Sep 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

fix a bug in displaying ammo numbers, was a stupid typo

------------------------------------------------------------------------
r7550 | havoc | 2007-08-30 06:26:58 -0700 (Thu, 30 Aug 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_main.h
   M /trunk/darkplaces/snd_ogg.c
   M /trunk/darkplaces/snd_wav.c

OGG_FreeSfx and WAV_FreeSfx no longer reference sfx_t
OGG_FetchEnd no longer uses a pointer pointer

------------------------------------------------------------------------
r7549 | havoc | 2007-08-30 05:55:17 -0700 (Thu, 30 Aug 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_main.h
   M /trunk/darkplaces/snd_ogg.c

eliminated channel_t reference in OGG_FetchEnd

------------------------------------------------------------------------
r7548 | havoc | 2007-08-30 05:49:49 -0700 (Thu, 30 Aug 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/snd_main.h
   M /trunk/darkplaces/snd_mix.c
   M /trunk/darkplaces/snd_ogg.c
   M /trunk/darkplaces/snd_wav.c

eliminated references to channel_t and sfx_t in OGG_FetchSound and
WAV_FetchSound, reworked ogg fetcher_data struct a bit for this

------------------------------------------------------------------------
r7547 | havoc | 2007-08-29 20:55:44 -0700 (Wed, 29 Aug 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

turn off r_glsl if compilation of the lowest level fallback fails

------------------------------------------------------------------------
r7546 | havoc | 2007-08-29 20:55:21 -0700 (Wed, 29 Aug 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/image.c

save 24bit tga if alpha channel is entirely 255

------------------------------------------------------------------------
r7545 | havoc | 2007-08-29 02:28:26 -0700 (Wed, 29 Aug 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_null.c

make snd_null.c work again (added snd_mutewhenidle)

------------------------------------------------------------------------
r7544 | havoc | 2007-08-28 22:35:08 -0700 (Tue, 28 Aug 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

fix intermission display on recorded singleplayer demos, it was checking
cl.islocalgame which is false on demo playback and thinking it should
draw multiplayer scoreboard instead of the intermission stats

------------------------------------------------------------------------
r7543 | havoc | 2007-08-27 14:52:06 -0700 (Mon, 27 Aug 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h

implemented q3 shader keyword polygonoffset

------------------------------------------------------------------------
r7542 | havoc | 2007-08-27 04:12:19 -0700 (Mon, 27 Aug 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_main.h
   M /trunk/darkplaces/sound.h
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_wgl.c

implemented snd_mutewhenidle cvar, defaults to 1, to allow people to
reenable sound when not the active window if they wish (such as when
watching demos)

------------------------------------------------------------------------
r7541 | havoc | 2007-08-27 04:10:41 -0700 (Mon, 27 Aug 2007) | 5 lines
Changed paths:
   M /trunk/darkplaces/keys.c

added a developer 1000 print for every key event received, attempting to
figure out why while watching the demo loop you can press the 1 key and
then escape and escape does nothing, pressing other keys reenables
escape again

------------------------------------------------------------------------
r7540 | havoc | 2007-08-27 03:50:40 -0700 (Mon, 27 Aug 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/host.c

added cl_maxidlefps cvar to control the fps limiting when not the active
window

------------------------------------------------------------------------
r7539 | havoc | 2007-08-26 23:53:26 -0700 (Sun, 26 Aug 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

cleaned up qw-related todo items and added some newly discovered qw issues

------------------------------------------------------------------------
r7537 | dresk | 2007-08-26 12:02:29 -0700 (Sun, 26 Aug 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/svvm_cmds.c

Added pointsound QC function to CL and SV VMs (extension DP_SV_POINTSOUND, #483).  This function is very similar to sound, though instead of providing an entity, an origin is provided, and the channel parameter is omitted (since no entity is being tracked).

This function requires no modification to the protocol layer (since origin was always sent with sound calls, along with an entity).
------------------------------------------------------------------------
r7536 | divverent | 2007-08-26 05:23:25 -0700 (Sun, 26 Aug 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_sprite.c
   M /trunk/darkplaces/r_sprites.c
   M /trunk/darkplaces/spritegn.h

new sprite types SPR_LABEL and SPR_LABEL_SCALE

------------------------------------------------------------------------
r7535 | havoc | 2007-08-24 00:47:54 -0700 (Fri, 24 Aug 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

changed reporting of compressed RGB textures to use 0.5 bytes per pixel
when estimating the uploaded size

------------------------------------------------------------------------
r7534 | havoc | 2007-08-23 19:33:01 -0700 (Thu, 23 Aug 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_sprite.c
   M /trunk/darkplaces/r_explosion.c

no longer compresses embedded textures (in q1 and hl formats) because
they tend to use little video memory to begin with

------------------------------------------------------------------------
r7533 | havoc | 2007-08-23 19:31:35 -0700 (Thu, 23 Aug 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

added gl_texturecompression to the video options menu

------------------------------------------------------------------------
r7532 | havoc | 2007-08-23 01:27:38 -0700 (Thu, 23 Aug 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

improved r_texturestats output to count compressed textures as only 1
byte per pixel rather than their input bytes per pixel amount

------------------------------------------------------------------------
r7531 | havoc | 2007-08-23 00:44:46 -0700 (Thu, 23 Aug 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/image_png.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_sprite.c
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/r_textures.h
   M /trunk/darkplaces/vid_shared.c

implemented support for GL_ARB_texture_compression - this is controlled
by the gl_texturecompression cvar, and which kinds of texture are
affected can be controlled by the gl_texturecompression_* cvars

------------------------------------------------------------------------
r7530 | divverent | 2007-08-22 08:40:45 -0700 (Wed, 22 Aug 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/cmd.c

add to cvar expansion: new variant $3- for all arguments starting from the 3rd; note: $1- is equivalent to $*.
Fix bug in cvar value quoting that didn't quote $ (typo).

------------------------------------------------------------------------
r7528 | havoc | 2007-08-18 10:50:23 -0700 (Sat, 18 Aug 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/common.c

improved COM_ParseToken functions to continue parsing after the token
buffer fills up (a better behavior than aborting parsing)

------------------------------------------------------------------------
r7527 | havoc | 2007-08-18 10:46:07 -0700 (Sat, 18 Aug 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/todo


------------------------------------------------------------------------
r7525 | dresk | 2007-08-15 23:35:30 -0700 (Wed, 15 Aug 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/svvm_cmds.c

Added SSQC Function "SV_OnEntityNoSpawnFunction" which is called, if available, whenever an entity on the server is parsed but has no spawn function.  Previously Darkplaces would report this to the console under developer mode and immediately remove the entity.  The SSQC may now specify the behavior when such an event occurs (it may also simply call remove(self) to mimic the engine's behavior.)
------------------------------------------------------------------------
r7524 | dresk | 2007-08-13 11:04:50 -0700 (Mon, 13 Aug 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/view.c

Added CSQC globals dmg_take, dmg_save and dmg_origin.  These globals correspond to the SSQC-sent messages that provide the data from the QC layer.  dmg_origin is the origin of the damage taken, derived from the dmg_inflictor entity in the QC.  All values are reset after every rendered frame (to mimic the server behavior).

These globals are optional, and do not interfere with the CRC of the CSQC definitions.
------------------------------------------------------------------------
r7523 | havoc | 2007-08-12 00:26:49 -0700 (Sun, 12 Aug 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

fix bug in csqc sound builtin where it multiplied volume by 255 (the
sound system already does that)

------------------------------------------------------------------------
r7522 | havoc | 2007-08-11 23:31:08 -0700 (Sat, 11 Aug 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/snd_main.c

added cl_gameplayfix_soundsmovewithentities cvar so that this feature
can be disabled if desired

------------------------------------------------------------------------
r7518 | havoc | 2007-08-11 03:22:39 -0700 (Sat, 11 Aug 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

added a FIXME comment about r_glsl 1 not working properly with
overbright lightstyle strings

------------------------------------------------------------------------
r7517 | havoc | 2007-08-11 03:07:25 -0700 (Sat, 11 Aug 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/render.h

fix brightness of fullbright entities in r_glsl 1 mode by using a 128
grey texture instead of white as the fake lightmap for the batch

------------------------------------------------------------------------
r7516 | dresk | 2007-08-10 11:09:01 -0700 (Fri, 10 Aug 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c

Added support for assigning coop and deathmatch global float values to optional CSQC float globals (just like SSQC works with the two floats).
------------------------------------------------------------------------
r7515 | divverent | 2007-08-10 03:34:06 -0700 (Fri, 10 Aug 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/palette.c
   M /trunk/darkplaces/palette.h
   M /trunk/darkplaces/sbar.c

allow shirt/pants/scoreboard colors to be pulled from an extra palette file (r_colormap_palette); reload the palettes on r_restart

------------------------------------------------------------------------
r7511 | havoc | 2007-08-09 22:46:58 -0700 (Thu, 09 Aug 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/view.c

allow view warping when underwater with gl_polyblend 0

------------------------------------------------------------------------
r7510 | dresk | 2007-08-09 22:40:24 -0700 (Thu, 09 Aug 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

Added "pl" to the list of available keys to the CSQC function getplayerkey.  "pl" returns the player's packetloss, as reported by the engine.
------------------------------------------------------------------------
r7509 | havoc | 2007-08-09 06:15:13 -0700 (Thu, 09 Aug 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

display 4 digit ammo in inventory bar in quake hud

------------------------------------------------------------------------
r7508 | havoc | 2007-08-08 22:16:37 -0700 (Wed, 08 Aug 2007) | 7 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c

fix a clientside bug with CL_ValidateState altering entity states and
causing them to remain altered in the future on delta updates in DP5/6/7
protocols (for example if skin or frame was set to a value that is not
valid on the current model, and then the model changes without the skin
or frame changing, it would be stuck on skin 0 or frame 0 until they
change to something else)

------------------------------------------------------------------------
r7507 | havoc | 2007-08-08 22:14:40 -0700 (Wed, 08 Aug 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

don't crash if r_listmaptextures or r_replacemaptexture is used with no
world model on the client

------------------------------------------------------------------------
r7506 | havoc | 2007-08-07 21:18:09 -0700 (Tue, 07 Aug 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces-dedicated.dsp
   M /trunk/darkplaces/darkplaces-sdl.dsp

added /LARGEADDRESSAWARE in two more MSVS projects

------------------------------------------------------------------------
r7505 | havoc | 2007-08-07 21:16:08 -0700 (Tue, 07 Aug 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.dev
   M /trunk/darkplaces/darkplaces.dsp

added large address aware flags in Dev-C++ and MSVS6 projects

------------------------------------------------------------------------
r7504 | havoc | 2007-08-07 21:13:17 -0700 (Tue, 07 Aug 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.inc

added --large-address-aware flag in windows builds

------------------------------------------------------------------------
r7502 | havoc | 2007-08-03 16:46:28 -0700 (Fri, 03 Aug 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/protocol.c

fix a typo that caused incorrect prioritization of lost entity updates

------------------------------------------------------------------------
r7501 | havoc | 2007-08-01 17:10:45 -0700 (Wed, 01 Aug 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fix an error in the last patch

------------------------------------------------------------------------
r7500 | havoc | 2007-08-01 17:08:20 -0700 (Wed, 01 Aug 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

revert tolerances patch in RecursiveHullCheck, tolerances probably
should be there but this wasn't working properly, so it is reverted

------------------------------------------------------------------------
r7499 | divverent | 2007-07-28 11:52:26 -0700 (Sat, 28 Jul 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

fix and simplify strpad so that it actually works

------------------------------------------------------------------------
r7498 | divverent | 2007-07-28 08:50:49 -0700 (Sat, 28 Jul 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

make str2chr return 0 when used on an index outside the string (before, it didn't set the return value and would return something random)

------------------------------------------------------------------------
r7497 | divverent | 2007-07-28 07:23:14 -0700 (Sat, 28 Jul 2007) | 15 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.h
   M /trunk/darkplaces/svvm_cmds.c

KrimZon's FTE_STRINGS port, please test!

// float(string haystack, string needle) strstr = #222;
float(string haystack, string needle, float startpos) strstrofs = #222;
// str2chr was already there
// chr2str was already there
string(float ccase, float calpha, float cnum, string s, ...) strconv = #224;
string(float chars, string s, ...) strpad = #225;
string(string info, string key, string value, ...) infoadd = #226;
string(string info, string key) infoget = #227;
float(string s1, string s2) strcmp = #228;
float(string s1, string s2, float len) strncmp = #228;
float(string s1, string s2) strcasecmp = #229;
float(string s1, string s2, float len) strncasecmp = #230;

------------------------------------------------------------------------
r7496 | dresk | 2007-07-27 15:53:09 -0700 (Fri, 27 Jul 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/clprogdefs.h
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c

Reverted addition of float global intermission to clprogdefs.h (which required a CRC update and recompilation of all CSQC mods).  Revert changes to CSQC Defs file if intermission had been inserted into it.

CSQC updating of intermission still supported if float global intermission exists.
------------------------------------------------------------------------
r7495 | dresk | 2007-07-23 23:11:10 -0700 (Mon, 23 Jul 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/clprogdefs.h
   M /trunk/darkplaces/csprogs.c

Added the global float "intermission" to CSQC defs (in clprogdefs.h).  Intermission was added after the global float servercommandframe, and MUST be added in all CSQC definitions files at this location.  This float is updated whenever the client intermission is updated.

This new global float is part of Spike's CSQC definition, as it exists in his globals as well (albeit in a different order from DP's).
------------------------------------------------------------------------
r7494 | dresk | 2007-07-23 20:50:38 -0700 (Mon, 23 Jul 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c

Added the map name (ie. "The Grisly Grotto") to the world.message field string in CSQC (you will have to define .string message somewhere in your QC code to access it)
------------------------------------------------------------------------
r7493 | havoc | 2007-07-23 18:04:55 -0700 (Mon, 23 Jul 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

hush a warning in Fantasy Quake (SOLID_BSP on a sprite - makes no sense,
but continuous spam about it annoys the player)

------------------------------------------------------------------------
r7492 | havoc | 2007-07-19 13:49:11 -0700 (Thu, 19 Jul 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

fix problem with guardian not waking up in dissolution of eternity
mission pack

------------------------------------------------------------------------
r7491 | havoc | 2007-07-16 23:09:46 -0700 (Mon, 16 Jul 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/sv_main.c

changed SCR_BeginLoadingPlaque to not call S_StopAllSounds, this should
fix cd loop/play commands in quake.rc

------------------------------------------------------------------------
r7490 | havoc | 2007-07-15 19:31:05 -0700 (Sun, 15 Jul 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

don't draw score info in viewsize 120

------------------------------------------------------------------------
r7489 | divverent | 2007-07-15 07:55:43 -0700 (Sun, 15 Jul 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_wgl.c

make -dinput support BUTTON4 and the wheel

------------------------------------------------------------------------
r7488 | divverent | 2007-07-15 02:32:39 -0700 (Sun, 15 Jul 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix typo in r_glsl_dumpshader message

------------------------------------------------------------------------
r7487 | divverent | 2007-07-14 00:26:30 -0700 (Sat, 14 Jul 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/cmd.h
   M /trunk/darkplaces/keys.c

add Cmd_QuoteString, and make the config writing code use that to quote strings written to the config file (so binds containing backslashes and quotes are saved correctly)

------------------------------------------------------------------------
r7486 | divverent | 2007-07-14 00:06:15 -0700 (Sat, 14 Jul 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/cmd.c

command parsing: make "bind" and "in_bind" have the same parsing exception as "alias": no cvar expansion takes place when executing these commands, unless the command names are quoted or "hidden" in some other way

This fixes binds using cvars when written to the config file.

------------------------------------------------------------------------
r7485 | havoc | 2007-07-13 01:11:50 -0700 (Fri, 13 Jul 2007) | 5 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

modified Mod_Q1BSP_LoadFaces to use smaller lightmapsize on maps that
don't have a lot of lightmap data (mainly ammo boxes and such), and also
increased the maximum lightmapsize to 1024 which improves performance on
very large maps like masque.bsp

------------------------------------------------------------------------
r7484 | havoc | 2007-07-13 01:09:48 -0700 (Fri, 13 Jul 2007) | 5 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

added some tolerances in Mod_Q1BSP_RecursiveHullCheck so that it is
likely to give sane results if an endpoint is exactly on a plane
(possibly negating the need for the nudge off the impact plane, but that
remains in the code)

------------------------------------------------------------------------
r7483 | havoc | 2007-07-11 04:01:21 -0700 (Wed, 11 Jul 2007) | 6 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/todo

fix bug with large time skips in demo playback being slowly interpolated
rather than simply skipped as in Quake, this fixes Nehahra movie
playback (where scene cuts are associated with large time deltas), as
well as fixing the view angle interpolation on the first frame of all
other demos

------------------------------------------------------------------------
r7482 | divverent | 2007-07-10 03:29:39 -0700 (Tue, 10 Jul 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

make rcon command display a bit nicer for multi-command rcons

------------------------------------------------------------------------
r7481 | divverent | 2007-07-10 03:04:42 -0700 (Tue, 10 Jul 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

allow multiple rcon commands in the same packet, separated by NUL

------------------------------------------------------------------------
r7480 | divverent | 2007-07-09 23:39:28 -0700 (Mon, 09 Jul 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c

oops... forgot to safeguard against recursive character adding

------------------------------------------------------------------------
r7479 | dresk | 2007-07-08 22:07:07 -0700 (Sun, 08 Jul 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/model_sprite.c

Updated cl_modelindexlist command with additional model information, including model type (Q1BSP, MDL, MD2, etc) and triangle count.

Removed Hungarian Notation in CL_ModelIndexList_f and CL_SoundIndexList_f functions.
------------------------------------------------------------------------
r7478 | havoc | 2007-07-08 18:28:47 -0700 (Sun, 08 Jul 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/todo

allow multiplayer savegames

------------------------------------------------------------------------
r7477 | havoc | 2007-07-08 18:28:30 -0700 (Sun, 08 Jul 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

never let client timeout in singleplayer

------------------------------------------------------------------------
r7476 | divverent | 2007-07-08 17:38:37 -0700 (Sun, 08 Jul 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c

log_dest_udp now limits the packet size to 1400, not 1500, for lower-MTU setups like PPPoE

------------------------------------------------------------------------
r7475 | dresk | 2007-07-08 17:02:55 -0700 (Sun, 08 Jul 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/console.c

Removed inline from function Con_Rcon_AddChar due to MSVC8 (Visual Studio 2005) not supporting the C99 standard (which supports inline).  Potential future compiler check for feature.
------------------------------------------------------------------------
r7474 | dresk | 2007-07-08 16:54:14 -0700 (Sun, 08 Jul 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_main.c

Added command cl_soundindexlist which lists the sound index and the corresponding filenames of the sounds.
------------------------------------------------------------------------
r7473 | dresk | 2007-07-08 16:04:59 -0700 (Sun, 08 Jul 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/prvm_exec.c

Added optional wildcard support for prvm_edict, prvm_edicts and prvm_globals commads.  In prvm_edict/s, wildcard is for field names; in prvm_globals, wildcard is for generic names.
------------------------------------------------------------------------
r7472 | divverent | 2007-07-08 16:00:26 -0700 (Sun, 08 Jul 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c

fix little bug that made \001 destroy the first output character in log_dest_udp

------------------------------------------------------------------------
r7471 | divverent | 2007-07-08 06:47:12 -0700 (Sun, 08 Jul 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/console.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/netconn.h

new cvar log_dest_udp to send all console data to one or more specified addresses, separated by spaces, in form of QW rcon prints. Should be useful to let external programs communicate with a DP server (like IRC gateways, console web interfaces, stuff like that)

------------------------------------------------------------------------
r7470 | havoc | 2007-07-07 20:16:38 -0700 (Sat, 07 Jul 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/todo


------------------------------------------------------------------------
r7469 | havoc | 2007-07-07 20:14:10 -0700 (Sat, 07 Jul 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/todo

fixed bug in gl_lightmaps code that made it not work properly on map
surfaces
improved gl_lightmaps to be almost completely usable

------------------------------------------------------------------------
r7467 | divverent | 2007-07-07 15:19:22 -0700 (Sat, 07 Jul 2007) | 10 lines
Changed paths:
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/common.c

changed parsing/cvar expanding rules to allow better handling of cvars with evil characters in their value, and to allow for easy concatenation of cvar values:
- \\ inside quoted strings now becomes \ (which is honored by semicolon splitting too)
- only one round of expansion when processing an alias (expanding cvars and parameters at the same time); this is implemented by duplicating every resulting dollar sign when expanding an alias
- lines starting with alias are exempt from cvar expansion (to be compatible with older versions that rely on alias lines with double quoted arguments to not have cvar expansion, which got changed in a recent commit); this can be overridden by quoting the word "alias"
- add ${cvar} syntax so one can expand a cvar and immediately follow with some letters
- add ${$cvar} syntax to reintroduce indirection similar to what could previously be done because aliases were expanded in two rounds
- make $cvar expansion insert the cvar in a way that isn't harmful when inside double quotes (that is, backslash double quotes and backslashes); this then allows copying cvars using: set copy "$original"

A detailed description of the rules is in cmd.c, Cmd_PreprocessString in a big comment block.

------------------------------------------------------------------------
r7466 | havoc | 2007-07-04 15:26:11 -0700 (Wed, 04 Jul 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cmd.c

fix $cvar expansion to work in quotes

------------------------------------------------------------------------
r7465 | havoc | 2007-07-04 15:00:27 -0700 (Wed, 04 Jul 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/svvm_cmds.c

corrected comments for DP_FS_SEARCH functions to say DP_QC_FS_SEARCH

------------------------------------------------------------------------
r7464 | divverent | 2007-07-03 14:28:39 -0700 (Tue, 03 Jul 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/collision.c

fix brushforbox_index integer overflow found by Green - thanks for reporting. And C's modulo operation sucks.

------------------------------------------------------------------------
r7463 | havoc | 2007-07-02 17:53:48 -0700 (Mon, 02 Jul 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/todo

added sv_gameplayfix_delayprojectiles cvar, to allow the delayed
projectiles behavior to be disabled if desired (since it does have a
significant impact on gameplay)

------------------------------------------------------------------------
r7462 | havoc | 2007-07-02 17:49:38 -0700 (Mon, 02 Jul 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/sv_user.c

fix the jump-slide bug in the sv_gameplayfix_qwplayerphysics option
(I to fix this because some people like the feature, but others don't)

------------------------------------------------------------------------
r7461 | havoc | 2007-07-02 17:29:14 -0700 (Mon, 02 Jul 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/protocol.c

send less stats in old protocols, a lot of them were being duplicated
for no reason

------------------------------------------------------------------------
r7460 | havoc | 2007-07-02 17:28:38 -0700 (Mon, 02 Jul 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/quakedef.h

commented out STAT_FRAGS (never used in quake either)

------------------------------------------------------------------------
r7459 | divverent | 2007-06-29 04:46:38 -0700 (Fri, 29 Jun 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

and now I see that the added frags counter requires shifting the flag status icons up... so the chat still is unobstructed

------------------------------------------------------------------------
r7458 | divverent | 2007-06-29 04:40:33 -0700 (Fri, 29 Jun 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

add cvar sbar_miniscoreboard_size to control the size of the mini DM overlay in items (or -1 makes it get a default size depending on the current HUD); shift around the frags counter a bit to work well with 4 teams in sbar_hudselector 1 and 3 teams in sbar_hudselector 0 in Nexuiz (yes, then 4 teams display is knowingly broken, but it looks like we can use sbar_hudselector 1 in the next release)

------------------------------------------------------------------------
r7457 | divverent | 2007-06-29 01:26:39 -0700 (Fri, 29 Jun 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

oops, missing \n

------------------------------------------------------------------------
r7456 | divverent | 2007-06-29 00:46:15 -0700 (Fri, 29 Jun 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix shader name in "permutation%s failed for shader %s, some features may not work properly!" message (previously was hardcoded to glsl/default.glsl);
new command r_glsl_dumpshader that dumps the engine builtin default.glsl file to glsl/default.glsl for editing and trying out stuff

------------------------------------------------------------------------
r7455 | dresk | 2007-06-27 00:40:57 -0700 (Wed, 27 Jun 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/sv_phys.c

Fixed bug where .contentstransition QC field function was not assigning the self entity to the entity experiencing the contents transition.
------------------------------------------------------------------------
r7454 | divverent | 2007-06-26 13:27:40 -0700 (Tue, 26 Jun 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_ogg.c

oops, I didn't see this warning

------------------------------------------------------------------------
r7453 | divverent | 2007-06-26 13:25:58 -0700 (Tue, 26 Jun 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_ogg.c

fix buffer overrun in vorbis decoder

------------------------------------------------------------------------
r7452 | divverent | 2007-06-26 06:57:33 -0700 (Tue, 26 Jun 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

sb_colon support for Nexuiz

------------------------------------------------------------------------
r7451 | divverent | 2007-06-26 01:36:10 -0700 (Tue, 26 Jun 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

in teamplay, frags counter now shows other teams instead of distribution/place in team colors

------------------------------------------------------------------------
r7450 | divverent | 2007-06-24 08:25:10 -0700 (Sun, 24 Jun 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

take the time used by the stuff before the server code into account when measuring the timing offset for server frames

------------------------------------------------------------------------
r7449 | divverent | 2007-06-24 07:52:17 -0700 (Sun, 24 Jun 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/server.h

Measure some timing values for output in status; also, if developer is 1, complain to the console if the server can't keep up with the game speed.

------------------------------------------------------------------------
r7448 | havoc | 2007-06-24 00:19:01 -0700 (Sun, 24 Jun 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

enhanced all cvar reading builtins to support multiple strings for the
cvar name
enhanced cvar_set to take multiple strings for the value

------------------------------------------------------------------------
r7447 | havoc | 2007-06-24 00:15:53 -0700 (Sun, 24 Jun 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

slight simplification/optimization of an if statement (no change in
behavior)

------------------------------------------------------------------------
r7446 | havoc | 2007-06-19 22:50:46 -0700 (Tue, 19 Jun 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

support modelflags field on entity without a model

------------------------------------------------------------------------
r7445 | havoc | 2007-06-19 22:40:55 -0700 (Tue, 19 Jun 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/csprogs.c

fix uninitialized variable when CSQC does not have ConsoleCommand

------------------------------------------------------------------------
r7444 | havoc | 2007-06-17 01:49:37 -0700 (Sun, 17 Jun 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/csprogs.c

fix problem in CL_VM_ConsoleCommand

------------------------------------------------------------------------
r7443 | havoc | 2007-06-17 01:48:08 -0700 (Sun, 17 Jun 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

fix strncmp to check for 3 parameters not 1

------------------------------------------------------------------------
r7442 | havoc | 2007-06-17 00:37:11 -0700 (Sun, 17 Jun 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/clprogdefs.h

some whitespace changes

------------------------------------------------------------------------
r7441 | havoc | 2007-06-17 00:32:52 -0700 (Sun, 17 Jun 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c

added view_angles field in csqc, no longer sets pmove_org or pmove_vel

------------------------------------------------------------------------
r7440 | havoc | 2007-06-17 00:22:10 -0700 (Sun, 17 Jun 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/csprogs.c

patch from Spike which implements colormap support on csqc entities

------------------------------------------------------------------------
r7439 | havoc | 2007-06-17 00:20:45 -0700 (Sun, 17 Jun 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

patch from Spike which makes csqc actually get loaded

------------------------------------------------------------------------
r7438 | havoc | 2007-06-17 00:19:59 -0700 (Sun, 17 Jun 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

patch from Spike which makes getstati accept 3 parameters to extract a
shifted bit range from a stat

------------------------------------------------------------------------
r7437 | havoc | 2007-06-17 00:16:31 -0700 (Sun, 17 Jun 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/gl_rmain.c

changed all references to entity_render_t->frame to frame2 to eliminate
the unnecessary field

------------------------------------------------------------------------
r7435 | havoc | 2007-06-16 16:45:13 -0700 (Sat, 16 Jun 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/svvm_cmds.c

fix a bug with bounding box measurement when
sv_gameplayfix_findradiusdistancetobox is 0

------------------------------------------------------------------------
r7432 | havoc | 2007-06-16 15:22:06 -0700 (Sat, 16 Jun 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c

implemented sv_gameplayfix_multiplethinksperframe

------------------------------------------------------------------------
r7431 | havoc | 2007-06-15 19:45:43 -0700 (Fri, 15 Jun 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

don't overflow 1024 byte buffer on quake protocol, this often happens
when bubbles rise from a dying player in e1m4 deathmatch

------------------------------------------------------------------------
r7430 | havoc | 2007-06-15 14:17:57 -0700 (Fri, 15 Jun 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

set ortho_x and ortho_y, forgot this before

------------------------------------------------------------------------
r7429 | havoc | 2007-06-15 01:54:47 -0700 (Fri, 15 Jun 2007) | 5 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_rmain.c

changed the meaning of VF_PERSPECTIVE false after discussion with Spike,
VF_FOV now determines the dimensions in all directions (in other words,
the view is from -VF_FOVX to +VF_FOVX horizontally, and -VF_FOVY to
+VF_FOVY vertically, in quake units)

------------------------------------------------------------------------
r7428 | havoc | 2007-06-15 01:09:01 -0700 (Fri, 15 Jun 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/sv_user.c

another attempt at fixing bugs with downloads caused by the workaround
that prevents old clients from getting disconnected on map change

------------------------------------------------------------------------
r7427 | havoc | 2007-06-15 00:58:20 -0700 (Fri, 15 Jun 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

use an entity limit based on the protocol

------------------------------------------------------------------------
r7426 | havoc | 2007-06-14 19:35:13 -0700 (Thu, 14 Jun 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

a refinement of the previous patch to only affect submodels, not all bsp
models

------------------------------------------------------------------------
r7425 | havoc | 2007-06-14 19:33:49 -0700 (Thu, 14 Jun 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

added r_polygonoffset_submodel_offset support in submodel shadow
rendering, fixing a bug that kept dlights from affecting submodels

------------------------------------------------------------------------
r7424 | havoc | 2007-06-14 00:16:12 -0700 (Thu, 14 Jun 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

fixed serverside bug with active weapon stat in old protocols

------------------------------------------------------------------------
r7423 | havoc | 2007-06-14 00:02:09 -0700 (Thu, 14 Jun 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

moved name validation code to server side

------------------------------------------------------------------------
r7422 | havoc | 2007-06-13 23:18:50 -0700 (Wed, 13 Jun 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c

added support for VF_PERSPECTIVE = false in frustum culling

------------------------------------------------------------------------
r7421 | havoc | 2007-06-13 23:17:33 -0700 (Wed, 13 Jun 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

fix sbar/crosshair state in csqc

------------------------------------------------------------------------
r7420 | havoc | 2007-06-13 22:37:59 -0700 (Wed, 13 Jun 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/clvm_cmds.c

fix some bugs in the last commit (perspective was off)

------------------------------------------------------------------------
r7419 | havoc | 2007-06-13 22:27:56 -0700 (Wed, 13 Jun 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/csprogs.h
   M /trunk/darkplaces/gl_rmain.c

implemented csqc VF_PERSPECTIVE, still needs more work but it's a start

------------------------------------------------------------------------
r7418 | havoc | 2007-06-13 21:42:00 -0700 (Wed, 13 Jun 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

restore some csqc variables in VM_R_ClearScene

------------------------------------------------------------------------
r7417 | havoc | 2007-06-13 21:13:09 -0700 (Wed, 13 Jun 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

added a CSQC code download print

------------------------------------------------------------------------
r7416 | havoc | 2007-06-13 21:06:16 -0700 (Wed, 13 Jun 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

print a message and call CL_BeginDownloads if a download is corrupt

------------------------------------------------------------------------
r7415 | havoc | 2007-06-13 20:58:38 -0700 (Wed, 13 Jun 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c

reworked sendsignon logic so that unlimited sends are allowed once
prespawn is sent by the client

------------------------------------------------------------------------
r7414 | havoc | 2007-06-13 20:41:40 -0700 (Wed, 13 Jun 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

make sure cl_downloadbegin will be sent

------------------------------------------------------------------------
r7413 | havoc | 2007-06-13 20:40:06 -0700 (Wed, 13 Jun 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/protocol.c

fix a bug in server support for PROTOCOL_NEHAHRAMOVIE

------------------------------------------------------------------------
r7412 | havoc | 2007-06-13 17:37:15 -0700 (Wed, 13 Jun 2007) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h

when spectating in nexuiz, use the current viewentity for scoreboard
information rather than the real player entity
(renamed cl.playerentity to cl.realplayerentity and made playerentity
update whenever viewentity is set to a valid client entity)

------------------------------------------------------------------------
r7411 | havoc | 2007-06-13 17:23:54 -0700 (Wed, 13 Jun 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

centered quake hud in deathmatch, this makes the new score block visible
removed use of the color cyan on the score block text, because the quake
numbers are brown and it makes them very dark

------------------------------------------------------------------------
r7410 | havoc | 2007-06-13 16:29:13 -0700 (Wed, 13 Jun 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/sbar.c
   M /trunk/darkplaces/sv_main.c

added a score-distribution/place/score block left of the hud
added a time remaining clock left of the hud (which shows time in level
instead if no timelimit is active or if the server does not send it)

------------------------------------------------------------------------
r7409 | havoc | 2007-06-13 01:42:51 -0700 (Wed, 13 Jun 2007) | 5 lines
Changed paths:
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/sv_main.c

removed the ^7 after player names in various engine messages and made
the player name change code append the ^7 if the name contains color
codes and the last one is not ^7, this gets rid of spurious ^7 tags seen
by non-DP clients

------------------------------------------------------------------------
r7408 | havoc | 2007-06-12 23:59:45 -0700 (Tue, 12 Jun 2007) | 7 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/netconn.h
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c

brought back the client->sendsignon flag from original quake code, this
fixes the occasional error message on old clients when a level change
occurs and chat messages or scoreboard updates or other reliable
messages are delivered to the client when it is not expecting them
(during model/sound loading when it is supposed to just be exchanging
keepalive messages)

------------------------------------------------------------------------
r7407 | havoc | 2007-06-12 22:41:31 -0700 (Tue, 12 Jun 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fix a warning's format string

------------------------------------------------------------------------
r7406 | havoc | 2007-06-11 10:38:39 -0700 (Mon, 11 Jun 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

tweaked some warnings on q1bsp texture loading to follow a consistent
formatting style and use developer prints for most of them

------------------------------------------------------------------------
r7405 | havoc | 2007-06-11 10:19:10 -0700 (Mon, 11 Jun 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c

added more developer prints when loading shaders
fixed shader loading to refuse empty texture names, this fixes support
for cmt4.bsp which has some unnamed textures

------------------------------------------------------------------------
r7404 | havoc | 2007-06-11 09:19:07 -0700 (Mon, 11 Jun 2007) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/csprogs.c

merged several identical pieces of worldmodel setup code into
a new function called CL_SetupWorldModel
CL_VM_Init no longer resets anything, CL_ClearState now sets up the
cl.csqc_vidvars defaults, this fixes the "no world model" bug

------------------------------------------------------------------------
r7403 | havoc | 2007-06-11 08:45:02 -0700 (Mon, 11 Jun 2007) | 5 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

added back rate limiting on old protocols, however sv_maxrate no longer
applies on old protocols, and quake clients and other old clients will
simply default to unlimited rate, so this allows a client to request a
lower rate but by default does not impose any limiting

------------------------------------------------------------------------
r7402 | havoc | 2007-06-11 08:41:07 -0700 (Mon, 11 Jun 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/libcurl.c

enable libcurl downloads by default

------------------------------------------------------------------------
r7401 | havoc | 2007-06-11 08:25:16 -0700 (Mon, 11 Jun 2007) | 6 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/sv_main.c

increase default sv_maxrate from 10KB/s to 1MB/s, this makes
unconfigured servers far more useful, especially for LAN games
increase default rate from 10KB/s to 20KB/s, this makes downloads go
faster and anyone who can handle 10KB/s is usually on broadband that can
handle 20KB/s (dialup and ISDN users will want to lower it)

------------------------------------------------------------------------
r7400 | havoc | 2007-06-10 22:40:52 -0700 (Sun, 10 Jun 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

move CL_VM_Init extern up a bit

------------------------------------------------------------------------
r7399 | havoc | 2007-06-10 22:38:20 -0700 (Sun, 10 Jun 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

don't use sv_maxrate when hosting old protocols

------------------------------------------------------------------------
r7398 | havoc | 2007-06-10 22:37:12 -0700 (Sun, 10 Jun 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

default new clients' rate to unlimited, DP clients will send an
appropriate value long before any ingame messages are sent, and the
sv_maxrate still applies

------------------------------------------------------------------------
r7397 | havoc | 2007-06-10 20:32:08 -0700 (Sun, 10 Jun 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/snd_main.c

fix sound spatialization and S_StartSound to deal with the 32768+entnum
sound call in csqc

------------------------------------------------------------------------
r7396 | havoc | 2007-06-10 18:28:37 -0700 (Sun, 10 Jun 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/csprogs.c

fix a runaway loop if parsing fails on csqc entities

------------------------------------------------------------------------
r7395 | havoc | 2007-06-10 16:49:43 -0700 (Sun, 10 Jun 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h

load csprogs.dat after it is downloaded

------------------------------------------------------------------------
r7394 | havoc | 2007-06-09 20:31:46 -0700 (Sat, 09 Jun 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/world.c

use world-> rather than sv.world. in World_LinkEdict_AreaGrid

------------------------------------------------------------------------
r7393 | havoc | 2007-06-09 19:39:38 -0700 (Sat, 09 Jun 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/csprogs.c

fix .frame2 csqc field

------------------------------------------------------------------------
r7392 | havoc | 2007-06-09 19:19:16 -0700 (Sat, 09 Jun 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

increased shader limit from 4096 to 16384, still need to change it to a
memexpandablearray_t sometime

------------------------------------------------------------------------
r7390 | divverent | 2007-06-04 14:42:10 -0700 (Mon, 04 Jun 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

bottom align mini DM overlay when not fully utilized

------------------------------------------------------------------------
r7389 | divverent | 2007-06-04 00:11:34 -0700 (Mon, 04 Jun 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

no team separator in mini DM overlay... prevent showing just two players (instead, draw a separator and show just one) for hud selector 0

------------------------------------------------------------------------
r7388 | divverent | 2007-06-03 09:08:30 -0700 (Sun, 03 Jun 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

HUD: mini overlay now supports teamplay (in team games, it shows all teams and the ones near your score in your team)

------------------------------------------------------------------------
r7387 | havoc | 2007-06-03 06:23:47 -0700 (Sun, 03 Jun 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

made deformvertexes autosprite2 work properly

------------------------------------------------------------------------
r7386 | havoc | 2007-06-01 18:54:49 -0700 (Fri, 01 Jun 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/lhnet.c

correct two warnings to say the correct function name (LHNET_Write
warnings were saying LHNET_Read)

------------------------------------------------------------------------
r7385 | havoc | 2007-06-01 01:02:21 -0700 (Fri, 01 Jun 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

added sbar_hudselector cvar which can choose a new hud in nexuiz if set
to 1

------------------------------------------------------------------------
r7384 | havoc | 2007-05-31 18:33:34 -0700 (Thu, 31 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/svvm_cmds.c
   M /trunk/dpmod/qc/dpextensions.qc

added DP_EF_NOGUNBOB extension

------------------------------------------------------------------------
r7383 | divverent | 2007-05-30 04:37:25 -0700 (Wed, 30 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

make gl_vbo saved as it slows down some chipsets

------------------------------------------------------------------------
r7382 | divverent | 2007-05-30 01:52:15 -0700 (Wed, 30 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_agl.c

OS X: make unknown char/keycode just a DPrint, reportedly some mouse drivers work fine apart from that they also send weird key codes

------------------------------------------------------------------------
r7381 | divverent | 2007-05-28 16:40:25 -0700 (Mon, 28 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

ignore r_glsl_contrastboost in range 0..1 (it breaks overbright pixels in that range), that is, the cvar now only does anything when > 1 (brighten up image) or < 0 (threshold effect)

------------------------------------------------------------------------
r7380 | divverent | 2007-05-28 14:46:15 -0700 (Mon, 28 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

contrast boost: change 1 to myhvec3(1, 1, 1) to make ATI driver happy (doesn't change fps on nvidia)

------------------------------------------------------------------------
r7379 | divverent | 2007-05-28 14:01:55 -0700 (Mon, 28 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

make degrading shaders actually WORK

------------------------------------------------------------------------
r7378 | divverent | 2007-05-28 06:35:07 -0700 (Mon, 28 May 2007) | 6 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

glsl doesn't allow dividing by zero (result is undefined, although sane on nvidia), so...
-"      color.rgb = SceneBrightness / (ContrastBoostCoeff + 1 / color.rgb);\n"
+"      color.rgb = color.rgb * SceneBrightness / (ContrastBoostCoeff * color.rgb + 1);\n"
also gains some fps apparently (7600GT here)
Weirdly, *= seems to be by 3fps slower than using = and *

------------------------------------------------------------------------
r7377 | divverent | 2007-05-28 05:29:48 -0700 (Mon, 28 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/render.h

new cvar r_glsl_contrastboost to do something similar to gamma in the GLSL shader... costs some fps when enabled, but works everywhere, and doesn't grey out as much as gamma (see http://hector.rbi.informatik.uni-frankfurt.de/nex/img/r_ambient4r_hdr_scenebrightness2r_glsl_contrastboost2.jpg vs http://hector.rbi.informatik.uni-frankfurt.de/nex/img/v_gamma2.jpg)

------------------------------------------------------------------------
r7376 | divverent | 2007-05-27 02:22:07 -0700 (Sun, 27 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

that was missing in 7372 (TAB should also hide the centerprinting of finale)

------------------------------------------------------------------------
r7375 | havoc | 2007-05-26 23:46:44 -0700 (Sat, 26 May 2007) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_lightning.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_sky.c

added polygonoffset as a texture property, used on submodels (such as
doors in q1bsp maps) to prevent zfighting if they exactly overlap a
wall, consistent with software quake (which intentionally removed the
portions of the door overlapping a wall)

------------------------------------------------------------------------
r7374 | havoc | 2007-05-26 23:42:10 -0700 (Sat, 26 May 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

default sv_gameplayfix_blowupfallenzombies to 0 in -hipnotic mode as it
messes up the friendly monsters

------------------------------------------------------------------------
r7373 | havoc | 2007-05-26 22:57:48 -0700 (Sat, 26 May 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_shadow.c

fixed recently introduced bug that made lightmapintensity affect dlights
and rtlights

------------------------------------------------------------------------
r7372 | havoc | 2007-05-26 15:15:27 -0700 (Sat, 26 May 2007) | 5 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

make showscores work while finale is up in all game modes
(this should not have been implemented as a nexuiz specific feature)
made monsters and secrets display check the STAT_TOTAL values to decide
whether to draw, rather than a nexuiz check

------------------------------------------------------------------------
r7371 | divverent | 2007-05-26 04:42:33 -0700 (Sat, 26 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/fractalnoise.c

change noise4f to a function that does not crash

------------------------------------------------------------------------
r7370 | divverent | 2007-05-26 03:19:37 -0700 (Sat, 26 May 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/sbar.c

intermission: store the current time to completed_time only on the first svc_intermission-like command (Nexuiz switches to svc_intermission for final scoreboard display and to svc_finale for the voting screen);
intermission: in GAME_NEXUIZ, display standard scoreboard instead of intermission overlay, and allow showscores (TAB) to override svc_finale overlay
scoreboard: in intermission, show the time when the game ended, not the current time

------------------------------------------------------------------------
r7369 | havoc | 2007-05-25 13:32:05 -0700 (Fri, 25 May 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h

reorganized rgbgen/alphagen/tcgen fields into their own structs to clean
up the code somewhat

------------------------------------------------------------------------
r7368 | havoc | 2007-05-25 01:03:48 -0700 (Fri, 25 May 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h

implemented deformvertexes (previously autosprite/autosprite2 had been
supported as a special case, but now all deformvertexes modes work)

------------------------------------------------------------------------
r7367 | havoc | 2007-05-25 00:57:11 -0700 (Fri, 25 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/fractalnoise.c
   M /trunk/darkplaces/quakedef.h

added a 4D noise function for use by shaders

------------------------------------------------------------------------
r7366 | divverent | 2007-05-24 23:40:21 -0700 (Thu, 24 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

ask for generated normals when usign Q3TCGEN_ENVIRONMENT

------------------------------------------------------------------------
r7365 | havoc | 2007-05-24 13:12:21 -0700 (Thu, 24 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h

added parsing of rgbgen wave and alphagen wave

------------------------------------------------------------------------
r7364 | havoc | 2007-05-24 00:35:30 -0700 (Thu, 24 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h

support multiple tcmod commands on a single layer

------------------------------------------------------------------------
r7363 | havoc | 2007-05-23 23:43:28 -0700 (Wed, 23 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

implemented tcgen

------------------------------------------------------------------------
r7362 | havoc | 2007-05-23 22:55:41 -0700 (Wed, 23 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/render.h

implemented tcmod (all forms)

------------------------------------------------------------------------
r7361 | havoc | 2007-05-23 20:37:44 -0700 (Wed, 23 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h

added loading of rgbgen/alphagen/tcgen/tcmod

------------------------------------------------------------------------
r7360 | havoc | 2007-05-23 18:49:26 -0700 (Wed, 23 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/render.h

remove unused rsurface.modelneighbor3i

------------------------------------------------------------------------
r7359 | havoc | 2007-05-23 18:36:13 -0700 (Wed, 23 May 2007) | 6 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h
   M /trunk/darkplaces/r_sprites.c
   M /trunk/darkplaces/render.h

eliminated rsurface.model, so there is now no dependence on having an
actual model in the material renderer
(except transparent surface queuing still needing an entity)
this cleanup means that the material renderer could be called from other
places without an entity (effects such as particles and lightning beams)

------------------------------------------------------------------------
r7358 | havoc | 2007-05-23 15:41:52 -0700 (Wed, 23 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/render.h

moved rsurface_ variables into rsurface struct as a minor cleanup

------------------------------------------------------------------------
r7356 | havoc | 2007-05-23 15:36:08 -0700 (Wed, 23 May 2007) | 6 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/svvm_cmds.c

added DP_QC_CVAR_DEFSTRING extension
corrected function descriptions of DP_QC_STRING_CASE_FUNCTIONS extension
to indicate that they are in that extension, previously they broke the
formatting convention by saying what they were for instead of the
extension they belong to

------------------------------------------------------------------------
r7355 | havoc | 2007-05-23 15:24:53 -0700 (Wed, 23 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/protocol.h

forgot to commit this change

------------------------------------------------------------------------
r7354 | havoc | 2007-05-23 15:07:18 -0700 (Wed, 23 May 2007) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/protocol.h

changed DP_SV_MODELFLAGS_AS_EFFECTS extension, now using any of the MF_
flags will override the model's flags
added EF_NOMODELFLAGS effect to disable model flags without replacing
them with anything new

------------------------------------------------------------------------
r7352 | havoc | 2007-05-23 13:51:31 -0700 (Wed, 23 May 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/render.h

removed rsurface_entity field, and copied all fields that were accessed
through it into rsurface_* fields

------------------------------------------------------------------------
r7350 | havoc | 2007-05-23 10:15:21 -0700 (Wed, 23 May 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

remove stupid int casts of pitch/yaw in beam code, yet another instance
of this legacy from quake that I hadn't killed yet

------------------------------------------------------------------------
r7349 | havoc | 2007-05-23 10:05:10 -0700 (Wed, 23 May 2007) | 7 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/sbar.c

changed server to not send pingplreport in response to "ping" command,
because it confuses non-DP clients and older DP clients (resulting in
the message "unknown command pingplreport" flooding the console)
changed client to send "pings" command to DP7 protocol servers so that
it gets only the pingplreport output, avoiding any potential misparsing
of ping reports and reducing bandwidth a little.

------------------------------------------------------------------------
r7348 | havoc | 2007-05-23 10:03:07 -0700 (Wed, 23 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

hide ping reports in demos

------------------------------------------------------------------------
r7347 | divverent | 2007-05-23 09:26:59 -0700 (Wed, 23 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/mathlib.h
   M /trunk/darkplaces/snd_main.c

replace funky !!a ^ !!b XOR usage by a new boolxor(a, b) macro that does that internally - should be more readable

------------------------------------------------------------------------
r7346 | divverent | 2007-05-23 04:31:54 -0700 (Wed, 23 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c

in v_flipped mode, invert the sense of snd_swapstereo

------------------------------------------------------------------------
r7344 | havoc | 2007-05-22 20:51:42 -0700 (Tue, 22 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

added support for "rgbgen lightingdiffuse" as a type of lighting

------------------------------------------------------------------------
r7343 | divverent | 2007-05-22 17:23:30 -0700 (Tue, 22 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_sprite.c
   M /trunk/darkplaces/r_sprites.c

damn, committed the old version of my patch... this now is the REAL v_flipped

------------------------------------------------------------------------
r7342 | divverent | 2007-05-22 17:11:40 -0700 (Tue, 22 May 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/model_sprite.c
   M /trunk/darkplaces/r_sprites.c

cvar: v_flipped flips all 3D view except sprites and flips input to compensate,
basically a poor man's left handed mode

------------------------------------------------------------------------
r7341 | havoc | 2007-05-22 13:17:21 -0700 (Tue, 22 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

call FS_ClearSearchPath in FS_Shutdown

------------------------------------------------------------------------
r7340 | havoc | 2007-05-22 13:15:24 -0700 (Tue, 22 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

close packs when clearing search path

------------------------------------------------------------------------
r7339 | havoc | 2007-05-22 13:07:56 -0700 (Tue, 22 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_null.c
   M /trunk/darkplaces/sound.h

renamed snd_reload to snd_unloadallsounds to clarify its purpose

------------------------------------------------------------------------
r7338 | havoc | 2007-05-22 11:46:56 -0700 (Tue, 22 May 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/svvm_cmds.c

enable svc_pointparticles1 protocol, because the pointparticles
extension is so new that compatibility with month-old clients that never
officially supported the DP_SV_POINTPARTICLES feature is not a concern

------------------------------------------------------------------------
r7337 | havoc | 2007-05-22 03:08:34 -0700 (Tue, 22 May 2007) | 5 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fixed bug in autosprite setup code that made it malfunction badly on any
non-world entity
rewrote autosprite code to make it a bit cleaner
rewrote autosprite2 code to make it work properly

------------------------------------------------------------------------
r7336 | divverent | 2007-05-22 01:07:34 -0700 (Tue, 22 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/lhnet.c

Win32: ioctl SIO_UDP_CONNRESET <- FALSE

------------------------------------------------------------------------
r7335 | divverent | 2007-05-22 00:39:05 -0700 (Tue, 22 May 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/sv_user.c

Reject clc_stringcmd with \r and \n in them; when developer is set, hex dump these commands.
Exception: \r and \n are allowed at the end of a clc_stringcmd, but get cut off before processing (DP builds from before yesterday did that with sentcvar commands).

------------------------------------------------------------------------
r7334 | havoc | 2007-05-21 22:50:19 -0700 (Mon, 21 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h

q3 shaders are now supported on all model and map formats

------------------------------------------------------------------------
r7333 | havoc | 2007-05-21 19:37:06 -0700 (Mon, 21 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/svvm_cmds.c

fix typo

------------------------------------------------------------------------
r7331 | havoc | 2007-05-21 16:08:37 -0700 (Mon, 21 May 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/svvm_cmds.c

added DP_SV_POINTPARTICLES extension string (the functions already
existed)

------------------------------------------------------------------------
r7330 | havoc | 2007-05-21 15:13:46 -0700 (Mon, 21 May 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/svvm_cmds.c

added svc_pointparticles1 for next protocol bump (uses 15 bytes instead
of 29 bytes for the potentially common case of zero velocity and a count
of 1)

------------------------------------------------------------------------
r7329 | divverent | 2007-05-21 14:14:34 -0700 (Mon, 21 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/keys.c

make ASCII 10 and ASCII 13 terminate messagemode too (fixes Ctrl-J, Ctrl-M, Num-Enter)

------------------------------------------------------------------------
r7328 | divverent | 2007-05-21 14:08:24 -0700 (Mon, 21 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

sentcvar: don't append a \n, it's a clc_stringcmd, these are not separated by \n!

------------------------------------------------------------------------
r7327 | havoc | 2007-05-20 15:42:39 -0700 (Sun, 20 May 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h

removed r_shadow_realtime_world_dlightshadows cvar, now the
r_shadow_realtime_dlight_shadows setting applies even in rtworld mode

------------------------------------------------------------------------
r7326 | havoc | 2007-05-20 15:32:51 -0700 (Sun, 20 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h

renamed r_shadow_shadow_polygon* cvars to r_shadow_polygon*

------------------------------------------------------------------------
r7325 | havoc | 2007-05-20 15:28:18 -0700 (Sun, 20 May 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

validate r_shadow_frontsidecasting each frame and correct it to a valid
value if invalid

------------------------------------------------------------------------
r7324 | havoc | 2007-05-20 15:26:48 -0700 (Sun, 20 May 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

made the effect of the r_shadow_shadow_polygonoffset cvar reverse when
r_shadow_frontsidecasting is off, so that only one setting needs
changing to toggle between the two modes

------------------------------------------------------------------------
r7323 | havoc | 2007-05-20 09:16:02 -0700 (Sun, 20 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

send input for every client frame in singleplayer

------------------------------------------------------------------------
r7322 | divverent | 2007-05-20 09:02:27 -0700 (Sun, 20 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/BSDmakefile
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/makefile.inc
   M /trunk/darkplaces/sys_shared.c

DP_PRELOAD_DEPENDENCIES=yes makefile option: when set, link against the libraries needed using -l dynamically so they won't get loaded at runtime using dlopen

------------------------------------------------------------------------
r7321 | divverent | 2007-05-20 07:59:03 -0700 (Sun, 20 May 2007) | 7 lines
Changed paths:
   M /trunk/darkplaces/cl_demo.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/cl_screen.h
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c

new option -capturedemo to capture a demo to an AVI file;
new cvars cl_capturevideo_width, cl_capturevideo_height to scale down video capture
when capturing >1GB, don't write an index chunk (in that case, an ix00/ix01 chunk has to be written, but that's not yet implemented)
when capturing, write a "dmlh" header to store the total number of frames, and store the partial number of frames in the "avih" header, as specified by OpenDML
when capturing, store the aspect ratio in a "vprp" header chunk (OpenDML)
make Host_Quit_f do nothing when already quitting (fixes "quit" issue while playing back a demo); note that Host_Quit_f is only used by the console and by -benchmark/-demo/-capturedemo

------------------------------------------------------------------------
r7320 | havoc | 2007-05-19 12:24:19 -0700 (Sat, 19 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/sv_main.c

don't send svc_statubyte or any stat index over 32 to old clients

------------------------------------------------------------------------
r7319 | havoc | 2007-05-19 12:23:34 -0700 (Sat, 19 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

don't send empty unreliable packets

------------------------------------------------------------------------
r7318 | havoc | 2007-05-19 11:42:03 -0700 (Sat, 19 May 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

fix bug that caused server to send incorrect format of .velocity in
svc_clientdata when using "QUAKEDP" protocol

------------------------------------------------------------------------
r7317 | havoc | 2007-05-19 05:01:02 -0700 (Sat, 19 May 2007) | 6 lines
Changed paths:
   M /trunk/darkplaces/vid_wgl.c

reworked newmouseparms[] code
removed -noforcemspd and -noforcemaccel options as they didn't make
sense when comparing to the MSDN documentation (-noforcemparms remains)
fixed any possible bugs with restoring originalmouseparms[]
added comments explaining the meaning of newmouseparms[] components

------------------------------------------------------------------------
r7316 | divverent | 2007-05-19 02:19:52 -0700 (Sat, 19 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_agl.c

kill mouse accel using IOHIDSetAccelerationWithKey(mouseDev, CFSTR(kIOHIDMouseAccelerationType), -1.0) instead, this is what System Preferences uses (otherwise, mouse accel doesn't get restored right on exit)

------------------------------------------------------------------------
r7315 | divverent | 2007-05-18 14:11:39 -0700 (Fri, 18 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_alsa.c
   M /trunk/darkplaces/snd_oss.c

more of these

------------------------------------------------------------------------
r7314 | divverent | 2007-05-18 14:08:47 -0700 (Fri, 18 May 2007) | 5 lines
Changed paths:
   M /trunk/darkplaces/snd_coreaudio.c

foo *var;
sizeof(var) is the size of the POINTER
sizeof(*var) is the size of the TYPE
Now it should work...

------------------------------------------------------------------------
r7313 | divverent | 2007-05-18 14:05:19 -0700 (Fri, 18 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_coreaudio.c

only memcpy the suggested format if the failure is not permanent! Otherwise, it can lead to endless loops

------------------------------------------------------------------------
r7312 | havoc | 2007-05-18 08:26:11 -0700 (Fri, 18 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cmd.c

implemented support for \" in console command parsing code

------------------------------------------------------------------------
r7311 | havoc | 2007-05-17 15:01:55 -0700 (Thu, 17 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

changed default of cl_netinputpacketsperserverpacket to 1.0

------------------------------------------------------------------------
r7310 | havoc | 2007-05-17 14:23:03 -0700 (Thu, 17 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

allow non-integer cl_netinputpacketsperserverpacket values

------------------------------------------------------------------------
r7309 | havoc | 2007-05-17 12:19:38 -0700 (Thu, 17 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

fix descriptions on cl_netinputpacketsper* cvars

------------------------------------------------------------------------
r7308 | havoc | 2007-05-17 12:14:36 -0700 (Thu, 17 May 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

added a cvar which allows the client to send more than one packet per
server packet, by default 2, this results in smoother demos when packet
loss is occurring with predicted movement

------------------------------------------------------------------------
r7307 | havoc | 2007-05-17 12:04:55 -0700 (Thu, 17 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

don't limit lerps to 100ms in demo playback

------------------------------------------------------------------------
r7306 | havoc | 2007-05-17 11:58:54 -0700 (Thu, 17 May 2007) | 7 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/host.c

moved the code that applies slowmo to demo playback so that it reacts
immediately to changes, not at the next packet read (which may never
come if slowmo was set to 0 at any point)
made pausedemo command freeze demo playback in a way that time does not
advance, preventing the problem where it fast forwards to catch up with
where it would have been if not paused after unpausing the demo

------------------------------------------------------------------------
r7303 | divverent | 2007-05-17 08:53:57 -0700 (Thu, 17 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.inc
   M /trunk/darkplaces/snd_coreaudio.c
   M /trunk/darkplaces/vid_agl.c

cvar apple_mouse_noaccel (1 default) disables mouse acceleration

------------------------------------------------------------------------
r7302 | divverent | 2007-05-17 08:50:10 -0700 (Thu, 17 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

setting skinframe to R_SkinFrame_LoadMissing for animmap too!

------------------------------------------------------------------------
r7301 | havoc | 2007-05-17 07:14:19 -0700 (Thu, 17 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_coreaudio.c

fix 3 typos

------------------------------------------------------------------------
r7300 | havoc | 2007-05-17 06:49:39 -0700 (Thu, 17 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt

renamed vid_dga to vid_dgamouse

------------------------------------------------------------------------
r7299 | havoc | 2007-05-17 06:45:35 -0700 (Thu, 17 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c

renamed vid_dga to vid_dgamouse

------------------------------------------------------------------------
r7298 | havoc | 2007-05-17 06:44:12 -0700 (Thu, 17 May 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c

cleaned up vid_dga code, removed vid_dga_mouseaccel cvar as it did the
same thing as sensitivity (and was not saved, and defaulted to 1)

------------------------------------------------------------------------
r7297 | havoc | 2007-05-17 04:55:41 -0700 (Thu, 17 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_coreaudio.c

improved coreaudio initialization code to suggest more changes

------------------------------------------------------------------------
r7296 | havoc | 2007-05-17 04:43:53 -0700 (Thu, 17 May 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/snd_coreaudio.c

fix CoreAudio support so that it suggests a proper sound speed when the
hardware returns a different value

------------------------------------------------------------------------
r7295 | divverent | 2007-05-17 03:16:58 -0700 (Thu, 17 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_agl.c

enable apple multithreaded GL by default; let's see when the first one complains

------------------------------------------------------------------------
r7294 | divverent | 2007-05-17 02:38:46 -0700 (Thu, 17 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/libcurl.c
   M /trunk/darkplaces/vid_glx.c

libcurl-4; vid_glx: RTLD_GLOBAL (apparently FreeBSD users need it)

------------------------------------------------------------------------
r7293 | havoc | 2007-05-16 10:15:09 -0700 (Wed, 16 May 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/r_light.c

trace corona checks from eye to light origin, this fixes light coronas
being seen inside walls in quake mission pack 2 on lightning traps

------------------------------------------------------------------------
r7292 | havoc | 2007-05-16 10:11:35 -0700 (Wed, 16 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fix some unused variables

------------------------------------------------------------------------
r7291 | havoc | 2007-05-16 10:11:04 -0700 (Wed, 16 May 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_demo.c

changed 1-frame warm-up period to 3 frames before time begins advancing
in the timedemo playback (meaning 3 identical frames are rendered first)
this should improve consistency of timedemo results

------------------------------------------------------------------------
r7290 | havoc | 2007-05-16 06:45:39 -0700 (Wed, 16 May 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/svvm_cmds.c

changed an error when fighting the end boss of Nehahra to merely a
warning, the qc should be fixed though

------------------------------------------------------------------------
r7289 | havoc | 2007-05-16 04:47:15 -0700 (Wed, 16 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/collision.c

hopefully fixed a bug in line/sphere collision code (not used)

------------------------------------------------------------------------
r7288 | havoc | 2007-05-16 02:27:04 -0700 (Wed, 16 May 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

optimized the Mod_Q3BSP_LightPoint pitch/yaw math by using the
mod_md3_sin table rather than a lot of angle math to feed to cos/sin

------------------------------------------------------------------------
r7287 | divverent | 2007-05-15 16:16:06 -0700 (Tue, 15 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cvar.c

only print Set: and SetA: for developer >= 100 (as only then, a Cvar_Get function call line always follows)

------------------------------------------------------------------------
r7286 | divverent | 2007-05-15 16:12:54 -0700 (Tue, 15 May 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

calling VM_SetTraceGlobals can create a tempstring for the texture name; thus,
make sure that the tempstring gets freed when VM_SetTraceGlobals gets called
from outside QC (before calling the touch function)

------------------------------------------------------------------------
r7285 | havoc | 2007-05-15 03:14:06 -0700 (Tue, 15 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/protocol.c

renamed QUAKEWORLD protocol to QW to shorten connect string

------------------------------------------------------------------------
r7284 | havoc | 2007-05-15 03:08:23 -0700 (Tue, 15 May 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/protocol.c

fix a bug that caused the DP server to only report the first two
protocols it supports rather than all

------------------------------------------------------------------------
r7280 | havoc | 2007-05-14 07:34:53 -0700 (Mon, 14 May 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

added a proper gl_lightmaps rendering path, previously the gl_lightmaps
option did not work with r_glsl 1 and affected sprites (which it was not
meant to)

------------------------------------------------------------------------
r7279 | divverent | 2007-05-14 07:31:57 -0700 (Mon, 14 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_ogg.c

oops, forgot to remove it...

------------------------------------------------------------------------
r7278 | divverent | 2007-05-14 07:25:46 -0700 (Mon, 14 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_ogg.c

need to explicitly load vorbis_comment_query from libvorbis, not libvorbisfile, on Win32

------------------------------------------------------------------------
r7277 | havoc | 2007-05-14 07:20:00 -0700 (Mon, 14 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

remove a piece of debugging code

------------------------------------------------------------------------
r7276 | havoc | 2007-05-14 07:07:27 -0700 (Mon, 14 May 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fixed lightmap merging bugs and added a special simplified case for
the case of no merging (mainly for testing)

------------------------------------------------------------------------
r7275 | havoc | 2007-05-14 05:24:55 -0700 (Mon, 14 May 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

reworked lightmap merging code to determine optimal texture size for
each merged lightmap texture (which basically means the last one is now
smaller than the rest in most cases)

------------------------------------------------------------------------
r7274 | divverent | 2007-05-14 05:03:07 -0700 (Mon, 14 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_ogg.c

LOOP_START tag in vorbis files now gives the sample number to loop from

------------------------------------------------------------------------
r7273 | havoc | 2007-05-14 03:28:00 -0700 (Mon, 14 May 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/render.h

restored the old lightmap batching code that I removed when adding the
lightmap merging, this helps a lot on maps that don't fit in one
1024x1024 lightmap

------------------------------------------------------------------------
r7272 | havoc | 2007-05-14 02:33:26 -0700 (Mon, 14 May 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_main.h
   M /trunk/darkplaces/snd_mix.c
   M /trunk/darkplaces/snd_ogg.c
   M /trunk/darkplaces/snd_wav.c

changed loopstart from signed to unsigned, now un-looped sounds are
represented with loopstart == total_length

------------------------------------------------------------------------
r7271 | havoc | 2007-05-14 02:12:25 -0700 (Mon, 14 May 2007) | 6 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_main.h
   M /trunk/darkplaces/snd_mix.c
   M /trunk/darkplaces/snd_ogg.c

removed channel_t->end and lastptime, now only pos governs playback
position, this should make the playback code safer
reworked S_PaintChannels to advance channel pos regardless of volume
changed S_StartSound to delay sounds rather than skip them, which may be
important on short sound effects

------------------------------------------------------------------------
r7270 | havoc | 2007-05-12 03:26:15 -0700 (Sat, 12 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

don't use cl_nettimesync code when playing a demo

------------------------------------------------------------------------
r7269 | havoc | 2007-05-12 03:02:06 -0700 (Sat, 12 May 2007) | 6 lines
Changed paths:
   M /trunk/darkplaces/keys.c

added a keyname for backslash which is now used instead of the literal \
character, avoiding issues with bind "\" "something" which was parsing
wrongly, also removed the quotes around the bind keyname, and changed
the keyname code to prefer using the override names (such as tilde
instead of ~) in binds when saving the config

------------------------------------------------------------------------
r7268 | havoc | 2007-05-12 02:46:58 -0700 (Sat, 12 May 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/fs.h
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/menu.h
   M /trunk/darkplaces/todo

patch from David Cristian which adds a "browse mods" menu which seems to
work quite well

------------------------------------------------------------------------
r7267 | divverent | 2007-05-11 01:45:14 -0700 (Fri, 11 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

fix description of cl_movement_wateraccelerate; make air movement use movevars_airaccelerate (fixes movement in Nexuiz Pro)

------------------------------------------------------------------------
r7266 | divverent | 2007-05-11 01:20:56 -0700 (Fri, 11 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

if .gravity field is zero, it means the same as one (see also: SV_AddGravity)

------------------------------------------------------------------------
r7265 | divverent | 2007-05-11 01:14:11 -0700 (Fri, 11 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

also send friction/waterfriction as stats

------------------------------------------------------------------------
r7264 | divverent | 2007-05-11 00:47:31 -0700 (Fri, 11 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix typo in r_q1bsp_skymasking cvar name

------------------------------------------------------------------------
r7263 | havoc | 2007-05-10 18:17:24 -0700 (Thu, 10 May 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

added back cl_netsyncboundmode 5 (4 with sub-millisecond adjustment when
very near the correct value)
added new default cl_nettimesyncboundmode 6, this is a hybrid of 1 and 5

------------------------------------------------------------------------
r7262 | havoc | 2007-05-10 18:04:45 -0700 (Thu, 10 May 2007) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/netconn.h
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sv_user.c
   M /trunk/darkplaces/svvm_cmds.c
   M /trunk/darkplaces/world.c

moved almost all server cvars to sv_main.c and added corresponding
externs in server.h
removed cl_gravity and cl_slowmo cvars
renamed cl.movevars_slowmo to cl.movevars_timescale

------------------------------------------------------------------------
r7261 | havoc | 2007-05-10 17:00:29 -0700 (Thu, 10 May 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sv_user.c

added friction and waterfriction movevars stats
corrected sv_airaccel_qw and sv_airaccel_sideways_friction cvars (they
had the wrong name string)

------------------------------------------------------------------------
r7257 | havoc | 2007-05-09 04:09:07 -0700 (Wed, 09 May 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/common.c

added back support for {}()[]: special characters in
COM_ParseToken_VM_Tokenize

------------------------------------------------------------------------
r7256 | havoc | 2007-05-09 04:00:14 -0700 (Wed, 09 May 2007) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/libcurl.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/sv_main.c

renamed COM_ParseTokenConsole to COM_ParseToken_Console
split COM_ParseToken into COM_ParseToken_Simple, COM_ParseToken_QuakeC
and COM_ParseToken_VM_Tokenize which have different support for special
characters

------------------------------------------------------------------------
r7255 | havoc | 2007-05-09 02:53:11 -0700 (Wed, 09 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

fixed several critical bugs in VM_tokenizebyseparator

------------------------------------------------------------------------
r7254 | havoc | 2007-05-09 02:29:56 -0700 (Wed, 09 May 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.c

fix broken OFS_PARM0 + index code in VM_M_callfunction and
VM_tokenizebyseparator, these were not multiplying by 3 as is required

------------------------------------------------------------------------
r7253 | havoc | 2007-05-08 17:17:21 -0700 (Tue, 08 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

removed a wasted normalize in fragment shader for model lighting

------------------------------------------------------------------------
r7252 | havoc | 2007-05-08 17:13:21 -0700 (Tue, 08 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

scale demo playback speed by slowmo cvar

------------------------------------------------------------------------
r7251 | divverent | 2007-05-07 16:19:14 -0700 (Mon, 07 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

GAME_NEXUIZ: move the key up a bit for keyhunt, looks better

------------------------------------------------------------------------
r7250 | divverent | 2007-05-07 14:36:32 -0700 (Mon, 07 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

Impossible combination of GAME_NEXUIZ CTF status icons ("have red flag | have blue flag") now displays an alternate image for the new keyhunt game mode

------------------------------------------------------------------------
r7249 | havoc | 2007-05-07 13:50:22 -0700 (Mon, 07 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_sprite.c

fix crash when loading progs/null.spr in nehahra, which has 0x0 size

------------------------------------------------------------------------
r7248 | divverent | 2007-05-07 11:23:22 -0700 (Mon, 07 May 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix glsl model lighting on unlit maps (normal vector was calculated as (0,0,0) as there was no contribution from the map -> GLSL calls normalize() on that -> (nan,nan,nan), which apparently counts as black).
The fix replaces these zero normal vectors by (0,0,1) (which vector is actually chosen does not matter, as its contribution is scaled by zero anyway).

------------------------------------------------------------------------
r7247 | divverent | 2007-05-07 10:17:38 -0700 (Mon, 07 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

let the slowmo cvar override the server/demo's idea of slowmo when it is != 1; makes slowmo work again for demo playback

------------------------------------------------------------------------
r7246 | havoc | 2007-05-07 01:46:37 -0700 (Mon, 07 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_rsurf.c

reduced uninitialized memory a bit more

------------------------------------------------------------------------
r7245 | havoc | 2007-05-07 00:28:00 -0700 (Mon, 07 May 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/protocol.h

reduced uninitialized data size by 13MB by moving some temporary arrays
used by outdated protocols into their database struct, also moved some
other arrays

------------------------------------------------------------------------
r7244 | havoc | 2007-05-06 23:46:04 -0700 (Sun, 06 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

replaced mod_known array with a memexpandablearray_t, this saves 11.5MB

------------------------------------------------------------------------
r7243 | havoc | 2007-05-06 22:37:08 -0700 (Sun, 06 May 2007) | 7 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/csprogs.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/svvm_cmds.c
   M /trunk/darkplaces/view.c

rewrote server sendstates building code, no longer builds two
entity_state_t arrays (where one of them is global and one per-client),
this is a slight efficiency loss but saves a few megabytes and makes the
customizeentityforclient code more straightforward
merged some global variables into cl. and sv. structs, and others became
arrays on the stack

------------------------------------------------------------------------
r7242 | havoc | 2007-05-06 20:41:11 -0700 (Sun, 06 May 2007) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_user.c

now sends player physics variables as stats, including slowmo, gravity,
and sys_ticrate, this avoids the need to stuffcmd cl_movement cvars
on servers that provide the ticrate stat the cl_netinputpacketspersecond
cvar is no longer important, this also seems to improve demo recording

------------------------------------------------------------------------
r7241 | havoc | 2007-05-06 20:01:40 -0700 (Sun, 06 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/world.c

removed PRVM_EDICT_NUM_UNSIGNED (PRVM_EDICT_NUM now casts to unsigned)

------------------------------------------------------------------------
r7240 | havoc | 2007-05-06 19:49:41 -0700 (Sun, 06 May 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/client.h

changed rain to spawn particles without collisions and implemented
delayed spawning of splashes to facilitate this

------------------------------------------------------------------------
r7239 | havoc | 2007-05-06 19:49:10 -0700 (Sun, 06 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_user.c

increased tolerance on warnings in DEBUGMOVES code

------------------------------------------------------------------------
r7238 | havoc | 2007-05-06 19:48:43 -0700 (Sun, 06 May 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c

fixed a reference to sv.models in client code (should have been
cl.model_precache)

------------------------------------------------------------------------
r7237 | havoc | 2007-05-06 15:46:43 -0700 (Sun, 06 May 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/wad.c
   M /trunk/darkplaces/wad.h

rewrote most of wad system, this eliminated 512KB of static arrays for
hlwad lumpinfo
added W_UnloadAll function which is now called by FS_Rescan

------------------------------------------------------------------------
r7236 | havoc | 2007-05-06 05:23:19 -0700 (Sun, 06 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

made r_depthfirst a saved cvar

------------------------------------------------------------------------
r7235 | havoc | 2007-05-06 04:37:04 -0700 (Sun, 06 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c

added support for \" in console

------------------------------------------------------------------------
r7234 | havoc | 2007-05-06 03:38:31 -0700 (Sun, 06 May 2007) | 5 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/model_sprite.c
   M /trunk/darkplaces/render.h

added r_depthfirst option which defaults to 1 (render depth of world
into scene before rendering color), and also offers 2 (render depth of
world and models), this saves shader fillrate on intensive shaders or
texturing techniques (deluxemapping, anisotropic filtering, etc)

------------------------------------------------------------------------
r7233 | havoc | 2007-05-06 03:13:43 -0700 (Sun, 06 May 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c

reworked sound mixing code to fix a bug that caused sound to stop
working after a timedemo (or anything else that overrode the normal
sound timing)

------------------------------------------------------------------------
r7232 | havoc | 2007-05-06 03:12:19 -0700 (Sun, 06 May 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix a bug that caused GL20 render path to always ask for tangents and
normals when rendering models

------------------------------------------------------------------------
r7230 | divverent | 2007-05-04 04:40:58 -0700 (Fri, 04 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

oops, the r_picmipworld should be CVAR_SAVE of course. Sorry for that.

------------------------------------------------------------------------
r7229 | divverent | 2007-05-04 02:29:57 -0700 (Fri, 04 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

r_picmipworld - when 0, gl_picmip does not apply to world models (because they tend to use much less texture memory than player models in Nexuiz)

------------------------------------------------------------------------
r7228 | havoc | 2007-05-04 00:01:34 -0700 (Fri, 04 May 2007) | 6 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/client.h

fixed broken trails (introduced by my attempt to fix them)
fixed a bug where attachments to viewmodelforclient entities would show
up in the world in chase_active 1 mode near 0 0 0
rain particles now trace ahead at spawn and only begin collision
checking when near the impact time

------------------------------------------------------------------------
r7227 | havoc | 2007-05-03 18:17:16 -0700 (Thu, 03 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/model_shared.c

reenabled code that unloads unused models on level change

------------------------------------------------------------------------
r7226 | havoc | 2007-05-03 00:40:58 -0700 (Thu, 03 May 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c

fix bug where attached models spawn a trail from their non-attached
start location to their new location on the first frame

------------------------------------------------------------------------
r7225 | divverent | 2007-05-02 06:49:57 -0700 (Wed, 02 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/palette.c

damn, I can't convert hex/dec...

------------------------------------------------------------------------
r7224 | divverent | 2007-05-02 06:20:35 -0700 (Wed, 02 May 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/palette.c

made palette colors more readable

------------------------------------------------------------------------
r7223 | havoc | 2007-05-01 21:36:28 -0700 (Tue, 01 May 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c

a slight cleanup of PaintAndSubmit conditions and S_Update early out
conditions

------------------------------------------------------------------------
r7222 | havoc | 2007-04-30 23:11:48 -0700 (Mon, 30 Apr 2007) | 6 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/netconn.c

significant cleanup of input networking code (reorganized and now uses
frametimes rather than timestamps for queued moves) and some refinements
to prediction code
tried to reimplement the anti-pogostick code and it's partially working
but not completely (mispredicts for one frame each time)

------------------------------------------------------------------------
r7221 | havoc | 2007-04-30 19:25:32 -0700 (Mon, 30 Apr 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/vid_shared.c

default vid_grabkeyboard to 0, it's already forced to 1 on fullscreen so
this should do no harm

------------------------------------------------------------------------
r7220 | divverent | 2007-04-30 16:00:58 -0700 (Mon, 30 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

make SV_PushMove push by playerclip faces too (by using the right contents mask for each pushed entity)

------------------------------------------------------------------------
r7219 | havoc | 2007-04-30 15:44:19 -0700 (Mon, 30 Apr 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

mvdsv sucks (changed *ver from showing a string like DarkPlaces Linux
14:15:44 Apr 30 2007, to simply \*ver\dp)

------------------------------------------------------------------------
r7218 | dresk | 2007-04-30 14:59:19 -0700 (Mon, 30 Apr 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_parse.c

Applied KadaverJack's patch on my cl_sound_ric_gunshot code that provides a small optimization by using bitwise operations instead of numerical calculations.
------------------------------------------------------------------------
r7216 | dresk | 2007-04-30 10:27:16 -0700 (Mon, 30 Apr 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.h
   M /trunk/darkplaces/svvm_cmds.c

Added DP_QC_STRING_CASE_FUNCTIONS extension, providing VM functions strtolower and strtoupper which return the lowercase and uppercase of strings respectively, available across the CL, SV and MENU VMs.
------------------------------------------------------------------------
r7215 | havoc | 2007-04-30 10:22:47 -0700 (Mon, 30 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

fix pl% calculation for QW servers (was using [i] instead of [j])

------------------------------------------------------------------------
r7214 | havoc | 2007-04-30 10:02:10 -0700 (Mon, 30 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

fix nettimesync bug after the recent cleanup

------------------------------------------------------------------------
r7213 | havoc | 2007-04-29 22:39:56 -0700 (Sun, 29 Apr 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_sprite.c
   M /trunk/darkplaces/render.h

implemented QW skin support, it's broken on skins that are not the same
size as the model skin though

------------------------------------------------------------------------
r7212 | havoc | 2007-04-29 22:39:00 -0700 (Sun, 29 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

count empty packets in rate limiting

------------------------------------------------------------------------
r7211 | havoc | 2007-04-29 22:28:29 -0700 (Sun, 29 Apr 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/image.c

fix a bug in texture path identification (the nopath case was occurring
even when there was a path, because it was checking the wrong variable)

------------------------------------------------------------------------
r7210 | havoc | 2007-04-29 22:27:03 -0700 (Sun, 29 Apr 2007) | 7 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

removed cl_nettimesyncboundmode 5 because it seems to print many more
time warnings than 4 does when developer is on
now sets cls.servermovesequence to cls.netcon->qw_incoming_sequence
now keeps around qw player entities if a packet does not contain any
(an fteqw server I was testing on sometimes sent packets containing
large reliable message groups but no player entities at all)

------------------------------------------------------------------------
r7209 | dresk | 2007-04-29 20:58:20 -0700 (Sun, 29 Apr 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/clvm_cmds.c

Updated cl_sound_ric_gunshot CVar to support multiple modes.  0 plays no sounds, 1 plays sounds on TE_GUNSHOT, 2 plays sounds on TE_GUNSHOTQUAD and 3 plays sounds on both TE_GUNSHOT and TE_GUNSHOTQUAD.  This is not bloat because the Crylink in Nexuiz uses TE_GUNSHOTQUAD, and most people don't want ricochet sounds on that (though if you do, all the merrier).
------------------------------------------------------------------------
r7208 | havoc | 2007-04-29 15:15:44 -0700 (Sun, 29 Apr 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

increased IP + UDP header overhead estimate from 18 bytes to 28 bytes
based on tcpdump results

------------------------------------------------------------------------
r7207 | divverent | 2007-04-29 12:36:05 -0700 (Sun, 29 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c

store into *colorindex again

------------------------------------------------------------------------
r7206 | dresk | 2007-04-27 16:25:47 -0700 (Fri, 27 Apr 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/clvm_cmds.c

Added cl_sound_ric_gunshot which specifies if the related cl_sound_ric and cl_sound_tink CVars will apply to te_gunshot and te_gunshotquad calls.  The default value is 0 and it is not saved.
------------------------------------------------------------------------
r7205 | divverent | 2007-04-27 15:57:01 -0700 (Fri, 27 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/prvm_cmds.c

make COM_StringLengthNoColors and COM_StringDecolorize get an additional length parameter to just work on part of a string (if set to 0, it means use the whole string); use that in centerprint drawing to fix centering issues in some odd situations like "^^^^^^^^^^^^^^^^^^^^^^^^^^".

------------------------------------------------------------------------
r7203 | havoc | 2007-04-26 13:20:20 -0700 (Thu, 26 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_sprite.c

clarified descriptions of r_mipsprites and r_mipskins

------------------------------------------------------------------------
r7202 | havoc | 2007-04-26 09:19:42 -0700 (Thu, 26 Apr 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

split cl_netpacketloss into cl_netpacketloss_send and
cl_netpacketloss_receive to allow more network testing

------------------------------------------------------------------------
r7197 | havoc | 2007-04-25 11:17:38 -0700 (Wed, 25 Apr 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/model_sprite.c

fixed bug where animated mdl skins (such as Tomaz's health box and
explobox models in dpmod) were getting freed because they were not
properly counted in the model->num_textures

------------------------------------------------------------------------
r7194 | havoc | 2007-04-25 09:41:34 -0700 (Wed, 25 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

changed default cl_movement_minping from 1 to 0

------------------------------------------------------------------------
r7193 | havoc | 2007-04-25 09:41:02 -0700 (Wed, 25 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

changed default cl_movement_minping from 50 to 1

------------------------------------------------------------------------
r7192 | havoc | 2007-04-25 07:47:02 -0700 (Wed, 25 Apr 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/zone.c

added tracking of memory usage of VBO/EBO buffers
added gl_vbostats command to list VBO/EBO buffers
added total VBO/EBO usage information in memstats

------------------------------------------------------------------------
r7191 | havoc | 2007-04-25 03:15:55 -0700 (Wed, 25 Apr 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fix bugs in Mod_Q3BSP_Loadtextures that caused crashes and other
sillyness

------------------------------------------------------------------------
r7190 | divverent | 2007-04-25 01:38:40 -0700 (Wed, 25 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

prevent abuse by ending netname with a ^: if the name is not a valid colored string, add a ^ if possible, and if there is no space for it, remove the trailing ^

------------------------------------------------------------------------
r7189 | divverent | 2007-04-25 00:18:16 -0700 (Wed, 25 Apr 2007) | 7 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/prvm_cmds.c

fix strlennocol/strdecolorize on unusual strings like "foo^";
now strlennocol returns the visible width (like before) and strdecolorize
returns a string that can be safely printed and that looks like the original,
just without the colors.

Moved decolorizing and counting to common.c.

------------------------------------------------------------------------
r7188 | havoc | 2007-04-24 16:17:36 -0700 (Tue, 24 Apr 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_sprite.c

isolated more of the texture loading code from the rest of model
loading, to avoid potential for crashes in dedicated servers

------------------------------------------------------------------------
r7187 | havoc | 2007-04-24 15:55:20 -0700 (Tue, 24 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_sprite.c

fixed crash in sprite loaders on dedicated servers

------------------------------------------------------------------------
r7186 | havoc | 2007-04-24 14:29:59 -0700 (Tue, 24 Apr 2007) | 6 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/model_sprite.c
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/svvm_cmds.c

added DP_SV_MODELFLAGS_AS_EFFECTS extension, this adds EF_ROCKET and
friends as effect bits in the protocol, the QC can use these constants
directly or can use the new .modelflags field to set them without float
precision issues caused by the large values, this basically means that
you can make an entity leave a blood trail, or look like a rocket

------------------------------------------------------------------------
r7185 | havoc | 2007-04-24 13:33:32 -0700 (Tue, 24 Apr 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/svvm_cmds.c

reverted dresk's DP_SV_ALLOWTOUCHWITHOWNER patch as it adds unnecessary
bloat when there is a well-known QuakeC approach to do this already

------------------------------------------------------------------------
r7184 | dresk | 2007-04-24 13:28:42 -0700 (Tue, 24 Apr 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/svvm_cmds.c

Added QC float .allowtouchwithowner .  Setting this to true allow an entity to touch its owner (ie. missile or grenade).  Be careful where you spawn your projectiles and assign this value, as you may end up detonating the projectile immediately.
------------------------------------------------------------------------
r7183 | havoc | 2007-04-24 12:24:32 -0700 (Tue, 24 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

allow model flags to work on attached entities

------------------------------------------------------------------------
r7182 | havoc | 2007-04-24 10:11:32 -0700 (Tue, 24 Apr 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

expanded texture name buffer so that names don't get clipped in
r_texturestats output

------------------------------------------------------------------------
r7181 | havoc | 2007-04-24 10:08:54 -0700 (Tue, 24 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

don't crash in Mod_BuildAliasSkinFromSkinFrame on dedicated servers

------------------------------------------------------------------------
r7180 | dresk | 2007-04-24 09:27:21 -0700 (Tue, 24 Apr 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/sv_main.c

Added standard color escapes to "changed name to" broadcast prints
------------------------------------------------------------------------
r7179 | dresk | 2007-04-24 09:11:13 -0700 (Tue, 24 Apr 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

Updated console command description of prvm_edicts (it had the description of prvm_edictset)
------------------------------------------------------------------------
r7178 | dresk | 2007-04-24 08:47:51 -0700 (Tue, 24 Apr 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/host_cmd.c

Added return to standard color coding in "status" command player listing
------------------------------------------------------------------------
r7177 | dresk | 2007-04-24 08:40:38 -0700 (Tue, 24 Apr 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/cl_main.c

Added check for MAX_MODELS in cl_modelindexlist command
------------------------------------------------------------------------
r7176 | dresk | 2007-04-24 08:37:47 -0700 (Tue, 24 Apr 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cmd.c

Removed modelindexlist command from cmd.c, shifted function as cl_modelindexlist into cl_main.c

Started modelindex at 1
------------------------------------------------------------------------
r7175 | dresk | 2007-04-24 08:30:47 -0700 (Tue, 24 Apr 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c

Added return to standard color coding in the "Player entered the game" and "Client "Player" Dropped" messages
------------------------------------------------------------------------
r7174 | dresk | 2007-04-24 08:21:56 -0700 (Tue, 24 Apr 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/cmd.c

Implemented console command 'modelindexlist' which lists all the models and their corresponding model index numbers
------------------------------------------------------------------------
r7173 | havoc | 2007-04-24 08:02:02 -0700 (Tue, 24 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_sprite.c
   M /trunk/darkplaces/model_sprite.h
   M /trunk/darkplaces/r_sprites.c

fixed missing sprite textures caused by purging code

------------------------------------------------------------------------
r7172 | havoc | 2007-04-24 07:41:57 -0700 (Tue, 24 Apr 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fix bug that made all textures without a shader definition have
numskinframes = 0, which caused purging to eliminate their textures

------------------------------------------------------------------------
r7171 | havoc | 2007-04-24 07:41:27 -0700 (Tue, 24 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

check if skinframe is NULL in R_SkinFrame_MarkUsed

------------------------------------------------------------------------
r7170 | havoc | 2007-04-24 07:23:25 -0700 (Tue, 24 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_sprite.c

fix a line I forgot to commit

------------------------------------------------------------------------
r7169 | dresk | 2007-04-24 06:25:23 -0700 (Tue, 24 Apr 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/svvm_cmds.c

Fixed a typo by not putting a whitespace after the DP_SV_NETADDRESS
------------------------------------------------------------------------
r7168 | havoc | 2007-04-24 06:19:07 -0700 (Tue, 24 Apr 2007) | 8 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/model_sprite.c
   M /trunk/darkplaces/r_sprites.c
   M /trunk/darkplaces/render.h

replaced Mod_LoadSkinFrame functions with R_SkinFrame system, this
allows multiple models to share textures in a given level, as well as
models using the same texture multiple times (often the case in md3
where meshes have a vertex limit, and q3bsp where texture structs
describe surface properties and multiple may exist referring to the same
texture set)
this reduced Nexuiz video memory usage by over 150MB

------------------------------------------------------------------------
r7167 | havoc | 2007-04-24 06:12:35 -0700 (Tue, 24 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_main.h

fix MAX_CHANNELS, it was too low with the expanded MAX_DYNAMIC_CHANNELS

------------------------------------------------------------------------
r7166 | havoc | 2007-04-24 03:14:46 -0700 (Tue, 24 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/zone.c

fix crash when freeing an expandable array caused by a typo

------------------------------------------------------------------------
r7165 | havoc | 2007-04-23 23:56:37 -0700 (Mon, 23 Apr 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/sys.h
   M /trunk/darkplaces/sys_shared.c
   M /trunk/darkplaces/vid_agl.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_null.c
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_wgl.c

audited all Sys_Quit calls and gave them return values indicating
whether the game quit normally, so shell scripts get a useful value

------------------------------------------------------------------------
r7164 | havoc | 2007-04-23 13:44:45 -0700 (Mon, 23 Apr 2007) | 5 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

replaced qglArrayElement calls with qglVertex3f calls in showtris code,
this avoids issues with abysmal gl_vbo 1 performance on NVIDIA cards
(which seem to use a software fallback for drawing lines for some
reason)

------------------------------------------------------------------------
r7162 | dresk | 2007-04-23 13:32:12 -0700 (Mon, 23 Apr 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/svvm_cmds.c

Added new extension for .string netaddress (DP_SV_NETADDRESS)
------------------------------------------------------------------------
r7161 | dresk | 2007-04-23 13:25:05 -0700 (Mon, 23 Apr 2007) | 1 line
Changed paths:
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c

Implemented .string netaddress to SVQC, providing the IP Address of the associated client entity (string is "null/botclient is client is not valid)
------------------------------------------------------------------------
r7160 | havoc | 2007-04-23 12:39:18 -0700 (Mon, 23 Apr 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

modified Mod_LoadSkinFrame to not attempt to generate a fogging mask if
not given the TEXF_ALPHA flag (in which case the fog mask would not be
used anyway)

------------------------------------------------------------------------
r7159 | havoc | 2007-04-23 12:13:39 -0700 (Mon, 23 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h

cleaned up Mod_LoadSkinFrame now that image_loadskin is gone

------------------------------------------------------------------------
r7158 | havoc | 2007-04-23 11:11:15 -0700 (Mon, 23 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/image.h
   M /trunk/darkplaces/model_shared.c

merged image_loadskin and image_freeskin into Mod_LoadSkinFrame

------------------------------------------------------------------------
r7157 | havoc | 2007-04-23 09:20:31 -0700 (Mon, 23 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/zone.c

fix some unintentional math on a void pointer

------------------------------------------------------------------------
r7154 | havoc | 2007-04-22 06:04:35 -0700 (Sun, 22 Apr 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/render.h

batch by lightmap rather than by use of lightmaps (batching by use of
lightmaps is no longer necessary with the lightmap merging)

------------------------------------------------------------------------
r7153 | havoc | 2007-04-22 04:24:17 -0700 (Sun, 22 Apr 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

added r_showbboxes cvar and accompanying code to render server entity
bounding boxes

------------------------------------------------------------------------
r7152 | havoc | 2007-04-22 02:52:01 -0700 (Sun, 22 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_lightning.c

fix a bug in the last commit pertaining to lightning beam fogging

------------------------------------------------------------------------
r7151 | havoc | 2007-04-22 02:48:18 -0700 (Sun, 22 Apr 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_lightning.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/todo

fixed several bugs in fog code, it basically wasn't working in the
r_glsl 0 case at all, it still doesn't work with rtlights in gl_combine
1 mode though

------------------------------------------------------------------------
r7150 | havoc | 2007-04-22 02:02:23 -0700 (Sun, 22 Apr 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

fixed bug where items would not fall if pushed off a ledge by a
MOVETYPE_PUSH entity

------------------------------------------------------------------------
r7149 | havoc | 2007-04-21 22:13:06 -0700 (Sat, 21 Apr 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/libcurl.c

correct a couple error messages which said "Map downloads", changed to
"cURL downloads"

------------------------------------------------------------------------
r7148 | divverent | 2007-04-20 15:36:23 -0700 (Fri, 20 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_agl.c

oops... sorry for that one. Copypaste without testing never works...

------------------------------------------------------------------------
r7147 | divverent | 2007-04-20 15:22:59 -0700 (Fri, 20 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_agl.c

fix multithreaded OpenGL support; actually load CGL functions from OpenGL.framework

------------------------------------------------------------------------
r7146 | divverent | 2007-04-20 08:59:28 -0700 (Fri, 20 Apr 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

compare the right values for host cache masks;
use -1 bots to indicate unknown bot count

------------------------------------------------------------------------
r7145 | divverent | 2007-04-20 04:43:24 -0700 (Fri, 20 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

new cvar fs_empty_files_in_pack_mark_deletions: when set, a pk3 with empty files can effectively "delete" a file in an earlier pk3

------------------------------------------------------------------------
r7144 | havoc | 2007-04-19 23:25:06 -0700 (Thu, 19 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_main.h

upped MAX_DYNAMIC_CHANNELS from 128 to 512

------------------------------------------------------------------------
r7143 | havoc | 2007-04-19 06:17:06 -0700 (Thu, 19 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/client.h

changed VERTEXFOGTABLE macro to not use a global variable

------------------------------------------------------------------------
r7142 | havoc | 2007-04-19 05:50:45 -0700 (Thu, 19 Apr 2007) | 6 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

significant cleanup of reliefmapping shader, now uses step() function
instead of if's, this might improve compatibility with ATI cards, but
not sure, in any case I improved the stepping math a little bit which
saves some time, minor fps improvement on reliefmapping compared to
before

------------------------------------------------------------------------
r7141 | havoc | 2007-04-19 00:32:00 -0700 (Thu, 19 Apr 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

adjusted netgraph code to draw the latest netgraph column on the right
rather than the left

------------------------------------------------------------------------
r7140 | havoc | 2007-04-18 17:44:52 -0700 (Wed, 18 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/mvm_cmds.c

correct a typo (numbotss)

------------------------------------------------------------------------
r7134 | divverent | 2007-04-18 04:38:57 -0700 (Wed, 18 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

sv_public -2 now allows the local: client to connect

------------------------------------------------------------------------
r7133 | havoc | 2007-04-18 04:15:58 -0700 (Wed, 18 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/protocol.c

fix a bug in the RENDER_EXTERIORMODEL check in the last commit

------------------------------------------------------------------------
r7132 | havoc | 2007-04-18 04:13:57 -0700 (Wed, 18 Apr 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/protocol.c

changed protocol code to always send origin as low precision if
possible, except for exteriormodel's (such as the player itself),
this means the only effect of EF_LOWPRECISION is lower precision angles

------------------------------------------------------------------------
r7131 | havoc | 2007-04-18 03:35:30 -0700 (Wed, 18 Apr 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

removed the forced LOWPRECISION flag on entities because it messes up
angles too much, and it is hard to decide what origins warrant high
precision or low precision

------------------------------------------------------------------------
r7130 | havoc | 2007-04-18 03:20:09 -0700 (Wed, 18 Apr 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/todo

improved entity unsticking code, it now uses a trace from the offset
position back to the original position, and uses the impact point, this
makes it correct significantly less than before

------------------------------------------------------------------------
r7129 | havoc | 2007-04-18 02:59:06 -0700 (Wed, 18 Apr 2007) | 6 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/todo

try unstick offsets in a certain order, preferring horizontal offsets
and then vertical, and never doing horizontal + vertical, this fixes
problems where you would 'creep' along the floor diagonally at certain
frametimes at certain plane distances where precision error causes
problems, now you only teleport upward 1 unit and fall repeatedly

------------------------------------------------------------------------
r7128 | havoc | 2007-04-18 02:29:50 -0700 (Wed, 18 Apr 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/zone.c
   M /trunk/darkplaces/zone.h

added Mem_ExpandableArray_IndexRange and
Mem_ExpandableArray_RecordAtIndex which allow iterating the array

------------------------------------------------------------------------
r7127 | havoc | 2007-04-18 02:17:54 -0700 (Wed, 18 Apr 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/zone.c
   M /trunk/darkplaces/zone.h

added Mem_ExpandableArray functions, which are not currently used but
may be useful

------------------------------------------------------------------------
r7126 | havoc | 2007-04-18 02:17:33 -0700 (Wed, 18 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

added cl_nettimesyncboundmode 5 which is div0's slight refinement of 4

------------------------------------------------------------------------
r7125 | havoc | 2007-04-18 01:08:31 -0700 (Wed, 18 Apr 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/netconn.h

added numbots and numhumans in server info parsing, serverlist filtering
can also mask by these, and the 'player empty' check for the engine's
own server listings now uses numhumans rather than numplayers

------------------------------------------------------------------------
r7124 | havoc | 2007-04-18 00:51:11 -0700 (Wed, 18 Apr 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

added reporting of number of bots in getinfo/getstatus replies (they are
counted as clients also, so something parsing the info can deduct them
if it wishes)

------------------------------------------------------------------------
r7123 | havoc | 2007-04-18 00:00:49 -0700 (Wed, 18 Apr 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c

fix bug introduced in last patch that made all text print one character
to the left

------------------------------------------------------------------------
r7122 | havoc | 2007-04-17 23:45:31 -0700 (Tue, 17 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c

further optimized space skipping in DrawQ_String

------------------------------------------------------------------------
r7121 | havoc | 2007-04-17 23:20:32 -0700 (Tue, 17 Apr 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

changed weapons bar in nexuiz hud to use alpha rather than additive
blend, and have full opacity for 1 second and then fade over half a second

------------------------------------------------------------------------
r7120 | havoc | 2007-04-17 22:52:36 -0700 (Tue, 17 Apr 2007) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/draw.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/sbar.c

refactored DrawQ_Pic to actually do the drawing rather than wasting time
on a DrawQ_SuperPic call
added DrawQ_Fill as an optimized case of DrawQ_Pic
this significantly improved performance of shownetgraph

------------------------------------------------------------------------
r7119 | havoc | 2007-04-17 22:33:17 -0700 (Tue, 17 Apr 2007) | 9 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/draw.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/sbar.c
   M /trunk/darkplaces/todo

changed r_textshadow behavior to always draw a black shadow, but with
alpha dependent on the brightness of the primary text color, this means
you don't get white shadows under black text, but do get black shadows
under white text
rewrote DrawQ_String and friends to be one combined function that draws
colored strings more efficiently by batching characters with differing
colors together, and it even batches the shadow with the text which can
help performance significantly with r_textshadow on

------------------------------------------------------------------------
r7118 | havoc | 2007-04-17 04:59:40 -0700 (Tue, 17 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

renamed client netgraphs back to incoming and outgoing

------------------------------------------------------------------------
r7117 | havoc | 2007-04-17 04:51:02 -0700 (Tue, 17 Apr 2007) | 6 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

added shownetgraph 2 mode which shows netgraphs for all clients when
hosting a listen server
tweaked shownetgraph separator spacing a bit so that it is only 2 pixels
between incoming/outgoing graphs, and 4 pixels between netgraphs
relabeled incoming/outgoing graphs to world/input

------------------------------------------------------------------------
r7116 | havoc | 2007-04-17 04:50:04 -0700 (Tue, 17 Apr 2007) | 6 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/host.c

moved calls of CL_ReadDemoMessage and CL_SendMove from CL_ReadFromServer
to the main loop
renamed CL_ReadFromServer to CL_UpdateWorld, and it is now called even
if not connected (to clear the r_refdef entities/lights info, and the
num_brushmodels)

------------------------------------------------------------------------
r7115 | havoc | 2007-04-17 04:48:51 -0700 (Tue, 17 Apr 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

no longer sends nearly-empty input packets when cl.time is less than the
previous move time

------------------------------------------------------------------------
r7114 | havoc | 2007-04-17 02:32:44 -0700 (Tue, 17 Apr 2007) | 6 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h

replaced cl_nettimesyncmode with 3 cvars cl_nettimesyncfactor,
cl_nettimesyncboundmode, cl_nettimesyncboundtolerance
the new default time sync method is from Quake3 and slowly adjusts 1ms
forward each packet received, or falls back 2ms if it found itself ahead
of time

------------------------------------------------------------------------
r7113 | havoc | 2007-04-17 01:03:27 -0700 (Tue, 17 Apr 2007) | 5 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

fix a crash reported by Lardarse when using more skin textures for a
.mdl model than skins exist in the model, this was caused by texture_t
containing pointers to itself that were broken by the reallocation of
the array

------------------------------------------------------------------------
r7112 | havoc | 2007-04-16 22:54:26 -0700 (Mon, 16 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/todo

moved shownetgraph to right side of screen

------------------------------------------------------------------------
r7111 | divverent | 2007-04-16 14:51:29 -0700 (Mon, 16 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c

in X11, keypad * is KP_MULTIPLY, not '*'

------------------------------------------------------------------------
r7110 | havoc | 2007-04-16 06:37:42 -0700 (Mon, 16 Apr 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/host.c

server no longer calls networking on each physics frame (since sv.datagram
is no longer important)

------------------------------------------------------------------------
r7109 | havoc | 2007-04-16 06:36:31 -0700 (Mon, 16 Apr 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

disable some debugging code that caused an empty packet to be sent each
server frame even if CanSend returned false (which was done just to see
when the CanSend blocking was occurring, since it was hard to tell)

------------------------------------------------------------------------
r7108 | havoc | 2007-04-16 06:08:38 -0700 (Mon, 16 Apr 2007) | 7 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/netconn.h
   M /trunk/darkplaces/sv_main.c

implemented shownetgraph
major overhaul of rate limiting code
implemented packet-frequency rate limiting (like qw/q2/q3) as a fallback
when packet size limiting fails (such as packet sizes below 100 bytes
causing all sorts of issues, so now the minimum bound on maxsize is 100,
and another good example is reliable messages exceeding the rate limit)

------------------------------------------------------------------------
r7107 | havoc | 2007-04-16 06:05:26 -0700 (Mon, 16 Apr 2007) | 8 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

fixed several issues in the recent effect rate limiting code (situations
where it could get stuck and stop sending them entirely due to too low a
rate setting)
fixed issues introduced in recent stats code (was not resetting them on
a level change, leading to very broken stats for the client)
this includes a missing part of the LOWPRECISION-on-all-entities patch so
that now works

------------------------------------------------------------------------
r7106 | havoc | 2007-04-16 05:21:00 -0700 (Mon, 16 Apr 2007) | 7 lines
Changed paths:
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/sv_user.c

EF_LOWPRECISION is now default on all entities except the player, this
saves quite a bit of bandwidth (bad side effect: rotating bmodels are
less smooth, need another workaround for that...)
fixed a bug in entity priorities which caused entities to be sent with
no change bits set (which did nothing useful, just wasted bandwidth),
saving quite a bit more bandwidth

------------------------------------------------------------------------
r7105 | havoc | 2007-04-16 00:57:51 -0700 (Mon, 16 Apr 2007) | 9 lines
Changed paths:
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/prvm_exec.c
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/svvm_cmds.c

sv.datagram is now flushed to client->unreliablemsg buffers, along with
logging of good split points so that each effect can be issued to
different packets as space allows (sending some each packet), this makes
effects finally obey the rate limit
cleaned up sending of csqc stats in pre-DP6 protocols and renamed the
autosentstats stuff to customstats to better represent what it does
implemented stats updates in pre-DP6 protocols (mostly for sake of
customstats code cleanlyness)

------------------------------------------------------------------------
r7104 | havoc | 2007-04-15 16:37:17 -0700 (Sun, 15 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

made cl_joinbeforedownloadsfinish a saved cvar

------------------------------------------------------------------------
r7103 | havoc | 2007-04-15 16:36:43 -0700 (Sun, 15 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

made cl_nettimesyncmode a saved cvar

------------------------------------------------------------------------
r7102 | havoc | 2007-04-15 15:13:01 -0700 (Sun, 15 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

added cl_nettimesyncmode 7 (adaptive + loose sync)

------------------------------------------------------------------------
r7101 | havoc | 2007-04-15 14:59:02 -0700 (Sun, 15 Apr 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

added cl_nettimesyncmode 6 (adaptive sync, gradually adapts to server
sync)

------------------------------------------------------------------------
r7100 | havoc | 2007-04-15 14:42:45 -0700 (Sun, 15 Apr 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

increased cl_nettimesyncmode 5 tolerance to 25% of time delta to better
accomodate german ADSL

------------------------------------------------------------------------
r7099 | havoc | 2007-04-15 14:36:53 -0700 (Sun, 15 Apr 2007) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

changed cl_nettimesyncmode 2 to use tighter tolerances again (1 frame,
not 2)
added cl_nettimesyncmode 5 (new default) which is like 2 but has very
tight tolerances (1/8th of frame delta)

------------------------------------------------------------------------
r7098 | havoc | 2007-04-15 13:52:08 -0700 (Sun, 15 Apr 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_sprite.c

sp2 loader no longer errors if an image is missing
(WHY did it do this before??)

------------------------------------------------------------------------
r7097 | divverent | 2007-04-15 13:01:38 -0700 (Sun, 15 Apr 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/svvm_cmds.c

New console commands sv_cmd, menu_cmd, cl_cmd, that call GameCommand(string s) in the server, menu, client program with the remainder of the command line as argument. Extension: DP_QC_CMD for all of them, DP_SV_CMD for sv_cmd.


------------------------------------------------------------------------
r7096 | divverent | 2007-04-15 02:21:17 -0700 (Sun, 15 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_sprite.c

adds a cvar r_picmipsprites that, when set to 0, makes gl_picmip not affect sprites

------------------------------------------------------------------------
r7095 | divverent | 2007-04-14 13:44:36 -0700 (Sat, 14 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

fix segfault sendcvar for non existing cvars introduced in r6933

------------------------------------------------------------------------
r7094 | havoc | 2007-04-14 11:27:13 -0700 (Sat, 14 Apr 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

changed default cl_autodemo_nameformat to put demos in an autodemos/
directory (they clutter the id1 directory too much)

------------------------------------------------------------------------
r7093 | havoc | 2007-04-13 18:11:00 -0700 (Fri, 13 Apr 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/cd_shared.c
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/vid_agl.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_wgl.c

removed all commandline checks for the option "-safe" except for the
OpenGL extension checks, this makes -safe actually playable

------------------------------------------------------------------------
r7092 | havoc | 2007-04-13 15:53:33 -0700 (Fri, 13 Apr 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_shared.h

saved a little more memory by not keeping around the basebonepose data
after loading (it can be regenerated by inverting the inverse array
anyway)

------------------------------------------------------------------------
r7091 | havoc | 2007-04-13 15:41:27 -0700 (Fri, 13 Apr 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

fix broken allocation code for skeletal models that was allocating too
much memory for basebonepose arrays (thanks to Vic for reporting this)

------------------------------------------------------------------------
r7090 | havoc | 2007-04-13 15:20:03 -0700 (Fri, 13 Apr 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

removed cl_nettimesyncmode 5 code, changed default to 1 (5 had no
theoretical advantages over 1)

------------------------------------------------------------------------
r7089 | havoc | 2007-04-13 15:08:32 -0700 (Fri, 13 Apr 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

added cl_nettimesyncmode 5 (now the default), this is very similar to
cl_nettimesyncmode 1 but allows up to 1 millisecond fluctuations

------------------------------------------------------------------------
r7088 | havoc | 2007-04-13 08:32:41 -0700 (Fri, 13 Apr 2007) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

changed .viewzoom field to scale view frustum slopes rather than fov
angle, this makes zooming more fluid and straightforward, and causes a 1
to 1 correspondence between the sensitivity decrease and the view size
decrease

------------------------------------------------------------------------
r7082 | havoc | 2007-04-11 17:39:30 -0700 (Wed, 11 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/todo

changed descriptions of r_ambient and r_fullbright cvars to no longer say that they don't work in multiplayer (because they do currently)

------------------------------------------------------------------------
r7081 | havoc | 2007-04-11 17:38:14 -0700 (Wed, 11 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

removed some unnecessary code in CL_TimeRefresh_f

------------------------------------------------------------------------
r7080 | havoc | 2007-04-11 17:37:20 -0700 (Wed, 11 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c

implemented two more checks for cls.timedemo to bypass snd_blocked

------------------------------------------------------------------------
r7079 | havoc | 2007-04-11 04:52:34 -0700 (Wed, 11 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c

added cls.timedemo check in S_PaintAndSubmit to use cl.mtime[0] for sound sync when doing timedemos, this greatly improves the accuracy of benchmarks with respect to sound mixing time

------------------------------------------------------------------------
r7074 | havoc | 2007-04-07 14:29:03 -0700 (Sat, 07 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

patch from div0 to fix nexuiz ctf flag icon code so it works with vid_conwidth values other than 640

------------------------------------------------------------------------
r7073 | havoc | 2007-04-07 13:52:25 -0700 (Sat, 07 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fixed a third instance of the length(CubeVector) attenuation code bug (passing a single float to a 2D texture fetch)

------------------------------------------------------------------------
r7072 | havoc | 2007-04-07 13:27:31 -0700 (Sat, 07 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c

the value of r_textshadow now controls the amount of offset for the shadow in pixels (formerly it was 25% of text size which typically meant 2 pixels)

------------------------------------------------------------------------
r7071 | havoc | 2007-04-07 11:02:45 -0700 (Sat, 07 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/csprogs.c

somehow forgot to save this file before committing the RENDER_NOSELFSHADOW patch

------------------------------------------------------------------------
r7070 | havoc | 2007-04-07 05:36:25 -0700 (Sat, 07 Apr 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/todo

player model no longer shadows gun model
technical explanation: this was done by adding a RENDER_NOSELFSHADOW flag which is used on view models, this flag prevents any entities using the flag from shadowing themselves or eachother...  then another hack was added to queue the shadowing of the RENDER_EXTERIORMODEL entities in the RENDER_NOSELFSHADOW batch (so it does not shadow other RENDER_NOSELFSHADOW entities), but still have it receive shadows by lighting it in the normal self-shadowing batch...   In more general use the RENDER_NOSELFSHADOW flag could be used to make characters not shadow themselves (like in Doom3), however r_shadow_frontsidecasting 0 is a better approach to that problem (partial self-shadowing characters)

------------------------------------------------------------------------
r7069 | havoc | 2007-04-07 01:09:47 -0700 (Sat, 07 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h

added clearstencil parameter to R_Shadow_RenderMode_StencilShadowVolumes

------------------------------------------------------------------------
r7068 | havoc | 2007-04-07 01:07:08 -0700 (Sat, 07 Apr 2007) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/darkplaces.txt
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_lightning.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/r_sprites.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/view.c

added GL_DepthRange function and MATERIALFLAG_SHORTDEPTHRANGE (now used by viewmodels), this prevents viewmodels from poking into walls
changed EF_NODEPTHTEST code to set MATERIALFLAG_SHORTDEPTHRANGE instead of MATERIALFLAG_NODEPTHTEST, this causes proper rendering of opaque models (such as the held item in prydon gate)
this also reenabled stencil shadows on view models but they render as if they are very very small (due to MATERIALFLAG_SHORTDEPTHRANGE)
changed default value of cl_viewmodel_scale from 0.3 to 1, this makes stereo rendering look better (small gun model looks silly when you can actually see that it is small) and makes rtlight cubemaps affect the gun more realistically

------------------------------------------------------------------------
r7065 | havoc | 2007-04-06 05:48:52 -0700 (Fri, 06 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_brush.h

view models no longer receive stencil shadows (only basic light visibility culling like transparent surfaces receive), this makes the gun much more visible and protects it the player's own shadow, this change may is a major one and may get further changes (such as better culling perhaps)

------------------------------------------------------------------------
r7064 | havoc | 2007-04-06 05:39:53 -0700 (Fri, 06 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

fix one more case of EF_NODEPTHTEST not being checked

------------------------------------------------------------------------
r7063 | havoc | 2007-04-06 05:31:00 -0700 (Fri, 06 Apr 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_sprite.c

removed MATERIALFLAG_TRANSPARENT
added MATERIALFLAGMASK_DEPTHSORTED - this solved a lack of sorting on EF_NODEPTHTEST entities

------------------------------------------------------------------------
r7062 | havoc | 2007-04-06 04:29:03 -0700 (Fri, 06 Apr 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/snd_alsa.c
   M /trunk/darkplaces/snd_coreaudio.c
   M /trunk/darkplaces/snd_sdl.c

check vid_activewindow in several spammy prints that occur when the client is running slower than the server
changed cl.time warnings from developer 10 to developer 100 and check vid_activewindow

------------------------------------------------------------------------
r7061 | havoc | 2007-04-06 03:29:06 -0700 (Fri, 06 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

added cl_nettimesyncmode 4, this is not the default, just another option to experiment with

------------------------------------------------------------------------
r7060 | havoc | 2007-04-06 02:48:52 -0700 (Fri, 06 Apr 2007) | 6 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

made the following changes to CL_NetworkTimeReceived:
changed cl_nettimesyncmode 2 to be more tolerant of out of bounds values, this fixes occasional choppyness
now prints warnings if time is out of bounds if developer is 10 or higher
simplified some code
disabled time interpolation code during signon process, this should give better starting values for cl.time

------------------------------------------------------------------------
r7059 | havoc | 2007-04-06 02:42:43 -0700 (Fri, 06 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

changed "new engine string" prints to also include the current text stored in the string, to aid in understanding what engine strings are being used

------------------------------------------------------------------------
r7058 | havoc | 2007-04-06 02:41:58 -0700 (Fri, 06 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_alsa.c
   M /trunk/darkplaces/snd_coreaudio.c
   M /trunk/darkplaces/snd_sdl.c

changed "sample frames missing" and similar warnings to require developer 1000 or higher

------------------------------------------------------------------------
r7057 | havoc | 2007-04-05 22:25:18 -0700 (Thu, 05 Apr 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

fixed a bug where the loading plaque caused front buffer rendering of all later stereo views (glDrawBuffer was not being set in stereo rendering, except when vid_stereobuffer was used)
swapped left/right views so that positive values for r_stereo_separation produce normal stereo, not cross-eyed
added r_stereo_angle cvar based on a patch from Thomas Spriggs, this allows you to make the views look different directions, in addition to the existing offset capability

------------------------------------------------------------------------
r7056 | havoc | 2007-04-05 22:22:01 -0700 (Thu, 05 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/view.c

cl_bobmodel_side and cl_bobmodel_up cvars now are scaled by cl_viewmodel_scale so that cl_viewmodel_scale can be changed without affecting the amount of viewmodel movement on the screen

------------------------------------------------------------------------
r7055 | havoc | 2007-04-05 03:31:42 -0700 (Thu, 05 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c

fix bug with cl_nolerp 1 that caused playdemo to play back at timedemo speeds

------------------------------------------------------------------------
r7054 | havoc | 2007-04-05 01:47:17 -0700 (Thu, 05 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

fixed bug where dpmod weapons fired twice as often as intended (frametime is now 0 in calls to PlayerPreThink/PlayerPostthink on input moves)

------------------------------------------------------------------------
r7053 | havoc | 2007-04-05 01:25:54 -0700 (Thu, 05 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

fix another prediction issue (physics code was being called per input frame and per server frame)

------------------------------------------------------------------------
r7052 | havoc | 2007-04-05 01:21:19 -0700 (Thu, 05 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sv_user.c

reworked predicted player physics to call PlayerPreThink before the move and PlayerPostThink after the move, in addition to calling those surrounding the regular physics code, hopefully this doesn't break anything, it fixes the jumping bug introduced in the recent changes

------------------------------------------------------------------------
r7051 | havoc | 2007-04-05 00:50:22 -0700 (Thu, 05 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

changed sv.time to realtime in name change time limit code

------------------------------------------------------------------------
r7050 | havoc | 2007-04-05 00:14:09 -0700 (Thu, 05 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/lhnet.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/sbar.c

eliminated most calls to Sys_DoubleTime (using realtime instead, or in one case a different sort of check)

------------------------------------------------------------------------
r7049 | havoc | 2007-04-05 00:02:29 -0700 (Thu, 05 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

fix severe timing issues regarding the global variable realtime which governs many things in the engine

------------------------------------------------------------------------
r7048 | havoc | 2007-04-04 22:09:59 -0700 (Wed, 04 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_user.c

fix bug with players not moving during the input timeout after prediction is intentionally disabled

------------------------------------------------------------------------
r7047 | havoc | 2007-04-04 12:06:54 -0700 (Wed, 04 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fixed compile error in GLSL shader with the new textured attenuation code

------------------------------------------------------------------------
r7046 | havoc | 2007-04-04 08:22:02 -0700 (Wed, 04 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h
   M /trunk/darkplaces/render.h

implemented vbo rendering of map, models, and compiled shadow volumes

------------------------------------------------------------------------
r7045 | havoc | 2007-04-04 08:21:34 -0700 (Wed, 04 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h

added gl_vbo cvar to allow disabling of vbo rendering (and vbo creation while loading models) for immediate comparison of framerates with/without vbo

------------------------------------------------------------------------
r7044 | havoc | 2007-04-04 04:54:05 -0700 (Wed, 04 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/todo

now creates EBOs and VBOs containing static model geometry, map geometry, and compiled shadows

------------------------------------------------------------------------
r7043 | havoc | 2007-04-04 03:18:14 -0700 (Wed, 04 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_lightning.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_sky.c

added bufferobject and bufferoffset parameters to all R_Mesh_*Pointer functions and R_Mesh_Draw

------------------------------------------------------------------------
r7042 | havoc | 2007-04-04 01:32:31 -0700 (Wed, 04 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

the beginnings of VBO support in the rendering backend

------------------------------------------------------------------------
r7041 | havoc | 2007-04-04 00:16:15 -0700 (Wed, 04 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r7040 | havoc | 2007-04-03 21:28:28 -0700 (Tue, 03 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

corrected showturtle cvar description (it said it was unused, it actually does work)

------------------------------------------------------------------------
r7039 | havoc | 2007-04-03 21:27:17 -0700 (Tue, 03 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/snd_main.c

fixed two timing flaws where cl.realframetime was used instead of (cl.time - cl.oldtime), one being centerprint fade time, and the other being ambient sky/water noise fading

------------------------------------------------------------------------
r7038 | havoc | 2007-04-02 21:09:11 -0700 (Mon, 02 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sv_user.c

fix bug in the previous movement patch where moves were not applied to the QC fields when not MOVETYPE_WALK

------------------------------------------------------------------------
r7037 | havoc | 2007-04-02 19:44:30 -0700 (Mon, 02 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sv_user.c

changed PlayerPrethink/think/PlayerPostThink to occur regardless of movement prediction, so they are guarenteed to run every server frame like in quake/quakeworld, only the movement itself is done elsewhere and only for MOVETYPE_WALK cases, this means that animations keep proper sync regardless of prediction timing

------------------------------------------------------------------------
r7036 | havoc | 2007-04-02 19:40:06 -0700 (Mon, 02 Apr 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/vid_shared.c

added detection of VBO extension

------------------------------------------------------------------------
r7035 | havoc | 2007-03-31 02:56:59 -0700 (Sat, 31 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c

patch from div0 to fix the fixangle logic (my fix apparently didn't work properly either)

------------------------------------------------------------------------
r7034 | havoc | 2007-03-31 02:42:34 -0700 (Sat, 31 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_agl.c
   A /trunk/darkplaces/vid_agl_mackeys.h

patch from div0 that improves mac keyboard support in the AGL client, this includes a copy of SDL_mackeys.h (as vid_agl_mackeys.h), it should be kept up to date as appropriate

------------------------------------------------------------------------
r7032 | havoc | 2007-03-30 13:42:13 -0700 (Fri, 30 Mar 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

added back bullet impact sparks due to complaints
made grenade smoke trails only last 2/3rd as long (this matches the quake grenade trail vs the quake rocket trail length)

------------------------------------------------------------------------
r7031 | havoc | 2007-03-30 12:59:40 -0700 (Fri, 30 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

slight improvement to the new bullet smoke

------------------------------------------------------------------------
r7030 | havoc | 2007-03-30 01:48:11 -0700 (Fri, 30 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_demo.c
   M /trunk/darkplaces/host.c

make timedemo and -benchmark use srand(0) to get more predictable results

------------------------------------------------------------------------
r7029 | havoc | 2007-03-30 01:47:12 -0700 (Fri, 30 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/menu.c

disabled cl_beams_instantaimhack by default, and disabled it in every Effects: preset in the options menu

------------------------------------------------------------------------
r7028 | havoc | 2007-03-30 01:31:10 -0700 (Fri, 30 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

removed restrictions on r_fullbright and r_ambient cvars (they can now be used in multiplayer)

------------------------------------------------------------------------
r7027 | havoc | 2007-03-30 01:26:37 -0700 (Fri, 30 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_light.c

fix the corona view distance culling checks, had the values swapped between rtlight/dlight cases

------------------------------------------------------------------------
r7026 | havoc | 2007-03-30 01:25:12 -0700 (Fri, 30 Mar 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

changed cl_particles_quake mode to use size 1.5 for particles rather than size 1.0, this makes them about as visible as in glquake
changed explosion sparks to not be affected by gravity and some other differences in how they are spawned
removed sparks on bullet/nail impact effects, made smoke bigger and a bit darker so it's not just small white puffs, it now looks rather nice, and more true to the original quake gunshot/spike/superspike effect

------------------------------------------------------------------------
r7025 | havoc | 2007-03-29 20:33:29 -0700 (Thu, 29 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

fix bug that caused blood stainmaps to not appear when decals were off

------------------------------------------------------------------------
r7024 | havoc | 2007-03-29 20:28:56 -0700 (Thu, 29 Mar 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/r_light.c

cleaned up R_DrawCoronas code to be more readable/maintainable
modified R_DrawCoronas to use a spherical distance check on coronas rather than a view-direction dependent one, and changed the distance checks, this should get rid of the 'seeing your own muzzleflash corona when looking down' issue

------------------------------------------------------------------------
r7023 | havoc | 2007-03-29 20:26:51 -0700 (Thu, 29 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

fix bug which caused CL_Move to not see any network bmodels (doors, etc), which caused particles, blood, and coronas to ignore doors and such

------------------------------------------------------------------------
r7022 | havoc | 2007-03-29 18:41:00 -0700 (Thu, 29 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

fixed specularscale calculation

------------------------------------------------------------------------
r7021 | havoc | 2007-03-29 13:23:20 -0700 (Thu, 29 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

fix warning

------------------------------------------------------------------------
r7020 | havoc | 2007-03-29 02:18:03 -0700 (Thu, 29 Mar 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/sys.h
   M /trunk/darkplaces/sys_linux.c
   M /trunk/darkplaces/sys_sdl.c
   M /trunk/darkplaces/sys_win.c
   M /trunk/darkplaces/todo

changed Sys_Sleep functions to take microseconds instead of milliseconds (this may mildly improve sleep accuracy on Linux dedicated servers)
modified the host main loop to check for server packets each iteration of the loop rather than at the server framerate (this doesn't accomplish much yet but has potential)
added sv_checkforpacketsduringsleep cvar to enable use of select() instead of Sys_Sleep()

------------------------------------------------------------------------
r7018 | havoc | 2007-03-28 18:39:52 -0700 (Wed, 28 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.h
   M /trunk/darkplaces/svvm_cmds.c

added DP_QC_TOKENIZEBYSEPARATOR extension

------------------------------------------------------------------------
r7017 | havoc | 2007-03-28 17:39:50 -0700 (Wed, 28 Mar 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/render.h

added r_shadow_usenormalmap cvar which allows you to disable directional shading on rtlights, looking a bit more like glquake lights, this also renders somewhat faster so it may be of use as a performance tweak for some cards
added an optimized ambient-without-diffuse path in the GLSL shader to help r_shadow_usenormalmap 0 performance

------------------------------------------------------------------------
r7016 | havoc | 2007-03-28 17:33:16 -0700 (Wed, 28 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/lhnet.c
   M /trunk/darkplaces/lhnet.h
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/netconn.h

added NetConn_SleepMicroseconds function, and LHNET_SleepUntilPacket_Microseconds function, this uses select() to wait for a specified amount of time or until a packet is received

------------------------------------------------------------------------
r7015 | havoc | 2007-03-28 17:31:57 -0700 (Wed, 28 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/view.c

cl_bob* cvars are now saved

------------------------------------------------------------------------
r7014 | havoc | 2007-03-27 17:42:28 -0700 (Tue, 27 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

stop demo playback on connect command but do not disconnect

------------------------------------------------------------------------
r7013 | havoc | 2007-03-27 12:48:09 -0700 (Tue, 27 Mar 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_user.c

added .float disableclientprediction field for qc to use to disable prediction intentionally if it so wishes
added .movetype check to disable prediction whenever movetype is not MOVETYPE_WALK, this fixes unwanted prediction issues in all known cases
moved prediction disabling code from SV_ReadClientMove to SV_ExecuteClientMoves as a minor cleanup

------------------------------------------------------------------------
r7012 | havoc | 2007-03-27 12:43:56 -0700 (Tue, 27 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/csprogs.c

remove unused variable

------------------------------------------------------------------------
r7011 | havoc | 2007-03-27 11:36:21 -0700 (Tue, 27 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

made scr_printspeed 0 also disable slow printing

------------------------------------------------------------------------
r7010 | havoc | 2007-03-27 11:30:44 -0700 (Tue, 27 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

changed default value of scr_printspeed from 8 to 1000000 to disable the slow printing entirely, as it is more annoying than useful

------------------------------------------------------------------------
r7009 | havoc | 2007-03-27 11:28:23 -0700 (Tue, 27 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

patch from div0 to make svc_finale text show up immediately if scr_printspeed is a very high value

------------------------------------------------------------------------
r7008 | havoc | 2007-03-25 21:45:19 -0700 (Sun, 25 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

remove unnecessary calculations of absmin/absmax in csqc builtins, they're not used by the engine and are updated by setorigin/setsize

------------------------------------------------------------------------
r7007 | havoc | 2007-03-25 21:39:47 -0700 (Sun, 25 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/csprogs.c

slight optimization to CSQC_AddRenderEdict - don't fetch renderflags twice

------------------------------------------------------------------------
r7006 | havoc | 2007-03-25 19:40:26 -0700 (Sun, 25 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/libcurl.c

fix bug in the last commit

------------------------------------------------------------------------
r7005 | havoc | 2007-03-25 19:04:42 -0700 (Sun, 25 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/libcurl.c

patch from div0 to fix issues with libcurl on old nexuiz servers

------------------------------------------------------------------------
r7004 | havoc | 2007-03-24 17:49:42 -0700 (Sat, 24 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/svbsp.c

eliminated dependency on quakedef.h, this file now compile standalone without any problems

------------------------------------------------------------------------
r7003 | havoc | 2007-03-24 16:04:58 -0700 (Sat, 24 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

changed default value of cl_netinputpacketlosstolerance from 4 to 1, matching Quake3, as it's actually quite rare for more than every other packet to be lost

------------------------------------------------------------------------
r7002 | havoc | 2007-03-24 10:55:42 -0700 (Sat, 24 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/svvm_cmds.c

as requested by div0, sprint to world now behaves like print

------------------------------------------------------------------------
r7001 | havoc | 2007-03-24 10:46:19 -0700 (Sat, 24 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/todo

moved clearing of self.fixangle to SV_Physics_ClientEntity so that it is only cleared each time PlayerPreThink is called, fixing bugs with irregular move times causing spectating smoothing to fail

------------------------------------------------------------------------
r7000 | havoc | 2007-03-19 10:53:06 -0700 (Mon, 19 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

added glFinish() call to loading screen (which uses front buffer rendering) to make it work on Windows Vista

------------------------------------------------------------------------
r6999 | havoc | 2007-03-19 07:10:19 -0700 (Mon, 19 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

added leaf culling using the shadow-caster frustum, this got a very small gain

------------------------------------------------------------------------
r6998 | havoc | 2007-03-18 15:44:59 -0700 (Sun, 18 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/todo

changed bestweapon command to match the one in proquake - taking each weapon identifier as a separate parameter, rather than one string of them, I don't know why the person asking for bestweapon support gave me an example of a single parameter as no other engine seems to do it that way

------------------------------------------------------------------------
r6997 | havoc | 2007-03-18 10:52:32 -0700 (Sun, 18 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/todo

added iplog support (iplog_list command, iplog_name cvar, and automatic gathering of ip addresses from status commands)

------------------------------------------------------------------------
r6996 | havoc | 2007-03-18 10:04:28 -0700 (Sun, 18 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

added cl_movement_minping cvar, default 50, this shuts off prediction when your ping time is below 50ms, such as in local games or lan games

------------------------------------------------------------------------
r6995 | havoc | 2007-03-17 06:27:02 -0700 (Sat, 17 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/snd_mem.c
   M /trunk/darkplaces/todo

changed some prints to dprints

------------------------------------------------------------------------
r6994 | havoc | 2007-03-17 06:19:00 -0700 (Sat, 17 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt
   M /trunk/darkplaces/vid_shared.c

reenabled vid_grabkeyboard by default until the focus issue is figured out

------------------------------------------------------------------------
r6993 | havoc | 2007-03-17 06:08:52 -0700 (Sat, 17 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/host_cmd.c

play a different sound (sound/misc/talk2.wav) for team chat messages (only if the file exists of course), to accomplish this the team chat messages now have () around the player name, which is compatible with other engines with this feature

------------------------------------------------------------------------
r6992 | havoc | 2007-03-16 05:35:53 -0700 (Fri, 16 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

cl_autodemo and cl_autodemo_nameformat are now saved cvars

------------------------------------------------------------------------
r6991 | havoc | 2007-03-16 02:37:04 -0700 (Fri, 16 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_demo.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h

fixed cl_autodemo

------------------------------------------------------------------------
r6990 | havoc | 2007-03-16 02:34:24 -0700 (Fri, 16 Mar 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/cvar.c
   M /trunk/darkplaces/host_cmd.c

fixed bug where every name/color/playermodel/playerskin/etc property change was sent twice
removed some autodemo code

------------------------------------------------------------------------
r6989 | havoc | 2007-03-16 02:29:11 -0700 (Fri, 16 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

corrected name of gl_ext_separatestencil server (it was missing the second s)

------------------------------------------------------------------------
r6988 | havoc | 2007-03-15 20:13:22 -0700 (Thu, 15 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c

reenabled keyboard grab when fullscreen - this is just a temporary solution, the window should be focused but isn't

------------------------------------------------------------------------
r6987 | havoc | 2007-03-15 17:36:27 -0700 (Thu, 15 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_agl.c

fix a double typo (thanks Willis)

------------------------------------------------------------------------
r6985 | havoc | 2007-03-15 07:29:41 -0700 (Thu, 15 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/filematch.c

fix an error

------------------------------------------------------------------------
r6984 | havoc | 2007-03-15 07:06:03 -0700 (Thu, 15 Mar 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/darkplaces.txt

disabled cl_movement prediction when cls.servermovesequence is 0 (either a protocol that does not support move synchronization, or prediction is disabled)
removed cl_movement_latency cvar as it no longer serves any purpose with the removal of support for prediction on unsynchronized move protocols

------------------------------------------------------------------------
r6983 | havoc | 2007-03-15 06:54:37 -0700 (Thu, 15 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/filematch.c
   M /trunk/darkplaces/fs.c

rewrote stringlist stuff, now uses a (dynamically resizing) array of pointers rather than a linked list, and uses a selection sort rather than a bubble sort, this has changed the "maps" command from taking about 7 seconds on my system to about 70ms

------------------------------------------------------------------------
r6982 | havoc | 2007-03-15 05:49:57 -0700 (Thu, 15 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c

fix a crash in maps command

------------------------------------------------------------------------
r6981 | havoc | 2007-03-15 05:10:27 -0700 (Thu, 15 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/todo

aligned menu options to not cover the quake logo plaque on the left side

------------------------------------------------------------------------
r6980 | havoc | 2007-03-15 04:34:14 -0700 (Thu, 15 Mar 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/menu.c

main options menu now has only the most frequently used options, and contains several presets for effects and lighting (renamed Graphics Options to Lighting)
main options menu now fits on a 320x240 display

------------------------------------------------------------------------
r6979 | havoc | 2007-03-15 04:32:01 -0700 (Thu, 15 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt

updated with new default value of con_closeontoggleconsole

------------------------------------------------------------------------
r6978 | havoc | 2007-03-15 04:23:50 -0700 (Thu, 15 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

reworked quake query code (CCREQ_/CCREP_ handling) to use MSG_Read functions, it was previously using a mixture of these and direct packet parsing, which was not working, this means quake query tools work again

------------------------------------------------------------------------
r6977 | havoc | 2007-03-15 03:34:24 -0700 (Thu, 15 Mar 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

separated the code that sends player name and such into CL_SendPlayerInfo
moved call to CL_SendPlayerInfo from signon 2 to signon 1
moved cl_begindownloads from signon 2 to signon 1, this fixes the 'no ambient sounds' bug

------------------------------------------------------------------------
r6976 | havoc | 2007-03-15 03:32:11 -0700 (Thu, 15 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c

changed default snd_soundradius from 1000 to 2000, matching proquake (which attempts to match dos quake), this means you can fire a rocket across the outdoor pent area in dm3 and hear the explosion

------------------------------------------------------------------------
r6975 | havoc | 2007-03-15 03:12:52 -0700 (Thu, 15 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

implemented support for fuhquake macros in fuhquake/QIZMO format .loc files, hardcoded the strings for these rather than using cvars (unlike fuhquake) because excess settings is silly

------------------------------------------------------------------------
r6974 | havoc | 2007-03-15 01:34:05 -0700 (Thu, 15 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/view.c

made cl_bob 0 also disable cl_bobmodel

------------------------------------------------------------------------
r6973 | havoc | 2007-03-15 01:28:10 -0700 (Thu, 15 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/keys.c

changed default value of con_closeontoggleconsole due to a never ending stream of complaints about the ~ key not closing the console

------------------------------------------------------------------------
r6972 | havoc | 2007-03-15 01:10:30 -0700 (Thu, 15 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

set pmodel/emodel keys in userinfo for qw servers

------------------------------------------------------------------------
r6971 | havoc | 2007-03-14 03:33:43 -0700 (Wed, 14 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_agl.c

add apple_multithreadedgl cvar (offloads OpenGL driver to a second thread if possible), off by default (may change to on if I get feedback from testers)

------------------------------------------------------------------------
r6970 | havoc | 2007-03-14 01:48:51 -0700 (Wed, 14 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/todo

added cl_particles_rain and cl_particles_snow cvars to allow disabling of these types of particles, based on a patch from esteel

------------------------------------------------------------------------
r6969 | havoc | 2007-03-14 01:48:00 -0700 (Wed, 14 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/curves.c

added a missing return statement in the 'any-dimension' bspline example code (which is in a comment so this has no effect on code)

------------------------------------------------------------------------
r6968 | havoc | 2007-03-13 20:09:29 -0700 (Tue, 13 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix bug where transparent models used an out of date material (generated earlier in the same frame), which caused problems when multiple instances of the same model exist in the same frame and one or more of them are transparent

------------------------------------------------------------------------
r6967 | havoc | 2007-03-13 19:08:28 -0700 (Tue, 13 Mar 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

loc file parsing now supports whitespace following commas (I did not previously have such a test file)
now rejects malformed proquake-format loc file lines that do not have a quoted string directly after the 6 numbers

------------------------------------------------------------------------
r6966 | havoc | 2007-03-12 05:30:57 -0700 (Mon, 12 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt

removed duplicate entries in the cvar list

------------------------------------------------------------------------
r6965 | havoc | 2007-03-12 05:28:00 -0700 (Mon, 12 Mar 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt

removed "Future supported games" section as it really serves no purpose
sorted cvar list

------------------------------------------------------------------------
r6964 | havoc | 2007-03-12 04:39:11 -0700 (Mon, 12 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

442

------------------------------------------------------------------------
r6963 | havoc | 2007-03-12 04:29:40 -0700 (Mon, 12 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

446

------------------------------------------------------------------------
r6962 | havoc | 2007-03-12 04:29:20 -0700 (Mon, 12 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt

updated readme

------------------------------------------------------------------------
r6961 | havoc | 2007-03-11 23:21:21 -0700 (Sun, 11 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c

multiline cvar_t descriptions cause problems when building the readme

------------------------------------------------------------------------
r6960 | havoc | 2007-03-11 22:58:29 -0700 (Sun, 11 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/svvm_cmds.c

removed trailing comments on cvar declarations and Cmd_AddCommand calls

------------------------------------------------------------------------
r6959 | havoc | 2007-03-11 22:44:45 -0700 (Sun, 11 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/vid_shared.c

corrected some comments

------------------------------------------------------------------------
r6958 | havoc | 2007-03-11 22:31:02 -0700 (Sun, 11 Mar 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_demo.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c

removed -demolooponly commandline option as it did precisely the same thing as -demo, and I don't feel like implementing the feature its name implies
corrected a mention of host_maxfps to cl_maxfps in host_framerate cvar description

------------------------------------------------------------------------
r6957 | havoc | 2007-03-11 22:26:59 -0700 (Sun, 11 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_shared.c

added vid_grabkeyboard cvar which defaults to 0, this means that the glx client no longer locks out window manager hotkeys (such as volume control and music player control keys, as well as alt-tab)

------------------------------------------------------------------------
r6956 | havoc | 2007-03-11 21:18:32 -0700 (Sun, 11 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/csprogs.c

implemented proper handling of .frame2/.lerpfrac/.frame1time/.frame2time fields in csqc entities

------------------------------------------------------------------------
r6955 | havoc | 2007-03-11 19:33:27 -0700 (Sun, 11 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/todo

added support for locs/something.loc naming in loc file loading code, for proquake filename compatibility

------------------------------------------------------------------------
r6954 | havoc | 2007-03-11 19:28:15 -0700 (Sun, 11 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

disable interpolation of predicted movement locations when a teleport occurred (just like unpredicted movement is not interpolated in this case)

------------------------------------------------------------------------
r6953 | havoc | 2007-03-11 16:56:44 -0700 (Sun, 11 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

don't abort a download if a level change occurs during the download, instead just wait for it to finish before signing in to the new level

------------------------------------------------------------------------
r6952 | havoc | 2007-03-11 16:54:14 -0700 (Sun, 11 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

make gamedir command work on dedicated servers

------------------------------------------------------------------------
r6951 | havoc | 2007-03-11 16:53:31 -0700 (Sun, 11 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/snd_coreaudio.c
   M /trunk/darkplaces/snd_sdl.c

increased minimum developer cvar level for several spammy messages (new engine string, sample frames missing) from 100 to 200, to make 100 more usable

------------------------------------------------------------------------
r6950 | havoc | 2007-03-10 23:41:47 -0800 (Sat, 10 Mar 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/todo

implemented .loc file support, including some editing (add command, and removenearest command) and viewing capability (r_speeds now shows the current location name, and locs_show 1 displays the actual boxes/points as translucent boxes)
implemented proquake message macros (%l, %d, %h, %a, etc), can be disabled by locs_enable 0

------------------------------------------------------------------------
r6949 | havoc | 2007-03-10 19:34:50 -0800 (Sat, 10 Mar 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c

changed brightness of unlit q1bsp maps from 2x white to 1x white (so textures show as their true colors rather than twice as bright)
fixed bug that made models black in unlit q1bsp maps

------------------------------------------------------------------------
r6948 | havoc | 2007-03-09 02:41:10 -0800 (Fri, 09 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/svvm_cmds.c

fix incorrect parameter count check on setspawnparms, this was causing coop servers to suddenly quit when someone respawned

------------------------------------------------------------------------
r6947 | havoc | 2007-03-08 18:39:07 -0800 (Thu, 08 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

removed master 12.166.196.192 (run by Venim) because it hasn't been responding for a long time

------------------------------------------------------------------------
r6946 | havoc | 2007-03-08 16:13:19 -0800 (Thu, 08 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

added cl_dlights_decayradius and cl_dlights_decaybrightness cvars, both default on, this brings back the quake-style radius decay, and keeps the more recently added brightness decay, benchmarks suffered when radius decay was removed, so its return should restore any losses associated with that

------------------------------------------------------------------------
r6945 | havoc | 2007-03-08 15:50:28 -0800 (Thu, 08 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h
   M /trunk/darkplaces/render.h

implemented shadow caster culling by creating a frustum plane set that includes the light origin, any object that is not within this frustum (which encloses the screen and a triangular-shaped volume extending to the light origin) can not possibly cast a shadow onto the visible geometry, this reduces cpu work in a few cases (off-screen explosion with several entities further off-screen)

------------------------------------------------------------------------
r6944 | havoc | 2007-03-08 15:39:14 -0800 (Thu, 08 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

fixed bug in portal culling code that allowed a leaf to be revisited multiple times, causing it to be counted multiple times, and wasting a small amount of time marking surfaces redundantly

------------------------------------------------------------------------
r6943 | havoc | 2007-03-08 15:36:23 -0800 (Thu, 08 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clvm_cmds.c

reworked prediction code to work better when riding lifts

------------------------------------------------------------------------
r6942 | havoc | 2007-03-08 15:33:57 -0800 (Thu, 08 Mar 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/sv_main.c

refactored csqc entity sending code so that it properly obeys msg->maxsize, undoing writes that could not fit
added comment about how csqc entity sending code needs some changes to avoid packet loss problems

------------------------------------------------------------------------
r6941 | havoc | 2007-03-08 15:32:45 -0800 (Thu, 08 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/mathlib.h

added a few more Vector4 macros

------------------------------------------------------------------------
r6940 | havoc | 2007-03-03 14:06:57 -0800 (Sat, 03 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/sv_main.c

changed entity networking prioritization code to use the center of the model rather than the origin, this fixes prioritization of doors and lifts which typically have their origin near '0 0 0' rather than inside the entity box

------------------------------------------------------------------------
r6939 | havoc | 2007-03-03 13:59:03 -0800 (Sat, 03 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

fix weapon jitters when walking up ramps, and prediction failures when doing rampjumps, unfortunately this also ends up predicting quake2-style double jumps (which do not occur on the server)

------------------------------------------------------------------------
r6938 | havoc | 2007-03-03 09:47:15 -0800 (Sat, 03 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

patch from div0 fixing his previous patch that he told me had prediction visibility tests but actually lacked it

------------------------------------------------------------------------
r6937 | havoc | 2007-03-02 17:49:43 -0800 (Fri, 02 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

quick hack to get rid of twitchy onground state in prediction when running up ramps, this really needs a better fix sometime

------------------------------------------------------------------------
r6936 | havoc | 2007-03-02 17:37:22 -0800 (Fri, 02 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_user.c

fixed bug that was causing prediction to fail periodically in singleplayer games, especially with cl_maxfps 125 (negative packet times were causing sv_clmovement_minping 0 tests to pass occasionally, disabling prediction, and causing a major stall in input handling)

------------------------------------------------------------------------
r6935 | havoc | 2007-03-02 16:57:01 -0800 (Fri, 02 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_user.c

server now executes predicted moves of more than 50ms as two separate moves like QWSV does (the client prediction expects this)

------------------------------------------------------------------------
r6934 | havoc | 2007-03-02 16:51:48 -0800 (Fri, 02 Mar 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

minor cleanup of CL_SendMove comments regarding packet timing
changed predicted move sending code to not care about the value of cls.signon

------------------------------------------------------------------------
r6933 | havoc | 2007-03-02 14:37:36 -0800 (Fri, 02 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

changed sendcvar command to send a reply (with no value parameter) if the cvar does not exist

------------------------------------------------------------------------
r6932 | havoc | 2007-03-02 14:23:08 -0800 (Fri, 02 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_shared.c

reworked cvar checks in VID_UpdateGamma to simply set gamma_forcenextframe if they have changed, this is somewhat in preparation for eventual use of cvar callbacks

------------------------------------------------------------------------
r6931 | havoc | 2007-03-02 07:33:59 -0800 (Fri, 02 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_user.c
   M /trunk/darkplaces/todo

less hacky solution to resetting movesequence on a level change

------------------------------------------------------------------------
r6930 | havoc | 2007-03-02 05:05:39 -0800 (Fri, 02 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_user.c

fix really stupid bug introduced in sv_user.c revision 1.83 (sv_waterfriction was being used, even if it's -1 which means use sv_friction instead), now properly uses sv_friction if sv_waterfriction < 0

------------------------------------------------------------------------
r6929 | havoc | 2007-03-01 15:11:26 -0800 (Thu, 01 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cvar.c
   M /trunk/darkplaces/cvar.h
   M /trunk/darkplaces/host_cmd.c

fixed problems with playing on QW server caused by the use of _cl_name and similar config variables

------------------------------------------------------------------------
r6928 | havoc | 2007-03-01 13:36:55 -0800 (Thu, 01 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/portals.c

fix bug where only the first portal to see a surface was able to mark triangles as worth of receiving light

------------------------------------------------------------------------
r6927 | havoc | 2007-03-01 12:07:20 -0800 (Thu, 01 Mar 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/portals.c
   M /trunk/darkplaces/portals.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h
   M /trunk/darkplaces/todo

implemented r_shadow_culltriangles cvar (on by default), this improves lighting performance by reducing the amount of geometry to render, it does not add any additional cpu w
ork because similar forms of culling were already used on shadow casting triangles (which are now replaced by this), this just applies the same already computed culling to the lighting as well as the shadowing

------------------------------------------------------------------------
r6926 | havoc | 2007-03-01 10:49:26 -0800 (Thu, 01 Mar 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

fix bug that was causing r_editlights light indicators to not render

------------------------------------------------------------------------
r6925 | havoc | 2007-02-28 08:49:54 -0800 (Wed, 28 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/gl_rmain.c

remove stray \n characters in Cmd_AddCommand calls

------------------------------------------------------------------------
r6924 | havoc | 2007-02-28 03:08:30 -0800 (Wed, 28 Feb 2007) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/collision.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/mathlib.h
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/portals.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_sprites.c

eliminated RENDER_NOCULLFACE (now uses MATERIALFLAG_NOCULLFACE on a texture)
eliminated RENDER_TRANSPARENT (it was only used by the client code briefly, it did not need to be stored, it only turned off RENDER_SHADOW)
added TriangleOverlapsBox macro (and changed several pieces of code to use it)
changed some code to use the BoxInsideBox macro

------------------------------------------------------------------------
r6923 | havoc | 2007-02-28 01:50:36 -0800 (Wed, 28 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

improved detection of q3 terrain blend shaders to reduce chances of a misidentification

------------------------------------------------------------------------
r6922 | havoc | 2007-02-28 01:35:29 -0800 (Wed, 28 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/client.h

remove an unused extern

------------------------------------------------------------------------
r6921 | havoc | 2007-02-28 01:34:34 -0800 (Wed, 28 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

fix a cvar name

------------------------------------------------------------------------
r6920 | havoc | 2007-02-27 13:15:48 -0800 (Tue, 27 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/libcurl.c

fix missing { character

------------------------------------------------------------------------
r6919 | havoc | 2007-02-27 11:24:48 -0800 (Tue, 27 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/libcurl.c

use CVAR_SAVE not 1 for flags on curl cvars

------------------------------------------------------------------------
r6918 | havoc | 2007-02-24 02:05:38 -0800 (Sat, 24 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/svvm_cmds.c

allow 0 parameters in VM_SV_makestatic due to a bug in id1 qc

------------------------------------------------------------------------
r6917 | havoc | 2007-02-23 23:12:56 -0800 (Fri, 23 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

added optimized case in R_Q1BSP_GetLightInfo surface culling that skips checking individual triangle bounding boxes if the entire surface is inside the light bounding box (as is often the case)

------------------------------------------------------------------------
r6916 | havoc | 2007-02-23 23:09:31 -0800 (Fri, 23 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

optimized entity culling loop for shadow casting entities that are not directly seen

------------------------------------------------------------------------
r6915 | havoc | 2007-02-23 07:31:06 -0800 (Fri, 23 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/mathlib.h

added BoxInsideBox macro

------------------------------------------------------------------------
r6914 | havoc | 2007-02-23 05:49:12 -0800 (Fri, 23 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

minor optimization of R_Q1BSP_RecursiveLightInfo

------------------------------------------------------------------------
r6913 | havoc | 2007-02-23 05:48:42 -0800 (Fri, 23 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

minor optimization

------------------------------------------------------------------------
r6912 | havoc | 2007-02-23 05:09:11 -0800 (Fri, 23 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

forgot to re-sort the todo

------------------------------------------------------------------------
r6911 | havoc | 2007-02-23 05:07:36 -0800 (Fri, 23 Feb 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/todo

audited R_Mesh_Matrix calls and RSurf_ActiveEntity calls and moved them to more appropriate locations in some cases
split R_DrawSurfaces into R_DrawWorldSurfaces and R_DrawModelSurfaces to make profile reports more useful
split RSurf_ActiveEntity into RSurf_ActiveWorldEntity and RSurf_ActiveModelEntity to make profile reports more useful, and very slightly improve performance

------------------------------------------------------------------------
r6910 | havoc | 2007-02-23 04:53:07 -0800 (Fri, 23 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

remove ; that was causing crashes/breakage

------------------------------------------------------------------------
r6909 | havoc | 2007-02-23 04:47:02 -0800 (Fri, 23 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

remove unused variables

------------------------------------------------------------------------
r6908 | havoc | 2007-02-23 04:45:35 -0800 (Fri, 23 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

fixed bug that caused the wrong texture to be used on rtlight lighting when two or more textures were involved in a single batch

------------------------------------------------------------------------
r6907 | havoc | 2007-02-23 04:05:14 -0800 (Fri, 23 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

small cleanup of R_DrawSurfaces (separated r_showcollisionbrushes and r_showtris/r_shownormals code into functions)

------------------------------------------------------------------------
r6906 | havoc | 2007-02-23 03:43:03 -0800 (Fri, 23 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h

split model_brushq3_t num_lightmaps field into num_originallightmaps (for lightmapindex checking) and num_mergedlightmaps (for loops), this fixes lightmap indexing errors on deluxemapped maps

------------------------------------------------------------------------
r6905 | havoc | 2007-02-23 02:46:00 -0800 (Fri, 23 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/libcurl.c
   M /trunk/darkplaces/libcurl.h
   M /trunk/darkplaces/sv_main.c

patch from div0 that makes curl downloads stay connected to the game server while downloading (like the direct downloads)

------------------------------------------------------------------------
r6904 | havoc | 2007-02-23 01:36:47 -0800 (Fri, 23 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/sv_main.c

patch from div0 that adds clientside culling of entities by TraceLineOfSight (like sv_cullentities_trace does), and merges the client and server code for this culling, this also adds traces for predicted player movement on the server to reduce the "items popping up" problem when running into a new room

------------------------------------------------------------------------
r6903 | havoc | 2007-02-23 01:19:36 -0800 (Fri, 23 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

memset arrays before writing skeletal vertices into them (as the code did long ago), this is an 8% improvement in Mod_Alias_GetMesh_Vertices in my benchmarking (7.58 seconds in profile before, 6.95 seconds after)

------------------------------------------------------------------------
r6902 | havoc | 2007-02-23 01:02:48 -0800 (Fri, 23 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/todo

further optimizations to batching code, not much gain if any from these, but it may play nicer with cpu cache

------------------------------------------------------------------------
r6901 | havoc | 2007-02-22 21:12:05 -0800 (Thu, 22 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/quakedef.h

check __GNUC__ version before defining printf attribute, only define it on gcc 3 and later

------------------------------------------------------------------------
r6900 | havoc | 2007-02-22 07:22:37 -0800 (Thu, 22 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

changed default mod_q3bsp_lightmapmergepower from 5 (4096x4096) to 4 (2048x2048), this means that the textures won't use more than 16MB each, which is a bit friendlier to 128MB cards than a 64MB texture  (note: this is only the upper limit, if the map does not need this much lightmap space it already picks a smaller size)

------------------------------------------------------------------------
r6899 | havoc | 2007-02-22 07:17:24 -0800 (Thu, 22 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fix dedicated server crashes caused by new lightmap merging

------------------------------------------------------------------------
r6898 | havoc | 2007-02-22 06:37:43 -0800 (Thu, 22 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fixed bug that made some models invisible in nexuiz (if they have skin != 0 and skin 0 was never rendered yet on this model, they were using skin 0, which was often uninitialized)

------------------------------------------------------------------------
r6897 | havoc | 2007-02-22 03:55:01 -0800 (Thu, 22 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/collision.c

disabled collision_enternudge by default again, due to intermittent problems with getting stuck on ramps

------------------------------------------------------------------------
r6896 | havoc | 2007-02-22 03:45:12 -0800 (Thu, 22 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

changed light attenuation equation in the default.glsl shader in the engine

------------------------------------------------------------------------
r6895 | havoc | 2007-02-22 03:30:29 -0800 (Thu, 22 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h

added r_shadow_lightradiusscale cvar (similar to r_shadow_lightintensityscale)

------------------------------------------------------------------------
r6894 | havoc | 2007-02-22 03:29:38 -0800 (Thu, 22 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

don't compute tangents or normals on non-deluxemapped world surfaces, or tangents on models if the shader does not use normalmapping

------------------------------------------------------------------------
r6893 | havoc | 2007-02-22 03:25:51 -0800 (Thu, 22 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

really fixed deluxemapping this time

------------------------------------------------------------------------
r6892 | havoc | 2007-02-22 03:19:51 -0800 (Thu, 22 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fixed deluxemapping detection bug that made it never work

------------------------------------------------------------------------
r6891 | havoc | 2007-02-22 00:45:28 -0800 (Thu, 22 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h

now merges all q3bsp lightmap textures into one huge lightmap texture if possible, this doubled benchmark framerates for me

------------------------------------------------------------------------
r6890 | havoc | 2007-02-22 00:44:01 -0800 (Thu, 22 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

added some debugging code to RSurf_DrawBatch_WithLightmapSwitching to print out how many surfaces are rendered in each batch and each subbatch by lightmap (this revealed that q3map2's surface sorting is horrible)

------------------------------------------------------------------------
r6889 | havoc | 2007-02-21 20:42:10 -0800 (Wed, 21 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

split RSurf_DrawBatch_Lightmap function into 4 main functions (previously there were only 3 modes, causing rendering problems) and 2 utility functions, this cleaned up the code somewhat

------------------------------------------------------------------------
r6888 | havoc | 2007-02-21 19:42:25 -0800 (Wed, 21 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix a bug in transparent mesh rendering which often caused crashes

------------------------------------------------------------------------
r6887 | havoc | 2007-02-21 17:13:31 -0800 (Wed, 21 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

reorganized surface batching to batch visible surfaces first, and then pass them to a function that breaks the list down by texture, also reorganized batching code to use a forward-search approach rather than state machine approach, this got a small (2%) speed gain in benchmarks

------------------------------------------------------------------------
r6886 | havoc | 2007-02-21 16:39:49 -0800 (Wed, 21 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

some cleanup of GL20 code (removed rsurface_glsl_texture and rsurface_glsl_uselightmaptexture caching, because with the change to not batching by lightmap texture there are no longer redundant batches)

------------------------------------------------------------------------
r6885 | havoc | 2007-02-21 16:34:20 -0800 (Wed, 21 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

merged some surface rendering setup code

------------------------------------------------------------------------
r6884 | havoc | 2007-02-21 03:56:29 -0800 (Wed, 21 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

default gl_lockarrays to 0, I'm not aware of any cards that actually benefit from it

------------------------------------------------------------------------
r6883 | havoc | 2007-02-21 03:55:37 -0800 (Wed, 21 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/todo

modified surface renderer batching to batch all lightmapped surfaces with the same texture together, rather than a separate batch for each lightmap texture, this means that the lightmap switching overhead is lower than before, no apparent improvement in benchmarks though

------------------------------------------------------------------------
r6882 | havoc | 2007-02-20 20:38:56 -0800 (Tue, 20 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cvar.c
   M /trunk/darkplaces/todo

fixed bug that was causing seta commands to usually not save to config.cfg (due to the value being copied to their default when they are created, causing the default matching to prevent them from being saved before)

------------------------------------------------------------------------
r6881 | havoc | 2007-02-20 19:23:13 -0800 (Tue, 20 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/collision.c

changed collision nudging to behave like quake2/3, properly handling shallow impacts (not allowing them to go any deeper if they are within epsilon)

------------------------------------------------------------------------
r6880 | havoc | 2007-02-20 04:34:38 -0800 (Tue, 20 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/sv_main.c

added model->brush.TraceLineOfSight function, this traces the rendering hull and treats leafs with no pvs as solid (meaning it traces the structural rendering hull in q3bsp, ignoring detail brushes and patches), this function is now used by sv_cullentities_trace for higher performance, and it does not stop at solid transparent surfaces such as the chainlink fences in the nexuiz map toxic.bsp

------------------------------------------------------------------------
r6879 | havoc | 2007-02-20 04:32:03 -0800 (Tue, 20 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.h
   M /trunk/darkplaces/cl_particles.c

fix some crashes related to particles when csqc is not active

------------------------------------------------------------------------
r6878 | havoc | 2007-02-20 00:07:48 -0800 (Tue, 20 Feb 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h

added mleaf_t->containscollisionsurfaces variable which indicates if the leafsurfaces array contains any q3 patches to collide against, checking this saves a substantial amount of time on collision detection in q3bsp (as few leafs actually contain patches, but many contain other kinds of surfaces)
added combinedsupercontents variable to mnode_t and mleaf_t, this was intended for collision culling but is not actually used (checks are implemented but commented out, because there was no measurable speed increase, and it could cause inconsistent results for startcontents when tracing objects larger than a point test - since point tests are always about contents there is no such culling performed in that case)

------------------------------------------------------------------------
r6877 | havoc | 2007-02-20 00:04:28 -0800 (Tue, 20 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/screen.h

added scr_refresh cvar which is similar to r_render but disables the entire render code rather than merely disabling the glDraw calls

------------------------------------------------------------------------
r6876 | havoc | 2007-02-19 19:27:08 -0800 (Mon, 19 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

changed reconnect command description

------------------------------------------------------------------------
r6875 | havoc | 2007-02-19 19:25:24 -0800 (Mon, 19 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

made reconnect command reconnect to the last server you were on, even if it was an nq server (previously this only worked on qw servers)

------------------------------------------------------------------------
r6874 | havoc | 2007-02-19 17:18:22 -0800 (Mon, 19 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.h

changed Q3SURFACEPARM_ANTIPORTAL to be an unsigned constant

------------------------------------------------------------------------
r6873 | havoc | 2007-02-19 16:25:57 -0800 (Mon, 19 Feb 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h

added parsing of surfaceparm antiportal
added support of "noshader" (treated the same as nodraw, basically)

------------------------------------------------------------------------
r6872 | havoc | 2007-02-19 15:17:21 -0800 (Mon, 19 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/protocol.c

moved cl.movesequence/cl.servermovesequence to cls. struct, this keeps the movesequence from level to level and fixes level change problems on old servers

------------------------------------------------------------------------
r6871 | havoc | 2007-02-19 15:05:27 -0800 (Mon, 19 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

reenabled network culling of bmodels (optional however), this should improve network performance in some nexuiz levels, and a few quake levels, it means that blood and decals do not interact with bmodels in other rooms however

------------------------------------------------------------------------
r6870 | havoc | 2007-02-19 02:15:11 -0800 (Mon, 19 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

reworked packet sending code a bit more, this is mostly just a cleanup, not a change in logic, except that cl_movement 0 now reports the correct ping time to the server, so local players get ping 0 as they used to

------------------------------------------------------------------------
r6869 | havoc | 2007-02-19 01:08:16 -0800 (Mon, 19 Feb 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/view.c

fixed stair smoothing code so it no longer jitters when riding lifts
added support for cl_stairsmoothspeed 0 as a means of disabling stair smoothing

------------------------------------------------------------------------
r6868 | havoc | 2007-02-18 23:48:09 -0800 (Sun, 18 Feb 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/sv_phys.c

changed FL_ONGROUND handling for pushers (lifts for example) so you now ride down lifts, rather than repeatedly falling and hitting the lift
cleaned up FL_ONGROUND handling for items riding pushers, so they now only lose their FL_ONGROUND status if the move is blocked

------------------------------------------------------------------------
r6867 | havoc | 2007-02-18 22:21:30 -0800 (Sun, 18 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

changed how CL_PrintEntities_f prints the model name, this seems to fix the garbage characters bug

------------------------------------------------------------------------
r6866 | havoc | 2007-02-18 21:53:32 -0800 (Sun, 18 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/sv_phys.c

fix broken SOLID_CORPSE collisions

------------------------------------------------------------------------
r6865 | havoc | 2007-02-18 21:53:11 -0800 (Sun, 18 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/svvm_cmds.c

fix two 'wrong number of parameters' errors

------------------------------------------------------------------------
r6864 | havoc | 2007-02-18 17:52:37 -0800 (Sun, 18 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_move.c

fix an uninitialized variable

------------------------------------------------------------------------
r6863 | havoc | 2007-02-18 17:46:44 -0800 (Sun, 18 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/svvm_cmds.c

fixed parmcount check on VM_SV_AddStat from 2 parameters to 3

------------------------------------------------------------------------
r6862 | havoc | 2007-02-18 17:33:38 -0800 (Sun, 18 Feb 2007) | 7 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/cl_collision.h
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.h
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_move.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sv_user.c
   M /trunk/darkplaces/svvm_cmds.c
   M /trunk/darkplaces/todo
   M /trunk/darkplaces/view.c

this patch may break things and needs testing
major cleanup of csqc and ssqc builtin tables
minimized differences between csqc and ssqc builtin tables (everything that can be implemented in both is implemented in both)
added VM_SAFEPARMCOUNTRANGE to allow a function to have, for example, 2-4 parameters (where as VM_SAFEPARMCOUNT requires it to be an exact match)
added VM_SAFEPARMCOUNT or VM_SAFEPARMCOUNTRANGE to ALL builtins, this may break buggy qc (and it's possible that one or more of these checks are wrong)
replaced CL_TraceBox with CL_Move, this is a proper csqc-entity aware version akin to SV_Move, it has a ton of parameters due to support for network entity collisions as well (ideally this needs cleanup somehow but I have no idea how, as non-csqc network entities do not share the prvm_edict_t system and do not have entity numbers in the csqc world)

------------------------------------------------------------------------
r6861 | havoc | 2007-02-18 17:24:44 -0800 (Sun, 18 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

fix shading seams along uv seams on compiled frame zero of mdl/md2/md3 models

------------------------------------------------------------------------
r6860 | havoc | 2007-02-18 17:15:58 -0800 (Sun, 18 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/sv_main.c

fixed support of progs.dat files with important global and field names removed, such as omicron bot reporting that OP_STATE is not supported because it removed the field names

------------------------------------------------------------------------
r6858 | havoc | 2007-02-18 16:10:39 -0800 (Sun, 18 Feb 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c

removed vm_cl_extensions (now uses vm_sv_extensions)
cleaned up fieldoffsets/globaloffsets/funcoffsets fetching code (including removal of some duplicates) and sorted the contents of the structs to match the new order of the code

------------------------------------------------------------------------
r6857 | havoc | 2007-02-18 15:39:54 -0800 (Sun, 18 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

fixed an evil ent->fields.vp access that was not using PRVM_EDICTFIELDVALUE

------------------------------------------------------------------------
r6856 | havoc | 2007-02-18 15:10:19 -0800 (Sun, 18 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/image.c

added an error message stating if an image file was loaded but decoding failed

------------------------------------------------------------------------
r6855 | havoc | 2007-02-18 04:57:43 -0800 (Sun, 18 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/svvm_cmds.c

added svc_trailparticles and svc_pointparticles, these are written by the trailparticles and pointparticles server builtins (matching the csqc ones), these can utilize any effect defined in effectinfo.txt without using csqc

------------------------------------------------------------------------
r6854 | havoc | 2007-02-18 04:49:24 -0800 (Sun, 18 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/host.c

renamed CL_Move to CL_Input to avoid confusion with the CL_Move that will be added (similar to SV_Move)

------------------------------------------------------------------------
r6853 | havoc | 2007-02-18 04:47:17 -0800 (Sun, 18 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/collision.c
   M /trunk/darkplaces/collision.h

added generic collision functions Collision_ClipToGenericEntity, Collision_ClipToWorld, and Collision_CombineTraces to allow reduction of similar code in csqc and ssqc

------------------------------------------------------------------------
r6852 | havoc | 2007-02-18 04:45:26 -0800 (Sun, 18 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c

changed fieldoffsets and globaloffsets to be integer array indices instead of byte offsets, this basically means d->ofs is no longer multiplied by 4 in PRVM_ED_FindFieldOffset and PRVM_ED_FindGlobalOffset

------------------------------------------------------------------------
r6851 | havoc | 2007-02-18 04:41:11 -0800 (Sun, 18 Feb 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/prvm_exec.c
   M /trunk/darkplaces/prvm_execprogram.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sv_user.c
   M /trunk/darkplaces/svvm_cmds.c

a cosmetic change as suggested by div0:
renamed PRVM_GETEDICTFIELDVALUE to PRVM_EDICTFIELDVALUE
renamed PRVM_GETGLOBALFIELDVALUE to PRVM_GLOBALFIELDVALUE

------------------------------------------------------------------------
r6850 | havoc | 2007-02-18 04:35:52 -0800 (Sun, 18 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

allow non-integer framerates for q3 shader animmap commands

------------------------------------------------------------------------
r6849 | havoc | 2007-02-18 03:53:09 -0800 (Sun, 18 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/image_png.c

fixed a bug with png loading on x86_64 platforms caused by libpng retardedness (it defines png_uint_32 as unsigned long, which is 64bit on such architectures, AND to make it worse this can be modified in pngconf.h on a per platform basis, so we detect the problem on big endian 64bit architectures and fix it there too)

------------------------------------------------------------------------
r6848 | black | 2007-02-17 03:27:09 -0800 (Sat, 17 Feb 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_cmds.c

Hopefully this fixes a bug introduced with the latest cleanup by LH.
Changed the menu code to always show the old quake menu if forceqmenu is set
(even if it lacks the gfx files).

------------------------------------------------------------------------
r6847 | havoc | 2007-02-16 14:25:44 -0800 (Fri, 16 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

reduced r_shadow_glossintensity from 2 to 1 by default

------------------------------------------------------------------------
r6846 | havoc | 2007-02-15 18:26:48 -0800 (Thu, 15 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_demo.c

the record command now disconnects you if starting a new map, this fixes a crash if doing "playdemo demo1;record test;stop"

------------------------------------------------------------------------
r6845 | havoc | 2007-02-15 13:41:07 -0800 (Thu, 15 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

changed SCR_DrawConsole call in csqc mode to match non-csqc mode (now draws after sbar)

------------------------------------------------------------------------
r6844 | havoc | 2007-02-14 23:55:14 -0800 (Wed, 14 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/csprogs.c

fix an uninitialized variable warnign

------------------------------------------------------------------------
r6843 | havoc | 2007-02-14 16:13:49 -0800 (Wed, 14 Feb 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/csprogs.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/prvm_exec.c
   M /trunk/darkplaces/prvm_execprogram.h
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_move.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sv_user.c
   M /trunk/darkplaces/svvm_cmds.c
   M /trunk/darkplaces/todo
   M /trunk/darkplaces/world.c
   M /trunk/darkplaces/world.h

cleaned up client qc, menu qc, and server qc VM initialization a bit so they have shared field/global/function lookup code,
changed world.c to not be server specific, moved server-specific functions to sv_phys.c

------------------------------------------------------------------------
r6842 | havoc | 2007-02-14 16:11:29 -0800 (Wed, 14 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

added gl_lockarrays_minimumvertices cvar for testing

------------------------------------------------------------------------
r6841 | havoc | 2007-02-14 16:07:21 -0800 (Wed, 14 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces-dedicated.dsp
   M /trunk/darkplaces/darkplaces-sdl.dsp
   M /trunk/darkplaces/darkplaces.dsp
   M /trunk/darkplaces/makefile.inc
   D /trunk/darkplaces/world_cs.c

removed unused world_cs.c code

------------------------------------------------------------------------
r6840 | havoc | 2007-02-14 13:22:16 -0800 (Wed, 14 Feb 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/sv_user.c

added a check for level changes which blocks prediction for 100ms at the beginning of the new level, and clears ping time and other information
refactored input parsing to buffer moves in sv_readmoves array, this means that it can now always trust the last move in the packet, never ignored like earlier ones (which are clearly repeats of earlier input)

------------------------------------------------------------------------
r6839 | havoc | 2007-02-14 13:09:55 -0800 (Wed, 14 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.h

some initial changes to support terrain texture blending someday

------------------------------------------------------------------------
r6838 | havoc | 2007-02-13 22:54:24 -0800 (Tue, 13 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

added bounding of info->particleaccumulator so that bogus values won't cause a very long loop

------------------------------------------------------------------------
r6837 | havoc | 2007-02-13 22:53:36 -0800 (Tue, 13 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

fix bug that caused trails to not appear at the right place

------------------------------------------------------------------------
r6836 | havoc | 2007-02-12 15:38:01 -0800 (Mon, 12 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h

added cl_nettimesyncmode cvar to choose the method of synchronizing cl.time, it defaults to resetting the cl.time to the previous packet's time, but only when it is out of bounds (meaning it increases it if it is falling behind, and snaps it back to the previous packet time if it exceeds this packet's time, which eliminates accumulated error)

------------------------------------------------------------------------
r6835 | havoc | 2007-02-12 15:24:09 -0800 (Mon, 12 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

sendcvar now quotes the resulting sentcvar value

------------------------------------------------------------------------
r6834 | havoc | 2007-02-12 12:36:11 -0800 (Mon, 12 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/host.c

removed cl.timenonlerp (reverted to using cl.time)

------------------------------------------------------------------------
r6833 | havoc | 2007-02-12 11:27:57 -0800 (Mon, 12 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

changed particleaccumulator check to use >= 1 instead of > 0, hopefully this will fix an infinite loop I encountered in testing

------------------------------------------------------------------------
r6832 | havoc | 2007-02-12 08:44:09 -0800 (Mon, 12 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/clvm_cmds.c

fixed problems with network entity viewmodels not following csqc_origin (as set by csqc)

------------------------------------------------------------------------
r6831 | havoc | 2007-02-12 08:43:15 -0800 (Mon, 12 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_rmain.c

minor cleaning

------------------------------------------------------------------------
r6830 | havoc | 2007-02-12 08:42:46 -0800 (Mon, 12 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

disabled saveconfig when doing -benchmark

------------------------------------------------------------------------
r6828 | havoc | 2007-02-11 15:08:29 -0800 (Sun, 11 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

downloads of .cfg and dlcache/ files are now forbidden by default (cvar controlled)

------------------------------------------------------------------------
r6827 | havoc | 2007-02-11 14:43:43 -0800 (Sun, 11 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/image.c

reworked Image_HeightmapToNormalmap to use a somewhat blurrier but more consistent algorithm

------------------------------------------------------------------------
r6826 | havoc | 2007-02-11 09:44:59 -0800 (Sun, 11 Feb 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_sprite.c

modified Mod_LoadSkinFrame to set base = r_texture_notexture on failure, this reduced fallback code elsewhere
reworked Mod_BuildAliasSkinsFromSkinFiles, it no longer tries fallbacks if a skin texture fails to load
fixed a crash on missing meshes in a skin file (which are intentionally nodraw, just like in Quake3)

------------------------------------------------------------------------
r6825 | havoc | 2007-02-11 07:52:17 -0800 (Sun, 11 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/view.c

disabled cl.stairoffset adjustments when airborn

------------------------------------------------------------------------
r6824 | havoc | 2007-02-11 07:27:18 -0800 (Sun, 11 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

some optimizations of CL_UpdateNetworkEntity to lower cpu overhead of the client

------------------------------------------------------------------------
r6823 | havoc | 2007-02-10 18:12:16 -0800 (Sat, 10 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

fix gamedir error when connecting to quakeworld servers

------------------------------------------------------------------------
r6822 | havoc | 2007-02-10 17:59:02 -0800 (Sat, 10 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

added an extern for r_bloom_brighten to fix menu.c compilation

------------------------------------------------------------------------
r6821 | havoc | 2007-02-10 14:44:46 -0800 (Sat, 10 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

fixed r_bloom_brighten to use the correct range

------------------------------------------------------------------------
r6820 | havoc | 2007-02-10 14:43:41 -0800 (Sat, 10 Feb 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/menu.c

added r_bloom_brighten modification in graphics options menu, this was already displayed but wasn't working, messing up all options after it
updated graphics options item count from 19 to 20

------------------------------------------------------------------------
r6819 | havoc | 2007-02-10 14:01:19 -0800 (Sat, 10 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

fix graphics options menu editing of bloom/scene brightness settings (they were swapped)

------------------------------------------------------------------------
r6818 | havoc | 2007-02-10 13:17:06 -0800 (Sat, 10 Feb 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/protocol.c

fix stupid bug in last patch that made entities not update
reworked priorities some more

------------------------------------------------------------------------
r6817 | havoc | 2007-02-10 12:31:19 -0800 (Sat, 10 Feb 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/protocol.c

fixed bug from lingering code that was resetting entity priority every frame
more tweaks to entity priority code

------------------------------------------------------------------------
r6816 | havoc | 2007-02-10 12:06:49 -0800 (Sat, 10 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fix a stupid bug in transparent water detection for q1bsp, it now works

------------------------------------------------------------------------
r6815 | havoc | 2007-02-09 13:17:37 -0800 (Fri, 09 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/protocol.c

changed entity priority code again, it should have less 'starvation' issues now (high priority entities causing others to be missed)

------------------------------------------------------------------------
r6814 | havoc | 2007-02-08 20:36:48 -0800 (Thu, 08 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/portals.c

reenabled exact portal culling of surface triangles, because it was not bugged after all

------------------------------------------------------------------------
r6813 | havoc | 2007-02-08 20:24:27 -0800 (Thu, 08 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

some minor state change optimizations on GL20 path, it now does even less per batch

------------------------------------------------------------------------
r6812 | havoc | 2007-02-08 19:26:24 -0800 (Thu, 08 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

made r_shadow_frontsidecasting cvar disable the portal culling features when it is casting from back sides (which portal culling can't work with)

------------------------------------------------------------------------
r6811 | havoc | 2007-02-08 19:22:34 -0800 (Thu, 08 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h

added back portal culling to rtlights because svbsp code is not working as well as it's supposed to

------------------------------------------------------------------------
r6810 | havoc | 2007-02-08 17:19:05 -0800 (Thu, 08 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fix Q3BSP map loader's sky surface detection so that it doesn't assume all submodels have sky if the base model does, this improves rendering performance a bit (by not scanning for sky in submodels that claim to have it but don't)

------------------------------------------------------------------------
r6809 | havoc | 2007-02-08 07:57:21 -0800 (Thu, 08 Feb 2007) | 12 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h

removed CL_UpdateEntities call in CSQC rendering code
changed r_refdef.lights from dlight_t * to rtlight_t (no longer a pointer)
modified CL_UpdateLights to setup the r_refdef.lights[] entry instead of merely pointing to the rtlight_t in the dlight_t struct
changed csqc dlight handling to comply with the spec (R_ClearScene resets r_refdef.numlights, then VM_R_AddEntities adds all engine-based entities and lights)
moved single-frame dlight spawning for rocket glow and such from CL_UpdateNetworkEntity to CL_LinkNetworkEntity (which is called by VM_R_AddEntities)
replaced all single-frame uses of CL_AllocDLight with R_RTLight_Update(&r_refdef.lights[r_refdef.numlights++], ...) calls, this includes lights such as muzzleflash, rocket glow, .glow_size lights, tenebrae dlights, etc
renamed CL_AllocDlight to CL_AllocLightFlash
renamed CL_DecayLights to CL_DecayLightFlashes
renamed CL_UpdateLights to CL_RelinkLightFlashes
renamed CL_ParticleEffect to CL_ParticleTrail and added spawndlight/spawnparticles boolean parameters, then added a CL_ParticleEffect which calls this with true for both
removed cubemapnum field from dlight_t

------------------------------------------------------------------------
r6808 | havoc | 2007-02-08 07:56:40 -0800 (Thu, 08 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/mvm_cmds.c

added DP_QC_STRFTIME extension to menu vm (somehow I missed this when committing earlier)

------------------------------------------------------------------------
r6807 | havoc | 2007-02-08 07:56:10 -0800 (Thu, 08 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/protocol.c

reworked entity priority handling in DP6/7 protocols to better utilize limited bandwidth and just be cleaner code in general

------------------------------------------------------------------------
r6806 | havoc | 2007-02-08 07:37:08 -0800 (Thu, 08 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

disabled use of certain prediction code when the server has blocked prediction

------------------------------------------------------------------------
r6805 | havoc | 2007-02-08 07:13:27 -0800 (Thu, 08 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

lowered minimum maxpacketsize from 100 bytes to 50 bytes (this means rate 1000 will be honored at the default sys_ticrate 0.05)

------------------------------------------------------------------------
r6803 | havoc | 2007-02-08 02:15:36 -0800 (Thu, 08 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.h
   M /trunk/darkplaces/svvm_cmds.c

added DP_QC_STRFTIME extension

------------------------------------------------------------------------
r6802 | havoc | 2007-02-07 10:39:41 -0800 (Wed, 07 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_user.c

added a check for move->sequence that is more than 16 packets old to avoid having frozen players after a level change

------------------------------------------------------------------------
r6801 | havoc | 2007-02-06 00:43:08 -0800 (Tue, 06 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c

some slight cleanup of CL_LerpPoint, and now does a bound() on cl.time as well as cl.timenonlerp whenever cl.mtime[] is updated

------------------------------------------------------------------------
r6800 | havoc | 2007-02-06 00:36:14 -0800 (Tue, 06 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_user.c

tolerate clients living up to one frame in the future, just to be more flexible with client prediction

------------------------------------------------------------------------
r6799 | havoc | 2007-02-06 00:18:50 -0800 (Tue, 06 Feb 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/client.h

no longer sends moves if time is not moving forward, except when paused (this fixes some bugs causing cl_movement 0 to lose impulse/buttons)
no longer repeats old moves if cl_movement is off (because they would serve no purpose)
eliminated cl.movemessages (now uses cl.movesequence for the same purpose)

------------------------------------------------------------------------
r6798 | havoc | 2007-02-05 21:38:08 -0800 (Mon, 05 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_user.c

fix very stupid typo in input merging when cl_movement is 0

------------------------------------------------------------------------
r6797 | havoc | 2007-02-05 09:53:30 -0800 (Mon, 05 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_user.c

disabled debug print I forgot about

------------------------------------------------------------------------
r6796 | havoc | 2007-02-05 09:45:59 -0800 (Mon, 05 Feb 2007) | 6 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/csprogs.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sv_user.c
   M /trunk/darkplaces/todo

redesigned input networking code (still same protocol) and did a lot of cleaning, now predicts movement even if server packets are lost
added cl_netinputpacketlosstolerance cvar (default 4, qw used 2, can be up to 16) to repeat old input messages in each packet so that they can only be lost by heavy packet loss
changed sv_clmovement_waitforinput default to 16 to match this capability
reworked a lot of timing code related to input networking
fixed some bugs when frametime is 0 in player physics

------------------------------------------------------------------------
r6795 | havoc | 2007-02-05 07:47:55 -0800 (Mon, 05 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.dev

thanks to morfar for updating the Dev-C++ project file

------------------------------------------------------------------------
r6794 | havoc | 2007-02-05 05:32:09 -0800 (Mon, 05 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_user.c

changed default sv_clmovement_minping from 100 to 0

------------------------------------------------------------------------
r6793 | havoc | 2007-02-05 01:04:01 -0800 (Mon, 05 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

fixed double-jump bug in prediction when jumping up sides of crates or on stairs

------------------------------------------------------------------------
r6792 | havoc | 2007-02-05 00:55:12 -0800 (Mon, 05 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

fix q1bsp detection of stuck entities (needed some more parentheses)

------------------------------------------------------------------------
r6791 | havoc | 2007-02-05 00:41:34 -0800 (Mon, 05 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

removed an unneeded extern prototype

------------------------------------------------------------------------
r6790 | havoc | 2007-02-05 00:39:49 -0800 (Mon, 05 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/protocol.c

removed an unneeded cl.movement_replay = true; line

------------------------------------------------------------------------
r6789 | havoc | 2007-02-04 04:55:09 -0800 (Sun, 04 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/world.c
   M /trunk/darkplaces/world_cs.c

fix a couple printf format string warnings that only occur with COLLISIONPARANOID on

------------------------------------------------------------------------
r6788 | havoc | 2007-02-04 04:54:09 -0800 (Sun, 04 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/collision.c

refactored end code in Collision_Trace*BrushFloat functions to fix a severe logic bug that caused players to get stuck inside eachother in nexuiz

------------------------------------------------------------------------
r6787 | havoc | 2007-02-04 03:27:42 -0800 (Sun, 04 Feb 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c

minor optimization of surface scanning
minor optimization of leaf recursion
added a leafstack overflow check to visibility flooding

------------------------------------------------------------------------
r6786 | havoc | 2007-02-04 00:32:57 -0800 (Sun, 04 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

added r_showsurfaces 2 mode which shorts triangle draw order (to analyze whether models are optimized for vertex cache)

------------------------------------------------------------------------
r6785 | havoc | 2007-02-03 05:01:36 -0800 (Sat, 03 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_user.c

revised sv_clmovement_waitforinput default from 2 to 5 frames to have more tolerance for inconsistent packet timing

------------------------------------------------------------------------
r6782 | havoc | 2007-02-03 04:10:03 -0800 (Sat, 03 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/svvm_cmds.c

added DP_SV_PRINT extension

------------------------------------------------------------------------
r6781 | havoc | 2007-02-03 04:08:54 -0800 (Sat, 03 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

made CL_SetInfo check for more forbidden characters (key now refuses any form of whitespace, value now refuses \r and \n) and refactored the checking code to make it a bit cleaner

------------------------------------------------------------------------
r6780 | havoc | 2007-02-03 04:07:59 -0800 (Sat, 03 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

moved DP_QC_UNLIMITEDTEMPSTRINGS in extensions list to its proper place

------------------------------------------------------------------------
r6779 | havoc | 2007-02-03 00:49:02 -0800 (Sat, 03 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h

added r_shadow_frontsidecasting cvar (default 1), this allows switching to back-side casting instead, however this has proven buggy so it is not to be used yet

------------------------------------------------------------------------
r6778 | havoc | 2007-02-03 00:40:38 -0800 (Sat, 03 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/collision.c

optimized trimesh collision culling (this mostly affects patches)

------------------------------------------------------------------------
r6777 | havoc | 2007-02-02 22:33:07 -0800 (Fri, 02 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/collision.c

fix really stupid typo in previous patch that caused a memory smash

------------------------------------------------------------------------
r6776 | havoc | 2007-02-02 21:19:55 -0800 (Fri, 02 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/collision.c

fix bug in Collision_SnapCopyPoints that made it only snap the first vertex

------------------------------------------------------------------------
r6775 | havoc | 2007-02-02 20:03:01 -0800 (Fri, 02 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c

removed single-quoted string support in console parser because it breaks the maplist in nexuiz

------------------------------------------------------------------------
r6774 | havoc | 2007-02-02 19:36:26 -0800 (Fri, 02 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

fixed two bugs that caused a constant state of "player stuck" (one was that it always thought this was a q1bsp/hlbsp map, and the other was that the q1bsp/hlbsp corner checking was checking the wrong locations)

------------------------------------------------------------------------
r6773 | havoc | 2007-02-02 19:08:57 -0800 (Fri, 02 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

fixed bug in AVI RIFF chunk 1GB size limiting code (it was not accounting for the index buffer size which will be written afterward) which was causing the chunk to often exceed 1GB

------------------------------------------------------------------------
r6772 | havoc | 2007-02-02 06:39:13 -0800 (Fri, 02 Feb 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/view.c

moved interpolation of viewangles when playing back demos or spectating someone to a better place, this should work better with csqc

------------------------------------------------------------------------
r6771 | tomaz | 2007-01-29 13:32:09 -0800 (Mon, 29 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces-dedicated.dsp
   M /trunk/darkplaces/darkplaces-sdl.dsp
   M /trunk/darkplaces/darkplaces.dsp

Updated the workspaces to include svbsp.c and svbsp.h

------------------------------------------------------------------------
r6770 | havoc | 2007-01-29 02:33:33 -0800 (Mon, 29 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

497

------------------------------------------------------------------------
r6769 | havoc | 2007-01-29 02:31:14 -0800 (Mon, 29 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

reverted r_bloom_colorsubtract and r_shadow_brighten defaults to 0.125 and 2

------------------------------------------------------------------------
r6768 | havoc | 2007-01-29 02:20:05 -0800 (Mon, 29 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

changed default r_shadow_gloss2intensity from 0.5 to 0.125, now looks more like tenebrae again (except a little better)

------------------------------------------------------------------------
r6767 | havoc | 2007-01-29 01:52:31 -0800 (Mon, 29 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

fix very stupid bug in svbsp calls that made only the first triangle of an occluding surface polygon be inserted into the svbsp, and some other cleanup/corrections

------------------------------------------------------------------------
r6766 | havoc | 2007-01-29 01:51:20 -0800 (Mon, 29 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/svbsp.c

some minor optimizations, comment corrections, and changed debug polygon colors

------------------------------------------------------------------------
r6765 | havoc | 2007-01-28 23:51:07 -0800 (Sun, 28 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

fix stupid bug in insertion of occluder triangles in the svbsp code (it was stopping after adding the first one)

------------------------------------------------------------------------
r6763 | havoc | 2007-01-28 00:25:15 -0800 (Sun, 28 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

corrected OPTIONS_ITEMS and OPTIONS_GRAPHICS_ITEMS constants (the last 3 items of the graphics options submenu were not reachable)

------------------------------------------------------------------------
r6762 | havoc | 2007-01-27 20:14:59 -0800 (Sat, 27 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

fix stupid bug (dynamic shadowing from models was checking if NOSHADOW was set, not if it was clear)

------------------------------------------------------------------------
r6761 | havoc | 2007-01-27 18:57:51 -0800 (Sat, 27 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/makefile.inc
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h
   A /trunk/darkplaces/svbsp.c
   A /trunk/darkplaces/svbsp.h

implemented Shadow Volume BSP based culling of lit surfaces, this is slightly better than the existing portal culling code (or much better in the case of detail brush terrain in q3bsp where little culling was performed previously), and is now the only culling method used by rtlight compilation

------------------------------------------------------------------------
r6760 | havoc | 2007-01-27 18:55:15 -0800 (Sat, 27 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_sprite.c
   M /trunk/darkplaces/render.h

added MATERIALFLAG_NOSHADOW in an effort to clean up the material checking in shadow code a bit

------------------------------------------------------------------------
r6759 | havoc | 2007-01-27 18:52:41 -0800 (Sat, 27 Jan 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/matrixlib.c
   M /trunk/darkplaces/matrixlib.h

patch from Tomaz adding a proper matrix inverter, it should be able to invert any matrix that is possible to invert, but is VERY slow, and consequently Matrix4x4_Invert_Simple has been kept for speed reasons
it is probably possible to optimize this function significantly, and it would also be possible to add non-uniform-scaling inversion to Matrix4x4_Invert_Simple to make it more flexible

------------------------------------------------------------------------
r6758 | havoc | 2007-01-27 18:50:32 -0800 (Sat, 27 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/prvm_cmds.c

added Debug_Polygon functions for testing, these are currently abusing the CSQC polygon queue and have many stupid limitations which should be cleaned up at some point, but it is now possible to call these to draw things for debugging purposes

------------------------------------------------------------------------
r6757 | havoc | 2007-01-25 21:58:43 -0800 (Thu, 25 Jan 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

changed sbar stats (Monsters/Secrets/Time/map title) around a bit, inspired by a patch from steven a but not directly based on it
specific changes: Monsters/Secrets are now on top row (rather than left side), map filename (minus path/extension) and map title are shown, time moved to far right of second row

------------------------------------------------------------------------
r6756 | havoc | 2007-01-25 08:27:19 -0800 (Thu, 25 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/csprogs.c

fixed renderflags handling in CSQC_AddRenderEdict

------------------------------------------------------------------------
r6755 | havoc | 2007-01-25 08:07:30 -0800 (Thu, 25 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c

clients who are downloading can now receive chat messages and other notices

------------------------------------------------------------------------
r6754 | havoc | 2007-01-24 13:27:06 -0800 (Wed, 24 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/portals.c

disabled use of Portal_PortalThroughPortalPlanes on triangles in exact triangle culling mode because it was falsely culling some polygons (particularly in start.bsp), this makes the culling less exact unfortunately

------------------------------------------------------------------------
r6753 | havoc | 2007-01-24 13:26:13 -0800 (Wed, 24 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

fixed bug where toggling r_shadow_realtime_world_compile would alter the culling boxes of the compiled rtlights when in the non-compiled state

------------------------------------------------------------------------
r6750 | havoc | 2007-01-24 10:40:26 -0800 (Wed, 24 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/svvm_cmds.c
   M /trunk/darkplaces/todo
   M /trunk/dpmod/qc/dpextensions.qc

added BX_WAL_SUPPORT to extensions list and documented it (.wal texture support has been in for a long time before this)

------------------------------------------------------------------------
r6749 | havoc | 2007-01-24 09:48:49 -0800 (Wed, 24 Jan 2007) | 5 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/render.h

some cleanup of shader permutation handling
expanded shader permutation system to allow multiple shader source files (not sure if this will ever be used) rather than just "glsl/default.glsl"
added code support for geometry shaders (not actually hooked up because there's no GL_ARB_geometry_shader extension yet)
added flagging of which shader objects are needed by a given permutation (to allow vertex-only shaders for shadow volume projection and such, also not implemented)

------------------------------------------------------------------------
r6748 | havoc | 2007-01-24 06:21:05 -0800 (Wed, 24 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/world.c
   M /trunk/darkplaces/world_cs.c

fix a few typos in comments

------------------------------------------------------------------------
r6747 | havoc | 2007-01-24 06:19:39 -0800 (Wed, 24 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/prvm_exec.c

replaced prvm_tempstringmemory cvar with automatic buffer growth (with a limit of 256MB)

------------------------------------------------------------------------
r6746 | havoc | 2007-01-23 20:15:45 -0800 (Tue, 23 Jan 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/prvm_exec.c
   M /trunk/darkplaces/prvm_execprogram.h
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sv_user.c
   M /trunk/darkplaces/svvm_cmds.c
   M /trunk/darkplaces/todo

redesigned tempstring system, now uses a fixed size buffer based on the prvm_tempstringmemory cvar (this is probably safe to automatically resize in the future but is not currently resized)
audited PRVM_G_STRING use in the engine (eliminated many NULL checks in functions because it never returns NULL)
added DP_QC_UNLIMITEDTEMPSTRINGS extension to indicate this new tempstring system's wonderous features (not yet documented)

------------------------------------------------------------------------
r6745 | havoc | 2007-01-23 19:56:16 -0800 (Tue, 23 Jan 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/menu.c

added r_hdr_range cvar (which just divides r_bloom_colorscale and multiplies r_bloom_brighten)
changed default r_bloom_brighten from 2 to 1 and r_bloom_colorsubtract from 0.125 to 0, this gives a more color-preserving bloom effect and actually seems brighter in many cases

------------------------------------------------------------------------
r6744 | havoc | 2007-01-23 11:36:14 -0800 (Tue, 23 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

another minor cleanup for static entities related to delayed model loading (no bugs involved though)

------------------------------------------------------------------------
r6743 | havoc | 2007-01-23 11:34:20 -0800 (Tue, 23 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

fixed bug in CL_RelinkStaticEntities related to delayed model loading, now calls CL_UpdateRenderEntity so the culling box is correct

------------------------------------------------------------------------
r6742 | havoc | 2007-01-23 08:58:57 -0800 (Tue, 23 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cmd.c

changed Cmd_StuffCmds_f to combine the entire set of commandline arguments into one string before calling Cbuf_InsertText, this fixes the reverse order execution bug (where +deathmatch 7 +map dpdm2 would execute deathmatch 7 AFTER starting the map, which was useless until a restart command was issued)

------------------------------------------------------------------------
r6741 | havoc | 2007-01-23 08:51:26 -0800 (Tue, 23 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

fix bug in GL_CullFace which was causing it to often malfunction

------------------------------------------------------------------------
r6740 | havoc | 2007-01-22 19:12:39 -0800 (Mon, 22 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

504 (-7)

------------------------------------------------------------------------
r6739 | havoc | 2007-01-22 19:02:53 -0800 (Mon, 22 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_demo.c
   M /trunk/darkplaces/client.h

changed the not-very-useful min/avg/max part of timedemo results to one-second min/avg/max

------------------------------------------------------------------------
r6738 | havoc | 2007-01-22 17:40:36 -0800 (Mon, 22 Jan 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/csprogs.c

fixed bug in CSQC_AddRenderEdict (it was using the tempentity's modelindex rather than the vm entity, meaning that csqc entities never had a visible model)
reduced code by merging cl.csqc_model_precache lookups into CSQC_GetModelByIndex and CSQC_GetModelFromEntity functions

------------------------------------------------------------------------
r6737 | havoc | 2007-01-22 16:43:51 -0800 (Mon, 22 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/cl_collision.h
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/csprogs.c

eliminated cl.csqc_entities array and related fields

------------------------------------------------------------------------
r6736 | havoc | 2007-01-22 16:27:49 -0800 (Mon, 22 Jan 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/csprogs.h
   M /trunk/darkplaces/view.c

significant cleanup of CL_UpdateEntities, GL_UpdateNetworkEntity, CL_LinkNetworkEntity, V_CalcRefdef handling, and CSQC issues related to these
eliminated linkframe from entity_t (this means CL_UpdateNetworkEntity may sometimes process an entity twice, and CL_LinkNetworkEntity is no longer recursive as it does not need to be)

------------------------------------------------------------------------
r6735 | havoc | 2007-01-22 15:16:00 -0800 (Mon, 22 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

fix a couple warnings (one of them more serious than the other)

------------------------------------------------------------------------
r6734 | havoc | 2007-01-22 14:14:47 -0800 (Mon, 22 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c

added support for single-quoted strings in COM_ParseTokenConsole

------------------------------------------------------------------------
r6733 | havoc | 2007-01-22 14:13:51 -0800 (Mon, 22 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c

removed \ escape character support from COM_ParseTokenConsole because it breaks \ bindings in configs and may have other issues

------------------------------------------------------------------------
r6732 | havoc | 2007-01-22 14:01:27 -0800 (Mon, 22 Jan 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/csprogs.h
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/fs.h
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c

implemented csprogs.dat downloading with special dlcache/name.size.crc file naming, this is in need of testing
added csqc_progsize cvar to csqc signon process (still compatible with old servers)

------------------------------------------------------------------------
r6731 | havoc | 2007-01-22 11:31:49 -0800 (Mon, 22 Jan 2007) | 5 lines
Changed paths:
   M /trunk/darkplaces/vid_sdl.c

two improvements to vid_restart in the SDL client: hardware gamma is now
restored after vid_restart, and the brief fullscreen window (used to reset
the SDL GL attributes) is now only used during vid_restart, not the initial
client startup

------------------------------------------------------------------------
r6730 | havoc | 2007-01-22 10:34:13 -0800 (Mon, 22 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

STAT_TOTALSECRETS and STAT_TOTALMONSTERS are now networked so deathmatch 7 mode in dpmod shows the total monsters now

------------------------------------------------------------------------
r6729 | havoc | 2007-01-22 10:20:05 -0800 (Mon, 22 Jan 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/svvm_cmds.c

modified droptofloor to treat trace.startsolid as an acceptable situation, this prevents many items falling out of various user-made maps (including a critial item in level x2m4 of X-Men: Ravages of Apocalypse)
added sv_gameplayfix_droptofloorstartsolid cvar to control this behavior

------------------------------------------------------------------------
r6728 | havoc | 2007-01-22 06:59:47 -0800 (Mon, 22 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/svvm_cmds.c

added framecount and framerate checks to PF_effect

------------------------------------------------------------------------
r6727 | havoc | 2007-01-22 06:53:52 -0800 (Mon, 22 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c

added \' and \\ support to parsers, and added such escape code support to ' quoted strings and regular words

------------------------------------------------------------------------
r6726 | havoc | 2007-01-22 06:51:05 -0800 (Mon, 22 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c

implemented \" and \n support in quoted string parsers (console and otherwise)

------------------------------------------------------------------------
r6725 | havoc | 2007-01-22 06:42:05 -0800 (Mon, 22 Jan 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h

moved EF_MUZZLEFLASH checking to CL_MoveLerpEntityStates to make muzzleflashes reliably work when the client is running slower than the server
made muzzleflash 1.5x as large and 4x as bright as before, and fade in 50ms instead of 100ms
changed dlight decay to scale color instead of radius

------------------------------------------------------------------------
r6722 | havoc | 2007-01-22 05:37:39 -0800 (Mon, 22 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

tweaked default TE_TELEPORT effect, it now spawns one large very bright particle in the middle and 1/8th as many small particles, this should improve multiplayer performance on slow graphics cards, also doubled the brightness of the dlight created, and made it last a bit longer

------------------------------------------------------------------------
r6721 | havoc | 2007-01-22 05:22:46 -0800 (Mon, 22 Jan 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

improved SV_TestEntityPosition in q1bsp/hlbsp by checking the 8 corner points of the box, this fixes the misaligned double-doors bug in the Prydon Gate expansion "The Dark Age"
changed Stuck entity warning from developer 1 to developer 100 because it's annoying and not very helpful

------------------------------------------------------------------------
r6720 | havoc | 2007-01-22 05:20:29 -0800 (Mon, 22 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

client no longer tries to download missing files from server if it is hosting the server

------------------------------------------------------------------------
r6719 | havoc | 2007-01-22 04:06:42 -0800 (Mon, 22 Jan 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/fs.h

changed FS_ChangeGamedir to FS_ChangeGameDirs and made it fail if any of the gamedirs are missing (if the failmissing parameter is set) and detect various other failures
FS_Init now checks if game directories are found and does a Sys_Error if not
now does a Host_Error if a QW server specifies an invalid gamedir (missing gamedir is ok however, because QW downloads files)

------------------------------------------------------------------------
r6718 | havoc | 2007-01-22 02:40:58 -0800 (Mon, 22 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

changed ping report name matching to allow scoreboard names to be longer than ping report names (because recent versions of ClanRing CTF seem to append READY on the scoreboard but not the ping report)

------------------------------------------------------------------------
r6717 | havoc | 2007-01-22 02:38:06 -0800 (Mon, 22 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

CL_Effect (called by svc_effect parsing) now sanity checks framerate and framecount

------------------------------------------------------------------------
r6716 | havoc | 2007-01-21 15:12:20 -0800 (Sun, 21 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/todo

autodetect whether a map supports transparent water at load time

------------------------------------------------------------------------
r6715 | havoc | 2007-01-21 12:27:36 -0800 (Sun, 21 Jan 2007) | 6 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/fs.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_user.c
   M /trunk/darkplaces/todo

implemented individual file downloads on darkplaces servers
deferred loading of files until signon 2 (necessary for download system)
made loading of files operate in two passes, first for existing files and then again for files that need to be downloaded
added cl_joinbeforedownloadsfinish cvar to cause the game to begin after the map is loaded, before other downloads finish (not entirely sure this is a good idea, but it's cool)
added sv_allowdownloads cvar to allow enabling/disabling of downloads, and sv_allowdownloads_inarchive and sv_allowdownloads_archive cvars to allow server administrators to enable downloading files from archives or even whole archives if so desired (however the client does not currently request archives)

------------------------------------------------------------------------
r6714 | havoc | 2007-01-21 06:21:53 -0800 (Sun, 21 Jan 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h
   M /trunk/darkplaces/vid_shared.c

reorganized view rendering setup code a bit to reduce potential for state bugs (more thorough and consistent state resets now)
added support for glStencilOpSeparate function in OpenGL 2.0 (or GL_ATI_separate_stencil extension prior to that), so ATI cards should get a speed boost now, this path is now also used on NVIDIA hardware, but support for GL_EXT_stencil_two_side extension has been retained to support several other vendors

------------------------------------------------------------------------
r6713 | havoc | 2007-01-21 03:53:08 -0800 (Sun, 21 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

added some comments in Mod_LoadModel

------------------------------------------------------------------------
r6712 | havoc | 2007-01-21 03:52:29 -0800 (Sun, 21 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

fixed negative time delta problem with sbar item flashing

------------------------------------------------------------------------
r6711 | havoc | 2007-01-21 03:51:27 -0800 (Sun, 21 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/fs.h

added FS_FileSize and made FS_FileExtension public

------------------------------------------------------------------------
r6710 | havoc | 2007-01-21 03:39:19 -0800 (Sun, 21 Jan 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c

r_textshadow is now a saved cvar
the r_textshadow shadow color is now 1-red-green-blue (basically meaning it is black except for black text where it is white)

------------------------------------------------------------------------
r6709 | havoc | 2007-01-20 14:52:03 -0800 (Sat, 20 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/wad.c
   M /trunk/darkplaces/wad.h

very minor cleaning

------------------------------------------------------------------------
r6708 | havoc | 2007-01-20 01:27:05 -0800 (Sat, 20 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_sky.c

fix a crash in R_SkyStartFrame when there is no worldmodel

------------------------------------------------------------------------
r6707 | havoc | 2007-01-20 01:16:17 -0800 (Sat, 20 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/fs.h

added FS_CheckNastyPath prototype to fs.h so that it can be used elsewhere

------------------------------------------------------------------------
r6706 | havoc | 2007-01-20 01:14:02 -0800 (Sat, 20 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_mem.c

S_PrecacheSound now clears the SFXFLAG_FILEMISSING flag so that loading will try again on previously missing files whenever the level changes (particularly important if downloads or gamedir changes have occurred)

------------------------------------------------------------------------
r6703 | havoc | 2007-01-18 03:08:11 -0800 (Thu, 18 Jan 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/menu.h

increased M_MAX_EDICTS to 32768
note to Black: 640k ought to be enough for everybody using the nexuiz menu, right? ;)

------------------------------------------------------------------------
r6702 | havoc | 2007-01-18 03:04:31 -0800 (Thu, 18 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/csprogs.h

changed CL_MAX_EDICTS to match MAX_EDICTS

------------------------------------------------------------------------
r6701 | havoc | 2007-01-18 02:58:03 -0800 (Thu, 18 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

applied div0's patch to the tell command adding player number support (as opposed to the hard-to-type player names) as well as fixing a bug with quoted player names containing spaces accidentally sending part of the player name to the recipient (similar to the quake tell bug which sent the entire player name)

------------------------------------------------------------------------
r6700 | havoc | 2007-01-18 02:44:24 -0800 (Thu, 18 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/collision.c
   M /trunk/darkplaces/model_brush.c

added collision_prefernudgedfraction cvar (defaults to 1), which should improve collision stability in 'wedge corner' cases (such as creases in terrain)

------------------------------------------------------------------------
r6699 | havoc | 2007-01-18 02:41:26 -0800 (Thu, 18 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

renamed r_bloomstate.vertex3f to r_screenvertex3f and made it constant

------------------------------------------------------------------------
r6698 | havoc | 2007-01-18 02:39:02 -0800 (Thu, 18 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/view.c

fixed problems with cl.time stepping backwards causing a black fade-in and other problems

------------------------------------------------------------------------
r6697 | havoc | 2007-01-18 00:49:50 -0800 (Thu, 18 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/lhnet.c

support partial IP addresses in the ipv4 address parser, this fixes the 20+ second delay when parsing status messages on some modified quake servers that report only partial addresses (hiding the last octet)

------------------------------------------------------------------------
r6696 | havoc | 2007-01-17 23:04:14 -0800 (Wed, 17 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt

expanded the Replacement Content section with some example filenames and other information

------------------------------------------------------------------------
r6695 | havoc | 2007-01-14 03:18:17 -0800 (Sun, 14 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

changed extResponse handler to quote the address string when passing it to the menu qc

------------------------------------------------------------------------
r6694 | havoc | 2007-01-14 02:19:20 -0800 (Sun, 14 Jan 2007) | 3 lines
Changed paths:
   M /trunk/darkplaces/cd_win.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/console.h
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/fs.h
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/image_png.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/prvm_execprogram.h
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/snd_mix.c
   M /trunk/darkplaces/snd_win.c
   M /trunk/darkplaces/sys.h
   M /trunk/darkplaces/vid_agl.c
   M /trunk/darkplaces/vid_wgl.c
   M /trunk/darkplaces/zone.c

patch from div0 that enables printf format warnings in gcc
patch from div0 that fixes a lot of printf format warnings (some quite bad)

------------------------------------------------------------------------
r6693 | havoc | 2007-01-14 02:09:16 -0800 (Sun, 14 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/sv_main.c

patch from div0 that adds sv_random_seed for benchmarking servers with bots the same way repeatedly

------------------------------------------------------------------------
r6692 | havoc | 2007-01-14 02:05:49 -0800 (Sun, 14 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

patch from div0 to add sv_adminnick cvar which overrides hostname as the name to use in chat from the dedicated server console (or via rcon say and such)

------------------------------------------------------------------------
r6691 | havoc | 2007-01-14 02:03:13 -0800 (Sun, 14 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_user.c

cast time of received moves to float to prevent negative ping estimates when timer is degraded severely

------------------------------------------------------------------------
r6690 | havoc | 2007-01-14 01:59:26 -0800 (Sun, 14 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/mvm_cmds.c

added DP_MENU_EXTRESPONSEPACKET to extensions list

------------------------------------------------------------------------
r6689 | havoc | 2007-01-14 01:56:30 -0800 (Sun, 14 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/netconn.h

patch from div0 that adds a special "extResponse " type of packet that can be returned to menu qc as a string (to query current version of Nexuiz or anything else of that nature, requires special servers that return such packets, the packets are sent using the "packet" command which already existed from qw support)

------------------------------------------------------------------------
r6688 | havoc | 2007-01-14 01:53:31 -0800 (Sun, 14 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/draw.h
   M /trunk/darkplaces/gl_draw.c

patch from div0 to make DrawQ_ColoredString return the length of the printed text

------------------------------------------------------------------------
r6687 | havoc | 2007-01-14 01:51:52 -0800 (Sun, 14 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

patch from div0 to clamp ping reports to 1-9999 range in getinfo server queries

------------------------------------------------------------------------
r6686 | havoc | 2007-01-14 01:50:42 -0800 (Sun, 14 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.inc

added -Wdeclaration-after-statement to warn about any use of C99 lazy variable declaration (which is not supported by MSVC)

------------------------------------------------------------------------
r6685 | havoc | 2007-01-11 19:40:35 -0800 (Thu, 11 Jan 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_demo.c
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/cmd.h
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/sv_user.c

changed Cmd_AddCommand to only work for console commands, not client commands executed on the server, Cmd_AddCommand_WithClientCommand has been added to allow separate command functions for console commands and client commands, this got rid of a lot of cmd_source == src_command checks
this refactoring fixes a security vulnerability in the clcommand builtin provided by KRIMZON_SV_PARSECLIENTCOMMAND, which was able to execute many commands on the server console, and that put the burden on the QC code to validate command safety, which was not intended
in short: this fixes a remote console command execution vulnerability that affected a few games/mods

------------------------------------------------------------------------
r6684 | havoc | 2007-01-11 16:34:19 -0800 (Thu, 11 Jan 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/fs.c

gamedir is now checked by FS_CheckNastyPath
added special isgamedir flag to FS_CheckNastyPath to validate gamedir using more stringent checks than for normal filenames
added additional checks in FS_CheckNastyPath for things like . in path elements (still allowed in filename at end but no longer allowed in path elements at all)

------------------------------------------------------------------------
r6683 | havoc | 2007-01-10 20:48:25 -0800 (Wed, 10 Jan 2007) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/todo

implemented new bloom code (still not using GLSL, but the new bloom is much nicer and more configurable)
added r_shadow_glossexponent cvar to control width of specular highlights
changed r_shadow_glossexponent default from 8 to 32 (looks more like metal or wet stone)

------------------------------------------------------------------------
r6682 | havoc | 2007-01-10 20:45:12 -0800 (Wed, 10 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/vid_shared.c

implemented detection of GL_EXT_blend_subtract

------------------------------------------------------------------------
r6681 | havoc | 2007-01-10 20:43:48 -0800 (Wed, 10 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.h

try harder to identify little endian cpus when BYTE_ORDER is undefined

------------------------------------------------------------------------
r6680 | havoc | 2007-01-04 13:25:05 -0800 (Thu, 04 Jan 2007) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

corrected comment on savings of the optimized skeletal cases

------------------------------------------------------------------------
r6675 | havoc | 2006-12-31 11:38:46 -0800 (Sun, 31 Dec 2006) | 4 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h

added r_shadow_glossexponent cvar to control specular power (sharpness)
changed default r_shadow_glossintensity from 1 to 2, r_shadow_gloss2intensity from 0.25 to 0.5, r_shadow_glossexponent from 8 to 32 (gloss is now much more metallic looking)
moved some stencil operation reset code to after the GL_EXT_stencil_two_side extension is turned off (just to be safer)

------------------------------------------------------------------------
r6674 | havoc | 2006-12-30 12:28:06 -0800 (Sat, 30 Dec 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

fix bug that made some models not cast shadows from the correct location

------------------------------------------------------------------------
r6673 | havoc | 2006-12-30 08:30:18 -0800 (Sat, 30 Dec 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h

added r_shadows cvar which renders Quake3 cg_shadows 2 style stencil shadows from models

------------------------------------------------------------------------
r6672 | havoc | 2006-12-30 08:28:26 -0800 (Sat, 30 Dec 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

I don't know how this got committed

------------------------------------------------------------------------
r6671 | havoc | 2006-12-30 08:07:18 -0800 (Sat, 30 Dec 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fix default modellight_lightdir shading direction in q1bsp (this has no effect since diffuse is black)

------------------------------------------------------------------------
r6670 | havoc | 2006-12-30 07:55:42 -0800 (Sat, 30 Dec 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h

added a missing const modifier

------------------------------------------------------------------------
r6669 | havoc | 2006-12-30 01:30:33 -0800 (Sat, 30 Dec 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

fix stupid bug in CL_SetInfo when checking for pmodel/emodel as key (it was using Cmd_Argv)

------------------------------------------------------------------------
r6668 | havoc | 2006-12-27 17:49:03 -0800 (Wed, 27 Dec 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

patch from div0 that adds sv_public modes -2 (do not allow players to connect) and -1 (do not respond to queries)

------------------------------------------------------------------------
r6667 | havoc | 2006-12-24 04:34:20 -0800 (Sun, 24 Dec 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/collision.c

made brush loader trust q3map2 brushes completely, still falls out of terrain maps using .ase models

------------------------------------------------------------------------
r6666 | havoc | 2006-12-24 01:38:01 -0800 (Sun, 24 Dec 2006) | 3 lines
Changed paths:
   M /trunk/darkplaces/collision.c

changed collision brush loader to not discard planes that don't produce a polygon, this fixes many terrain and ramp problems in q3bsp (q3map2 inserted planes to fix these edge cases but the engine was discarding them)
optimized brush collision code to have more early out cases

------------------------------------------------------------------------
r6665 | havoc | 2006-12-23 17:16:05 -0800 (Sat, 23 Dec 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

set world mins/maxs/absmin/absmax at server startup

------------------------------------------------------------------------
r6664 | black | 2006-12-23 08:04:52 -0800 (Sat, 23 Dec 2006) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

Init gl_main before gl_draw to make DP start from anywhere without crashing. Additionally it's more logical that way.
(If this breaks something, you can try to stone me or whoever who wrote the code in the first place ;))

------------------------------------------------------------------------
r6663 | havoc | 2006-12-22 05:05:38 -0800 (Fri, 22 Dec 2006) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h

raised MAX_TEXTUREUNITS from 16 to 64
fixed bug with backendimageunits/backendarrayunits not being limited to MAX_TEXTUREUNITS (caused memory corruption on NVIDIA GeForce 8 series which have 32 texture image units), backendunits was already limited properly

------------------------------------------------------------------------
r6662 | havoc | 2006-12-21 01:12:21 -0800 (Thu, 21 Dec 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h

removed Q3TEXTUREFLAG_ALPHATEST uses in the code, fixing a bug that made alpha test surfaces not be alpha tested (now checks shader->layers[0].alphatest)

------------------------------------------------------------------------
r6661 | havoc | 2006-12-18 22:47:27 -0800 (Mon, 18 Dec 2006) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/vid_shared.c

support for GL_ARB_texture_non_power_of_two extension (makes quake textures look a bit sharper on cards that support it and saves video memory)
known to be supported on NVIDIA Geforce 6 and above

------------------------------------------------------------------------
r6660 | havoc | 2006-12-18 10:11:08 -0800 (Mon, 18 Dec 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c

added a missing extern

------------------------------------------------------------------------
r6659 | havoc | 2006-12-18 09:21:02 -0800 (Mon, 18 Dec 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/fs.h

patch from div0 to fix screenshot naming when -game is used

------------------------------------------------------------------------
r6658 | havoc | 2006-12-17 10:25:46 -0800 (Sun, 17 Dec 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/host.c

implemented QW gamedir switching and manual gamedir switching (via "gamedir" command in console, can also use +gamedir on commandline), this may have lingering bugs

------------------------------------------------------------------------
r6657 | havoc | 2006-12-17 10:20:24 -0800 (Sun, 17 Dec 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

improved Mod_Q3BSP_LightPoint function to use r_refdef.lightstylevalue[0] to scale the color contribution, this means that dpmod darkmode works in q3bsp now

------------------------------------------------------------------------
r6656 | havoc | 2006-12-17 10:14:02 -0800 (Sun, 17 Dec 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_null.c
   M /trunk/darkplaces/sound.h

added snd_reload command to reload all sounds

------------------------------------------------------------------------
r6655 | havoc | 2006-12-17 10:11:01 -0800 (Sun, 17 Dec 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

removed unused packlist variable and pack->next field

------------------------------------------------------------------------
r6654 | havoc | 2006-12-16 13:42:33 -0800 (Sat, 16 Dec 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cvar.c
   M /trunk/darkplaces/cvar.h

added Cvar_UnlockDefaults function (not console accessible)

------------------------------------------------------------------------
r6653 | havoc | 2006-12-15 11:43:12 -0800 (Fri, 15 Dec 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c

removed an unused extern for fs_modified

------------------------------------------------------------------------
r6652 | havoc | 2006-12-15 11:42:10 -0800 (Fri, 15 Dec 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cmd.c

modified "stuffcmds" command (which runs commandline arguments preceded by + characters) to only do so once, this allows the quake.rc to be executed multiple times without executing commandline arguments multiple times

------------------------------------------------------------------------
r6651 | havoc | 2006-12-15 11:32:10 -0800 (Fri, 15 Dec 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/netconn.c

corrected some svc_nop's to clc_nop's (same value but more correct)

------------------------------------------------------------------------
r6650 | havoc | 2006-12-15 09:38:52 -0800 (Fri, 15 Dec 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/sv_main.c

removed NET_MAXRATE (as it served no useful purpose), changed description of rate to say bytespersecond instead of 500-25000 (which was wrong, the limit was 1000-150000)

------------------------------------------------------------------------
r6649 | havoc | 2006-12-14 04:12:02 -0800 (Thu, 14 Dec 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cmd.c

add a newline at the end of each exec'd config file

------------------------------------------------------------------------
r6648 | havoc | 2006-12-13 03:18:35 -0800 (Wed, 13 Dec 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.dev

updated Dev-C++ project file from Spirit

------------------------------------------------------------------------
r6647 | havoc | 2006-12-11 22:28:54 -0800 (Mon, 11 Dec 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c

display loading plaque much sooner in startup process, and draw it to GL_FRONT buffer rather than drawing it to the GL_BACK buffer and swapping, as if triple buffering is used the GL_BACK buffer might not be shown for some time, but the GL_FRONT buffer is instantaneous

------------------------------------------------------------------------
r6646 | havoc | 2006-12-11 08:39:13 -0800 (Mon, 11 Dec 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

moved health counter in quake hud back to its original position, no longer overlapping hipnotic key icons (for some reason Black's patch to add the nexuiz hud in revision 1.27 also moved the quake health counter, I can't discern why...)

------------------------------------------------------------------------
r6645 | havoc | 2006-12-11 02:07:47 -0800 (Mon, 11 Dec 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

optimized Mod_Alias_GetMesh_Vertices to eliminate memset calls and process arrays independently of eachother in the skeletal blending code, it also has an optimized case for one-bone vertices (the most common case)

------------------------------------------------------------------------
r6644 | havoc | 2006-12-11 02:06:01 -0800 (Mon, 11 Dec 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/csprogs.c

changed demo playback csqc mismatch error to a warning

------------------------------------------------------------------------
r6643 | havoc | 2006-12-10 05:30:16 -0800 (Sun, 10 Dec 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

fix crash when a client reconnects to the same client slot, thanks to div0 for reporting and investigating this bug

------------------------------------------------------------------------
r6641 | havoc | 2006-12-08 07:18:19 -0800 (Fri, 08 Dec 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

patch from div0 that fixes rate limiting code to make use of sv_maxrate (as it was supposed to)

------------------------------------------------------------------------
r6640 | havoc | 2006-12-06 05:12:57 -0800 (Wed, 06 Dec 2006) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fixed bug where non-autosprite transparencies rendered in the same batch as autosprite transparencies were not rendered (fixes light cones disappearing in q3dm0, among other things), this occurred because the code that handles q3 shaders using "deformvertexes autosprite" changed the array pointers but never changed them back when rendering another q3 shader that does not use deformvertexes
minor cleanup of RSurf_ActiveEntity (now uses RSurf_CleanUp rather than duplicating code)
moved RSurf_CleanUp above RSurf_ActiveEntity

------------------------------------------------------------------------
r6639 | havoc | 2006-12-06 05:08:44 -0800 (Wed, 06 Dec 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

corrected a misspelling in a comment

------------------------------------------------------------------------
r6638 | havoc | 2006-12-06 03:05:41 -0800 (Wed, 06 Dec 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

improved warnings from drawstring/drawpic/drawfill functions (they now state the correct function name, and print the full warning message, previously they were truncated if it was only one problem)

------------------------------------------------------------------------
r6637 | havoc | 2006-12-06 03:04:46 -0800 (Wed, 06 Dec 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/csprogs.c

fix connect error when csqc is not present (oops!)

------------------------------------------------------------------------
r6636 | havoc | 2006-12-06 01:04:48 -0800 (Wed, 06 Dec 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fixed black models when csqc is active

------------------------------------------------------------------------
r6635 | havoc | 2006-12-06 00:34:35 -0800 (Wed, 06 Dec 2006) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c

fixed bug that caused csqc to only load after a map restart
rearranged entity linking when csqc is active to fix the lagging weapon model bug

------------------------------------------------------------------------
r6634 | havoc | 2006-12-06 00:07:40 -0800 (Wed, 06 Dec 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

fixed a bug with cl_movement prediction being applied during demo playback

------------------------------------------------------------------------
r6633 | havoc | 2006-12-05 01:00:09 -0800 (Tue, 05 Dec 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

fixed a bug with blank frames in sprites failing to produce a texture (fixes painkeep exploding shotgun shell sprites which became white rectangles on certain frames)

------------------------------------------------------------------------
r6629 | havoc | 2006-11-30 17:40:16 -0800 (Thu, 30 Nov 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/keys.c

added con_closeontoggleconsole cvar based on Dresk's patch, but reduced to a minimal set of changes to one file rather than two

------------------------------------------------------------------------
r6628 | havoc | 2006-11-30 15:51:51 -0800 (Thu, 30 Nov 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/vid_shared.c

funky interlacing-like rendering feature from div0 (scr_stipple cvar)

------------------------------------------------------------------------
r6627 | havoc | 2006-11-24 17:28:12 -0800 (Fri, 24 Nov 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/svvm_cmds.c
   M /trunk/dpmod/qc/dpextensions.qc

patch from Dresk which adds DP_SV_ENTITYCONTENTSTRANSITION extension which calls a .contentstransition(oldcontents, newcontents) when the quake physics code detects a contents transition (empty to water for example)

------------------------------------------------------------------------
r6626 | havoc | 2006-11-24 14:55:08 -0800 (Fri, 24 Nov 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.h
   M /trunk/darkplaces/svvm_cmds.c
   M /trunk/dpmod/qc/dpextensions.qc

patch from Dresk for DP_QC_STRINGCOLORFUNCTIONS extension (strlennocol measures length of string with color chars removed (useful for centering text), strdecolorize returns a string with color codes stripped)

------------------------------------------------------------------------
r6625 | havoc | 2006-11-24 12:32:54 -0800 (Fri, 24 Nov 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/model_sprite.c
   M /trunk/darkplaces/model_sprite.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_sprites.c
   M /trunk/darkplaces/todo

added proper support for q3 shader animmap commands

------------------------------------------------------------------------
r6624 | havoc | 2006-11-23 11:35:52 -0800 (Thu, 23 Nov 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/todo

cleaned up GL_DepthTest and GL_CULL_FACE state management (by adding GL_CullFace), may fix some problems with rtlighting on EF_NODEPTHTEST entities

------------------------------------------------------------------------
r6622 | havoc | 2006-11-22 16:06:38 -0800 (Wed, 22 Nov 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.h
   M /trunk/darkplaces/svvm_cmds.c

added DP_ASINACOSATANATAN2TAN extension which adds common trig functions missing from standard QuakeC

------------------------------------------------------------------------
r6621 | havoc | 2006-11-17 07:47:22 -0800 (Fri, 17 Nov 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

added #define _FILE_OFFSET_BITS 64 to reduce problems with video recording on 32bit unix platforms (64bit Linux builds do not seem to have problems with this to begin with)

------------------------------------------------------------------------
r6620 | havoc | 2006-11-15 03:23:55 -0800 (Wed, 15 Nov 2006) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/svvm_cmds.c

made cl_viewmodel_scale apply to csqc and gettaginfo
fixed bug with concat order in stereo rendering (it was offseting along X in worldspace due to wrong concat order)

------------------------------------------------------------------------
r6619 | havoc | 2006-11-15 01:33:22 -0800 (Wed, 15 Nov 2006) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_sprites.c

fixed view location bugs in csqc; it was reading the player entity's render.origin field, which was broken...  removed the origin and angles fields from entity_render_t and eliminated all references
renamed CL_BoundingBoxForEntity to CL_UpdateRenderEntity and made it update the entity_render_t inversematrix and scale according to the matrix, and also calls R_LerpAnimation, this reduced code elsewhere

------------------------------------------------------------------------
r6618 | havoc | 2006-11-12 04:55:06 -0800 (Sun, 12 Nov 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/libcurl.c

patch from div0 to fix a segfault in curl support when canceling a file that isn't being downloaded

------------------------------------------------------------------------
r6617 | havoc | 2006-11-09 02:16:16 -0800 (Thu, 09 Nov 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

patch from div0 that removes connect flood ban when a player disconnects (this prevents people from getting connect-flood-banned for simply reconnecting after a pk3 autodownload in Nexuiz)

------------------------------------------------------------------------
r6616 | havoc | 2006-11-06 00:48:43 -0800 (Mon, 06 Nov 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/matrixlib.h

found MATRIX4x4_OPENGLORIENTATION to be a speed loss using gcc 4.1.0 with x86_64 architecture, disabled it by default

------------------------------------------------------------------------
r6615 | havoc | 2006-11-06 00:25:26 -0800 (Mon, 06 Nov 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/matrixlib.c
   M /trunk/darkplaces/matrixlib.h

implemented MATRIX4X4_OPENGLORIENTATION #define option, this is on by default and may improve performance compared to the D3D-style matrix orientation that was used before

------------------------------------------------------------------------
r6614 | havoc | 2006-11-06 00:23:43 -0800 (Mon, 06 Nov 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_alias.h

changed md3 tag storage to be the original float[12] OpenGL-orientation format rather than a matrix4x4 which was wasting some space

------------------------------------------------------------------------
r6613 | havoc | 2006-11-05 23:31:00 -0800 (Sun, 05 Nov 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/matrixlib.c
   M /trunk/darkplaces/matrixlib.h
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_sprites.c

more cleaning of matrix4x4_t struct access

------------------------------------------------------------------------
r6612 | havoc | 2006-11-05 22:13:54 -0800 (Sun, 05 Nov 2006) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/matrixlib.c
   M /trunk/darkplaces/matrixlib.h
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/r_sprites.c
   M /trunk/darkplaces/svvm_cmds.c
   M /trunk/darkplaces/todo
   M /trunk/darkplaces/view.c

cleaned up almost all direct indexing of matrix4x4_t structures to go through proper Matrix4x4 functions
removed some weird scaling code in gettaginfo QC builtin

------------------------------------------------------------------------
r6609 | havoc | 2006-10-23 03:34:09 -0700 (Mon, 23 Oct 2006) | 4 lines
Changed paths:
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/server.h

implemented connect flood blocking (100% effective on connect floods with an interval of 5 seconds or less between connects from the same IP address, and limits connect floods slower than that to occupying 2 slots at once due to a 10 second timeout)
cleaned up connect packet handling code to be more readable and consistent
reenabled rejoin code (allowing players to resume the game if their client crashes crashes but comes back with the same port number - rather rare unless cl_port is used, but could help people who do use cl_port)

------------------------------------------------------------------------
r6608 | havoc | 2006-10-23 03:22:07 -0700 (Mon, 23 Oct 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h

got rid of cl.qw_spectator flag because it can be determined by cl.scores[cl.playerentity].qw_spectator instead

------------------------------------------------------------------------
r6607 | havoc | 2006-10-20 08:57:17 -0700 (Fri, 20 Oct 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

attempt to avoid some Mem_Free errors on NULL pointers if there are no surfaces in the map

------------------------------------------------------------------------
r6606 | havoc | 2006-10-20 08:16:19 -0700 (Fri, 20 Oct 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

don't crash in scoreboard code when connected to a qw server as a spectator

------------------------------------------------------------------------
r6605 | havoc | 2006-10-18 02:08:50 -0700 (Wed, 18 Oct 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix bug with autosprite shaders when deformvertexes is applied twice during render of the same batch (why?  dunno, but it shouldn't break like this!)

------------------------------------------------------------------------
r6604 | havoc | 2006-10-17 20:52:49 -0700 (Tue, 17 Oct 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/todo
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_agl.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_null.c
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c

added vid_stereobuffer cvar based on patch from syschuck on the alientrap forums

------------------------------------------------------------------------
r6603 | havoc | 2006-10-17 20:45:23 -0700 (Tue, 17 Oct 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

some clean up of math used to generate trace start/end in prydon cursor code

------------------------------------------------------------------------
r6602 | havoc | 2006-10-17 20:34:34 -0700 (Tue, 17 Oct 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/view.c

added cl_viewmodel_scale cvar which controls gun model size

------------------------------------------------------------------------
r6597 | havoc | 2006-10-03 13:22:58 -0700 (Tue, 03 Oct 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c

added snd_soundradius cvar (default 1000 as before) to allow games (Nexuiz for instance) and people (mostly fans of dos quake's different sound radius) to adjust the sound radius

------------------------------------------------------------------------
r6596 | havoc | 2006-09-30 13:52:54 -0700 (Sat, 30 Sep 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c

implemented condump command (I was told by [515] that he implemented this command but he never sent me the code in his patch and so I was incorrectly under the impression that it was in the engine)

------------------------------------------------------------------------
r6595 | havoc | 2006-09-19 23:37:04 -0700 (Tue, 19 Sep 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

fixed a (hopefully rare) bug affecting shalrath missiles which caused multiple missiles to explode on successive frames due to the large bounding boxes of the MOVETYPE_FLYMISSILE explosions causing a touch event on the other flying missiles that were not yet near the player, which caused them to explode even though they were being touched by an explosion that was SOLID_NOT

------------------------------------------------------------------------
r6594 | havoc | 2006-09-19 01:45:13 -0700 (Tue, 19 Sep 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

fix bug that often made enforcer laser bolts 'stick' in the air if a player is standing right next to the enforcer when it fires, this was due to some internal confusion over what constitutes a 'startsolid' case, this has been clarified so that SV_PushEntity only uses trace.bmodelstartsolid, just like the toss/bounce/fly/flymissile/bouncemissile physics expect

------------------------------------------------------------------------
r6593 | havoc | 2006-09-18 22:12:07 -0700 (Mon, 18 Sep 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h

added GAME_DARSANA and GAME_CONTAGIONTHEORY

------------------------------------------------------------------------
r6592 | havoc | 2006-09-16 03:42:44 -0700 (Sat, 16 Sep 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

disabled junk tag writer that I wrote for byte by byte comparisons to mencoder-processed copies of my AVI files

------------------------------------------------------------------------
r6591 | havoc | 2006-09-16 03:40:17 -0700 (Sat, 16 Sep 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

removed some unused variables

------------------------------------------------------------------------
r6590 | havoc | 2006-09-16 03:25:05 -0700 (Sat, 16 Sep 2006) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/snd_main.c

removed video capture formats other than AVI I420 as it is the only useful format in practice (lots of jpeg/tga files is annoying to deal with, and few programs support rgb/yv12 raw dumps), this means no more .wav saving either and cleans the code a bit
fixed several bugs in sound system when saving avi (lingering .wav code)
added cl_capturevideo_realtime cvar to allow realtime capture if desired (requires a fast machine and can have A/V sync issues)

------------------------------------------------------------------------
r6589 | havoc | 2006-09-16 02:52:43 -0700 (Sat, 16 Sep 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

496

------------------------------------------------------------------------
r6588 | havoc | 2006-09-16 02:50:21 -0700 (Sat, 16 Sep 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_mix.c
   M /trunk/darkplaces/snd_null.c
   M /trunk/darkplaces/sound.h
   M /trunk/darkplaces/todo

implemented direct AVI video capture using the I420 colorspace (aka Intel(r) 4:2:0 codec) with interleaved PCM audio, and would like to thank Microsoft(r) for wasting many hours of my time with AVI format insanity

------------------------------------------------------------------------
r6587 | havoc | 2006-09-16 01:40:15 -0700 (Sat, 16 Sep 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

changed VM_fopen and VM_fclose announcements to require developer >= 100 like the VM_fputs/VM_fgets functions do, and made them console prints instead of VM_Warning calls (not sure why they were to begin with)

------------------------------------------------------------------------
r6586 | havoc | 2006-09-14 19:07:09 -0700 (Thu, 14 Sep 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c

hide warnings about missing gfx/crosshair* images

------------------------------------------------------------------------
r6585 | black | 2006-09-13 14:07:04 -0700 (Wed, 13 Sep 2006) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/csprogs.h
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/sv_main.c

Try to fix a dedicated server crash by moving the two csqc_ cvar initializations
into SV_Init. This is a hack, however, so someone else please clean this up :)
The VM's internal name now is always "client", so this should make life easier
when debugging (note: this doesn't affect the progs filename used).

------------------------------------------------------------------------
r6584 | havoc | 2006-09-12 00:22:40 -0700 (Tue, 12 Sep 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

changed deluxemapping detection code to deal with odd bsp files produced by q3map2 that contain two lightmaps but the second one is completely unused and blank and thus not suitable as a deluxemap, this fixes black (or very dim) surfaces in some small maps when GLSL is enabled

------------------------------------------------------------------------
r6583 | havoc | 2006-09-11 23:17:54 -0700 (Mon, 11 Sep 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_cmds.c

moved VM_FILES and VM_SEARCHLIST stuff to prvm_prog_t

------------------------------------------------------------------------
r6582 | havoc | 2006-09-11 22:56:26 -0700 (Mon, 11 Sep 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

remove some unsafe optimizations in VM_Files_Init and VM_Files_CloseAll (using memset on the return value of an indexing macro is generally a bad idea, and doesn't improve code readability)

------------------------------------------------------------------------
r6581 | havoc | 2006-09-11 21:35:31 -0700 (Mon, 11 Sep 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/progsvm.h

increased PRVM_MAX_STACK_DEPTH and PRVM_LOCALSTACK_SIZE at div0's request to reduce qc crashes with recursive rocket explosions in Nexuiz

------------------------------------------------------------------------
r6577 | havoc | 2006-09-01 02:35:38 -0700 (Fri, 01 Sep 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_shared.c

changed description for gl_finish cvar according to esteel's suggestion

------------------------------------------------------------------------
r6576 | havoc | 2006-08-29 05:58:45 -0700 (Tue, 29 Aug 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/sbar.c

another patch from div0 to improve ping parsing behavior in the event that multiple ping reports are received after a query (due to packets backlogging)

------------------------------------------------------------------------
r6575 | havoc | 2006-08-28 21:50:40 -0700 (Mon, 28 Aug 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

another patch from div0 to fix ping report parsing

------------------------------------------------------------------------
r6574 | havoc | 2006-08-27 03:13:24 -0700 (Sun, 27 Aug 2006) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

patch from div0 to fix ping report parsing where the first player slots are empty
fixed bug in negative ping parser (it was not skipping the - when it was negative)

------------------------------------------------------------------------
r6573 | havoc | 2006-08-27 02:23:07 -0700 (Sun, 27 Aug 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

greatly improved chances of connecting to a proquake server on the first try, by sending an svc_nop immediately upon connect

------------------------------------------------------------------------
r6572 | havoc | 2006-08-27 01:53:29 -0700 (Sun, 27 Aug 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/view.c

fix bug with gun bobbing in demo playback (where input packets are not sent, and thus the prediction replay was not occurring...)

------------------------------------------------------------------------
r6571 | havoc | 2006-08-27 01:52:53 -0700 (Sun, 27 Aug 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_execprogram.h

fix a bug with the divide by zero warning in the QC VM, it was not updating the relevant xfunction/xstatement variables

------------------------------------------------------------------------
r6570 | havoc | 2006-08-27 01:20:44 -0700 (Sun, 27 Aug 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

changed default timeformat (related to timestamps cvar for logging)

------------------------------------------------------------------------
r6569 | sajt | 2006-08-26 01:41:31 -0700 (Sat, 26 Aug 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

Fix for people with proper compilers :)

------------------------------------------------------------------------
r6568 | havoc | 2006-08-26 00:02:49 -0700 (Sat, 26 Aug 2006) | 7 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/csprogs.h
   M /trunk/darkplaces/draw.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.h
   M /trunk/darkplaces/todo
   M /trunk/darkplaces/view.c

CSQC fixes (less broken, still not spec compliant)
CSQC can now link the same entity multiple times (each time modified differently) as per the CSQC spec (this is mainly useful for rendering multi-model players based on one csqc entity, like Quake3's cgame does)
changed DrawQ functions to automatically set up 2D rendering if previous rendering was of a 3D view (necessary change for proper CSQC support)
changed QuakeC rint builtin implementation to handle very large values (outside of int range) and possibly run a little bit faster, note that it still rounds toward the nearest integer, away from zero (as intended)
refactored gun bob, damage kick fade, and stair smoothing code to eliminate a 'multiple fade steps per frame' bug
renamed the misnamed VM_ftoi function to VM_ftoe, in accordance with the menu QC builtin ftoe

------------------------------------------------------------------------
r6567 | havoc | 2006-08-25 08:33:33 -0700 (Fri, 25 Aug 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.inc

accidentally removed -fno-strict-aliasing

------------------------------------------------------------------------
r6566 | havoc | 2006-08-25 05:48:54 -0700 (Fri, 25 Aug 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

fix csqc support on dedicated servers (now CRC's the csqc_progname file at level start and sends that to clients, so it does not need to actually load the csqc_progname itself)

------------------------------------------------------------------------
r6565 | havoc | 2006-08-25 05:27:02 -0700 (Fri, 25 Aug 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_parse.c

fix the jittery gun bug related to onground changing rapidly

------------------------------------------------------------------------
r6564 | havoc | 2006-08-25 05:18:13 -0700 (Fri, 25 Aug 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c

disabled support for csqc entities in CL_SelectTraceLine

------------------------------------------------------------------------
r6563 | havoc | 2006-08-25 01:53:39 -0700 (Fri, 25 Aug 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.inc

changed release optimizations from -O2 -ffast-math -funroll-loops to simply -O2, this produced a 0.3% fps loss in my most extreme testing on x86_64, which does not seem significant, and gcc 4.1.0 was breaking the Nexuiz menu with the -funsafe-math-optimizations option (part of -ffast-math)

------------------------------------------------------------------------
r6562 | black | 2006-08-21 04:19:41 -0700 (Mon, 21 Aug 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

Fix a stupid typo in the sbar's ctf flag icon filenames.

------------------------------------------------------------------------
r6561 | havoc | 2006-08-21 00:40:40 -0700 (Mon, 21 Aug 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

nexuiz hud change to show flag status in CTF

------------------------------------------------------------------------
r6560 | havoc | 2006-08-18 21:25:06 -0700 (Fri, 18 Aug 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/libcurl.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/prvm_edict.c

patch from div to fix icc warnings

------------------------------------------------------------------------
r6559 | havoc | 2006-08-16 00:17:21 -0700 (Wed, 16 Aug 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/console.c

changed several '^' checks to STRING_COLOR_TAG as they should be

------------------------------------------------------------------------
r6558 | havoc | 2006-08-16 00:13:29 -0700 (Wed, 16 Aug 2006) | 3 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/host.c

reorganized Host_Init a bit, merged away a few functions (such as COM_CheckRegistered and COM_InitArgv) and changed some others, now registers several cvars earlier in the startup process
integrated patch from div0 for sys_colortranslation and sys_specialcharactertranslation cvars which control the translation of color codes and Quake characters for terminal output on stdout, this gets rid of the hideous ^7 on every line and makes colored text show up properly using ANSI color codes on most platforms (on windows the color codes are simply stripped because ANSI is not supported by windows terminals)

------------------------------------------------------------------------
r6557 | havoc | 2006-08-14 16:46:30 -0700 (Mon, 14 Aug 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

no longer has time or team columns in non-QW games

------------------------------------------------------------------------
r6556 | havoc | 2006-08-14 15:55:34 -0700 (Mon, 14 Aug 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

patch from div0: clamp "ping" reply valies in 0..9999 to prevent misparsing in case of uninitialized ping values

------------------------------------------------------------------------
r6555 | havoc | 2006-08-14 15:54:32 -0700 (Mon, 14 Aug 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/sv_main.c

patch from div0: Send download requirements at an earlier time to cause less message spam with the disconnect-and-reconnect download method

------------------------------------------------------------------------
r6554 | havoc | 2006-08-14 15:54:01 -0700 (Mon, 14 Aug 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cdaudio.h

oops forgot this from the cd loop/play named tracks patch

------------------------------------------------------------------------
r6553 | havoc | 2006-08-14 15:53:15 -0700 (Mon, 14 Aug 2006) | 6 lines
Changed paths:
   M /trunk/darkplaces/libcurl.c

patch from div0:
instead of downloading in game and reloading the map when it is done (which
caused crashes because of multiple world models in the model list and didn't
also reload sounds and models), disconnect while downloading and execute the
connect command to reconnect later

------------------------------------------------------------------------
r6552 | havoc | 2006-08-14 15:51:43 -0700 (Mon, 14 Aug 2006) | 10 lines
Changed paths:
   M /trunk/darkplaces/keys.c

patch from div0:
fix console weirdnesses:
* empty lines kill command history (instead don't add empty lines to the history)
* cursor position and history line length were done the wrong way, positioning
  the cursor outside of the line or only recalling part of a line

NOTE: maybe it is better to move the Con_Printf BELOW the return so an empty
prompt isn't even displayed? bash does not do it like that, IRC clients do it
like that, and personally I don't care

------------------------------------------------------------------------
r6551 | havoc | 2006-08-14 15:49:49 -0700 (Mon, 14 Aug 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cd_shared.c

patch from div0: cd loop and cd play commands now support named tracks (explicitly specifying a music track to play) as well as numbered (cd/fake cd)

------------------------------------------------------------------------
r6549 | havoc | 2006-08-13 22:14:24 -0700 (Sun, 13 Aug 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

reenabled the quake 'fall out of level' bug, to make the scorpion near the start of hip1m2 fall out of the ceiling as it was meant to (this probably fixes a lot of other bugs in various broken maps)

------------------------------------------------------------------------
r6548 | havoc | 2006-08-10 02:35:30 -0700 (Thu, 10 Aug 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

494

------------------------------------------------------------------------
r6545 | havoc | 2006-08-05 13:03:21 -0700 (Sat, 05 Aug 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.h

hush warnings about strcat and other redefinitions by undefining them first

------------------------------------------------------------------------
r6544 | molivier | 2006-08-05 05:31:03 -0700 (Sat, 05 Aug 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/cvar.c
   M /trunk/darkplaces/dpvsimpledecode.c
   M /trunk/darkplaces/filematch.c
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/lhnet.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/sbar.c
   M /trunk/darkplaces/snd_mem.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sys_sdl.c
   M /trunk/darkplaces/sys_win.c
   M /trunk/darkplaces/vid_agl.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_wgl.c

Removed all calls to strcpy; most of them are now calls to strlcpy or memcpy.

------------------------------------------------------------------------
r6543 | molivier | 2006-08-05 05:30:03 -0700 (Sat, 05 Aug 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_coreaudio.c

The inclusion of pthread.h was missing

------------------------------------------------------------------------
r6542 | molivier | 2006-08-04 04:37:32 -0700 (Fri, 04 Aug 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/dpvsimpledecode.c
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_edict.c

Replaced all calls to str[n]cat and strncpy by calls to strlcat and strlcpy respectively

------------------------------------------------------------------------
r6541 | havoc | 2006-08-03 08:25:42 -0700 (Thu, 03 Aug 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/glquake.h

fix memory alignment issue when saving odd-width screenshots (set GL_PACK_ALIGNMENT to 1), thanks div0

------------------------------------------------------------------------
r6540 | havoc | 2006-07-31 11:39:19 -0700 (Mon, 31 Jul 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/collision.c

more tweaks trying to improve precision on q3map2-compiled terrain models in q3bsp

------------------------------------------------------------------------
r6539 | havoc | 2006-07-31 06:57:42 -0700 (Mon, 31 Jul 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/collision.c

trying to improve terrain collision brush issues in q3bsp

------------------------------------------------------------------------
r6538 | havoc | 2006-07-31 03:00:45 -0700 (Mon, 31 Jul 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/sys_sdl.c
   M /trunk/darkplaces/vid_sdl.c

added gamepad/joystick support to the SDL client, this uses completely different cvars from the windows one, and is noticably less weird as a result :)

------------------------------------------------------------------------
r6537 | havoc | 2006-07-31 02:59:14 -0700 (Mon, 31 Jul 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/collision.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_brush.c

improved plane distance epsilon checking and improved precision when converting brush planes to polygons (by finding a roughly minimal bounding box for the plane to polygon projection), this should reduce collision brush issues on modeled terrain in q3bsp maps

------------------------------------------------------------------------
r6535 | havoc | 2006-07-26 06:57:58 -0700 (Wed, 26 Jul 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

491

------------------------------------------------------------------------
r6534 | havoc | 2006-07-26 06:51:03 -0700 (Wed, 26 Jul 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

fixed an improperly filed change request

------------------------------------------------------------------------
r6533 | havoc | 2006-07-26 06:43:53 -0700 (Wed, 26 Jul 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

495

------------------------------------------------------------------------
r6532 | black | 2006-07-26 03:35:38 -0700 (Wed, 26 Jul 2006) | 3 lines
Changed paths:
   M /trunk/darkplaces/prvm_execprogram.h

'Catch' divisions by zero in the VM:
print a warning if developer >= 1 and return 0.0 as result of the operation.

------------------------------------------------------------------------
r6531 | havoc | 2006-07-25 22:24:48 -0700 (Tue, 25 Jul 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

498

------------------------------------------------------------------------
r6530 | havoc | 2006-07-25 22:19:31 -0700 (Tue, 25 Jul 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/svvm_cmds.c

use VM_Warning instead of Con_Printf+PRVM_PrintState

------------------------------------------------------------------------
r6529 | havoc | 2006-07-25 22:16:42 -0700 (Tue, 25 Jul 2006) | 4 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/svvm_cmds.c

changed PF_WARNING to not do a return
changed PF_WARNING define to VM_Warning function
changed Con_Printf warnings in QC builtins to VM_Warning calls

------------------------------------------------------------------------
r6526 | havoc | 2006-07-25 03:38:17 -0700 (Tue, 25 Jul 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_exec.c
   M /trunk/darkplaces/prvm_execprogram.h

print out profile report above runaway loop counter error

------------------------------------------------------------------------
r6525 | havoc | 2006-07-24 23:33:48 -0700 (Mon, 24 Jul 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

enabled player scoreboard in coop (note that this overrides the intermission screen)

------------------------------------------------------------------------
r6524 | havoc | 2006-07-23 21:03:36 -0700 (Sun, 23 Jul 2006) | 3 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/darkplaces.dev
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/svvm_cmds.c

some cleanups and improved warnings
added Prydon campaign to multiplayer setup menu, fixed a bizarre crash in game episode lookup code by rewriting it

------------------------------------------------------------------------
r6523 | havoc | 2006-07-23 04:41:34 -0700 (Sun, 23 Jul 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c

Mathieu should have set the snd_* cvars properly, not poking .integer

------------------------------------------------------------------------
r6522 | havoc | 2006-07-23 04:00:35 -0700 (Sun, 23 Jul 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_win.c

disabled WAVE_FORMAT_EXTENSIBLE support as it does not seem to be working

------------------------------------------------------------------------
r6521 | havoc | 2006-07-22 03:36:47 -0700 (Sat, 22 Jul 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/image_png.c

added libpng.so fallback name, primarily for FreeBSD

------------------------------------------------------------------------
r6520 | havoc | 2006-07-21 15:55:51 -0700 (Fri, 21 Jul 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

remove testing prints (forgot to remove them before commiting)

------------------------------------------------------------------------
r6519 | havoc | 2006-07-21 03:19:31 -0700 (Fri, 21 Jul 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

fix bug with items in a trap door in the ceiling in some usermade maps that made them ride the door panels into the walls rather than fall

------------------------------------------------------------------------
r6518 | havoc | 2006-07-21 00:16:18 -0700 (Fri, 21 Jul 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_win.c

reverting DirectSound buffer position wrapping code to something similar to the old code (except using % instead of &)

------------------------------------------------------------------------
r6517 | havoc | 2006-07-19 21:29:54 -0700 (Wed, 19 Jul 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_win.c

changed SECONDARY_BUFFER_SIZE to be a multiple of 32768 so that it is roughly a power of 2...

------------------------------------------------------------------------
r6516 | havoc | 2006-07-19 02:44:04 -0700 (Wed, 19 Jul 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

471

------------------------------------------------------------------------
r6515 | havoc | 2006-07-18 21:50:45 -0700 (Tue, 18 Jul 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/wad.c
   M /trunk/darkplaces/wad.h

changed Draw_CachePic to load both tga/png/jpg and lmp/wad images at once and take the pic size from the lmp/wad, and cleaned up parts of wad and lmp loading, eliminated SwapPic

------------------------------------------------------------------------
r6514 | havoc | 2006-07-18 15:27:06 -0700 (Tue, 18 Jul 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_modules.c

don't crash if r_restart is used in startup scripts before anything starts the video system (fixed this by starting video system in r_restart if necessary)

------------------------------------------------------------------------
r6513 | havoc | 2006-07-17 16:24:30 -0700 (Mon, 17 Jul 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

enabled old quake-style connection/query packets when hosting servers for old protocols, this should allow DP to host compatible NQ servers and such

------------------------------------------------------------------------
r6512 | havoc | 2006-07-17 16:19:46 -0700 (Mon, 17 Jul 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/quakedef.h

fix a buffer overflow bug in InfoString_SetValue (thanks div0!), and increase userinfo and serverinfo strings to 1280 bytes each (from 196 and 512 respectively)

------------------------------------------------------------------------
r6511 | havoc | 2006-07-10 00:56:26 -0700 (Mon, 10 Jul 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h

added detection of 4 more surfaceparms to hush warnings

------------------------------------------------------------------------
r6510 | havoc | 2006-07-10 00:35:06 -0700 (Mon, 10 Jul 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/sbar.c

changed how ping report hiding operates, so that it only hides one ping report for each ping command issued by the scoreboard

------------------------------------------------------------------------
r6509 | havoc | 2006-07-09 23:58:17 -0700 (Sun, 09 Jul 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/sbar.c

fix bug where realtime was used instead of cl.time in player times on scoreboard

------------------------------------------------------------------------
r6508 | havoc | 2006-07-09 02:54:52 -0700 (Sun, 09 Jul 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

added bestweapon command

------------------------------------------------------------------------
r6507 | havoc | 2006-07-09 01:34:39 -0700 (Sun, 09 Jul 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/sbar.c

added ping and status command output parsing in the client, currently this is used to get pings in the scoreboard on Quake servers (and of course older DP servers), the server sends a pingplreport command after the human-readable ping report so that the packet loss display works (but only if the server supports this), changed client to send ping command instead of pings (at least until the next protocol version increase) and the client will not print ping report messages while the scoreboard is displayed.  the status command parsing is not actually used at this time but could be the basis of iplog support

------------------------------------------------------------------------
r6506 | havoc | 2006-07-09 01:28:43 -0700 (Sun, 09 Jul 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

cleaned up cl_netinputpacketspersecond code a little for more readability (no change in behavior)

------------------------------------------------------------------------
r6505 | havoc | 2006-07-08 02:34:54 -0700 (Sat, 08 Jul 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

hide ping and packetloss displays if the values are both 0 (bots and local player for instance)

------------------------------------------------------------------------
r6504 | havoc | 2006-07-08 02:24:58 -0700 (Sat, 08 Jul 2006) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/netconn.h
   M /trunk/darkplaces/sbar.c
   M /trunk/darkplaces/sv_user.c

added ping and packet loss display to scoreboard, and pings/pingplreport commands to make it work without changing protocol and without breaking demo compatibility either, this can work on any server that supports the pings command and replies with pingplreport
revised scoreboard layout and added column titles above it

------------------------------------------------------------------------
r6503 | molivier | 2006-07-08 01:59:55 -0700 (Sat, 08 Jul 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_win.c

Added 3D sound support to the Win32 backend (DirectSound and MMSYSTEM), i.e. to the WGL version

------------------------------------------------------------------------
r6502 | havoc | 2006-07-06 21:19:55 -0700 (Thu, 06 Jul 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/r_shadow.c

changed most COM_ParseToken calls to COM_ParseTokenConsole, this fixed the kills listing in the savegame menu

------------------------------------------------------------------------
r6501 | havoc | 2006-07-06 21:19:05 -0700 (Thu, 06 Jul 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c

whitespace on blank lines removed

------------------------------------------------------------------------
r6499 | havoc | 2006-07-04 00:03:18 -0700 (Tue, 04 Jul 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

fixed transfusion data check (the mainmenu item numbering starts at 1, not 0)

------------------------------------------------------------------------
r6498 | molivier | 2006-07-03 12:46:07 -0700 (Mon, 03 Jul 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/BSDmakefile
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/makefile.inc

Cleaned the ugly code I committed for DP_FS_BASEDIR support (the environment variable is now only defined when needed)

------------------------------------------------------------------------
r6496 | havoc | 2006-07-03 00:31:55 -0700 (Mon, 03 Jul 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

fix issue with DP_FS_BASEDIR on Mac

------------------------------------------------------------------------
r6495 | havoc | 2006-07-02 18:31:21 -0700 (Sun, 02 Jul 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

made nexuiz missing data fallback menu apply to all games when their main menu image is missing (the Open Console and Quit options are more useful than a bunch of checker squares)

------------------------------------------------------------------------
r6494 | havoc | 2006-07-02 17:56:42 -0700 (Sun, 02 Jul 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_shared.c

force a gamma update if v_hwgamma value changes between 1 and 2

------------------------------------------------------------------------
r6493 | havoc | 2006-07-02 17:11:03 -0700 (Sun, 02 Jul 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_shared.c

added v_hwgamma 2 (forced gamma, ignores driver returning failure) for testing

------------------------------------------------------------------------
r6492 | havoc | 2006-07-02 17:02:30 -0700 (Sun, 02 Jul 2006) | 3 lines
Changed paths:
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c

clean up of FL_ONGROUND checks in MOVE_TOSS/FLY/FLYMISSILE/BOUNCE/BOUNCEMISSILE/STEP code, this fixes items and monsters sometimes being left floating in the air after a trap door opens or when riding a func_train (most notably in the lava room of r1m5 of mission pack 2)
added sv_gameplayfix_upwardvelocityclearsongroundflag cvar to allow the upward velocity gameplay fix to be disabled if desired

------------------------------------------------------------------------
r6491 | havoc | 2006-07-02 15:50:20 -0700 (Sun, 02 Jul 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.inc

fixed DP_FS_BASEDIR passing to gcc by adding single quotes around the entire contents of the -D parameter

------------------------------------------------------------------------
r6490 | sajt | 2006-06-30 15:45:58 -0700 (Fri, 30 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

Patch from div0 to fix autosprite

------------------------------------------------------------------------
r6489 | sajt | 2006-06-28 01:30:26 -0700 (Wed, 28 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/libcurl.c

Patch from div0 to fix skyboxes in downloaded maps

------------------------------------------------------------------------
r6488 | sajt | 2006-06-28 01:11:31 -0700 (Wed, 28 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/matrixlib.c

Fixed a bug in Matrix4x4_CopyTranslateOnly... which is never called. Oh well.

------------------------------------------------------------------------
r6487 | molivier | 2006-06-25 10:42:37 -0700 (Sun, 25 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.h

Removed the extra definitions of hton[sl] and ntoh[sl] since apparently they are not necessary on any platform DP supports

------------------------------------------------------------------------
r6486 | molivier | 2006-06-25 10:35:17 -0700 (Sun, 25 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/makefile.inc

You can now set a different default base directory at compile time, by defining DP_FS_BASEDIR to the new value (ex: make DP_FS_BASEDIR=/usr/local/games/quake release)

------------------------------------------------------------------------
r6485 | molivier | 2006-06-25 10:00:07 -0700 (Sun, 25 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_alsa.c
   M /trunk/darkplaces/snd_mix.c
   M /trunk/darkplaces/snd_oss.c

Decreased the OSS buffer size, and cleaned some code

------------------------------------------------------------------------
r6484 | molivier | 2006-06-23 12:51:29 -0700 (Fri, 23 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.inc

The name of the SDL config program used by the makefiles is now configurable thanks to the SDL_CONFIG variable (ex: make SDL_CONFIG=sdl11-config sdl-release). Its default value is "sdl-config"

------------------------------------------------------------------------
r6483 | havoc | 2006-06-22 23:31:32 -0700 (Thu, 22 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_shared.c

fix gamma 'flicker' bug caused by gamma_forcenextframe being repeatedly set when gamma fails

------------------------------------------------------------------------
r6482 | havoc | 2006-06-21 22:58:02 -0700 (Wed, 21 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_shared.c

fix some stupid bugs in gamma update code (why didn't I remove the forcenextframe variable?)

------------------------------------------------------------------------
r6481 | molivier | 2006-06-20 12:38:20 -0700 (Tue, 20 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c

Made S_ChooseCheaperFormat() a bit smarter

------------------------------------------------------------------------
r6480 | molivier | 2006-06-14 23:13:08 -0700 (Wed, 14 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_ogg.c

Fixed OGG Vorbis code when using OGGs with a sound frequency smaller than the sound output frequency (the code was wrongly using the OGG sound format instead of the output sound format to compute the streaming buffer size). Thanks to Dresk for reporting this problem

------------------------------------------------------------------------
r6479 | havoc | 2006-06-14 09:22:11 -0700 (Wed, 14 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_execprogram.h

reduce runaway loop counter limit from 1 billion to 10 million, as 1 billion takes a while

------------------------------------------------------------------------
r6478 | havoc | 2006-06-14 06:48:27 -0700 (Wed, 14 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt

added a section on replacement content, and some other edits

------------------------------------------------------------------------
r6477 | havoc | 2006-06-13 09:25:55 -0700 (Tue, 13 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/lhnet.c

made FromString reject empty strings

------------------------------------------------------------------------
r6476 | havoc | 2006-06-13 06:09:23 -0700 (Tue, 13 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

changed r_gls_deluxemapping 2 to not attempt to do fake deluxemapping on vertex lit surfaces

------------------------------------------------------------------------
r6475 | havoc | 2006-06-13 02:15:36 -0700 (Tue, 13 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/BSDmakefile
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/makefile.inc

patch from div0 to make universal-binary builds of darkplaces possible on Mac OS X

------------------------------------------------------------------------
r6474 | havoc | 2006-06-12 14:25:29 -0700 (Mon, 12 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_shared.c

modified VID_RestoreSystemGamma to force a gamma update on next frame (if it turned off hardware gamma temporarily)

------------------------------------------------------------------------
r6473 | havoc | 2006-06-12 14:24:48 -0700 (Mon, 12 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c

don't set vid_activewindow to false in Map/Unmap events, just in FocusIn/FocusOut

------------------------------------------------------------------------
r6472 | havoc | 2006-06-12 13:24:27 -0700 (Mon, 12 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

check if master server address string is empty when sending heartbeats and master queries

------------------------------------------------------------------------
r6471 | havoc | 2006-06-12 05:43:47 -0700 (Mon, 12 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

updated GLSL shader to match the one in Nexuiz 2.0, this fixes reliefmapping/offsetmapping on models, and improves performance on NVIDIA by using more half-precision math

------------------------------------------------------------------------
r6470 | sajt | 2006-06-11 20:38:04 -0700 (Sun, 11 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces-dedicated.dsp
   M /trunk/darkplaces/darkplaces-sdl.dsp
   M /trunk/darkplaces/darkplaces.dsp

Added libcurl.[ch] to MSVC project files

------------------------------------------------------------------------
r6469 | havoc | 2006-06-11 16:24:18 -0700 (Sun, 11 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_lightning.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/render.h

added HDR bloom feature, not very different from bloom but looks better, runs a bit slower

------------------------------------------------------------------------
r6468 | havoc | 2006-06-11 08:35:41 -0700 (Sun, 11 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/cvar.h
   M /trunk/darkplaces/host_cmd.c

don't allow $ expansion or sendcvar on rcon_password (added CVAR_PRIVATE flag for this purpose)

------------------------------------------------------------------------
r6467 | havoc | 2006-06-11 08:35:08 -0700 (Sun, 11 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

don't draw notify lines while r_letterbox is on

------------------------------------------------------------------------
r6466 | molivier | 2006-06-11 07:13:09 -0700 (Sun, 11 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c

Fixed audio capture when the sound engine wasn't restarted right before the capture (thanks to FrikaC for reporting the bug)

------------------------------------------------------------------------
r6465 | havoc | 2006-06-11 06:50:25 -0700 (Sun, 11 Jun 2006) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/darkplaces-dedicated.dev
   M /trunk/darkplaces/darkplaces-dedicated.dsp
   M /trunk/darkplaces/darkplaces-sdl.dsp
   M /trunk/darkplaces/darkplaces.dev
   M /trunk/darkplaces/darkplaces.dsp
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/makefile.inc
   M /trunk/darkplaces/menu.c
   D /trunk/darkplaces/r_crosshairs.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/sbar.c
   M /trunk/darkplaces/screen.h

removed crosshair_static cvar (now only the hud crosshair remains)
merged r_crosshairs.c into sbar.c

------------------------------------------------------------------------
r6464 | havoc | 2006-06-11 06:23:40 -0700 (Sun, 11 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_crosshairs.c

removed team colored crosshair feature, removed crosshair brightness cvar, renamed crosshair_alpha to crosshair_color_alpha

------------------------------------------------------------------------
r6463 | havoc | 2006-06-11 06:18:01 -0700 (Sun, 11 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_crosshairs.c

removed crosshair_flashspeed and crosshair_flashrange cvars (flashing is now gone)

------------------------------------------------------------------------
r6462 | havoc | 2006-06-11 06:12:07 -0700 (Sun, 11 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c

changed the default crosshair textures to use greyscale instead of alpha fading

------------------------------------------------------------------------
r6461 | havoc | 2006-06-11 06:03:45 -0700 (Sun, 11 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_crosshairs.c

added crosshair_useteamcolor, crosshair_color_red, crosshair_color_green, and crosshair_color_blue cvars

------------------------------------------------------------------------
r6460 | havoc | 2006-06-11 05:46:07 -0700 (Sun, 11 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_user.c

fixed 'slow gravity' bug when cl_movement players are not replying to all server frames

------------------------------------------------------------------------
r6459 | molivier | 2006-06-11 02:30:59 -0700 (Sun, 11 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_sdl.c

Fixed the 5.1 speaker layout when using SDL on Win32 (thanks to Willis for the report)

------------------------------------------------------------------------
r6458 | molivier | 2006-06-10 11:22:20 -0700 (Sat, 10 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_alsa.c
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_main.h
   M /trunk/darkplaces/snd_oss.c
   M /trunk/darkplaces/snd_sdl.c

Added snd_channellayout to configure the speaker layout dynamically (0: auto, 1: standard, 2: ALSA)

------------------------------------------------------------------------
r6457 | molivier | 2006-06-10 07:23:26 -0700 (Sat, 10 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c

When we're recording a demo, we must not stop rendering sound even when the application becomes inactive

------------------------------------------------------------------------
r6456 | molivier | 2006-06-10 07:00:25 -0700 (Sat, 10 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_alsa.c
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_oss.c
   M /trunk/darkplaces/snd_sdl.c

Removed some debug printings, and made some others requiring developer >= 100. Reset the soundcard after opening in the OSS module.

------------------------------------------------------------------------
r6455 | havoc | 2006-06-10 05:19:57 -0700 (Sat, 10 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/host_cmd.c

disabled the broken cl_autodemo feature until Sajt fixes it

------------------------------------------------------------------------
r6454 | havoc | 2006-06-09 10:30:56 -0700 (Fri, 09 Jun 2006) | 3 lines
Changed paths:
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/cvar.c
   M /trunk/darkplaces/cvar.h
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/menu.c

changed cvar default setup code such that cvar default strings are locked after executing default.cfg the first time (that is to say, their current values are copied into their default strings at this point), this fixes unsaved cvar problems in nexuiz caused by the default string being out of date on cvars that were modified by default.cfg
changed Reset To Defaults option in menu to use a newly added cvar_resettodefaults_all command before execing default.cfg to reset the binds

------------------------------------------------------------------------
r6453 | havoc | 2006-06-09 06:50:50 -0700 (Fri, 09 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

trust the q3bsp NODRAW flag rather than the shader

------------------------------------------------------------------------
r6451 | havoc | 2006-06-09 02:49:36 -0700 (Fri, 09 Jun 2006) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

don't allocate a mempool or texture pool if a model file is not found (prevents buildup of 'progs/beam.mdl' memory/texture pools if it is not found)
audited 'if mod->loaded' checks to be more sure about unloading models even if they failed to load

------------------------------------------------------------------------
r6450 | havoc | 2006-06-09 00:50:42 -0700 (Fri, 09 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

fixed another C99 lazy variable declaration bug in div0's physics patch

------------------------------------------------------------------------
r6449 | havoc | 2006-06-09 00:35:41 -0700 (Fri, 09 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/libcurl.c

another curl message patch from div0

------------------------------------------------------------------------
r6448 | havoc | 2006-06-09 00:34:12 -0700 (Fri, 09 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/libcurl.c

libcurl.2.dylib is apparently compatible for our purposes and neatly adds Mac OS X Panther support

------------------------------------------------------------------------
r6447 | havoc | 2006-06-09 00:30:17 -0700 (Fri, 09 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

fix typo that caused crashes in detection of model animation in models with only one frame

------------------------------------------------------------------------
r6446 | havoc | 2006-06-09 00:04:40 -0700 (Fri, 09 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/libcurl.c

another patch from div0 to curl messages

------------------------------------------------------------------------
r6445 | havoc | 2006-06-08 23:50:19 -0700 (Thu, 08 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/libcurl.c

fix for continuously spewed curl error messages

------------------------------------------------------------------------
r6444 | havoc | 2006-06-08 22:28:07 -0700 (Thu, 08 Jun 2006) | 2 lines
Changed paths:
   A /trunk/darkplaces/libcurl.c
   A /trunk/darkplaces/libcurl.h

oops, forgot these

------------------------------------------------------------------------
r6443 | havoc | 2006-06-08 19:03:34 -0700 (Thu, 08 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/makefile.inc
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/sv_main.c

web download patch from div0, this adds the "curl" console command, and the ability for servers to send a set of conditional curl commands which will download pk3 archives if specific files are missing

------------------------------------------------------------------------
r6442 | havoc | 2006-06-08 18:56:11 -0700 (Thu, 08 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

nexuiz prediction patch from div0, this adds two new cl_movement_airaccel_* cvars which change air control physics

------------------------------------------------------------------------
r6441 | molivier | 2006-06-08 14:39:20 -0700 (Thu, 08 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_bsd.c

The BSD audio module had the same bug as the OSS module (incorrectly reporting "audio can't keep up")

------------------------------------------------------------------------
r6440 | havoc | 2006-06-08 05:35:10 -0700 (Thu, 08 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c

fixed r_drawportals

------------------------------------------------------------------------
r6439 | havoc | 2006-06-08 04:16:52 -0700 (Thu, 08 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/collision.c
   M /trunk/darkplaces/collision.h
   M /trunk/darkplaces/model_brush.c

fixed collision bug on q3 light cones and other non-solid brushes that are not axial, now uses only the brush's supercontents value, not its surface textures

------------------------------------------------------------------------
r6438 | havoc | 2006-06-08 04:00:21 -0700 (Thu, 08 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_alias.h
   M /trunk/darkplaces/model_shared.h

no longer converts vertex-morph model formats to float arrays, instead keeping their geometry in the original formats from disk, this saves 1.2MB of memory in e1m2 and might slightly improve load times, it also preserves vertex normals to get rid of shading artifacts on texcoord seams

------------------------------------------------------------------------
r6437 | havoc | 2006-06-08 03:57:55 -0700 (Thu, 08 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/image.c

added more image search paths so that md2 model skins load properly again, and to reduce problems for tenebrae model packs

------------------------------------------------------------------------
r6435 | havoc | 2006-06-07 01:49:56 -0700 (Wed, 07 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

don't crash if a quake button entity is on its alternate frames but doesn't actually have any to show

------------------------------------------------------------------------
r6434 | havoc | 2006-06-07 01:33:57 -0700 (Wed, 07 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/keys.c

don't crash if key bindings functions are called with bogus keynums

------------------------------------------------------------------------
r6433 | havoc | 2006-06-07 01:33:21 -0700 (Wed, 07 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_light.c

fix a < 256 check that should have been < MAX_LIGHTSTYLES

------------------------------------------------------------------------
r6432 | havoc | 2006-06-06 23:34:11 -0700 (Tue, 06 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_shared.c

ignore GL_EXT_texture3D extension if it reports a bogus GL_MAX_3D_TEXTURE_SIZE

------------------------------------------------------------------------
r6431 | havoc | 2006-06-06 23:30:49 -0700 (Tue, 06 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

extra check for gl_texture3d

------------------------------------------------------------------------
r6430 | havoc | 2006-06-06 23:28:30 -0700 (Tue, 06 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/image.c

fix typo

------------------------------------------------------------------------
r6429 | havoc | 2006-06-06 23:20:18 -0700 (Tue, 06 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fix maps/ check to use 5 characters, not 4

------------------------------------------------------------------------
r6428 | havoc | 2006-06-06 23:19:54 -0700 (Tue, 06 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/image.c

prevent Image_MipReduce from getting stuck in an infinite loop on 3D textures

------------------------------------------------------------------------
r6427 | havoc | 2006-06-06 23:03:29 -0700 (Tue, 06 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

added stack trace printout to VM_remove warnings

------------------------------------------------------------------------
r6426 | havoc | 2006-06-06 23:02:59 -0700 (Tue, 06 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cvar.c

don't save cvars that are at their default value

------------------------------------------------------------------------
r6425 | havoc | 2006-06-06 23:02:37 -0700 (Tue, 06 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

fixed an unregistered cvar

------------------------------------------------------------------------
r6424 | havoc | 2006-06-06 21:52:25 -0700 (Tue, 06 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/csprogs.c

disabled loading of csprogs.dat if developer is less than 100

------------------------------------------------------------------------
r6423 | havoc | 2006-06-06 21:11:45 -0700 (Tue, 06 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/svvm_cmds.c

added DP_GFX_EXTERNALTEXTURES_PERMAP extension

------------------------------------------------------------------------
r6422 | havoc | 2006-06-06 04:12:52 -0700 (Tue, 06 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c

commented out S_StartSound <whatever> not precached message because it happens constantly if the file could not be found

------------------------------------------------------------------------
r6421 | molivier | 2006-06-05 23:21:47 -0700 (Mon, 05 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_alsa.c
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_main.h
   M /trunk/darkplaces/snd_mix.c
   M /trunk/darkplaces/snd_oss.c
   M /trunk/darkplaces/snd_sdl.c

Attempt to fix speaker layout for 5.1 and 7.1 sound, on Windows and Mac OS X; the sound engine now builds its speaker layout based on the OS and the snd_swapstereo cvar. Plus a minor fix for the OSS sound module (was incorrectly reporting "audio can't keep up")

------------------------------------------------------------------------
r6420 | molivier | 2006-06-05 23:14:34 -0700 (Mon, 05 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

Use our usual defines for detecting the OS type

------------------------------------------------------------------------
r6416 | molivier | 2006-06-04 15:58:52 -0700 (Sun, 04 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c

Fixed the "nosound" cvar. Thanks to Willis for having reported this bug

------------------------------------------------------------------------
r6415 | molivier | 2006-06-04 03:57:24 -0700 (Sun, 04 Jun 2006) | 25 lines
Changed paths:
   M /trunk/darkplaces/BSDmakefile
   M /trunk/darkplaces/mathlib.c
   M /trunk/darkplaces/mathlib.h
   M /trunk/darkplaces/snd_alsa.c
   M /trunk/darkplaces/snd_bsd.c
   M /trunk/darkplaces/snd_coreaudio.c
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_main.h
   M /trunk/darkplaces/snd_mem.c
   M /trunk/darkplaces/snd_mix.c
   M /trunk/darkplaces/snd_null.c
   M /trunk/darkplaces/snd_ogg.c
   M /trunk/darkplaces/snd_ogg.h
   M /trunk/darkplaces/snd_oss.c
   M /trunk/darkplaces/snd_sdl.c
   M /trunk/darkplaces/snd_wav.c
   M /trunk/darkplaces/snd_wav.h
   M /trunk/darkplaces/snd_win.c
   M /trunk/darkplaces/sound.h
   M /trunk/darkplaces/sys_win.c
   M /trunk/darkplaces/vid_agl.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_wgl.c

- the Linux sound modules (ALSA and OSS) are now write-based, instead of
mmap-based. It should fix the problems with inboard sound cards
- added 3 cvars controlling the sound output format: snd_speed,
snd_channels, and snd_width (default values: 48000, 2, and 2
respectively). They're saved in the config file.
- the checks for command line options and environment variables
modifying the sound output format are now common to all modules. The
command line options supported are: -sndmono, -sndstereo, -sndquad,
-sndspeed, and -sndbits. The environment variables supported are:
QUAKE_SOUND_CHANNELS, QUAKE_SOUND_SPEED, and QUAKE_SOUND_SAMPLEBITS.
- added a (still dumb) function to figure out a better sound format when
the initialization of the sound card failed
- sound modules can now suggest a sound format if the initialization of
the sound card failed
- you can now do a "snd_restart" while having modified snd_width and/or
snd_channel. Doing a snd_restart with a modified snd_speed isn't yet
supported, it will fall back to the previous speed
- The WGL video module was blocking the sound output when the
application window lost the focus. Now, this code is shared and the AGL,
GLX and SDL video modules implement such a mecanism
- A lot of minor fixes, changes, factorizations and rewrites all over
the sound engine code and its modules
- added CeilPowerOf2() in the math library
- fixed BSDmakefile for NetBSD

------------------------------------------------------------------------
r6414 | havoc | 2006-06-04 00:29:19 -0700 (Sun, 04 Jun 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/view.c

cl_bobmodel is now a saved cvar

------------------------------------------------------------------------
r6410 | havoc | 2006-05-31 23:59:30 -0700 (Wed, 31 May 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/client.h

removed TE_VORESPIKE, no idea how it came into existence and it was never used

------------------------------------------------------------------------
r6409 | havoc | 2006-05-30 13:53:57 -0700 (Tue, 30 May 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c

don't allow runaway loops caused by Con_Print during notify/console drawing

------------------------------------------------------------------------
r6408 | havoc | 2006-05-30 03:42:21 -0700 (Tue, 30 May 2006) | 6 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/snd_main.c

fixed several crashes in video capture code when files fail to open
eliminated cl_capturevideo_sound cvar (now always on)
made sound capture non-realtime, by syncing sound mixer to capture frame while capture is active, this sounds horrible while recording but produces perfectly synced sound output to the .wav file
now numbers dpvideo files when saving, each one a higher number than the previous (the next number to use is saved to config), this allows capturing many short video clips without stopping to process the files
what this means: cl_capturevideo is now much more useful than before.

------------------------------------------------------------------------
r6407 | havoc | 2006-05-30 03:37:19 -0700 (Tue, 30 May 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c

fix unintended use of alpha test on 2d graphics (hud/menu/etc)

------------------------------------------------------------------------
r6406 | molivier | 2006-05-29 04:59:46 -0700 (Mon, 29 May 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces-dedicated.dev
   M /trunk/darkplaces/darkplaces.dev

Updated Dev-C++ project files

------------------------------------------------------------------------
r6405 | havoc | 2006-05-28 22:54:07 -0700 (Sun, 28 May 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

changed color control menu correction value to 0.5 (medium grey on linear color monitors)

------------------------------------------------------------------------
r6404 | havoc | 2006-05-28 22:51:24 -0700 (Sun, 28 May 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_shared.c

fixed repeated gamma ramp setting attempts in case of failure (again)

------------------------------------------------------------------------
r6403 | havoc | 2006-05-28 14:19:45 -0700 (Sun, 28 May 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_shared.c

fix bug that caused constant gamma ramp setting in windows in cases of failure

------------------------------------------------------------------------
r6402 | havoc | 2006-05-28 13:43:18 -0700 (Sun, 28 May 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

disable canjump check until it's fixed

------------------------------------------------------------------------
r6401 | havoc | 2006-05-28 12:38:41 -0700 (Sun, 28 May 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sv_user.c

further tweaks to prediction

------------------------------------------------------------------------
r6400 | havoc | 2006-05-28 12:36:23 -0700 (Sun, 28 May 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

fix a bug where dedicated servers might not respond to typing in the server console if no map is currently running (which is rare)

------------------------------------------------------------------------
r6399 | havoc | 2006-05-28 00:27:18 -0700 (Sun, 28 May 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

added a few more GLSL shader program setting calls in R_RenderScene just to prevent problems if a model/map rendering call leaves a GLSL program active

------------------------------------------------------------------------
r6398 | havoc | 2006-05-27 18:26:06 -0700 (Sat, 27 May 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_user.c
   M /trunk/darkplaces/todo

added sv_clmovement_* cvars to disable movement prediction of players, or disable it only when their ping is below a certain value (by default 100ms)

------------------------------------------------------------------------
r6397 | havoc | 2006-05-27 17:23:59 -0700 (Sat, 27 May 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

no longer sets model->loaded if the model file was not found, since the old Mod_CheckLoaded code is long gone

------------------------------------------------------------------------
r6396 | havoc | 2006-05-27 13:12:03 -0700 (Sat, 27 May 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c

remove an unused variable

------------------------------------------------------------------------
r6395 | havoc | 2006-05-27 13:07:34 -0700 (Sat, 27 May 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c

centering of notify lines in nexuiz now ignores color codes

------------------------------------------------------------------------
r6394 | havoc | 2006-05-27 12:58:53 -0700 (Sat, 27 May 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

centerprint no longer counts color codes when centering lines

------------------------------------------------------------------------
r6393 | havoc | 2006-05-25 20:09:02 -0700 (Thu, 25 May 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/image_png.c

don't hexdump png images while reading them (why did it do this??)

------------------------------------------------------------------------
r6392 | havoc | 2006-05-25 18:04:39 -0700 (Thu, 25 May 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

fix bug that was preventing rcon_address from working

------------------------------------------------------------------------
r6391 | havoc | 2006-05-25 18:00:09 -0700 (Thu, 25 May 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sv_user.c

implemented sv_gameplayfix_qwplayerphysics

------------------------------------------------------------------------
r6390 | havoc | 2006-05-25 16:46:11 -0700 (Thu, 25 May 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix a typo

------------------------------------------------------------------------
r6389 | havoc | 2006-05-25 16:28:03 -0700 (Thu, 25 May 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_user.c

try not to kick players for supposed speed cheating when float time degrades too much

------------------------------------------------------------------------
r6388 | havoc | 2006-05-25 16:27:24 -0700 (Thu, 25 May 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_user.c

fixed sv_waterfriction code so it is now used

------------------------------------------------------------------------
r6387 | havoc | 2006-05-25 16:22:06 -0700 (Thu, 25 May 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sv_user.c

added sv_waterfriction, sv_airaccelerate, sv_wateraccelerate cvars (and corresponding cl_movement_ cvars), now physics are about as configurable as quakeworld

------------------------------------------------------------------------
r6386 | havoc | 2006-05-25 00:48:33 -0700 (Thu, 25 May 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/fs.h

patch from div0 that allows loading new pak/pk3 archives while running

------------------------------------------------------------------------
r6385 | havoc | 2006-05-25 00:41:38 -0700 (Thu, 25 May 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

patch from div0 that makes togglemenu support a parameter (either 1 or 0) to not toggle but instead set the menu on or off

------------------------------------------------------------------------
r6384 | havoc | 2006-05-25 00:39:44 -0700 (Thu, 25 May 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/filematch.c

changed matchpattern to take a const char *

------------------------------------------------------------------------
r6380 | havoc | 2006-05-24 21:12:05 -0700 (Wed, 24 May 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/r_lightning.c
   M /trunk/darkplaces/todo

replaced cl_beams_relative cvar with cl_beams_quakepositionhack and cl_beams_instantaimhack and rewrote the relevant code, it now works like quake (except with instant aiming in the case of the instantaimhack) and applies only to your player

------------------------------------------------------------------------
r6379 | havoc | 2006-05-24 20:57:50 -0700 (Wed, 24 May 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_comp.h
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/prvm_exec.c

changed qc profiling to use doubles instead of ints for profile counters, so it can now count beyond 4 billion

------------------------------------------------------------------------
r6378 | havoc | 2006-05-24 20:54:31 -0700 (Wed, 24 May 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_execprogram.h

increased runaway jump count limit to 1000000000

------------------------------------------------------------------------
r6377 | havoc | 2006-05-24 20:49:59 -0700 (Wed, 24 May 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

calculate bounding box properly for psk models, and a cleanup of bounding box generation code for mdl/md2/md3 models

------------------------------------------------------------------------
r6376 | havoc | 2006-05-24 20:46:21 -0700 (Wed, 24 May 2006) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/protocol.c

fixed crashes when changing a few settings while playing a demo
fixed repeated jumping bug in cl_movement code
fixed crashes that would occur if playing a QW demo (not yet supported)

------------------------------------------------------------------------
r6375 | havoc | 2006-05-24 20:43:58 -0700 (Wed, 24 May 2006) | 3 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

fix crash when entering "color" command while playing a demo
fixed values printed by bottomcolor/topcolor commands (so bottomcolor no longer reports the whole color like color does, instead just the pants color)

------------------------------------------------------------------------
r6374 | havoc | 2006-05-24 20:41:51 -0700 (Wed, 24 May 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_demo.c

fix playback of demos after playing on a quakeworld server

------------------------------------------------------------------------
r6373 | havoc | 2006-05-24 20:41:01 -0700 (Wed, 24 May 2006) | 3 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

display qw spectators as spectators on the scoreboard
fix a crash if holding showscores while playing a demo

------------------------------------------------------------------------
r6372 | havoc | 2006-05-23 15:54:30 -0700 (Tue, 23 May 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/vid_sdl.c

remove some r_render checks, and added an r_render check to vid_sdl.c VID_Finish

------------------------------------------------------------------------
r6370 | havoc | 2006-05-17 01:18:06 -0700 (Wed, 17 May 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

471

------------------------------------------------------------------------
r6369 | havoc | 2006-05-14 19:40:36 -0700 (Sun, 14 May 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cmd.c

patch from Dresk that adds a doom3-like "toggle" console command

------------------------------------------------------------------------
r6368 | havoc | 2006-05-12 01:11:46 -0700 (Fri, 12 May 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/meshqueue.c
   M /trunk/darkplaces/meshqueue.h
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/r_crosshairs.c
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_lightning.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/r_sprites.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/view.c

reorganized a lot of renderer variables into r_refdef, and split some things out of r_refdef into r_view and r_viewcache, this reorganization brings DP closer to being able to render to textures

------------------------------------------------------------------------
r6367 | havoc | 2006-05-12 00:33:09 -0700 (Fri, 12 May 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

undo something not meant to be committed yet

------------------------------------------------------------------------
r6366 | havoc | 2006-05-12 00:06:22 -0700 (Fri, 12 May 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

fix two implicit conversions

------------------------------------------------------------------------
r6365 | havoc | 2006-05-12 00:05:32 -0700 (Fri, 12 May 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

fix s->waterlevel = 0 and such

------------------------------------------------------------------------
r6364 | havoc | 2006-05-11 02:20:29 -0700 (Thu, 11 May 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

removed the clearing of the root bone in .psa animations, to fix bugs (sorry, this was experimental and apparently broken)

------------------------------------------------------------------------
r6363 | havoc | 2006-05-11 02:03:10 -0700 (Thu, 11 May 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

fix a warning

------------------------------------------------------------------------
r6362 | havoc | 2006-05-10 04:52:21 -0700 (Wed, 10 May 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/todo

redesigned skeletal model loading and rendering to use matrix-palette animation (still in software, but that may change at some point), this improved nexuiz -benchmark demos/demo1 framerates by 11.3%

------------------------------------------------------------------------
r6361 | havoc | 2006-05-10 04:16:44 -0700 (Wed, 10 May 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/mathlib.h

added Vector4Set macro

------------------------------------------------------------------------
r6360 | havoc | 2006-05-10 03:14:26 -0700 (Wed, 10 May 2006) | 4 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

some clean up of packet parsing
merged most of the server info parsing code between the two cases (DP server and QW server), and reimplemented server info parsing for NQ servers
enabled ping/ack packet processing

------------------------------------------------------------------------
r6359 | havoc | 2006-05-10 01:26:44 -0700 (Wed, 10 May 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

setinfo *ip on every network connection (currently only meaningful to QW reconnect command, but potentially useful), and removed some unneeded setinfo's since the cvars/commands now work properly

------------------------------------------------------------------------
r6358 | havoc | 2006-05-10 01:24:54 -0700 (Wed, 10 May 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/cvar.c
   M /trunk/darkplaces/host_cmd.c

improved setinfo handling so that quakeworld works much better now (name/topcolor/bottomcolor/skin/team/noaim are handled properly now), this means TeamFortress won't kick clients for not responding to team/skin cvars, and is fully playable

------------------------------------------------------------------------
r6357 | havoc | 2006-05-10 01:02:45 -0700 (Wed, 10 May 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/world.c
   M /trunk/darkplaces/world_cs.c

removed all 3 uses of the brown-text message prefix in the server

------------------------------------------------------------------------
r6356 | havoc | 2006-05-10 00:59:45 -0700 (Wed, 10 May 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/csprogs.c

added a comment

------------------------------------------------------------------------
r6355 | havoc | 2006-05-09 23:02:04 -0700 (Tue, 09 May 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c

cleanup of chat prefix character handling, this fixes a bug that was removing quake's brown characters at the beginning of a line

------------------------------------------------------------------------
r6354 | havoc | 2006-05-09 08:26:00 -0700 (Tue, 09 May 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h

significantly reworked the cl_movement code, now predicts quakeworld almost completely correctly (only some issues with the different nature of stair stepping, and other differences compared to the FlyMove function on the servers which affect sliding in grooves)

------------------------------------------------------------------------
r6353 | havoc | 2006-05-09 08:22:46 -0700 (Tue, 09 May 2006) | 3 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

don't shuffle servers around when pings come in later and are identical to the existing ones (I.E. made the sort be a stable sort)
fixed a bug that caused qwmaster query packets to be bigger than necessary (was writing 7 bytes, should have been 3 bytes)

------------------------------------------------------------------------
r6352 | havoc | 2006-05-09 08:18:50 -0700 (Tue, 09 May 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

do q1bsp lighting checks starting with + 0.125 unit Z offset to improve chances of finding a lighting value rather than returning black when a model origin is almost stuck in the floor

------------------------------------------------------------------------
r6351 | havoc | 2006-05-08 16:39:56 -0700 (Mon, 08 May 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_shared.h

split R_DrawTextureSurfaceList code into several functions and added separate multitexture-combine/singletexture paths

------------------------------------------------------------------------
r6350 | havoc | 2006-05-08 03:35:32 -0700 (Mon, 08 May 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/lhnet.c

fix NUL termination issue on the test string by not actually printing the packet

------------------------------------------------------------------------
r6349 | havoc | 2006-05-08 03:33:02 -0700 (Mon, 08 May 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/lhnet.c

fixes to the test program

------------------------------------------------------------------------
r6348 | havoc | 2006-05-08 03:22:10 -0700 (Mon, 08 May 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/lhnet.c

lhnet fixes - now calls WSAStartup during LHNET_Init and WSAShutdown during LHNET_Shutdown, so gethostbyname will work on windows without any sockets open (as long as LHNET_Init has been called of course), fixed a few things that were breaking compilation with -DSTANDALONETEST and added a new simpler and more useful standalone test program which is now used by default (edit the #if if you want the old one instead)

------------------------------------------------------------------------
r6347 | havoc | 2006-05-07 22:21:14 -0700 (Sun, 07 May 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

fix really stupid bug in qw download code which was saving the same file repeatedly (it wasn't resetting the buffer position on each new download)

------------------------------------------------------------------------
r6345 | havoc | 2006-05-01 05:30:03 -0700 (Mon, 01 May 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix bug with gl_combine 0 transparent water rendering in q1bsp (alpha was not being stored, leaving garbage (typically 0) in the vertex alpha, making the water disappear)

------------------------------------------------------------------------
r6344 | havoc | 2006-05-01 05:14:02 -0700 (Mon, 01 May 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c

fix a type (description as part of value on r_textshadow)

------------------------------------------------------------------------
r6343 | havoc | 2006-05-01 05:05:34 -0700 (Mon, 01 May 2006) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h
   M /trunk/darkplaces/render.h

optimized rtlighting passes by using RSurf_DrawBatch_Simple, this took a lot of code restructuring but the resulting code is definitely a lot faster
fixed bugs in RSurf_DrawBatch_Lightmap related changes

------------------------------------------------------------------------
r6342 | havoc | 2006-05-01 02:00:22 -0700 (Mon, 01 May 2006) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

restructured RSurf_DrawLightmap to become RSurf_DrawBatch_Lightmap which processes all arrays and sets things up perfectly, then renders all the surfaces with a call to R_DrawBatch_Simple
added dynamic surface-merging to R_DrawBatch_Simple, depending on the new r_batchmode cvar it either renders surfaces individually (as before), consecutively (consecutively numbered surfaces are rendered with one call for their combined triangle elements range), or by memcpy merging elements into one array (this has rather chaotic vertex ranges so gl_lockarrays is disabled in this code because it is a consistent speed loss in this case)
this optimization increased fps by 4.7% in timedemo bigass1, and offers bigger gains in very high poly q1bsp and q3bsp maps

------------------------------------------------------------------------
r6341 | havoc | 2006-04-29 20:42:04 -0700 (Sat, 29 Apr 2006) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/view.c

changed svc_setangle to cause interpolated turning when spectating (two or more consecutive frames with a svc_setangle message), and instant entity updates when teleporting (just one svc_setangle) so you no longer fly through the level when teleporting
changed cl_beams_relative to only apply to the local player (unless set to a value of 2 or higher)

------------------------------------------------------------------------
r6340 | havoc | 2006-04-27 18:21:54 -0700 (Thu, 27 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_sdl.c

treat AltGr key as ALT for bind purposes

------------------------------------------------------------------------
r6339 | black | 2006-04-27 13:23:42 -0700 (Thu, 27 Apr 2006) | 6 lines
Changed paths:
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/cl_video.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/keys.c

Add _DrawQ_ProcessDrawFlag to clean-up the glblend setup code.
Add CL_Video_KeyEvent and support for it to Key_Event, now the the fullscreen video
is closed automatically when you hit enter, space or escape and the video system catches all
input (no more accidentially nagivating around in the menu).
(Please test this and report bugs to black@icculus.org if you find any)

------------------------------------------------------------------------
r6338 | havoc | 2006-04-26 19:54:45 -0700 (Wed, 26 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fixed fullbright support in glsl path

------------------------------------------------------------------------
r6337 | sajt | 2006-04-26 17:58:09 -0700 (Wed, 26 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

Removed myself from all the todo items. I no longer mind if none of these are ever implemented/fixed, and I check the cvs often enough that I'll see if they ever are. Feel free to remove any of these altogether, e.g. mirrors, hub save, skyrooms...

------------------------------------------------------------------------
r6336 | sajt | 2006-04-26 17:49:46 -0700 (Wed, 26 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r6335 | havoc | 2006-04-26 07:34:29 -0700 (Wed, 26 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

added proper liquidfriction support

------------------------------------------------------------------------
r6334 | havoc | 2006-04-26 07:22:55 -0700 (Wed, 26 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/client.h

optimized handling of decals, which increased timedemo bigass1.dem from 185fps to 191fps, also partially implemented airfriction and liquidfriction

------------------------------------------------------------------------
r6333 | havoc | 2006-04-26 06:12:43 -0700 (Wed, 26 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

a simple optimization to particle allocation, increased bigass1.dem performance from 184fps to 185fps

------------------------------------------------------------------------
r6332 | havoc | 2006-04-26 05:57:21 -0700 (Wed, 26 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/meshqueue.c
   M /trunk/darkplaces/meshqueue.h
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_lightning.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_sprites.c

now does batching of transparent surfaces, such as particles, this raised performance in bigass1.dem from 143fps to 184fps (it uses a lot of particles)

------------------------------------------------------------------------
r6331 | havoc | 2006-04-26 03:20:45 -0700 (Wed, 26 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/todo
   M /trunk/darkplaces/vid_agl.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c

added a lot more CHECKGLERROR macro calls, to identify precisely where any error occurs

------------------------------------------------------------------------
r6330 | havoc | 2006-04-26 02:09:19 -0700 (Wed, 26 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

changed back to 1 second intervals on fps math

------------------------------------------------------------------------
r6329 | havoc | 2006-04-26 02:08:55 -0700 (Wed, 26 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cvar.c

changed the Cvar_Command: prints to developer.integer >= 100

------------------------------------------------------------------------
r6328 | havoc | 2006-04-25 06:21:24 -0700 (Tue, 25 Apr 2006) | 3 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

reenabled support of find() with an empty string as the search value, this fixes the Blood Mage monster movement
slight optimization to findflags and findchainflags

------------------------------------------------------------------------
r6327 | havoc | 2006-04-25 06:20:05 -0700 (Tue, 25 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/prvm_exec.c
   M /trunk/darkplaces/prvm_execprogram.h

added prvm_printfunction command which prints an assembly dump of the specified qc function, with coloring and optionally statement profiling to show how many times each statement has been executed (prvm_statementprofiling must be on for this), also heavily modified statement printing to be more readable

------------------------------------------------------------------------
r6326 | havoc | 2006-04-24 23:14:44 -0700 (Mon, 24 Apr 2006) | 3 lines
Changed paths:
   M /trunk/darkplaces/prvm_exec.c
   M /trunk/darkplaces/prvm_execprogram.h

significant optimizations to the progs interpreter, changed the runaway loop counter to only count jump instructions (if/ifnot/goto), and redesigned the profile counting to use pointer math on batches of instructions instead of counting each instruction individually
changed prvm_profile report to show callcount before statements and builtincost, changed the sorting order to use summed callcount+statements+builtincost (and this made it print call counts for builtin functions as well)

------------------------------------------------------------------------
r6325 | havoc | 2006-04-24 17:34:02 -0700 (Mon, 24 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

reenabled the 'stick in place if stuck in a solid' code, but changed it to only apply for bmodelstartsolid, this prevents monsters from falling out of the level even if they're stuck in a wall, for consistency with stock quake

------------------------------------------------------------------------
r6324 | havoc | 2006-04-20 16:55:54 -0700 (Thu, 20 Apr 2006) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_particles.c

changed particle trail handling so that the TE_TEI_G3 effect can spawn particles along the beam just like trails can
cleaned up particle texture generation, no longer generates them if loading from disk, now also allows all 64 slots to be used (except the beam one) by generating generic texcoords for all of them

------------------------------------------------------------------------
r6323 | havoc | 2006-04-20 16:54:12 -0700 (Thu, 20 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/menu.h

added keyup function for menu qc at Black's request

------------------------------------------------------------------------
r6322 | havoc | 2006-04-20 08:52:12 -0700 (Thu, 20 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/client.h

replaced rainsplash animation with just a single particle which expands over time to free up significant space in the particlefont (also added sizeincrease parameter support to effectinfo.txt accordingly)

------------------------------------------------------------------------
r6321 | havoc | 2006-04-20 08:48:55 -0700 (Thu, 20 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

don't complain about shaders with no layers

------------------------------------------------------------------------
r6320 | havoc | 2006-04-20 03:55:47 -0700 (Thu, 20 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_agl.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_wgl.c

grab mouse when using menu while watching demos (important for nexuiz)

------------------------------------------------------------------------
r6319 | havoc | 2006-04-20 03:55:00 -0700 (Thu, 20 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix some model lighting bugs in the GLSL surface renderer related to stale lightmaps still being bound

------------------------------------------------------------------------
r6318 | havoc | 2006-04-20 02:17:21 -0700 (Thu, 20 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

allow changelevel to stop demos (necessary for nexuiz menu)

------------------------------------------------------------------------
r6317 | havoc | 2006-04-20 02:12:59 -0700 (Thu, 20 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/todo

fix missing newline on unknown opcode warning in progs loader

------------------------------------------------------------------------
r6316 | havoc | 2006-04-20 00:57:38 -0700 (Thu, 20 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/cl_screen.h
   M /trunk/darkplaces/menu.c

renamed scr_screenshot_gamma to scr_screenshot_gammaboost and changed default to 1, this means all screenshots will be unmodified unless the user specifically changes the setting, rather than saving them very bright by default

------------------------------------------------------------------------
r6315 | havoc | 2006-04-20 00:46:09 -0700 (Thu, 20 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/image.c

optimized LoadTGA to have fast paths for all formats, rather than one unified loading loop that tried to support all formats, this saves 1.15 seconds of load time in nexuiz on my machine (before: 2.32 seconds spent in LoadTGA, after: 1.17 seconds)

------------------------------------------------------------------------
r6314 | havoc | 2006-04-19 20:43:20 -0700 (Wed, 19 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h
   M /trunk/darkplaces/render.h

significant surface renderer optimizations

------------------------------------------------------------------------
r6313 | havoc | 2006-04-19 18:47:26 -0700 (Wed, 19 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h

added GL_AlphaTest function to enable/disable GL_ALPHA_TEST

------------------------------------------------------------------------
r6312 | havoc | 2006-04-19 06:33:05 -0700 (Wed, 19 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

precache scoreboard title, intermission pics, and finale pic

------------------------------------------------------------------------
r6311 | havoc | 2006-04-19 00:04:05 -0700 (Wed, 19 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

removed the flawed detection of modelspace deluxemaps (it was always concluding they were modelspace because of unused black pixels and such), now assumes q3bsp deluxemaps are always modelspace

------------------------------------------------------------------------
r6310 | havoc | 2006-04-18 04:24:19 -0700 (Tue, 18 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

another attempt to fix the warnings

------------------------------------------------------------------------
r6309 | havoc | 2006-04-18 04:19:02 -0700 (Tue, 18 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

attempting to fix a warning about setjmp clobbering variables

------------------------------------------------------------------------
r6308 | havoc | 2006-04-18 04:10:10 -0700 (Tue, 18 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix a bug in AUTOSPRITE2 code caused by overzealous optimization, thanks to Elric for reporting this

------------------------------------------------------------------------
r6307 | havoc | 2006-04-18 03:44:11 -0700 (Tue, 18 Apr 2006) | 5 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_shadow.c

reworked most of q3bsp q3 shader loading, now supports more shader effects (the first layer's blendfunc is now used for rendering), still no multilayer stuff though, and still no tcgen environment so some surfaces now look worse because their first pass is an environment effect, but most others look better...
q3 fog shaders are usually invisible now (looks better than blinding white surfaces)
added support for more hacky q3 shaders (like sky shaders that don't have surfaceparm sky, and transparent shaders that don't have surfaceparm trans)
added support for alpha test in q3 shaders (improves some shaders)

------------------------------------------------------------------------
r6306 | havoc | 2006-04-18 03:37:43 -0700 (Tue, 18 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/glquake.h

reset a bit more state each frame

------------------------------------------------------------------------
r6305 | havoc | 2006-04-17 23:28:17 -0700 (Mon, 17 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/screen.h

conback lives...  again!

------------------------------------------------------------------------
r6304 | havoc | 2006-04-17 23:19:10 -0700 (Mon, 17 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

removed showfps mode 2 (which was weird), modified showfps 1 to use 0.1 second polling intervals so it updates much more often

------------------------------------------------------------------------
r6303 | havoc | 2006-04-17 23:16:13 -0700 (Mon, 17 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/screen.h

conback support is dead.

------------------------------------------------------------------------
r6301 | havoc | 2006-04-17 23:03:37 -0700 (Mon, 17 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/screen.h

removed scr_conspeed, now always instantaneous console opening/closing

------------------------------------------------------------------------
r6300 | havoc | 2006-04-17 22:49:22 -0700 (Mon, 17 Apr 2006) | 8 lines
Changed paths:
   M /trunk/darkplaces/cl_demo.c
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sys_linux.c
   M /trunk/darkplaces/sys_sdl.c
   M /trunk/darkplaces/sys_win.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c
   M /trunk/darkplaces/view.c

rewrote timing code, now a much better and very different sleeping method, no longer wastes any cpu time
changed timing code to have independent sleeping for client and server frames in a listen server
changed console execution to occur in sync with server frames if a server is running, this fixes frikbot loading of .way files
eliminated several host_* variables, replaced host_realframetime with cl.realframetime (which is how long since the last client frame)
removed the clamping of sys_ticrate to >= 0.1, so now sys_ticrate 0 is allowed (run as fast as possible), as well as silly values like 0.001
removed serverprofile cvar as it was not easy to preserve it in the rewritten timing
merged Host_FilterTime, Host_ServerFrame, Host_Frame, _Host_Frame into Host_Main (which also calls Host_Init), this eliminates some duplicate code in all the sys_ modules

------------------------------------------------------------------------
r6299 | havoc | 2006-04-16 18:58:32 -0700 (Sun, 16 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/render.h

batch by lightmap as well as texture, this cures problems with vertex lit surfaces in deluxemapped q3bsp files (the vertex lit surfaces can't be deluxemapped)

------------------------------------------------------------------------
r6298 | havoc | 2006-04-16 04:38:37 -0700 (Sun, 16 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/todo

no longer recalculated q3bsp surface normals, this makes q3map2 'phong shading' features work, no more seams on terrain and such

------------------------------------------------------------------------
r6297 | havoc | 2006-04-16 04:37:07 -0700 (Sun, 16 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

fix crash when loading .dpm models

------------------------------------------------------------------------
r6296 | havoc | 2006-04-16 04:36:20 -0700 (Sun, 16 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

changed where vertex coloring is applied in the fragment shader, this fixes problems with vertex colored surfaces (note: does not help deluxemapping mode, there is another bug affecting that)

------------------------------------------------------------------------
r6295 | havoc | 2006-04-16 03:19:05 -0700 (Sun, 16 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h

modified Mod_BuildTextureVectorsAndNormals to become Mod_BuildTextureVectorsFromNormals, this is in preparation for properly honoring the surface normals in models and maps (doesn't do anything yet)

------------------------------------------------------------------------
r6294 | havoc | 2006-04-16 02:34:02 -0700 (Sun, 16 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/render.h

commented out r_texture_fogintensity texture generation as it's not used anywhere

------------------------------------------------------------------------
r6293 | havoc | 2006-04-16 02:30:21 -0700 (Sun, 16 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix bug in glsl surface shader setup code which was breaking fog

------------------------------------------------------------------------
r6292 | havoc | 2006-04-16 02:21:17 -0700 (Sun, 16 Apr 2006) | 6 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_lightning.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_sky.c

eliminated rmeshstate_t .pointer_vertex and .pointer_color (now must use R_Mesh_VertexPointer and R_Mesh_ColorPointer instead - in a lot of code these don't need to be called as often)
renamed R_Mesh_State to R_Mesh_TextureState
made an alternate variant of R_Mesh_TextureState called R_Mesh_ResetTextureState which acts like it was given an empty rmeshstate_t (but is faster than R_Mesh_TextureState)
moved R_Mesh_VertexPointer and R_Mesh_TexCoordPointer calls out of the inner loops of the GLSL surface path
other related cleanups

------------------------------------------------------------------------
r6291 | havoc | 2006-04-15 23:44:17 -0700 (Sat, 15 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/todo

redesigned some of the model animation code, should be a speed gain (no longer processes animation multiple times on models with multiple textures), and executes less code per surface (should speed up map rendering)

------------------------------------------------------------------------
r6290 | havoc | 2006-04-15 23:40:20 -0700 (Sat, 15 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

fixed zym loading bugs that made models lose surfaces

------------------------------------------------------------------------
r6289 | molivier | 2006-04-15 23:28:28 -0700 (Sat, 15 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_agl.c

AGL fixes: fixed a crash when switching to and from fullscreen several times; explicitely release the display when closing the video module; fixed initial test in VID_Shutdown(); a bit of code cleaning

------------------------------------------------------------------------
r6288 | havoc | 2006-04-15 21:02:32 -0700 (Sat, 15 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

use entity bbox for network culling if model was not found (this allows dedicated servers to run properly without models installed)

------------------------------------------------------------------------
r6287 | havoc | 2006-04-15 18:08:00 -0700 (Sat, 15 Apr 2006) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

some cleanup of Mod_Alias_GetMesh_Vertex3f
fixed md3 animation loading bug (this was causing all frames other than 0 to be corrupt)

------------------------------------------------------------------------
r6286 | molivier | 2006-04-15 04:33:29 -0700 (Sat, 15 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.inc
   M /trunk/darkplaces/vid_agl.c

Fixes and cleanups related to the recent AGL patches

------------------------------------------------------------------------
r6285 | havoc | 2006-04-15 01:24:35 -0700 (Sat, 15 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces
   M /trunk/darkplaces/.cvsignore

added darkplaces-agl to .cvsignore

------------------------------------------------------------------------
r6284 | havoc | 2006-04-15 01:14:55 -0700 (Sat, 15 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_agl.c

fix more warnings

------------------------------------------------------------------------
r6283 | havoc | 2006-04-15 01:13:14 -0700 (Sat, 15 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.inc

added -framework AGL to the Mac OSX client libs to make it compile

------------------------------------------------------------------------
r6282 | havoc | 2006-04-15 01:04:10 -0700 (Sat, 15 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_agl.c

fix some warnings

------------------------------------------------------------------------
r6281 | havoc | 2006-04-15 00:53:27 -0700 (Sat, 15 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/world.c

fix really stupid typo in SV_Move code, this cures the 'monsters walking through walls' bug

------------------------------------------------------------------------
r6280 | havoc | 2006-04-14 23:46:09 -0700 (Fri, 14 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

fix clientside bmodel collisions (now can walk around on the start.bsp main room floor, lifts, be blocked by doors, etc)

------------------------------------------------------------------------
r6279 | havoc | 2006-04-14 23:45:12 -0700 (Fri, 14 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

prints entity number of MOVETYPE_PUSH entities without models (this is mostly useful to level designers who accidentally left a brushless door lying around)

------------------------------------------------------------------------
r6278 | havoc | 2006-04-14 23:44:03 -0700 (Fri, 14 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

additional debugging code

------------------------------------------------------------------------
r6277 | havoc | 2006-04-14 23:41:22 -0700 (Fri, 14 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

fixed stair step up bug in cl_movement code which caused prediction to go through walls in some cases

------------------------------------------------------------------------
r6276 | havoc | 2006-04-14 23:38:09 -0700 (Fri, 14 Apr 2006) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/cl_collision.h
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/world_cs.c

fixed really stupid typo in CL_TraceBox regarding bmodel entity collisions (doors and such) which was breaking their collisions
eliminated CL_PointQ1Contents

------------------------------------------------------------------------
r6275 | havoc | 2006-04-13 20:46:39 -0700 (Thu, 13 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

audit of checkstuck/unstickentity code and relates stuff, this seems to fix the falling out of level bug

------------------------------------------------------------------------
r6274 | havoc | 2006-04-13 20:45:43 -0700 (Thu, 13 Apr 2006) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/collision.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/sv_move.c

better SUPERCONTENTS masks for a few TraceBox and PointContents calls
slight cleanups

------------------------------------------------------------------------
r6273 | havoc | 2006-04-13 09:48:09 -0700 (Thu, 13 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

moved SVC_PARTICLE code to fallback code, this does allow effectinfo.txt to override SVC_PARTICLE but that isn't recommended

------------------------------------------------------------------------
r6272 | havoc | 2006-04-13 09:41:23 -0700 (Thu, 13 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

stop complaining about SVC_PARTICLE

------------------------------------------------------------------------
r6271 | havoc | 2006-04-13 09:33:19 -0700 (Thu, 13 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_agl.c

two Mac OSX fixes from ds01 on alientrap forums - input fixed, and fullscren fixed

------------------------------------------------------------------------
r6270 | havoc | 2006-04-12 15:41:27 -0700 (Wed, 12 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/todo
   M /trunk/darkplaces/view.c

changed cshifts[] to use floats instead of ints, this reduces framerate dependence (where damage flashes faded faster at lower framerates)

------------------------------------------------------------------------
r6269 | havoc | 2006-04-12 15:40:32 -0700 (Wed, 12 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

Sys_Sleep more to save cpu time

------------------------------------------------------------------------
r6268 | havoc | 2006-04-12 15:40:14 -0700 (Wed, 12 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

don't hide console when entering a map, only do so for timedemo

------------------------------------------------------------------------
r6266 | havoc | 2006-04-11 14:47:51 -0700 (Tue, 11 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/image_png.c

MacOSX g++ setjmp fix from div0

------------------------------------------------------------------------
r6265 | black | 2006-04-11 04:31:04 -0700 (Tue, 11 Apr 2006) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

This works for me, works on Windows according to MSDN and should also work
everywhere else according to the C standard.

------------------------------------------------------------------------
r6264 | havoc | 2006-04-10 15:03:40 -0700 (Mon, 10 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

reverted Black's change to the effectinfo.txt color command

------------------------------------------------------------------------
r6263 | black | 2006-04-10 13:41:57 -0700 (Mon, 10 Apr 2006) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

An attempt to fix the particle color bug (it coudlnt read hex values).
Also extend it to make it support "R G B" color pairs.

------------------------------------------------------------------------
r6262 | havoc | 2006-04-08 18:11:39 -0700 (Sat, 08 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c

do apply mixahead math as int

------------------------------------------------------------------------
r6261 | havoc | 2006-04-08 13:02:56 -0700 (Sat, 08 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

fix cl.completed_time math after that last commit

------------------------------------------------------------------------
r6260 | havoc | 2006-04-08 11:56:35 -0700 (Sat, 08 Apr 2006) | 3 lines
Changed paths:
   M /trunk/darkplaces/cd_linux.c
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/image_png.c
   M /trunk/darkplaces/jpeg.c
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_sprite.c
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/sbar.c
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_mem.c
   M /trunk/darkplaces/snd_mix.c
   M /trunk/darkplaces/snd_ogg.c
   M /trunk/darkplaces/snd_wav.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_move.c
   M /trunk/darkplaces/sv_user.c
   M /trunk/darkplaces/svvm_cmds.c
   M /trunk/darkplaces/sys_sdl.c
   M /trunk/darkplaces/sys_win.c
   M /trunk/darkplaces/todo
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/view.c
   M /trunk/darkplaces/world.c
   M /trunk/darkplaces/world_cs.c

made darkplaces able to compile as C++ again, and fixed all conversion warnings when doing so
changed several malloc and free calls to Z_Malloc and Z_Free

------------------------------------------------------------------------
r6259 | havoc | 2006-04-08 09:17:06 -0700 (Sat, 08 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

default sv_gameplayfix_stepdown to 0 because it's generally undesirable

------------------------------------------------------------------------
r6258 | havoc | 2006-04-04 12:08:45 -0700 (Tue, 04 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

466

------------------------------------------------------------------------
r6251 | havoc | 2006-04-04 07:01:23 -0700 (Tue, 04 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/quakedef.h

increased sv_maxrate limit to 150000 from 25000

------------------------------------------------------------------------
r6249 | havoc | 2006-04-04 06:51:22 -0700 (Tue, 04 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/todo

added particle effect scripting using effectinfo.txt, this means configurable effects in any game that wishes to do so

------------------------------------------------------------------------
r6248 | havoc | 2006-04-04 06:49:12 -0700 (Tue, 04 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/render.h

don't render skymasking polygons when noclipping

------------------------------------------------------------------------
r6247 | havoc | 2006-04-04 06:36:21 -0700 (Tue, 04 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

added some extra prints to net_slistqw to figure out which masters are working, and removed a few duplicate references to the id qw masters from the list

------------------------------------------------------------------------
r6228 | havoc | 2006-04-02 00:12:44 -0800 (Sun, 02 Apr 2006) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/vid_shared.c

some cleanup of the GLSL shader, no longer uses #ifdef variable declarations because the shader compiler removes unused variables anyway, and now always calculates the eye vector for simplicity reasons
removed the SURFACENORMALIZE option (now always on, since it doesn't cost much render time and was on by default)
removed all use and detection of half floats (these were originally around 11% speedup on GF6 hardware but but in more recent drivers they've dropped to around 3-6%, and spit out a lot of warnings during shader compilation with no apparent way to fix the warnings)

------------------------------------------------------------------------
r6227 | havoc | 2006-04-02 00:05:42 -0800 (Sun, 02 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

removed a piece of debugging code

------------------------------------------------------------------------
r6220 | havoc | 2006-04-01 05:49:46 -0800 (Sat, 01 Apr 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

rewrote much of SV_Trace_Toss to fix bugs (it basically wasn't working, though I was unable to figure out why)

------------------------------------------------------------------------
r6216 | havoc | 2006-03-30 19:38:34 -0800 (Thu, 30 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

print out the contents of the GLSL shader when it is compiled when using developer 100 or higher

------------------------------------------------------------------------
r6215 | havoc | 2006-03-29 05:25:09 -0800 (Wed, 29 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix a crash in r_showsurfaces

------------------------------------------------------------------------
r6214 | havoc | 2006-03-29 04:54:11 -0800 (Wed, 29 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/render.h

optimizations to surface rendering setup

------------------------------------------------------------------------
r6212 | havoc | 2006-03-29 03:11:46 -0800 (Wed, 29 Mar 2006) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/portals.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_sprites.c
   M /trunk/darkplaces/svvm_cmds.c

eliminated model->meshlist, replaced with an embedded model->surfmesh to cut down on pointer indirections, this also eliminated surface->groupmesh
some minor optimizations of code to keep track of ent->model in a local variable rather than dereferencing ent every time

------------------------------------------------------------------------
r6211 | havoc | 2006-03-29 03:08:11 -0800 (Wed, 29 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c

very very minor optimization

------------------------------------------------------------------------
r6210 | havoc | 2006-03-29 03:04:08 -0800 (Wed, 29 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/BSDmakefile

added LDFLAGS_SDL to the pmake file

------------------------------------------------------------------------
r6209 | havoc | 2006-03-29 02:54:31 -0800 (Wed, 29 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/BSDmakefile

remove a superfluous -L

------------------------------------------------------------------------
r6208 | havoc | 2006-03-29 02:52:14 -0800 (Wed, 29 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.inc

merged special SUNOS LDFLAGS_UNIXCL into LDFLAGS_SUNOSCL to eliminate an ifeq which was breaking on pmake

------------------------------------------------------------------------
r6207 | havoc | 2006-03-29 02:51:31 -0800 (Wed, 29 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/BSDmakefile

remove the -f makefile.bsd

------------------------------------------------------------------------
r6206 | havoc | 2006-03-29 02:37:23 -0800 (Wed, 29 Mar 2006) | 2 lines
Changed paths:
   A /trunk/darkplaces/BSDmakefile
   D /trunk/darkplaces/makefile.bsd

renamed makefile.bsd to BSDmakefile so that pmake will automatically find it (no -f necessary), thanks to div0 for the tip

------------------------------------------------------------------------
r6205 | havoc | 2006-03-29 01:18:50 -0800 (Wed, 29 Mar 2006) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/todo

no longer uses multiple meshes for model loading, they each use one mesh for all surfaces combined
now puts all q3bsp map geometry into one mesh at load rather than splitting it into 65536 vertex meshes to crutch up broken drivers (they've been fixed already so this is no longer necessary)

------------------------------------------------------------------------
r6204 | havoc | 2006-03-29 01:14:28 -0800 (Wed, 29 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

in Host_ServerFrame, give the server a bit more execution time

------------------------------------------------------------------------
r6203 | havoc | 2006-03-28 22:50:53 -0800 (Tue, 28 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

default scr_menuforcewhiledisconnected to 0

------------------------------------------------------------------------
r6202 | havoc | 2006-03-28 16:31:12 -0800 (Tue, 28 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/palette.c
   M /trunk/darkplaces/palette.h
   M /trunk/darkplaces/vid_shared.c

added rampsize parameter to BuildGammaTable8 and 16

------------------------------------------------------------------------
r6201 | havoc | 2006-03-28 05:09:42 -0800 (Tue, 28 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c

an optimization to call XF86VidModeGetGammaRampSize only when opening the window, and assume the rampsize doesn't change after that

------------------------------------------------------------------------
r6200 | havoc | 2006-03-28 05:02:06 -0800 (Tue, 28 Mar 2006) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_agl.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_null.c
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c

modified gamma handling, now VID_UpdateGamma is only called from VID_Finish, and VID_SetGamma/VID_GetGamma/VID_UpdateGamma take rampsize parameters
VID_UpdateGamma now supports ramp sizes other than 256, and automatically allocates memory accordingly, this allows hardware gamma on X11 to work on Quadro cards (which report 1024 gamma entries according to div0), and allows any other platform to do whatever it wishes

------------------------------------------------------------------------
r6199 | havoc | 2006-03-28 02:17:21 -0800 (Tue, 28 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h

added loading of hmap2 .dlit tangentspace deluxemap files and a rather lame method of lightstyle support (blending the deluxemaps according to lightstyles, not rendering them separately like it should)

------------------------------------------------------------------------
r6196 | havoc | 2006-03-27 19:01:52 -0800 (Mon, 27 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

added two more psk/psa versions reported by Kazashi

------------------------------------------------------------------------
r6195 | havoc | 2006-03-27 17:04:23 -0800 (Mon, 27 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/world.c

patch from div0 to fix disappearing items in nexuiz (trace_* globals in qc were not being cleared before calling touch)

------------------------------------------------------------------------
r6194 | havoc | 2006-03-26 00:09:45 -0800 (Sun, 26 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fixed r_speeds stats with r_showsurfaces 1 mode

------------------------------------------------------------------------
r6193 | havoc | 2006-03-25 23:17:32 -0800 (Sat, 25 Mar 2006) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c

added r_showsurfaces rendering mode which illustrates how many surfaces are on screen (and renders REALLY FAST)
moved r_showcollisionbrushes code to gl_rmain.c

------------------------------------------------------------------------
r6192 | havoc | 2006-03-25 22:43:50 -0800 (Sat, 25 Mar 2006) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/todo
   M /trunk/darkplaces/vid_shared.c

eliminated the hacky r_showtris code, now r_glsl 1 mode works with r_showtris
rewrote r_showtris and r_shownormals to use opaque lines that write to the depth buffer, this makes them show up quite clearly in all cases
moved r_showtris and r_shownormals code into R_DrawSurfaces

------------------------------------------------------------------------
r6191 | havoc | 2006-03-25 19:28:37 -0800 (Sat, 25 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

disable skymasking in q3bsp because it causes issues with q3map2 sky tricks (and reenabled the skipping of skymasking on hlbsp also)

------------------------------------------------------------------------
r6190 | havoc | 2006-03-25 18:26:44 -0800 (Sat, 25 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fixed bug that was preventing some deluxemapped q3bsp files from being identified as deluxemapped

------------------------------------------------------------------------
r6189 | havoc | 2006-03-25 14:31:21 -0800 (Sat, 25 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

448

------------------------------------------------------------------------
r6188 | sajt | 2006-03-25 02:56:16 -0800 (Sat, 25 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

452

------------------------------------------------------------------------
r6187 | sajt | 2006-03-24 23:58:18 -0800 (Fri, 24 Mar 2006) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/host_cmd.c

cl_autodemo, when set to true, automatically records every game you play. The filename of the demo is determined by cl_autodemo_nameformat (UNIX time string) and the map name.

Note - I'm pretty sure this currently lumps all games played successively into one demo. Feel free to fix that :)

------------------------------------------------------------------------
r6186 | sajt | 2006-03-24 23:25:45 -0800 (Fri, 24 Mar 2006) | 3 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/jpeg.c

'Cruft' removal (removed GAME_FNIGGIUM)
Fixed a very minor 'potential' leak in JPEG loading

------------------------------------------------------------------------
r6185 | havoc | 2006-03-23 04:34:27 -0800 (Thu, 23 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/sv_main.c

fix some TraceBox calls that weren't updated like they should have been, so they were using a totally bogus bounding box

------------------------------------------------------------------------
r6184 | havoc | 2006-03-23 04:33:46 -0800 (Thu, 23 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

fix EF_SELECTABLE flickering bug with prydon cursor

------------------------------------------------------------------------
r6183 | havoc | 2006-03-23 04:04:10 -0800 (Thu, 23 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_sky.c

and a GL_DepthMask call

------------------------------------------------------------------------
r6177 | havoc | 2006-03-23 03:53:11 -0800 (Thu, 23 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cd_shared.c
   M /trunk/darkplaces/cdaudio.h
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/cvar.c
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/todo
   M /trunk/darkplaces/zone.c

changed several DPrint's and developer cvar checks to higher developer cvar levels (>= 10 and >= 100 for example), this makes developer 1 much more pleasant to use, also changed the memory clearing on free to depend on developer_memorydebug (which is already quite slow) rather than developer (which shouldn't slow things down much)

------------------------------------------------------------------------
r6176 | havoc | 2006-03-23 03:49:22 -0800 (Thu, 23 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_sky.c

a GL_DepthTest call I forgot in the last commit

------------------------------------------------------------------------
r6175 | havoc | 2006-03-23 03:47:11 -0800 (Thu, 23 Mar 2006) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fixed bug that made light filter cubemaps not work in GLSL mode (was binding a cubemap as a 2D texture...  oops)
fixed bug that made sky brush entities not appear when not looking at sky brushes in the world (GL_DepthTest/GL_DepthMask were messed up)

------------------------------------------------------------------------
r6174 | havoc | 2006-03-23 03:44:47 -0800 (Thu, 23 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

corrected PFLAGS_FULLDYNAMIC pitch angle handling

------------------------------------------------------------------------
r6173 | havoc | 2006-03-23 03:43:46 -0800 (Thu, 23 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/collision.c
   M /trunk/darkplaces/collision.h
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/world.c
   M /trunk/darkplaces/world_cs.c

fix bugs with bbox vs bbox traces (the collision box's planes didn't have correct contents/surfaceflags/texture information)

------------------------------------------------------------------------
r6172 | havoc | 2006-03-23 03:41:34 -0800 (Thu, 23 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/matrixlib.c

fixed really stupid bug in Matrix4x4_Normalize - it was transposing the matrix (a legacy of the fact it was based on Invert_Simple)

------------------------------------------------------------------------
r6170 | havoc | 2006-03-22 18:34:51 -0800 (Wed, 22 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

add back a cls.signon = 0 in the SpawnServer code that is necessary to prevent crashes on level change in singleplayer and listen servers

------------------------------------------------------------------------
r6169 | havoc | 2006-03-22 18:34:16 -0800 (Wed, 22 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

added more validation of clipnodes loaded from a q1bsp file

------------------------------------------------------------------------
r6168 | havoc | 2006-03-22 01:18:03 -0800 (Wed, 22 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cd_win.c
   M /trunk/darkplaces/snd_win.c
   M /trunk/darkplaces/sys_linux.c
   M /trunk/darkplaces/sys_win.c
   M /trunk/darkplaces/vid_wgl.c

another WIN32_LEAN_AND_MEAN patch from Willis, this one for non-SDL client and dedicated server

------------------------------------------------------------------------
r6166 | havoc | 2006-03-22 00:51:35 -0800 (Wed, 22 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/csprogs.h
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/r_crosshairs.c
   M /trunk/darkplaces/snd_alsa.c
   M /trunk/darkplaces/snd_sdl.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/svvm_cmds.c
   M /trunk/darkplaces/todo
   M /trunk/darkplaces/view.c
   M /trunk/darkplaces/world.c
   M /trunk/darkplaces/world_cs.c

implemented DP_TRACE_HITCONTENTSMASK_SURFACEINFO extension, this allows QC to find out if a projectile hit sky, among other capabilities

------------------------------------------------------------------------
r6165 | havoc | 2006-03-21 21:22:21 -0800 (Tue, 21 Mar 2006) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/collision.c
   M /trunk/darkplaces/collision.h
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/world.c
   M /trunk/darkplaces/world_cs.c

changed collision code to report supercontents, surfaceflags, and texture that was hit in a trace (even if it has to fake the information for q1bsp)
decals no longer stick to sky (except in stock id1 q1bsp maps which have CONTENTS_SOLID sky)

------------------------------------------------------------------------
r6164 | havoc | 2006-03-21 02:36:25 -0800 (Tue, 21 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

448

------------------------------------------------------------------------
r6163 | havoc | 2006-03-21 02:31:54 -0800 (Tue, 21 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/todo

fixed bug that made deluxemapping gloss appear even with rtworld on

------------------------------------------------------------------------
r6162 | havoc | 2006-03-21 02:28:43 -0800 (Tue, 21 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

fix alpha blended textures in GLSL lighting path

------------------------------------------------------------------------
r6161 | havoc | 2006-03-21 01:56:14 -0800 (Tue, 21 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/sbar.c

changed all Draw_CachePic calls to precache the pic except for two calls in the menu qc vm

------------------------------------------------------------------------
r6160 | havoc | 2006-03-21 01:55:27 -0800 (Tue, 21 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

fix a crash that could occur if resizing the resize buffer twice in one upload call, and also fix a bug where the player setup menu's translated player pic was being treated as a subimage update which doesn't work because that image is scaled up, not a natural power of 2

------------------------------------------------------------------------
r6159 | havoc | 2006-03-21 01:07:34 -0800 (Tue, 21 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/mathlib.h

slight readability improvement to PointInfrontOfTriangle

------------------------------------------------------------------------
r6158 | havoc | 2006-03-21 01:06:02 -0800 (Tue, 21 Mar 2006) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/r_textures.h
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_shared.c

removed detection of GL_NV_texture_shader extension which was previously used for the geforce3 water shader that was removed a long time ago
removed support for GL_DSDT_NV textures (which were only used for the geforce3 water shader)
removed code pertaining to GL_NV_vertex_array_range (which hasn't been supported for a very long time)

------------------------------------------------------------------------
r6157 | havoc | 2006-03-21 00:49:42 -0800 (Tue, 21 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/r_textures.h
   M /trunk/darkplaces/todo

removed TEXF_FRAGMENT support from texture manager and merged gltextureimage_t into gltexture_t to save some memory and reduce code complexity

------------------------------------------------------------------------
r6156 | molivier | 2006-03-20 22:52:58 -0800 (Mon, 20 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_agl.c

Minor changes to get rid of functions deprecated in Mac OS X 10.4

------------------------------------------------------------------------
r6155 | havoc | 2006-03-20 22:49:25 -0800 (Mon, 20 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_textures.h

modified Q1BSP loader to generate lightmap fragments on its own, rather than relying on the texture manager, this greatly shortens r_texturestats reports and reduces memory usage a bit (less gltexture_t structures), and modified R_UpdateTexture to be able to update fragments

------------------------------------------------------------------------
r6154 | havoc | 2006-03-20 21:49:29 -0800 (Mon, 20 Mar 2006) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/meshqueue.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/todo
   M /trunk/darkplaces/wad.c
   M /trunk/darkplaces/zone.c

renamed varray_ arrays to rsurface_array_, and they are no longer used outside the surface rendering code, additionally they are now dynamically resized (saves a little memory)
audited a lot of memory allocations and fixed a few significant leaks
removed Host_ClearMemory as it was causing several memory leaks, and split cls.mempool into cls.levelmempool and cls.permanentmempool, cls.levelmempool is now emptied each level load (this also fixes those same leaks)
merged r_shadow_mempool into r_main_mempool

------------------------------------------------------------------------
r6153 | havoc | 2006-03-20 19:03:26 -0800 (Mon, 20 Mar 2006) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_lightning.c
   M /trunk/darkplaces/r_shadow.c

removed the USETEXMATRIX define (now always on), reduced varray_texcoord3f to only have one array rather than 4 (as the others are no longer needed with USETEXMATRIX), removed varray_texcoord2f, removed earray_element3i
changed many simple uses of varray_* arrays to use stack arrays instead
this reduces memory usage by 1MB

------------------------------------------------------------------------
r6152 | havoc | 2006-03-20 18:27:02 -0800 (Mon, 20 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h

removed unused R_Mesh_CacheArray stuff

------------------------------------------------------------------------
r6151 | havoc | 2006-03-20 18:23:27 -0800 (Mon, 20 Mar 2006) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/cl_screen.h
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/draw.h
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/todo

moved SCR_UpdateScreen and SCR_DrawScreen code to cl_screen.c and rearranged them somewhat
moved DrawQ_ functions to gl_draw.c and eliminated r_refdef.drawqueue (this saves some memory and makes all the 2D code more efficient)
disabled unused R_Mesh_CacheArray stuff in gl_backend.c

------------------------------------------------------------------------
r6150 | havoc | 2006-03-20 17:18:34 -0800 (Mon, 20 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

fixed one more cvar declaration that was missing a comma

------------------------------------------------------------------------
r6149 | havoc | 2006-03-20 17:15:43 -0800 (Mon, 20 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

fixed value/description of r_textshadow

------------------------------------------------------------------------
r6148 | havoc | 2006-03-20 15:09:24 -0800 (Mon, 20 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/collision.h
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/world.c
   M /trunk/darkplaces/world_cs.c

fixed stuck entity warnings when they should not have been occurring, by adding trace.bmodelstartsolid as a separate thing to check

------------------------------------------------------------------------
r6147 | havoc | 2006-03-20 14:31:10 -0800 (Mon, 20 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

enabled fullbrights on liquid textures in q1bsp loading, this fixes the black lava bug

------------------------------------------------------------------------
r6146 | havoc | 2006-03-19 22:13:30 -0800 (Sun, 19 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

fix crash when using r_editlights mode

------------------------------------------------------------------------
r6145 | havoc | 2006-03-19 22:08:51 -0800 (Sun, 19 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

fix nail and explosion sound defaults

------------------------------------------------------------------------
r6144 | havoc | 2006-03-19 21:51:30 -0800 (Sun, 19 Mar 2006) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/view.c

cl_movement 0 should no longer be causing an input replay (which was slow and pointless), though I don't know how it was doing so before...
added code to prevent pogostick jumping in the cl_movement prediction (since the qc prevents pogostick jumping, it was inaccurate to simulate it clientside)
changed view/gun bobbing to use cl.movement_velocity for the xyspeed math, this greatly improves the clientside prediction

------------------------------------------------------------------------
r6143 | havoc | 2006-03-19 20:01:50 -0800 (Sun, 19 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces-dedicated.dsp
   M /trunk/darkplaces/darkplaces-sdl.dsp
   M /trunk/darkplaces/darkplaces.dsp
   M /trunk/darkplaces/vid_sdl.c

WIN32_LEAN_AND_MEAN patch from Willis to speed up MSVC compilation

------------------------------------------------------------------------
r6142 | havoc | 2006-03-19 20:01:09 -0800 (Sun, 19 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/render.h

added reliefmapping (behaves exactly like offsetmapping, but a slightly different look), removed r_glsl_offsetmapping_bias setting

------------------------------------------------------------------------
r6141 | havoc | 2006-03-19 13:15:02 -0800 (Sun, 19 Mar 2006) | 5 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/render.h

fixed deluxemapping
added r_glsl_deluxemapping cvar (2 forces fake deluxemapping on any level, kind of interesting to see)
added modelspace deluxemapping (automatically detects whether deluxemaps are modelspace or tangentspace at load time)
changed offsetmapping shader to be more perspective correct

------------------------------------------------------------------------
r6140 | havoc | 2006-03-19 13:12:26 -0800 (Sun, 19 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

added one more r_speeds 2 report item, to ensure that "clear" is really measuring only the clearing process

------------------------------------------------------------------------
r6139 | sajt | 2006-03-18 04:17:01 -0800 (Sat, 18 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cvar.c

This made the cvar completion so much more readable

------------------------------------------------------------------------
r6138 | sajt | 2006-03-18 04:12:57 -0800 (Sat, 18 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c

I was just joking

------------------------------------------------------------------------
r6137 | sajt | 2006-03-18 04:11:13 -0800 (Sat, 18 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c

nitpicky

------------------------------------------------------------------------
r6136 | havoc | 2006-03-18 02:08:09 -0800 (Sat, 18 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

added r_glsl_restart command, and modified shaderstring loading back to the old way (reload the file on every permutation compile) for simplicity

------------------------------------------------------------------------
r6135 | havoc | 2006-03-17 21:20:17 -0800 (Fri, 17 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

one more correction

------------------------------------------------------------------------
r6134 | havoc | 2006-03-17 21:18:27 -0800 (Fri, 17 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix stupid but non-harmful bug in RSurf_DrawLightmap code

------------------------------------------------------------------------
r6133 | havoc | 2006-03-17 21:08:48 -0800 (Fri, 17 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/image.c

fixed an uninitialized variable warning (which was true)

------------------------------------------------------------------------
r6132 | havoc | 2006-03-17 20:28:17 -0800 (Fri, 17 Mar 2006) | 4 lines
Changed paths:
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/image.h
   M /trunk/darkplaces/model_brush.c

reduced number of image extensions checked by doing more intelligent path examination, and changing q1bsp loader to prepend textures/, this allows it to not check any prefixes in the image loader itself (except in a few cases in nexuiz)
changed image loader to not check override/ unless running GAME_TENEBRAE
removed several unused image functions

------------------------------------------------------------------------
r6131 | havoc | 2006-03-16 23:50:50 -0800 (Thu, 16 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

updated default.glsl

------------------------------------------------------------------------
r6130 | havoc | 2006-03-16 23:49:01 -0800 (Thu, 16 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/todo

added deluxemapping (per pixel lighting using lightmaps in specially compiled q3bsp maps)

------------------------------------------------------------------------
r6129 | havoc | 2006-03-16 22:34:13 -0800 (Thu, 16 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

updated default glsl shader

------------------------------------------------------------------------
r6128 | havoc | 2006-03-16 22:33:11 -0800 (Thu, 16 Mar 2006) | 4 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_light.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/render.h

added GLSL shader path for normal rendering stage, reworked a lot of things to do this
removed .lights file loading and the corresponding directional model shading (these were only produced by hlight for q1bsp, very rare files) so that the GLSL normal rendering stage would not have to deal with .lights files
changed R_CompleteLightPoint to properly match rtlight shading, not the old dlights, this allowed removal of the old lightmap_* rtlight fields

------------------------------------------------------------------------
r6127 | havoc | 2006-03-16 22:29:12 -0800 (Thu, 16 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

446

------------------------------------------------------------------------
r6126 | havoc | 2006-03-16 22:27:07 -0800 (Thu, 16 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_textures.h

modified R_GetTexture to return the texnum of r_texture_white if given NULL

------------------------------------------------------------------------
r6125 | havoc | 2006-03-16 19:59:23 -0800 (Thu, 16 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

remove fullbright flag on lava and teleport textures

------------------------------------------------------------------------
r6123 | sajt | 2006-03-16 17:28:42 -0800 (Thu, 16 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/view.c

Yes, that was a rather silly typo!

------------------------------------------------------------------------
r6122 | havoc | 2006-03-16 14:58:21 -0800 (Thu, 16 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/view.c

added v_deathtiltangle cvar to allow changing of the roll angle used while dead, at RenegadeC's request

------------------------------------------------------------------------
r6121 | havoc | 2006-03-15 05:19:36 -0800 (Wed, 15 Mar 2006) | 6 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/render.h

cleaning up GLSL code
moved GLSL shader setup to gl_rmain.c and made it more general, not specifically lighting shaders
cache locations of GLSL shader variables for faster access (instead of looking them up every time it renders something)
GLSL shader reworked to support deluxemap rendering and lightmap rendering, to be used in the future
merged glsl/light.frag and glsl/light.vert into glsl/default.glsl using VERTEX_SHADER and FRAGMENT_SHADER defines to differentiate parts of it

------------------------------------------------------------------------
r6120 | havoc | 2006-03-15 05:16:19 -0800 (Wed, 15 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.h

changed skybox string from size 64 to MAX_QPATH (which is 64)

------------------------------------------------------------------------
r6119 | molivier | 2006-03-15 02:54:27 -0800 (Wed, 15 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces-dedicated.dsp
   M /trunk/darkplaces/darkplaces-sdl.dsp
   M /trunk/darkplaces/darkplaces.dsp

Removed cgame.c, cgamevm.c, ui.c, cg_math.h, cgame_api.h, cgamevm.h, and ui.h from the MSVC projects

------------------------------------------------------------------------
r6118 | havoc | 2006-03-15 00:02:43 -0800 (Wed, 15 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

slight optimization of model purging and the like, and a failed attempt to make mod_known be a dynamic array

------------------------------------------------------------------------
r6117 | havoc | 2006-03-14 23:02:56 -0800 (Tue, 14 Mar 2006) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/csprogs.h
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/meshqueue.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/netconn.h
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/r_crosshairs.c
   M /trunk/darkplaces/r_lightning.c
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_mix.c
   M /trunk/darkplaces/view.c
   M /trunk/darkplaces/wad.c

moved many cl_ prefixed variables into cl. or cls.
made most menu functions static
removed WORKINGLQUAKE support from cl_particles.c and moved particle allocation to cl_main.c (where all the other arrays are allocated)
renamed cl_activevideos to cl_num_videos and videoarray to cl_videos (did not move these into cls. however)

------------------------------------------------------------------------
r6116 | havoc | 2006-03-14 22:08:15 -0800 (Tue, 14 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_user.c

don't set qc impulse more than once per packet

------------------------------------------------------------------------
r6115 | havoc | 2006-03-14 17:01:53 -0800 (Tue, 14 Mar 2006) | 2 lines
Changed paths:
   D /trunk/darkplaces/cg_math.h
   D /trunk/darkplaces/cgame.c
   D /trunk/darkplaces/cgame_api.h
   D /trunk/darkplaces/cgamevm.c
   D /trunk/darkplaces/cgamevm.h
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/makefile.inc
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/quakedef.h
   D /trunk/darkplaces/ui.c
   D /trunk/darkplaces/ui.h

removed cgame and ui code (both unused), this reduces memory use a bit

------------------------------------------------------------------------
r6114 | havoc | 2006-03-14 16:42:48 -0800 (Tue, 14 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

added LAN search for quakeworld servers

------------------------------------------------------------------------
r6113 | havoc | 2006-03-14 16:35:08 -0800 (Tue, 14 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/netconn.h

split up net_slist into net_slist and net_slistqw, and modified menu accordingly to have two search options

------------------------------------------------------------------------
r6112 | havoc | 2006-03-13 20:39:14 -0800 (Mon, 13 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/r_shadow.c

fix crosshair 6, and allow custom crosshairs up to 32

------------------------------------------------------------------------
r6111 | sajt | 2006-03-11 18:36:58 -0800 (Sat, 11 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

Fix in Nexuiz's fallback menu to avoid ending up with a blank screen

------------------------------------------------------------------------
r6110 | sajt | 2006-03-11 17:04:12 -0800 (Sat, 11 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/todo

r_nearclip cvar

------------------------------------------------------------------------
r6109 | sajt | 2006-03-11 16:23:44 -0800 (Sat, 11 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces-dedicated.dsp
   M /trunk/darkplaces/darkplaces.dsp

Added some non-crucial header files to the VC++6 projects. The .dev files need them too, not sure what compiler those files are for though.

------------------------------------------------------------------------
r6108 | havoc | 2006-03-11 12:17:23 -0800 (Sat, 11 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_agl.c

fix typo

------------------------------------------------------------------------
r6107 | havoc | 2006-03-11 11:01:54 -0800 (Sat, 11 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cvar.c
   M /trunk/darkplaces/cvar.h

use hash lookups in Cvar_FindVar, this gives a ~40% increase in fps with high numbers of bots in nexuiz

------------------------------------------------------------------------
r6106 | havoc | 2006-03-11 10:28:00 -0800 (Sat, 11 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/zone.c

refactored _Mem_Free into _Mem_FreeBlock which takes a memheader_t * and _Mem_Free which converts a void * to the content area of the memory, to a memheader_t * and calls _Mem_FreeBlock - now _Mem_FreePool and _Mem_EmptyPool can call that directly, which avoids a Mem_IsAllocated error that I don't understand

------------------------------------------------------------------------
r6105 | havoc | 2006-03-11 10:10:56 -0800 (Sat, 11 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

added back brackets so that developer isn't forced to 100 on startup every time

------------------------------------------------------------------------
r6104 | havoc | 2006-03-11 09:33:31 -0800 (Sat, 11 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

oops, accidentally set developer to 100 by default

------------------------------------------------------------------------
r6103 | havoc | 2006-03-11 09:24:10 -0800 (Sat, 11 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_agl.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_null.c
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_wgl.c

changed VID_Finish to take an allowmousegrab parameter, this avoids mousegrab on the initial loading screen (before +vid_mouse 1 on commandline is executed)

------------------------------------------------------------------------
r6102 | havoc | 2006-03-11 09:23:09 -0800 (Sat, 11 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

init host_framecount to 0, just a cleanup

------------------------------------------------------------------------
r6101 | havoc | 2006-03-11 09:22:22 -0800 (Sat, 11 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/protocol.c

fix bug in [515]'s csqc code - it was using the literal number 64 for the max players, not MAX_SCOREBOARD as it should

------------------------------------------------------------------------
r6100 | havoc | 2006-03-11 09:11:23 -0800 (Sat, 11 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/zone.c

fix incredibly stupid bug in Memory_Init, it was clearing the pool chain AFTER allocating two pools

------------------------------------------------------------------------
r6099 | havoc | 2006-03-11 09:10:55 -0800 (Sat, 11 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

cleaned up the stupid forcedeveloper hack, now changes the default string of the cvar before it is registered, this is much cleaner

------------------------------------------------------------------------
r6098 | havoc | 2006-03-11 08:59:04 -0800 (Sat, 11 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

moved -developer code to the very beginning of Host_Init, and added a -developer2 option for heavy memory debugging from the beginning

------------------------------------------------------------------------
r6097 | havoc | 2006-03-11 08:58:28 -0800 (Sat, 11 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/zone.h

moved name in memory pools to a different part of the structure, to make ddd displays read better

------------------------------------------------------------------------
r6096 | havoc | 2006-03-11 08:57:48 -0800 (Sat, 11 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_shared.c

fix skinfile memory leaks on ZYM, DPM, and PSK model loaders, and move the skinfile allocations to the model's memory pool even though they are temporary

------------------------------------------------------------------------
r6095 | havoc | 2006-03-11 08:19:18 -0800 (Sat, 11 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/host.c

moved Log_Start call into SCR_BeginLoadingPlaque (which occurs as soon as a map or demo loads, or when config parsing is done)

------------------------------------------------------------------------
r6094 | havoc | 2006-03-10 15:47:18 -0800 (Fri, 10 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

446

------------------------------------------------------------------------
r6093 | havoc | 2006-03-10 15:45:42 -0800 (Fri, 10 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

default sv_jumpstep to 0 to not allow players to jump places they should not be able to go in quake (each game/mod can set this in its default.cfg if it is desired)

------------------------------------------------------------------------
r6092 | havoc | 2006-03-10 15:23:21 -0800 (Fri, 10 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c

fixed cl_activebeams handling, now beams work again

------------------------------------------------------------------------
r6089 | havoc | 2006-03-09 21:21:43 -0800 (Thu, 09 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

fixed bug that caused SV_SpawnServer to fail to send reconnect commands to clients (it was using sv.reliable_datagram which is immediately cleared and thus not sent)

------------------------------------------------------------------------
r6088 | havoc | 2006-03-09 21:19:54 -0800 (Thu, 09 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

when loading a savegame, use the saved v_angle value, not angles which usually lacks pitch, this fixes the lack of view pitch when loading games

------------------------------------------------------------------------
r6087 | havoc | 2006-03-09 21:18:39 -0800 (Thu, 09 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

fixed bug that allowed the quake2 stair jump to work

------------------------------------------------------------------------
r6086 | havoc | 2006-03-09 20:02:56 -0800 (Thu, 09 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

don't clear player entity when loading a savegame

------------------------------------------------------------------------
r6085 | havoc | 2006-03-09 18:37:40 -0800 (Thu, 09 Mar 2006) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/collision.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/world.c
   M /trunk/darkplaces/world_cs.c

changed TraceBox functions to take start,mins,maxs,end like they did in Quake, this is a slight optimization to traceline and pointcontents tests and q1bsp tracing, but mostly just cleans up the code
removed some old code from q3bsp TraceLine/TraceBox functions
changed segmentmins/maxs and nodesegmentmins/maxs calculations to have a 1 unit enlargement on all comparisons, this might improve reliability of TraceBox, but probably not

------------------------------------------------------------------------
r6084 | havoc | 2006-03-09 18:31:42 -0800 (Thu, 09 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fixed bullets-going-through-walls bug in q3bsp collision code, this was a really nasty bug in the midfrac calculations (it was calculating the midfrac for the partially clipped line segment and then acting as if that was a fraction of the complete line segment...  this caused many problems)

------------------------------------------------------------------------
r6083 | havoc | 2006-03-09 08:19:23 -0800 (Thu, 09 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/svvm_cmds.c

fixed bug that caused ClientDisconnect to not be called on bots in their first level (it did get called on their second level onward), this fix does however assume the QC code will call ClientConnect every time it uses spawnclient

------------------------------------------------------------------------
r6082 | havoc | 2006-03-08 07:53:47 -0800 (Wed, 08 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

made zym and dpm model loaders warn and ignore the model if it is missing geometry or frames

------------------------------------------------------------------------
r6081 | havoc | 2006-03-07 17:13:29 -0800 (Tue, 07 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/world.c
   M /trunk/darkplaces/world.h

some work on SV_TestEntityPosition and entity unsticking, now only checks against bmodels

------------------------------------------------------------------------
r6080 | havoc | 2006-03-07 12:39:58 -0800 (Tue, 07 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/snd_mem.c
   M /trunk/darkplaces/vid_sdl.c

some win64 fixes from Willis

------------------------------------------------------------------------
r6079 | havoc | 2006-03-07 06:18:05 -0800 (Tue, 07 Mar 2006) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_shadow.c

rearranged surface renderer some more
added tangent/normal generation flags to RSurf_SetVertexPointer, this eliminated the various calls to Mod_BuildTextureVectorsAndNormals and Mod_BuildNormals during rendering, so RSurf_SetVertexPointer is now the only function that sets up rsurface_* variables

------------------------------------------------------------------------
r6078 | havoc | 2006-03-07 03:22:16 -0800 (Tue, 07 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

simplified cl_particles_quality handling, shouldn't affect particle lifetime anymore now

------------------------------------------------------------------------
r6077 | havoc | 2006-03-07 03:21:49 -0800 (Tue, 07 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

fix r_speeds 1 so that it works again

------------------------------------------------------------------------
r6076 | havoc | 2006-03-07 02:49:16 -0800 (Tue, 07 Mar 2006) | 3 lines
Changed paths:
   M /trunk/darkplaces/sv_user.c

fixed pogostick/doublejump bug when running id1 qc with a client sending input packets less frequently than server frames
moved ping time calculation out of SV_ApplyClientMove and back into SV_ReadClientMove

------------------------------------------------------------------------
r6075 | molivier | 2006-03-07 02:14:28 -0800 (Tue, 07 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_mem.c

Modified ResampleSfx for a small speed gain

------------------------------------------------------------------------
r6074 | molivier | 2006-03-06 02:16:16 -0800 (Mon, 06 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces-sdl.dsp

Added "SDL/include" to the include paths and "SDL/lib" to the library paths (allow easy compilation with SDL when the SDL SDK isn't already integrated in MSVC; just unzip "SDL-devel-1.2.x-VC6.zip" in the darkplaces folder, rename its folder to "SDL" and voila!)

------------------------------------------------------------------------
r6073 | havoc | 2006-03-04 13:31:37 -0800 (Sat, 04 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/quakedef.h

upped player limit (MAX_SCOREBOARD) from 64 to 255, and corrected my email address in the menu

------------------------------------------------------------------------
r6072 | havoc | 2006-03-04 10:49:26 -0800 (Sat, 04 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/mdfour.c

commented out a line as suggested by Spike, to fix a crash when length is 0, this matches the behavior of md4

------------------------------------------------------------------------
r6071 | havoc | 2006-03-04 10:48:37 -0800 (Sat, 04 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

added LittleLong around the checksums to fix endian-ness issues in QW

------------------------------------------------------------------------
r6068 | havoc | 2006-03-04 07:04:28 -0800 (Sat, 04 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

add SV_VM block around SV_DropClient call in NetConn_ServerFrame to fix a crash when players time out

------------------------------------------------------------------------
r6067 | havoc | 2006-03-04 06:52:53 -0800 (Sat, 04 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_brush.c

some cleanup of surface->cached_dlight handling to fix the broken unlit q1bsp handling (it was not appearing fullbright as it should), and this also is a slight optimization

------------------------------------------------------------------------
r6066 | black | 2006-03-04 06:45:35 -0800 (Sat, 04 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/cl_video.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/prvm_cmds.c

Fix a bug in the video system.

------------------------------------------------------------------------
r6065 | havoc | 2006-03-04 06:36:50 -0800 (Sat, 04 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

forgot to include this in the previous commit

------------------------------------------------------------------------
r6064 | havoc | 2006-03-04 06:33:22 -0800 (Sat, 04 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/cl_video.h

unmerge OpenVideo code, back to the proper multilayer system it was

------------------------------------------------------------------------
r6063 | havoc | 2006-03-04 05:38:03 -0800 (Sat, 04 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

changed Q1BSP LoadEdges out of bounds error into just a warning

------------------------------------------------------------------------
r6062 | havoc | 2006-03-04 02:50:37 -0800 (Sat, 04 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix a const warning

------------------------------------------------------------------------
r6061 | havoc | 2006-03-04 02:49:23 -0800 (Sat, 04 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix duplicate definition of identitymatrix (search and replace accident)

------------------------------------------------------------------------
r6060 | havoc | 2006-03-04 02:48:40 -0800 (Sat, 04 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/clvm_cmds.c

fix typo

------------------------------------------------------------------------
r6059 | havoc | 2006-03-04 02:47:37 -0800 (Sat, 04 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/collision.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_lightning.c
   M /trunk/darkplaces/r_sprites.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/svvm_cmds.c
   M /trunk/darkplaces/view.c

eliminated calls to Matrix4x4_CreateIdentity (now copies from the already existing global identitymatrix struct) and changed all references to r_identitymatrix to refer to identitymatrix

------------------------------------------------------------------------
r6058 | havoc | 2006-03-04 01:24:21 -0800 (Sat, 04 Mar 2006) | 6 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/cl_screen.h
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/r_crosshairs.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/sbar.c

replaced sbarpic_t with cachepic_t in sbar code (saves a bit of memory)
changed DrawQ_SuperPic and DrawQ_Pic to take a cachepic_t * instead of a pic name (this speeds up the sbar code by not using name lookups constantly)
removed DrawQ_Fill (use DrawQ_Pic with NULL pic instead)
changed crosshair/editlights cursors to use r_crosshairs array initialized at startup instead of constantly calling Draw_CachePic
changed Host_Init to call SCR_BeginLoadingPlaque instead of Host_StartVideo (which is called by SCR_BeginLoadingPlaque)

------------------------------------------------------------------------
r6057 | havoc | 2006-03-04 01:23:32 -0800 (Sat, 04 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

454

------------------------------------------------------------------------
r6056 | havoc | 2006-03-04 01:23:05 -0800 (Sat, 04 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_sdl.c

added SDL_APPACTIVE checking so that vid_hidden is now set correctly, this turns off rendering when minimized

------------------------------------------------------------------------
r6055 | havoc | 2006-03-03 23:14:10 -0800 (Fri, 03 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/cl_video.h
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/r_lightning.c
   M /trunk/darkplaces/render.h

optimizations and refactoring to get a small (1-2%) speed gain

------------------------------------------------------------------------
r6054 | havoc | 2006-03-03 22:13:50 -0800 (Fri, 03 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cgamevm.c

added a fast path for queries on "sv_gravity" in CG_Frame (which is unused)

------------------------------------------------------------------------
r6053 | havoc | 2006-03-03 21:40:06 -0800 (Fri, 03 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cgame.c

optimized entity handling in cgame.c (not used) so that it doesn't drag down framerates doing nothing

------------------------------------------------------------------------
r6052 | havoc | 2006-03-03 18:45:32 -0800 (Fri, 03 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

fix a C99 lazy variable issue with non-C99 compilers

------------------------------------------------------------------------
r6051 | havoc | 2006-03-03 07:02:56 -0800 (Fri, 03 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

now only compiles GLSL shaders on demand, this improves startup times (but causes some pausing when new combinations occur - which usually only happens on new levels)

------------------------------------------------------------------------
r6050 | havoc | 2006-03-03 06:51:07 -0800 (Fri, 03 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

move SV_ClearDatagram call to eliminate missing weapon/pickup effects bug when using cl_movement 1

------------------------------------------------------------------------
r6049 | molivier | 2006-03-02 08:46:30 -0800 (Thu, 02 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_ogg.c

Fallback to "vorbis.dll" and "vorbisfile.dll" if "libvorbis.dll" and "libvorbisfile.dll" can't be loaded

------------------------------------------------------------------------
r6048 | molivier | 2006-03-02 07:47:38 -0800 (Thu, 02 Mar 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces-dedicated.dsp
   M /trunk/darkplaces/darkplaces-sdl.dsp
   M /trunk/darkplaces/darkplaces.dsp

Added mdfour.[ch] to the MSVC project files

------------------------------------------------------------------------
r6047 | havoc | 2006-02-28 04:19:54 -0800 (Tue, 28 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/netconn.h

filter servers by "gameversion" cvar, which is now also exposed in the serverinfo

------------------------------------------------------------------------
r6046 | havoc | 2006-02-28 00:17:49 -0800 (Tue, 28 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

only query QuakeWorld servers when in GAME_NORMAL mode

------------------------------------------------------------------------
r6045 | havoc | 2006-02-27 22:29:59 -0800 (Mon, 27 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/polygon.c

casts to fix warnings in MSVC x64, thanks Willis

------------------------------------------------------------------------
r6044 | havoc | 2006-02-27 22:00:27 -0800 (Mon, 27 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/svvm_cmds.c

patch from div0 to fix a comment

------------------------------------------------------------------------
r6043 | havoc | 2006-02-27 21:41:39 -0800 (Mon, 27 Feb 2006) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/sv_phys.c

reduced number of GAME_NEXUIZ checks in the engine (added cl_sound and sv_sound cvars to change or disable engine-triggered sounds), removed some old unused nexuiz menu code (now that the fallbac
k prevents you from even reaching the singleplayer menu)

------------------------------------------------------------------------
r6042 | havoc | 2006-02-26 18:19:30 -0800 (Sun, 26 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

fix the minutes display on the QW scoreboard

------------------------------------------------------------------------
r6041 | havoc | 2006-02-26 18:15:48 -0800 (Sun, 26 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/lhnet.c

MorphOS networking support patch from bigfoot

------------------------------------------------------------------------
r6040 | havoc | 2006-02-26 18:15:10 -0800 (Sun, 26 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

added MorphOS labeling

------------------------------------------------------------------------
r6039 | havoc | 2006-02-26 03:00:19 -0800 (Sun, 26 Feb 2006) | 3 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

vast improvements in qw server listings in the server browser
now DP servers and QW servers are color coded differently, and player count is color coded (red if empty or full, yellow if less than 4 players, white otherwise, useful for quickly identifying the busy servers)

------------------------------------------------------------------------
r6038 | havoc | 2006-02-26 01:39:59 -0800 (Sun, 26 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/netconn.h

added qw master support to server query system, and added 16 masters (15 of which from FTEQW), now the server browser is flooded with QW servers

------------------------------------------------------------------------
r6037 | havoc | 2006-02-26 01:37:52 -0800 (Sun, 26 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

improved packet command to have more escape codes (like \0)

------------------------------------------------------------------------
r6036 | havoc | 2006-02-26 01:36:46 -0800 (Sun, 26 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

fix crash in nq connect (oops)

------------------------------------------------------------------------
r6035 | havoc | 2006-02-25 22:15:17 -0800 (Sat, 25 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

added support for qw movevars (sent in server join, and sometimes a couple of them are updated during the game) in the cl_movement physics

------------------------------------------------------------------------
r6034 | havoc | 2006-02-25 19:15:05 -0800 (Sat, 25 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

fix the timeout problem with cl_movement 1 mode on QW servers, but the prediction still needs work to make use of movevars

------------------------------------------------------------------------
r6033 | havoc | 2006-02-25 19:00:47 -0800 (Sat, 25 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/sbar.c
   M /trunk/darkplaces/sv_user.c
   M /trunk/darkplaces/view.c

qw support is 99% working

------------------------------------------------------------------------
r6031 | havoc | 2006-02-25 06:13:18 -0800 (Sat, 25 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/makefile.inc
   A /trunk/darkplaces/mdfour.c
   A /trunk/darkplaces/mdfour.h
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h

added md4four map checksumming, since QW servers seem to be very picky about map checksums matching

------------------------------------------------------------------------
r6030 | havoc | 2006-02-25 05:21:54 -0800 (Sat, 25 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/protocol.c

QW support getting very close

------------------------------------------------------------------------
r6029 | havoc | 2006-02-25 02:11:36 -0800 (Sat, 25 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/protocol.h

QW support getting closer

------------------------------------------------------------------------
r6028 | havoc | 2006-02-25 01:59:58 -0800 (Sat, 25 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h

moved parse_model_precache and parse_sound_precache to cl.model_names and cl.sound_names respectively

------------------------------------------------------------------------
r6027 | havoc | 2006-02-25 00:56:03 -0800 (Sat, 25 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/protocol.c

fix typos that caused colormod to malfunction when hosting a QUAKEDP protocol server (it was sending red as green and blue), thanks to Spike for pointing this out

------------------------------------------------------------------------
r6026 | havoc | 2006-02-23 22:04:40 -0800 (Thu, 23 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/cvar.c
   M /trunk/darkplaces/cvar.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/netconn.h
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c

beginnings of qw protocol support

------------------------------------------------------------------------
r6025 | havoc | 2006-02-23 22:03:21 -0800 (Thu, 23 Feb 2006) | 3 lines
Changed paths:
   M /trunk/darkplaces/common.c

added InfoString_Print
modified InfoString_GetValue and InfoString_SetValue to reject " characters

------------------------------------------------------------------------
r6024 | havoc | 2006-02-23 21:18:03 -0800 (Thu, 23 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/view.c

renamed cl.protocol to cls.protocol

------------------------------------------------------------------------
r6023 | havoc | 2006-02-23 21:17:36 -0800 (Thu, 23 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c

fix infinite loop bugs in InfoString_SetValue

------------------------------------------------------------------------
r6022 | havoc | 2006-02-23 20:46:27 -0800 (Thu, 23 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/netconn.h

removed canSend field from netconn_t, and added a fromserver variable in client parsing just for clarity

------------------------------------------------------------------------
r6021 | havoc | 2006-02-23 20:44:04 -0800 (Thu, 23 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

remove an unnecessary SV_VM block

------------------------------------------------------------------------
r6020 | havoc | 2006-02-23 20:14:42 -0800 (Thu, 23 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

patch from esteel that fixes the +/-button command descriptions (they all said button3)

------------------------------------------------------------------------
r6019 | havoc | 2006-02-23 08:19:09 -0800 (Thu, 23 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/netconn.c

fix rcon_password validation to refuse whitespace, and refuse empty passwords (as it was meant to do all along, but wasn't working properly)

------------------------------------------------------------------------
r6018 | havoc | 2006-02-23 08:04:24 -0800 (Thu, 23 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/sv_user.c

rearrange SV_VM_Begin/End again to fix crashes

------------------------------------------------------------------------
r6017 | havoc | 2006-02-23 06:50:41 -0800 (Thu, 23 Feb 2006) | 4 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/console.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/netconn.h
   M /trunk/darkplaces/sv_user.c

added qw compatible "rcon" support (allows a client who knows the server's rcon_password to run a command on the server), had to move NetConn_ServerFrame outside of the SV_VM_Begin block in Host_ServerFrame, and add relevant SV_VM_Begin blocks to various parts of host_cmd.c
added qw print command packet to client packet processing (needed for remote rcon when not connected to the server)
added qw "packet" command (sends a text message to the specified address)

------------------------------------------------------------------------
r6016 | havoc | 2006-02-23 03:08:14 -0800 (Thu, 23 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/collision.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/polygon.c
   M /trunk/darkplaces/polygon.h
   M /trunk/darkplaces/portals.c

changed Polygon[DF]_Divide functions to also be able to return an on-plane points count

------------------------------------------------------------------------
r6015 | havoc | 2006-02-23 02:57:31 -0800 (Thu, 23 Feb 2006) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/netconn.h
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c

merged NetConn_SendReliableMessage into NetConn_SendUnreliableMessage, and also merged away the other ReliableMessage functions (ReSend and Next)
rearranged client and server message sending calls to attempt to send unreliable messages, even if empty (necessary to trigger sending of reliable messages)
eliminated last remnants of NetConn_SendToAll stuff
changed some cls.demoplayback checks to !cls.netcon checks

------------------------------------------------------------------------
r6014 | havoc | 2006-02-23 02:47:09 -0800 (Thu, 23 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_user.c

make cl_movement handling a little more robust (hopefully)

------------------------------------------------------------------------
r6013 | havoc | 2006-02-23 02:34:56 -0800 (Thu, 23 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

changed r_speeds to only display timings with r_speeds 2, r_speeds 1 now only displays statistics (no glFinish needed so this is much faster)

------------------------------------------------------------------------
r6012 | havoc | 2006-02-22 21:47:53 -0800 (Wed, 22 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/sys_linux.c
   M /trunk/darkplaces/sys_sdl.c

another int cast for that patch

------------------------------------------------------------------------
r6011 | havoc | 2006-02-22 21:43:57 -0800 (Wed, 22 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/sys_linux.c
   M /trunk/darkplaces/sys_sdl.c

added int cast on write call in new terminal printing code, and added an include of io.h on windows

------------------------------------------------------------------------
r6010 | havoc | 2006-02-22 21:29:16 -0800 (Wed, 22 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c

removed runmove array in favor of using a private entity flag to prevent movement on the first physics frame an entity exists in, this makes projectiles fired by cl_movement 1 clients behave properly

------------------------------------------------------------------------
r6009 | havoc | 2006-02-22 21:26:53 -0800 (Wed, 22 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/progs.h

add the priv.server->move field needed by a previous commit

------------------------------------------------------------------------
r6006 | havoc | 2006-02-22 20:14:59 -0800 (Wed, 22 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

change unknown opcode error to a Con_DPrintf, this makes fteqcc fastarrays progs load

------------------------------------------------------------------------
r6005 | havoc | 2006-02-22 17:48:09 -0800 (Wed, 22 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/sys_linux.c
   M /trunk/darkplaces/sys_sdl.c

div0 fixed the bug that caused huge console prints to the terminal to be truncated, this bug has been bothering me for a long time, thanks div0!

------------------------------------------------------------------------
r6004 | havoc | 2006-02-22 15:18:12 -0800 (Wed, 22 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cmd.c

fix alias execution order bug introduced by Black on 20050705 (using Cbuf_AddText instead of Cbuf_InsertText for alias expansion is bad!)

------------------------------------------------------------------------
r6003 | havoc | 2006-02-22 04:12:24 -0800 (Wed, 22 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix decal draw order bug introduced in recent commit, I forgot that decals are not queued as transparencies like other particles, so calling R_DrawParticles before rtlights was a bad idea (as it made the rtlights be unaffected by decals)

------------------------------------------------------------------------
r6002 | havoc | 2006-02-22 02:02:25 -0800 (Wed, 22 Feb 2006) | 6 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h
   M /trunk/darkplaces/render.h

changed behavior of r_showtris (now only affects geometry in the game view, not sky, not hud, and not bloom)
added r_showtris_polygonoffset (doesn't seem to work, for unknown reasons)
renamed r_drawcollisionbrushes to r_showcollisionbrushes and got rid of its mode 2 behavior (which was trippy but not all that useful)
added r_showdisabledepthtest cvar which disables depth testing on the debugging geometry produced by r_show* cvars
renamed r_shadow_visiblelighting/volumes cvars to r_showlighting/shadowvolumes (and they no longer have a mode 2, use r_showdisabledepthtesting to get the same effect instead)

------------------------------------------------------------------------
r6001 | havoc | 2006-02-21 23:50:02 -0800 (Tue, 21 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/svvm_cmds.c

added NAN error checks to traceline and tracebox calls, these cause a PRVM_ERROR

------------------------------------------------------------------------
r6000 | havoc | 2006-02-21 23:46:31 -0800 (Tue, 21 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

made QC error() and objerror() builtins print the error string above and below the crash information, to be less confusing

------------------------------------------------------------------------
r5999 | molivier | 2006-02-20 15:33:24 -0800 (Mon, 20 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cd_shared.c
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_null.c
   M /trunk/darkplaces/sound.h

Added function S_IsSoundPrecached to the sound engine API. "snd_main.h" shouldn't be included outside of the sound engine.

------------------------------------------------------------------------
r5998 | molivier | 2006-02-20 15:28:52 -0800 (Mon, 20 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

Modified path for Transfusion gfx files

------------------------------------------------------------------------
r5997 | havoc | 2006-02-19 20:07:22 -0800 (Sun, 19 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/sv_user.c

fix player not being able to move bug introduced by recent input accumulation code

------------------------------------------------------------------------
r5996 | molivier | 2006-02-19 01:25:42 -0800 (Sun, 19 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c

Workaround for a bug in the Linux ATI proprietary driver; it does not put the current video mode in the first slot in the array returned by XF86VidModeGetAllModeLines, which can lead to a crash in VID_Shutdown. Also, fixed a small memory leak (the video mode array was never freed)

------------------------------------------------------------------------
r5995 | havoc | 2006-02-18 02:16:18 -0800 (Sat, 18 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_demo.c

call NetConn_UpdateSockets instead of NetConn_ClientFrame in playdemo code

------------------------------------------------------------------------
r5994 | havoc | 2006-02-17 21:20:04 -0800 (Fri, 17 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

Willis added a better fallback when the nexuiz menu qc fails to load

------------------------------------------------------------------------
r5993 | havoc | 2006-02-17 01:41:32 -0800 (Fri, 17 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c

fix crashes with NAN bounding boxes (collisions or dlights) recursing down the BSP tree, they still don't behave properly (because there is no proper handling of NAN), but at least they don't crash anymore

------------------------------------------------------------------------
r5992 | havoc | 2006-02-16 20:00:27 -0800 (Thu, 16 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

added an unstick function used on most entities if their movement trace indicates they started in solid, this should prevent items and gibs from falling out of levels 99% of the time

------------------------------------------------------------------------
r5991 | havoc | 2006-02-16 19:25:31 -0800 (Thu, 16 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_oss.c

changed tryrates array to include 48000, 24000, and 16000 speeds (this should help 48khz AC97 chips)

------------------------------------------------------------------------
r5990 | havoc | 2006-02-16 02:28:15 -0800 (Thu, 16 Feb 2006) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/host.c

reworked input timing a bit more, now cl_movement 1 mode syncs client packets to the incoming server packets (because the server does not trust the client's timing, only the history of server frames sent to the client, and thus the client has to sync exactly to the server timing to work)
moved CL_SendCmd() call into CL_ReadFromServer right after CL_ReadDemoMessage(), this fixes the prediction jitters that recently appeared with the cl_netinputpacketspersecond feature, however it might add a slight delay in local games (I haven't noticed a delay however)

------------------------------------------------------------------------
r5989 | havoc | 2006-02-15 23:24:09 -0800 (Wed, 15 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/sv_main.c

remove an unused extern for sys_ticrate, and added a comment warning about improper rate limiting if sys_ticrate is 0 (but it should never be 0 on a real server)

------------------------------------------------------------------------
r5988 | havoc | 2006-02-15 23:20:28 -0800 (Wed, 15 Feb 2006) | 3 lines
Changed paths:
   M /trunk/darkplaces/sv_user.c

fixed bug that allowed accidental speed cheating with cl_movement 1 mode (move->time was being cleared by ApplyClientMove, so when ReadClientMove calculated how much to move since the last move, it always thought the last move was at time == 0, and then it clamped this delta to 0.1 or less, which prevented it from being completely ridiculous, but still horrible)
added kicking of speed cheaters (if they echo a timestamp that has not yet been issued by the server, they're clearly lying)

------------------------------------------------------------------------
r5987 | havoc | 2006-02-15 14:29:50 -0800 (Wed, 15 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt

added a small how to install guide and a link to the Linux Quake Howto

------------------------------------------------------------------------
r5986 | havoc | 2006-02-14 22:04:51 -0800 (Tue, 14 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_user.c

also accumulate impulses when receiving multiple packets per server frame

------------------------------------------------------------------------
r5985 | havoc | 2006-02-14 19:14:42 -0800 (Tue, 14 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c

changed client input packets to be sent at a fixed 50fps (configurable by cvar) rather than in response to each server packet

------------------------------------------------------------------------
r5984 | havoc | 2006-02-14 19:09:37 -0800 (Tue, 14 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sv_user.c

improved server handling of multiple packets per client physics frame (as would be the case if the client sends more frames per second than the server sends to it)

------------------------------------------------------------------------
r5983 | havoc | 2006-02-14 18:54:14 -0800 (Tue, 14 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/protocol.c

fix very stupid bug that caused entities to sometimes not be removed (priority was not being updated when deltabits were added back to an entity, so the priority remained at the no-update-necessary level despite the fact it should be sent again)

------------------------------------------------------------------------
r5982 | havoc | 2006-02-14 15:39:23 -0800 (Tue, 14 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

fix a typo in vid_conwidth declaration

------------------------------------------------------------------------
r5981 | havoc | 2006-02-13 10:35:43 -0800 (Mon, 13 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.inc

added nexuiz-agl executable name so that mac nexuiz builds work

------------------------------------------------------------------------
r5980 | havoc | 2006-02-12 16:23:46 -0800 (Sun, 12 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

modified Host_ServerFrame to run multiple server frames again, but with a time limit of 0.05 seconds spent on server frames per call

------------------------------------------------------------------------
r5979 | havoc | 2006-02-12 13:03:32 -0800 (Sun, 12 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.inc

now make clean cleans up the nexuiz executables also

------------------------------------------------------------------------
r5978 | havoc | 2006-02-12 12:59:15 -0800 (Sun, 12 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_ogg.c

changed vorbis.dll and friends to use lib prefix (libvorbis.dll)

------------------------------------------------------------------------
r5977 | havoc | 2006-02-12 12:26:02 -0800 (Sun, 12 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/makefile.bsd
   M /trunk/darkplaces/makefile.inc
   A /trunk/darkplaces/nexuiz.ico
   A /trunk/darkplaces/nexuiz.rc

added nexuiz icon and make rules to make use of it, and now the icon is included in dedicated and sdl builds (not just native client builds)

------------------------------------------------------------------------
r5976 | havoc | 2006-02-12 11:44:39 -0800 (Sun, 12 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_user.c

fixed changelevel networking bug (now ignores clc_ackframe messages from clients who are not spawned, this prevents leftover entity acks from previous level from messing up netcode)

------------------------------------------------------------------------
r5975 | havoc | 2006-02-12 11:43:45 -0800 (Sun, 12 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

moved sendsignon = true back to where it was, as it is directly related to the message writing above it

------------------------------------------------------------------------
r5974 | havoc | 2006-02-12 10:22:42 -0800 (Sun, 12 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

fix uninitialized specularscale in R_Shadow_RenderSurfacesLighting

------------------------------------------------------------------------
r5973 | havoc | 2006-02-12 10:22:09 -0800 (Sun, 12 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c

fix uninitialized variables in InfoString_GetValue and InfoString_SetValue

------------------------------------------------------------------------
r5972 | havoc | 2006-02-12 10:21:16 -0800 (Sun, 12 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/netconn.h

renamed NetConn_UpdateServerStuff to NetConn_UpdateSockets and made it non-static, now called in CL_EstablishConnection so +connect on commandline works again

------------------------------------------------------------------------
r5970 | havoc | 2006-02-11 21:35:37 -0800 (Sat, 11 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

rollback recent network compression changes, it really does have to be reset on level change because the client expects it to be, another solution must be found

------------------------------------------------------------------------
r5969 | havoc | 2006-02-11 21:28:19 -0800 (Sat, 11 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c

fixed glsl colormapping brightness bug when using colormod

------------------------------------------------------------------------
r5968 | havoc | 2006-02-11 21:12:37 -0800 (Sat, 11 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

a fix for the previous fix (don't reset host_client->latestframenum on level change)

------------------------------------------------------------------------
r5967 | havoc | 2006-02-11 19:28:52 -0800 (Sat, 11 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

GAME_NEXUIZ scoreboard team color names patch from KadaverJack

------------------------------------------------------------------------
r5966 | havoc | 2006-02-11 18:55:42 -0800 (Sat, 11 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

fix problems with changelevel causing network compression to stop working (bug introduced when SV_SendReconnect was rewritten quite some time ago), this was happening because the compression database was being freed on level change and reallocated, and thus producing older entity frame numbers that the client refused

------------------------------------------------------------------------
r5964 | havoc | 2006-02-11 16:35:46 -0800 (Sat, 11 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/protocol.h

removed EntityFrame5_ResetDatabase because it was only used in EntityFrame5_AllocDatabase

------------------------------------------------------------------------
r5963 | havoc | 2006-02-11 14:49:59 -0800 (Sat, 11 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

fix a crash in SV_ConnectClient on bots

------------------------------------------------------------------------
r5962 | havoc | 2006-02-10 20:24:19 -0800 (Fri, 10 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_demo.c
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/netconn.h
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/sv_main.c

removed crash parameter from Host_ShudownServer, eliminated NetConn_SendToAll and SV_SendReconnect

------------------------------------------------------------------------
r5961 | havoc | 2006-02-10 20:21:51 -0800 (Fri, 10 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

minor cleanup of keepalive

------------------------------------------------------------------------
r5960 | havoc | 2006-02-10 18:33:30 -0800 (Fri, 10 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/netconn.h
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/svvm_cmds.c

migrated cls.message and client->message buffers into netconn_t struct

------------------------------------------------------------------------
r5959 | havoc | 2006-02-10 10:44:19 -0800 (Fri, 10 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/quakedef.h

added a comment by MAX_LIGHTSTYLES about savegames

------------------------------------------------------------------------
r5958 | havoc | 2006-02-09 05:52:17 -0800 (Thu, 09 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

added diffuse texture alpha support to GLSL shader (dot3 and vertex still need updating)

------------------------------------------------------------------------
r5957 | havoc | 2006-02-08 08:49:07 -0800 (Wed, 08 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_shadow.c

fixed bugs concerning rtlighting of transparent entities

------------------------------------------------------------------------
r5956 | havoc | 2006-02-08 08:13:59 -0800 (Wed, 08 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

two more 4x3 modes

------------------------------------------------------------------------
r5951 | havoc | 2006-02-07 07:39:51 -0800 (Tue, 07 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/clvm_cmds.c

changed two MAX_LIGHTSTYLE references to cl_max_lightstyle

------------------------------------------------------------------------
r5950 | havoc | 2006-02-07 07:36:56 -0800 (Tue, 07 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

fixed loadgame to support stock quake savegames (which have 64 lightstyles, darkplaces savegames have 256)

------------------------------------------------------------------------
r5949 | havoc | 2006-02-07 07:08:16 -0800 (Tue, 07 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

made MAX_LIGHTSTYLES error into a warning and it now checks cl_max_lightstyle instead

------------------------------------------------------------------------
r5948 | havoc | 2006-02-07 07:07:40 -0800 (Tue, 07 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/client.h

added externs for more of the cl_max_ variables

------------------------------------------------------------------------
r5944 | black | 2006-02-05 05:44:27 -0800 (Sun, 05 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cmd.c

Fix it the right way (and also remove another bug this way).

------------------------------------------------------------------------
r5943 | havoc | 2006-02-04 21:17:54 -0800 (Sat, 04 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cmd.c

crash fix for use of $*/$0-9 when not in an alias, patch from KadaverJack

------------------------------------------------------------------------
r5941 | havoc | 2006-02-04 06:09:38 -0800 (Sat, 04 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

added 1280x800 resolution (2560x1600 already existed)

------------------------------------------------------------------------
r5940 | havoc | 2006-02-02 21:14:24 -0800 (Thu, 02 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c

two int casts that were missing, reported by Willis

------------------------------------------------------------------------
r5939 | havoc | 2006-02-02 06:57:04 -0800 (Thu, 02 Feb 2006) | 4 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

vertex lighting path now does pants/shirt rendering faster than before
doubled brightness of vertex lighting path to make it look roughly like the other paths (unsure why it was darker however)
optimized lighting code setup a bit (less silly conditional returns)

------------------------------------------------------------------------
r5938 | havoc | 2006-02-02 05:52:00 -0800 (Thu, 02 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

fix a bug in the GLSL colormapping setup (was feeding a tinted pants/shirt color, should feed the raw colormap colors, because the shader is doing a multiply by light color on all of this)

------------------------------------------------------------------------
r5937 | havoc | 2006-02-02 05:44:20 -0800 (Thu, 02 Feb 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

split R_Shadow_RenderSurfacesLighting_Light_Dot3 into 3 subfunctions for different kinds of pass, and used these to do pants and shirt a little faster

------------------------------------------------------------------------
r5936 | havoc | 2006-02-02 05:13:36 -0800 (Thu, 02 Feb 2006) | 3 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

added pants/shirt layer rendering to GLSL shader, rather than calling it three times like before (which was very slow)
migrated GLSL light shader permutation selection (and correspondingly all parameter setup) into R_Shadow_RenderSurfacesLighting_Light_GLSL, this causes more setup overhead but allows specific optimization of non-colormapping and non-specular surfaces so this should be a speed gain overall

------------------------------------------------------------------------
r5935 | havoc | 2006-02-01 07:51:37 -0800 (Wed, 01 Feb 2006) | 3 lines
Changed paths:
   M /trunk/darkplaces/cvar.c

fix crash in Cvar_CompleteCvarPrint
added description printing to cvarlist

------------------------------------------------------------------------
r5934 | havoc | 2006-02-01 07:11:46 -0800 (Wed, 01 Feb 2006) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c

changed renderer to check ent->colormap_pantscolor and ent->colormap_shirtcolor instead of ent->colormap to detect whether to use colormapping on a model, this should reduce chance of bugs in lighting code
also optimized the R_Shadow_RenderSurfacesLighting function a bit to have separate handling of colormapped and non-colormapped surfaces (probably a small speed gain, and reduces chance of bugs in lighting code)

------------------------------------------------------------------------
r5933 | havoc | 2006-02-01 05:21:06 -0800 (Wed, 01 Feb 2006) | 4 lines
Changed paths:
   M /trunk/darkplaces/cd_sdl.c
   M /trunk/darkplaces/cd_shared.c
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/cmd.h
   M /trunk/darkplaces/collision.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/cvar.c
   M /trunk/darkplaces/cvar.h
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/meshqueue.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_sprite.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/r_crosshairs.c
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_lightning.c
   M /trunk/darkplaces/r_modules.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/sbar.c
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_null.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sv_user.c
   M /trunk/darkplaces/svvm_cmds.c
   M /trunk/darkplaces/sys_linux.c
   M /trunk/darkplaces/sys_win.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c
   M /trunk/darkplaces/view.c
   M /trunk/darkplaces/world.c
   M /trunk/darkplaces/world_cs.c
   M /trunk/darkplaces/zone.c

added description string to all cvars and commands
modified tab completion to print description by each cvar, instead of just printing names
refactored tab completion code

------------------------------------------------------------------------
r5927 | havoc | 2006-01-30 05:34:01 -0800 (Mon, 30 Jan 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c

disable hardware gamma if XF86VidModeGetGammaRampSize reports a size other than 256, for instance 1024 on Quadro

------------------------------------------------------------------------
r5926 | havoc | 2006-01-30 05:03:47 -0800 (Mon, 30 Jan 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c

sound direction fix (negated yaw angle), submitted by div0

------------------------------------------------------------------------
r5925 | havoc | 2006-01-30 05:01:34 -0800 (Mon, 30 Jan 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_sdl.c

patch from div0 to add -sndmono and -sndstereo options to sdl sound code

------------------------------------------------------------------------
r5924 | havoc | 2006-01-30 04:59:27 -0800 (Mon, 30 Jan 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c

fix for segfault in map name completion, submitted by div0

------------------------------------------------------------------------
r5923 | havoc | 2006-01-23 13:34:22 -0800 (Mon, 23 Jan 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/world.c

fix a typo, and apparently this isn't the cause of the nexuiz CTF bug

------------------------------------------------------------------------
r5922 | havoc | 2006-01-23 13:14:04 -0800 (Mon, 23 Jan 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/world.c

fixed SOLID_NOT relink touching triggers bug (which was causing CTF flags to be repeatedly captured in Nexuiz)

------------------------------------------------------------------------
r5921 | molivier | 2006-01-21 02:19:00 -0800 (Sat, 21 Jan 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces-dedicated.dsp
   M /trunk/darkplaces/darkplaces-sdl.dsp
   M /trunk/darkplaces/darkplaces.dsp

Updated DSP files from Willis

------------------------------------------------------------------------
r5920 | molivier | 2006-01-21 01:59:11 -0800 (Sat, 21 Jan 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/csprogs.c
   M /trunk/darkplaces/image_png.c
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/prvm_cmds.c

A few casts and variable type changes to get rid of warnings on Win64. By Willis

------------------------------------------------------------------------
r5919 | molivier | 2006-01-21 01:40:54 -0800 (Sat, 21 Jan 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

Moved a couple of extern declarations outside of the body of their functions (fixes compilation on MSVC6). By Willis

------------------------------------------------------------------------
r5918 | molivier | 2006-01-21 01:13:48 -0800 (Sat, 21 Jan 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/image_png.c

Added the proper libPNG DLL name for Win64, by Willis

------------------------------------------------------------------------
r5917 | molivier | 2006-01-21 01:10:39 -0800 (Sat, 21 Jan 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_sdl.c

Fix for Win64, by Willis

------------------------------------------------------------------------
r5916 | molivier | 2006-01-21 00:50:36 -0800 (Sat, 21 Jan 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

Fixed drawmask for non-csqc mods. Thanks to Willis for spotting this bug

------------------------------------------------------------------------
r5915 | havoc | 2006-01-17 12:48:39 -0800 (Tue, 17 Jan 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_wgl.c

changed newmouseparms to 0 0 0, in hopes of avoiding the winxp mouse acceleration bug

------------------------------------------------------------------------
r5914 | havoc | 2006-01-16 14:51:43 -0800 (Mon, 16 Jan 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/image_png.c

changed mac libpng12.dylib to libpng12.0.dylib

------------------------------------------------------------------------
r5913 | havoc | 2006-01-16 11:11:34 -0800 (Mon, 16 Jan 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_null.c

added S_FindName function to make dedicated server compile again

------------------------------------------------------------------------
r5911 | havoc | 2006-01-15 19:53:36 -0800 (Sun, 15 Jan 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/svvm_cmds.c

disable EXT_CSQC extension name for now

------------------------------------------------------------------------
r5910 | havoc | 2006-01-15 19:52:42 -0800 (Sun, 15 Jan 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/cl_collision.h
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/cl_screen.h
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clprogdefs.h
   A /trunk/darkplaces/clvm_cmds.c
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/console.c
   A /trunk/darkplaces/csprogs.c
   A /trunk/darkplaces/csprogs.h
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/makefile.inc
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.h
   M /trunk/darkplaces/sbar.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/svvm_cmds.c
   M /trunk/darkplaces/vid_wgl.c
   M /trunk/darkplaces/view.c
   A /trunk/darkplaces/world_cs.c

csqc patch from [515], seems to work with [515]'s dpcsqc test mod, needs a lot of code cleanup/merging, and VF_FOV stuff is currently ignored

------------------------------------------------------------------------
r5909 | havoc | 2006-01-15 13:02:25 -0800 (Sun, 15 Jan 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/image_png.c

changed line endings from DOS to unix

------------------------------------------------------------------------
r5908 | havoc | 2006-01-15 12:20:51 -0800 (Sun, 15 Jan 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/image.c
   A /trunk/darkplaces/image_png.c
   A /trunk/darkplaces/image_png.h
   M /trunk/darkplaces/makefile.inc

added png support patch from [515] (had to rewrite most of it though)

------------------------------------------------------------------------
r5907 | havoc | 2006-01-15 08:51:37 -0800 (Sun, 15 Jan 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

added 1440x900 and 720x450 resolutions

------------------------------------------------------------------------
r5906 | havoc | 2006-01-14 09:45:35 -0800 (Sat, 14 Jan 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/svvm_cmds.c

added DP_EF_DOUBLESIDED extension to list

------------------------------------------------------------------------
r5903 | havoc | 2006-01-14 09:40:50 -0800 (Sat, 14 Jan 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/svvm_cmds.c

added DP_SV_CUSTOMIZEENTITYFORCLIENT extension based on a patch from [515]

------------------------------------------------------------------------
r5902 | havoc | 2006-01-12 07:19:22 -0800 (Thu, 12 Jan 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/keys.c

corrected a typo in a comment

------------------------------------------------------------------------
r5901 | havoc | 2006-01-12 07:17:12 -0800 (Thu, 12 Jan 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/keys.c

added console editing enhancements patch from [515], except the part for special quake characters was omitted (as the engine should not assume the quake font is being used)

------------------------------------------------------------------------
r5900 | havoc | 2006-01-11 15:15:12 -0800 (Wed, 11 Jan 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/cl_screen.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/vid_shared.c

added DrawQ_Line/DrawQ_Lines/DrawQ_LineWidth patch from [515], note: buggy, needs cleanup

------------------------------------------------------------------------
r5899 | havoc | 2006-01-11 14:24:05 -0800 (Wed, 11 Jan 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c

added con_textsize patch from [515]

------------------------------------------------------------------------
r5898 | havoc | 2006-01-11 10:53:22 -0800 (Wed, 11 Jan 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

added r_replacemaptexture and r_listmaptextures commands patch from [515]

------------------------------------------------------------------------
r5897 | havoc | 2006-01-11 08:17:29 -0800 (Wed, 11 Jan 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/console.h

added tab-completion of map/changelevel command + maps command patch from [515], which prints map names, titles, and format (Q1/Q2/Q3/HL/MC/??)

------------------------------------------------------------------------
r5896 | havoc | 2006-01-11 06:41:42 -0800 (Wed, 11 Jan 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

added sendcvar patch from [515]

------------------------------------------------------------------------
r5895 | havoc | 2006-01-10 13:16:49 -0800 (Tue, 10 Jan 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/bspfile.h

added a warning comment about dmodel_t not matching the on-disk q1bsp format because of Sajt's MCBSP code (this does no harm because the reading code does not utilize dmodel_t in reading those structs, but it is a potential land mine to people looking at the header to study the format)

------------------------------------------------------------------------
r5894 | havoc | 2006-01-10 13:14:06 -0800 (Tue, 10 Jan 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.h

correct q2dheader_t and q3dheader_t to have the correct lump array sizes

------------------------------------------------------------------------
r5893 | havoc | 2006-01-10 06:52:21 -0800 (Tue, 10 Jan 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

added rain splash code written by [515], and made the splash sparks a bit wider so that they are noticable

------------------------------------------------------------------------
r5892 | havoc | 2006-01-10 06:35:45 -0800 (Tue, 10 Jan 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/r_shadow.c

added EF_DOUBLESIDED (and internally RENDER_NOCULLFACE)

------------------------------------------------------------------------
r5891 | havoc | 2006-01-10 06:11:51 -0800 (Tue, 10 Jan 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_user.c

added button9-16

------------------------------------------------------------------------
r5889 | havoc | 2006-01-08 12:10:01 -0800 (Sun, 08 Jan 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/svvm_cmds.c

redesigned the heart of SV_GetTagMatrix, it now makes sense

------------------------------------------------------------------------
r5887 | havoc | 2006-01-01 07:10:01 -0800 (Sun, 01 Jan 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_sprite.c

fix sp2 frame positioning

------------------------------------------------------------------------
r5886 | havoc | 2006-01-01 05:21:55 -0800 (Sun, 01 Jan 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_sdl.c

changed mouse button numbering to have MWHEELUP/MWHEELDOWN and then 4 5...

------------------------------------------------------------------------
r5885 | havoc | 2006-01-01 05:15:27 -0800 (Sun, 01 Jan 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/prvm_edict.c

added developer_entityparsing cvar to aid in debugging entitystring parsing issues (which always seem to turn out to be map bugs, but it's useful to know what the bug in the map is)

------------------------------------------------------------------------
r5884 | havoc | 2006-01-01 05:12:31 -0800 (Sun, 01 Jan 2006) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

hide GLSL compile warnings when developer is 0

------------------------------------------------------------------------
r5883 | havoc | 2005-12-31 23:51:57 -0800 (Sat, 31 Dec 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

make compile again, stupid typos

------------------------------------------------------------------------
r5882 | havoc | 2005-12-31 23:46:47 -0800 (Sat, 31 Dec 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

corrected some function names in error messages

------------------------------------------------------------------------
r5881 | havoc | 2005-12-31 23:46:13 -0800 (Sat, 31 Dec 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

added vertex bounds checking in Mod_Q1BSP_LoadEdges

------------------------------------------------------------------------
r5880 | havoc | 2005-12-30 03:14:05 -0800 (Fri, 30 Dec 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

disabled running of multiple server frames per host frame, because it does not handle overload gracefully (instead it makes the framerate significantly worse if the server frame is the bottleneck)

------------------------------------------------------------------------
r5879 | havoc | 2005-12-30 00:27:40 -0800 (Fri, 30 Dec 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/svvm_cmds.c

refactored gettaginfo in an attempt to improve readability, and fixed scaling bug

------------------------------------------------------------------------
r5874 | havoc | 2005-12-29 00:43:50 -0800 (Thu, 29 Dec 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/palette.c

eliminated special case for gamma 1.0 as it was making worse gamma ramps than the general case, and tweaked the code a bit to round to nearest so it should hit exactly 65535

------------------------------------------------------------------------
r5873 | molivier | 2005-12-28 06:56:02 -0800 (Wed, 28 Dec 2005) | 2 lines
Changed paths:
   D /trunk/darkplaces/pr_cmds.c
   D /trunk/darkplaces/pr_edict.c
   D /trunk/darkplaces/pr_exec.c
   D /trunk/darkplaces/pr_execprogram.h

Removed unused files

------------------------------------------------------------------------
r5872 | molivier | 2005-12-28 05:26:28 -0800 (Wed, 28 Dec 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_agl.c

Added support for refresh rate, vsync, and hardware gamma to Mac OS X native video module. Still working on the hardware gamma though, it looks a bit broken (colors are weird with gamma = 1)

------------------------------------------------------------------------
r5871 | havoc | 2005-12-27 02:10:55 -0800 (Tue, 27 Dec 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/meshqueue.c
   M /trunk/darkplaces/meshqueue.h
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_lightning.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h
   M /trunk/darkplaces/r_sprites.c

reworked rtlighting code to handle transparent water lighting and transparent model lighting (doesn't properly handle alpha textures though)

------------------------------------------------------------------------
r5870 | havoc | 2005-12-27 01:56:31 -0800 (Tue, 27 Dec 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

changed basedir and gamedir handling slightly to eliminate the need for "./" paths

------------------------------------------------------------------------
r5869 | molivier | 2005-12-26 23:53:53 -0800 (Mon, 26 Dec 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_coreaudio.c

Fixed CoreAudio sound module

------------------------------------------------------------------------
r5868 | havoc | 2005-12-26 20:54:40 -0800 (Mon, 26 Dec 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

esteel's patch used C99 lazy variable declaration, fixed

------------------------------------------------------------------------
r5867 | havoc | 2005-12-26 20:12:47 -0800 (Mon, 26 Dec 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c

remove an unused variable

------------------------------------------------------------------------
r5866 | havoc | 2005-12-26 18:43:33 -0800 (Mon, 26 Dec 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

fix sprite transparency bug introduced by the palette changes

------------------------------------------------------------------------
r5865 | havoc | 2005-12-26 18:29:40 -0800 (Mon, 26 Dec 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/palette.c
   M /trunk/darkplaces/palette.h

reworked transparency in palettes, made palette_complete be strictly opaque, added palette_transparent (and switched a few things over to it), made palette_font actually be used (and it no longer has a transparent color 255, only color 0 is transparent in the font, correctly matching software quake), this should hopefully fix bugs with models using color 255 in their skin

------------------------------------------------------------------------
r5864 | havoc | 2005-12-26 18:22:56 -0800 (Mon, 26 Dec 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_sprite.c

changed a palette_complete, palette_alpha reference to NULL, NULL in sprite loading

------------------------------------------------------------------------
r5863 | havoc | 2005-12-26 18:18:35 -0800 (Mon, 26 Dec 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

removed a duplicate ;

------------------------------------------------------------------------
r5860 | havoc | 2005-12-25 17:16:44 -0800 (Sun, 25 Dec 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

nexuiz team scoreboard patch from esteel

------------------------------------------------------------------------
r5859 | havoc | 2005-12-16 19:43:57 -0800 (Fri, 16 Dec 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

changed Venim's dpmaster back to an IP

------------------------------------------------------------------------
r5858 | havoc | 2005-12-16 18:04:53 -0800 (Fri, 16 Dec 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

added tChr's master server, changed Venim's back to a hostname as it seems to resolve now, and noted admin of each master server

------------------------------------------------------------------------
r5857 | havoc | 2005-12-14 05:47:13 -0800 (Wed, 14 Dec 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

default r_useportalculling to 1, I don't know why it was off

------------------------------------------------------------------------
r5856 | black | 2005-12-05 11:36:32 -0800 (Mon, 05 Dec 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

Erm, remove the paramcount check from localcmd, so that it actually works
with an arbitrary number of params.

------------------------------------------------------------------------
r5855 | havoc | 2005-11-30 07:10:07 -0800 (Wed, 30 Nov 2005) | 6 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/cl_screen.h
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/view.c

video modes in menu now also set vid_pixelheight and vid_conwidth/vid_conheight
improved video modes menu, it now has widescreen modes, refresh rate, and more information about the chosen mode
renamed vid_pixelaspect to vid_pixelheight and inverted its behavior (smaller value now means that a pixel is wider than it is tall)
eliminated r_refdef.fov* fields, redesigned to use frustum plane slopes (like glFrustum takes) and calculate fov from height*4/3 rather than width, so widescreen now automatically uses higher fov accordingly, but 4x3 modes are the same as they always were, this also required generating the frustum planes differently in the renderer
changed underwater view warping to use frustum scaling rather than angles, this makes it a little smoother

------------------------------------------------------------------------
r5854 | havoc | 2005-11-30 07:03:08 -0800 (Wed, 30 Nov 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_agl.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_null.c
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c

implemented vid_refreshrate cvar to specify display refresh rate in windows
added vid_minwidth/vid_minheight for use by menu, this lets a mod specify minimum acceptable resolution

------------------------------------------------------------------------
r5853 | havoc | 2005-11-29 04:24:24 -0800 (Tue, 29 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

409

------------------------------------------------------------------------
r5852 | havoc | 2005-11-29 04:14:23 -0800 (Tue, 29 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

smoke trails are now half as bright, bullet impact sparks now fly upward a little bit at first (looks better when shooting the floor)

------------------------------------------------------------------------
r5851 | havoc | 2005-11-29 03:58:59 -0800 (Tue, 29 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/menu.c

implemented cl_particles_quake cvar to use quake-style particle effects

------------------------------------------------------------------------
r5850 | havoc | 2005-11-29 03:57:19 -0800 (Tue, 29 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

disabled dlight from scrag and hellknight shots

------------------------------------------------------------------------
r5849 | havoc | 2005-11-28 16:20:03 -0800 (Mon, 28 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c

removed headphones stuff, now stereo is side speakers (like headphones was) because it was too hard to hear things behind you with only front speakers, added mono speaker layout also

------------------------------------------------------------------------
r5848 | havoc | 2005-11-27 23:46:39 -0800 (Sun, 27 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/keys.h
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_wgl.c

fixed keynum_t issue, it was declared as an extern variable (?!?) in the header, should have been a typedef

------------------------------------------------------------------------
r5847 | havoc | 2005-11-27 23:45:07 -0800 (Sun, 27 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_wgl.c

changed buttonremap arrays to int instead of keynum_t because keynum_t is not being found for some bizarre reason no matter what I do

------------------------------------------------------------------------
r5846 | havoc | 2005-11-27 21:54:20 -0800 (Sun, 27 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/keys.h
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_wgl.c

made K_MOUSE4/5 keys separate from K_MWHEELUP/DOWN keys

------------------------------------------------------------------------
r5845 | havoc | 2005-11-27 20:51:59 -0800 (Sun, 27 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

fix a typo

------------------------------------------------------------------------
r5844 | havoc | 2005-11-27 16:59:01 -0800 (Sun, 27 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

added scr_screenshot_gamma to menu (I'm sure I did this once before!)

------------------------------------------------------------------------
r5843 | havoc | 2005-11-27 00:29:37 -0800 (Sun, 27 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

416

------------------------------------------------------------------------
r5842 | havoc | 2005-11-26 16:24:44 -0800 (Sat, 26 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_alsa.c
   M /trunk/darkplaces/snd_bsd.c
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_oss.c

eliminated snd_inited and sound_started variables, now uses shm != NULL checks instead

------------------------------------------------------------------------
r5841 | havoc | 2005-11-26 16:22:04 -0800 (Sat, 26 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt

added minor documentation about logging features

------------------------------------------------------------------------
r5840 | havoc | 2005-11-26 14:41:58 -0800 (Sat, 26 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_mix.c

remove a piece of breakpoint code I forgot to remove before

------------------------------------------------------------------------
r5839 | havoc | 2005-11-26 00:05:32 -0800 (Sat, 26 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

fix a typo in r_speeds display that incorrectly displayed dynamic shadow triangles

------------------------------------------------------------------------
r5838 | havoc | 2005-11-25 15:03:31 -0800 (Fri, 25 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_mix.c

fix a sound conversion bug in mono output

------------------------------------------------------------------------
r5837 | havoc | 2005-11-25 15:00:30 -0800 (Fri, 25 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

fix a warning

------------------------------------------------------------------------
r5836 | havoc | 2005-11-25 00:23:36 -0800 (Fri, 25 Nov 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/image.h
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/model_sprite.c
   M /trunk/darkplaces/model_sprite.h
   M /trunk/darkplaces/r_sprites.c

sprites now use skinframe_t instead of their own texture/fogtexture fields
cleaned up hlbsp texture loading slightly, now uses Mod_LoadSkinFrame_Internal

------------------------------------------------------------------------
r5835 | havoc | 2005-11-24 23:29:35 -0800 (Thu, 24 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_sprite.c

don't load images when running a dedicated server (they would only be discarded by the missing texture manager anyway)

------------------------------------------------------------------------
r5834 | havoc | 2005-11-24 23:11:34 -0800 (Thu, 24 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/meshqueue.c

dynamically scale the meshqueue transparency sorting distances to adapt the precision to larger/smaller scenes

------------------------------------------------------------------------
r5833 | havoc | 2005-11-24 22:55:40 -0800 (Thu, 24 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/svvm_cmds.c

changed strzone, stuffcmd, and localcmd to be able to take multiple strings

------------------------------------------------------------------------
r5832 | havoc | 2005-11-24 22:14:05 -0800 (Thu, 24 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

ping command now works from server console

------------------------------------------------------------------------
r5830 | havoc | 2005-11-24 21:24:25 -0800 (Thu, 24 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/sv_main.c

cleaned up edict clearing when connecting or coming back from a level change, this fixes the botclient bugs regarding .colormap, but also meant that NetConn_ServerFrame requires SV_VM_Begin/End around it

------------------------------------------------------------------------
r5829 | havoc | 2005-11-24 19:24:59 -0800 (Thu, 24 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

added support for model scaling in bounding box calculations for network culling, so now entities can be made bigger and won't disappear incorrectly

------------------------------------------------------------------------
r5828 | havoc | 2005-11-24 17:34:12 -0800 (Thu, 24 Nov 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/world.c

SOLID_NOT is now linked into the areagrid, which fixed the bugs with corpses not riding lifts, and also means that findradius will find SOLID_NOT entities more often like the sv_gameplayfix_blowupfallenzombies was intended to
reorganized and optimized the TOSS/FLY/BOUNCE/STEP physics for better handling of sv_gameplayfix_noairborncorpse

------------------------------------------------------------------------
r5827 | havoc | 2005-11-24 17:31:18 -0800 (Thu, 24 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

changed serverlist to using color tags instead of shifting the numbers to different charsets in the quake font

------------------------------------------------------------------------
r5826 | havoc | 2005-11-24 17:29:59 -0800 (Thu, 24 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

changed serverlist menu to use color tags instead of shifting the numbers to different character sets in the quake font

------------------------------------------------------------------------
r5825 | havoc | 2005-11-24 17:17:43 -0800 (Thu, 24 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_agl.c
   M /trunk/darkplaces/vid_glx.c

allow typing characters above 126

------------------------------------------------------------------------
r5824 | havoc | 2005-11-24 17:16:07 -0800 (Thu, 24 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c

use color tags for chat messages instead of 0x80 masking

------------------------------------------------------------------------
r5823 | havoc | 2005-11-24 17:12:00 -0800 (Thu, 24 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c

fixed up various bugs with cl_beams_relative, and reenabled smooth sweeping on other players/enemies

------------------------------------------------------------------------
r5822 | havoc | 2005-11-23 10:41:13 -0800 (Wed, 23 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

changed default bloom settings to faster performing and less overkill values

------------------------------------------------------------------------
r5821 | havoc | 2005-11-22 19:40:59 -0800 (Tue, 22 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

added a remaining < 1 check to centerprint display code, this might have fixed the problem where it briefly showed the full text at the beginning of a finale

------------------------------------------------------------------------
r5820 | havoc | 2005-11-22 19:33:20 -0800 (Tue, 22 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_crosshairs.c

fix bugs with crosshair_static 0 mode when the player is an EF_NODRAW entity

------------------------------------------------------------------------
r5819 | havoc | 2005-11-22 19:28:28 -0800 (Tue, 22 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_particles.c

removing uses of entity_render_t->origin in the client

------------------------------------------------------------------------
r5818 | havoc | 2005-11-22 19:00:34 -0800 (Tue, 22 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_alsa.c
   M /trunk/darkplaces/snd_bsd.c
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_main.h
   M /trunk/darkplaces/snd_mix.c
   M /trunk/darkplaces/snd_oss.c
   M /trunk/darkplaces/snd_sdl.c
   M /trunk/darkplaces/snd_win.c

implemented 7.1 audio, only works with SDL (attempted ALSA support but ALSA doesn't seem to like mmap access to 4/6/8 channel buffers)

------------------------------------------------------------------------
r5817 | havoc | 2005-11-22 18:59:05 -0800 (Tue, 22 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r5816 | havoc | 2005-11-22 18:54:50 -0800 (Tue, 22 Nov 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_demo.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/cvar.c
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/keys.h
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/sys_linux.c
   M /trunk/darkplaces/sys_sdl.c
   M /trunk/darkplaces/sys_win.c

cleaned up many text buffer sizes throughout the engine, most now use MAX_INPUTLINE, some use MAX_QPATH, also cleaned up a lot of stuff that had buffer sizes in the code (now uses sizeof)
increased MAX_INPUTLINE from 256 to 16384, so now console commandlines and many other things can be very large

------------------------------------------------------------------------
r5815 | havoc | 2005-11-21 16:55:26 -0800 (Mon, 21 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_shadow.c

fixed backwards q3bsp model lighting and backwards rtlighting

------------------------------------------------------------------------
r5814 | havoc | 2005-11-21 16:40:00 -0800 (Mon, 21 Nov 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_shared.c

added r_shownormals
fixed Mod_BumpVectors to generate normals the correct way...  now all rtlighting and q3bsp vertex shading is backwards :(

------------------------------------------------------------------------
r5813 | havoc | 2005-11-21 10:14:56 -0800 (Mon, 21 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

clear the client->weaponmodel cache on level change

------------------------------------------------------------------------
r5812 | molivier | 2005-11-20 07:14:10 -0800 (Sun, 20 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_agl.c

Fixed black screen when using fullscreen mode on Mac OS X

------------------------------------------------------------------------
r5811 | havoc | 2005-11-19 04:45:01 -0800 (Sat, 19 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

disable sbar in GAME_NETHERWORLD (it draws it using qc)

------------------------------------------------------------------------
r5810 | havoc | 2005-11-17 07:17:14 -0800 (Thu, 17 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/r_textures.h
   M /trunk/darkplaces/vid_shared.c

made gl_max_size cvar only affect TEXF_PICMIP textures, this prevents it from breaking bloom like it did previously, and bloom now disables itself if the hardware doesn't support big enough textures (such as 3Dfx Voodoo1/2/3/Rush/Banshee)

------------------------------------------------------------------------
r5809 | havoc | 2005-11-13 04:10:08 -0800 (Sun, 13 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/lhnet.c

changed DNS name cache expiration time to 12 hours

------------------------------------------------------------------------
r5808 | havoc | 2005-11-13 04:08:35 -0800 (Sun, 13 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

corrected dpmaster.deathmask.net IP address comment again

------------------------------------------------------------------------
r5807 | havoc | 2005-11-13 04:05:24 -0800 (Sun, 13 Nov 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/matrixlib.c
   M /trunk/darkplaces/matrixlib.h

added Matrix4x4_Normalize
now normalizes dlight matrix so that attached dlight entities won't be smaller/bigger than normal

------------------------------------------------------------------------
r5806 | havoc | 2005-11-13 04:04:28 -0800 (Sun, 13 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/lhnet.c

expire internal DNS name cache entries after 5 minutes (this way a master server can change IP address)

------------------------------------------------------------------------
r5805 | havoc | 2005-11-13 03:59:31 -0800 (Sun, 13 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

updated ip address comment for dpmaster.deathmask.net

------------------------------------------------------------------------
r5804 | havoc | 2005-11-11 04:47:09 -0800 (Fri, 11 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c

increased max cachepics from 256 to 1024 at VorteX's request

------------------------------------------------------------------------
r5803 | havoc | 2005-11-09 23:03:40 -0800 (Wed, 09 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

condensed CL_EntityParticles code

------------------------------------------------------------------------
r5802 | black | 2005-11-08 08:49:35 -0800 (Tue, 08 Nov 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/cmd.c

Moved the cmd preprocessor call from ExecuteString to Cbuf_Execute which
should fix the messagemode issue.

------------------------------------------------------------------------
r5801 | havoc | 2005-11-07 04:37:15 -0800 (Mon, 07 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/collision.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_sprite.c
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/pr_exec.c
   M /trunk/darkplaces/pr_execprogram.h
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/prvm_exec.c
   M /trunk/darkplaces/prvm_execprogram.h
   M /trunk/darkplaces/r_modules.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/svvm_cmds.c
   M /trunk/darkplaces/vid_agl.c
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c

removed \n from all Host_Error, Sys_Error, PRVM_ERROR, PF_ERROR calls, since Host_Error/Sys_Error add their own \n as needed

------------------------------------------------------------------------
r5800 | havoc | 2005-11-07 03:08:12 -0800 (Mon, 07 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/cvar.c
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_mem.c
   M /trunk/darkplaces/snd_wav.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/svvm_cmds.c
   M /trunk/darkplaces/sys_linux.c
   M /trunk/darkplaces/sys_win.c
   M /trunk/darkplaces/vid_glx.c

cleaned up all Con_Printf calls that were missing a \n

------------------------------------------------------------------------
r5799 | havoc | 2005-11-07 01:52:57 -0800 (Mon, 07 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/palette.c

fix a bug in loading colormap.lmp to determine number of fullbrights, forgot to pass &filesize to FS_LoadFile

------------------------------------------------------------------------
r5798 | havoc | 2005-11-07 01:44:12 -0800 (Mon, 07 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

fixed a bug in the r_lockpvs cvar silently added in the last commit (r_lockvisibility cvar also added in the last commit)

------------------------------------------------------------------------
r5797 | havoc | 2005-11-07 01:41:51 -0800 (Mon, 07 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_light.c

got rid of unused r_vismarklights cvar

------------------------------------------------------------------------
r5796 | havoc | 2005-11-07 01:35:58 -0800 (Mon, 07 Nov 2005) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

cleaned up R_WorldVisibility code some more and added additional documentation
renamed r_surfaceworldnode to r_useportalculling and inverted its behavior accordingly
added a special no-pvs-at-all case for floating around in the void to improve readability

------------------------------------------------------------------------
r5795 | havoc | 2005-11-06 22:51:09 -0800 (Sun, 06 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/r_crosshairs.c
   M /trunk/darkplaces/r_shadow.c

removed .tga/.lmp extensions from all Pic names in the engine to improve consistency

------------------------------------------------------------------------
r5794 | havoc | 2005-11-06 22:48:48 -0800 (Sun, 06 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_crosshairs.c
   M /trunk/darkplaces/r_shadow.c

fix rendering issues with light crosshairs and the world crosshair

------------------------------------------------------------------------
r5793 | havoc | 2005-11-06 21:30:44 -0800 (Sun, 06 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cmd.c

cleanup of Cmd_PreprocessString and removal of a commented code block as requested by Black

------------------------------------------------------------------------
r5792 | havoc | 2005-11-06 07:56:28 -0800 (Sun, 06 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/wad.c

fix stupid crash

------------------------------------------------------------------------
r5791 | black | 2005-11-06 07:23:23 -0800 (Sun, 06 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cmd.c

Merged the $ handling into one preprocessor function.

------------------------------------------------------------------------
r5790 | havoc | 2005-11-05 06:18:22 -0800 (Sat, 05 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/fs.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/image.h
   M /trunk/darkplaces/jpeg.c
   M /trunk/darkplaces/jpeg.h
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/palette.c
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/snd_ogg.c
   M /trunk/darkplaces/snd_wav.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/wad.c

eliminated fs_filesize global, now File_LoadFile and File_Open take a fs_offset_t filesize variable pointer to store the file size into

------------------------------------------------------------------------
r5789 | havoc | 2005-11-04 23:48:17 -0800 (Fri, 04 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/bspfile.h
   M /trunk/darkplaces/cd_bsd.c
   M /trunk/darkplaces/cd_linux.c
   M /trunk/darkplaces/cd_null.c
   M /trunk/darkplaces/cd_sdl.c
   M /trunk/darkplaces/cd_shared.c
   M /trunk/darkplaces/cd_win.c
   M /trunk/darkplaces/cdaudio.h
   M /trunk/darkplaces/cgamevm.c
   M /trunk/darkplaces/cgamevm.h
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/cl_screen.h
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/draw.h
   M /trunk/darkplaces/fractalnoise.c
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/fs.h
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/image.h
   M /trunk/darkplaces/jpeg.c
   M /trunk/darkplaces/jpeg.h
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/mathlib.c
   M /trunk/darkplaces/mathlib.h
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/model_sprite.c
   M /trunk/darkplaces/modelgen.h
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/netconn.h
   M /trunk/darkplaces/palette.c
   M /trunk/darkplaces/palette.h
   M /trunk/darkplaces/portals.c
   M /trunk/darkplaces/portals.h
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/pr_comp.h
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/pr_execprogram.h
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/prvm_execprogram.h
   M /trunk/darkplaces/qtypes.h
   M /trunk/darkplaces/r_crosshairs.c
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_lightning.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/r_textures.h
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/sbar.c
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/snd_alsa.c
   M /trunk/darkplaces/snd_bsd.c
   M /trunk/darkplaces/snd_coreaudio.c
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_main.h
   M /trunk/darkplaces/snd_mem.c
   M /trunk/darkplaces/snd_mix.c
   M /trunk/darkplaces/snd_ogg.c
   M /trunk/darkplaces/snd_sdl.c
   M /trunk/darkplaces/snd_wav.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/svvm_cmds.c
   M /trunk/darkplaces/vid_agl.c
   M /trunk/darkplaces/vid_wgl.c
   M /trunk/darkplaces/wad.c
   M /trunk/darkplaces/wad.h
   M /trunk/darkplaces/zone.c
   M /trunk/darkplaces/zone.h

eliminated qbyte type, now uses unsigned char throughout the engine for this purpose

------------------------------------------------------------------------
r5788 | havoc | 2005-11-04 05:24:15 -0800 (Fri, 04 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c

implemented sv_fixedframeratesingleplayer cvar

------------------------------------------------------------------------
r5787 | havoc | 2005-11-04 04:32:52 -0800 (Fri, 04 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c

eliminated use of node bounding box when recursing collision traces and lights through the BSP tree, now only uses BoxOnPlaneSide approach, with an optimized axial case inlined

------------------------------------------------------------------------
r5786 | havoc | 2005-11-04 04:31:35 -0800 (Fri, 04 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

minor optimizations to GLSL path layer checking

------------------------------------------------------------------------
r5785 | havoc | 2005-11-01 01:57:40 -0800 (Tue, 01 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

made timing even more reliable (now sleeps only as little as possible, and only if at least 10ms remains)

------------------------------------------------------------------------
r5784 | havoc | 2005-11-01 01:52:47 -0800 (Tue, 01 Nov 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

fix dedicated server timing, now sleeps less than the full amount of time (like listen servers/clients already did) to maintain a steady framerate, also made it not sleep unless it is at least 10ms, to try to further improve the timing accuracy, thanks to GreEn`mArine for testing this change

------------------------------------------------------------------------
r5783 | havoc | 2005-10-29 22:17:27 -0700 (Sat, 29 Oct 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

fix another crash on level change caused by NetConn_ServerFrame being called

------------------------------------------------------------------------
r5782 | havoc | 2005-10-29 04:26:25 -0700 (Sat, 29 Oct 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/sv_main.c

fix server physics crash on level change from reading player movement packets during SV_SpawnServer (bad idea!)

------------------------------------------------------------------------
r5781 | havoc | 2005-10-29 03:59:10 -0700 (Sat, 29 Oct 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

rewrote much of the voodoo/tnt rtlight path, now supports fog, and now avoids rendering any black triangles (since these cards don't have a lot of fillrate it's better to cull triangles on the cpu)

------------------------------------------------------------------------
r5780 | havoc | 2005-10-28 23:51:14 -0700 (Fri, 28 Oct 2005) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_crosshairs.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_lightning.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_sprites.c
   M /trunk/darkplaces/render.h

converted vertex fogging to use a fogtable array which matches the fog texture
enabled fog texturing on GLSL lighting path (dot3 path and vertex path still need work)
changed EyeVector/LightVector in GLSL shader back to full fp32 precision because at fp16 the vectors were reaching infinity at only a few meters, which obviously broke fogging

------------------------------------------------------------------------
r5779 | havoc | 2005-10-28 17:58:15 -0700 (Fri, 28 Oct 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_sprites.c

merged two sprite functions into the main callback to slightly clean up the code and simplify it

------------------------------------------------------------------------
r5778 | havoc | 2005-10-28 17:39:53 -0700 (Fri, 28 Oct 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_lerpanim.c
   M /trunk/darkplaces/r_sprites.c

migrated r_lerpsprites cvar check to r_lerpanim, r_lerpmodels no longer affects sprites

------------------------------------------------------------------------
r5777 | havoc | 2005-10-27 22:44:11 -0700 (Thu, 27 Oct 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

tweaked GLSL lighting shader to get a bit more performance (at least 7%) on GF6 by making all variables half precision except TexCoord, hopefully also helps GFFX

------------------------------------------------------------------------
r5776 | havoc | 2005-10-26 23:41:42 -0700 (Wed, 26 Oct 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/render.h

the beginnings of texture fog support (to cure the vertex artifacts and simplify the renderer a bit)

------------------------------------------------------------------------
r5775 | havoc | 2005-10-26 22:55:59 -0700 (Wed, 26 Oct 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

remove a debugging message related to ammo > 200 in zymotic hud

------------------------------------------------------------------------
r5774 | havoc | 2005-10-26 15:23:41 -0700 (Wed, 26 Oct 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpvsimpledecode.c

fix free/malloc problems from a partial switch to Z_Free and Z_Malloc, the switch over is now complete

------------------------------------------------------------------------
r5773 | havoc | 2005-10-26 03:57:05 -0700 (Wed, 26 Oct 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

new zymotic hud

------------------------------------------------------------------------
r5772 | havoc | 2005-10-26 03:13:00 -0700 (Wed, 26 Oct 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/svvm_cmds.c
   M /trunk/darkplaces/world.c
   M /trunk/darkplaces/world.h

replaced CL_PointQ1Contents with longer calls to contents conversion and CL_PointSuperContents
changed CL_PointSuperContents to a #define calling SV_Move directly as an optimization

------------------------------------------------------------------------
r5771 | havoc | 2005-10-26 03:11:47 -0700 (Wed, 26 Oct 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sv_user.c

split SV_Physics_Entity into SV_Physics_Entity and SV_Physics_ClientEntity as an optimization

------------------------------------------------------------------------
r5770 | havoc | 2005-10-26 03:09:28 -0700 (Wed, 26 Oct 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

fix stupid bug introduced by merging CL_DecayLights into CL_UpdateLights, fixed by splitting them again, now glowing entities should work again

------------------------------------------------------------------------
r5769 | havoc | 2005-10-25 19:09:48 -0700 (Tue, 25 Oct 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c

optimized SV_WriteClientdataToMessage by caching weaponmodelindex in client structure, saving 1% cpu time in masque.bsp

------------------------------------------------------------------------
r5768 | havoc | 2005-10-25 19:02:49 -0700 (Tue, 25 Oct 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

reverted bsp recursion changes (back to the BoxOnPlaneSide method) because the skipping of solid leafs in node bounding box generation was completely breaking q3bsp collisions, and without the reduced node boxes the bsp recursion code runs horribly slow for unknown reasons

------------------------------------------------------------------------
r5767 | havoc | 2005-10-24 21:29:39 -0700 (Mon, 24 Oct 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

updated IP address comment for Willis's dpmaster.deathmask.net master server

------------------------------------------------------------------------
r5766 | havoc | 2005-10-23 22:55:21 -0700 (Sun, 23 Oct 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

fix a use of cs.specialvisibilityradius before it was initialized (thanks to gcc 4 for pointing out this bug)

------------------------------------------------------------------------
r5765 | havoc | 2005-10-23 21:42:22 -0700 (Sun, 23 Oct 2005) | 6 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_light.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h
   M /trunk/darkplaces/render.h

moved d_lightstylevalue into r_refdef.lightstyle
moved r_dlights into r_redef.lights and made it an array of pointers into cl_dlights to save memory and time
merged R_UpdateLights into CL_DecayLights and renamed it CL_UpdateLights
renamed R_RTLight_UpdateFromDLight to R_RTLight_Update and made it take only the dlight pointer
implemented cl_activedlights variable to prevent scanning whole MAX_DLIGHTS range every frame

------------------------------------------------------------------------
r5764 | havoc | 2005-10-23 21:28:49 -0700 (Sun, 23 Oct 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fixed a flaw in Mod_Q1BSP_RecursiveRecalcNodeBBox, it was merging bounding boxes even if they came from solid leafs, which meant that the solid hull around the world was making almost all nodes have a bounding box of +-1 billion units, negating any benefit at all to node bounding boxes
10% speed gain in masque.bsp by changing pvs box checking functions to use box tests when recursing the bsp tree instead of BoxOnPlaneSide (now that the node boxes are usable)

------------------------------------------------------------------------
r5763 | havoc | 2005-10-23 21:22:16 -0700 (Sun, 23 Oct 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

slightly optimized Mod_ForName to make less calls to Mod_LoadModel

------------------------------------------------------------------------
r5762 | havoc | 2005-10-23 21:19:23 -0700 (Sun, 23 Oct 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/world.c

made an optimized SV_ClipMoveToWorld function to save time on large numbers of world collisions

------------------------------------------------------------------------
r5761 | havoc | 2005-10-23 21:17:09 -0700 (Sun, 23 Oct 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/mathlib.c

#ifdef 0'd out BoxOnPlaneSide_Separate as it is not used

------------------------------------------------------------------------
r5760 | havoc | 2005-10-23 16:13:11 -0700 (Sun, 23 Oct 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

don't send empty lightstyles during signon

------------------------------------------------------------------------
r5759 | havoc | 2005-10-23 13:24:03 -0700 (Sun, 23 Oct 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

fixed a bug that was making "Model %s not found" warnings never appear when parsing the model precache list

------------------------------------------------------------------------
r5758 | havoc | 2005-10-23 13:02:31 -0700 (Sun, 23 Oct 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/portals.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/world.c

got rid of Mod_CheckLoaded, changed how model system restart works to make this work properly
disabled model purging on level change, now only the world model is unloaded, this should improve slightly load times from level to level if a model is used in an early level, then not used in the next, and then used again in the next after that, however it also increases memory usage

------------------------------------------------------------------------
r5757 | havoc | 2005-10-23 12:42:34 -0700 (Sun, 23 Oct 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/sv_main.c

changed network entity pvs checking to cache the cluster list (updated whenever the cull box changes), this got a 20% speed gain in masque.bsp, also rewrote much of the network entity handling code for another 1% speed gain and slight readability improvement

------------------------------------------------------------------------
r5756 | havoc | 2005-10-22 23:36:05 -0700 (Sat, 22 Oct 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_sprites.c
   M /trunk/darkplaces/render.h

rewrote r_speeds stats code, now uses renderstats global structure rather than individual c_ global variables, this makes maintenance a lot easier, additionally changed all the stats to be more representitive of how the engine actually works (counting entities instead of models/bmodels/sprites separately, among other changes), condensed r_speeds stats display to fewer lines

------------------------------------------------------------------------
r5754 | havoc | 2005-10-20 23:35:08 -0700 (Thu, 20 Oct 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_coreaudio.c

fix another g++ conversion error

------------------------------------------------------------------------
r5753 | havoc | 2005-10-20 23:32:19 -0700 (Thu, 20 Oct 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_agl.c

added explicit casts for agl functions when calling GL_GetProcAddress

------------------------------------------------------------------------
r5752 | havoc | 2005-10-20 23:15:55 -0700 (Thu, 20 Oct 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

fix another float->enum conversion error with g++ 4

------------------------------------------------------------------------
r5751 | havoc | 2005-10-20 23:15:25 -0700 (Thu, 20 Oct 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/mvm_cmds.c

fixed two Con_Printf format strings with the wrong type

------------------------------------------------------------------------
r5750 | havoc | 2005-10-20 23:08:25 -0700 (Thu, 20 Oct 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/bspfile.h
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/clprogdefs.h
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/cvar.h
   M /trunk/darkplaces/dpvsimpledecode.c
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/input.h
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/keys.h
   M /trunk/darkplaces/mathlib.h
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/model_alias.h
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/modelgen.h
   M /trunk/darkplaces/mprogdefs.h
   M /trunk/darkplaces/netconn.h
   M /trunk/darkplaces/pr_comp.h
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/pr_exec.c
   M /trunk/darkplaces/progdefs.h
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/qtypes.h
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_lightning.c
   M /trunk/darkplaces/r_textures.h
   M /trunk/darkplaces/sbar.c
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/snd_main.h
   M /trunk/darkplaces/snd_mix.c
   M /trunk/darkplaces/snd_wav.c
   M /trunk/darkplaces/snd_win.c
   M /trunk/darkplaces/spritegn.h
   M /trunk/darkplaces/sys.h
   M /trunk/darkplaces/ui.h
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/wad.c
   M /trunk/darkplaces/wad.h

gave names to nearly all structs and enums which should make for better C++ error messages, and fix any more of those anonymous struct errors

------------------------------------------------------------------------
r5749 | havoc | 2005-10-20 22:30:33 -0700 (Thu, 20 Oct 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

fix an anonymous struct error with g++ 4

------------------------------------------------------------------------
r5748 | havoc | 2005-10-20 22:28:59 -0700 (Thu, 20 Oct 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/mvm_cmds.c

fix a float->enum conversion error with g++ 4

------------------------------------------------------------------------
r5747 | havoc | 2005-10-20 22:26:35 -0700 (Thu, 20 Oct 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/mvm_cmds.c

fix a float->enum conversion error with g++ on big endian systems

------------------------------------------------------------------------
r5746 | havoc | 2005-10-20 22:23:37 -0700 (Thu, 20 Oct 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_sprite.c

fix an int->enum conversion error with g++ on big endian systems

------------------------------------------------------------------------
r5745 | havoc | 2005-10-20 22:15:15 -0700 (Thu, 20 Oct 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/image.c

added struct name to imageformats to cure an error in g++ 4

------------------------------------------------------------------------
r5744 | havoc | 2005-10-20 22:11:58 -0700 (Thu, 20 Oct 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

added a struct name to envmapinfo to stop a g++ 4 error about envmapinfo (which is a global) using an anonymous type (a struct with no name)

------------------------------------------------------------------------
r5743 | havoc | 2005-10-20 22:05:49 -0700 (Thu, 20 Oct 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cgame.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/collision.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/cvar.c
   M /trunk/darkplaces/dpvsimpledecode.c
   M /trunk/darkplaces/filematch.c
   M /trunk/darkplaces/fractalnoise.c
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/image.h
   M /trunk/darkplaces/jpeg.c
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/lhnet.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/menu.h
   M /trunk/darkplaces/meshqueue.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_sprite.c
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/qtypes.h
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_lightning.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/r_sprites.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/snd_alsa.c
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_ogg.c
   M /trunk/darkplaces/snd_sdl.c
   M /trunk/darkplaces/snd_wav.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/ui.c
   M /trunk/darkplaces/ui.h
   M /trunk/darkplaces/vid_agl.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_wgl.c
   M /trunk/darkplaces/wad.c
   M /trunk/darkplaces/zone.c
   M /trunk/darkplaces/zone.h

made darkplaces compile successfully with g++ to test for errors C doesn't care about (result: found no actual bugs, just C++ compilers being ultra fussy)

------------------------------------------------------------------------
r5742 | havoc | 2005-10-20 15:22:24 -0700 (Thu, 20 Oct 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c

fix one more signedness warning

------------------------------------------------------------------------
r5741 | havoc | 2005-10-20 15:14:19 -0700 (Thu, 20 Oct 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/collision.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/lhnet.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_sprite.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/polygon.c
   M /trunk/darkplaces/polygon.h
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/snd_coreaudio.c
   M /trunk/darkplaces/snd_mix.c
   M /trunk/darkplaces/snd_ogg.c
   M /trunk/darkplaces/snd_wav.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/vid_agl.c
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/view.c

gcc 4.0 signedness warning fixes and uninitialized vector fixes

------------------------------------------------------------------------
r5740 | havoc | 2005-10-17 15:51:42 -0700 (Mon, 17 Oct 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

added very preliminary zymotic hud

------------------------------------------------------------------------
r5739 | havoc | 2005-10-15 08:36:36 -0700 (Sat, 15 Oct 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

fix typo

------------------------------------------------------------------------
r5738 | havoc | 2005-10-15 08:21:02 -0700 (Sat, 15 Oct 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

don't try to compile GL_NV_half_float shaders if the extension is missing

------------------------------------------------------------------------
r5737 | havoc | 2005-10-14 00:36:45 -0700 (Fri, 14 Oct 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

removed Lights Per Model setting from effects options menu, as it only affects .lights files now that vertex dlights are gone...  leading to much confusion among users

------------------------------------------------------------------------
r5736 | havoc | 2005-10-13 05:03:05 -0700 (Thu, 13 Oct 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

work around for empty key/value pairs in nehahra neh1m8.bsp entities

------------------------------------------------------------------------
r5735 | havoc | 2005-10-11 03:06:10 -0700 (Tue, 11 Oct 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

fix a stupid bug with the runes display on the hud (it was detecting rogue/hipnotic hud's by the existence of the items2 field, which due to the DP progs loader always exists)

------------------------------------------------------------------------
r5734 | havoc | 2005-10-11 02:58:50 -0700 (Tue, 11 Oct 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/collision.c

changed the unused line/sphere collision code to use Vector macros instead of doing everything manually (possibly improving readability)

------------------------------------------------------------------------
r5733 | havoc | 2005-10-11 02:57:44 -0700 (Tue, 11 Oct 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

updated a comment about the nehahra pmodel command/field

------------------------------------------------------------------------
r5731 | havoc | 2005-10-07 05:56:54 -0700 (Fri, 07 Oct 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/collision.c

fix a stupid bug in line/sphere collision code (was using sqrt where it shouldn't)

------------------------------------------------------------------------
r5730 | havoc | 2005-10-06 07:12:00 -0700 (Thu, 06 Oct 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

ok this did not cause memory corruption because of another bug which wasted an equivilant amount of memory...

------------------------------------------------------------------------
r5729 | havoc | 2005-10-06 07:11:06 -0700 (Thu, 06 Oct 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

fix a very stupid bug in Mod_AllocSurfMesh that causes memory corruption

------------------------------------------------------------------------
r5727 | havoc | 2005-09-24 02:24:25 -0700 (Sat, 24 Sep 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

fix recursive error (and sometimes segfault) when a Host_Error occurs during progs loading (such as with a corrupt progs.dat)

------------------------------------------------------------------------
r5726 | havoc | 2005-09-22 23:04:17 -0700 (Thu, 22 Sep 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

make glsl work on ATI's newer drivers (which don't like #define on keywords)

------------------------------------------------------------------------
r5725 | molivier | 2005-09-18 09:43:45 -0700 (Sun, 18 Sep 2005) | 5 lines
Changed paths:
   M /trunk/darkplaces/snd_coreaudio.c
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_main.h
   M /trunk/darkplaces/snd_mem.c
   M /trunk/darkplaces/snd_ogg.c
   M /trunk/darkplaces/snd_sdl.c
   M /trunk/darkplaces/snd_wav.c
   M /trunk/darkplaces/snd_wav.h

- SFXs no longer allocate mempools, they use the sound mempool directly.
It saved 21KB and 129 mempools (from 191 to 62) in my quick test.
- removed unused function S_UnloadSound
- changed an endian test in the Ogg Vorbis code to look more coherent

------------------------------------------------------------------------
r5724 | molivier | 2005-09-18 09:36:14 -0700 (Sun, 18 Sep 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/zone.c

Made Mem_PrintStats also print the real allocated size (including structures used by the memory system)

------------------------------------------------------------------------
r5723 | havoc | 2005-09-12 18:33:51 -0700 (Mon, 12 Sep 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/fs.c

moved scr_screenshot_name declaration from cl_screen.c to fs.c because fs.c depends on it and creates it

------------------------------------------------------------------------
r5722 | havoc | 2005-09-11 05:58:07 -0700 (Sun, 11 Sep 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

changed R_TimeReport to call glFinish to improve the accuracy of the reports on each subsystem (not allowing deferred rendering - yes this knocks your framerate down a lot)

------------------------------------------------------------------------
r5721 | havoc | 2005-09-11 05:02:02 -0700 (Sun, 11 Sep 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix a crash on vertex lighting q1bsp/hlbsp surfaces with no lightmap samples data

------------------------------------------------------------------------
r5720 | havoc | 2005-09-11 04:48:17 -0700 (Sun, 11 Sep 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_shadow.c

rewrote colormapping handling to store colormap_pantscolor and colormap_shirtcolor in entity_render_t rather than having the annoying palette lookups in the renderer, while doing this I removed support for fullbright rendering of colormap colors 14 and 15 (this shouldn't really affect anyone, stock quake did not even let you use these colors, and they're ugly colors anyway :)
rewrote portions of surface renderer again, to improve readability and overbright handling, this shouldn't change anything visually

------------------------------------------------------------------------
r5719 | havoc | 2005-09-11 04:38:38 -0700 (Sun, 11 Sep 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

use a better check for bmodels when clearing stainmaps which won't happen on old submodels (which might not be unloaded yet when this function is called)

------------------------------------------------------------------------
r5718 | havoc | 2005-09-11 03:39:45 -0700 (Sun, 11 Sep 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fix Sajt's bug in q1bsp/hlbsp hullsizes (off by one on the hull index)

------------------------------------------------------------------------
r5717 | havoc | 2005-09-11 01:33:52 -0700 (Sun, 11 Sep 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

fix a stupid typo in the vertex shader

------------------------------------------------------------------------
r5716 | molivier | 2005-09-11 00:30:26 -0700 (Sun, 11 Sep 2005) | 11 lines
Changed paths:
   M /trunk/darkplaces/fs.c

- Updated Zlib definitions to version 1.2.3. The only difference is that
the function calling convention has changed on Win32 (previously, the
zlib DLL used WINAPI). YOU NOW NEED AN OFFICIAL "zlib1.dll" version
1.2.x instead of your old "zlib.dll" (get it from http://www.zlib.net/).
If you still want to use a DLL with the old calling convention,
uncomment line 101 and recompile (such a DLL can be found at
http://www.winimage.com/zLibDll/).
- Removed QuakeForge copyright since the last bit of QF
code was removed months ago by LordHavoc
- Changed the way we test the presence of the O_NONBLOCK flag

------------------------------------------------------------------------
r5714 | sajt | 2005-09-10 15:00:21 -0700 (Sat, 10 Sep 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

After the swarm of angry mail I received from owners of manufacturerly-diverse processors, I finally gave in.

------------------------------------------------------------------------
r5713 | sajt | 2005-09-10 14:38:50 -0700 (Sat, 10 Sep 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.h

Removed the evil evil prototype

------------------------------------------------------------------------
r5711 | havoc | 2005-09-10 05:12:34 -0700 (Sat, 10 Sep 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_shared.h

removed a lot of texture_t fields that were used by the old renderer

------------------------------------------------------------------------
r5710 | havoc | 2005-09-10 04:33:11 -0700 (Sat, 10 Sep 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

removed old surface renderer

------------------------------------------------------------------------
r5709 | sajt | 2005-09-10 03:30:05 -0700 (Sat, 10 Sep 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c

The MCBSP header has been fixed but it will still crash your NASA lunar module landing mainframe

------------------------------------------------------------------------
r5707 | sajt | 2005-09-10 03:07:25 -0700 (Sat, 10 Sep 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/bspfile.h
   M /trunk/darkplaces/model_brush.c

Rename dhullinfo_t to hullinfo_t, fix byte->qbyte. More fixes later! Don't complain if this crashes your Sun supercomputer!

------------------------------------------------------------------------
r5706 | sajt | 2005-09-09 23:49:57 -0700 (Fri, 09 Sep 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/bspfile.h
   M /trunk/darkplaces/model_brush.c

MCBSP version 2 loading in the engine.. Some very ugly code (will be rewritten). Also, I haven't thought of how bboxes will round to hull sizes yet, so don't even bother trying to use the format yet. Also, someone might want to add a dhullinfo_t instance in the model struct or something, so the rounding functions would be able to access the hull sizes. I'm not sure how that will all work yet.

------------------------------------------------------------------------
r5702 | havoc | 2005-09-09 06:57:56 -0700 (Fri, 09 Sep 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_shared.h

new surface renderer, builds a layer list in R_UpdateTextureInfo, currently requires r_test to be 1 to use it, will be removing old surface renderer (still available) soon

------------------------------------------------------------------------
r5701 | havoc | 2005-09-09 05:37:25 -0700 (Fri, 09 Sep 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

fix a bug that made the world render colormapped (no effect but a speed loss)

------------------------------------------------------------------------
r5700 | molivier | 2005-09-09 01:32:50 -0700 (Fri, 09 Sep 2005) | 2 lines
Changed paths:
   A /trunk/darkplaces/vid_agl.c

Mac OS X OpenGL and input module, using Carbon and AGL. Still in development, but stable enough for a player to use. Notable problems and missing features: no hardware gamma support, no desktop menus, mouse movement scaling NOT disabled (please, if someone knows how to do that with Carbon, let me know), and the fact that it has only be tested on one computer so far (my iBook G4)...

------------------------------------------------------------------------
r5699 | havoc | 2005-09-08 04:49:00 -0700 (Thu, 08 Sep 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/render.h

removed detail texturing (it only worked in q1bsp and hlbsp maps, did not work properly with rtlights, was liked by some people and disliked by many more, and consumed some memory)

------------------------------------------------------------------------
r5698 | havoc | 2005-09-08 02:12:16 -0700 (Thu, 08 Sep 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/render.h

removed distortion textures formerly used by GF3 water shader, this frees up 128K of texture memory

------------------------------------------------------------------------
r5697 | havoc | 2005-09-08 02:08:45 -0700 (Thu, 08 Sep 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/render.h

removed GF3 water shader (entirely), it probably won't be coming back

------------------------------------------------------------------------
r5696 | havoc | 2005-09-07 21:15:17 -0700 (Wed, 07 Sep 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_shadow.c

moved waterscrollmatrix handling into texture->currentexmatrix to simplify texture matrix shaders like water, and added support in R_Shadow_RenderLighting functions

------------------------------------------------------------------------
r5695 | havoc | 2005-09-07 10:41:03 -0700 (Wed, 07 Sep 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

changed Mod_Q3BSP_LoadEffects to allow brushindex -1 (for effects applied to the whole map), and made it use a warning instead of an error for invalid brushindex

------------------------------------------------------------------------
r5694 | havoc | 2005-09-07 09:07:47 -0700 (Wed, 07 Sep 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h

migrated surface list iteration into the RenderLighting paths for more efficient handling of surfaces, this increased GLSL performance, and vertex lighting performance (rewrote most of it), dot3 path is still quite slow however

------------------------------------------------------------------------
r5693 | havoc | 2005-09-07 09:05:54 -0700 (Wed, 07 Sep 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/snd_mem.c

fix a few very small mistakes by Black and Elric: precompiler directives (#define) can not have whitespace before them, but can have whitespace after the #

------------------------------------------------------------------------
r5692 | havoc | 2005-09-07 02:58:37 -0700 (Wed, 07 Sep 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cmd.c

fix a crash in Cmd_ExecuteAlias when $* is used with no parameters

------------------------------------------------------------------------
r5691 | molivier | 2005-09-07 02:58:15 -0700 (Wed, 07 Sep 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/makefile.inc
   A /trunk/darkplaces/snd_coreaudio.c
   M /trunk/darkplaces/snd_main.c

Added CoreAudio (Mac OS X) sound driver. Changed / fixed a couple of Mac OS X related lines in the makefiles. The sound format is now printed at sound module startup.

------------------------------------------------------------------------
r5690 | havoc | 2005-09-07 02:56:23 -0700 (Wed, 07 Sep 2005) | 5 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/model_sprite.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h

split model->DrawShadowVolume into CompileShadowVolume and DrawShadowVolume to simplify things
moved ShadowMesh creation from R_RTLight_Compile to R_Q1BSP_CompileShadowVolume
split R_Shadow_RenderLighting into several functions for different paths to (very slightly) improve readability
fixed a bug introduced by recent specularscale optimizations (it wasn't being passed to RenderLighting)

------------------------------------------------------------------------
r5689 | molivier | 2005-09-07 02:54:30 -0700 (Wed, 07 Sep 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_sdl.c

Fixed the SDL video driver on Mac OS X (crash when restarting). Thanks to BigMac for the patch

------------------------------------------------------------------------
r5688 | havoc | 2005-09-07 01:47:55 -0700 (Wed, 07 Sep 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h

removed r_shadow_realtime_world_compilelight cvar and all code relating to it (no longer compiles lighting geometry), this is necessary for proper handling of water and animated textures

------------------------------------------------------------------------
r5687 | havoc | 2005-09-07 01:40:12 -0700 (Wed, 07 Sep 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h

migrated a lot of error handling out of R_Shadow_RenderLighting and into the loading code or DrawLight code, this makes r_shadow_realtime_world_compilelight
0 faster than it was, still not quite as fast as compilelight 1 however

------------------------------------------------------------------------
r5686 | sajt | 2005-09-06 19:43:41 -0700 (Tue, 06 Sep 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c

Dot crosshair is now a tad bigger (and centred properly)

------------------------------------------------------------------------
r5685 | sajt | 2005-09-06 04:28:25 -0700 (Tue, 06 Sep 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/todo

396 again
A few items look like they should be fixed by now: line #'s 47, 51, 208, ... (only looked through a few of them)

------------------------------------------------------------------------
r5684 | sajt | 2005-09-06 04:17:35 -0700 (Tue, 06 Sep 2005) | 4 lines
Changed paths:
   M /trunk/darkplaces/bspfile.h
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/hmap2/brush.c
   M /trunk/hmap2/bsp5.h
   M /trunk/hmap2/bspfile.c
   M /trunk/hmap2/bspfile.h
   M /trunk/hmap2/light.c
   M /trunk/hmap2/map.c
   M /trunk/hmap2/qbsp.c
   M /trunk/hmap2/tree.c
   M /trunk/hmap2/vis.c

New MCBSP format, used for my mod. It differs from bsp 29 in that it stores coloured lighting data in the bsp file itself, it has a different set of hulls, and a differently formatted header (I used a few hacks to pull that off without adding a new header struct... maybe be changed later).

Anyway, do NOT use this format yet! The format is WIP and backward compatibility will not be kept!

------------------------------------------------------------------------
r5683 | havoc | 2005-09-05 23:51:19 -0700 (Mon, 05 Sep 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

now has two precision error workaround cases rather than one, lifts have been successfully tested at 1 million frames per second
slight cleaning of some variable declarations

------------------------------------------------------------------------
r5682 | havoc | 2005-09-05 23:10:51 -0700 (Mon, 05 Sep 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

don't remove onground flag when riding a pusher, this fixes the e3m2 silver key not falling with the platform it is riding

------------------------------------------------------------------------
r5681 | havoc | 2005-09-05 22:33:53 -0700 (Mon, 05 Sep 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

removed (int) casts added by Sajt's last commit, as they are probably a slowdown in most cases

------------------------------------------------------------------------
r5680 | sajt | 2005-09-05 19:17:40 -0700 (Mon, 05 Sep 2005) | 4 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/world.c

The broken pushers are PARTLY fixed. They will now stop when in contact with an entity and call their blocked() QC function. However they appear to have a tiny portion stuck in the player, so the developer console will still be spammed with 'player is stuck.' messages, and the player can still jump while a crusher is on his head.

Note to smart people: I'm not sure what to stick in movetype for the SV_ClipMoveToEntity calls, so I put 0 since it's not important. Maybe that should be changed to the appropriate value for the sake of Good(tm).

------------------------------------------------------------------------
r5679 | havoc | 2005-09-02 04:20:51 -0700 (Fri, 02 Sep 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

fix a bug that called player thinks during a level change, this bug may have even been in stock quake

------------------------------------------------------------------------
r5678 | havoc | 2005-09-02 04:10:10 -0700 (Fri, 02 Sep 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/image.c

fix a memory leak in one error case in LoadTGA and clean up things a little

------------------------------------------------------------------------
r5676 | sajt | 2005-08-31 18:59:04 -0700 (Wed, 31 Aug 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_sky.c

No longer gives fail message when skybox loads properly, and no longer gives two fail messages when skybox doesn't load properly

------------------------------------------------------------------------
r5675 | havoc | 2005-08-31 07:05:59 -0700 (Wed, 31 Aug 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

initialize red to false (fixes an uninitialized variable warning which appears to be a genuine bug)

------------------------------------------------------------------------
r5674 | havoc | 2005-08-31 02:21:25 -0700 (Wed, 31 Aug 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c

change GAME_ZYMOTIC default data dir to basezym

------------------------------------------------------------------------
r5673 | sajt | 2005-08-30 02:40:02 -0700 (Tue, 30 Aug 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

Another MSVC error fixed

------------------------------------------------------------------------
r5672 | havoc | 2005-08-30 01:53:01 -0700 (Tue, 30 Aug 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h

modified Mod_ValidateElements to fix broken elements rather than crashing later

------------------------------------------------------------------------
r5671 | havoc | 2005-08-30 00:34:33 -0700 (Tue, 30 Aug 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

make compile on MSVC

------------------------------------------------------------------------
r5670 | havoc | 2005-08-29 21:12:43 -0700 (Mon, 29 Aug 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_alias.h
   A /trunk/darkplaces/model_psk.h
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h

added PSK model support (UnrealTournament 2003/2004 ActorX format)

------------------------------------------------------------------------
r5669 | havoc | 2005-08-28 22:48:32 -0700 (Sun, 28 Aug 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

rollback that shadowmesh fix, I was thinking about it incorrectly

------------------------------------------------------------------------
r5668 | havoc | 2005-08-28 22:44:23 -0700 (Sun, 28 Aug 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

forgot one part of the shadowmesh fix

------------------------------------------------------------------------
r5667 | havoc | 2005-08-28 22:43:41 -0700 (Sun, 28 Aug 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fix the quake logo shadow in e1m5 (ALL surfaces were producing shadow volumes, including sky and liquids)

------------------------------------------------------------------------
r5666 | havoc | 2005-08-28 13:41:12 -0700 (Sun, 28 Aug 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_alias.h
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/model_sprite.c
   M /trunk/darkplaces/model_sprite.h

some cleaning of the model headers, and added bufferend parameter to all model loaders

------------------------------------------------------------------------
r5665 | havoc | 2005-08-28 00:23:51 -0700 (Sun, 28 Aug 2005) | 4 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_alias.h
   A /trunk/darkplaces/model_dpmodel.h
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_zymotic.h

added .dpm model support
moved Mod_ZYMOTICMODEL_Load function prototype from model_zymotic.h to model_alias.h (where the others already are)
removed an unnecessary call to Mod_BuildTriangleNeighbors in Mod_ZYMOTICMODEL_Load (it was being called twice)

------------------------------------------------------------------------
r5663 | tomaz | 2005-08-27 18:26:15 -0700 (Sat, 27 Aug 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

Added multiplayer maps to -did2 mode

------------------------------------------------------------------------
r5662 | tomaz | 2005-08-27 18:21:42 -0700 (Sat, 27 Aug 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h

Added -did2 mode ( Defeat In Detail 2 )

------------------------------------------------------------------------
r5658 | havoc | 2005-08-24 22:20:09 -0700 (Wed, 24 Aug 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

changed scr_screenshot_jpeg default to 1 (note this does not affect any existing installations which already have it saved to config as 1)

------------------------------------------------------------------------
r5657 | sajt | 2005-08-24 19:07:05 -0700 (Wed, 24 Aug 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/view.c

Get client velocity from cl.velocity rather than cl.movement_velocity for bob, this makes demos use the bob too

------------------------------------------------------------------------
r5656 | sajt | 2005-08-24 15:16:55 -0700 (Wed, 24 Aug 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

Apparently this shuts 'assignment in conditional' warnings up

------------------------------------------------------------------------
r5655 | havoc | 2005-08-24 11:51:16 -0700 (Wed, 24 Aug 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fix a stupid bug in shader parsing (it was ignoring passes when not transparent)

------------------------------------------------------------------------
r5654 | sajt | 2005-08-24 04:46:12 -0700 (Wed, 24 Aug 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

396

------------------------------------------------------------------------
r5653 | sajt | 2005-08-24 04:45:37 -0700 (Wed, 24 Aug 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/view.c

Added 99% functional weaponmodel bobbing code. It even tries to stop bobbing when you're not on the ground, and smoothly transitions between bobbing and not bobbing. The only problem is it seems to jolt whenever you pass through a message trigger or pick up an item or do anything unexceptional like that. Was it a bad idea to trust cl.onground?

------------------------------------------------------------------------
r5651 | sajt | 2005-08-24 02:53:11 -0700 (Wed, 24 Aug 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

395

------------------------------------------------------------------------
r5649 | havoc | 2005-08-23 23:17:12 -0700 (Tue, 23 Aug 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

nothing to see here, move along...

------------------------------------------------------------------------
r5648 | havoc | 2005-08-23 22:59:41 -0700 (Tue, 23 Aug 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

some cleanup of R_DrawTextureSurfaceList
changed model->brushq3.data_lightmaps checks to model->type == mod_brushq3, to fix rtlighting issues in unlit q3bsp maps (which were rendering fullbright even in rtworld mode)

------------------------------------------------------------------------
r5647 | sajt | 2005-08-23 15:13:06 -0700 (Tue, 23 Aug 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

Urre admits he was inebriated and his judgment hencely impaired when he suggested this

------------------------------------------------------------------------
r5646 | sajt | 2005-08-23 15:02:33 -0700 (Tue, 23 Aug 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/todo

Removed gl_combine from the menu and let the menu select the dot crosshair

------------------------------------------------------------------------
r5645 | sajt | 2005-08-23 14:45:11 -0700 (Tue, 23 Aug 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c
   M /trunk/darkplaces/todo

When below 1 fps, the fps counter instead counts spf (seconds per frame). Note that it's pretty hard to get into the spfs (so far I've only gotten it the moment after adding 30 rtlights at the same time when there were already 300 in the same spot)

------------------------------------------------------------------------
r5644 | sajt | 2005-08-23 14:09:21 -0700 (Tue, 23 Aug 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/todo

Added showbrand cvar, possible values 1-8. Draws the image gfx/brand on an edge or corner of the screen, based on the value of showbrand. 1 is bottom-left, 2 is bottom-middle, etc.

------------------------------------------------------------------------
r5643 | havoc | 2005-08-23 13:50:14 -0700 (Tue, 23 Aug 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

q3bsp loader no longer generates a fake lightgrid when one is missing, this saves a lot of memory in unlit maps

------------------------------------------------------------------------
r5642 | sajt | 2005-08-23 02:03:26 -0700 (Tue, 23 Aug 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c

I forgot to mention that I also fixed some other asymmetric crosshairs (3 and 4)

------------------------------------------------------------------------
r5641 | sajt | 2005-08-23 01:51:48 -0700 (Tue, 23 Aug 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/r_crosshairs.c
   M /trunk/darkplaces/todo

Added dot crosshair (crosshair 6)

------------------------------------------------------------------------
r5639 | sajt | 2005-08-23 00:06:23 -0700 (Tue, 23 Aug 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/svvm_cmds.c
   M /trunk/darkplaces/todo

Added a builtin for te_flamejet

------------------------------------------------------------------------
r5638 | sajt | 2005-08-22 23:43:24 -0700 (Mon, 22 Aug 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_user.c
   M /trunk/darkplaces/todo

Added sv_maxairspeed cvar (default 30). This was already mirrored  by cl_movement_maxairspeed.

------------------------------------------------------------------------
r5637 | sajt | 2005-08-22 22:50:55 -0700 (Mon, 22 Aug 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/svvm_cmds.c

Forgot a little portion of the comment :-(

------------------------------------------------------------------------
r5635 | sajt | 2005-08-22 22:39:12 -0700 (Mon, 22 Aug 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/svvm_cmds.c
   M /trunk/darkplaces/todo

Added DP_SV_WRITEUNTERMINATEDSTRING extension

------------------------------------------------------------------------
r5634 | sajt | 2005-08-22 21:07:29 -0700 (Mon, 22 Aug 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

Updated todo

------------------------------------------------------------------------
r5632 | havoc | 2005-08-22 20:02:56 -0700 (Mon, 22 Aug 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r5630 | molivier | 2005-08-21 00:54:56 -0700 (Sun, 21 Aug 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/sys_shared.c

Added the RTLD_GLOBAL flag to the dlopen call, since some systems seem to require that for some DLLs to work correctly. Thanks to Andreas Dehmel for the patch

------------------------------------------------------------------------
r5629 | molivier | 2005-08-21 00:51:31 -0700 (Sun, 21 Aug 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

Removed an unused variable

------------------------------------------------------------------------
r5617 | havoc | 2005-08-20 14:57:28 -0700 (Sat, 20 Aug 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_explosion.c

made some things static

------------------------------------------------------------------------
r5616 | havoc | 2005-08-20 12:00:02 -0700 (Sat, 20 Aug 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/svvm_cmds.c
   M /trunk/dpmod/qc/dpextensions.qc

added DP_SV_PRECACHEANYTIME extension

------------------------------------------------------------------------
r5601 | havoc | 2005-08-18 18:42:43 -0700 (Thu, 18 Aug 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix double bright models bug (LightPoint returns 2x color, and RSurf_SetColorPointer is called expecting 1x color)

------------------------------------------------------------------------
r5598 | havoc | 2005-08-18 17:21:25 -0700 (Thu, 18 Aug 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

don't try to send entities with a NAN origin (this is strangely crashing the PVS check in q1bsp maps, hitting a bad node)

------------------------------------------------------------------------
r5596 | havoc | 2005-08-18 11:48:30 -0700 (Thu, 18 Aug 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/render.h

added r_smoothnormals_areaweighting cvar (default 1, suggested by Black as a better method, faster and shading looks a little more distinct on nexuiz player models)

------------------------------------------------------------------------
r5591 | havoc | 2005-08-18 08:34:37 -0700 (Thu, 18 Aug 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

changed tolerances for renderable light intensities to make Stribbs happier

------------------------------------------------------------------------
r5590 | black | 2005-08-18 06:45:16 -0700 (Thu, 18 Aug 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/mathlib.h
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/svvm_cmds.c

-Increased MAX_LIGHTSTYLES to 256.
-Changed BuildNormals to use area-weighting/averaging instead of normal averaging.

------------------------------------------------------------------------
r5589 | black | 2005-08-17 05:43:01 -0700 (Wed, 17 Aug 2005) | 6 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/svvm_cmds.c

Fixed a bug in the r_shadow light entity parser which caused it to not read in
the pflags, skin and effects key/value pairs in q3 maps.
Added a check to PF_lightstyle for style >= 64.
Fixed a bug in the cursor drawing of the editrtlights mode (it was reading from a
uninitialized vector if you flew out of the map).

------------------------------------------------------------------------
r5582 | havoc | 2005-08-15 07:02:43 -0700 (Mon, 15 Aug 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

added a default case (Sys_Error) to CL_RocketTrail as recommended by [515]

------------------------------------------------------------------------
r5581 | molivier | 2005-08-15 03:40:19 -0700 (Mon, 15 Aug 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

cl_lastquakeentity and cl_isquakeentity are now reset properly when loading a new map (fix the crash with coopmod)

------------------------------------------------------------------------
r5580 | havoc | 2005-08-15 00:02:51 -0700 (Mon, 15 Aug 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/zone.c
   M /trunk/darkplaces/zone.h

added more developer_memorydebug sentinel checks, and made developer_memorydebug do not-allocated checks in a few cases that were not checked before
modified Mem_IsAllocated to be able to take a NULL pool pointer to scan all pools for the allocation

------------------------------------------------------------------------
r5579 | eviltypeguy | 2005-08-14 16:33:30 -0700 (Sun, 14 Aug 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/makefile.inc
   M /trunk/darkplaces/netconn.h
   M /trunk/darkplaces/snd_bsd.c
   M /trunk/darkplaces/vid_glx.c

Fixups for Solaris port.

------------------------------------------------------------------------
r5578 | havoc | 2005-08-14 15:54:15 -0700 (Sun, 14 Aug 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fix a crash in q1bsp model stats printing in developer mode

------------------------------------------------------------------------
r5577 | havoc | 2005-08-14 12:44:21 -0700 (Sun, 14 Aug 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/view.c

fix stupid typo in Cvar_RegisterVariable call

------------------------------------------------------------------------
r5576 | havoc | 2005-08-14 11:31:15 -0700 (Sun, 14 Aug 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/view.c

renamed cl_deathtilt to v_deathtilt to match FTE, fuhquake and ezquake engines

------------------------------------------------------------------------
r5575 | havoc | 2005-08-14 09:36:55 -0700 (Sun, 14 Aug 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/sbar.c
   M /trunk/darkplaces/view.c

added cl_deathnoviewmodel, cl_deathscoreboard and cl_deathtilt cvars so that games can decide whether they want these behaviors

------------------------------------------------------------------------
r5574 | havoc | 2005-08-14 09:36:09 -0700 (Sun, 14 Aug 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

added a comment in push code

------------------------------------------------------------------------
r5573 | black | 2005-08-13 13:56:23 -0700 (Sat, 13 Aug 2005) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/menu.c

Added colored string support to centerprint.
Fixed the menu from dying a recursive death if PRVM_Crash crashes inside
of the error handling function.

------------------------------------------------------------------------
r5568 | havoc | 2005-08-10 03:25:46 -0700 (Wed, 10 Aug 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

fix a terrible mistake: don't send \n at the end of the client variables during signon

------------------------------------------------------------------------
r5567 | havoc | 2005-08-10 03:23:26 -0700 (Wed, 10 Aug 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cmd.c

made Cmd_ForwardToServer code far more readable and prevented forwarding an empty string using cmd by itself

------------------------------------------------------------------------
r5566 | black | 2005-08-10 03:03:38 -0700 (Wed, 10 Aug 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cmd.c

Fixed alias parsing and added support for $* which pastes all formal parameters.

------------------------------------------------------------------------
r5565 | havoc | 2005-08-10 00:08:57 -0700 (Wed, 10 Aug 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/vid_shared.c

renamed r_shadow_geforcefxlowquality to r_shadow_usehalffloat and added gl_support_half_float extension checking, (half float is now considered a feature rather than a low quality option, as it is an even bigger speed gain on GF6 than on GFFX and no quality reduction has been observed)

------------------------------------------------------------------------
r5563 | black | 2005-08-08 01:16:37 -0700 (Mon, 08 Aug 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

Remove a call to ResetProg from ShutdownServer, so after a crash you will be able to debug the server prog.

------------------------------------------------------------------------
r5562 | havoc | 2005-08-08 00:41:47 -0700 (Mon, 08 Aug 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/svvm_cmds.c

add DP_ENT_COLORMOD extension to extension lists
remove NEXUIZ_PLAYERSKIN from extension lists (the dpextensions.qc describes it as part of the NEXUIZ_PLAYERMODEL extension)

------------------------------------------------------------------------
r5561 | havoc | 2005-08-08 00:16:41 -0700 (Mon, 08 Aug 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c

fix the commandline option documentation of The Hunted to say -thehunted, not -netherworld (no change in behavior, only documentation)

------------------------------------------------------------------------
r5560 | havoc | 2005-08-08 00:15:36 -0700 (Mon, 08 Aug 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c

change name of VorteX's netherworld mod

------------------------------------------------------------------------
r5552 | havoc | 2005-08-02 13:11:19 -0700 (Tue, 02 Aug 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/sys_linux.c

fix a signed/unsigned comparison warning

------------------------------------------------------------------------
r5549 | black | 2005-07-30 11:43:24 -0700 (Sat, 30 Jul 2005) | 4 lines
Changed paths:
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/host_cmd.c

-Changed a call to VariableString with FindCvar.
-Made changelevel call map if there is no server running (you could call this
a hack).

------------------------------------------------------------------------
r5540 | black | 2005-07-19 14:04:36 -0700 (Tue, 19 Jul 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/svvm_cmds.c

Moved the $cvar parser to Cmd_TokenizeString.

------------------------------------------------------------------------
r5539 | black | 2005-07-19 13:53:45 -0700 (Tue, 19 Jul 2005) | 8 lines
Changed paths:
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/todo

-Added $parameter parsing to the alias and $cvar parsing to the cmd system.
E.g.:
alias test "connect $1"
test "127.0.0.1"
set testcvar "127.0.0.1"
connect $testcvar
TODO: Add the extension description and the extension to the extension list.

------------------------------------------------------------------------
r5529 | tomaz | 2005-07-13 08:10:09 -0700 (Wed, 13 Jul 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c

Fixed a bug by me regarding the filesize of the embedded font.
Added FONT_FILESIZE define to avoid this misstake in the future.

------------------------------------------------------------------------
r5528 | havoc | 2005-07-13 07:20:17 -0700 (Wed, 13 Jul 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

draw [] brackets on the top 4 frags display before the frags count rather than after, as suggested by knghtbrd

------------------------------------------------------------------------
r5523 | havoc | 2005-07-10 14:21:47 -0700 (Sun, 10 Jul 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h

turned Mod_CheckLoaded into a #define

------------------------------------------------------------------------
r5522 | knghtbrd | 2005-07-10 14:17:52 -0700 (Sun, 10 Jul 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.inc

Fix the makefile not to use the unused gl_models.c

------------------------------------------------------------------------
r5521 | havoc | 2005-07-10 14:16:23 -0700 (Sun, 10 Jul 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces-dedicated.dsp
   M /trunk/darkplaces/darkplaces-sdl.dsp
   M /trunk/darkplaces/darkplaces.dsp
   D /trunk/darkplaces/gl_models.c

remove unused gl_models.c file

------------------------------------------------------------------------
r5517 | havoc | 2005-07-10 05:33:20 -0700 (Sun, 10 Jul 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/jpeg.c
   M /trunk/darkplaces/snd_ogg.c

use *64.dll instead of *.dll on win64, this way we can include both 32bit and 64bit dlls in the same releases

------------------------------------------------------------------------
r5514 | havoc | 2005-07-08 02:12:53 -0700 (Fri, 08 Jul 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

remove TEXF_CLAMP on skins

------------------------------------------------------------------------
r5513 | havoc | 2005-07-08 01:42:52 -0700 (Fri, 08 Jul 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

reduce TRIANGLEEDGEHASH from 16384 bins to 8192 to avoid a stack overflow on MSVC x64

------------------------------------------------------------------------
r5512 | havoc | 2005-07-06 11:22:56 -0700 (Wed, 06 Jul 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

move sv.active = true; up to fix a VM_bprint warning

------------------------------------------------------------------------
r5511 | havoc | 2005-07-05 06:32:14 -0700 (Tue, 05 Jul 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

changed qfile_t->buff_ind and qfile_t->buff_len to fs_offset_t to reduce number of casts

------------------------------------------------------------------------
r5510 | havoc | 2005-07-05 06:26:47 -0700 (Tue, 05 Jul 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

fix a warning

------------------------------------------------------------------------
r5509 | havoc | 2005-07-05 06:23:52 -0700 (Tue, 05 Jul 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpvsimpledecode.c
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/sv_main.c

more warning fixes

------------------------------------------------------------------------
r5508 | havoc | 2005-07-05 06:12:23 -0700 (Tue, 05 Jul 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.h

use 32bit fs_offset_t on windows (even win64 doesn't support 64bit file offsets on lseek/read/write)

------------------------------------------------------------------------
r5507 | havoc | 2005-07-05 06:08:49 -0700 (Tue, 05 Jul 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

made packfile_t (describes a file in a pack) use fs_offset_t

------------------------------------------------------------------------
r5506 | havoc | 2005-07-05 06:02:21 -0700 (Tue, 05 Jul 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_wgl.c

added a #define DIRECTINPUT_VERSION to hush warnings and make it work on dinput3 even if dinput8 headers are installed

------------------------------------------------------------------------
r5505 | black | 2005-07-05 06:01:29 -0700 (Tue, 05 Jul 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cd_win.c

fix VC 6 not supporting DWORD_PTR.

------------------------------------------------------------------------
r5504 | havoc | 2005-07-05 06:00:16 -0700 (Tue, 05 Jul 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

more warnings fixed

------------------------------------------------------------------------
r5503 | havoc | 2005-07-05 05:56:54 -0700 (Tue, 05 Jul 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/qtypes.h

more fixes

------------------------------------------------------------------------
r5502 | havoc | 2005-07-05 05:51:27 -0700 (Tue, 05 Jul 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_demo.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/fs.h
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/jpeg.c
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/qtypes.h
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/wad.c

added a 64bif fs_offset_t type to clean up most of the mess

------------------------------------------------------------------------
r5501 | black | 2005-07-05 05:04:30 -0700 (Tue, 05 Jul 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cd_win.c

fixed some conversions

------------------------------------------------------------------------
r5500 | havoc | 2005-07-05 04:57:50 -0700 (Tue, 05 Jul 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_main.h
   M /trunk/darkplaces/snd_ogg.c

stomping more size_t warnings

------------------------------------------------------------------------
r5499 | havoc | 2005-07-05 04:33:02 -0700 (Tue, 05 Jul 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/lhnet.c
   M /trunk/darkplaces/makefile.inc
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_ogg.c
   M /trunk/darkplaces/snd_wav.c
   M /trunk/darkplaces/zone.c

fixed signed/unsigned mismatch warnings
more size_t changes

------------------------------------------------------------------------
r5498 | havoc | 2005-07-05 04:24:38 -0700 (Tue, 05 Jul 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_main.h

changing some things back to size_t

------------------------------------------------------------------------
r5497 | havoc | 2005-07-05 03:49:06 -0700 (Tue, 05 Jul 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cgame.c
   M /trunk/darkplaces/cl_demo.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/cvar.c
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/fs.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/prvm_exec.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/sbar.c
   M /trunk/darkplaces/snd_mix.c

more size_t

------------------------------------------------------------------------
r5496 | havoc | 2005-07-05 02:29:08 -0700 (Tue, 05 Jul 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_main.h

use size_t less

------------------------------------------------------------------------
r5495 | havoc | 2005-07-05 02:24:26 -0700 (Tue, 05 Jul 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_ogg.c

more size_t

------------------------------------------------------------------------
r5494 | havoc | 2005-07-05 02:22:15 -0700 (Tue, 05 Jul 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/zone.h

use size_t even more

------------------------------------------------------------------------
r5493 | havoc | 2005-07-05 02:21:21 -0700 (Tue, 05 Jul 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/zone.h

use size_t more

------------------------------------------------------------------------
r5492 | havoc | 2005-07-05 02:10:43 -0700 (Tue, 05 Jul 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_main.h
   M /trunk/darkplaces/snd_mix.c
   M /trunk/darkplaces/snd_ogg.c
   M /trunk/darkplaces/sys_win.c
   M /trunk/darkplaces/zone.c
   M /trunk/darkplaces/zone.h

changed some things to size_t to reduce warnings on MSVC x64

------------------------------------------------------------------------
r5491 | havoc | 2005-07-04 23:53:11 -0700 (Mon, 04 Jul 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/fs.h

made FS_WriteFile's len parameter size_t to fix some warnings

------------------------------------------------------------------------
r5490 | havoc | 2005-07-04 03:10:38 -0700 (Mon, 04 Jul 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

fix problems with missing cubemap textures in GLSL

------------------------------------------------------------------------
r5489 | havoc | 2005-07-04 02:52:13 -0700 (Mon, 04 Jul 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix a crash when doing vid_restart or r_restart with detailtexturing on

------------------------------------------------------------------------
r5488 | havoc | 2005-07-04 02:51:35 -0700 (Mon, 04 Jul 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

fix a typo

------------------------------------------------------------------------
r5487 | havoc | 2005-07-04 02:44:45 -0700 (Mon, 04 Jul 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

default developer_texturelogging to 0, don't know why it was 1

------------------------------------------------------------------------
r5486 | havoc | 2005-07-04 01:35:48 -0700 (Mon, 04 Jul 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/keys.c

allow escape to togglemenu when in fullscreen console

------------------------------------------------------------------------
r5485 | tomaz | 2005-07-04 01:12:58 -0700 (Mon, 04 Jul 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_wgl.c

Fixed it so vertical syns is applied correctly at init.

------------------------------------------------------------------------
r5484 | black | 2005-07-03 04:23:47 -0700 (Sun, 03 Jul 2005) | 4 lines
Changed paths:
   M /trunk/darkplaces/cvar.c
   M /trunk/darkplaces/cvar.h
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/prvm_exec.c
   M /trunk/darkplaces/prvm_execprogram.h
   M /trunk/darkplaces/svvm_cmds.c

-Moved findflags and findchainflags to the prvm_cmds.c.
-Added support for default values to the cvar system.
-Added a cvar_defstring builtin to the vm.

------------------------------------------------------------------------
r5483 | havoc | 2005-07-03 02:01:09 -0700 (Sun, 03 Jul 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_shadow.c

fix bug that made pants/shirt not render in rtlighting (logic was backwards on the fullbright color range checks)
fix bug that rendered specular multiple times (brighter than inended) when using GLSL shader path on colormapped entities

------------------------------------------------------------------------
r5482 | havoc | 2005-07-03 00:07:34 -0700 (Sun, 03 Jul 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

don't print PRVM_NAME in each dprint call, it looks terrible (prints multiple times per line because of multiple dprint calls without \n)
fix fatal bug in findchain and findchainfloat which were using FindFieldOffset (which returns a byte array index) to get an offset to feed to PRVM_E_INT (which takes an integer array index)

------------------------------------------------------------------------
r5481 | havoc | 2005-07-02 04:03:25 -0700 (Sat, 02 Jul 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/protocol.c

fix bug in parsing PROTOCOL_DARKPLACES1/2/3/4 angles

------------------------------------------------------------------------
r5480 | havoc | 2005-07-01 20:06:23 -0700 (Fri, 01 Jul 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

fix Black's mistake of using 'long' (32bit/64bit depending on architecture) type in reading .lno files, changed to int (32bit) so that the code works on 64bit architectures

------------------------------------------------------------------------
r5479 | havoc | 2005-07-01 19:56:48 -0700 (Fri, 01 Jul 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

fix a problem with shadows being cut short from models near the edge of light radius (use model->radius*2 not model->radius)

------------------------------------------------------------------------
r5478 | havoc | 2005-07-01 19:55:56 -0700 (Fri, 01 Jul 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

changed two comments from saying long to int

------------------------------------------------------------------------
r5477 | havoc | 2005-07-01 15:39:31 -0700 (Fri, 01 Jul 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

allow multiple lightning beams owned by world

------------------------------------------------------------------------
r5476 | havoc | 2005-07-01 00:04:40 -0700 (Fri, 01 Jul 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_execprogram.h
   M /trunk/darkplaces/sv_main.c

forbid world writes after precache stage (without using sv.state, instead prog->allowworldwrites was added)

------------------------------------------------------------------------
r5475 | havoc | 2005-06-30 23:58:09 -0700 (Thu, 30 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

changed shadow projection length to use model->radius*2 instead of model->radius

------------------------------------------------------------------------
r5474 | havoc | 2005-06-29 16:03:32 -0700 (Wed, 29 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

stop searching for a server port when one is found

------------------------------------------------------------------------
r5473 | havoc | 2005-06-29 15:45:28 -0700 (Wed, 29 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c

added knownstrings_freeable array to prog struct so that attempts to free engine strings are detected and cause a PRVM_FreeString error (rather than a Mem_Free error)

------------------------------------------------------------------------
r5470 | havoc | 2005-06-28 16:10:21 -0700 (Tue, 28 Jun 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

default offsetmapping off (as it messes up model skins)
fixed permutation failure prints (now lists all 6 flags not just 4)

------------------------------------------------------------------------
r5469 | havoc | 2005-06-28 15:29:47 -0700 (Tue, 28 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

374

------------------------------------------------------------------------
r5468 | black | 2005-06-28 14:09:58 -0700 (Tue, 28 Jun 2005) | 4 lines
Changed paths:
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/todo

-Added sv_playerphysicsqc to control whether the qc physics function is called (if its available).
-Added support for loading LNO files (more to follow soon).
-The server now tries other ports (up to 100 above default) if the default port cant be bound.

------------------------------------------------------------------------
r5467 | havoc | 2005-06-28 12:23:36 -0700 (Tue, 28 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c

patch from christian holmberg to make XK_section key (I do not know what this is) type ~ character for binds

------------------------------------------------------------------------
r5466 | havoc | 2005-06-27 22:59:39 -0700 (Mon, 27 Jun 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

removed r_editlights_rtlightssizescale and r_editlights_rtlightscolorscale cvars (now they behave as if they were both 1.0)
added r_editlights_edit commands radiusscale sizescale and colorscale (use these to fix old-format .rtlights files)

------------------------------------------------------------------------
r5465 | havoc | 2005-06-27 16:07:28 -0700 (Mon, 27 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.h

increased server browser viewlist limit (was 128) to match the serverlist limit (2048)

------------------------------------------------------------------------
r5464 | black | 2005-06-26 12:56:39 -0700 (Sun, 26 Jun 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.h
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/sbar.c
   M /trunk/darkplaces/todo

-"add color code to start of chat message to prevent nick colors from messing up the text color"
-updated a few todo items.

------------------------------------------------------------------------
r5463 | havoc | 2005-06-25 17:51:03 -0700 (Sat, 25 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

removed "%s changed model to %s" message on .playermodel changes (it was unintended)

------------------------------------------------------------------------
r5462 | havoc | 2005-06-25 14:51:35 -0700 (Sat, 25 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

q3 shader parser was not supporting alphatest (promoted to alphablend) without trans parm

------------------------------------------------------------------------
r5461 | havoc | 2005-06-22 10:43:32 -0700 (Wed, 22 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

removed SV_SetOnGround, this cures the bunnyhopping bug (failure to jump again when hitting the ground)

------------------------------------------------------------------------
r5460 | havoc | 2005-06-22 10:35:17 -0700 (Wed, 22 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/collision.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/r_lerpanim.c
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_wav.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/svvm_cmds.c
   M /trunk/darkplaces/world.c

changed a lot of Host_Error calls to Con_Printf or Sys_Error according to severity

------------------------------------------------------------------------
r5458 | havoc | 2005-06-19 18:50:29 -0700 (Sun, 19 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/fractalnoise.c
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/r_modules.c
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_mem.c
   M /trunk/darkplaces/sys_linux.c
   M /trunk/darkplaces/sys_win.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_wgl.c

changed most Sys_Error calls to Con_Printf with appropriate error returns

------------------------------------------------------------------------
r5457 | havoc | 2005-06-19 18:35:52 -0700 (Sun, 19 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces-dedicated.dsp
   M /trunk/darkplaces/darkplaces-sdl.dsp
   M /trunk/darkplaces/darkplaces.dsp

removed winding.[ch] files from dsp files

------------------------------------------------------------------------
r5456 | havoc | 2005-06-19 18:30:33 -0700 (Sun, 19 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.inc
   D /trunk/darkplaces/winding.c
   D /trunk/darkplaces/winding.h

removed winding.[ch] as they were not used

------------------------------------------------------------------------
r5455 | havoc | 2005-06-19 16:52:18 -0700 (Sun, 19 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/keys.h

removed two unused Key_Event implementations (which let me remove some unused variables like menukeys and consolekeys to save several K of memory), cleaned up keys.h externs

------------------------------------------------------------------------
r5454 | havoc | 2005-06-19 16:02:51 -0700 (Sun, 19 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/keys.c

changed keydown[] from unsigned int holding key repeat count to qbyte holding status (0 = up, 1 = down, 2 = repeating) to save 3K of memory

------------------------------------------------------------------------
r5453 | havoc | 2005-06-19 15:56:43 -0700 (Sun, 19 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/keys.c

removed keydown[] and renamed key_repeats[] to keydown[] (overall the code looks the same, but this saves 1K of memory)

------------------------------------------------------------------------
r5452 | havoc | 2005-06-19 12:04:00 -0700 (Sun, 19 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/keys.c

cleaned up Key_Event, this changed toggleconsole bind behavior (it now only works while in key_game mode, like all other normal binds)

------------------------------------------------------------------------
r5451 | havoc | 2005-06-19 10:52:13 -0700 (Sun, 19 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/keys.c

removed shift_down variable, use keydown[K_SHIFT] instead

------------------------------------------------------------------------
r5450 | havoc | 2005-06-19 10:47:30 -0700 (Sun, 19 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

better detection of model load failures in viewmodel command

------------------------------------------------------------------------
r5449 | havoc | 2005-06-19 10:46:59 -0700 (Sun, 19 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

don't complain about missing bolt3/beam models

------------------------------------------------------------------------
r5448 | havoc | 2005-06-19 10:42:47 -0700 (Sun, 19 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/keys.c

removed 3 unused variables

------------------------------------------------------------------------
r5447 | black | 2005-06-19 09:42:43 -0700 (Sun, 19 Jun 2005) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/sv_main.c

-Added support for 515]'s BX_COLOREDTEXT extension.
-Changed fopen's and fclose's log ouput a bit (to include the prvm name)
-Fixed a stupid bug in the SV VM that caused it to crash on error.

------------------------------------------------------------------------
r5446 | havoc | 2005-06-18 18:10:38 -0700 (Sat, 18 Jun 2005) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/host.c

removed CL_InitTEnts function, moved its contents (cl_sfx precaches) to CL_ParseServerInfo
removed beam precaches from the beam parsing code to CL_ParseServerInfo so that the precaches are made each level (when it unloads models/sounds) rather than only once (ever!) during the game, this fixed crashes and rendering issues (using the wrong model) with lightning beams
renamed cl_sfx_ and cl_model_ from cl_ prefix to cl. prefix now that they are part of the per-level state

------------------------------------------------------------------------
r5445 | havoc | 2005-06-18 17:59:52 -0700 (Sat, 18 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

before calling SetNewParms qc function, set self to world to intentionally cause errors with broken SetNewParms code in some mods

------------------------------------------------------------------------
r5444 | havoc | 2005-06-18 17:55:58 -0700 (Sat, 18 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_explosion.c

remove unused frametime calculation

------------------------------------------------------------------------
r5443 | havoc | 2005-06-16 15:43:37 -0700 (Thu, 16 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

replace control characters (such as newline) with _ in savegame comments, this fixes loading savegames in 'dungeon.bsp' of The Ascension of Vigil, and probably some other maps that use newlines in their titles (nasty)

------------------------------------------------------------------------
r5442 | tomaz | 2005-06-15 09:26:54 -0700 (Wed, 15 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/lhfont.h

Fixed the embedded lhfont some more.

------------------------------------------------------------------------
r5441 | havoc | 2005-06-14 20:54:14 -0700 (Tue, 14 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.inc

use sdl-config --static-libs on Mac

------------------------------------------------------------------------
r5440 | tomaz | 2005-06-14 20:26:48 -0700 (Tue, 14 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c

Added saving of gfx/generated_conchars.tga

------------------------------------------------------------------------
r5439 | havoc | 2005-06-14 19:21:15 -0700 (Tue, 14 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

print a different fopen message if it failed

------------------------------------------------------------------------
r5438 | havoc | 2005-06-14 18:55:55 -0700 (Tue, 14 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

added debug prints to FRIK_FILE fopen/fclose builtins

------------------------------------------------------------------------
r5436 | havoc | 2005-06-14 15:45:38 -0700 (Tue, 14 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

strlwr does not exist on Linux

------------------------------------------------------------------------
r5435 | black | 2005-06-14 12:26:27 -0700 (Tue, 14 Jun 2005) | 5 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/netconn.c

-reconnect wont work if being called from the console (it never did but now
 it wont get you into this 'zombie' state).
-changed the severlist string compare function to convert all strings to
 lowercase before comparing.

------------------------------------------------------------------------
r5434 | havoc | 2005-06-14 10:52:20 -0700 (Tue, 14 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.inc

attempting to make darkplaces able to compile as 32bit on 64bit host systems (by feeding -m32 as CPUOPTIMIZATIONS on commandline)

------------------------------------------------------------------------
r5433 | tomaz | 2005-06-13 09:25:12 -0700 (Mon, 13 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

373

------------------------------------------------------------------------
r5432 | tomaz | 2005-06-13 09:13:43 -0700 (Mon, 13 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

Added gl_picmip slider and r_restart button to Graphics menu ("Texture Quality" and "Renderer Restart")

------------------------------------------------------------------------
r5431 | tomaz | 2005-06-13 07:54:52 -0700 (Mon, 13 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_demo.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/keys.c

added -demo and -demolooponly options. -demo starts the wanted demo and then shuts down the engine once done. -demolooponly does pretty mucht the same except it disables all keys but the escape key and makes escape key quit the engine.

------------------------------------------------------------------------
r5430 | havoc | 2005-06-13 05:05:14 -0700 (Mon, 13 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

376

------------------------------------------------------------------------
r5429 | havoc | 2005-06-12 18:18:00 -0700 (Sun, 12 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

fix two signed/unsigned mismatch warnings reported by Willis

------------------------------------------------------------------------
r5428 | black | 2005-06-12 09:34:03 -0700 (Sun, 12 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

Fixed a VC runtime assertion caused by wishdir not being initialized when wishspeed equals zero.

------------------------------------------------------------------------
r5427 | black | 2005-06-11 11:49:09 -0700 (Sat, 11 Jun 2005) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/cl_screen.h
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/sbar.c

-The new Key_Event is enabled by default now and Ive added a check so the
console toggle char is only added to the message line or console input if it is
the color tag char.
-Some name changes of the colored string constants.

------------------------------------------------------------------------
r5426 | black | 2005-06-11 11:20:26 -0700 (Sat, 11 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/menu.h
   M /trunk/darkplaces/progsvm.h

Increased maximum edict count to 4096

------------------------------------------------------------------------
r5425 | black | 2005-06-11 11:12:42 -0700 (Sat, 11 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

Missing ';' :(

------------------------------------------------------------------------
r5424 | black | 2005-06-11 11:01:41 -0700 (Sat, 11 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

Rewrote of DrawQ_ColoredString (fixing some bugs hopefully).

------------------------------------------------------------------------
r5423 | havoc | 2005-06-11 09:42:02 -0700 (Sat, 11 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/client.h

split CL_ClientMovement into CL_ClientMovement_Input (called each input packet) and CL_ClientMovement_Replay (called each frame) functions to cure a feedback loop that could freeze up a client with a full prediction queue (prediction became slower with each queue item, and the server was not affected by the slowness of the replay, so it could keep the client busy with an endless packet stream and the client would never catch up)

------------------------------------------------------------------------
r5422 | molivier | 2005-06-11 06:12:43 -0700 (Sat, 11 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

Basic support for Q3's "getstatus" message, for a better integration with Q3 compatible server browsers. Thanks to divVerent for an early version of this patch

------------------------------------------------------------------------
r5421 | havoc | 2005-06-10 17:44:08 -0700 (Fri, 10 Jun 2005) | 4 lines
Changed paths:
   M /trunk/darkplaces/filematch.c
   M /trunk/darkplaces/fs.c

changed searchpath directories to have a trailing / (allowing %s%s instead of %s/%s for more consistency)
fixed FS_Search to support empty paths (*.cfg and such), and use %s%s concatenation as the rest of the filesystem does, this required changing listdirectory slightly
some cleanup of the opendir implementation of listdirectory

------------------------------------------------------------------------
r5420 | havoc | 2005-06-10 17:38:24 -0700 (Fri, 10 Jun 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/netconn.c

sv_public now defaults to 0 except on dedicated servers
cleaned up Host_ServerOptions code significantly

------------------------------------------------------------------------
r5419 | molivier | 2005-06-10 00:04:14 -0700 (Fri, 10 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/makefile.bsd
   M /trunk/darkplaces/makefile.inc

Fixed direct compilation of subtargets (cl-release, sv-debug, ...)

------------------------------------------------------------------------
r5418 | havoc | 2005-06-09 16:26:19 -0700 (Thu, 09 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cd_linux.c

patch from Zero_Dogg to fix a compile problem on Mandriva Linux

------------------------------------------------------------------------
r5417 | molivier | 2005-06-09 16:21:47 -0700 (Thu, 09 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.bsd

Fixed a typo in the BSD makefile

------------------------------------------------------------------------
r5416 | havoc | 2005-06-09 09:28:57 -0700 (Thu, 09 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

added r_shadow_glsl_geforcefxlowquality cvar (automatically on if running a GeForce FX card) to use half floats instead of full floats where possible, and r_shadow_glsl_surfacenormalize cvar (slight quality improvement to bumpmapping)

------------------------------------------------------------------------
r5415 | havoc | 2005-06-09 07:26:43 -0700 (Thu, 09 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/portals.c

remove two unused variables

------------------------------------------------------------------------
r5414 | havoc | 2005-06-09 04:57:24 -0700 (Thu, 09 Jun 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/cg_math.h
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/mathlib.c
   M /trunk/darkplaces/mathlib.h
   M /trunk/darkplaces/portals.c
   M /trunk/darkplaces/r_shadow.c

replaced uses of VectorNormalizeFast with VectorNormalize as it was broken on x86_64 (probably just because it used long * casts of floats) and was never much faster on modern CPUs anyway
made a lot of internal functions in portals.c static, and replaced two vector subtracts and a crossproduct with TriangleNormal

------------------------------------------------------------------------
r5413 | havoc | 2005-06-09 04:55:07 -0700 (Thu, 09 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

round off ping listings to nearest integer

------------------------------------------------------------------------
r5412 | black | 2005-06-08 14:19:43 -0700 (Wed, 08 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

Changed the Host_Error calls in the string indexing functions to PRVM_ERROR calls.

------------------------------------------------------------------------
r5411 | black | 2005-06-08 13:12:37 -0700 (Wed, 08 Jun 2005) | 4 lines
Changed paths:
   M /trunk/darkplaces/keys.c

New Key_Event is still disabled.
Changed it back, so keys bound to toggleconsole that arent used as
console keys can hide the console again when pressed in the console.

------------------------------------------------------------------------
r5410 | molivier | 2005-06-08 05:24:28 -0700 (Wed, 08 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces-dedicated.dev
   M /trunk/darkplaces/darkplaces.dev

Updated Dev-C++ project files

------------------------------------------------------------------------
r5409 | molivier | 2005-06-07 23:06:44 -0700 (Tue, 07 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/makefile.bsd
   M /trunk/darkplaces/makefile.inc

Changed default sound module for linux to ALSA. Modified makefiles to allow people to choose the sound module easily at compile time (ex: "make DP_SOUND_API=OSS release" compiles release binaries with OSS sound output). Available sound modules are: NULL, OSS, ALSA, BSD, WIN, and COREAUDIO (not functional yet).

------------------------------------------------------------------------
r5408 | black | 2005-06-07 13:55:08 -0700 (Tue, 07 Jun 2005) | 11 lines
Changed paths:
   M /trunk/darkplaces/keys.c

My Key_Event is disabled (yet).
-Changed it to only toggle the console with ESCAPE when you're in the console,
 so binding toggleconsole to a normal key wont toggle it while typing.
-Changed the panic console key to shift-escape since ctrl-escape open the start
 menu.
Feel free to test it.
@ETG: since I can probably only reach you this way: it is intended that the console
toggle key now appears in the console input line and is also send to e.g. message.
This is because the color tag ^ key opens the console on some keyboard layouts and
couldnt be typed in otherwise.

------------------------------------------------------------------------
r5407 | eviltypeguy | 2005-06-06 19:14:38 -0700 (Mon, 06 Jun 2005) | 4 lines
Changed paths:
   M /trunk/darkplaces/keys.c

Disabling black's key code:
* Breaks US keyboard console access
* Breaks input for US keyboard, causing bizarre input problems and choppy MP gameplay

------------------------------------------------------------------------
r5406 | black | 2005-06-06 13:37:00 -0700 (Mon, 06 Jun 2005) | 10 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/cl_screen.h
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/sbar.c
   M /trunk/darkplaces/vid_wgl.c

If the new Key_Event breaks anything for you, you can set #if 0 and activate the old
one again.
-Moved _Con_DrawString to cl_screen and changed its name to DrawQ_ColoredString.
-Changed all the code to allow colored nicks.
-Changed Win32 code to support two-char keys (it takes the second byte - may
 need some more testing).
-Rewrote Key_Event to support typing in the ^ key on Germany keyboards (or
 at least mine). Press ^ two times, once to open the console and once to close it.
 If you type in a message, there will be a ^ char waiting for you (same in the  console if   you open it again).

------------------------------------------------------------------------
r5405 | havoc | 2005-06-06 00:24:26 -0700 (Mon, 06 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_user.c

use only the latest ping time, not averaged

------------------------------------------------------------------------
r5404 | havoc | 2005-06-06 00:23:24 -0700 (Mon, 06 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

removed one variable too many

------------------------------------------------------------------------
r5403 | havoc | 2005-06-06 00:22:59 -0700 (Mon, 06 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

fix two warnings after the last commit

------------------------------------------------------------------------
r5402 | havoc | 2005-06-06 00:20:12 -0700 (Mon, 06 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

use latest ping from client struct rather than averaging ping_times

------------------------------------------------------------------------
r5401 | havoc | 2005-06-05 23:34:27 -0700 (Sun, 05 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

fix crouch button to be the right one

------------------------------------------------------------------------
r5400 | havoc | 2005-06-05 20:53:13 -0700 (Sun, 05 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_exec.c

fixed a PRVM_Crash crash when progs was NULL

------------------------------------------------------------------------
r5399 | havoc | 2005-06-05 03:41:03 -0700 (Sun, 05 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/protocol.c

fixed the 'floating models' bug (EntityFrame5_WriteFrame was inconsistent with its maxedicts)

------------------------------------------------------------------------
r5398 | havoc | 2005-06-05 02:27:19 -0700 (Sun, 05 Jun 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c

fix lagged prydon cursor trace bug (it was using renderer variables, now uses V_CalcRefdef to get an up to date view matrix before this frame is even rendered)
fixed 'shooting at world origin' bug due to a misplaced CL_UpdatePrydonCursor call (now in CL_SendMove so it works properly)

------------------------------------------------------------------------
r5397 | havoc | 2005-06-05 02:24:24 -0700 (Sun, 05 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c

use TEXF_CLAMP on Draw_CachePic (except for the color control ditherpattern)

------------------------------------------------------------------------
r5396 | havoc | 2005-06-05 02:18:42 -0700 (Sun, 05 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c

don't hit your own model with cl_prydoncursor traces

------------------------------------------------------------------------
r5395 | havoc | 2005-06-05 01:34:43 -0700 (Sun, 05 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sv_user.c

fixed impulse lossage problem (ApplyClientMove wasn't being called during ReadClientMove)

------------------------------------------------------------------------
r5394 | havoc | 2005-06-05 00:12:06 -0700 (Sun, 05 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c

only give shareware warning if running GAME_NORMAL (quake)

------------------------------------------------------------------------
r5393 | black | 2005-06-03 12:36:07 -0700 (Fri, 03 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

Fixed an signed/unsigned warning.

------------------------------------------------------------------------
r5392 | havoc | 2005-06-03 08:43:21 -0700 (Fri, 03 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c

added a small simple optimization of prog->knownstring add/remove

------------------------------------------------------------------------
r5391 | black | 2005-06-03 07:15:59 -0700 (Fri, 03 Jun 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/netconn.h

-Added the cvars net_slist_timeout and net_slist_maxtries.
-The queue know tries to query a server multiple times.

------------------------------------------------------------------------
r5390 | havoc | 2005-06-03 07:15:14 -0700 (Fri, 03 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

fix a cast warning

------------------------------------------------------------------------
r5389 | havoc | 2005-06-03 07:12:18 -0700 (Fri, 03 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c

remove unused PRVM_SetQCString function

------------------------------------------------------------------------
r5388 | havoc | 2005-06-03 07:11:07 -0700 (Fri, 03 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_edict.c

rewrote PRVM_AllocString and PRVM_FreeString to deal with string offsets directly (rather than pointers) to avoid unnecessary GetString/SetString calls

------------------------------------------------------------------------
r5387 | havoc | 2005-06-03 06:36:22 -0700 (Fri, 03 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_exec.c

reset callcount in prvm_profile

------------------------------------------------------------------------
r5386 | havoc | 2005-06-03 05:49:36 -0700 (Fri, 03 Jun 2005) | 4 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

shut down local server when connected to a remote server
some cleaning of NetConn_QueryQueueFrame (and it now goes to sleep when there are no remaining queries to run as an optimization)
added net_slist_queriespersecond and net_slist_queriesperframe cvars

------------------------------------------------------------------------
r5385 | havoc | 2005-06-03 04:05:25 -0700 (Fri, 03 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/keys.c

added ctrl-escape hotkey for console (I know I coded this before...  but apparently it never got committed)

------------------------------------------------------------------------
r5384 | eviltypeguy | 2005-06-02 20:44:39 -0700 (Thu, 02 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.h

Silly me, apparently FNDELAY *is* available if you include sys/file.h on Solaris.

------------------------------------------------------------------------
r5383 | eviltypeguy | 2005-06-02 20:20:59 -0700 (Thu, 02 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/makefile.inc

Changes necessary to build and run on Solaris 10 x86

------------------------------------------------------------------------
r5382 | black | 2005-06-02 14:10:24 -0700 (Thu, 02 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/netconn.h

Added a query queue (test commit so Willis can test it).

------------------------------------------------------------------------
r5381 | black | 2005-06-02 12:21:26 -0700 (Thu, 02 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

Didnt know that Host_StartVideo works this way (called randomly around the code), so now the menu should be loaded at the right time (or just-in-time :))

------------------------------------------------------------------------
r5380 | tomaz | 2005-06-02 12:06:40 -0700 (Thu, 02 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c

Redid the coloring of the embedded font to use random colored pixels to make it look a bit more like the worn look of the original quake conchar.

------------------------------------------------------------------------
r5379 | black | 2005-06-02 12:00:05 -0700 (Thu, 02 Jun 2005) | 6 lines
Changed paths:
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/netconn.c

-Changed host_abortserver to host_abortframe.
-Added a hack to allow the menu crash in Host_Init without it taking down
 the whole host (please intergrate this into the general design somehow ASAP).
-Changed the hostcache code to always add servers at the right position and
 to eject 'worse' servers from the viewlist.

------------------------------------------------------------------------
r5378 | tomaz | 2005-06-02 11:45:19 -0700 (Thu, 02 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/lhfont.h

Updated the embedded font to contain the 2 top rows of signs/chars/thingies. Also made the coloring of it to better match the original quake conchar.

------------------------------------------------------------------------
r5377 | havoc | 2005-06-02 04:42:18 -0700 (Thu, 02 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/gl_draw.c

fix some potential buffer overflows

------------------------------------------------------------------------
r5376 | havoc | 2005-06-02 02:51:34 -0700 (Thu, 02 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/image.c

fix a stack smash possibility in loadimagepixels

------------------------------------------------------------------------
r5375 | havoc | 2005-06-02 02:02:55 -0700 (Thu, 02 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

fix two severe geometry bugs in the zym loader

------------------------------------------------------------------------
r5374 | black | 2005-06-01 12:21:09 -0700 (Wed, 01 Jun 2005) | 11 lines
Changed paths:
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/prvm_exec.c
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/server.h

-Added Host_AbortCurrentFrame to hide the longjump and make it usable by
 the VM error functions.
-Moved the static variables of Host_Error into the function body.
-Changed the definition of error_cmd to be called instead of Host_Error,
 so the VM control code is in full control of the error processing.
-Added MP_Error to the menu, so a menu crash wont shutdown the server anymore.
-Fixed an annying bug caused by a typo, that crashes Nexuiz if you query for
 a string in the serverlist.
-PRVM_Crash resets the prog pointer now.
-PRVM_Begin use Con_Printf again (but PRVM_DEBUGPRSTACK has been disabled again).

------------------------------------------------------------------------
r5373 | havoc | 2005-06-01 01:38:30 -0700 (Wed, 01 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_sdl.c

enable unicode and keyrepeat every time a video mode is initialized, this seems to fix the bug where typing stops working after a vid_restart

------------------------------------------------------------------------
r5372 | havoc | 2005-06-01 01:37:33 -0700 (Wed, 01 Jun 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/client.h

shortened movement queue back to 64 items to prevent a runaway loop (falling behind and not being able to run the collisions fast enough) in Nexuiz maps on my machine

------------------------------------------------------------------------
r5371 | havoc | 2005-05-31 21:03:43 -0700 (Tue, 31 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

fix some crashes with server commands (kick, view* commands)

------------------------------------------------------------------------
r5370 | havoc | 2005-05-31 17:55:06 -0700 (Tue, 31 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/sys_shared.c

less confusing messages from Sys_LoadLibrary

------------------------------------------------------------------------
r5369 | havoc | 2005-05-31 17:05:49 -0700 (Tue, 31 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/sys_shared.c

it helps to mangle the correct string...

------------------------------------------------------------------------
r5368 | havoc | 2005-05-31 16:59:51 -0700 (Tue, 31 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/sys_shared.c

fix the library search code (replaced / with 0, should've kept it and replaced the next character)

------------------------------------------------------------------------
r5367 | havoc | 2005-05-31 16:48:57 -0700 (Tue, 31 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/sys_shared.c

made Sys_LoadLibrary search in the executable path if the normal load fails (this should help on Mac OSX)

------------------------------------------------------------------------
r5366 | havoc | 2005-05-31 15:35:40 -0700 (Tue, 31 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fixed Mod_Q3BSP_LoadPlanes to use LittleFloat instead of LittleLong

------------------------------------------------------------------------
r5365 | havoc | 2005-05-31 15:00:06 -0700 (Tue, 31 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c

print to console before printing to terminal (which needs mangled characters), why was this backwards?

------------------------------------------------------------------------
r5364 | havoc | 2005-05-30 16:10:50 -0700 (Mon, 30 May 2005) | 2 lines
Changed paths:
   A /trunk/darkplaces/Darkplaces.app
   A /trunk/darkplaces/Darkplaces.app/Contents
   A /trunk/darkplaces/Darkplaces.app/Contents/Info.plist
   A /trunk/darkplaces/Darkplaces.app/Contents/PkgInfo
   A /trunk/darkplaces/Darkplaces.app/Contents/Resources
   A /trunk/darkplaces/Darkplaces.app/Contents/Resources/._Darkplaces.icns
   A /trunk/darkplaces/Darkplaces.app/Contents/Resources/Darkplaces.icns
   A /trunk/darkplaces/Darkplaces.app/Contents/Resources/English.lproj
   A /trunk/darkplaces/Darkplaces.app/Contents/Resources/English.lproj/InfoPlist.strings

.app directory for Mac OSX builds

------------------------------------------------------------------------
r5363 | havoc | 2005-05-30 16:09:32 -0700 (Mon, 30 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

don't echo player messages if not a dedicated server (as it produces double echoes)

------------------------------------------------------------------------
r5362 | havoc | 2005-05-30 15:34:17 -0700 (Mon, 30 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

pick apart com_argv[0] to find basedir in Mac OSX when running from a .app package

------------------------------------------------------------------------
r5361 | havoc | 2005-05-30 14:58:45 -0700 (Mon, 30 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

try to detect a .app package in MacOSX and use a basedir outside the .app

------------------------------------------------------------------------
r5360 | havoc | 2005-05-30 14:10:24 -0700 (Mon, 30 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

reenabled echoing of player messages to server console (why were they disabled??)

------------------------------------------------------------------------
r5359 | havoc | 2005-05-30 03:31:05 -0700 (Mon, 30 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/keys.c

rewrote character insertion/replacement in console commandline, fixing all known bugs with it and reducing code

------------------------------------------------------------------------
r5358 | havoc | 2005-05-30 01:38:51 -0700 (Mon, 30 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/snd_main.c

made bmodel trails (if anyone ever dares to try them) come from the center of the bmodel, this also cleaned up the sound code (and fixed a weird bug with a sound played in the same frame as an entity is removed)

------------------------------------------------------------------------
r5357 | havoc | 2005-05-30 01:37:12 -0700 (Mon, 30 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces-dedicated.dsp
   M /trunk/darkplaces/darkplaces-sdl.dsp
   M /trunk/darkplaces/darkplaces.dsp

updated dsp files from Willis

------------------------------------------------------------------------
r5356 | havoc | 2005-05-30 01:36:25 -0700 (Mon, 30 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

disable some effect sounds in nexuiz

------------------------------------------------------------------------
r5355 | havoc | 2005-05-29 23:42:41 -0700 (Sun, 29 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

ignore RENDER_VIEWMODEL if tagentity is set

------------------------------------------------------------------------
r5354 | havoc | 2005-05-29 15:48:49 -0700 (Sun, 29 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

default protocol changed to DP7

------------------------------------------------------------------------
r5353 | havoc | 2005-05-29 15:48:14 -0700 (Sun, 29 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c

fixed EF_NODEPTHTEST support on q1bsp/q3bsp/models

------------------------------------------------------------------------
r5352 | havoc | 2005-05-29 15:47:06 -0700 (Sun, 29 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

disabled cl_movement when in intermission

------------------------------------------------------------------------
r5351 | havoc | 2005-05-29 15:31:38 -0700 (Sun, 29 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

361

------------------------------------------------------------------------
r5350 | havoc | 2005-05-29 15:28:20 -0700 (Sun, 29 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/svvm_cmds.c
   M /trunk/dpmod/qc/dpextensions.qc

added DP_QUAKE3_MAP extension

------------------------------------------------------------------------
r5349 | havoc | 2005-05-29 14:29:11 -0700 (Sun, 29 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

disable h2ohit.wav in GAME_NEXUIZ

------------------------------------------------------------------------
r5348 | black | 2005-05-29 06:11:22 -0700 (Sun, 29 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

Added back pr_checkextension.

------------------------------------------------------------------------
r5347 | black | 2005-05-29 05:51:42 -0700 (Sun, 29 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c

Quick fix for the "0 not loaded" bug (error on trying to connect to a server).

------------------------------------------------------------------------
r5346 | havoc | 2005-05-28 23:17:40 -0700 (Sat, 28 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_user.c

fix bug causing impulses to often be lost

------------------------------------------------------------------------
r5345 | havoc | 2005-05-28 21:58:38 -0700 (Sat, 28 May 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/makefile.inc
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/sv_main.c

fixed makefile (it is not possible to comment out lines with \ at the end)
fixed two warnings

------------------------------------------------------------------------
r5344 | black | 2005-05-27 08:43:48 -0700 (Fri, 27 May 2005) | 11 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/makefile.inc
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/pr_exec.c
   M /trunk/darkplaces/pr_execprogram.h
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_cmds.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/prvm_exec.c
   M /trunk/darkplaces/prvm_execprogram.h
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_move.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sv_user.c
   A /trunk/darkplaces/svvm_cmds.c
   M /trunk/darkplaces/world.c
   M /trunk/darkplaces/world.h

-CVS: ----------------------------------------------------------------------
-Merged the old VM into the new one. The pr_* files are mess right now and
 will be removed as soon as they are not needed as semi-reference (to trace
 bugs)
-There is a certain risk that the server could crash now and then since some
 parts of the code can only be debugged (- checking them by looking at the code
 would be quite tedious to put it nicely)
-Changed all references to the old VM to point to the new VM (also hopefully
 all todo items)
-Im working on a cleanup for the SV_VM_Begin/End mess.

------------------------------------------------------------------------
r5342 | tomaz | 2005-05-25 02:25:52 -0700 (Wed, 25 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.dsp

Way to tired... Fixed all 3 project files to include mvm_cmds.c and made sure all used headers are in the header section.

------------------------------------------------------------------------
r5341 | tomaz | 2005-05-25 02:24:07 -0700 (Wed, 25 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces-dedicated.dsp
   M /trunk/darkplaces/darkplaces-sdl.dsp

darkplaces.dsp

------------------------------------------------------------------------
r5340 | black | 2005-05-25 02:07:38 -0700 (Wed, 25 May 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_edict.c

-LoadProgs now expects to be called after InitProg, so it wont do any
 unnecessary clean-ups.

------------------------------------------------------------------------
r5339 | havoc | 2005-05-25 01:55:24 -0700 (Wed, 25 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.dsp

patch from Willis to add mvm_cmds.c

------------------------------------------------------------------------
r5338 | havoc | 2005-05-25 01:26:12 -0700 (Wed, 25 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

don't set cl.movement true if cl_movement cvar is off

------------------------------------------------------------------------
r5337 | havoc | 2005-05-25 01:04:25 -0700 (Wed, 25 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/protocol.c

fix bug in last commit (msg->, not buf.)

------------------------------------------------------------------------
r5336 | havoc | 2005-05-25 00:57:04 -0700 (Wed, 25 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/protocol.c

fix an overflow without allowoverflow set error in EntityFrame5 sending of stats

------------------------------------------------------------------------
r5335 | havoc | 2005-05-25 00:25:31 -0700 (Wed, 25 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

default to "DP6" protocol (not "DARKPLACES6")

------------------------------------------------------------------------
r5334 | havoc | 2005-05-25 00:21:29 -0700 (Wed, 25 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

zym models now support TraceBox calls

------------------------------------------------------------------------
r5333 | havoc | 2005-05-25 00:17:44 -0700 (Wed, 25 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c

fix bug with ClientDisconnect not being called if a client drops between "spawn" and "begin" commands, now it is reliably called

------------------------------------------------------------------------
r5332 | havoc | 2005-05-24 17:05:42 -0700 (Tue, 24 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.h

added newline at end of file to hush a gcc warning

------------------------------------------------------------------------
r5331 | havoc | 2005-05-24 17:00:49 -0700 (Tue, 24 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.inc

added mvm_cmds.o

------------------------------------------------------------------------
r5330 | havoc | 2005-05-24 16:58:04 -0700 (Tue, 24 May 2005) | 4 lines
Changed paths:
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/protocol.c

reordered the protocolversion_t values to have preferred protocols first
changed client connect message to list all supported protocols
shortened PROTOCOL_DARKPLACES* names to "DP1" and such to make connect message shorter

------------------------------------------------------------------------
r5329 | black | 2005-05-24 15:30:18 -0700 (Tue, 24 May 2005) | 9 lines
Changed paths:
   A /trunk/darkplaces/mvm_cmds.c
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_cmds.c
   A /trunk/darkplaces/prvm_cmds.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/prvm_execprogram.h

-Split prvm_cmds.c into prvm_cmds.c, prvm_cmds.h and mvm_cmds.c (clvm_cmds.c
 and svm_cmds.c will perhaps be added soon)
-Added another union to prvm_edict_s to have different pointers to the
 edict fields.
-Changed the naming of some fields in prvm_edict_s (longer names instead of
 single letter ones)
-Changed PRVM_LoadProgs to only reset the CMD system if it has be initialized
 before.

------------------------------------------------------------------------
r5328 | havoc | 2005-05-24 15:04:03 -0700 (Tue, 24 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

default to DARKPLACES6 protocol (somehow this was not showing up in my diffs)

------------------------------------------------------------------------
r5327 | havoc | 2005-05-24 14:53:03 -0700 (Tue, 24 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

added onground clearing before each move so that going down slopes doesn't resemble a Road Runner cartoon

------------------------------------------------------------------------
r5326 | havoc | 2005-05-24 14:37:32 -0700 (Tue, 24 May 2005) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/netconn.h
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sv_user.c

rewrote protocol version system (including splitting PROTOCOL_QUAKE into PROTOCOL_QUAKE, PROTOCOL_QUAKEDP, and PROTOCOL_NEHAHRAMOVIE)
made server able to host PROTOCOL_NEHAHRAMOVIE protocol for completeness
added PROTOCOL_DARKPLACES7 protocol (still in development, not enabled by default) which allows players to use QW-style movement messages (makes prediction rock solid but has speedcheat/lagaport potential)

------------------------------------------------------------------------
r5325 | black | 2005-05-24 12:04:49 -0700 (Tue, 24 May 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

-Now netconn also accepts infoRespones from LAN servers when there is no
 master server around �_�

------------------------------------------------------------------------
r5324 | havoc | 2005-05-23 15:29:14 -0700 (Mon, 23 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

NetConn_ReceivedMessage now verifies that the packet's internal length value matches the data length

------------------------------------------------------------------------
r5323 | black | 2005-05-23 15:11:43 -0700 (Mon, 23 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

-Fix checking the length before knowing its actual value(??)

------------------------------------------------------------------------
r5322 | black | 2005-05-23 07:07:00 -0700 (Mon, 23 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

-Fixed a possible buffer overflow bug in NetConn_ReceivedMessage (thanks Spike!)

------------------------------------------------------------------------
r5321 | molivier | 2005-05-23 05:36:03 -0700 (Mon, 23 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_wgl.c

vid_usemouse doesn't need to be a global variable

------------------------------------------------------------------------
r5320 | black | 2005-05-21 15:25:12 -0700 (Sat, 21 May 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/progsvm.h

-Added an comment ('[INIT]') to all fields of vm_prog that can/should be
 initialized after calling PRVM_InitProg.

------------------------------------------------------------------------
r5319 | black | 2005-05-20 12:20:39 -0700 (Fri, 20 May 2005) | 4 lines
Changed paths:
   M /trunk/darkplaces/pr_comp.h
   M /trunk/darkplaces/pr_exec.c
   M /trunk/darkplaces/pr_execprogram.h
   M /trunk/darkplaces/prvm_exec.c
   M /trunk/darkplaces/prvm_execprogram.h

-Added the callcount field to the mfunction_t structure.
-Both vms now record how often a function has been called and the profile cmd
 now outputs the callcount with the other information.

------------------------------------------------------------------------
r5318 | havoc | 2005-05-19 23:33:44 -0700 (Thu, 19 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/sv_user.c

removed unused applytime field from usercmd_t

------------------------------------------------------------------------
r5317 | havoc | 2005-05-19 23:05:32 -0700 (Thu, 19 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/client.h

cleaned up prediction code somewhat, no longer uses times for much (instead storing frametimes)

------------------------------------------------------------------------
r5316 | havoc | 2005-05-19 23:04:36 -0700 (Thu, 19 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

slight cleanup (complete removal) of the "base" variable in surface rendering

------------------------------------------------------------------------
r5315 | havoc | 2005-05-19 14:20:08 -0700 (Thu, 19 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

changed default heartbeat_period to 120 seconds so that usually two packets come in before the 5 minute timeout, this should help with packet loss

------------------------------------------------------------------------
r5314 | havoc | 2005-05-19 11:42:55 -0700 (Thu, 19 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/protocol.c

changed EntityFrame5_ExpandEdicts call from using sv.num_edicts to sv.max_edicts to fix a crash

------------------------------------------------------------------------
r5313 | havoc | 2005-05-18 15:43:23 -0700 (Wed, 18 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/protocol.c

fix lingering tracers in nexuiz (among other possible problems)

------------------------------------------------------------------------
r5312 | havoc | 2005-05-17 23:39:14 -0700 (Tue, 17 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

fixed r_showtris bug (individual state changes were not being ignored in showtris pass

------------------------------------------------------------------------
r5311 | havoc | 2005-05-17 23:38:36 -0700 (Tue, 17 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

added onground tracking to cl_movement code, instead of checking constantly (which caused unintended double jumping/strafe jumping)

------------------------------------------------------------------------
r5310 | havoc | 2005-05-17 21:24:19 -0700 (Tue, 17 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

fix a severe bug with viewangles in cl_movement mode

------------------------------------------------------------------------
r5309 | havoc | 2005-05-17 21:08:47 -0700 (Tue, 17 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

fix interpolation of cl_movement

------------------------------------------------------------------------
r5308 | black | 2005-05-16 08:51:24 -0700 (Mon, 16 May 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

-Fixed some bugs in the altstr functions, now they should work 1:1 like the
 scmenu's ones

------------------------------------------------------------------------
r5307 | havoc | 2005-05-15 22:04:46 -0700 (Sun, 15 May 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sv_user.c

split SV_ReadClientMove into two functions, SV_ReadClientMove and SV_ApplyClientMove
merged away SV_RunClients (part of its code has been moved to SV_Physics)

------------------------------------------------------------------------
r5306 | havoc | 2005-05-15 20:15:34 -0700 (Sun, 15 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

cleaned up suspendedinairflag a bit

------------------------------------------------------------------------
r5305 | havoc | 2005-05-15 20:14:49 -0700 (Sun, 15 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c

removed deadsocket field from server client struct, changed connect handling to resend the serverinfo, but then disabled the reconnect handling entirely (so you can't reclaim your ghost)

------------------------------------------------------------------------
r5304 | havoc | 2005-05-15 20:11:14 -0700 (Sun, 15 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c

added a commented out Con_Printf for debugging spatialization

------------------------------------------------------------------------
r5303 | havoc | 2005-05-15 20:08:04 -0700 (Sun, 15 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/host.c

fix bug that rotated all sounds 90 degrees to the right in Nexuiz (because it has seriously messed up player models)

------------------------------------------------------------------------
r5302 | havoc | 2005-05-15 13:34:29 -0700 (Sun, 15 May 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

changed matrix_attenuation declarations to not be static (since they are externed in the header)
fixed some signedness warnings

------------------------------------------------------------------------
r5301 | havoc | 2005-05-15 11:57:04 -0700 (Sun, 15 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

disabled some of the server client connect code that may be causing problems

------------------------------------------------------------------------
r5300 | havoc | 2005-05-13 23:36:15 -0700 (Fri, 13 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fix a crash with getlighting builtin

------------------------------------------------------------------------
r5299 | havoc | 2005-05-13 23:35:54 -0700 (Fri, 13 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

fix a crash with mdl skingroups

------------------------------------------------------------------------
r5298 | havoc | 2005-05-13 23:32:41 -0700 (Fri, 13 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

an extra Mem_CheckSentinelsGlobal at start of Serverinfo parsing

------------------------------------------------------------------------
r5297 | havoc | 2005-05-13 22:39:59 -0700 (Fri, 13 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

366

------------------------------------------------------------------------
r5296 | havoc | 2005-05-13 22:38:40 -0700 (Fri, 13 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_light.c

added a couple checks to hopefully fix a lit sprite dlight problem (an organe dlight causing a sprite to turn blue suddenly) reported by Cheapy

------------------------------------------------------------------------
r5295 | havoc | 2005-05-13 22:25:25 -0700 (Fri, 13 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

fixed r_drawcollisionbrushes 2

------------------------------------------------------------------------
r5294 | havoc | 2005-05-13 22:17:19 -0700 (Fri, 13 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fix a crash when loading q3 maps with flares

------------------------------------------------------------------------
r5293 | havoc | 2005-05-13 22:05:27 -0700 (Fri, 13 May 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/vid_shared.c

gl_combine cvar is no longer saved
gl_combine cvar is no longer forced off if r_textureunits is less than 2

------------------------------------------------------------------------
r5292 | havoc | 2005-05-13 20:56:53 -0700 (Fri, 13 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/portals.c

fix portal lighting in a single cluster map (box map)

------------------------------------------------------------------------
r5291 | havoc | 2005-05-13 20:47:39 -0700 (Fri, 13 May 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

fixed rtlighting on colormap capable skins
implemented colormapped rtlighting on models

------------------------------------------------------------------------
r5290 | havoc | 2005-05-13 20:25:50 -0700 (Fri, 13 May 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fixed r_shadow_realtime_world_lightmap support in gl_combine 1 mode
fixed animated q1bsp texture support

------------------------------------------------------------------------
r5289 | havoc | 2005-05-13 19:11:04 -0700 (Fri, 13 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

fixed snow fluttering

------------------------------------------------------------------------
r5288 | havoc | 2005-05-13 19:09:54 -0700 (Fri, 13 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cgamevm.c

remove an unneeded cast

------------------------------------------------------------------------
r5287 | havoc | 2005-05-13 18:59:56 -0700 (Fri, 13 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/prvm_edict.c

fix some warnings

------------------------------------------------------------------------
r5286 | havoc | 2005-05-13 16:49:16 -0700 (Fri, 13 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

use Con_Printf instead of Host_Error when an unknown model format is encountered

------------------------------------------------------------------------
r5285 | havoc | 2005-05-13 16:47:58 -0700 (Fri, 13 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

only load .lit file if its file size matches 8 + lump->filelen * 3

------------------------------------------------------------------------
r5284 | havoc | 2005-05-13 16:41:24 -0700 (Fri, 13 May 2005) | 8 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/r_crosshairs.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/sbar.c
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_null.c
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c

replaced all references to vid.conwidth and vid.conheight with vid_conwidth.integer and vid_conheight.integer
replaced all references to vid.realx/vid.realy with 0
replaced all references to vid.realwidth and vid.realheight with vid.width and vid.height
replaced current_vid_* variables with vid. fields (vid.width, vid.height, vid.bitsperpixel, vid.fullscreen)
vid_glx.c: replaced scr_width/height with vid.width/height
vid_wgl.c: replaced window_center_x/y with calculations as needed, and replaced window_width/height with vid.width/height, and some other minor cleanups
removed VID_GetWindowSize function

------------------------------------------------------------------------
r5283 | havoc | 2005-05-13 16:10:38 -0700 (Fri, 13 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_wgl.c

more clean up of IN_Activate, added cl_ignoremousemove to merge some code

------------------------------------------------------------------------
r5282 | havoc | 2005-05-13 15:03:51 -0700 (Fri, 13 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h

corrected envmap saving for ft/rt/bk/lf/up/dn layout (px/py/nx/ny/pz/nz layout already worked fine) and disabled gamma correction on envmap saves

------------------------------------------------------------------------
r5281 | havoc | 2005-05-13 14:30:26 -0700 (Fri, 13 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

fix Mod_BuildAliasSkinsFromSkinFiles to work with the new skin layout, this should fix md3 skin file crashes

------------------------------------------------------------------------
r5280 | havoc | 2005-05-13 14:27:58 -0700 (Fri, 13 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix a warning

------------------------------------------------------------------------
r5279 | havoc | 2005-05-13 14:27:24 -0700 (Fri, 13 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

GAME_NEXUIZ no longer loads a number of gfx/ pics that it does not use

------------------------------------------------------------------------
r5278 | havoc | 2005-05-13 12:41:09 -0700 (Fri, 13 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/cl_screen.h
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/cl_video.h
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/draw.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_user.c
   M /trunk/darkplaces/wad.c
   M /trunk/darkplaces/wad.h

upgraded both QuakeC VMs to use a table of negative string indices for all dynamic strings, this should make everything work on 64bit systems

------------------------------------------------------------------------
r5277 | havoc | 2005-05-12 20:24:13 -0700 (Thu, 12 May 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_shared.h

finished model/map rendering merge, model renderer has been completely removed
model_t num_textures now lies a bit to keep things simple, it equals num_surfaces on models, even if there are multiple skins, in data_textures these extra textures really do exist even though num_textures does not count them (this was done so that UpdateAllTextureInfo won't crash trying to index later skins on the later skins themselves)

------------------------------------------------------------------------
r5276 | havoc | 2005-05-12 14:39:31 -0700 (Thu, 12 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

375 (-1)

------------------------------------------------------------------------
r5275 | havoc | 2005-05-12 13:44:12 -0700 (Thu, 12 May 2005) | 4 lines
Changed paths:
   M /trunk/darkplaces/todo

labeled todo items (at least ones not done yet) with a category before the program name, to prioritize bugfixes over changes and features and so on within a difficulty rating
cleaned out a lot of stale or duplicate todo items
376 (-20)

------------------------------------------------------------------------
r5274 | havoc | 2005-05-12 12:00:35 -0700 (Thu, 12 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

396

------------------------------------------------------------------------
r5273 | havoc | 2005-05-12 11:55:32 -0700 (Thu, 12 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

clear sounds before shutting down

------------------------------------------------------------------------
r5272 | havoc | 2005-05-12 10:53:29 -0700 (Thu, 12 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/keys.c

changed changed commandline history behavior to be more sane

------------------------------------------------------------------------
r5271 | black | 2005-05-11 13:26:12 -0700 (Wed, 11 May 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

-Changed VM_precache_pic to check CachePic for successful loading of the pictures.
 (The old check hasnt worked because CachePic always returns a valid pic pointer.)

------------------------------------------------------------------------
r5270 | havoc | 2005-05-11 11:22:48 -0700 (Wed, 11 May 2005) | 5 lines
Changed paths:
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_alias.h
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/portals.c
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/render.h

the merging of alias and bsp model rendering begins...  purely cosmetic changes in this first step
merged model_alias_t into model_t and removed alias prefixes from those fields
merged model_brush_t surface and texture stuff into model_t (num_surfaces, num_textures, etc)
made alias model code use model_t data_surfaces instead of alias meshes

------------------------------------------------------------------------
r5269 | havoc | 2005-05-11 11:19:48 -0700 (Wed, 11 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

some changes and cleanups to SV_FlyMove, turned off sv_newflymove by default (it just doesn't work right)

------------------------------------------------------------------------
r5268 | havoc | 2005-05-11 11:19:00 -0700 (Wed, 11 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/mathlib.h

added VectorReflect

------------------------------------------------------------------------
r5267 | molivier | 2005-05-11 04:12:01 -0700 (Wed, 11 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

Allocated temporary big buffers in R_BuildDetailTextures instead of having them on the stack (it caused some systems to crash)

------------------------------------------------------------------------
r5266 | havoc | 2005-05-10 11:39:51 -0700 (Tue, 10 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c

added sv_gameplayfix_blowupfallenzombies and sv_gameplayfix_findradiusdistancetobox cvars (to allow these changes to be disabled)

------------------------------------------------------------------------
r5265 | havoc | 2005-05-09 17:30:52 -0700 (Mon, 09 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/image.c

fix inverted normalmaps produced from bumpmaps (directly loaded normalmaps are fine)

------------------------------------------------------------------------
r5264 | havoc | 2005-05-09 16:52:40 -0700 (Mon, 09 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

patch from Willis for some map name changes in Transfusion

------------------------------------------------------------------------
r5263 | havoc | 2005-05-09 15:51:36 -0700 (Mon, 09 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_explosion.c

changed R_NewExplosion check for dead explosions to check time instead of alpha (may fix a bug)

------------------------------------------------------------------------
r5260 | havoc | 2005-05-09 13:43:17 -0700 (Mon, 09 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

389 (-2)

------------------------------------------------------------------------
r5259 | havoc | 2005-05-09 13:26:27 -0700 (Mon, 09 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c

fix VID_Shutdown ungrabs

------------------------------------------------------------------------
r5258 | havoc | 2005-05-09 13:12:36 -0700 (Mon, 09 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

391 (-2)

------------------------------------------------------------------------
r5257 | havoc | 2005-05-09 11:40:50 -0700 (Mon, 09 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

changed blaze.mindphukd.org back to an ip address because the hostname isn't resolving but the ip works fine

------------------------------------------------------------------------
r5256 | havoc | 2005-05-09 08:56:41 -0700 (Mon, 09 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/input.h
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_null.c
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c

major cleanup of input code - CL_Move replaces most of IN_Move, IN_Commands, many internal platform functions refactored to clean up platform code

------------------------------------------------------------------------
r5255 | havoc | 2005-05-09 08:51:19 -0700 (Mon, 09 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/glquake.h

remove qwgl externs, as they are not used outside vid_wgl.c

------------------------------------------------------------------------
r5254 | havoc | 2005-05-09 08:48:07 -0700 (Mon, 09 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

fix a problem with stenciltwoside introduced by recent changes

------------------------------------------------------------------------
r5253 | havoc | 2005-05-09 06:03:18 -0700 (Mon, 09 May 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/cd_shared.c
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/menu.c

fixed problems in the Host_Init Cbuf_InsertText stuff (by changing it to Cbuf_AddText, and some other cleanups)
added Host_StartVideo to a few more places

------------------------------------------------------------------------
r5252 | havoc | 2005-05-09 05:58:05 -0700 (Mon, 09 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cvar.c

changed 3 occurences of very if (developer.integer) Con_Print code to Con_DPrint

------------------------------------------------------------------------
r5251 | havoc | 2005-05-08 12:57:24 -0700 (Sun, 08 May 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/lhnet.c
   M /trunk/darkplaces/netconn.c

implemented caching of DNS names in lhnet.c
changed sv_masterextra* servers back to DNS names (but kept IP addresses as comments, note the dpmaster.deathmask.net IP has changed)

------------------------------------------------------------------------
r5250 | havoc | 2005-05-08 11:32:46 -0700 (Sun, 08 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c

S_LocalSound now uses ATTN_NONE, so menu sounds and such will no longer be centered at world origin

------------------------------------------------------------------------
r5249 | havoc | 2005-05-08 11:28:32 -0700 (Sun, 08 May 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

rewrote the notes on the Creative patent after re-reading it
fixed my incomplete StencilOp changes (reverted back to the way it was before)

------------------------------------------------------------------------
r5248 | havoc | 2005-05-08 06:22:50 -0700 (Sun, 08 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

revised a number of terminology notes at the beginning of r_shadow.c, including notes about the Creative Labs patent on the Carmack's Reverse technique

------------------------------------------------------------------------
r5247 | havoc | 2005-05-08 05:59:38 -0700 (Sun, 08 May 2005) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h
   M /trunk/darkplaces/render.h

added rmesh_t and R_Mesh_AddVertex3f, R_Mesh_AddPolygon3f, R_Mesh_AddBrushMeshFromPlanes functions
R_Shadow_ScissorForBBox now uses R_Mesh_AddBrushMeshFromPlanes function to get an exact clipped box-brush vertex set for calculating scissor area, this should reduce the scissor area used in some cases compared to the old hacky method
added nearclip plane to frustum[] array (only used by R_Shadow_ScissorForBBox)

------------------------------------------------------------------------
r5246 | havoc | 2005-05-08 03:42:51 -0700 (Sun, 08 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/sys_linux.c
   M /trunk/darkplaces/sys_sdl.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_null.c

various printf/fprintf calls are now Con_Printf, and some other minor cleanups

------------------------------------------------------------------------
r5245 | havoc | 2005-05-08 03:42:09 -0700 (Sun, 08 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/progs.h

PR_Alloc/Free/FreeAll now report filename/fileline of their caller in the Mem_ calls, for better readability of "memlist all" reports

------------------------------------------------------------------------
r5244 | havoc | 2005-05-07 11:07:20 -0700 (Sat, 07 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c

rearranged mouse grabbing rules again to force grabbing when fullscreen (for some reason it isn't the active window)

------------------------------------------------------------------------
r5243 | havoc | 2005-05-07 10:53:47 -0700 (Sat, 07 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/portals.c

fix a crash in portal clipping code (forgot to include polygon.h)

------------------------------------------------------------------------
r5242 | havoc | 2005-05-07 07:51:49 -0700 (Sat, 07 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/portals.c

portal code now uses Polygon_DivideF instead of its own polygon clipper

------------------------------------------------------------------------
r5241 | havoc | 2005-05-06 13:03:18 -0700 (Fri, 06 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rmain.c

minor rearrangement of Render_Init

------------------------------------------------------------------------
r5240 | havoc | 2005-05-06 13:01:55 -0700 (Fri, 06 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cmd.c

hush "Unknown command" warnings during startup

------------------------------------------------------------------------
r5239 | havoc | 2005-05-06 13:00:53 -0700 (Fri, 06 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_shared.c

renamed VID_Open to VID_Start, inlined VID_Close ito eliminate the only call to it

------------------------------------------------------------------------
r5238 | havoc | 2005-05-06 12:58:33 -0700 (Fri, 06 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/palette.c

reorganized Palette_Init code

------------------------------------------------------------------------
r5237 | havoc | 2005-05-06 12:43:18 -0700 (Fri, 06 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cd_shared.c
   M /trunk/darkplaces/cl_video.c

playvideo and cd loop/cd play commands now call Host_StartVideo (this fixes a crash and missing menu music respectively in Nexuiz)

------------------------------------------------------------------------
r5236 | havoc | 2005-05-06 05:31:05 -0700 (Fri, 06 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/sys_win.c

fix a misplaced variable

------------------------------------------------------------------------
r5235 | havoc | 2005-05-06 04:37:35 -0700 (Fri, 06 May 2005) | 12 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/cmd.h
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/console.h
   M /trunk/darkplaces/cvar.c
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/sys.h
   M /trunk/darkplaces/sys_linux.c
   M /trunk/darkplaces/sys_sdl.c
   M /trunk/darkplaces/sys_shared.c
   M /trunk/darkplaces/sys_win.c
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c

changed Host_Init to execute configs only once
cleaned up Host_Init (and related functions like Con_Init, COM_Init, Cbuf_Init, etc) a great deal
now uses host_framecount >= 3 checks instead of host_loopactive or host_initialized checks, this should fix any problems with crashes erasing config.cfg
VID_Open and friends are now called from Host_StartVideo which is called by SCR_BeginLoadingPlaque (such as by SV_SpawnServer) as well as the end of Host_Init, this only calls them the first time it is called, so it can be called during config parsing (such as +map start on the commandline)
moved sys_usetimegettime and dedicated server console opening in sys_wgl.c into Sys_InitConsole and Sys_Init_Commands functions called by Host_Init
merged Sys_Shared_EarlyInit and Sys_Shared_LateInit into Host_Init
got rid of sys_usetimegettime (windows-only) cvar in sys_sdl.c
changed type of a number of vid_* variables from int to qboolean
renamed vidmode_active to vid_isfullscreen in vid_glx.c for more code consistency
fixed a bug in vid_glx.c that made it grab the mouse/keyboard even when it was not the active window
no longer grabs mouse while playing demos in a window

------------------------------------------------------------------------
r5234 | havoc | 2005-05-06 04:28:31 -0700 (Fri, 06 May 2005) | 5 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/render.h

moved mod_shared.c detail texture and distortion texture stuff to gl_rmain.c (renamed mod_shared_* to r_texture_*)
got rid of unused mod_q1bsp_novis array
moved Mod_Q1BSP_Collision_Init into the boxhull code (which isn't even used anyway)
made r_restart reload models (as was intended) by making Mod_UnloadModel preserve the ->use field

------------------------------------------------------------------------
r5233 | havoc | 2005-05-06 04:27:18 -0700 (Fri, 06 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/zone.c

changed Mem_FreePool and Mem_EmptyPool to report their caller's filename/fileline when Mem_Free detects an error

------------------------------------------------------------------------
r5232 | havoc | 2005-05-06 01:58:29 -0700 (Fri, 06 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

attachments now inherit RENDER_VIEWMODEL from their parent (they already inherited RENDER_EXTERIORMODEL)

------------------------------------------------------------------------
r5231 | havoc | 2005-05-05 23:09:33 -0700 (Thu, 05 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_modules.c

removed a clear of names in the render modules init code, this allows it to be called AFTER some modules are registered (for a minor cleanup of the Host_Init code)

------------------------------------------------------------------------
r5230 | havoc | 2005-05-05 21:29:25 -0700 (Thu, 05 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.inc

enabled SDL builds by default (in addition to cl and dedicated)

------------------------------------------------------------------------
r5229 | havoc | 2005-05-05 17:36:07 -0700 (Thu, 05 May 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/view.c

added cl.movement_velocity to allow view bobbing to match up with cl_movement
fixed some bugs in cl_movement timing, it now applies input to the next move not the current one, making it work properly (assuming cl_movement_latency is exact)

------------------------------------------------------------------------
r5228 | havoc | 2005-05-05 07:24:24 -0700 (Thu, 05 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c

hush some texture loading warnings in dedicated servers (thanks to Biomass for reporting this)

------------------------------------------------------------------------
r5227 | havoc | 2005-05-05 05:52:07 -0700 (Thu, 05 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_wav.c

added some commented out code that can make a log of stereo wav sounds loaded

------------------------------------------------------------------------
r5226 | havoc | 2005-05-05 05:49:17 -0700 (Thu, 05 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/lhnet.c

cl_netlocalping now adds only half as much lag, so that the number specified is roughly what it will achieve

------------------------------------------------------------------------
r5225 | black | 2005-05-05 05:48:43 -0700 (Thu, 05 May 2005) | 5 lines
Changed paths:
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/cvar.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/vid_sdl.c

-Changed the SDL window icon back to DP's icon.
-Cmds, Cvars and Aliases are now inserted at the right alphanumerical
 position on creation.
-Fixed a bug in the serverlist which caused it to not mask entries properly.

------------------------------------------------------------------------
r5224 | havoc | 2005-05-04 13:14:06 -0700 (Wed, 04 May 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

changed cl_movement_latency to be in milliseconds rather than seconds (less confusing because of ping being milliseconds)
added code to remove 'impossibly far into the future' movement queue items (useful if latency is set to a high value initially and then lower, this will remove the stale high latency items)

------------------------------------------------------------------------
r5223 | havoc | 2005-05-04 07:07:47 -0700 (Wed, 04 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

moved a Cvar_RegisterVariable call to ensure that it happens before config parsing

------------------------------------------------------------------------
r5222 | havoc | 2005-05-04 03:26:36 -0700 (Wed, 04 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c

fixed a stupid bug in PF_te_customflash that made it send lifetime as /256 (should've been *256)

------------------------------------------------------------------------
r5221 | havoc | 2005-05-04 02:55:13 -0700 (Wed, 04 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

forgot to add 1 to radius byte in parsing TE_CUSTOMFLASH, probably not noticable though

------------------------------------------------------------------------
r5220 | havoc | 2005-05-04 02:51:41 -0700 (Wed, 04 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/sbar.c

removed .lmp suffix from a number of DrawQ_Pic calls, which should cure the gfx/net.lmp not found warnings

------------------------------------------------------------------------
r5219 | havoc | 2005-05-03 14:49:25 -0700 (Tue, 03 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

393 (+53)

------------------------------------------------------------------------
r5218 | havoc | 2005-05-03 11:33:21 -0700 (Tue, 03 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h

cleaned up portions of rtlighting system, allowing GLSL lighting to use very few state changes, for a 6% speed gain on my system

------------------------------------------------------------------------
r5217 | havoc | 2005-05-03 11:30:12 -0700 (Tue, 03 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

fix a bug that made rtlighting crash (thanks to Vic for reporting this)

------------------------------------------------------------------------
r5216 | havoc | 2005-05-03 03:38:55 -0700 (Tue, 03 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/glquake.h

added code for enabling GL_LINE_SMOOTH (antialiased lines) in r_showtris mode, but disabled because it wasn't a speed gain

------------------------------------------------------------------------
r5215 | havoc | 2005-05-03 03:36:20 -0700 (Tue, 03 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

don't show extra time reports in r_speeds report when using r_showtris 1

------------------------------------------------------------------------
r5214 | havoc | 2005-05-02 22:06:41 -0700 (Mon, 02 May 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/render.h

added developer_texturelogging
R_MarkEntities now updates r_refdef.worldentity visframe as well (for more internal consistency)

------------------------------------------------------------------------
r5213 | havoc | 2005-05-01 05:26:58 -0700 (Sun, 01 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

a bit of cleanup

------------------------------------------------------------------------
r5212 | havoc | 2005-05-01 05:14:05 -0700 (Sun, 01 May 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/render.h

moved r_shadow_ white and normal cubemaps to r_texture_

------------------------------------------------------------------------
r5211 | havoc | 2005-04-30 00:14:37 -0700 (Sat, 30 Apr 2005) | 5 lines
Changed paths:
   M /trunk/darkplaces/cgamevm.c
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/cl_collision.h
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/r_crosshairs.c
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/view.c

relocated the CL_SendMove call to put it at the end of network parsing (and only called if there was an svc_time message in this packet), this should greatly improve consistency of ping times and input sending (which was sometimes falling way behind with lag), no longer uses sys_ticrate to control input frequency
changed CL_TraceLine to CL_TraceBox and made it return a trace_t
worked on CL_ClientMovement function for clientside movement simulation (not working yet), this has many cl_movement* cvars associated with it which will be updated by the server at some point in the future
added (currently unused and not updated) cl_gravity and cl_slowmo cvars, which the server will be setting at some point in the future

------------------------------------------------------------------------
r5210 | havoc | 2005-04-28 19:40:37 -0700 (Thu, 28 Apr 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c

moved some Con_PrintToHistory code into Con_Print and reenabled talk.wav in GAME_NEXUIZ

------------------------------------------------------------------------
r5209 | havoc | 2005-04-24 00:00:16 -0700 (Sun, 24 Apr 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/portals.c

removed an unused function I thought I removed in the previous commit

------------------------------------------------------------------------
r5208 | havoc | 2005-04-23 23:19:10 -0700 (Sat, 23 Apr 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/portals.c

slight cleanup of surface clipping code (got rid of a rather redundent function)
major bugfix to surface portal clipping, lights should hit all the right surfaces now

------------------------------------------------------------------------
r5207 | havoc | 2005-04-23 22:24:30 -0700 (Sat, 23 Apr 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_shadow.c

don't apply dlights to opaque models (this was happening when flashblend is on)
default dlight shadowing on

------------------------------------------------------------------------
r5206 | havoc | 2005-04-23 00:38:48 -0700 (Sat, 23 Apr 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

fixed CL_SendMove packet rate limiting to not have a heartattack when going from singleplayer to multiplayer (this was causing the player to be stuck in place for a very long time)

------------------------------------------------------------------------
r5205 | havoc | 2005-04-20 18:26:44 -0700 (Wed, 20 Apr 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/host.c

added cl_capturevideo_sound (defaulted to 0) to allow enabling/disabling sound saving, with sound disabled you can save videos at a framerate your machine can't maintain (no sound sync to worry about)

------------------------------------------------------------------------
r5204 | havoc | 2005-04-20 04:16:36 -0700 (Wed, 20 Apr 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/portals.c
   M /trunk/darkplaces/portals.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h

reimplemented rtlight portal culling (used for compiled rtlights, and can be used for dlights but that is often a major speed loss)
added additional bounding box and triangle facing checks to rtlight compilation, triangles outside the box are no longer drawn

------------------------------------------------------------------------
r5203 | havoc | 2005-04-20 01:49:26 -0700 (Wed, 20 Apr 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_shadow.c

changed rtlight compiled cluster list/pvs to leaf list/pvs to enable slightly more accurate culling

------------------------------------------------------------------------
r5202 | havoc | 2005-04-19 23:02:47 -0700 (Tue, 19 Apr 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/portals.c

enabled portals on q3bsp for a small (occasionally huge) fps increase

------------------------------------------------------------------------
r5201 | havoc | 2005-04-19 22:33:29 -0700 (Tue, 19 Apr 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h

r_shadow_staticworldlights has mutated into r_shadow_realtime_world_compile, r_shadow_realtime_world_compilelight, r_shadow_realtime_world_compileshadow
added r_shadow_visiblelighting

------------------------------------------------------------------------
r5200 | havoc | 2005-04-19 18:12:46 -0700 (Tue, 19 Apr 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

fixed a stupid bug in SV_PushMove that made it ignore the first entity in the move box
fixed a rotation check in SV_PushMove so that it would detect roll rotations without pitch/yaw

------------------------------------------------------------------------
r5199 | havoc | 2005-04-19 01:00:18 -0700 (Tue, 19 Apr 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

cleaned up transparency handling in q3 shaders, should fix many glitched jumppads and such

------------------------------------------------------------------------
r5198 | havoc | 2005-04-18 14:22:09 -0700 (Mon, 18 Apr 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

now clears view to fog color if fog is enabled, this should cure fogging of sky in hlbsp

------------------------------------------------------------------------
r5197 | havoc | 2005-04-18 14:21:00 -0700 (Mon, 18 Apr 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

clean up script init a bit, now starts nexuiz logo video and such only if there's nothing to do

------------------------------------------------------------------------
r5196 | havoc | 2005-04-18 13:50:57 -0700 (Mon, 18 Apr 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

reenabled hlbsp sky polygon rendering so that fogging works

------------------------------------------------------------------------
r5195 | havoc | 2005-04-17 23:48:21 -0700 (Sun, 17 Apr 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_crosshairs.c

changed crosshair_static default to 1

------------------------------------------------------------------------
r5194 | havoc | 2005-04-17 23:47:40 -0700 (Sun, 17 Apr 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_shared.c

changed in_pitch_min and in_pitch_max defaults to -90 and 90 respectively

------------------------------------------------------------------------
r5193 | havoc | 2005-04-17 19:21:48 -0700 (Sun, 17 Apr 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

fixed the SU_ITEMS fix so that it doesn't trash the PROTOCOL_DARKPLACES6 parsing

------------------------------------------------------------------------
r5192 | havoc | 2005-04-17 14:15:50 -0700 (Sun, 17 Apr 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

fixed a bug in CL_ParseClientdata that was breaking on hipnotic demos

------------------------------------------------------------------------
r5191 | havoc | 2005-04-17 02:08:54 -0700 (Sun, 17 Apr 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

gl_texture_anisotropy now only affects TEXF_MIPMAP textures which should fix a number of 'wandering off the lightmap' issues (as well as similar issues with model skins, as they are not mipmapped)

------------------------------------------------------------------------
r5190 | havoc | 2005-04-17 02:05:32 -0700 (Sun, 17 Apr 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

texture images now take on the TEXF_FORCENEAREST and TEXF_FORCELINEAR flags from the textures placed in them (as was intended), so gl_texturemode changes
should no longer affect them

------------------------------------------------------------------------
r5189 | havoc | 2005-04-17 01:37:08 -0700 (Sun, 17 Apr 2005) | 4 lines
Changed paths:
   M /trunk/darkplaces/keys.c

default to insert mode instead of replace mode in console
get rid of stupid cursor right at end of line behavior in console, repeating characters from the previous edit line is annoying
allow typing characters > 126 in console

------------------------------------------------------------------------
r5188 | havoc | 2005-04-17 01:33:17 -0700 (Sun, 17 Apr 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

fix rtlighting on textureless surfaces (uses r_texture_white instead of no texture)

------------------------------------------------------------------------
r5187 | havoc | 2005-04-17 01:32:21 -0700 (Sun, 17 Apr 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_models.c

don't draw glow twice when gl_combine is on

------------------------------------------------------------------------
r5186 | havoc | 2005-04-16 14:30:13 -0700 (Sat, 16 Apr 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/protocol.c

fixed a stupid bug in Entityframe5_ExpandEdicts

------------------------------------------------------------------------
r5185 | havoc | 2005-04-16 02:15:18 -0700 (Sat, 16 Apr 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/sv_user.c

fix a crash when s->tag_entity is higher than current d->maxedicts

------------------------------------------------------------------------
r5184 | havoc | 2005-04-15 01:37:47 -0700 (Fri, 15 Apr 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h

changed R_Shadow_RenderLighting to do full base+pants+shirt+gloss rendering in one call (will optimize the rendering itself later to merge some of the passes)

------------------------------------------------------------------------
r5183 | havoc | 2005-04-15 01:30:53 -0700 (Fri, 15 Apr 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

fix a bug in the early out case of R_Q1BSP_DrawLight

------------------------------------------------------------------------
r5182 | havoc | 2005-04-15 01:21:11 -0700 (Fri, 15 Apr 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

R_Q1BSP_GetLightInfo now uses BSP tree recursion as an optimization for a small speed gain

------------------------------------------------------------------------
r5181 | havoc | 2005-04-15 01:18:26 -0700 (Fri, 15 Apr 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

made dland2.wav not play in GAME_NEXUIZ
no longer runs physics on disconnected clients (quake did not run them), fixing the physics problems with frikbots, thanks to FrikaC for explanation of this problem

------------------------------------------------------------------------
r5180 | black | 2005-04-14 13:45:08 -0700 (Thu, 14 Apr 2005) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/draw.h
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/netconn.h
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/r_crosshairs.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/sbar.c

-Added the parameter 'persistent'(naming?) to Draw_CachePic, which decides
 whether the texture is loaded in texture memory directly or only on demand.
-Adapted all Draw_CachePic calls (I'll do some corrections, atm most of them
 pass persistent := false)

------------------------------------------------------------------------
r5179 | havoc | 2005-04-14 01:27:36 -0700 (Thu, 14 Apr 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/image.c

LoadTGA is now more compliant with the TGA spec regarding colormaps (they can be present even on a truecolor image, just not used by it) and attributebits (alpha is now ignored if attributebits is not 8 which fixes a number of malformed TGA files (though they still waste disk space) - note that attributebits is part of the attributes header byte)

------------------------------------------------------------------------
r5178 | havoc | 2005-04-11 12:37:04 -0700 (Mon, 11 Apr 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

renamed r_shadow_cursor cvars to actually have the word cursor in their name like they were supposed to

------------------------------------------------------------------------
r5177 | havoc | 2005-04-11 12:06:49 -0700 (Mon, 11 Apr 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/world.c

remove unused variable

------------------------------------------------------------------------
r5176 | black | 2005-04-11 09:53:33 -0700 (Mon, 11 Apr 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpvsimpledecode.c

-Changed the dpv buffer to 1 MB.

------------------------------------------------------------------------
r5175 | havoc | 2005-04-10 19:27:30 -0700 (Sun, 10 Apr 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/bspfile.h
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/world.c

implemented playerclip and monsterclip brush support for q3bsp levels

------------------------------------------------------------------------
r5174 | havoc | 2005-04-10 19:23:16 -0700 (Sun, 10 Apr 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/console.c

changed color codes to match Quake3
changed chat coloring in Nexuiz to use yellow, instead of shifting to upper 128 characters, this should open up the possibility of 8bit fonts in Nexuiz (for multilingual chat)

------------------------------------------------------------------------
r5173 | havoc | 2005-04-10 09:53:42 -0700 (Sun, 10 Apr 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

smoke no longer expands over time (eats fillrate and isn't very realistic)

------------------------------------------------------------------------
r5172 | havoc | 2005-04-10 08:46:47 -0700 (Sun, 10 Apr 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

fixed ut2003-style smoke ring effect on explosions (not that anyone uses this I assume)

------------------------------------------------------------------------
r5171 | havoc | 2005-04-10 08:36:33 -0700 (Sun, 10 Apr 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

reimplemented particle lighting, however it is not used (too slow)
fixed a stupid bug in fogging of alpha blend and modulation blend

------------------------------------------------------------------------
r5170 | havoc | 2005-04-10 08:29:29 -0700 (Sun, 10 Apr 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/cl_collision.h
   M /trunk/darkplaces/cl_particles.c

fixed a crash if decals are stuck to submodels when cl_entities expands

------------------------------------------------------------------------
r5169 | havoc | 2005-04-10 07:01:22 -0700 (Sun, 10 Apr 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_light.h
   M /trunk/darkplaces/r_sprites.c

removed unused leaf parameter on CompleteLightPoint

------------------------------------------------------------------------
r5168 | black | 2005-04-09 13:11:40 -0700 (Sat, 09 Apr 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

Umm, I think this todo item (netconn) has been done some time ago.

------------------------------------------------------------------------
r5165 | molivier | 2005-04-07 03:00:48 -0700 (Thu, 07 Apr 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/todo
   M /trunk/dpmod/qc/dpextensions.qc

Added the DP_HALFLIFE_SPRITE QC extension

------------------------------------------------------------------------
r5164 | havoc | 2005-04-06 13:30:19 -0700 (Wed, 06 Apr 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

fix 256 frame limit (stupid legacy bug in entity_state_t building code)

------------------------------------------------------------------------
r5163 | havoc | 2005-04-06 04:12:56 -0700 (Wed, 06 Apr 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_rsurf.c

changed cl_brushmodel_entities array from entity_render_t * to int, to fix a crash when cl_entities array expands

------------------------------------------------------------------------
r5162 | havoc | 2005-04-06 03:06:26 -0700 (Wed, 06 Apr 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/protocol.c

fixed a stupid typo in EntityFrame5_ExpandEdicts that caused a double free error

------------------------------------------------------------------------
r5161 | havoc | 2005-04-05 15:23:17 -0700 (Tue, 05 Apr 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c

fixed an error case in S_StartSound

------------------------------------------------------------------------
r5160 | havoc | 2005-04-05 13:28:07 -0700 (Tue, 05 Apr 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

fix some crashes with fogged surfaces

------------------------------------------------------------------------
r5159 | havoc | 2005-04-05 13:01:33 -0700 (Tue, 05 Apr 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

made CL_ExpandEntities cause an error if called before cl_entities is initialized

------------------------------------------------------------------------
r5158 | havoc | 2005-04-05 11:23:53 -0700 (Tue, 05 Apr 2005) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/meshqueue.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/ui.c
   M /trunk/darkplaces/wad.c

consolidated many mempools to make memlist more readable (and very slightly reduce memory usage)
changed gltexture_t->identifier from a pointer to an array to reduce the number of allocations per texture (now 2-3 rather than 3-4)
made all MAX_EDICTS arrays in entityframe5_database_t adaptive size to reduce server memory usage

------------------------------------------------------------------------
r5157 | havoc | 2005-04-05 10:31:37 -0700 (Tue, 05 Apr 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cmd.c

no longer uses SZ_Alloc for cmd_text buffer

------------------------------------------------------------------------
r5156 | havoc | 2005-04-05 04:15:45 -0700 (Tue, 05 Apr 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/view.c

reduced client memory usage by 29MB by making cl_max_entities dynamic (starts out at 256)
cleaned up cl_num_entities to be more generally useful, it is only increased by network entities, this should speed up some code (by using cl_num_entities instead of MAX_EDICTS or cl_max_entities)

------------------------------------------------------------------------
r5155 | havoc | 2005-04-04 12:33:09 -0700 (Mon, 04 Apr 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

fixed a unintended-water-scroll bug on transparent fullbright surfaces

------------------------------------------------------------------------
r5154 | havoc | 2005-04-04 11:46:20 -0700 (Mon, 04 Apr 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

fix gl_combine 0 crashes (it was indexing the color vector as if it was a vertex property... wrong!)

------------------------------------------------------------------------
r5153 | havoc | 2005-04-04 09:01:17 -0700 (Mon, 04 Apr 2005) | 5 lines
Changed paths:
   M /trunk/darkplaces/curves.c
   M /trunk/darkplaces/curves.h
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/portals.c
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h

optimized surface rendering to surface->groupmesh->data_* array pointers directly instead of indexing them with surface->num_firstvertex, this allows fewer pointer changes (a small speed gain)
fixed stupid bug in q1bsp texture loading which was making all missing textures invisible
changed portal generation to not break when a portal is clipped away, this fixes a crash at render time with bogus portals
changed r_drawportals to only draw portals surrounding the visible leafs (speed gain, but also useful for debugging vis glitches)

------------------------------------------------------------------------
r5152 | molivier | 2005-04-04 07:51:56 -0700 (Mon, 04 Apr 2005) | 4 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

Fixed getserversResponse parsing:
* serverquerycount was incremented even when it didn't query this server
* if the list contained a server that was already queried, the remaining servers were ignored

------------------------------------------------------------------------
r5151 | black | 2005-04-04 06:03:54 -0700 (Mon, 04 Apr 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/prvm_cmds.c

-ServerList: Changed some if-else-chains to switch constructs.
-Added a pointer check (!= NULL) to VM_strunzone.

------------------------------------------------------------------------
r5149 | molivier | 2005-04-04 01:26:46 -0700 (Mon, 04 Apr 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/image.h
   M /trunk/darkplaces/menu.c

Removed LoadLMPAs8Bit; the menu now uses LoadLMP directly

------------------------------------------------------------------------
r5146 | molivier | 2005-04-03 22:40:51 -0700 (Sun, 03 Apr 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/image.h
   M /trunk/darkplaces/jpeg.c
   M /trunk/darkplaces/jpeg.h

Factorized LoadLMP and LoadLMPAs8Bit. Made a bunch of buffers const

------------------------------------------------------------------------
r5145 | black | 2005-04-03 03:12:18 -0700 (Sun, 03 Apr 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/netconn.h
   M /trunk/darkplaces/prvm_cmds.c

-Changed HostCache to ServerList (and a few other pure name changes)

------------------------------------------------------------------------
r5143 | molivier | 2005-04-03 00:26:14 -0800 (Sun, 03 Apr 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_sprite.c
   M /trunk/darkplaces/model_sprite.h
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/spritegn.h
   M /trunk/darkplaces/todo

Added Quake 2 sprite support (.sp2 files). Added the corresponding QC extension (DP_QUAKE2_SPRITE)

------------------------------------------------------------------------
r5142 | havoc | 2005-04-02 10:25:26 -0800 (Sat, 02 Apr 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

rewrote parts of Host_ServerFrame to make host_framerate cvar work again for The Ascension Of Vigil

------------------------------------------------------------------------
r5141 | havoc | 2005-04-02 09:38:45 -0800 (Sat, 02 Apr 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_sprite.c
   M /trunk/darkplaces/spritegn.h

fix hl sprite types again

------------------------------------------------------------------------
r5140 | havoc | 2005-04-02 08:49:28 -0800 (Sat, 02 Apr 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_sprite.c

fixed hl sprite types to properly handle the palette in each mode

------------------------------------------------------------------------
r5139 | havoc | 2005-04-02 08:20:34 -0800 (Sat, 02 Apr 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/model_sprite.c

fixed hl sprite additive mode

------------------------------------------------------------------------
r5138 | havoc | 2005-04-02 08:04:10 -0800 (Sat, 02 Apr 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_sprite.c

fix hl sprite loading (stupid typo in handling sprite types)

------------------------------------------------------------------------
r5137 | black | 2005-04-02 04:05:05 -0800 (Sat, 02 Apr 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/netconn.c

-Now a server is never pinged more than once.
-Fixed the color code function.

------------------------------------------------------------------------
r5136 | molivier | 2005-03-31 08:08:23 -0800 (Thu, 31 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

Updated a few entries in the todo file

------------------------------------------------------------------------
r5135 | havoc | 2005-03-31 01:50:43 -0800 (Thu, 31 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

fix incompatible types warnings (and change pointer_* fields back to void *)

------------------------------------------------------------------------
r5134 | molivier | 2005-03-30 21:41:44 -0800 (Wed, 30 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_null.c
   M /trunk/darkplaces/vid_wgl.c

Removed GL_OpenLibrary and GL_CloseLibrary from "vid.h" and "vid_null.c"

------------------------------------------------------------------------
r5133 | havoc | 2005-03-30 15:23:14 -0800 (Wed, 30 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

changed array pointer state to const float * instead of const void *

------------------------------------------------------------------------
r5132 | havoc | 2005-03-28 04:33:25 -0800 (Mon, 28 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_lightning.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_sky.c

added a firstvertex parameter to R_Mesh_DrawMesh

------------------------------------------------------------------------
r5131 | havoc | 2005-03-28 04:16:48 -0800 (Mon, 28 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h

save some memory by not allocating neighbors for q1bsp and q3bsp meshlists

------------------------------------------------------------------------
r5130 | havoc | 2005-03-28 03:32:47 -0800 (Mon, 28 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/portals.c
   M /trunk/darkplaces/pr_cmds.c

changed surface->mesh to surface->groupmesh and added num_firsttriangle and num_firstvertex fields to msurface_t, this cuts the msurface_t size from 120 bytes to 88 bytes, causing a 3.5% speed gain in a 37000 surface benchmark scene

------------------------------------------------------------------------
r5129 | havoc | 2005-03-27 22:54:34 -0800 (Sun, 27 Mar 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h

moved a number of msurface_t fields to a separate msurface_lightmapinfo_t structure which is allocated only for q1bsp maps, to save some memory and save some memory bandwidth (as these fields are not often accessed)
moved collision triangles/vertices information out of surfmesh_t and into msurface_t

------------------------------------------------------------------------
r5128 | havoc | 2005-03-27 17:46:58 -0800 (Sun, 27 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.h

slight optimizations to bsp renderer

------------------------------------------------------------------------
r5127 | havoc | 2005-03-27 17:43:43 -0800 (Sun, 27 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

removed an unneeded CHECKGLERROR

------------------------------------------------------------------------
r5126 | havoc | 2005-03-27 01:15:59 -0800 (Sun, 27 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

fixed backwards bumps in r_shadow_glsl 1 mode

------------------------------------------------------------------------
r5125 | havoc | 2005-03-27 00:22:05 -0800 (Sun, 27 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_alias.h
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/pr_cmds.c

implemented tag attachments on skeletal .zym models and centralized the code dealing with tags in model_alias.c

------------------------------------------------------------------------
r5124 | havoc | 2005-03-25 03:35:48 -0800 (Fri, 25 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

added comments to the bloom code in R_BlendView to try to explain how it works

------------------------------------------------------------------------
r5123 | havoc | 2005-03-24 06:49:39 -0800 (Thu, 24 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h

rearranged stale worldmodel removal a bit so that trying to load a level that doesn't exist doesn't mess up things on a server due to a partial reload

------------------------------------------------------------------------
r5122 | havoc | 2005-03-24 06:48:06 -0800 (Thu, 24 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_sky.c

fixed skybox texture leak on level changes

------------------------------------------------------------------------
r5121 | havoc | 2005-03-22 23:10:17 -0800 (Tue, 22 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

disabled item bobbing by default

------------------------------------------------------------------------
r5120 | havoc | 2005-03-22 16:16:28 -0800 (Tue, 22 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/view.c

view_ofs now affects intermission cameras, mods usually set view_ofs to '0 0 0' when going to intermission so this won't break anything, but allows Nexuiz to freeze frame the final moment with players still standing where they were

------------------------------------------------------------------------
r5119 | havoc | 2005-03-22 16:15:03 -0800 (Tue, 22 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

fix decal fading so they really DO disappear eventually now, rather than hogging particle slots for all time

------------------------------------------------------------------------
r5118 | havoc | 2005-03-21 12:47:01 -0800 (Mon, 21 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

fixed two more signed/unsigned mismatches

------------------------------------------------------------------------
r5117 | havoc | 2005-03-21 01:58:21 -0800 (Mon, 21 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

fix 3 NULL vertex pointer crashes (caused by R_Mesh_State lingering where it shouldn't)

------------------------------------------------------------------------
r5116 | havoc | 2005-03-21 01:57:52 -0800 (Mon, 21 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

fix a bug in R_Mesh_Finish introduced by the unsigned int i fix

------------------------------------------------------------------------
r5115 | havoc | 2005-03-21 01:14:57 -0800 (Mon, 21 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

fix two runaway loops caused by unsigned int i

------------------------------------------------------------------------
r5114 | molivier | 2005-03-21 00:44:35 -0800 (Mon, 21 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/makefile.inc

Added Mac OS X support to the makefiles. Note that the client doesn't compile yet since some files are still missing (vid_agl.c mainly)

------------------------------------------------------------------------
r5113 | molivier | 2005-03-21 00:42:59 -0800 (Mon, 21 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

Moved some particles texture initialization loops in a separate function to work around an optimization bug in Mac OS X's GCC

------------------------------------------------------------------------
r5107 | havoc | 2005-03-20 20:23:14 -0800 (Sun, 20 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

more unsigned (i/j/size variables)

------------------------------------------------------------------------
r5106 | havoc | 2005-03-20 20:21:08 -0800 (Sun, 20 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h

less unsigned

------------------------------------------------------------------------
r5105 | havoc | 2005-03-20 20:18:57 -0800 (Sun, 20 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

more unsigned

------------------------------------------------------------------------
r5104 | havoc | 2005-03-20 20:17:27 -0800 (Sun, 20 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h

changed ActiveTexture and ClientActiveTexture to take unsigned

------------------------------------------------------------------------
r5103 | havoc | 2005-03-20 20:12:59 -0800 (Sun, 20 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

changed a few things to unsigned

------------------------------------------------------------------------
r5102 | havoc | 2005-03-20 18:05:08 -0800 (Sun, 20 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

surface renderer now does less R_Mesh_State calls, opting instead to change only individual pieces of state

------------------------------------------------------------------------
r5101 | havoc | 2005-03-20 18:03:44 -0800 (Sun, 20 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h

added R_Mesh_ functions for setting individual parts of state, to allow faster state changes in surface renderer

------------------------------------------------------------------------
r5100 | havoc | 2005-03-20 18:02:05 -0800 (Sun, 20 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/vid_shared.c

added 1f and 4f glTexCoord/glMultiTexCoord function declarations

------------------------------------------------------------------------
r5099 | havoc | 2005-03-20 16:52:57 -0800 (Sun, 20 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

fix PBLEND_MOD in fog

------------------------------------------------------------------------
r5098 | havoc | 2005-03-18 21:45:24 -0800 (Fri, 18 Mar 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

reduced particle struct size (now 32768 particles is 3MB instead of about 3.8MB) by merging/removing some fields (and adding type structs to define rendering properties based on type to save a little space)
removed 11 parameters to particle() function

------------------------------------------------------------------------
r5097 | havoc | 2005-03-18 18:14:11 -0800 (Fri, 18 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

fix a warning

------------------------------------------------------------------------
r5096 | havoc | 2005-03-18 18:11:44 -0800 (Fri, 18 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

made detailtextures check r_detailtextures again

------------------------------------------------------------------------
r5095 | havoc | 2005-03-18 18:10:54 -0800 (Fri, 18 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h

added GAME_THEHUNTED

------------------------------------------------------------------------
r5094 | havoc | 2005-03-17 18:04:25 -0800 (Thu, 17 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

removed r_floatbuildlightmaps cvar and related code (since it was only useful to dlights)

------------------------------------------------------------------------
r5093 | havoc | 2005-03-17 17:58:31 -0800 (Thu, 17 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_alias.h

got rid of aliasskin/aliaslayer system for rendering models, now uses texture_t like maps do

------------------------------------------------------------------------
r5092 | black | 2005-03-17 10:57:45 -0800 (Thu, 17 Mar 2005) | 6 lines
Changed paths:
   M /trunk/darkplaces/fs.c

Well, you might not like this change, but I dont like it the way it is, so
it's up to you to fix it in a convenient way.
I certainly dont want to have my config files and qconsole.log (and possibly
all other files DP creates) in some linux-style .darkplaces folder(!) somewhere
hidden in my CVS home directory.

------------------------------------------------------------------------
r5091 | havoc | 2005-03-17 02:17:07 -0800 (Thu, 17 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

q3 shader parsing now sets more materialflags (such as transparency)

------------------------------------------------------------------------
r5090 | havoc | 2005-03-16 23:21:18 -0800 (Wed, 16 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_light.h

removed a lot of renderer cruft (such as 48% of gl_rsurf.c) as a result of the previous commit

------------------------------------------------------------------------
r5089 | havoc | 2005-03-16 23:11:41 -0800 (Wed, 16 Mar 2005) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_light.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/render.h

merged q1bsp and q3bsp surface rendering
disabled MarkLights based dlights (lightmap dlights, etc) because they're just too hard to maintain (broken AGAIN), and the code for them will be removed soon
renamed r_shadow_whitetexture and related textures to r_texture_white and such, and moved them to gl_rmain for more general use

------------------------------------------------------------------------
r5088 | havoc | 2005-03-15 10:42:23 -0800 (Tue, 15 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

Host_SaveConfig_f now refuses to save if Host_Frame hasn't completed the first frame yet (this means if it crashes during the first frame it won't save a config)

------------------------------------------------------------------------
r5087 | havoc | 2005-03-15 10:12:44 -0800 (Tue, 15 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

Willis updated map list in GAME_TRANSFUSION menus

------------------------------------------------------------------------
r5086 | havoc | 2005-03-14 16:12:19 -0800 (Mon, 14 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

now searchs LAN for servers (using a broadcast message to port 26000) like Quake did

------------------------------------------------------------------------
r5085 | havoc | 2005-03-14 16:09:07 -0800 (Mon, 14 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/lhnet.c

LHNET now enables broadcast send/receive on any UDP ports it opens

------------------------------------------------------------------------
r5084 | black | 2005-03-14 13:16:13 -0800 (Mon, 14 Mar 2005) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_video.h
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/r_shadow.c

-Beautified a function just for fun (better variable names).
-Added the prvm builtin altstr_ins which inserts a new item into an
 altstring.

------------------------------------------------------------------------
r5083 | havoc | 2005-03-11 16:48:36 -0800 (Fri, 11 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_edict.c

Willis disabled entity filtering based on skill/deathmatch in GAME_TRANSFUSION because it does the filtering in qc

------------------------------------------------------------------------
r5082 | havoc | 2005-03-11 16:47:53 -0800 (Fri, 11 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

Willis changed skill level numbers in GAME_TRANSFUSION menus

------------------------------------------------------------------------
r5081 | molivier | 2005-03-11 05:13:01 -0800 (Fri, 11 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/fs.h

Several fixes related to files opened in write or append mode, and to the ungetc character. Added FS_Purge (discard all buffered data, including the ungetc character)

------------------------------------------------------------------------
r5080 | havoc | 2005-03-10 14:11:19 -0800 (Thu, 10 Mar 2005) | 5 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/r_light.c

added basematerialflags/currentmaterialflags to texture_t which completely replace the SURF_* flags and SURFRENDER_* flags
eliminated the flags and plane fields from q1bsp surfaces
q1bsp texture_t generation now sets supercontents (eliminating need for the SURF_SOLIDCLIP surface flag)
split R_UpdateTextureInfo into two versions for updating a single texture and updating a whole entity's textures respectively, so transparency rendering can now call R_UpdateTextureInfo instead of having duplicate code

------------------------------------------------------------------------
r5079 | havoc | 2005-03-09 19:15:27 -0800 (Wed, 09 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

disabled O_NONBLOCKING flag on win32

------------------------------------------------------------------------
r5078 | havoc | 2005-03-09 15:42:16 -0800 (Wed, 09 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h

slight code reduction to DrawShadowVolume functions

------------------------------------------------------------------------
r5077 | havoc | 2005-03-09 15:41:01 -0800 (Wed, 09 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/collision.c

removed some unused code

------------------------------------------------------------------------
r5076 | havoc | 2005-03-09 15:04:15 -0800 (Wed, 09 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

merged some more q3bsp functions, now only loading and LightPoint/TraceBox differ

------------------------------------------------------------------------
r5075 | havoc | 2005-03-09 15:01:19 -0800 (Wed, 09 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/collision.c

corrected an error message

------------------------------------------------------------------------
r5074 | havoc | 2005-03-09 09:36:50 -0800 (Wed, 09 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_demo.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/dpvsimpledecode.c
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/fs.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/jpeg.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/wad.c

cl_capturevideo_raw* modes now use O_NONBLOCKING file access for more performance

------------------------------------------------------------------------
r5073 | molivier | 2005-03-09 05:09:35 -0800 (Wed, 09 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/vid_shared.c

Moved audio CD initialization / finalization out of the video code so the CD music doesn't stop playing when doing a vid_restart.

------------------------------------------------------------------------
r5072 | molivier | 2005-03-09 05:05:29 -0800 (Wed, 09 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

We didn't exit the "Reset to defaults" menu when answering "yes". Moved the "vertical sync" line a bit lower in the video options menu

------------------------------------------------------------------------
r5071 | molivier | 2005-03-09 05:03:30 -0800 (Wed, 09 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cd_win.c

Fixed and updated a few error messages

------------------------------------------------------------------------
r5070 | havoc | 2005-03-08 16:35:02 -0800 (Tue, 08 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

fixed bugs in q1bsp multitexture surface rendering (and singletexture detail rendering as well)

------------------------------------------------------------------------
r5069 | havoc | 2005-03-08 16:24:59 -0800 (Tue, 08 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/render.h

removed R_BoxVisible and added model->brush.BoxTouchingVisibleLeafs for more flexibility

------------------------------------------------------------------------
r5068 | havoc | 2005-03-08 16:22:46 -0800 (Tue, 08 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

fixed gamma support in video saving (don't know why it was disabled before)

------------------------------------------------------------------------
r5067 | havoc | 2005-03-08 16:22:22 -0800 (Tue, 08 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_mix.c

removed the 1/4th volume scaledown on video capture

------------------------------------------------------------------------
r5066 | havoc | 2005-03-08 09:56:22 -0800 (Tue, 08 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

made FS_Tell and FS_Seek work when writing files

------------------------------------------------------------------------
r5065 | havoc | 2005-03-08 07:20:07 -0800 (Tue, 08 Mar 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/render.h

added R_BoxVisible (used instead of VIS_CullBox)
rewrote portions of R_MarkEntities to be more efficient and more sane (and to use R_BoxVisible obviously)

------------------------------------------------------------------------
r5064 | havoc | 2005-03-08 07:18:19 -0800 (Tue, 08 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

fixed a mistake regarding clusterlist

------------------------------------------------------------------------
r5063 | havoc | 2005-03-08 06:09:34 -0800 (Tue, 08 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

renamed Mod_Q1BSP_BoxTouchingPVS to Mod_Brush_BoxTouchingPVS and removed the Q3BSP version (which is no longer different)

------------------------------------------------------------------------
r5062 | havoc | 2005-03-08 06:02:21 -0800 (Tue, 08 Mar 2005) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/render.h

added r_worldleafvisible flags array for more exact visibility checking (VIS_CullBox does not use this yet however, only rtlights do)
moved r_pvsbits, r_worldsurfacevisible, r_worldleafvisible to gl_rsurf.c
migrated r_pvsbits FatPVS call from just above R_WorldVisibility to inside it

------------------------------------------------------------------------
r5061 | havoc | 2005-03-08 05:49:25 -0800 (Tue, 08 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

further cleaning of R_WorldVisibility, which now works the same on q1bsp and q3bsp (except that q3bsp always uses the pvs method since the loader doesn't generate portals yet, and doesn't provide a PointInLeaf function)

------------------------------------------------------------------------
r5060 | havoc | 2005-03-08 05:48:27 -0800 (Tue, 08 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/portals.c

removed/changed a few mod_brushq1 checks

------------------------------------------------------------------------
r5059 | havoc | 2005-03-08 05:16:06 -0800 (Tue, 08 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.h

eliminated q3meffect_t (now uses q3deffect_t)

------------------------------------------------------------------------
r5058 | havoc | 2005-03-08 05:10:30 -0800 (Tue, 08 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.h

changed uses of q3mmodel_t to q3dmodel_t because there are no actual differences anymore

------------------------------------------------------------------------
r5057 | havoc | 2005-03-08 05:05:11 -0800 (Tue, 08 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h

changed brushq3 submodel firstsurface and firstbrush from pointers to integers

------------------------------------------------------------------------
r5056 | havoc | 2005-03-08 04:51:27 -0800 (Tue, 08 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_particles.c

reenabled CL_TeleportSplash (and removed a bogus parameter), reduced teleport light radius to improve performance

------------------------------------------------------------------------
r5055 | havoc | 2005-03-07 18:48:26 -0800 (Mon, 07 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

fix continual setting of sys_ticrate to 0.01 due to float rounding errors (now has a slight error tolerance)

------------------------------------------------------------------------
r5054 | havoc | 2005-03-07 17:50:47 -0800 (Mon, 07 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

slight optimization to q1bsp rtlight surface visibility checking, added surface visibility checking to q3bsp rtlight rendering (should now be on par with q1bsp rtlight rendering speed)

------------------------------------------------------------------------
r5053 | havoc | 2005-03-07 17:39:42 -0800 (Mon, 07 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h

added firstmodelbrush/nummodelbrushes fields to model struct, and moved brushes from brushq3 to brush, this eliminated all uses of the submodel structures in q3bsp (except during loading)

------------------------------------------------------------------------
r5052 | havoc | 2005-03-07 17:27:27 -0800 (Mon, 07 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

another C99 lazy variable fixed

------------------------------------------------------------------------
r5051 | havoc | 2005-03-07 15:28:42 -0800 (Mon, 07 Mar 2005) | 6 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/portals.c
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/r_light.c

merged q3msurface_t into msurface_t
renamed brushq1./brushq3. surface stuff to brush.
surface->texinfo->texture is now also copied into surface->texture for convenient access (and consistency with q3bsp)
the qc surface info extension has been made q3bsp friendly (however querying a surface's points won't give very sane results on q3bsp surfaces!)
a little cruft removal in some structures

------------------------------------------------------------------------
r5050 | havoc | 2005-03-07 12:55:59 -0800 (Mon, 07 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fixed q3bsp bug where firstmodelsurface was not being set (caused bmodels to render world surfaces instead of their own)

------------------------------------------------------------------------
r5049 | molivier | 2005-03-07 05:07:09 -0800 (Mon, 07 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cd_sdl.c
   M /trunk/darkplaces/vid_sdl.c

Removed a couple of warnings when compiling with MSVC6

------------------------------------------------------------------------
r5048 | havoc | 2005-03-06 13:26:33 -0800 (Sun, 06 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/portals.c
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/r_light.c

a major rename - instead of q1bsp code having surf, and q3bsp code having face, both now use surface

------------------------------------------------------------------------
r5047 | havoc | 2005-03-06 12:37:14 -0800 (Sun, 06 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/portals.c
   M /trunk/darkplaces/pr_cmds.c

eliminated surf->poly_* fields and cleaned up Mod_LoadFaces a great deal

------------------------------------------------------------------------
r5046 | havoc | 2005-03-06 11:47:29 -0800 (Sun, 06 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.h

merged q3mtexture_t into texture_t, note that only the name and skin fields are shared, merging the rest is more difficult

------------------------------------------------------------------------
r5045 | havoc | 2005-03-06 11:20:31 -0800 (Sun, 06 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h

removed texture_t->number and q3mtexture_t->number

------------------------------------------------------------------------
r5044 | havoc | 2005-03-06 11:16:51 -0800 (Sun, 06 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h

moved brushq3.submodel to brush, removed brushq3.data_thismodel (instead looking it up using submodel), other minor cleanups

------------------------------------------------------------------------
r5043 | havoc | 2005-03-06 11:00:09 -0800 (Sun, 06 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/portals.c
   M /trunk/darkplaces/r_light.c

moved brushq1 nodes/leafs/leaffaces/planes/portals fields to brush, along with brushq3 leafbrushes to make things even more consistent

------------------------------------------------------------------------
r5042 | havoc | 2005-03-06 09:09:47 -0800 (Sun, 06 Mar 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/portals.c
   M /trunk/darkplaces/r_light.c

renamed q1bsp marksurfaces to leaffaces for consistency with q2bsp and q3bsp naming
replaced q3mnode_t and q3mleaf_t with mnode_t and mleaf_t (which now contain supersets of the fields between the two bsp versions)

------------------------------------------------------------------------
r5041 | havoc | 2005-03-06 08:22:26 -0800 (Sun, 06 Mar 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.h

changed leafbrushes from pointers to ints to be consistent with leaffaces
moved q3m* structs and stuff to model_brush.h

------------------------------------------------------------------------
r5040 | havoc | 2005-03-06 08:12:14 -0800 (Sun, 06 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

moved pvs handling from R_Q3BSP_DrawFaces to R_WorldVisibility (now handles q1bsp and q3bsp), made R_Q3BSP_DrawFaces more similar to R_DrawSurfaces

------------------------------------------------------------------------
r5039 | havoc | 2005-03-06 07:31:34 -0800 (Sun, 06 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h

changed leafface references to ints (making leaffacenum obslete) for more consistency between q1bsp and q3bsp leaf structures

------------------------------------------------------------------------
r5038 | havoc | 2005-03-06 06:58:54 -0800 (Sun, 06 Mar 2005) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/portals.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/render.h

got rid of node->contents, leaf->contents kept (only needed temporarily during loading to generate collision hull 0), now checks node->plane to know if it is a node (leaf has a NULL plane pointer)
fixed the very messed up contents translation in Q3BSP
various other cleanups

------------------------------------------------------------------------
r5037 | havoc | 2005-03-06 06:56:44 -0800 (Sun, 06 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

changed waterlevel checking to use SUPERCONTENTS instead of CONTENTS, this might be a slight speedup (hasn't completely gotten rid of use of CONTENTS though, because that still must be reported to the QC)

------------------------------------------------------------------------
r5036 | havoc | 2005-03-06 06:50:43 -0800 (Sun, 06 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/collision.c

removed the commented out RecursiveHullCheckPoint function

------------------------------------------------------------------------
r5035 | havoc | 2005-03-06 06:49:48 -0800 (Sun, 06 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

changed all uses of CL_PointQ1Contents to CL_PointSuperContents in particle system (except with WORKINGLQUAKE defined)

------------------------------------------------------------------------
r5034 | havoc | 2005-03-06 06:48:51 -0800 (Sun, 06 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/bspfile.h

added SUPERCONTENTS_NODROP

------------------------------------------------------------------------
r5033 | havoc | 2005-03-06 03:42:40 -0800 (Sun, 06 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

lazy variable declarations strike again

------------------------------------------------------------------------
r5032 | havoc | 2005-03-06 03:35:38 -0800 (Sun, 06 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

variable declaration after function call...  oops

------------------------------------------------------------------------
r5031 | havoc | 2005-03-05 08:13:40 -0800 (Sat, 05 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_shared.h

tweaked the order of checks in an if, and removed the previously mentioned pvs texture chain stuff from the header (forgot to commit this before)

------------------------------------------------------------------------
r5030 | havoc | 2005-03-05 07:18:13 -0800 (Sat, 05 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/r_light.c

eliminated brushq1.pvs* variables, pvstexture surface chain stuff, and cleaned up related code

------------------------------------------------------------------------
r5029 | havoc | 2005-03-05 02:40:45 -0800 (Sat, 05 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/mathlib.c
   M /trunk/darkplaces/mathlib.h
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h

more refactoring of q1bsp rendering

------------------------------------------------------------------------
r5028 | havoc | 2005-03-03 06:21:31 -0800 (Thu, 03 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

fixed Mod_AllocSurfMesh (doesn't crash now)

------------------------------------------------------------------------
r5027 | havoc | 2005-03-03 06:20:07 -0800 (Thu, 03 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

cleaned up q1bsp surface rendering a bit more

------------------------------------------------------------------------
r5026 | molivier | 2005-03-03 06:11:58 -0800 (Thu, 03 Mar 2005) | 5 lines
Changed paths:
   A /trunk/darkplaces/darkplaces-dedicated.dev
   M /trunk/darkplaces/darkplaces.dev
   M /trunk/darkplaces/makefile.inc
   M /trunk/darkplaces/snd_ogg.c

- Toggled "strip executable" in the Dev-C++ project file and updated the version info
- Added a Dev-C++ project file for the dedicated server
- In Makefile.inc, some libs were listed twice in the command line while compiling a dedicated server on Win32
- A few very minor changes in snd_ogg.c

------------------------------------------------------------------------
r5025 | havoc | 2005-03-03 05:45:12 -0800 (Thu, 03 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

cleaned surface drawing in q1bsp and q3bsp a bit

------------------------------------------------------------------------
r5024 | havoc | 2005-03-03 04:50:25 -0800 (Thu, 03 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

some optimizations to q3bsp surface rendering

------------------------------------------------------------------------
r5023 | havoc | 2005-03-03 01:23:48 -0800 (Thu, 03 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/menu.h

Willis improved the Transfusion menu to support singleplayer

------------------------------------------------------------------------
r5022 | havoc | 2005-03-02 22:02:21 -0800 (Wed, 02 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h

q1bsp and q3bsp loaders now use model->meshlist for storing all the geometry of the surfaces (q1bsp loader does not yet enforce the 65536 vertex limit however)

------------------------------------------------------------------------
r5021 | havoc | 2005-03-02 03:24:29 -0800 (Wed, 02 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h

modified q3msurface_t to use a surfmesh (although not cleanly)

------------------------------------------------------------------------
r5020 | havoc | 2005-03-02 03:03:46 -0800 (Wed, 02 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h

improved/modified q1bsp surfmesh stuff for more general use (to make q3bsp able to use it)

------------------------------------------------------------------------
r5019 | havoc | 2005-03-01 21:44:33 -0800 (Tue, 01 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/zone.c

improved r_texturestats output (now gives a total for each pool) and merged some similar code in it

------------------------------------------------------------------------
r5018 | havoc | 2005-03-01 21:36:23 -0800 (Tue, 01 Mar 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

default sv_public to 1

------------------------------------------------------------------------
r5015 | havoc | 2005-02-11 14:22:35 -0800 (Fri, 11 Feb 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c

changed color prefix character to ^ (@ is not acceptable)

------------------------------------------------------------------------
r5014 | havoc | 2005-02-11 14:20:42 -0800 (Fri, 11 Feb 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/keys.c

removed key-below-escape forced toggleconsole, so that german keyboards can type ^

------------------------------------------------------------------------
r5013 | havoc | 2005-02-10 21:38:37 -0800 (Thu, 10 Feb 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_lerpanim.c

slight safety improvement in frameblend generation, may fix a crash Willis reported in Nexuiz

------------------------------------------------------------------------
r5011 | havoc | 2005-02-07 09:46:55 -0800 (Mon, 07 Feb 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

now does a togglemenu if there were no demos started and not connecting to a server and not starting a server

------------------------------------------------------------------------
r5007 | havoc | 2005-02-06 08:52:13 -0800 (Sun, 06 Feb 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

342

------------------------------------------------------------------------
r5006 | havoc | 2005-02-06 08:47:06 -0800 (Sun, 06 Feb 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

rain drops now make rain splashes

------------------------------------------------------------------------
r5005 | havoc | 2005-02-06 02:21:21 -0800 (Sun, 06 Feb 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

added Venim's dpmaster server (now up to 3 masters)

------------------------------------------------------------------------
r5004 | black | 2005-02-05 12:39:45 -0800 (Sat, 05 Feb 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

-Only print queried servers once to the console.

------------------------------------------------------------------------
r5002 | havoc | 2005-02-04 05:48:17 -0800 (Fri, 04 Feb 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/pr_cmds.c

implemented DP_CON_STARTMAP extension which defines two configurable aliases to choose a start map

------------------------------------------------------------------------
r5001 | havoc | 2005-02-04 03:50:50 -0800 (Fri, 04 Feb 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h

now lerps punchangle and punchvector

------------------------------------------------------------------------
r5000 | havoc | 2005-02-04 03:04:06 -0800 (Fri, 04 Feb 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_sdl.c

enable key repeat

------------------------------------------------------------------------
r4999 | havoc | 2005-02-04 02:30:36 -0800 (Fri, 04 Feb 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/render.h

realtime dlights are now overridden by gl_flashblend (as was intended)

------------------------------------------------------------------------
r4998 | havoc | 2005-02-04 02:19:50 -0800 (Fri, 04 Feb 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

fixed r_editlights_edit cubemap (it was calling strlcpy with the wrong length limit)

------------------------------------------------------------------------
r4997 | havoc | 2005-02-04 01:54:52 -0800 (Fri, 04 Feb 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

cl_particles_size works again

------------------------------------------------------------------------
r4996 | havoc | 2005-02-04 01:23:01 -0800 (Fri, 04 Feb 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

changed 3 clamp calls in the GLSL fragment shader to max calls instead, for a small speed gain (at least on ATI)

------------------------------------------------------------------------
r4995 | havoc | 2005-02-04 01:15:10 -0800 (Fri, 04 Feb 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c

vid_vsync 0 now causes a warning due to the fact GLX_SGI_swap_control has no way to turn off vsync, and suggests vid_restart

------------------------------------------------------------------------
r4994 | havoc | 2005-02-03 23:29:02 -0800 (Thu, 03 Feb 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_wgl.c

vid_usingvsync now set to false after a vid_restart (so that vsync will be set again if it's on)

------------------------------------------------------------------------
r4993 | havoc | 2005-02-03 23:19:58 -0800 (Thu, 03 Feb 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/cl_collision.h
   M /trunk/darkplaces/cl_input.c

no longer hits triangles of your own player model when tracing the prydoncursor from first person view

------------------------------------------------------------------------
r4992 | havoc | 2005-02-03 23:18:53 -0800 (Thu, 03 Feb 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

removed unused variable font_size

------------------------------------------------------------------------
r4991 | molivier | 2005-02-03 04:17:10 -0800 (Thu, 03 Feb 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/sbar.c
   M /trunk/darkplaces/snd_mem.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sys_linux.c
   M /trunk/darkplaces/sys_sdl.c
   M /trunk/darkplaces/sys_shared.c
   M /trunk/darkplaces/sys_win.c

Replaced snprintf and vnsprintf calls by dpsnprintf and dpvsnprintf calls, to ensure coherence among the various platforms (the Win32 versions of those functions aren't C99 compatible). dp(v)snprintf functions return -1 when the buffer is too small to contain all the data, and insure null termination.

------------------------------------------------------------------------
r4990 | black | 2005-02-02 13:14:52 -0800 (Wed, 02 Feb 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

Commented out the printing of the weapon number in the weapon selection.

------------------------------------------------------------------------
r4989 | black | 2005-02-02 12:54:45 -0800 (Wed, 02 Feb 2005) | 4 lines
Changed paths:
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/sbar.c

FCVS: ----------------------------------------------------------------------
-Changed the scoreboard for nexuiz (only).
-Fixed a bug in the old quake menu.

------------------------------------------------------------------------
r4988 | black | 2005-02-02 12:25:07 -0800 (Wed, 02 Feb 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c

Fixed a bug and also added support color support to the chat messages.

------------------------------------------------------------------------
r4987 | black | 2005-02-02 11:30:16 -0800 (Wed, 02 Feb 2005) | 4 lines
Changed paths:
   M /trunk/darkplaces/console.c

Added support for color tags to the console. Use the @ char followed by a
number to switch the color. Currently I have only the color indices 0-7 are
valid.

------------------------------------------------------------------------
r4986 | molivier | 2005-02-02 01:12:02 -0800 (Wed, 02 Feb 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_win.c

Fixed Win32 wav sound driver (thanks to fuh for the bug report). Cleaned up some code in the process

------------------------------------------------------------------------
r4982 | havoc | 2005-01-28 18:21:52 -0800 (Fri, 28 Jan 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

reduced offsetmapping from 4 sample to 3 sample to make it work within Radeon 9500-9800/X300 limits

------------------------------------------------------------------------
r4975 | havoc | 2005-01-27 14:15:44 -0800 (Thu, 27 Jan 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

disabled snapping of render patch vertices (collision patch vertices are still snapped)

------------------------------------------------------------------------
r4971 | havoc | 2005-01-26 14:15:34 -0800 (Wed, 26 Jan 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/sv_main.c

added support for skill values outside the range 0-3
GAME_TRANSFUSION now uses skill range 0-4

------------------------------------------------------------------------
r4970 | havoc | 2005-01-26 14:11:07 -0800 (Wed, 26 Jan 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_draw.c

fixed fov calculations so viewzoom isn't so weird anymore, this also fixes the 'double zoom' bug (viewzoom was being applied twice)

------------------------------------------------------------------------
r4969 | havoc | 2005-01-26 01:12:59 -0800 (Wed, 26 Jan 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

fix permutation failed warning to print the right thing

------------------------------------------------------------------------
r4968 | havoc | 2005-01-25 19:39:45 -0800 (Tue, 25 Jan 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

fix a stupid reverse bug (was using ! where I shouldn't)

------------------------------------------------------------------------
r4967 | havoc | 2005-01-25 19:38:50 -0800 (Tue, 25 Jan 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

print glsl/light as the shader that failed

------------------------------------------------------------------------
r4966 | havoc | 2005-01-25 17:40:53 -0800 (Tue, 25 Jan 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/r_shadow.c

disable shader permutations that fell back to software fragment shader (software vertex shader is ok)

------------------------------------------------------------------------
r4965 | havoc | 2005-01-25 15:59:23 -0800 (Tue, 25 Jan 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

fixed the embedded fragment and vertex shaders (somehow mispasted fragment shader into both, and the fragment shader was the old NVIDIA-only one)

------------------------------------------------------------------------
r4964 | havoc | 2005-01-25 12:11:06 -0800 (Tue, 25 Jan 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/prvm_cmds.c

removed obsolete FS_Close call in LoadGame
fixed two int -> unsigned char conversion warnings

------------------------------------------------------------------------
r4963 | havoc | 2005-01-25 12:05:18 -0800 (Tue, 25 Jan 2005) | 5 lines
Changed paths:
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/fs.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/r_shadow.c

now supports Mac and Windows newlines everywhere
all text files are now saved in UNIX format
removed FS_Gets and FS_Getline (they were only used by the loadgame code along with sscanf...  bad)
added FS_UnGetc (needed for Windows newline support in FRIK_FILE fgets)

------------------------------------------------------------------------
r4962 | havoc | 2005-01-24 17:32:40 -0800 (Mon, 24 Jan 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

fix stupid typo in GLSL shader

------------------------------------------------------------------------
r4961 | havoc | 2005-01-24 15:36:00 -0800 (Mon, 24 Jan 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

made GLSL lighting work on ATI (NVIDIA was letting me use sloppier code)
added more CHECKGLERROR calls during GLSL lighting rendering

------------------------------------------------------------------------
r4960 | havoc | 2005-01-24 14:05:51 -0800 (Mon, 24 Jan 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

changed offsetmapping bias to -0.04 so that it never samples off the model skins

------------------------------------------------------------------------
r4959 | havoc | 2005-01-24 13:51:16 -0800 (Mon, 24 Jan 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

added hacky workaround for nvidia GLSL bug (state screwups after switching back to program 0 which go away if I draw something (even an empty Begin...End) after the switch)

------------------------------------------------------------------------
r4958 | havoc | 2005-01-24 13:49:41 -0800 (Mon, 24 Jan 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h

added surfaceparm pointlight to known surfaceparm list

------------------------------------------------------------------------
r4957 | havoc | 2005-01-24 12:27:42 -0800 (Mon, 24 Jan 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

changed the flat bump texture (for no bumpmap textures) to have a 128 height instead of 255 so it's not affected by offset mapping

------------------------------------------------------------------------
r4956 | havoc | 2005-01-24 10:32:05 -0800 (Mon, 24 Jan 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

switch back to program 0 when done setting up GLSL shaders

------------------------------------------------------------------------
r4955 | havoc | 2005-01-23 14:19:22 -0800 (Sun, 23 Jan 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

added documentation on glsl cvars to r_shadow_help

------------------------------------------------------------------------
r4954 | havoc | 2005-01-23 14:16:33 -0800 (Sun, 23 Jan 2005) | 4 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

GLSL shader per pixel lighting implemented (with optimized permutations)
offset mapping implemented in GLSL lighting shader (looks really cool if a little slow, enabled by default)
cleaned up some internal handling ambientscale/diffusescale/specularscale/gloss mode design issues in R_Shadow_RenderLighting

------------------------------------------------------------------------
r4953 | havoc | 2005-01-23 14:12:22 -0800 (Sun, 23 Jan 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h

rearchitected renderer backend to have support for independent number of texture image units, texture coord array units, and texture env blend units
added GL_Backend_CompileProgram and GL_Backend_FreeProgram for GLSL support

------------------------------------------------------------------------
r4952 | havoc | 2005-01-23 14:10:02 -0800 (Sun, 23 Jan 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/image.c

fixed backwards normalmaps generated from bumpmaps (... weird!), and now stores bumpmap into alpha channel of normalmap for use by shaders

------------------------------------------------------------------------
r4951 | havoc | 2005-01-22 22:39:07 -0800 (Sat, 22 Jan 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

fixed blendfunc issues with single pass lighting (such as ambient pass) which were using GL_DST_ALPHA when they shouldn't have been (fixes the 'bright shadows' issue which occurred from multiple lights in some cases)
added a usestencil variable in rtlight rendering just to make it a little more clear in the code

------------------------------------------------------------------------
r4950 | havoc | 2005-01-22 22:36:14 -0800 (Sat, 22 Jan 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/lhnet.c

fixed scaling of cl_netlocalping cvar (it was multiplying by 1000 instead of dividing)

------------------------------------------------------------------------
r4949 | havoc | 2005-01-20 23:30:09 -0800 (Thu, 20 Jan 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_shared.c

disable vid_vsync by default

------------------------------------------------------------------------
r4948 | havoc | 2005-01-20 19:34:22 -0800 (Thu, 20 Jan 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_shared.c

if hardware gamma setting fails, try to restore system gamma anyway (Windows stupidity)

------------------------------------------------------------------------
r4947 | havoc | 2005-01-20 19:22:11 -0800 (Thu, 20 Jan 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/fs.c

changed GAME_ init data to have a separate user config directory for each game type (~/.darkplaces for most), and two game dirs rather than an implied id1 (so now nexuiz doesn't look for id1 for example)

------------------------------------------------------------------------
r4946 | molivier | 2005-01-19 01:09:20 -0800 (Wed, 19 Jan 2005) | 14 lines
Changed paths:
   M /trunk/darkplaces/cl_demo.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/console.h
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/fs.h
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/snd_null.c
   M /trunk/darkplaces/sound.h

- Got rid of all the FILE* stuff in the FS code, relying on low-level
functions exclusively. It now manages its own per-file 2KB read buffers.
Writes are no longer buffered.
- Removed function "FS_Flush" and cvar "log_sync", since they're no
longer relevant
- Package's file descriptors are now duplicated when opening a new file
inside a package, to make package substitution at run time impossible on
non-Win32 systems. Added a couple of "lseek" when necessary (before
"read" calls in "FS_Read").
- Removed unused functions "FS_Eof", "Log_Print" and "S_ClearBuffer"
- Several other minor changes and fixes in the FS code
- Changed log open mode to "a" from "at" since 't' seems a Win32-only
extension

------------------------------------------------------------------------
r4945 | molivier | 2005-01-18 02:02:18 -0800 (Tue, 18 Jan 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces-dedicated.dsp
   M /trunk/darkplaces/darkplaces-sdl.dsp

DSP files must be treated as binary files

------------------------------------------------------------------------
r4944 | havoc | 2005-01-17 17:38:44 -0800 (Mon, 17 Jan 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

disabled HostCache_Test code because it's wrecking the server browser in each release build

------------------------------------------------------------------------
r4943 | havoc | 2005-01-17 15:30:20 -0800 (Mon, 17 Jan 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

now adapts sv.num_edicts according to how many edicts are found by SV_Physics, so if a lot of temporary stuff spawns and removes itself it will knock the num_edicts back down

------------------------------------------------------------------------
r4942 | havoc | 2005-01-17 15:17:31 -0800 (Mon, 17 Jan 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

implemented the 'don't move projectiles on first frame' hack a different way

------------------------------------------------------------------------
r4941 | havoc | 2005-01-17 14:52:16 -0800 (Mon, 17 Jan 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

reverted back to per-entity prethink-think-move-postthink process to fix mods

------------------------------------------------------------------------
r4940 | havoc | 2005-01-17 14:11:16 -0800 (Mon, 17 Jan 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

now supports nextthink < 0 again... sigh

------------------------------------------------------------------------
r4939 | havoc | 2005-01-16 21:35:55 -0800 (Sun, 16 Jan 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c

hush fraction out of bounds warnings in CL_SelectTraceline

------------------------------------------------------------------------
r4938 | havoc | 2005-01-14 18:23:51 -0800 (Fri, 14 Jan 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

added saving of particles/nexbeam.tga (commented out like the particles/particlefont.tga saver is)

------------------------------------------------------------------------
r4937 | havoc | 2005-01-14 18:11:53 -0800 (Fri, 14 Jan 2005) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

fixed a bug in texture generator that made all the particles too large in the particle font by one pixel (now they're smaller than their frame, like they were supposed to be), this fixes all the sharp edges on particles
changed nexbeam to be quite a bit brighter in the center than the sides (as I really wanted it all along)
nexbeam no longer scrolls its texture (looked odd)

------------------------------------------------------------------------
r4936 | havoc | 2005-01-14 18:09:46 -0800 (Fri, 14 Jan 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

nexbeam is now white and 8 units wide (rather than two beams, one 12 units and one 5 units and each a different color)

------------------------------------------------------------------------
r4935 | havoc | 2005-01-14 18:08:45 -0800 (Fri, 14 Jan 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_lightning.c

normalize after the CrossProduct

------------------------------------------------------------------------
r4934 | havoc | 2005-01-14 17:53:55 -0800 (Fri, 14 Jan 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix the odd distortion on beam polygons that tends to make their end kind of vanish to a point

------------------------------------------------------------------------
r4933 | havoc | 2005-01-14 15:39:47 -0800 (Fri, 14 Jan 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

fixed a crash with lights that have no clusters (a light outside the level) by allocating the clusterpvs even if there are no clusters

------------------------------------------------------------------------
r4932 | havoc | 2005-01-13 10:26:26 -0800 (Thu, 13 Jan 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

now skips entire rtlight rendering process if light is too dark or does not emit any surface light - another 30% speed gain

------------------------------------------------------------------------
r4931 | havoc | 2005-01-13 00:14:54 -0800 (Thu, 13 Jan 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

migrated push thinks back to SV_Physics_Pusher to fix a qc crash when touching a door

------------------------------------------------------------------------
r4930 | havoc | 2005-01-12 23:06:19 -0800 (Wed, 12 Jan 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt

added Ludwig Nussel to Thanks to section

------------------------------------------------------------------------
r4929 | havoc | 2005-01-12 23:02:00 -0800 (Wed, 12 Jan 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/collision.c

cloned and rewrote Collision_TraceLineTriangleFloat to optimize it slightly

------------------------------------------------------------------------
r4928 | havoc | 2005-01-12 22:45:34 -0800 (Wed, 12 Jan 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c

forgot a parameter to S_FreeSfx

------------------------------------------------------------------------
r4927 | havoc | 2005-01-12 22:40:07 -0800 (Wed, 12 Jan 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c

no longer calls S_StopAllSounds when sound system restarts, and cleaned up a sound freeing loop (just nicer code)

------------------------------------------------------------------------
r4926 | havoc | 2005-01-12 22:36:57 -0800 (Wed, 12 Jan 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/sv_main.c

shuffled around some SCR_BeginLoadingPlaque calls so now SV_SpawnServer causes a loading plaque and ParseServerinfo only draws a loading plaque if there's no local server (which already did one), this cleans up the loading plaque management a great deal

------------------------------------------------------------------------
r4925 | havoc | 2005-01-12 22:32:29 -0800 (Wed, 12 Jan 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/world.c

bound fractions after trace code

------------------------------------------------------------------------
r4924 | havoc | 2005-01-12 22:31:30 -0800 (Wed, 12 Jan 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_null.c
   M /trunk/darkplaces/sound.h

added S_ClearBuffer to sound.h and snd_null.c

------------------------------------------------------------------------
r4923 | havoc | 2005-01-12 22:29:28 -0800 (Wed, 12 Jan 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

NetConn_Read no longer runs cl_packetloss rejection code if there is no packet (slight optimization/sanity improvement)
removed another SCR_BeginLoadingPlaque call

------------------------------------------------------------------------
r4922 | havoc | 2005-01-12 22:23:32 -0800 (Wed, 12 Jan 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/screen.h

changed scr_conlines to be a local variable named conlines
now draws fullscreen console (between levels) without altering scr_con_current

------------------------------------------------------------------------
r4921 | havoc | 2005-01-12 22:21:17 -0800 (Wed, 12 Jan 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_demo.c

removed a SCR_BeginLoadingPlaque when starting to play a demo
removed clearing of scr_conlines (useless)

------------------------------------------------------------------------
r4920 | havoc | 2005-01-12 22:17:26 -0800 (Wed, 12 Jan 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/keys.c

use vid.conheight instead of scr_conlines in history scrolling
don't call SCR_UpdateScreen twice

------------------------------------------------------------------------
r4919 | havoc | 2005-01-12 22:13:57 -0800 (Wed, 12 Jan 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

remove a silly scr_conlines check

------------------------------------------------------------------------
r4918 | havoc | 2005-01-12 22:11:38 -0800 (Wed, 12 Jan 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c

bound the fractions in CL_TraceLine instead of posting a warning, as out of bounds fractions have no harmful effects during a trace (to allow the bounds in the trace code to be removed)

------------------------------------------------------------------------
r4917 | havoc | 2005-01-12 22:07:23 -0800 (Wed, 12 Jan 2005) | 5 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

rearranged entire SV_Physics process (which may break mods but I hope not!):
each operation (move, prethink, think, postthink) is now a separate stage (as an optimization mainly)
moves are now done before prethinks, thinks, and postthinks so that think-spawned entities do not move on their first frame (this fixes the issue that all projectiles appeared some distance from the player, dependent on server framerate, so rocket trails and other things look correct)
added a relink of any entity that moves for any reason (just an origin compare), not sure if this is a good idea but it is more consistent

------------------------------------------------------------------------
r4916 | havoc | 2005-01-12 22:01:58 -0800 (Wed, 12 Jan 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

changed numskins to 1 on q1bsp and q3bsp and numframes to 2 on q3bsp, to suppress some network warnings about non-existent frames/skins

------------------------------------------------------------------------
r4915 | havoc | 2005-01-12 22:00:45 -0800 (Wed, 12 Jan 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

no longer kicks off client if it got signon 1 twice during a reconnect (not sure why this happens occasionally though)

------------------------------------------------------------------------
r4914 | havoc | 2005-01-12 21:58:56 -0800 (Wed, 12 Jan 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

slight optimization to CL_RelinkNetworkEntities to scan entities faster

------------------------------------------------------------------------
r4913 | havoc | 2005-01-12 21:57:41 -0800 (Wed, 12 Jan 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c

optimizations to CL_SelectTraceLine to scan entity list faster

------------------------------------------------------------------------
r4912 | havoc | 2005-01-12 21:55:46 -0800 (Wed, 12 Jan 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_models.c

don't generate vertex/normal/tangents until they are needed by lighting passes, this greatly improved framerates in nexuiz because a lot of models were having nothing to draw (apparently), perhaps their light color was black (odd...)

------------------------------------------------------------------------
r4911 | black | 2005-01-11 06:47:49 -0800 (Tue, 11 Jan 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

-Now the Nex weapon list works correctly again.

------------------------------------------------------------------------
r4910 | black | 2005-01-11 06:33:39 -0800 (Tue, 11 Jan 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/sbar.c

-The NEXUIZ_PLAYERMODEL is not game specific anymore.
-A small cosmetic change to the Nex weapon list code.

------------------------------------------------------------------------
r4909 | molivier | 2005-01-09 01:07:08 -0800 (Sun, 09 Jan 2005) | 9 lines
Changed paths:
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/filematch.c
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/jpeg.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/snd_ogg.c
   M /trunk/darkplaces/sys.h
   M /trunk/darkplaces/sys_shared.c

- Sys_LoadLibrary now accepts several possible names for a DLL (it fixes
the PK3 and Vorbis supports on NetBSD)
- Added a check for absolute paths in FS_CheckNastyPath
- Moved "COM_Shutdown" after "Log_Close" in the shutdown process to make
sure the FS code is still active when we close the log file
- Factorized some code in the FS module
- Made the "listdirectory" parameter "const"
- Fixed a warning in "prvm_cmds.c" when compiling with GCC

------------------------------------------------------------------------
r4908 | havoc | 2005-01-07 04:20:58 -0800 (Fri, 07 Jan 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_alsa.c

added #include "snd_main.h" to make this compile again (thanks to Ludwig Nussel for the patch)

------------------------------------------------------------------------
r4907 | havoc | 2005-01-07 04:19:03 -0800 (Fri, 07 Jan 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/snd_ogg.c

changed libz.so to libz.so.1, libvorbis.so to libvorbis.so.0, and libvorbisfile.so to libvorbisfile.so.3 (thanks to Ludwig Nussel for the patch)

------------------------------------------------------------------------
r4906 | havoc | 2005-01-07 03:52:43 -0800 (Fri, 07 Jan 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

thanks to Ludwig Nussel for this patch to add ~/.darkplaces support for non-Windows users

------------------------------------------------------------------------
r4899 | havoc | 2005-01-06 05:31:31 -0800 (Thu, 06 Jan 2005) | 3 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

swapped order of incr/decr renders for static shadow volumes (for some reason I had decr first, then incr, doesn't matter since they don't clamp but looks odd in the code)
remove quotes on cubemap names in .rtlights file loader (forgot to commit this previously)

------------------------------------------------------------------------
r4897 | tomaz | 2005-01-03 07:47:00 -0800 (Mon, 03 Jan 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cgamevm.c
   M /trunk/darkplaces/cgamevm.h
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/cmd.h
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/zone.c
   M /trunk/darkplaces/zone.h

Cleaned up alot more memory leaks. (still get 720 leaks just running demo1.dem)

------------------------------------------------------------------------
r4896 | molivier | 2005-01-03 06:22:35 -0800 (Mon, 03 Jan 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

Fixed a warning about an uninitialized variable

------------------------------------------------------------------------
r4895 | molivier | 2005-01-03 06:20:56 -0800 (Mon, 03 Jan 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_null.c
   M /trunk/darkplaces/sound.h

Added S_Terminate to free all sound resources at shutdown

------------------------------------------------------------------------
r4894 | tomaz | 2005-01-01 13:52:27 -0800 (Sat, 01 Jan 2005) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/host.c

Added CL_Shutdown which took care of 14 memory leaks totaling over 30mb. (needs more added to it)

------------------------------------------------------------------------
r4893 | black | 2005-01-01 11:00:33 -0800 (Sat, 01 Jan 2005) | 4 lines
Changed paths:
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/cmd.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/prvm_cmds.c

-Added 2 builtins to make the hostcache stuff easier extensible.
 More to follow soon.
-Cmd now has a shutdown function so it doesnt leak anything (hopefully).

------------------------------------------------------------------------
r4892 | black | 2004-12-28 14:29:45 -0800 (Tue, 28 Dec 2004) | 5 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

-Changed the name of PingTest to Test (it now also adds a name to the entry)
-Now the test function is enabled by default (just so Vermeulen can play around
 with it) - there shouldnt be any conflicts with real servers since I shift the
 ping of all emulated servers by 250 ms.

------------------------------------------------------------------------
r4891 | black | 2004-12-28 08:27:50 -0800 (Tue, 28 Dec 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

-Fixed a minor bug in ResetMasks.

------------------------------------------------------------------------
r4890 | black | 2004-12-27 08:54:32 -0800 (Mon, 27 Dec 2004) | 8 lines
Changed paths:
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/netconn.h
   M /trunk/darkplaces/prvm_cmds.c

-Added support for 10 hostcache masks, which will be at the same time.
 5 will be concatenated with AND and the other 5 with OR, so you'll have
 plenty of possibilities to mask whatever you want.
-Changed the mask structure and function to be a bit more generic.
-Added 3 new comparison operators (NOTEQUAL, CONTAINS and NOTCONTAIN - the
 latter two for strings)
-Adapted the builtins to work with multiple masks.

------------------------------------------------------------------------
r4889 | black | 2004-12-26 07:39:47 -0800 (Sun, 26 Dec 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/prvm_cmds.c

-Added a couple of VM builtins.

------------------------------------------------------------------------
r4888 | havoc | 2004-12-25 15:53:10 -0800 (Sat, 25 Dec 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt

Updated email address in readme. (thanks to zarquon for pointing out that it was outdated)

------------------------------------------------------------------------
r4887 | havoc | 2004-12-22 16:18:03 -0800 (Wed, 22 Dec 2004) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

changed r_bloom_resolution behavior to have a non-square texture to match the view width/height aspect
changed default r_bloom_resolution from 256 to 320
changed r_bloom_blur to adapt to resolutions (using 320 as a base value - blur 8 is 8 pixel blur at resolution 320, 16 pixel blur at 640, etc)

------------------------------------------------------------------------
r4886 | black | 2004-12-22 15:10:20 -0800 (Wed, 22 Dec 2004) | 5 lines
Changed paths:
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/netconn.h
   M /trunk/darkplaces/prvm_cmds.c

-Fixed a wrong parameter type in netconn.
-Made hostcache_cachecount public again.
-Added altstr_set to the new VM.
-Started work on the new hostcache interface for the menu qc.

------------------------------------------------------------------------
r4882 | havoc | 2004-12-22 10:19:59 -0800 (Wed, 22 Dec 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

don't send a bunch of svc_precache messages in the serverinfo packet (no longer produces svc_precache messages if server state is ss_loading)

------------------------------------------------------------------------
r4881 | black | 2004-12-22 07:43:39 -0800 (Wed, 22 Dec 2004) | 3 lines
Changed paths:
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/netconn.c

-Fixed the binary insert in the hostcache.
-Fixed a bug in the old menu's serverlist.

------------------------------------------------------------------------
r4880 | havoc | 2004-12-21 16:12:47 -0800 (Tue, 21 Dec 2004) | 3 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

some cleaning of the hostcache code
made the binary search insert loop actually do something

------------------------------------------------------------------------
r4879 | havoc | 2004-12-21 14:26:26 -0800 (Tue, 21 Dec 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

334

------------------------------------------------------------------------
r4878 | black | 2004-12-21 13:53:22 -0800 (Tue, 21 Dec 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

-Fixed a minor bug in the mask function

------------------------------------------------------------------------
r4877 | black | 2004-12-21 13:41:58 -0800 (Tue, 21 Dec 2004) | 4 lines
Changed paths:
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/netconn.h
   M /trunk/darkplaces/prvm_cmds.c

-Added a new hostcache interface:
 * Ascending und descending sorting by various fields is supported.
 * Its possible to mask entries (substrings or comparisons for numbers).

------------------------------------------------------------------------
r4876 | havoc | 2004-12-21 08:51:43 -0800 (Tue, 21 Dec 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/collision.c

fixed up a number of nudging bugs in Collision_TraceLineTriangleFloat

------------------------------------------------------------------------
r4875 | havoc | 2004-12-21 08:48:37 -0800 (Tue, 21 Dec 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/collision.c

some cleanup and hopefully improved accuracy

------------------------------------------------------------------------
r4874 | havoc | 2004-12-20 12:50:41 -0800 (Mon, 20 Dec 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

colormod now works

------------------------------------------------------------------------
r4873 | havoc | 2004-12-20 12:00:46 -0800 (Mon, 20 Dec 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cvar.c

save seta cvars with the seta command, and normal ones without it

------------------------------------------------------------------------
r4872 | molivier | 2004-12-20 01:58:41 -0800 (Mon, 20 Dec 2004) | 4 lines
Changed paths:
   M /trunk/darkplaces/jpeg.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/snd_ogg.c

- Fixed JPEG support on Mac OS X
- Fixed Ogg Vorbis support on Mac OS X (the vorbis DLL is now also loaded manually since some OSes don't do that for us)
- Fixed loading of MD3 models on big-endian CPUs

------------------------------------------------------------------------
r4871 | black | 2004-12-19 14:55:00 -0800 (Sun, 19 Dec 2004) | 4 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

-Fixed a "bug" in PRVM_iscachedpic - it always returned true and thus no
 images were precached (now it always returns false and the menu halts for
 ~4 seconds after starting)

------------------------------------------------------------------------
r4870 | black | 2004-12-19 06:40:34 -0800 (Sun, 19 Dec 2004) | 3 lines
Changed paths:
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/todo

-Added the cvar sv_progs, which allows you to set the name of the server
 progs file.

------------------------------------------------------------------------
r4869 | tomaz | 2004-12-18 18:12:08 -0800 (Sat, 18 Dec 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

332

------------------------------------------------------------------------
r4868 | havoc | 2004-12-18 18:10:00 -0800 (Sat, 18 Dec 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

334

------------------------------------------------------------------------
r4867 | tomaz | 2004-12-18 18:03:49 -0800 (Sat, 18 Dec 2004) | 2 lines
Changed paths:
   A /trunk/darkplaces/darkplaces-dedicated.dsp
   A /trunk/darkplaces/darkplaces-sdl.dsp
   M /trunk/darkplaces/darkplaces.dsp
   M /trunk/darkplaces/darkplaces.dsw

Projects for win32 dedicated and win32 SDL builds.

------------------------------------------------------------------------
r4866 | tomaz | 2004-12-18 17:27:50 -0800 (Sat, 18 Dec 2004) | 2 lines
Changed paths:
   D /trunk/darkplaces/dedicated.dsp

Remove this file

------------------------------------------------------------------------
r4865 | havoc | 2004-12-18 17:09:34 -0800 (Sat, 18 Dec 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_shared.c

GLX mode now supports GLX_SGI_swap_control for vid_vsync

------------------------------------------------------------------------
r4864 | tomaz | 2004-12-18 17:08:32 -0800 (Sat, 18 Dec 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.dsw
   A /trunk/darkplaces/dedicated.dsp

Adding a MSVC6 project file to build the win32 darkplaces-dedicated.

------------------------------------------------------------------------
r4863 | havoc | 2004-12-18 17:02:07 -0800 (Sat, 18 Dec 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_wgl.c

fixed misnamed variables

------------------------------------------------------------------------
r4862 | havoc | 2004-12-18 16:48:33 -0800 (Sat, 18 Dec 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_demo.c

removed videosync code from timedemo

------------------------------------------------------------------------
r4861 | havoc | 2004-12-18 16:47:26 -0800 (Sat, 18 Dec 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_wgl.c

VID_Finish in WGL now turns off videosync during timedemos

------------------------------------------------------------------------
r4860 | black | 2004-12-18 15:59:46 -0800 (Sat, 18 Dec 2004) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/cl_video.h
   M /trunk/darkplaces/host.c

-CL_Video now allows multiple streams again. It is registered as a r_module
 now and automatically restores the textures on r_restart.

------------------------------------------------------------------------
r4859 | tomaz | 2004-12-18 13:31:29 -0800 (Sat, 18 Dec 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

338

------------------------------------------------------------------------
r4858 | tomaz | 2004-12-18 13:20:51 -0800 (Sat, 18 Dec 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

338

------------------------------------------------------------------------
r4857 | tomaz | 2004-12-18 13:17:47 -0800 (Sat, 18 Dec 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

Fixed the sys_ticrate bounds checking, it was constantly setting it to 0.1 when it is already 0.1

------------------------------------------------------------------------
r4856 | tomaz | 2004-12-18 12:18:27 -0800 (Sat, 18 Dec 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_demo.c

Disabled vsync when doing a timedemo.

------------------------------------------------------------------------
r4855 | black | 2004-12-18 03:22:10 -0800 (Sat, 18 Dec 2004) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/cl_video.h

-Castrated the new CL_Video subsystem. It doesnt allow more than 1 video
 stream at a time again. I've moved the texture pool stuff into OpenVideo
 and CloseVideo, so it should work exactly like the old code.

------------------------------------------------------------------------
r4854 | molivier | 2004-12-18 00:12:38 -0800 (Sat, 18 Dec 2004) | 3 lines
Changed paths:
   M /trunk/darkplaces/fs.c

- Fixed PK3 support for Mac OS X
- DP no longer considers empty PK3s as invalid

------------------------------------------------------------------------
r4853 | havoc | 2004-12-17 22:40:21 -0800 (Fri, 17 Dec 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_shared.c

made sensitivity affect cl_prydoncursor

------------------------------------------------------------------------
r4852 | havoc | 2004-12-17 20:11:14 -0800 (Fri, 17 Dec 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

341

------------------------------------------------------------------------
r4851 | havoc | 2004-12-17 18:40:48 -0800 (Fri, 17 Dec 2004) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/render.h

added Bloom effect (r_bloom* cvars)
added Bloom effect cvars to graphics options menu
cleaned up r_speeds variables (c_*) which were being declared and externed and cleared all over the place (that's most of these files)

------------------------------------------------------------------------
r4850 | havoc | 2004-12-17 17:37:29 -0800 (Fri, 17 Dec 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/model_shared.c

renamed cl_stainmapsclearonload to cl_stainmaps_clearonload to make it ignore the setting in old configs

------------------------------------------------------------------------
r4849 | havoc | 2004-12-17 17:24:46 -0800 (Fri, 17 Dec 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

cl_stainmapsclearonload now defaults to 1 (as it was meant to), not that this will help anyone with it already saved to their config

------------------------------------------------------------------------
r4848 | havoc | 2004-12-17 07:51:24 -0800 (Fri, 17 Dec 2004) | 3 lines
Changed paths:
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/pr_cmds.c

removed dangerous filename checks from FRIK_FILE code
added FS_CheckNastyPath function which is called by FS_Open, so now dangerous paths are rejected everywhere

------------------------------------------------------------------------
r4847 | black | 2004-12-17 06:03:20 -0800 (Fri, 17 Dec 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c

-Fixed a bug in the centering code.

------------------------------------------------------------------------
r4846 | black | 2004-12-17 05:47:25 -0800 (Fri, 17 Dec 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c

-Added centered notify output for GAME_NEXUIZ.

------------------------------------------------------------------------
r4845 | black | 2004-12-16 09:57:04 -0800 (Thu, 16 Dec 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h

-Now playermodel and playerskin finally work correctly (hopefully).

------------------------------------------------------------------------
r4844 | molivier | 2004-12-15 01:11:54 -0800 (Wed, 15 Dec 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/host.c

vsprintf -> vsnprintf

------------------------------------------------------------------------
r4843 | havoc | 2004-12-14 14:44:27 -0800 (Tue, 14 Dec 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

339

------------------------------------------------------------------------
r4842 | havoc | 2004-12-14 07:01:08 -0800 (Tue, 14 Dec 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

don't warn about svc_precache failing to precache sounds if snd_initialized is false (-nosound or -safe was used)

------------------------------------------------------------------------
r4841 | molivier | 2004-12-14 01:09:41 -0800 (Tue, 14 Dec 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.bsd

Oops... Fixed my fix to BSD makefile

------------------------------------------------------------------------
r4840 | black | 2004-12-13 08:51:06 -0800 (Mon, 13 Dec 2004) | 3 lines
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

-Fixed another bug introduced by me, affecting the detection of a valid
 time global in the new VM.

------------------------------------------------------------------------
r4839 | black | 2004-12-13 08:20:15 -0800 (Mon, 13 Dec 2004) | 3 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/progdefs.h
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_user.c

-Fixed the stupid bug introduced by my NEX_PLAYERMODEL/NEX_PLAYERSKIN commit.
-Hopefully playermodel and playerskin work still now.

------------------------------------------------------------------------
r4838 | molivier | 2004-12-13 07:41:32 -0800 (Mon, 13 Dec 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.bsd

Fixed BSD makefile for NetBSD

------------------------------------------------------------------------
r4837 | molivier | 2004-12-13 07:00:36 -0800 (Mon, 13 Dec 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_exec.c

Fixed a warning in MSVC6

------------------------------------------------------------------------
r4836 | molivier | 2004-12-13 02:40:44 -0800 (Mon, 13 Dec 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

Fixed model automatic precaching in the new network protocol

------------------------------------------------------------------------
r4835 | black | 2004-12-10 10:43:30 -0800 (Fri, 10 Dec 2004) | 3 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

-Converted some of the altstring functions to builtins
-Fixed a bug in the DrawQueue - it was calculating the clip area wrongly

------------------------------------------------------------------------
r4834 | molivier | 2004-12-10 02:55:58 -0800 (Fri, 10 Dec 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

Added BB_Power to the Transfusion map list

------------------------------------------------------------------------
r4833 | molivier | 2004-12-10 02:55:22 -0800 (Fri, 10 Dec 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_video.c

Removed a couple of warnings when compiling with GCC

------------------------------------------------------------------------
r4832 | molivier | 2004-12-08 07:36:35 -0800 (Wed, 08 Dec 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c

A few minor changes in the sound code

------------------------------------------------------------------------
r4830 | black | 2004-12-06 05:32:11 -0800 (Mon, 06 Dec 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_exec.c

-Fixed another signed/unsigned warning after the type change of func_t.

------------------------------------------------------------------------
r4829 | black | 2004-12-05 05:58:16 -0800 (Sun, 05 Dec 2004) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/pr_comp.h
   M /trunk/darkplaces/pr_execprogram.h

-Fixed a minor bug in CL_Video
-Changed func_t from int to unsigned int - probably this breaks some things
 but at least it fixes an annoying crash of the DP with the current Nexuiz
 build.

------------------------------------------------------------------------
r4828 | black | 2004-12-04 13:08:13 -0800 (Sat, 04 Dec 2004) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/cl_video.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/prvm_cmds.c

-Added video streaming support to the new VM
-Changed again a lot of CL_Video (mostly bugs and logical errors)
-It doesnt append the prefix now, but only checks whether it matches
 or not - if it doesnt it doesnt load the video.

------------------------------------------------------------------------
r4827 | black | 2004-12-04 08:15:17 -0800 (Sat, 04 Dec 2004) | 7 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/cl_video.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/todo

-Added the console command prvm_globalset
-Rewritten CL_Video to support multiple video streams
-Fixed a bug in the new VM's epair parser
The only problem CL_Video now has, is that it doesnt use TEXF_FRAGMENT
right now. Ive added a more general description of this problem to the
todo list.

------------------------------------------------------------------------
r4826 | havoc | 2004-12-03 11:41:15 -0800 (Fri, 03 Dec 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_lightning.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/view.c

some renderer/client separation cleanup, migrated some things to r_refdef to eliminate renderer references to cl. fields

------------------------------------------------------------------------
r4825 | havoc | 2004-12-03 10:58:09 -0800 (Fri, 03 Dec 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

fixed precache problems in non-DARKPLACES6 protocols

------------------------------------------------------------------------
r4824 | havoc | 2004-12-03 10:57:41 -0800 (Fri, 03 Dec 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

fixed a Sys_Error in the client when connected to QUAKE protocol servers (it was trying to send an empty message)

------------------------------------------------------------------------
r4823 | molivier | 2004-12-03 06:15:09 -0800 (Fri, 03 Dec 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/conproc.c
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/todo

Added "ctype.h" to the list of standard headers in "quakedef.h". Cleaned up the todo file a bit (yes, DP works with zipped id1 PAKs)

------------------------------------------------------------------------
r4822 | molivier | 2004-12-03 00:32:08 -0800 (Fri, 03 Dec 2004) | 6 lines
Changed paths:
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/snd_sdl.c
   M /trunk/darkplaces/sys_shared.c
   M /trunk/darkplaces/vid_sdl.c

- DP now defines MACOSX when relevant
- added a "Mac OS X" string in Sys_Shared_EarlyInit
- removed an unused "rcsid" string
- fixed SDL audio on big endian systems
- fixed SDL video initialization on Mac OS X

------------------------------------------------------------------------
r4821 | havoc | 2004-12-02 21:03:12 -0800 (Thu, 02 Dec 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_user.c

don't let clients kill server with bogus cursor_entitynumber values

------------------------------------------------------------------------
r4819 | black | 2004-12-02 06:25:48 -0800 (Thu, 02 Dec 2004) | 6 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/progdefs.h
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_user.c
   M /trunk/darkplaces/todo

Ive done three todo items:
-Added support for ' strings in Com_ParseToken.
-Added support for " and ' as end tokens in Com_ParseToken.
-Added the NEXUIZ_PLAYERMODEL and NEXUIZ_PLAYERSKIN extensions.
The last needs to be tested though. Hopefully it works.

------------------------------------------------------------------------
r4818 | molivier | 2004-12-02 01:46:27 -0800 (Thu, 02 Dec 2004) | 6 lines
Changed paths:
   M /trunk/darkplaces/cd_sdl.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/conproc.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/console.h
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/snd_sdl.c
   M /trunk/darkplaces/snd_win.c
   M /trunk/darkplaces/sys_shared.c
   M /trunk/darkplaces/vid_wgl.c

- Removed Con_SafePrint and Con_SafePrintf since they now does the same things as Con_Print and Con_Printf
- Moved log initialization right after memory initialization to make the log functions available as early as possible
- Moved the removal of "qconsole.log" (when -condebug is in the command line) in FS_Init
- Moved the "Console initialized." message so it is actually printed at console
- Removed the declaration of "con_chars" (it doesn't exist anymore)

------------------------------------------------------------------------
r4817 | havoc | 2004-12-01 15:19:06 -0800 (Wed, 01 Dec 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.h
   M /trunk/darkplaces/gl_backend.c

implemented scr_screenshot_gamma in screenshot saving (previously only implemented in video saving - oops)

------------------------------------------------------------------------
r4816 | havoc | 2004-12-01 15:14:07 -0800 (Wed, 01 Dec 2004) | 4 lines
Changed paths:
   M /trunk/darkplaces/cd_bsd.c
   M /trunk/darkplaces/cd_linux.c
   M /trunk/darkplaces/cd_sdl.c
   M /trunk/darkplaces/cd_shared.c
   M /trunk/darkplaces/cd_win.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/snd_alsa.c
   M /trunk/darkplaces/snd_mem.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sys.h
   M /trunk/darkplaces/sys_shared.c
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/world.c

changed a lot of Con_DPrint/Con_DPrintf calls to Con_Print/Con_Printf (non-technical things like device errors which should be seen even without developer on)
merged Sys_Print code into Con_Print and changed all other Sys_Print/Sys_Printf calls to calling Con_Print/Con_Printf or Con_DPrint/Con_DPrintf instead
rewrote Con_Print so that timestamps are printed only at the start of each line (or just after the 0x01 or 0x02 characters used for chat messages), not during partial line prints, and timestamps now apply to all output destinations (log, console, terminal)

------------------------------------------------------------------------
r4815 | havoc | 2004-12-01 15:13:13 -0800 (Wed, 01 Dec 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_user.c

fix a typo

------------------------------------------------------------------------
r4814 | havoc | 2004-12-01 13:49:46 -0800 (Wed, 01 Dec 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_user.c
   M /trunk/dpmod/qc/dpextensions.qc

modified PRYDON_CLIENTCURSOR extension to reset cursor_trace_ent to world if the entity it is referencing is currently freed (as requested by FrikaC)

------------------------------------------------------------------------
r4813 | havoc | 2004-12-01 13:48:21 -0800 (Wed, 01 Dec 2004) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

cleaned up CL_SendMove a lot, added notes on number of bytes used for different protocols
made CL_SendMove never send a clc_ackframe for frame 0 in any latestframenums slots
made CL_SendMove discard only the clc_move portion of the first two messages (the ones dropped to avoid input leftover from the previous level), still sending the clc_ackframe message
changed CL_SendMove to not accumulate move messages but just send the latest (may improve cursor issues in prydon gate using non-clientcursor mode)

------------------------------------------------------------------------
r4812 | molivier | 2004-12-01 06:03:42 -0800 (Wed, 01 Dec 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

Removed wrong FIXME comment (in-game precached sounds don't need SFXFLAG_SERVERSOUND)

------------------------------------------------------------------------
r4811 | molivier | 2004-12-01 06:00:52 -0800 (Wed, 01 Dec 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/todo

Fixed FS_Seek for unpacked files when FS_USESYSCALLS is defined (should fix HalfLife WAD loading)

------------------------------------------------------------------------
r4810 | molivier | 2004-12-01 00:20:39 -0800 (Wed, 01 Dec 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

341

------------------------------------------------------------------------
r4809 | havoc | 2004-11-30 23:59:48 -0800 (Tue, 30 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

fix annoying warnings about weaponmodel ""

------------------------------------------------------------------------
r4808 | havoc | 2004-11-30 23:57:08 -0800 (Tue, 30 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

342

------------------------------------------------------------------------
r4807 | havoc | 2004-11-30 23:45:40 -0800 (Tue, 30 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

changed order of tests in deciding whether to do culling on a bmodel entity to fix uninitialized variable warnings (thanks Elric)

------------------------------------------------------------------------
r4806 | havoc | 2004-11-30 23:40:36 -0800 (Tue, 30 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

reset animation interpolation on weaponmodel when model changes (thanks Elric)

------------------------------------------------------------------------
r4805 | havoc | 2004-11-30 23:20:42 -0800 (Tue, 30 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

decals now render immediately rather than being transparency sorted, this generally resolves the issues with decals hiding sprites and lightning beams, though it's debatable whether the new interaction with water and transparent bmodels is really an improvement

------------------------------------------------------------------------
r4804 | havoc | 2004-11-30 22:12:47 -0800 (Tue, 30 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

now clears screen at startup to prevent garbage from being seen around loading plaque in windows

------------------------------------------------------------------------
r4803 | havoc | 2004-11-30 22:07:14 -0800 (Tue, 30 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt
   M /trunk/darkplaces/vid_wgl.c

defaulting to nodinput mode again due to problems with dinput mode

------------------------------------------------------------------------
r4801 | havoc | 2004-11-30 21:39:03 -0800 (Tue, 30 Nov 2004) | 18 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/input.h
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_sprites.c
   M /trunk/darkplaces/sbar.c
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_user.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_null.c
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c
   M /trunk/darkplaces/view.c

implemented PRYDON_CLIENTCURSOR extension (clientside mouse pointer that feeds back information to the QuakeC)
added DP_BUTTONUSE extension (+use/-use button)
added DP_BUTTONCHAT extension (true while input is not focused on the game)
reimplemented DP_ENT_COLORMOD extension due to popular request, and changed its definition to allow colors above '1 1 1' for brightening effects
implemented PROTOCOL_DARKPLACES6 protocol, featuring delta compression of ammo counts and other properties (using generic svc_updatestat and svc_updatestatubyte messages), precaching models and sounds during the game (svc_precache).
removed cmd parameter from a lot of input code (now uses cl.cmd. instead of cmd->)
added sv_gameplayfix_setmodelrealbox to allow disabling of the setmodel real model bounding box on alias models (may improve mod compatibility if set to 0, thus performing a setsize (self, '-16 -16 -16', '16 16 16') instead of the real alias model box).
added SV_ModelIndex and SV_SoundIndex functions to clean up the server's precaching and model lookup processes (code reduction/maintenance reduction).
changed sv.model_precache and sv.sound_precache to be real char arrays rather than pointers, so precache names no longer need to be constants as they're now copied.
added some modelindex bounds checks to a few pieces of code.
the dpfields array is now sorted and matches the supported fields list (added the missing ones).
client now acknowledges the last 3 frames in each input packet to reduce packet loss issues.
renamed clc_ackentities to clc_ackframe as it is now used for compressing stats as well as entities in PROTOCOL_DARKPLACES6, this also means it always produces a packet for every frame even if there's no changed entities (or room under the rate limit for that matter)
PROTOCOL_DARKPLACES5 and 6 now perform a non-harmful serverside packetlog reset (marking all packets as lost) if the packetlog fills up, this should eliminate choked-to-death cases where the client lost everything for a few seconds.
MAX_CL_STATS expanded from 32 to 256 (just incase more stats are added, this prevents protocol breakage on too many unknown extra stats)
fixed a bug with the worst case rtlight rendering (the color array was disabled, oops).
some cl.* fields converted to cl.stats elements (STAT_ITEMS for instance) to accomodate the PROTOCOL_DARKPLACES6 stats updates

------------------------------------------------------------------------
r4800 | havoc | 2004-11-30 20:45:44 -0800 (Tue, 30 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/cl_collision.h

some minor cleanup to CL_TraceLine, added CL_SelectTraceLine which is to be used by the PRYDON_CLIENTCURSOR extension

------------------------------------------------------------------------
r4799 | black | 2004-11-30 12:33:22 -0800 (Tue, 30 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

-Fixed a bug in drawstring - it used maxlen instead of len in a validity check

------------------------------------------------------------------------
r4798 | black | 2004-11-29 12:43:28 -0800 (Mon, 29 Nov 2004) | 5 lines
Changed paths:
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_edict.c

-Fixed an old qc bug that's already been existing in the original quake
 (- hopefully it is a bug): ParseEpair was accessing the globals arrays
 instead of writing an offset directly into the value.
-Removed the VM_CheckEmptyString from VM_drawstring.

------------------------------------------------------------------------
r4797 | black | 2004-11-28 05:10:38 -0800 (Sun, 28 Nov 2004) | 6 lines
Changed paths:
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/prvm_cmds.c

-Removed the NG Menu part, since it isnt used anymore (the old layout
 works generally better)
-Fixed a bug in VM_max - it used one of the old VM's macro.
-Added a memory leak output of the "strzone" zone when the menu is shutdown
 (only displayed if developer >= 2)

------------------------------------------------------------------------
r4796 | havoc | 2004-11-25 16:57:30 -0800 (Thu, 25 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h

redesigned drawing of loading plaque, it's now a separate refresh function which draws over the previous frame, rather than invoking a new render, which should fix crashes with level changes with rtlights on (trying to render an rtlight while the map the rtlight was for has already been unloaded tends to cause a crash)

------------------------------------------------------------------------
r4795 | havoc | 2004-11-25 12:41:29 -0800 (Thu, 25 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/screen.h
   M /trunk/darkplaces/sys_win.c
   M /trunk/darkplaces/vid_wgl.c

removed some windows cruft (like scr_skipupdate, and the SleepUntilInput stuff)

------------------------------------------------------------------------
r4794 | havoc | 2004-11-25 12:38:37 -0800 (Thu, 25 Nov 2004) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

removed Sys_Sleep call from CL_KeepaliveMessage, as it's probably better to load as fast as possible than to yield cpu time during loading
removed an unnecessary CL_KeepaliveMessage call in model purging

------------------------------------------------------------------------
r4793 | havoc | 2004-11-25 09:36:24 -0800 (Thu, 25 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_sdl.c

changed drivername to NULL, as SDL knows best

------------------------------------------------------------------------
r4792 | havoc | 2004-11-25 09:02:38 -0800 (Thu, 25 Nov 2004) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h

added model->brush.submodels[] array of pointers to submodels of a world model
added unfinished Mod_Q1BSP_LoadMapBrushes (will be finished someday)

------------------------------------------------------------------------
r4791 | havoc | 2004-11-25 08:19:56 -0800 (Thu, 25 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/mathlib.h
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/prvm_cmds.c

changed lhrandom to use the full RAND_MAX limit (more random, after all the low bits are the most predictable), and made the random() qc builtin use lhrandom

------------------------------------------------------------------------
r4790 | havoc | 2004-11-25 08:18:04 -0800 (Thu, 25 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

small beginnings of GLSL support, doesn't do anything yet

------------------------------------------------------------------------
r4789 | havoc | 2004-11-25 08:16:28 -0800 (Thu, 25 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/server.h

forgot to commit this with the Host_ServerFrame changes

------------------------------------------------------------------------
r4788 | havoc | 2004-11-25 08:13:42 -0800 (Thu, 25 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

redesigned Host_ServerFrame timing again, it now never runs more than 5 serverframes per host frame as a sanity limit (to remain playable in an overloaded game), and is just cleaner

------------------------------------------------------------------------
r4787 | havoc | 2004-11-25 08:08:48 -0800 (Thu, 25 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

forgot to commit a bunch of CL_AllocDlight changes (to use lightstyle -1)

------------------------------------------------------------------------
r4786 | havoc | 2004-11-25 08:07:53 -0800 (Thu, 25 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

added cl_capturevideo_rawyv12 mode, and cl_screenshot_gamma (defaults to 2.2)

------------------------------------------------------------------------
r4785 | molivier | 2004-11-25 01:04:37 -0800 (Thu, 25 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c

Fixed ambient sound volume (it was reset each frame, and cannot change by more than the value of the "ambient_fade" cvar each frame... you do the math). Thanks to Tomaz and Urre for the bug report

------------------------------------------------------------------------
r4784 | havoc | 2004-11-24 17:24:00 -0800 (Wed, 24 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/sys_win.c

changed Sys_Error to not put up a messagebox if in dedicated mode, and cleaned it up a bit

------------------------------------------------------------------------
r4783 | havoc | 2004-11-24 05:39:38 -0800 (Wed, 24 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cgamevm.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/r_shadow.c

fixed a critical bug with Vile and other midnight mods (dlights were being controlled by style 0, this meant they didn't appear in these mods, added style -1 as a special case)

------------------------------------------------------------------------
r4782 | havoc | 2004-11-22 12:24:57 -0800 (Mon, 22 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

fixed an uninitialized variable warning

------------------------------------------------------------------------
r4781 | molivier | 2004-11-22 06:38:33 -0800 (Mon, 22 Nov 2004) | 7 lines
Changed paths:
   M /trunk/darkplaces/cd_shared.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/qtypes.h
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_main.h
   M /trunk/darkplaces/snd_null.c
   M /trunk/darkplaces/sound.h

Several changes to the SFX lock code in the sound engine, mainly to make sure SFXs are automatically freed only at level change
Moved call to CL_InitTEnts after S_Startup so the tent sounds get properly precached
Added a developer warning when trying to play a non-precached SFX
Made the soundlist command more verbose
Added the ssize_t type for Win32 systems
Some comments and dead code removal

------------------------------------------------------------------------
r4780 | molivier | 2004-11-22 02:01:51 -0800 (Mon, 22 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

A few very minor changes to the FS code

------------------------------------------------------------------------
r4779 | havoc | 2004-11-21 04:16:16 -0800 (Sun, 21 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_sky.c

fix skybox loading, _ft and _bk were swapped (and all others had to be flipped accordingly), it now matches quake2 as it was supposed to all along

------------------------------------------------------------------------
r4778 | havoc | 2004-11-20 10:07:34 -0800 (Sat, 20 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

327

------------------------------------------------------------------------
r4777 | havoc | 2004-11-20 10:05:23 -0800 (Sat, 20 Nov 2004) | 3 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_main.h

fixed bug with engine sounds (for TE_ effects) and local sounds (menu, etc) being unloaded on level change (they are supposed to stay indefinitely)
keep play/play2/playvol sounds around until level change (so they're not being constantly unloaded and reloaded when used repeatedly)

------------------------------------------------------------------------
r4776 | havoc | 2004-11-20 03:49:41 -0800 (Sat, 20 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c

changed S_StartSound to start a sound even if it has no fetcher, as the fetcher isn't set until it is loaded... and it isn't loaded until it is played if it was not precached...  and it's being unprecached by the S_ServerSounds function even if it's an engine sound...

------------------------------------------------------------------------
r4775 | havoc | 2004-11-20 03:20:24 -0800 (Sat, 20 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/protocol.c

added support for PROTOCOL_NEHAHRAMOVIE in more places, so now nehahra works again, and added some more Host_Error's for unknown cl.protocol values

------------------------------------------------------------------------
r4774 | havoc | 2004-11-20 01:25:49 -0800 (Sat, 20 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

fix the unintentional framegroup timing reset that happened when the .frame field changed after more than 100ms since the previous change (this was causing corpses to suddenly stand up and then fall down quickly in Nexuiz)

------------------------------------------------------------------------
r4773 | havoc | 2004-11-19 04:42:01 -0800 (Fri, 19 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

326

------------------------------------------------------------------------
r4772 | molivier | 2004-11-18 06:08:27 -0800 (Thu, 18 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

Quick hack to fix the calls to "open" on Win32

------------------------------------------------------------------------
r4771 | havoc | 2004-11-18 05:03:34 -0800 (Thu, 18 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

326

------------------------------------------------------------------------
r4769 | havoc | 2004-11-17 08:36:07 -0800 (Wed, 17 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

minimize cpu use when framerate limited

------------------------------------------------------------------------
r4768 | havoc | 2004-11-17 08:34:51 -0800 (Wed, 17 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

improved how showfps 1 measures framerate, it's now a bit more accurate, still reads a bit low though with millisecond timers

------------------------------------------------------------------------
r4767 | havoc | 2004-11-17 08:33:38 -0800 (Wed, 17 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

FS now uses open/read/write/lseek/close instead of fopen/fread/fwrite/fseek/fclose to get a little more performance from less unnecessary buffering (helps video recording keep up a steady rate)

------------------------------------------------------------------------
r4766 | havoc | 2004-11-17 08:31:58 -0800 (Wed, 17 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

remove the only use of FS_Eof

------------------------------------------------------------------------
r4765 | havoc | 2004-11-17 07:42:39 -0800 (Wed, 17 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

made dedicated servers hog a whole lot less CPU time

------------------------------------------------------------------------
r4764 | havoc | 2004-11-17 01:58:38 -0800 (Wed, 17 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

325

------------------------------------------------------------------------
r4763 | molivier | 2004-11-17 00:40:05 -0800 (Wed, 17 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/todo

Give priority to unpacked files over packed files (the old AKVERSION behaviour)

------------------------------------------------------------------------
r4762 | havoc | 2004-11-17 00:11:04 -0800 (Wed, 17 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.inc

fixed windows SDL linking (now uses sdl-config like it should)

------------------------------------------------------------------------
r4761 | havoc | 2004-11-16 21:58:54 -0800 (Tue, 16 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

forgot a very important else in rtlights saving

------------------------------------------------------------------------
r4760 | havoc | 2004-11-16 04:18:58 -0800 (Tue, 16 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

now unloads all stale submodels and the old world model before loading the new one (this relies on the world model being the first precache to trigger this code at the appropriate time)

------------------------------------------------------------------------
r4759 | havoc | 2004-11-16 04:17:54 -0800 (Tue, 16 Nov 2004) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h

renamed mod->needload to mod->loaded as a minor cleanup (safer default)
removed now unused Mod_TouchModel

------------------------------------------------------------------------
r4758 | havoc | 2004-11-16 04:15:25 -0800 (Tue, 16 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

call Mod_FindName directly instead of Mod_TouchModel because one just wraps the other

------------------------------------------------------------------------
r4757 | havoc | 2004-11-16 04:14:51 -0800 (Tue, 16 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

now checks that a lightmap surfacechain is not NULL before dereferencing it

------------------------------------------------------------------------
r4756 | havoc | 2004-11-15 15:09:21 -0800 (Mon, 15 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

fixed bug that called PlayerPreThink and PlayerPostThink on unspawned clients

------------------------------------------------------------------------
r4755 | havoc | 2004-11-15 05:13:58 -0800 (Mon, 15 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

328 (a lot of new items)

------------------------------------------------------------------------
r4754 | havoc | 2004-11-14 18:48:40 -0800 (Sun, 14 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

forgot to commit this file

------------------------------------------------------------------------
r4753 | havoc | 2004-11-14 15:31:36 -0800 (Sun, 14 Nov 2004) | 4 lines
Changed paths:
   M /trunk/darkplaces/cgamevm.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h

upgraded rtlights format to have separate ambient, diffuse, and specular intensity scales, and also coronasize, this also allows corona-only lights by setting all scales to 0, and added normalmode/realtimemode flags so that lights can appear in normal mode, not just realtime mode (primarily useful for adding corona effects to a normal level)
added ambient light support to RenderLighting (non-bumpmapped diffuse)
some dlights now use ambientscale (this has not been exposed as a qc extension yet, qc lights remain the same)

------------------------------------------------------------------------
r4752 | havoc | 2004-11-14 15:23:19 -0800 (Sun, 14 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/server.h

remove unused sv_player extern

------------------------------------------------------------------------
r4751 | black | 2004-11-14 10:34:55 -0800 (Sun, 14 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_cmds.c

-Fixed a stupid bug in the VM_findchain* functions.

------------------------------------------------------------------------
r4750 | havoc | 2004-11-13 18:16:33 -0800 (Sat, 13 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/keys.c

someone removed the quotes around binds in Key_WriteBindings...  added back so that bind ";" whatever doesn't wreck the config

------------------------------------------------------------------------
r4744 | havoc | 2004-11-13 03:14:31 -0800 (Sat, 13 Nov 2004) | 5 lines
Changed paths:
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sv_user.c

replaced all uses of sv_player with host_client->edict (because sv_player was often invalid after a level change)
fixed a number of botclient crashes relating to invalid client->edict pointers after a level change
now sets client->spawned = true on botclients when freshly spawned (they were already being set correctly on level change)
DP_SV_BOTCLIENT now works properly

------------------------------------------------------------------------
r4743 | havoc | 2004-11-13 03:11:15 -0800 (Sat, 13 Nov 2004) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

no longer warns about q3bsp surfaces with lightmapindex -3 (or any other negative values below -1), as q3map2 seems to use these values intentionally it's rather pointless to warn about them
now warns about missing textures in q3bsp texture loading

------------------------------------------------------------------------
r4742 | havoc | 2004-11-12 15:18:57 -0800 (Fri, 12 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/dpmod/qc/dpextensions.qc

added DP_SV_BOTCLIENT extension

------------------------------------------------------------------------
r4741 | havoc | 2004-11-12 14:50:41 -0800 (Fri, 12 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/server.h

moved the extern prototype for SV_ConnectClient from netconn.c to server.h since the DP_SV_BOTCLIENT builtins will be calling it

------------------------------------------------------------------------
r4740 | havoc | 2004-11-12 14:42:20 -0800 (Fri, 12 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/sv_main.c

more preparation for DP_SV_BOTCLIENT, removed a number of unneeded netconnection checks and changed some others to check active, and made player info queries reply "botclient" for clients with no netconnection

------------------------------------------------------------------------
r4739 | havoc | 2004-11-12 14:09:18 -0800 (Fri, 12 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

print botclient as address in status reports for clients with no netconnection

------------------------------------------------------------------------
r4738 | havoc | 2004-11-12 14:08:07 -0800 (Fri, 12 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

cleaned up SV_DropClient code a bit

------------------------------------------------------------------------
r4737 | havoc | 2004-11-12 13:48:07 -0800 (Fri, 12 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/netconn.h
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c

moved rate and connecttime from netconn structure to client structure in preparation for DP_SV_BOTCLIENT extension

------------------------------------------------------------------------
r4736 | havoc | 2004-11-09 22:02:18 -0800 (Tue, 09 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h

made q3bsp alphafunc shaders render as transparent (quick hack)

------------------------------------------------------------------------
r4735 | havoc | 2004-11-09 18:32:00 -0800 (Tue, 09 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c

VorteX has fixed gettaginfo to work as advertised (properly handling of attached entities) and cleaned up gettagindex by splitting it into two functions

------------------------------------------------------------------------
r4734 | havoc | 2004-11-04 16:21:19 -0800 (Thu, 04 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

imposed a 20 frames at once limit in Host_ServerFrame

------------------------------------------------------------------------
r4733 | havoc | 2004-11-04 16:17:16 -0800 (Thu, 04 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

added a host_frametime limit of 1 second, so that it never tries to run more than 1 second per frame

------------------------------------------------------------------------
r4732 | havoc | 2004-11-03 09:13:37 -0800 (Wed, 03 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/menu.c

internal cleanup: split up CL_SparkShower into CL_SparkShower, CL_Smoke, and CL_BulletMark so the effects parser can be a little cleaner, also added gravityscale to CL_SparkShower

------------------------------------------------------------------------
r4731 | havoc | 2004-11-03 09:09:44 -0800 (Wed, 03 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.inc

updated cpu optimization choices

------------------------------------------------------------------------
r4730 | havoc | 2004-11-02 23:20:55 -0800 (Tue, 02 Nov 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

centerprint is no longer limited to 40 characters wide, it can now use up to the full vid.conwidth

------------------------------------------------------------------------
r4729 | havoc | 2004-10-30 12:25:03 -0700 (Sat, 30 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

307

------------------------------------------------------------------------
r4728 | havoc | 2004-10-30 10:12:06 -0700 (Sat, 30 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

308

------------------------------------------------------------------------
r4727 | havoc | 2004-10-30 06:50:16 -0700 (Sat, 30 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c

added DP_SV_CLIENTCOLORS and DP_SV_CLIENTNAME extensions (these were already documented and working but not listed)

------------------------------------------------------------------------
r4726 | havoc | 2004-10-30 06:46:22 -0700 (Sat, 30 Oct 2004) | 4 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c

added DP_SV_PING, DP_SV_PUNCHVECTOR, DP_SND_FAKETRACKS, and DP_FS_SEARCH extensions
corrected builtin table comments for DP_FS_SEARCH functions
removed DP_SV_EXTERIORMODELTOCLIENT extension (no such thing, the extension is named DP_ENT_EXTERIORMODELTOCLIENT)

------------------------------------------------------------------------
r4724 | havoc | 2004-10-30 05:03:59 -0700 (Sat, 30 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/dpmod/qc/dpextensions.qc

added DP_CON_SET and DP_CON_SETA extensions

------------------------------------------------------------------------
r4723 | black | 2004-10-29 07:37:19 -0700 (Fri, 29 Oct 2004) | 3 lines
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

-Moved the entity mem init in the entity load functions around a bit to
 make it possible for the menu parser to support full templates.

------------------------------------------------------------------------
r4722 | black | 2004-10-29 04:39:35 -0700 (Fri, 29 Oct 2004) | 4 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_exec.c

-Minor fix in VM_registercvar.
-Added \" support to quoted strings in Com_ParseToken.
-Minor change to PRVM_PrintStatus.

------------------------------------------------------------------------
r4721 | molivier | 2004-10-27 23:38:02 -0700 (Wed, 27 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

303

------------------------------------------------------------------------
r4720 | havoc | 2004-10-27 11:29:51 -0700 (Wed, 27 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

changed net_masterextra1 and 2 back to IP addresses (but kept their DNS names as comments), the DNS resolving takes too long, and caching it is non-trivial

------------------------------------------------------------------------
r4719 | havoc | 2004-10-27 11:21:04 -0700 (Wed, 27 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

304

------------------------------------------------------------------------
r4718 | havoc | 2004-10-27 11:18:05 -0700 (Wed, 27 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

now aborts video capture if it falls behind by more than a second (as the sound is likely hosed in that case)

------------------------------------------------------------------------
r4717 | havoc | 2004-10-27 11:11:36 -0700 (Wed, 27 Oct 2004) | 8 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/snd_mix.c

greatly improved video capture speed by generating the files much more directly (less processing)
added a raw video .rgb output mode (making only one file instead of thousands, for a slight speed gain, assuming you have tools that can read it)
video capture now maintains sound sync by duplicating frames to keep up a consistent video output speed (warning: do not attempt higher speeds than your machine is capable of, it WILL fall behind and get progressively slower very fast)
rewrote much of Host_FilterTime to improve video capture and simplify timing in general
removed host_minfps (now uses sys_ticrate instead)
renamed host_maxfps to cl_maxfps (as it only ever affected the client anyway)
now runs multiple server frames if host is falling behind, based on sys_ticrate (mainly useful to avoid slowing down when client is rendering really slow)

------------------------------------------------------------------------
r4716 | molivier | 2004-10-27 08:50:47 -0700 (Wed, 27 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cd_bsd.c
   M /trunk/darkplaces/cd_linux.c
   M /trunk/darkplaces/cd_sdl.c
   M /trunk/darkplaces/cd_shared.c
   M /trunk/darkplaces/cd_win.c
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   D /trunk/darkplaces/crc.c
   D /trunk/darkplaces/crc.h
   M /trunk/darkplaces/darkplaces.dev
   M /trunk/darkplaces/darkplaces.dsp
   M /trunk/darkplaces/gl_draw.c
   D /trunk/darkplaces/gl_warp_sin.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/image.h
   M /trunk/darkplaces/jpeg.c
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/makefile.inc
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/prvm_exec.c
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/wad.c
   M /trunk/darkplaces/wad.h

Pure cleaning commit: removed "crc.[ch]" and "gl_warp_sin.h", removed dead functions and dead variables, and moved several header includes out of "quakedef.h"

------------------------------------------------------------------------
r4715 | molivier | 2004-10-26 07:48:43 -0700 (Tue, 26 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_win.c

Updated Win32 sound module: the wave output code was partially rewritten since the old version was obviously pretty tied to Quake original output format; removed a few useless variables here and there; and a lot of whitespaces and comment changes, as usual

------------------------------------------------------------------------
r4714 | havoc | 2004-10-26 01:30:48 -0700 (Tue, 26 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/screen.h

get rid of the unused clearnotify and clearconsole variables

------------------------------------------------------------------------
r4713 | havoc | 2004-10-26 01:22:02 -0700 (Tue, 26 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

fix the "newname changed name to newname" bug

------------------------------------------------------------------------
r4712 | havoc | 2004-10-26 00:50:27 -0700 (Tue, 26 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c

moved the map startup for -listen and -dedicated servers from startdemos to just after the config parsing, so that startdemos is no longer required

------------------------------------------------------------------------
r4711 | havoc | 2004-10-26 00:41:31 -0700 (Tue, 26 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cd_shared.c

fixed 3 digit cdtracks loading (it was improperly checking the returned sfx, which is never NULL)

------------------------------------------------------------------------
r4710 | havoc | 2004-10-26 00:37:19 -0700 (Tue, 26 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cd_shared.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/dpvsimpledecode.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_mem.c
   M /trunk/darkplaces/snd_null.c
   M /trunk/darkplaces/sound.h

S_LoadSound now automatically tries both with and without sound/ when loading sounds, which allows quake3 maps to work better, since their target_speaker entities include sound/ in the filenames, this also got rid of the stdpath parameter in the S_PrecacheSound/S_FindName/S_LocalSound calls)

------------------------------------------------------------------------
r4709 | havoc | 2004-10-25 09:09:13 -0700 (Mon, 25 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

cruft removal

------------------------------------------------------------------------
r4708 | havoc | 2004-10-25 09:08:55 -0700 (Mon, 25 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

now displays light number (and total number of lights) in r_editlights mode

------------------------------------------------------------------------
r4707 | molivier | 2004-10-25 08:55:19 -0700 (Mon, 25 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c

Don't allow sound extra updates until the sounds have been spatialized (fix the noise at startup). A few whitespaces and a couple of minor changes.

------------------------------------------------------------------------
r4706 | havoc | 2004-10-25 00:35:51 -0700 (Mon, 25 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_oss.c

fix a signed/unsigned comparison warning

------------------------------------------------------------------------
r4705 | havoc | 2004-10-25 00:35:08 -0700 (Mon, 25 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c

fix a rare crash when a sound is emitted by an entity with a model whose precache pointer is NULL, apparently this happens in the Fiend Run Lite demos

------------------------------------------------------------------------
r4704 | havoc | 2004-10-25 00:33:02 -0700 (Mon, 25 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

don't warn about missing frames and skins in models that failed to load

------------------------------------------------------------------------
r4703 | molivier | 2004-10-25 00:13:18 -0700 (Mon, 25 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cd_bsd.c
   M /trunk/darkplaces/jpeg.c
   M /trunk/darkplaces/lhnet.c
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/makefile.bsd
   M /trunk/darkplaces/makefile.inc
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/snd_oss.c
   M /trunk/darkplaces/sys_shared.c

FreeBSD support

------------------------------------------------------------------------
r4701 | tomaz | 2004-10-23 14:43:38 -0700 (Sat, 23 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

308

------------------------------------------------------------------------
r4700 | havoc | 2004-10-23 08:39:48 -0700 (Sat, 23 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_execprogram.h

made traceon/traceoff take effect immediately (forgot to check for pr_trace change where it mattered - after a builtin call)

------------------------------------------------------------------------
r4699 | havoc | 2004-10-23 03:41:43 -0700 (Sat, 23 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/dpmod/qc/dpextensions.qc

added DP_SV_DROPCLIENT extension

------------------------------------------------------------------------
r4698 | havoc | 2004-10-23 03:00:38 -0700 (Sat, 23 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c

removed number field from client_t struct as it seemed to be behaving unreliably in SV_DropClient (resulting in changes to the scoreboard entry for client 0, regardless of which client was dropped)

------------------------------------------------------------------------
r4697 | havoc | 2004-10-23 02:46:26 -0700 (Sat, 23 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt
   M /trunk/darkplaces/vid_wgl.c

now defaults to DirectInput in windows, -dinput option changed to -nodinput and readme updated accordingly

------------------------------------------------------------------------
r4696 | black | 2004-10-22 17:36:48 -0700 (Fri, 22 Oct 2004) | 5 lines
Changed paths:
   M /trunk/darkplaces/cd_shared.c

-Added the constant MAXTRACKS which is set to 256.
 (remap has the type qbyte[256] now)
-CD_Play now also searches for fake tracks with 3 digits.
 (the old 2 digit search is kept for compatibility)

------------------------------------------------------------------------
r4695 | tomaz | 2004-10-22 16:21:29 -0700 (Fri, 22 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

309

------------------------------------------------------------------------
r4694 | tomaz | 2004-10-22 11:31:46 -0700 (Fri, 22 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

310

------------------------------------------------------------------------
r4693 | havoc | 2004-10-22 03:56:42 -0700 (Fri, 22 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

don't crash on dlights trying to cast shadows from world surfaces when there is no world model

------------------------------------------------------------------------
r4692 | molivier | 2004-10-22 01:29:15 -0700 (Fri, 22 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

Updated Transfusion map list

------------------------------------------------------------------------
r4691 | black | 2004-10-21 10:44:34 -0700 (Thu, 21 Oct 2004) | 5 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/zone.c
   M /trunk/darkplaces/zone.h

- Added Mem_IsAllocated.
- Decreased the required parameter count of VM_strcat to 1.
- Added a check to VM_strunzone so it wont free already freed strings and
  thus crash the qc (only if developer != 0).

------------------------------------------------------------------------
r4690 | havoc | 2004-10-21 06:30:27 -0700 (Thu, 21 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c

VorteX fixed the "circle bug" in his SV_GetTagMatrix code

------------------------------------------------------------------------
r4685 | molivier | 2004-10-21 02:04:27 -0700 (Thu, 21 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

Several changes for single player support in Transfusion (based on a patch by Kazashi)

------------------------------------------------------------------------
r4684 | havoc | 2004-10-21 01:45:59 -0700 (Thu, 21 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c

don't allow Log_ConPrint to recurse into itself, as can happen with a memory corruption report -> Log_ConPrint -> memory corruption report -> Log_ConPrint -> ...

------------------------------------------------------------------------
r4683 | havoc | 2004-10-20 06:41:05 -0700 (Wed, 20 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

313

------------------------------------------------------------------------
r4682 | havoc | 2004-10-20 06:30:42 -0700 (Wed, 20 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

if a (supposedly) quake sky texture is not 128x256, upload it just as a solid layer

------------------------------------------------------------------------
r4681 | havoc | 2004-10-20 06:29:07 -0700 (Wed, 20 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

now loads a .ent file for lights if found

------------------------------------------------------------------------
r4680 | havoc | 2004-10-20 06:19:48 -0700 (Wed, 20 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c

ignore first mouse move after mouse grab as it's generally garbage

------------------------------------------------------------------------
r4679 | havoc | 2004-10-20 05:58:15 -0700 (Wed, 20 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/cmd.h
   M /trunk/darkplaces/keys.c

messagemode/messagemode2 now send the say/say_team command directly instead of passing through the client console, so that typing something like ";quit" as a message does not quit the game

------------------------------------------------------------------------
r4678 | havoc | 2004-10-20 04:58:58 -0700 (Wed, 20 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/render.h

fixed r_restart skybox crash (as well as incorrect texture bugs related to this), and moved alphaskytexture/solidskytexture to q1bsp texture loader, now part of the world model instead of separate

------------------------------------------------------------------------
r4677 | havoc | 2004-10-20 00:18:40 -0700 (Wed, 20 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/image.c

Image_WriteTGARGBA now writes 8 as the attributes byte (which GIMP seems to need to recognize the alpha channel)

------------------------------------------------------------------------
r4676 | havoc | 2004-10-19 21:16:32 -0700 (Tue, 19 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

removed a pmodel reference I forgot to remove

------------------------------------------------------------------------
r4675 | havoc | 2004-10-19 19:40:59 -0700 (Tue, 19 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c

fix problems with losing colors on connect and leaving ghosts on the scoreboard and other glitches related to edict clearing

------------------------------------------------------------------------
r4674 | tomaz | 2004-10-19 04:32:35 -0700 (Tue, 19 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

Enlarged particle font from 256x256 to 512x512 and added saving of the font to a TGA (#if 0 'd)

------------------------------------------------------------------------
r4673 | havoc | 2004-10-19 03:58:50 -0700 (Tue, 19 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

reset nametime at prespawn (before name command is sent by client) and spawn (after name command is sent by client)

------------------------------------------------------------------------
r4672 | havoc | 2004-10-19 02:57:09 -0700 (Tue, 19 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

remove unused variables

------------------------------------------------------------------------
r4671 | havoc | 2004-10-19 02:54:36 -0700 (Tue, 19 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

instead of sending a scoreboard update in the DropClient code, let it happen at the next SV_UpdateToReliableMessages

------------------------------------------------------------------------
r4670 | havoc | 2004-10-19 02:53:31 -0700 (Tue, 19 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

fixed problem with lost scoreboard messages to a client that is still loading

------------------------------------------------------------------------
r4669 | havoc | 2004-10-19 02:44:14 -0700 (Tue, 19 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/sys_shared.c

Host_Shutdown now calls CL_Disconnect and Host_ShutdownServer so that quitting without using the quit command no longer leaves a player connected to the server

------------------------------------------------------------------------
r4668 | havoc | 2004-10-19 01:14:33 -0700 (Tue, 19 Oct 2004) | 3 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

cleaned up scoreboard printing loops a bit (they don't need to check if the name is empty)
fixed (I think, after much testing) the duplicate names bug in the mini scoreboard by changing a bound to a separate max and min (evidently the loop index was starting < 0)

------------------------------------------------------------------------
r4666 | havoc | 2004-10-18 17:48:15 -0700 (Mon, 18 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt

added mention in credits of romi's rtlights pk3 being included in dpmod

------------------------------------------------------------------------
r4665 | molivier | 2004-10-18 08:18:36 -0700 (Mon, 18 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_main.c
   M /trunk/darkplaces/snd_win.c

Finally removed the Win32 specific code from "snd_main.c". Changed a few comments and fixed a typo in the process.

------------------------------------------------------------------------
r4664 | havoc | 2004-10-18 03:16:26 -0700 (Mon, 18 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_sdl.c

add support for 32bit color in SDL builds

------------------------------------------------------------------------
r4663 | black | 2004-10-17 12:48:02 -0700 (Sun, 17 Oct 2004) | 3 lines
Changed paths:
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/sbar.c

-Renamed two builtins of the new VM
-Fixed the hud weapon selection

------------------------------------------------------------------------
r4662 | havoc | 2004-10-17 04:51:38 -0700 (Sun, 17 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h

snap curve vertices to solve some finicky collision problems and probably also makes things look a little better where two curves meet in some cases

------------------------------------------------------------------------
r4661 | havoc | 2004-10-17 04:48:29 -0700 (Sun, 17 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/curves.c

fix an incomplete edit on variable naming

------------------------------------------------------------------------
r4660 | havoc | 2004-10-17 04:40:40 -0700 (Sun, 17 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/curves.c
   M /trunk/darkplaces/curves.h
   M /trunk/darkplaces/model_brush.c

now using all-new Q3 patch tesselation code, matching Quake3 pretty well

------------------------------------------------------------------------
r4659 | havoc | 2004-10-17 04:19:18 -0700 (Sun, 17 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

increased edge hash size from 1024 items to 16384, cutting down on long q3bsp load times when generating the shadow mesh

------------------------------------------------------------------------
r4658 | havoc | 2004-10-17 04:16:42 -0700 (Sun, 17 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt

added VorteX to thanks list

------------------------------------------------------------------------
r4657 | havoc | 2004-10-17 04:15:57 -0700 (Sun, 17 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c

added DP_QC_GETTAGINFO extension (thanks VorteX!)

------------------------------------------------------------------------
r4655 | havoc | 2004-10-17 00:42:29 -0700 (Sun, 17 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

314

------------------------------------------------------------------------
r4654 | havoc | 2004-10-16 19:24:58 -0700 (Sat, 16 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt

added |Rain| and feh to credits

------------------------------------------------------------------------
r4653 | havoc | 2004-10-16 14:47:45 -0700 (Sat, 16 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

fixed an unused variable warning

------------------------------------------------------------------------
r4652 | havoc | 2004-10-16 14:34:42 -0700 (Sat, 16 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

315

------------------------------------------------------------------------
r4651 | havoc | 2004-10-16 14:33:04 -0700 (Sat, 16 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

don't spew shaders to console on load unless developer is 2 or higher

------------------------------------------------------------------------
r4650 | havoc | 2004-10-16 13:28:51 -0700 (Sat, 16 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

forgot to remove a debugging test that emitted sparks from autosprite2 shaders

------------------------------------------------------------------------
r4649 | havoc | 2004-10-16 04:58:31 -0700 (Sat, 16 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

hush reconnect command warning about signon 0 because it happens all the time

------------------------------------------------------------------------
r4648 | havoc | 2004-10-16 04:29:13 -0700 (Sat, 16 Oct 2004) | 5 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h

now parses more of q3 shaders to guess at proper rendering settings for surfaces, now implemented are additive blend, deformvertexes autosprite (and autosprite2), nomipmaps, nopicmip, cull twosided/none/disable, surfaceparm nomipmap
now assumes that a q3 texture is not transparent unless it has a shader saying it is (yes shaders are now required to enable transparency in q3bsp)
now loads the texture used in the first pass of the shader if there is no texture of the same name as the shader itself
what this all means: quake3 maps look 99% correct (other than lack of animation and various shader effects)

------------------------------------------------------------------------
r4647 | black | 2004-10-16 02:56:56 -0700 (Sat, 16 Oct 2004) | 3 lines
Changed paths:
   M /trunk/darkplaces/vid_wgl.c

-Added static, global baseDC and baseRC variables to avoid having to call
 qwglGetCurrent* all the time.

------------------------------------------------------------------------
r4646 | havoc | 2004-10-16 00:00:52 -0700 (Sat, 16 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

fixed a typo in the numtriangles commit (should have been num_triangles)

------------------------------------------------------------------------
r4645 | havoc | 2004-10-15 23:58:28 -0700 (Fri, 15 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

skip surfaces with no triangles in Q3BSP rendering code to avoid a R_Mesh_Draw warning

------------------------------------------------------------------------
r4644 | havoc | 2004-10-15 22:52:36 -0700 (Fri, 15 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

don't check visframe on q3bsp surfaces, it's not used

------------------------------------------------------------------------
r4643 | havoc | 2004-10-15 21:50:44 -0700 (Fri, 15 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_exec.c

expanded PR_PrintState from 5 statements to 8 statements printed, to give more chance of seeing the parameters to a function in warnings/crashes

------------------------------------------------------------------------
r4642 | havoc | 2004-10-15 21:49:07 -0700 (Fri, 15 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c

added reporting of what model is unprecached in no precache warning

------------------------------------------------------------------------
r4641 | havoc | 2004-10-15 21:48:18 -0700 (Fri, 15 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt

added MoALTz to thanks list

------------------------------------------------------------------------
r4640 | havoc | 2004-10-15 16:22:38 -0700 (Fri, 15 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

forgot to give strlcat a size

------------------------------------------------------------------------
r4639 | havoc | 2004-10-15 16:09:13 -0700 (Fri, 15 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

added a newline to chat messages

------------------------------------------------------------------------
r4638 | havoc | 2004-10-15 14:20:26 -0700 (Fri, 15 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.inc

added -lSDL to the windows SDL link flags

------------------------------------------------------------------------
r4637 | black | 2004-10-15 14:18:02 -0700 (Fri, 15 Oct 2004) | 5 lines
Changed paths:
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/vid_wgl.c

-Added a more descriptive comment for prvm_edict_t::p
-Added 3 new builtins to the new VM: ftoe, etof, parseentitydata
-Changed the Win32 driver to reuse the GL hDC if possible instead of
 calling GetDC and ReleaseDC every frame.

------------------------------------------------------------------------
r4636 | havoc | 2004-10-15 14:08:25 -0700 (Fri, 15 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/sys_linux.c
   M /trunk/darkplaces/sys_sdl.c

changed main() argv parameter to non-const, and casting it to const on assignment instead, this should fix an SDL compilation problem

------------------------------------------------------------------------
r4635 | havoc | 2004-10-15 13:25:17 -0700 (Fri, 15 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c

added DP_LITSPRITES extension string

------------------------------------------------------------------------
r4632 | havoc | 2004-10-15 00:08:46 -0700 (Fri, 15 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

315

------------------------------------------------------------------------
r4631 | havoc | 2004-10-15 00:08:12 -0700 (Fri, 15 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/menu.h
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/todo

now shows status messages in join game menu when a server is typed in manually (it was only showing them in the server list, oops), also added additional status messages

------------------------------------------------------------------------
r4630 | havoc | 2004-10-14 23:56:18 -0700 (Thu, 14 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/lhnet.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/netconn.h

reduced cl_net* cvars to just cl_netlocalping and cl_netpacketloss and removed sv_netpacketloss cvars

------------------------------------------------------------------------
r4629 | havoc | 2004-10-14 23:53:41 -0700 (Thu, 14 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

revert an optimization to shadow volume generation that saved a little cpu time but cost a lot of gpu fillrate, and caused shadows to randomly invert sometimes

------------------------------------------------------------------------
r4628 | havoc | 2004-10-13 16:28:50 -0700 (Wed, 13 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

thanks much to Moz for fixing the r_stereo_separation code, it now has proper eye positioning and looks MUCH better

------------------------------------------------------------------------
r4626 | molivier | 2004-10-13 06:45:16 -0700 (Wed, 13 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_mem.c
   M /trunk/darkplaces/snd_mix.c

Fixed a couple of comments, and modified slightly the developer printing in ResampleSfx

------------------------------------------------------------------------
r4625 | molivier | 2004-10-13 06:42:10 -0700 (Wed, 13 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.dev
   M /trunk/darkplaces/darkplaces.dsp
   M /trunk/darkplaces/makefile.inc
   D /trunk/darkplaces/snd_dma.c
   A /trunk/darkplaces/snd_main.c

snd_dma.c -> snd_main.c

------------------------------------------------------------------------
r4624 | molivier | 2004-10-13 00:03:57 -0700 (Wed, 13 Oct 2004) | 15 lines
Changed paths:
   M /trunk/darkplaces/cd_shared.c
   M /trunk/darkplaces/cdaudio.h
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/darkplaces.dev
   M /trunk/darkplaces/darkplaces.dsp
   M /trunk/darkplaces/dpvsimpledecode.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/snd_alsa.c
   M /trunk/darkplaces/snd_bsd.c
   M /trunk/darkplaces/snd_dma.c
   A /trunk/darkplaces/snd_main.h
   M /trunk/darkplaces/snd_mem.c
   M /trunk/darkplaces/snd_mix.c
   M /trunk/darkplaces/snd_null.c
   M /trunk/darkplaces/snd_ogg.c
   M /trunk/darkplaces/snd_oss.c
   M /trunk/darkplaces/snd_sdl.c
   M /trunk/darkplaces/snd_wav.c
   M /trunk/darkplaces/snd_win.c
   M /trunk/darkplaces/sound.h
   M /trunk/darkplaces/todo
   M /trunk/darkplaces/vid_wgl.c

Lots of minor fixes and improvements to the sound engine, plus a few more important changes:
- moved the internal structures and API into a separate file (snd_main.h)
- added a lock mecanism on SFXs to free them as soon as they're no longer used
- simplified the sound API
- minor fixes and comment changes here and there
- independent sound volume for fake CD tracks
- updated MSVC and Dev-C++ project files accordingly
- removed unused functions
- added a SFX flag to make sure the engine complains at most one time for each missing sound file
- made the SFX list a linked list to remove the hardcoded limit for the number of SFX a client can handle
- changed the way ambient sounds are managed to be more consistent with the new API
- factorized some code
- removed the useless IN_Accumulate in the Win32 specific code
- removed the table for 8bit sound mixing (snd_scaletable)

------------------------------------------------------------------------
r4623 | black | 2004-10-12 12:08:30 -0700 (Tue, 12 Oct 2004) | 6 lines
Changed paths:
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_edict.c

-Its now possible to add support for other edict_private structs easily.
(Note: You have to derive them by composition from the original one -
e.g. struct server_edict_private_s { prvm_edict_private_t base; ... };
or just copy the elements from prvm_edict_private_t into the new struct -
and add them to the anonymous union p in prvm_edict_t.)

------------------------------------------------------------------------
r4622 | havoc | 2004-10-12 10:27:06 -0700 (Tue, 12 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

allow invalid skin numbers on entities using tenebrae dlights (falling back to the model's skin 0 for actual rendering, but using the skin number for a dlight cubemap)

------------------------------------------------------------------------
r4621 | havoc | 2004-10-10 11:51:32 -0700 (Sun, 10 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.inc

enabled SDL sound and CD

------------------------------------------------------------------------
r4620 | havoc | 2004-10-10 11:51:05 -0700 (Sun, 10 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_sdl.c

fixed a signed/unsigned warning

------------------------------------------------------------------------
r4619 | havoc | 2004-10-10 11:50:38 -0700 (Sun, 10 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_wgl.c

made MapKey static since it's not used anywhere else

------------------------------------------------------------------------
r4618 | havoc | 2004-10-09 20:08:00 -0700 (Sat, 09 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

remove quotes on say commands at the server end (like it used to, this is done a little cleaner though)

------------------------------------------------------------------------
r4617 | havoc | 2004-10-09 11:30:00 -0700 (Sat, 09 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

315

------------------------------------------------------------------------
r4616 | havoc | 2004-10-08 19:03:39 -0700 (Fri, 08 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/world.c
   M /trunk/darkplaces/world.h

added SV_EntitiesInBox function to find entities within a box, merging the box testing in the trigger/trace code, and also greatly optimized PF_findradius using this function

------------------------------------------------------------------------
r4615 | havoc | 2004-10-08 18:56:14 -0700 (Fri, 08 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

fixed reconnect command which was being ignored by the client (forgot that it doesn't know what came from the client console and what came from the server, so disabling it in the client console was a bad idea)

------------------------------------------------------------------------
r4614 | havoc | 2004-10-08 13:15:00 -0700 (Fri, 08 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sv_user.c

added "QC function <name> is missing" warnings to more PR_ExecuteProgram calls

------------------------------------------------------------------------
r4613 | havoc | 2004-10-08 13:12:16 -0700 (Fri, 08 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

simplified r_rt* variable setup a little bit

------------------------------------------------------------------------
r4612 | havoc | 2004-10-08 13:11:04 -0700 (Fri, 08 Oct 2004) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/sv_user.c

got rid of cl_nodelta cvar (it has never been useful, and rarely worked)
got rid of ackframenum -1 handling
removed ackframenum from entityframe4 and entityframe5 databases as they didn't use it for anything anyway (it is used only temporarily inside the AckFrame functions)

------------------------------------------------------------------------
r4611 | havoc | 2004-10-08 12:39:47 -0700 (Fri, 08 Oct 2004) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/gl_rmain.c

fixed constant resetting of animation interpolation on entities that just spawned (fixes framegroup animation problems on non-static entities that don't change much)
changed movement interpolation to better handle every-other-frame updates which tend to happen with rate limiting

------------------------------------------------------------------------
r4610 | havoc | 2004-10-08 09:15:47 -0700 (Fri, 08 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_edict.c

fix automatic addition of "color" field to be a vector

------------------------------------------------------------------------
r4607 | havoc | 2004-10-07 21:31:06 -0700 (Thu, 07 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

cleaned up Host_Say to not process the message (MUCH simpler and I didn't trust that code anyway), fixed crash with fromServer messages (it was not checking teamonly, save is not a valid edict)

------------------------------------------------------------------------
r4606 | havoc | 2004-10-07 11:55:13 -0700 (Thu, 07 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

fix color problem with glow_trail (the blue trail bug)

------------------------------------------------------------------------
r4605 | havoc | 2004-10-06 19:17:51 -0700 (Wed, 06 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

306

------------------------------------------------------------------------
r4604 | havoc | 2004-10-06 17:48:19 -0700 (Wed, 06 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/protocol.c

fixed lingering entities in quake protocol (off by one error in the entity removal loop)

------------------------------------------------------------------------
r4603 | havoc | 2004-10-06 17:42:14 -0700 (Wed, 06 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

added cl_beams_* cvars to effects options menu

------------------------------------------------------------------------
r4602 | havoc | 2004-10-06 12:39:01 -0700 (Wed, 06 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

now should be able to connect to another server without leaving the current server until the connection is accepted

------------------------------------------------------------------------
r4601 | havoc | 2004-10-06 12:31:09 -0700 (Wed, 06 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

now begins loading plaque at all the appropriate places, which also means an end to sound during loading

------------------------------------------------------------------------
r4600 | havoc | 2004-10-06 10:10:44 -0700 (Wed, 06 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c

fix nehahra movie support (forgot to handle its protocol number in MSG_ReadCoord)

------------------------------------------------------------------------
r4599 | havoc | 2004-10-05 17:26:37 -0700 (Tue, 05 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_sprites.c

sprites now work with EF_NODEPTHTEST

------------------------------------------------------------------------
r4598 | havoc | 2004-10-05 10:52:06 -0700 (Tue, 05 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

only enable watershader on fullbright water

------------------------------------------------------------------------
r4597 | havoc | 2004-10-05 10:44:16 -0700 (Tue, 05 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/makefile.bsd
   M /trunk/darkplaces/makefile.inc
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/sys_sdl.c
   M /trunk/darkplaces/vid_sdl.c

now compiles on x86_64 successfully (still a crash regarding progs strings to fix later)

------------------------------------------------------------------------
r4596 | havoc | 2004-10-05 08:22:58 -0700 (Tue, 05 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt

added commandline options section

------------------------------------------------------------------------
r4595 | havoc | 2004-10-05 08:22:17 -0700 (Tue, 05 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cd_bsd.c
   M /trunk/darkplaces/cd_linux.c
   M /trunk/darkplaces/cd_shared.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/palette.c
   M /trunk/darkplaces/snd_alsa.c
   M /trunk/darkplaces/snd_dma.c
   M /trunk/darkplaces/snd_ogg.c
   M /trunk/darkplaces/snd_oss.c
   M /trunk/darkplaces/snd_sdl.c
   M /trunk/darkplaces/snd_win.c
   M /trunk/darkplaces/sys_shared.c
   M /trunk/darkplaces/sys_win.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c

revised commandline option comments for better categorization when sorted

------------------------------------------------------------------------
r4594 | havoc | 2004-10-05 07:08:15 -0700 (Tue, 05 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cd_bsd.c
   M /trunk/darkplaces/cd_linux.c
   M /trunk/darkplaces/cd_shared.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/palette.c
   M /trunk/darkplaces/snd_alsa.c
   M /trunk/darkplaces/snd_dma.c
   M /trunk/darkplaces/snd_ogg.c
   M /trunk/darkplaces/snd_oss.c
   M /trunk/darkplaces/snd_sdl.c
   M /trunk/darkplaces/snd_win.c
   M /trunk/darkplaces/sys_shared.c
   M /trunk/darkplaces/sys_win.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c

added COMMANDLINEOPTION comments for every commandline option, these will be listed in the readme

------------------------------------------------------------------------
r4593 | havoc | 2004-10-04 14:28:58 -0700 (Mon, 04 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

fix colormap checking in ValidateState, it was throwing out RENDER_COLORMAPPED colormaps (which are not client numbers)

------------------------------------------------------------------------
r4592 | havoc | 2004-10-04 14:28:13 -0700 (Mon, 04 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

fix skybox in hlbsp not rendering

------------------------------------------------------------------------
r4591 | havoc | 2004-10-04 14:13:49 -0700 (Mon, 04 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c

MSG_ReadAngle functions now return -180 to +180 range instead of 0-360 range which should fix glitches with player model pitch when looking down

------------------------------------------------------------------------
r4590 | havoc | 2004-10-04 13:44:53 -0700 (Mon, 04 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

305

------------------------------------------------------------------------
r4589 | havoc | 2004-10-04 11:50:30 -0700 (Mon, 04 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

fix negative frags showing up as 65535 and such

------------------------------------------------------------------------
r4588 | havoc | 2004-10-04 09:43:24 -0700 (Mon, 04 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

304

------------------------------------------------------------------------
r4587 | havoc | 2004-10-04 07:15:13 -0700 (Mon, 04 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/wad.c

fix a very stupid way of addressing memory which is not 64bit compatible in the miptex reader

------------------------------------------------------------------------
r4586 | havoc | 2004-10-04 07:04:05 -0700 (Mon, 04 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/progs.h

NUM_FOR_EDICT now casts to int so that it never returns a 64bit integer on 64bit compiles which sometimes end up getting passed to printf with the wrong format...

------------------------------------------------------------------------
r4585 | molivier | 2004-10-03 23:58:57 -0700 (Sun, 03 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c

Allocated the log queue earlier in Log_Init since Cvar_* functions now print developer information

------------------------------------------------------------------------
r4584 | molivier | 2004-10-03 23:56:58 -0700 (Sun, 03 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_mix.c

Moved the clamping of volumes higher in the mixing code, so that 16 bit sounds are clamped too

------------------------------------------------------------------------
r4582 | havoc | 2004-10-03 12:15:44 -0700 (Sun, 03 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

304

------------------------------------------------------------------------
r4581 | tomaz | 2004-10-03 12:08:15 -0700 (Sun, 03 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

298

------------------------------------------------------------------------
r4580 | havoc | 2004-10-03 03:27:50 -0700 (Sun, 03 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/vid_shared.c

remove support for GL_NV_vertex_array_range as it's obsolete and unused

------------------------------------------------------------------------
r4579 | havoc | 2004-10-03 03:17:31 -0700 (Sun, 03 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_wgl.c

added -novideosync disable for WGL swap control

------------------------------------------------------------------------
r4578 | havoc | 2004-10-02 14:09:34 -0700 (Sat, 02 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c

fix cvar_string to check if the cvar exists

------------------------------------------------------------------------
r4574 | havoc | 2004-10-01 07:07:59 -0700 (Fri, 01 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

298

------------------------------------------------------------------------
r4573 | havoc | 2004-10-01 07:05:47 -0700 (Fri, 01 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

299

------------------------------------------------------------------------
r4572 | havoc | 2004-10-01 03:43:24 -0700 (Fri, 01 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

323

------------------------------------------------------------------------
r4569 | havoc | 2004-10-01 01:39:08 -0700 (Fri, 01 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

save shorter rtlights lines when cubemap/corona/angles are not used, saves a bit of space

------------------------------------------------------------------------
r4568 | havoc | 2004-10-01 00:54:54 -0700 (Fri, 01 Oct 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

fix an accidentally removed variable, and move a couple unused variables into the #else block they're used in

------------------------------------------------------------------------
r4567 | havoc | 2004-09-30 10:23:58 -0700 (Thu, 30 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

made shadowvolume building about 40% faster by not using projectdistance

------------------------------------------------------------------------
r4566 | havoc | 2004-09-30 09:38:54 -0700 (Thu, 30 Sep 2004) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h

sped up nexuiz rtlights benchmark by 4% by optimizing box cull on models to skip triangle box cull when surface box is entirely inside light box
restructured R_Shadow_ConstructShadowVolume loops a bit to make for less stalls, this seems to have only netted a 0.5% speed gain or so

------------------------------------------------------------------------
r4565 | havoc | 2004-09-30 03:05:01 -0700 (Thu, 30 Sep 2004) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h

removed a few fields from q3msurface_t
added a facelist to each q3mtexture_t so that the renderer can build a list of faces of the same texture without any face->texture comparisons
rewrote R_Q3BSP_DrawSky and R_Q3BSP_Draw, this improved a nexuiz timedemo with no rtlights by 116%

------------------------------------------------------------------------
r4564 | havoc | 2004-09-29 03:50:28 -0700 (Wed, 29 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

recalculate model->brushq3.num_leafs during loading because some broken q3map/q3map2 compiler versions actually count submodels as leafs in the bsp file

------------------------------------------------------------------------
r4563 | havoc | 2004-09-28 02:15:04 -0700 (Tue, 28 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.ico

updated darkplaces icon with 6 sizes of 32bit (XP icon) and 4 sizes of 8bit (non-XP icon), thanks de-we

------------------------------------------------------------------------
r4561 | havoc | 2004-09-27 23:59:21 -0700 (Mon, 27 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

324

------------------------------------------------------------------------
r4560 | havoc | 2004-09-27 23:38:45 -0700 (Mon, 27 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_sprites.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/dpmod/qc/dpextensions.qc

implemented DP_EF_NODEPTHTEST extension

------------------------------------------------------------------------
r4559 | havoc | 2004-09-27 22:34:59 -0700 (Mon, 27 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

use a less bizarre method of byte swapping q1bsp/q3bsp headers

------------------------------------------------------------------------
r4558 | tomaz | 2004-09-27 15:03:22 -0700 (Mon, 27 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

325

------------------------------------------------------------------------
r4557 | tomaz | 2004-09-27 15:00:16 -0700 (Mon, 27 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

326

------------------------------------------------------------------------
r4556 | havoc | 2004-09-27 06:41:21 -0700 (Mon, 27 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

327

------------------------------------------------------------------------
r4555 | havoc | 2004-09-27 06:39:27 -0700 (Mon, 27 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

upgraded particle font texture to 512x512 and changed the blood texture, and made blood splats larger (to make use of the more detailed texture)

------------------------------------------------------------------------
r4554 | havoc | 2004-09-27 04:31:52 -0700 (Mon, 27 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

fixed r_shadow_realtime_world_lightmaps cvar control to be a slider, it was a checkbox

------------------------------------------------------------------------
r4553 | havoc | 2004-09-27 00:09:58 -0700 (Mon, 27 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

325

------------------------------------------------------------------------
r4552 | tomaz | 2004-09-26 23:12:30 -0700 (Sun, 26 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

326

------------------------------------------------------------------------
r4551 | havoc | 2004-09-26 18:29:47 -0700 (Sun, 26 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

327 and reformatted notify list to sort by name first

------------------------------------------------------------------------
r4550 | tomaz | 2004-09-26 16:10:06 -0700 (Sun, 26 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

329

------------------------------------------------------------------------
r4549 | havoc | 2004-09-26 07:02:21 -0700 (Sun, 26 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

fix recently added notifies to say who to notify

------------------------------------------------------------------------
r4548 | havoc | 2004-09-26 06:47:27 -0700 (Sun, 26 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

336

------------------------------------------------------------------------
r4546 | havoc | 2004-09-26 06:42:22 -0700 (Sun, 26 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

static entities now light and shadow properly

------------------------------------------------------------------------
r4545 | havoc | 2004-09-26 06:23:06 -0700 (Sun, 26 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/host.c

minor cleanup - merged R_UpdateWorld into other places

------------------------------------------------------------------------
r4541 | havoc | 2004-09-26 06:11:04 -0700 (Sun, 26 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_shadow.c

r_fullbright 1 now works properly with r_shadow_realtime_world 1 (why anyone would want to do this? no idea)

------------------------------------------------------------------------
r4540 | havoc | 2004-09-26 05:46:40 -0700 (Sun, 26 Sep 2004) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/model_sprite.c
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_sprites.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/sv_user.c

added r_rtworld, r_rtworldshadows, r_rtdlight, r_rtdlightshadows, and r_lightmapintensity cvars to greatly clean up the handling of the various rtlight/normal rendering modes
ifixed lighting problems on transparent alias models in r_shadow_realtime_world mode with r_shadow_realtime_world_lightmaps < 1 (note: still does not use the rtlights entities, just bsp model light queries like lightmap mode uses)
cleaned up handling regarding RENDER_LIGHT, RENDER_SHADOW, EF_ADDITIVE, alpha, r_fullbright, RENDER_EXTERIORMODEL, and model->flags (now the EF_ADDITIVE and EF_FULLBRIGHT flags were moved to model->flags2)
tag children now inherit RENDER_EXTERIORMODEL from their parent so you can simply attach an external weapon model to the player model and it will appear/disappear according to chase_active appropriately

------------------------------------------------------------------------
r4539 | havoc | 2004-09-26 05:14:37 -0700 (Sun, 26 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

removed some very stale dead code

------------------------------------------------------------------------
r4538 | tomaz | 2004-09-26 04:25:11 -0700 (Sun, 26 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c

Fixed some errors in the vid_vsync code.

------------------------------------------------------------------------
r4537 | havoc | 2004-09-25 21:06:45 -0700 (Sat, 25 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_models.c

remove unused variable generatenormals

------------------------------------------------------------------------
r4536 | havoc | 2004-09-25 19:23:11 -0700 (Sat, 25 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

fix R_Shadow_UpdateWorldLight (used by editing commands) to set cubemap even if it's an empty string, otherwise it's impossible to remove a cubemap on a light

------------------------------------------------------------------------
r4535 | havoc | 2004-09-22 18:44:33 -0700 (Wed, 22 Sep 2004) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_alias.h
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h

added a Mod_BuildNormals function to accelerate vertex lighting which doesn't need texture vectors
moved vertex blending function from gl_models.c to model_alias.c and renamed accordingly
model loader now compiles frame zero into raw arrays because most models are not animated, this speeds up non-animated models, and anything else idling on frame 0, this eliminates vertex processing in many cases

------------------------------------------------------------------------
r4534 | havoc | 2004-09-21 02:34:06 -0700 (Tue, 21 Sep 2004) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/sv_main.c

made quakec stuffed quake1 protocol entities work alongside newer protocols, to attempt to fix the ending of Scourge of Armagon (still not working properly yet, camera is not taking the angles except in PROTOCOL_QUAKE mode)
also fixed separator positioning in Com_HexDumpToConsole (used for packet dumps)

------------------------------------------------------------------------
r4533 | havoc | 2004-09-21 02:18:30 -0700 (Tue, 21 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

this should fix a stupid bug with PROTOCOL_DARKPLACES4 clc_ackentities (client wasn't using the right framenum variable)

------------------------------------------------------------------------
r4532 | havoc | 2004-09-21 00:03:49 -0700 (Tue, 21 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/dpmod/qc/dpextensions.qc

corrected name of NXQ_GFX_LETTERBOX (it was misnamed PXQ_GFX_LETTERBOX, my mistake, sorry)

------------------------------------------------------------------------
r4531 | havoc | 2004-09-20 20:14:39 -0700 (Mon, 20 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

340

------------------------------------------------------------------------
r4530 | havoc | 2004-09-20 14:42:34 -0700 (Mon, 20 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

341

------------------------------------------------------------------------
r4529 | havoc | 2004-09-19 22:51:21 -0700 (Sun, 19 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/r_crosshairs.c
   M /trunk/darkplaces/screen.h
   M /trunk/dpmod/qc/dpextensions.qc

added PXQ_GFX_LETTERBOX extension

------------------------------------------------------------------------
r4528 | havoc | 2004-09-19 21:45:51 -0700 (Sun, 19 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

changed net_master's to ghdigital.com and dpmaster.deathmask.net (names instead of IPs)

------------------------------------------------------------------------
r4527 | tomaz | 2004-09-18 14:25:11 -0700 (Sat, 18 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

339

------------------------------------------------------------------------
r4526 | havoc | 2004-09-18 13:46:33 -0700 (Sat, 18 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

340

------------------------------------------------------------------------
r4525 | tomaz | 2004-09-18 10:53:08 -0700 (Sat, 18 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

341

------------------------------------------------------------------------
r4524 | havoc | 2004-09-18 10:48:12 -0700 (Sat, 18 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

343 (+1 -2)

------------------------------------------------------------------------
r4523 | havoc | 2004-09-18 10:44:12 -0700 (Sat, 18 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cvar.c

revert to saving normal cvar commands instead of seta, for compatibility with other quake engines

------------------------------------------------------------------------
r4522 | tomaz | 2004-09-18 10:30:55 -0700 (Sat, 18 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/menu.h

Added confirm question to "Reset to Defaults" option.

------------------------------------------------------------------------
r4521 | tomaz | 2004-09-17 15:16:58 -0700 (Fri, 17 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

344

------------------------------------------------------------------------
r4520 | tomaz | 2004-09-17 15:16:00 -0700 (Fri, 17 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

Fixed a missing \n

------------------------------------------------------------------------
r4519 | tomaz | 2004-09-17 15:00:45 -0700 (Fri, 17 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

344

------------------------------------------------------------------------
r4518 | tomaz | 2004-09-17 14:56:13 -0700 (Fri, 17 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h

Renamed mod_brush to mod_brushq1.

------------------------------------------------------------------------
r4517 | tomaz | 2004-09-17 14:53:11 -0700 (Fri, 17 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

344

------------------------------------------------------------------------
r4516 | tomaz | 2004-09-17 14:51:20 -0700 (Fri, 17 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/model_shared.c

Clears stainmaps on map restart/change based on cl_stainmapsclearonload cvar. Also added to effects menu.

------------------------------------------------------------------------
r4515 | havoc | 2004-09-17 14:27:58 -0700 (Fri, 17 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

344

------------------------------------------------------------------------
r4514 | havoc | 2004-09-17 14:25:04 -0700 (Fri, 17 Sep 2004) | 4 lines
Changed paths:
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/cvar.c
   M /trunk/darkplaces/cvar.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/menu.h
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/prvm_cmds.c

added set (create/set a cvar) and seta (create/set a saved cvar) commands, now config saving uses seta, and this allows mods to add their own cvars in default.cfg easily
cleaned up some of the command/cvar startup sequence, the menu commands and cvars were being registered AFTER config loading and video init, now they're registered before like they should be
cleaned up some cvar code and added developer printing of the more important cvar calls

------------------------------------------------------------------------
r4513 | havoc | 2004-09-17 14:19:13 -0700 (Fri, 17 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

missing \n on one dprint in ValidateState

------------------------------------------------------------------------
r4512 | black | 2004-09-17 11:41:51 -0700 (Fri, 17 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

Fixed str_cvar.

------------------------------------------------------------------------
r4511 | havoc | 2004-09-16 18:13:06 -0700 (Thu, 16 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c

another round angles to int bug (this time in PF_vectoyaw)

------------------------------------------------------------------------
r4510 | havoc | 2004-09-16 18:03:03 -0700 (Thu, 16 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c

fix stupid quake precision problem with PF_vectoangles (it rounded pitch to integer!)

------------------------------------------------------------------------
r4509 | havoc | 2004-09-16 17:33:05 -0700 (Thu, 16 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c

use double precision for coord and angle conversions...  might help with jerky camera in some mods?

------------------------------------------------------------------------
r4508 | havoc | 2004-09-16 17:32:25 -0700 (Thu, 16 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/protocol.c

fix parser bug that read scale into alpha in PROTOCOL_DARKPLACES5

------------------------------------------------------------------------
r4507 | havoc | 2004-09-16 13:41:06 -0700 (Thu, 16 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r4506 | havoc | 2004-09-16 13:20:40 -0700 (Thu, 16 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

344

------------------------------------------------------------------------
r4505 | havoc | 2004-09-16 13:00:11 -0700 (Thu, 16 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

optimized Mod_BuildBumpVectors slightly

------------------------------------------------------------------------
r4504 | molivier | 2004-09-15 09:06:51 -0700 (Wed, 15 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.dev

Fixed project file for Dev-C++, from Kazashi

------------------------------------------------------------------------
r4501 | havoc | 2004-09-14 16:03:30 -0700 (Tue, 14 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c

fix up another quoted commandline issue (this one being in commandline reconstruction for the cmdline cvar, not used for anything important)

------------------------------------------------------------------------
r4500 | havoc | 2004-09-14 15:57:23 -0700 (Tue, 14 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

fixed totally mixed up vis culling (as a result of botched bmodel vis handling - oops)

------------------------------------------------------------------------
r4499 | havoc | 2004-09-14 15:41:10 -0700 (Tue, 14 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cgamevm.c
   M /trunk/darkplaces/cl_demo.c
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_user.c
   M /trunk/darkplaces/view.c

PROTOCOL_DARKPLACES5

------------------------------------------------------------------------
r4498 | havoc | 2004-09-14 15:15:19 -0700 (Tue, 14 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

344 - minor things

------------------------------------------------------------------------
r4496 | molivier | 2004-09-13 23:19:00 -0700 (Mon, 13 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/lhnet.c

socklen_t is "int" in the Winsocks API

------------------------------------------------------------------------
r4495 | havoc | 2004-09-13 18:36:23 -0700 (Mon, 13 Sep 2004) | 4 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

now saves r_shadow cvars that are available in the graphics options menu
separated R_Shadow_NewWorldLight into R_Shadow_NewWorldLight to allocate light and R_Shadow_UpdateWorldLight to assign properties, so that lights can be updated in place rather than reallocating them (mainly saves on hassles with r_debuglight testing while editing lights, which were being renumbered by every edit)
R_Shadow_UpdateWorldLight now tolerates radius 0, color 0 0 0, and snaps angles to the 0-360 range

------------------------------------------------------------------------
r4493 | havoc | 2004-09-13 14:39:27 -0700 (Mon, 13 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

341 - some hud items added

------------------------------------------------------------------------
r4491 | tomaz | 2004-09-12 15:20:43 -0700 (Sun, 12 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

337

------------------------------------------------------------------------
r4490 | tomaz | 2004-09-12 11:11:24 -0700 (Sun, 12 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/keys.h
   M /trunk/darkplaces/vid_wgl.c

Added support for 16 joystick buttons.

------------------------------------------------------------------------
r4489 | tomaz | 2004-09-12 10:04:31 -0700 (Sun, 12 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/client.h

Merged CL_RocketTrail2 into CL_RocketTrail.

------------------------------------------------------------------------
r4488 | tomaz | 2004-09-12 09:18:06 -0700 (Sun, 12 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

Fixed positioning of light editing display, it's was not following the console properly.

------------------------------------------------------------------------
r4487 | tomaz | 2004-09-12 09:16:12 -0700 (Sun, 12 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

Made cl_beams_relative only affect view-attached beams.

------------------------------------------------------------------------
r4486 | tomaz | 2004-09-11 15:02:50 -0700 (Sat, 11 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

343

------------------------------------------------------------------------
r4485 | tomaz | 2004-09-11 15:02:20 -0700 (Sat, 11 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c

Added vid_vsync cvar and also to put it in the video options menu.

------------------------------------------------------------------------
r4478 | tomaz | 2004-09-11 11:31:37 -0700 (Sat, 11 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cmd.c

Fixed a bug in the commandline parser when giving it more than one + command.

------------------------------------------------------------------------
r4477 | tomaz | 2004-09-11 11:11:33 -0700 (Sat, 11 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

Fixed a crash in R_EditLights_PasteInfo_f.

------------------------------------------------------------------------
r4474 | havoc | 2004-09-11 08:31:23 -0700 (Sat, 11 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cmd.c

rewrote Cmd_StuffCmds_f (commandline parser), it now properly handles quoted strings, + and - inside a word, and numbers beginning with + or -

------------------------------------------------------------------------
r4473 | havoc | 2004-09-10 17:57:59 -0700 (Fri, 10 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_demo.c

apparently M_ToggleMenu_f is not what to call...  Call_MR_ToggleMenu_f is

------------------------------------------------------------------------
r4472 | havoc | 2004-09-10 17:54:00 -0700 (Fri, 10 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_demo.c

fix undefined function warning

------------------------------------------------------------------------
r4471 | havoc | 2004-09-10 17:47:20 -0700 (Fri, 10 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_demo.c

make CL_NextDemo put up menu if there's no demo to play (this makes startdemos command put up menu if there are no demos, better than staring at console)

------------------------------------------------------------------------
r4470 | havoc | 2004-09-10 17:46:26 -0700 (Fri, 10 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

fix very unreliable jumping (it was doing a stepdown back onto the floor instantly if framerate was too high or slowmo too low)

------------------------------------------------------------------------
r4469 | havoc | 2004-09-10 17:45:46 -0700 (Fri, 10 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/sys_win.c

another attempt to fix quoted strings in windows commandline, but more so a cleanup

------------------------------------------------------------------------
r4468 | tomaz | 2004-09-10 17:42:41 -0700 (Fri, 10 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

345

------------------------------------------------------------------------
r4466 | havoc | 2004-09-10 11:20:06 -0700 (Fri, 10 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/sys_win.c

fixed unterminated character constant in my last fix

------------------------------------------------------------------------
r4465 | havoc | 2004-09-10 11:19:05 -0700 (Fri, 10 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/sys_win.c

fix quoted string parsing

------------------------------------------------------------------------
r4464 | havoc | 2004-09-09 12:20:30 -0700 (Thu, 09 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/lhnet.c

socklen_t is missing on windows...  use size_t there, I hope this is right (winxp64 testing needed)

------------------------------------------------------------------------
r4458 | havoc | 2004-09-09 04:21:44 -0700 (Thu, 09 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

two bugs... back to 350

------------------------------------------------------------------------
r4457 | tomaz | 2004-09-08 23:12:00 -0700 (Wed, 08 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

347

------------------------------------------------------------------------
r4452 | tomaz | 2004-09-07 23:03:41 -0700 (Tue, 07 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

350 !!!

------------------------------------------------------------------------
r4451 | tomaz | 2004-09-07 16:30:36 -0700 (Tue, 07 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

351

------------------------------------------------------------------------
r4450 | tomaz | 2004-09-07 16:03:09 -0700 (Tue, 07 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

352

------------------------------------------------------------------------
r4447 | tomaz | 2004-09-07 11:23:35 -0700 (Tue, 07 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

356

------------------------------------------------------------------------
r4446 | tomaz | 2004-09-07 11:19:35 -0700 (Tue, 07 Sep 2004) | 3 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

Added r_editlights_copyinfo and r_editlights_pasteinfo commands to clone the properties of a light, all except for origin.
Also added a check for r_editlights.integer in R_Shadow_EditLights_EditAll_f to avoid to spam the console with warnings.

------------------------------------------------------------------------
r4445 | tomaz | 2004-09-07 10:48:04 -0700 (Tue, 07 Sep 2004) | 3 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c

Reverting the DP_MOVETYPEWALK_NONCLIENTS commit.
How about if we actually remove todo items that are already done?

------------------------------------------------------------------------
r4444 | tomaz | 2004-09-07 10:42:57 -0700 (Tue, 07 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c

Added an extension to indicate that MOVETYPE_WALK works on non-clients.

------------------------------------------------------------------------
r4443 | havoc | 2004-09-07 10:13:58 -0700 (Tue, 07 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/lhnet.c

fixed STANDALONETEST so it works again

------------------------------------------------------------------------
r4442 | tomaz | 2004-09-07 10:00:44 -0700 (Tue, 07 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

Made hl map loading halve the lightmap samples, to fit hl's 0-1 range into quake's 0-2 range.

------------------------------------------------------------------------
r4441 | tomaz | 2004-09-06 14:19:36 -0700 (Mon, 06 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

358

------------------------------------------------------------------------
r4440 | black | 2004-09-06 03:36:28 -0700 (Mon, 06 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/prvm_cmds.c

Fixed fgets (before it has been ignoring the line that contained the EOF char).

------------------------------------------------------------------------
r4439 | black | 2004-09-06 01:06:40 -0700 (Mon, 06 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/sys_sdl.c

Adding Sys_GetClipboardData to the SDL driver.

------------------------------------------------------------------------
r4438 | tomaz | 2004-09-05 04:25:21 -0700 (Sun, 05 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

359

------------------------------------------------------------------------
r4437 | tomaz | 2004-09-05 04:18:49 -0700 (Sun, 05 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/sbar.c
   M /trunk/darkplaces/sbar.h

Added two cvars (sbar_alpha_bg and sbar_alpha_fg) to replace sbar_alpha, one controls background as 0-1, and one controls everything else as 0-1

------------------------------------------------------------------------
r4436 | tomaz | 2004-09-04 20:32:21 -0700 (Sat, 04 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

360

------------------------------------------------------------------------
r4435 | havoc | 2004-09-04 07:29:52 -0700 (Sat, 04 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

363 - added an item about replacing sbar_alpha with two cvars

------------------------------------------------------------------------
r4434 | havoc | 2004-09-04 06:16:00 -0700 (Sat, 04 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/collision.c

more tolerance to deviations in calculated plane distances compared to the stored planes

------------------------------------------------------------------------
r4433 | tomaz | 2004-09-04 02:58:27 -0700 (Sat, 04 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

362

------------------------------------------------------------------------
r4432 | havoc | 2004-09-04 02:52:39 -0700 (Sat, 04 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

363 after some cleaning

------------------------------------------------------------------------
r4431 | molivier | 2004-09-03 08:19:18 -0700 (Fri, 03 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

Dpmaster has address mapping now

------------------------------------------------------------------------
r4430 | havoc | 2004-09-03 07:21:31 -0700 (Fri, 03 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

365

------------------------------------------------------------------------
r4429 | havoc | 2004-09-03 07:14:44 -0700 (Fri, 03 Sep 2004) | 6 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_alias.h
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/render.h

zym models are now loaded into the same structs as alias models in memory, this reduces code a lot and gives the full feature set (rtlights/skins)
zym models are now optimized when loading to eliminate duplicate vertex data (one of their more significant design flaws)
mdl/md2/md3 models no longer have stored svector/tvector/normal arrays, instead generating them on demand like skeletal models (this is slower but saves a *lot* of memory)
zym collisions are not implemented (yet)
zym bones are not reported as tags (yet)

------------------------------------------------------------------------
r4428 | havoc | 2004-09-03 04:03:47 -0700 (Fri, 03 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

converted portal building over to use polygon functions instead of winding

------------------------------------------------------------------------
r4427 | havoc | 2004-09-03 04:02:28 -0700 (Fri, 03 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fixed r_drawportals - the meshqueue was not begun yet

------------------------------------------------------------------------
r4426 | havoc | 2004-09-03 03:32:29 -0700 (Fri, 03 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/collision.c

fixed bugs with collision brush building, and added a great deal more error checking on them

------------------------------------------------------------------------
r4425 | havoc | 2004-09-02 23:26:27 -0700 (Thu, 02 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_ogg.c

added -novorbis commandline option to allow disabling ogg vorbis support even if the library is present

------------------------------------------------------------------------
r4424 | havoc | 2004-09-02 19:36:56 -0700 (Thu, 02 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

use main varray_vertex3f2 array (forgot this in previous commit)

------------------------------------------------------------------------
r4423 | havoc | 2004-09-02 19:24:30 -0700 (Thu, 02 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h

added varray_svector3f, varray_tvector3f, and varray_normal3f arrays

------------------------------------------------------------------------
r4422 | havoc | 2004-09-02 18:40:43 -0700 (Thu, 02 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/menu.c

added cl_particles_explosions_bubbles/sparks/smoke/shell cvars, got rid of cl_explosions cvar (it is equivilant to the shell cvar) and updated menu

------------------------------------------------------------------------
r4421 | havoc | 2004-09-02 18:39:42 -0700 (Thu, 02 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

fixed number of displayed scores in the minideathmatchoverlay in GAME_TRANSFUSION

------------------------------------------------------------------------
r4419 | havoc | 2004-09-02 06:46:30 -0700 (Thu, 02 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.rc
   M /trunk/darkplaces/makefile.inc

now uses de-we's darkplaces icon in mingw builds, and has proper file info on the exe's properties dialog

------------------------------------------------------------------------
r4418 | havoc | 2004-09-02 06:16:31 -0700 (Thu, 02 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

being glued to the floor while swimming = bad

------------------------------------------------------------------------
r4417 | havoc | 2004-09-01 01:05:05 -0700 (Wed, 01 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/dpmod/qc/dpextensions.qc

added DP_QC_FINDFLAGS and DP_QC_FINDCHAINFLAGS extensions

------------------------------------------------------------------------
r4416 | havoc | 2004-09-01 00:38:54 -0700 (Wed, 01 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

368

------------------------------------------------------------------------
r4415 | havoc | 2004-09-01 00:37:36 -0700 (Wed, 01 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

cl.viewzoomold/new are now reset in CL_ClearState

------------------------------------------------------------------------
r4414 | havoc | 2004-09-01 00:02:44 -0700 (Wed, 01 Sep 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/menu.c

GAME_NETHERWORLD patch: a bunch of cvars and some menu changes

------------------------------------------------------------------------
r4413 | havoc | 2004-08-31 02:13:47 -0700 (Tue, 31 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

368

------------------------------------------------------------------------
r4412 | havoc | 2004-08-31 01:29:47 -0700 (Tue, 31 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

367 (+3 todo items)

------------------------------------------------------------------------
r4410 | havoc | 2004-08-30 09:08:05 -0700 (Mon, 30 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

364

------------------------------------------------------------------------
r4409 | tomaz | 2004-08-30 07:48:27 -0700 (Mon, 30 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

365

------------------------------------------------------------------------
r4408 | tomaz | 2004-08-30 07:47:35 -0700 (Mon, 30 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/curves.c
   M /trunk/darkplaces/curves.h
   M /trunk/darkplaces/model_brush.c

Renamed QuadraticSpline code in curves.c to QuadraticBSpline.

------------------------------------------------------------------------
r4407 | molivier | 2004-08-30 05:03:31 -0700 (Mon, 30 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

Fixed the loading of ".skin" files (the skin numbers were reversed)

------------------------------------------------------------------------
r4406 | molivier | 2004-08-30 05:01:48 -0700 (Mon, 30 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.h

Removed an unused define, and renamed another one

------------------------------------------------------------------------
r4405 | molivier | 2004-08-30 04:59:52 -0700 (Mon, 30 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/lhfont.h
   M /trunk/darkplaces/polygon.c

Fixed a couple of warnings

------------------------------------------------------------------------
r4404 | havoc | 2004-08-30 02:27:10 -0700 (Mon, 30 Aug 2004) | 3 lines
Changed paths:
   M /trunk/darkplaces/polygon.c

fixed severe bugs in QuadForPlane (broken axis selection and use of the wrong planenormal components in some math)
modified Divide to not rotate the point list, this is a minor un-optimization of the algorithm but should improve consistency (unclipped polygons come out the same as they went in)

------------------------------------------------------------------------
r4403 | havoc | 2004-08-30 02:12:13 -0700 (Mon, 30 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/meshqueue.c

fix crash when transparent meshes were used in first frame rendered

------------------------------------------------------------------------
r4402 | havoc | 2004-08-30 02:11:35 -0700 (Mon, 30 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/collision.h

collision.h doesn't need winding.h anymore

------------------------------------------------------------------------
r4401 | havoc | 2004-08-30 02:10:43 -0700 (Mon, 30 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/curves.c

more documentation on B-Splines

------------------------------------------------------------------------
r4400 | havoc | 2004-08-30 02:09:57 -0700 (Mon, 30 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

make sure particles are reset on level change by clearing the array

------------------------------------------------------------------------
r4399 | havoc | 2004-08-29 02:08:44 -0700 (Sun, 29 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

367 and all unfinished todo items labeled by category

------------------------------------------------------------------------
r4398 | havoc | 2004-08-28 15:37:53 -0700 (Sat, 28 Aug 2004) | 2 lines
Changed paths:
   D /trunk/darkplaces/sv_user.qc

how'd this get here?

------------------------------------------------------------------------
r4396 | havoc | 2004-08-27 15:21:07 -0700 (Fri, 27 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

367

------------------------------------------------------------------------
r4395 | havoc | 2004-08-27 02:53:18 -0700 (Fri, 27 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h

added GAME_NETHERWORLD

------------------------------------------------------------------------
r4394 | havoc | 2004-08-27 02:07:22 -0700 (Fri, 27 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

368

------------------------------------------------------------------------
r4392 | havoc | 2004-08-27 01:42:18 -0700 (Fri, 27 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

369

------------------------------------------------------------------------
r4391 | havoc | 2004-08-26 14:08:38 -0700 (Thu, 26 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt

modified Tomaz credits

------------------------------------------------------------------------
r4390 | tomaz | 2004-08-26 01:43:02 -0700 (Thu, 26 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

369

------------------------------------------------------------------------
r4389 | havoc | 2004-08-26 00:43:22 -0700 (Thu, 26 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

370

------------------------------------------------------------------------
r4388 | havoc | 2004-08-25 20:10:32 -0700 (Wed, 25 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c

fixed te_explosion2 prototype in comment to include colorlength (as it already does in dpextensions.qc)

------------------------------------------------------------------------
r4387 | havoc | 2004-08-25 16:57:46 -0700 (Wed, 25 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

md3 skin loading for player models which have no shader names works

------------------------------------------------------------------------
r4386 | havoc | 2004-08-25 16:56:24 -0700 (Wed, 25 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

thanks to Jeff Ford (qbism) for this fix to md3 player model loading, the base skin now works

------------------------------------------------------------------------
r4385 | tomaz | 2004-08-25 16:05:25 -0700 (Wed, 25 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/menu.c

Added Tei's "whack" that adds a drop down shadow on all text. r_textshadow 1 to enable.

------------------------------------------------------------------------
r4384 | havoc | 2004-08-25 13:31:17 -0700 (Wed, 25 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/collision.c
   M /trunk/darkplaces/collision.h
   M /trunk/darkplaces/darkplaces.dev
   M /trunk/darkplaces/darkplaces.dsp
   M /trunk/darkplaces/makefile.inc
   M /trunk/darkplaces/model_brush.c
   A /trunk/darkplaces/polygon.c
   A /trunk/darkplaces/polygon.h

changed Collision_NewBrushFromPlanes to use new polygon.c code, this got rid of the winding allocations and moved everything onto the stack, a little cleaner (and the new polygon.c code is faster than winding.c)

------------------------------------------------------------------------
r4383 | tomaz | 2004-08-25 10:00:28 -0700 (Wed, 25 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

3371 items left.

------------------------------------------------------------------------
r4382 | tomaz | 2004-08-25 03:46:18 -0700 (Wed, 25 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

373 items left.

------------------------------------------------------------------------
r4381 | havoc | 2004-08-25 02:42:31 -0700 (Wed, 25 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

3 notifies done

------------------------------------------------------------------------
r4380 | havoc | 2004-08-25 02:33:19 -0700 (Wed, 25 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

a few more things done

------------------------------------------------------------------------
r4379 | havoc | 2004-08-25 02:32:06 -0700 (Wed, 25 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

implemented loading of particles/particlefont.tga and particles/nexbeam.tga

------------------------------------------------------------------------
r4378 | havoc | 2004-08-25 01:55:00 -0700 (Wed, 25 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fixed a couple potential crashes due to nodestack overflow, as suggested by Vic

------------------------------------------------------------------------
r4377 | havoc | 2004-08-25 01:50:52 -0700 (Wed, 25 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cgamevm.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/meshqueue.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/snd_dma.c
   M /trunk/darkplaces/snd_ogg.c
   M /trunk/darkplaces/snd_wav.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/ui.c
   M /trunk/darkplaces/wad.c
   M /trunk/darkplaces/zone.c
   M /trunk/darkplaces/zone.h

Mem_AllocPool flags and parent parameters added, now there can be multiple temporary mempools by using the POOLFLAG_TEMP option, and removed Mem_AllocNestedPool

------------------------------------------------------------------------
r4376 | havoc | 2004-08-25 01:08:00 -0700 (Wed, 25 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

+5 notify, +1 done, -6 todo, +3 todo

------------------------------------------------------------------------
r4375 | tomaz | 2004-08-24 23:51:57 -0700 (Tue, 24 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

376 items left.

------------------------------------------------------------------------
r4374 | tomaz | 2004-08-24 23:48:04 -0700 (Tue, 24 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

Slightly tweaked CL_ParticleExplosion2 by VorteX.

------------------------------------------------------------------------
r4373 | havoc | 2004-08-24 23:11:21 -0700 (Tue, 24 Aug 2004) | 4 lines
Changed paths:
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/view.c

cleaned up all standing in a sloped corner and getting hurt glitches by adding an SV_SetOnGround function which is called in SV_WalkMove in the right places (incase SV_FlyMove does not set it), which also fixed stair stepup smoothing (it needs FL_ONGROUND to not be flipping on and off during a step up)
added stair stepdown (instead of going flying off stairs)
added stair stepdown smoothing

------------------------------------------------------------------------
r4372 | havoc | 2004-08-24 19:07:48 -0700 (Tue, 24 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_particles.c

slightly changed color of iceblast in prydon

------------------------------------------------------------------------
r4371 | havoc | 2004-08-24 15:43:17 -0700 (Tue, 24 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

one new todo 3 item, one other 3 done

------------------------------------------------------------------------
r4370 | tomaz | 2004-08-24 11:18:17 -0700 (Tue, 24 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

Still 378 items.

------------------------------------------------------------------------
r4369 | tomaz | 2004-08-24 11:17:31 -0700 (Tue, 24 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_particles.c

Tried to make the vore spike trail to be blue under GAME_PRYDON mode. Failed and somehow made it white instead.

------------------------------------------------------------------------
r4368 | tomaz | 2004-08-24 11:09:03 -0700 (Tue, 24 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/darkplaces.txt

Added GAME_PRYDON.

------------------------------------------------------------------------
r4367 | tomaz | 2004-08-24 09:54:57 -0700 (Tue, 24 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

Somehow the svector bug which was d was readded as -d. Fixed that. 378 items left.

------------------------------------------------------------------------
r4366 | havoc | 2004-08-23 19:10:46 -0700 (Mon, 23 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

notified sublim3 of 4 items, categorized more items, added 2 or 3 items

------------------------------------------------------------------------
r4365 | havoc | 2004-08-23 01:20:45 -0700 (Mon, 23 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

broke rtlights, oops  (shadowtest was reversed)

------------------------------------------------------------------------
r4364 | havoc | 2004-08-23 00:25:34 -0700 (Mon, 23 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/glquake.h

missed a uint that should be GLuint

------------------------------------------------------------------------
r4363 | havoc | 2004-08-22 22:35:22 -0700 (Sun, 22 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/vid_shared.c

added GL_ARB_shader_objects, GL_ARB_shading_language_100, GL_ARB_vertex_shader, GL_ARB_fragment_shader extensions (not used for anything yet)

------------------------------------------------------------------------
r4362 | havoc | 2004-08-22 22:34:04 -0700 (Sun, 22 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/view.c

now only does stair smoothing when onground (thanks to Sajt for noticing this bug)

------------------------------------------------------------------------
r4361 | havoc | 2004-08-22 19:10:27 -0700 (Sun, 22 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h

merged R_Shadow_Stage_LightWithShadows and R_Shadow_Stage_LightWithoutShadows to make a R_Shadow_Stage_Light which takes a shadowtest parameter, just a bit of code reduction

------------------------------------------------------------------------
r4360 | tomaz | 2004-08-22 10:15:39 -0700 (Sun, 22 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

380 items left.

------------------------------------------------------------------------
r4359 | tomaz | 2004-08-22 09:20:33 -0700 (Sun, 22 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

Added sv_maxrate cvar to server setup menu.

------------------------------------------------------------------------
r4358 | tomaz | 2004-08-22 08:37:58 -0700 (Sun, 22 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

Made ValidateState warn and not error out about colormap > maxclients.

------------------------------------------------------------------------
r4357 | tomaz | 2004-08-22 04:45:41 -0700 (Sun, 22 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

383 items left.

------------------------------------------------------------------------
r4356 | tomaz | 2004-08-22 04:37:47 -0700 (Sun, 22 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_sprite.c

Made gl_picmip affect only maps, models, and sprites by setting their TEXF_PICMIP flag.

------------------------------------------------------------------------
r4355 | tomaz | 2004-08-22 04:12:04 -0700 (Sun, 22 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

Changed 360. to 360.0

------------------------------------------------------------------------
r4354 | tomaz | 2004-08-21 18:58:50 -0700 (Sat, 21 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

384 items left.

------------------------------------------------------------------------
r4353 | tomaz | 2004-08-21 18:58:08 -0700 (Sat, 21 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_textures.h

Added TEXF_PICMIP to the list of TEXF_ flags.

------------------------------------------------------------------------
r4352 | tomaz | 2004-08-21 18:30:48 -0700 (Sat, 21 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_exec.c

Made qc profile command post an error message instead of crashing when used during demo playback.

------------------------------------------------------------------------
r4351 | tomaz | 2004-08-21 18:08:47 -0700 (Sat, 21 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

385 items left.

------------------------------------------------------------------------
r4350 | havoc | 2004-08-21 15:27:41 -0700 (Sat, 21 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

notified Todd about 3 items being done

------------------------------------------------------------------------
r4349 | tomaz | 2004-08-21 09:45:15 -0700 (Sat, 21 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

389 items.

------------------------------------------------------------------------
r4348 | tomaz | 2004-08-21 09:43:41 -0700 (Sat, 21 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/sys_linux.c
   M /trunk/darkplaces/sys_sdl.c
   M /trunk/darkplaces/sys_win.c

Made Sys_Error print the error message to the console / logfile.

------------------------------------------------------------------------
r4347 | tomaz | 2004-08-21 09:42:10 -0700 (Sat, 21 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.h
   M /trunk/darkplaces/host.c

Close logfile at shutdown.

------------------------------------------------------------------------
r4346 | havoc | 2004-08-20 16:57:43 -0700 (Fri, 20 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

finished labeling categories of 0 difficulty items

------------------------------------------------------------------------
r4345 | tomaz | 2004-08-20 13:54:40 -0700 (Fri, 20 Aug 2004) | 2 lines
Changed paths:
   A /trunk/darkplaces/lhfont.h

Forgot this when doing the embedded conchar commit

------------------------------------------------------------------------
r4344 | tomaz | 2004-08-20 13:53:11 -0700 (Fri, 20 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

down to 393

------------------------------------------------------------------------
r4343 | tomaz | 2004-08-20 13:50:39 -0700 (Fri, 20 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c

embedded a fallback conchars.tga so it can load in an empty directory with a visible console (used to use the checkerboard texture)

------------------------------------------------------------------------
r4342 | tomaz | 2004-08-20 13:49:18 -0700 (Fri, 20 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt

Added de-we to the credits

------------------------------------------------------------------------
r4341 | havoc | 2004-08-19 23:58:23 -0700 (Thu, 19 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

went through most of todo and cleaned things up, not finished labeling them by category yet, but todo is now down to 402 items

------------------------------------------------------------------------
r4340 | tomaz | 2004-08-19 17:00:18 -0700 (Thu, 19 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/keys.c

Enabled tested and verified that the clipboard paste works in the console (Win32 only)

------------------------------------------------------------------------
r4339 | tomaz | 2004-08-19 05:34:15 -0700 (Thu, 19 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r4338 | tomaz | 2004-08-18 17:09:30 -0700 (Wed, 18 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r4337 | tomaz | 2004-08-18 15:23:01 -0700 (Wed, 18 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r4336 | tomaz | 2004-08-18 15:22:29 -0700 (Wed, 18 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c

Fixed collision: client getting fraction out of bounds errors when in a map the client does not have

------------------------------------------------------------------------
r4335 | tomaz | 2004-08-17 15:52:14 -0700 (Tue, 17 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r4334 | tomaz | 2004-08-17 15:50:53 -0700 (Tue, 17 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_light.c

Added lightstyle interpolation.

------------------------------------------------------------------------
r4333 | havoc | 2004-08-16 16:51:06 -0700 (Mon, 16 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/model_shared.c

fixed normalmap handling (my vectors were backwards), and corrected normalmap generator accordingly

------------------------------------------------------------------------
r4331 | havoc | 2004-08-12 16:31:48 -0700 (Thu, 12 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

now checks tangent vector crossproduct against surface normal to see if the tangents came out backwards and flips them if so, this fixed all the nasty bumpmapping problems

------------------------------------------------------------------------
r4330 | havoc | 2004-08-11 10:25:58 -0700 (Wed, 11 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_dma.c

fixed sound problems (I had totally messed up the panning calcs, oops)

------------------------------------------------------------------------
r4329 | havoc | 2004-08-09 19:12:41 -0700 (Mon, 09 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/snd_dma.c
   M /trunk/darkplaces/snd_null.c
   M /trunk/darkplaces/sound.h

converted S_Update to take a matrix, and internal snd_dma functions to use that matrix where applicable (only spatialization)

------------------------------------------------------------------------
r4328 | havoc | 2004-08-09 19:10:12 -0700 (Mon, 09 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/matrixlib.c
   M /trunk/darkplaces/matrixlib.h

added identitymatrix const struct which can be used wherever

------------------------------------------------------------------------
r4327 | havoc | 2004-08-09 14:35:53 -0700 (Mon, 09 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

fix unused variable k warning

------------------------------------------------------------------------
r4326 | havoc | 2004-08-09 14:29:47 -0700 (Mon, 09 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

don't show editlights cursor position when not in editlights mode

------------------------------------------------------------------------
r4325 | havoc | 2004-08-09 06:07:37 -0700 (Mon, 09 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

now shows cursor location in editlights mode

------------------------------------------------------------------------
r4324 | havoc | 2004-08-09 05:59:31 -0700 (Mon, 09 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

rocket glow is now more orange, less pale

------------------------------------------------------------------------
r4323 | havoc | 2004-08-09 03:12:49 -0700 (Mon, 09 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r4322 | havoc | 2004-08-08 15:55:57 -0700 (Sun, 08 Aug 2004) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

redesigned rocket explosion effect, now a simple spray of small sparks, nothing else
added pt_ember (a spark particle which leaves a trail of sparks), not used though (was used experimentally) and edited CL_MoveParticles a little bit to make it possible to spawn particles during the particle update loop

------------------------------------------------------------------------
r4321 | havoc | 2004-08-08 15:52:55 -0700 (Sun, 08 Aug 2004) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c

changed rocket explosion color to be more redish orange
changed rocket trail color to be more redish orange
doubled brightness of modelflags lights (they weren't very noticable)

------------------------------------------------------------------------
r4320 | tomaz | 2004-08-08 15:52:45 -0700 (Sun, 08 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r4316 | tomaz | 2004-08-08 14:51:58 -0700 (Sun, 08 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r4315 | tomaz | 2004-08-08 14:49:43 -0700 (Sun, 08 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

made TE_EXPLOSION2 use a spherical spawn pattern rather than cube shape

------------------------------------------------------------------------
r4314 | tomaz | 2004-08-08 14:26:23 -0700 (Sun, 08 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r4313 | tomaz | 2004-08-08 14:07:19 -0700 (Sun, 08 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r4312 | tomaz | 2004-08-08 14:04:51 -0700 (Sun, 08 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/dpmod/qc/dpextensions.qc

Fixed the missing colorlength param on te_explosion2

------------------------------------------------------------------------
r4311 | havoc | 2004-08-08 13:17:16 -0700 (Sun, 08 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r4310 | tomaz | 2004-08-08 13:06:59 -0700 (Sun, 08 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r4309 | black | 2004-08-07 16:21:54 -0700 (Sat, 07 Aug 2004) | 3 lines
Changed paths:
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/prvm_cmds.c

-Fixed a bad bugfix in the menu router.
-Added read-only support for files outside of data/ to the new vm.

------------------------------------------------------------------------
r4308 | havoc | 2004-08-07 08:52:21 -0700 (Sat, 07 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

effect dlights weren't casting shadows (oops)

------------------------------------------------------------------------
r4307 | havoc | 2004-08-07 08:51:42 -0700 (Sat, 07 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

fixed r_showtris

------------------------------------------------------------------------
r4306 | molivier | 2004-08-07 06:08:55 -0700 (Sat, 07 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_mem.c

Improved sound resampling. It can handle sounds up to 96KHz stereo at a constant precision, even if they're very long, since the algorithm now works second by second.

------------------------------------------------------------------------
r4305 | havoc | 2004-08-06 06:06:07 -0700 (Fri, 06 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_draw.c

rearranged SCR_UpdateScreen, now puts 2D graphics in the two views in r_stereo_sidebyside mode (but not in any other mode), and 2D graphics are rendered into both color planes with the anaglyph modes

------------------------------------------------------------------------
r4301 | havoc | 2004-08-06 01:01:37 -0700 (Fri, 06 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c

added DP_QC_MULTIPLETEMPSTRINGS extension (thanks to fuh for pointing out I should make this detectable to the QC)

------------------------------------------------------------------------
r4299 | havoc | 2004-08-05 06:50:38 -0700 (Thu, 05 Aug 2004) | 5 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_shadow.c

this patch adds a number of stereo viewing modes (shutter glasses and video glasses not supported yet)
added r_stereo_redblue and r_stereo_redgreen and r_stereo_redcyan (anaglyph 3d glasses)
added r_stereo_sidebyside (no glasses, recommend using the smallest viewsize to get them lined up with your eyes, then stare straight ahead...  warning: eye strain)
added r_stereo_separation (sets how far apart the eyes are in the world, default is 4 units, technically this should be 1.33, about 2 inches, but the quake player is a midget compared to the world...  so that doesn't look right)

------------------------------------------------------------------------
r4297 | black | 2004-08-03 01:39:50 -0700 (Tue, 03 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_dma.c

Changed S_LocalSound to play multiple sounds at a time.

------------------------------------------------------------------------
r4296 | tomaz | 2004-08-02 11:00:26 -0700 (Mon, 02 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/sys.h
   M /trunk/darkplaces/sys_linux.c
   M /trunk/darkplaces/sys_win.c

Added CTRL+V paste into the console for win32 users.

------------------------------------------------------------------------
r4295 | molivier | 2004-08-02 07:18:46 -0700 (Mon, 02 Aug 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h

Put all gamemode information (name, game dir, ...) into an array to ease maintenance.

------------------------------------------------------------------------
r4290 | havoc | 2004-07-27 02:18:10 -0700 (Tue, 27 Jul 2004) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

removed particle compacting stage, this fixed all 'disappearing decals' problems, and caused a slight redesign to support dead particles in the array (now classified as pt_dead)
removed pressure particle support (since the freeparticle array it reused is gone now), pressure property still exists but is unused
added friction to a few more particle effects

------------------------------------------------------------------------
r4289 | havoc | 2004-07-25 23:11:23 -0700 (Sun, 25 Jul 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/menu.c

removed gl_delayfinish cvar as it's now a speed loss with gl_finish 0

------------------------------------------------------------------------
r4288 | havoc | 2004-07-25 23:09:26 -0700 (Sun, 25 Jul 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c

added gl_finish cvar, defaults to 0, this was a noticable speed gain (22.5% on timedemo demo1 if not fillrate limited)

------------------------------------------------------------------------
r4287 | tomaz | 2004-07-23 03:29:52 -0700 (Fri, 23 Jul 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r4286 | tomaz | 2004-07-23 03:01:08 -0700 (Fri, 23 Jul 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r4284 | molivier | 2004-07-22 06:35:24 -0700 (Thu, 22 Jul 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/todo

Added 3 new QuakeC extensions: DP_SND_DIRECTIONLESSATTNNONE, DP_SND_OGGVORBIS and DP_SND_STEREOWAV

------------------------------------------------------------------------
r4283 | molivier | 2004-07-22 04:05:34 -0700 (Thu, 22 Jul 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r4281 | havoc | 2004-07-21 17:38:41 -0700 (Wed, 21 Jul 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r4280 | molivier | 2004-07-21 05:46:00 -0700 (Wed, 21 Jul 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

Fixed a warning when compiling with GCC (missing type)

------------------------------------------------------------------------
r4279 | molivier | 2004-07-20 05:26:55 -0700 (Tue, 20 Jul 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

Updated Transfusion map list for version 1.1 beta3

------------------------------------------------------------------------
r4278 | molivier | 2004-07-20 02:59:46 -0700 (Tue, 20 Jul 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

Fixed the sliders and the toggles in the options menu

------------------------------------------------------------------------
r4277 | tomaz | 2004-07-17 13:25:04 -0700 (Sat, 17 Jul 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/menu.h

added graphics options menu and put realtime lighting stuff in it

------------------------------------------------------------------------
r4276 | tomaz | 2004-07-17 13:17:36 -0700 (Sat, 17 Jul 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

added r_editlights_editall command, same as _edit but affects all lights

------------------------------------------------------------------------
r4275 | tomaz | 2004-07-17 13:15:25 -0700 (Sat, 17 Jul 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

made gl_texture_anisotropy take effect immediately like gl_texturemode rather than needing an r_restart

------------------------------------------------------------------------
r4274 | tomaz | 2004-07-17 13:10:28 -0700 (Sat, 17 Jul 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

Fixed a color bug that made realtime lights to be severly broken.

------------------------------------------------------------------------
r4273 | black | 2004-07-16 08:35:26 -0700 (Fri, 16 Jul 2004) | 3 lines
Changed paths:
   A /trunk/darkplaces/cd_sdl.c

-Added SDL cd playing support (though not all functions are supported).
-Added (in the SDL driver) the console command cddrive to handle multiple cd drives.

------------------------------------------------------------------------
r4272 | havoc | 2004-07-15 13:34:49 -0700 (Thu, 15 Jul 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/sv_main.c

cleaned up EntityState code somewhat, added beginnings of new protocol (not used yet)

------------------------------------------------------------------------
r4271 | black | 2004-07-15 06:01:48 -0700 (Thu, 15 Jul 2004) | 2 lines
Changed paths:
   A /trunk/darkplaces/snd_sdl.c

-Added SDL sound support (still needs a bit debugging, though).

------------------------------------------------------------------------
r4270 | black | 2004-07-14 06:22:01 -0700 (Wed, 14 Jul 2004) | 4 lines
Changed paths:
   M /trunk/darkplaces/snd_dma.c
   M /trunk/darkplaces/sound.h
   M /trunk/darkplaces/sys.h
   M /trunk/darkplaces/sys_win.c
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_wgl.c

-Added the preprocessor constant USE_DSOUND.
-Moved some prototypes around in sys.h a bit.
-Moved Sys_SendKeyEvents from sys_win.c to vid_wgl.c.

------------------------------------------------------------------------
r4269 | havoc | 2004-07-14 05:52:10 -0700 (Wed, 14 Jul 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r4268 | havoc | 2004-07-14 05:31:59 -0700 (Wed, 14 Jul 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r4267 | black | 2004-07-12 11:54:01 -0700 (Mon, 12 Jul 2004) | 5 lines
Changed paths:
   M /trunk/darkplaces/vid_sdl.c

-The mouse wheels now work in Windows (now button presses are detected event-based)
-The left and middle mouse button arent switched any more.
-The library SDL version and the linked SDL version are displayed now (perhaps change
 the outputted text)

------------------------------------------------------------------------
r4266 | coderjoe | 2004-07-11 10:58:54 -0700 (Sun, 11 Jul 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/menu.c

Add OpenQuartz support, provided by Toddd.

------------------------------------------------------------------------
r4265 | black | 2004-07-11 07:56:33 -0700 (Sun, 11 Jul 2004) | 3 lines
Changed paths:
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/sys.h
   M /trunk/darkplaces/sys_linux.c
   M /trunk/darkplaces/sys_sdl.c
   M /trunk/darkplaces/sys_shared.c
   M /trunk/darkplaces/sys_win.c
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_wgl.c

-Removed Sys_Quit and added Sys_Shutdown which will be called by Host_Shutdown.
-The SDL main driver is works more or less now.

------------------------------------------------------------------------
r4264 | black | 2004-07-10 05:27:22 -0700 (Sat, 10 Jul 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/prvm_cmds.c

Fixed a bug in the menu.

------------------------------------------------------------------------
r4263 | molivier | 2004-07-06 01:38:27 -0700 (Tue, 06 Jul 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/snd_dma.c
   M /trunk/darkplaces/snd_mix.c
   M /trunk/darkplaces/snd_null.c
   M /trunk/darkplaces/sound.h

Removed the functions "S_RawSamples_*" and "S_ResampleBuffer16Stereo". They're useless now that the video code uses the common sound API.

------------------------------------------------------------------------
r4262 | havoc | 2004-07-06 00:06:10 -0700 (Tue, 06 Jul 2004) | 4 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

USETEXMATRIX is now a #ifdef rather than a #if
now parses tyrlite light types properly (though doesn't do much special with them)
(this was an update I was sitting on for a month, forgot about it, sorry.)

------------------------------------------------------------------------
r4261 | molivier | 2004-07-05 06:28:58 -0700 (Mon, 05 Jul 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_dma.c

Fixed a crash when using "-nosound"

------------------------------------------------------------------------
r4260 | havoc | 2004-07-04 19:19:57 -0700 (Sun, 04 Jul 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r4259 | molivier | 2004-07-02 08:31:52 -0700 (Fri, 02 Jul 2004) | 2 lines
Changed paths:
   D /trunk/darkplaces/wavefile.c
   D /trunk/darkplaces/wavefile.h

Oops. Forgot to remove "wavefile.[ch]"

------------------------------------------------------------------------
r4258 | molivier | 2004-07-02 08:30:22 -0700 (Fri, 02 Jul 2004) | 5 lines
Changed paths:
   M /trunk/darkplaces/cd_shared.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/darkplaces.dev
   M /trunk/darkplaces/darkplaces.dsp
   M /trunk/darkplaces/dpvsimpledecode.c
   M /trunk/darkplaces/dpvsimpledecode.h
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/makefile.inc
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/snd_dma.c
   M /trunk/darkplaces/snd_mem.c
   M /trunk/darkplaces/snd_null.c
   M /trunk/darkplaces/sound.h

Modified the sound code so it can handle sounds outside of a "sound" subdirectory.
Changed the video code so it uses the common sound code (nice side-effect: DP video soundtracks can now be Ogg Vorbis files). Removed "wavefile.[ch]" and updated the project files accordingly.
Fixed log timestamps on Win32.
Cleaned a bit of code and a few header files inclusions here and there.

------------------------------------------------------------------------
r4257 | black | 2004-06-26 07:32:53 -0700 (Sat, 26 Jun 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

Added support for my experimental ng menu(qc).

------------------------------------------------------------------------
r4256 | black | 2004-06-25 08:13:05 -0700 (Fri, 25 Jun 2004) | 3 lines
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

Added the cmd prvm_global <program> <global> which displays the value of the
specific global. This makes debugging easier.

------------------------------------------------------------------------
r4254 | molivier | 2004-06-25 06:38:31 -0700 (Fri, 25 Jun 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_mix.c
   M /trunk/darkplaces/wavefile.c

Fixed partially the sound code for DP video captures. It still can't sync with the video stream capture itself, but at least it produces a correct WAV file.

------------------------------------------------------------------------
r4253 | molivier | 2004-06-24 07:49:07 -0700 (Thu, 24 Jun 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_demo.c
   M /trunk/darkplaces/todo

DP now handles correctly demos containing "svc_disconnect" messages (fix Quake Done Quick With A Vengeance demos)

------------------------------------------------------------------------
r4251 | molivier | 2004-06-23 07:14:11 -0700 (Wed, 23 Jun 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_dma.c
   M /trunk/darkplaces/snd_null.c
   M /trunk/darkplaces/sound.h

Removed unused functions S_AmbientOff and S_AmbientOn. Moved S_ClearBuffer declaration into "snd_dma.c" so it doesn't need an implementation in "snd_null.c"

------------------------------------------------------------------------
r4250 | molivier | 2004-06-23 07:11:05 -0700 (Wed, 23 Jun 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.inc

Oops. I involuntary changed the default Linux sound config from OSS to ALSA 2 months ago. Reverted back that change.

------------------------------------------------------------------------
r4249 | molivier | 2004-06-23 07:06:45 -0700 (Wed, 23 Jun 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

A couple of minor simplifications in the screenshot / video code

------------------------------------------------------------------------
r4248 | molivier | 2004-06-16 05:06:24 -0700 (Wed, 16 Jun 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces
   M /trunk/darkplaces/.cvsignore
   M /trunk/darkplaces/console.c
   A /trunk/darkplaces/darkplaces.dev

Added support for Dev-C++, a MinGW32 IDE <http://www.bloodshed.net/dev/devcpp.html>

------------------------------------------------------------------------
r4247 | havoc | 2004-05-26 16:03:44 -0700 (Wed, 26 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

Tomaz renamed r_picmip to gl_picmip, r_max_size to gl_max_size, r_max_scrapsize to gl_max_scrapsize

------------------------------------------------------------------------
r4245 | havoc | 2004-05-26 04:28:04 -0700 (Wed, 26 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r4244 | havoc | 2004-05-26 04:25:12 -0700 (Wed, 26 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/keys.c

Tomaz fixed key repeats in the console

------------------------------------------------------------------------
r4243 | havoc | 2004-05-23 01:41:21 -0700 (Sun, 23 May 2004) | 4 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

now reloads rtlights only when map changes, not renderer restarts, this means rtlights changes are not lost when video mode changes
autoloads rtlights when map changes, even if not in realtime lighting mode
compiles lights and loads their cubemaps without checking for visibility first (to force loading on first frame, not during gameplay)

------------------------------------------------------------------------
r4238 | havoc | 2004-05-22 01:11:03 -0700 (Sat, 22 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r4237 | havoc | 2004-05-21 20:13:09 -0700 (Fri, 21 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r4236 | havoc | 2004-05-21 20:12:27 -0700 (Fri, 21 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

Host_Name_f now validates player names, stripping \r and \n control codes

------------------------------------------------------------------------
r4235 | havoc | 2004-05-21 20:00:40 -0700 (Fri, 21 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

sort

------------------------------------------------------------------------
r4234 | havoc | 2004-05-21 20:00:07 -0700 (Fri, 21 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r4233 | havoc | 2004-05-21 19:59:36 -0700 (Fri, 21 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/world.c

added sv_gameplayfix_grenadebouncedownsteps, sv_gameplayfix_noairborncorpse, sv_gameplayfix_stepwhilejumping, sv_gameplayfix_swiminbmodels cvars to be able to disable DP's physics enhancements

------------------------------------------------------------------------
r4232 | havoc | 2004-05-21 19:42:03 -0700 (Fri, 21 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

rtlights were crashing when there's no vis in a q3bsp

------------------------------------------------------------------------
r4230 | havoc | 2004-05-21 19:12:33 -0700 (Fri, 21 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

forgot to sort the todo

------------------------------------------------------------------------
r4229 | havoc | 2004-05-21 19:11:56 -0700 (Fri, 21 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r4227 | havoc | 2004-05-21 15:25:29 -0700 (Fri, 21 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r4226 | havoc | 2004-05-21 15:18:45 -0700 (Fri, 21 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r4224 | havoc | 2004-05-21 12:45:13 -0700 (Fri, 21 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r4223 | havoc | 2004-05-21 12:42:06 -0700 (Fri, 21 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r4222 | havoc | 2004-05-21 12:20:51 -0700 (Fri, 21 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r4221 | havoc | 2004-05-21 12:18:15 -0700 (Fri, 21 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r4220 | havoc | 2004-05-21 12:09:21 -0700 (Fri, 21 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r4219 | havoc | 2004-05-21 11:59:21 -0700 (Fri, 21 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h

Tomaz renamed r_shadow_polygon* cvars to r_shadow_shadow_polygon*

------------------------------------------------------------------------
r4218 | havoc | 2004-05-21 11:56:54 -0700 (Fri, 21 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/zone.c

Tomaz made Mem_Free only clear if developer is on, this may speed up engine shutdown

------------------------------------------------------------------------
r4217 | havoc | 2004-05-21 11:55:30 -0700 (Fri, 21 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/lhnet.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/netconn.h

Tomaz renamed cl_fake* networking cvars to cl_net*

------------------------------------------------------------------------
r4216 | havoc | 2004-05-21 11:53:58 -0700 (Fri, 21 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

Tomaz made the progs/bolt.mdl and progs/bolt2.mdl loading not complain if missing

------------------------------------------------------------------------
r4215 | havoc | 2004-05-21 01:29:04 -0700 (Fri, 21 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r4214 | havoc | 2004-05-20 19:56:10 -0700 (Thu, 20 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

Tomaz fixed the name timer glitch which caused blank names when restarting a server

------------------------------------------------------------------------
r4213 | havoc | 2004-05-20 18:30:23 -0700 (Thu, 20 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

Tomaz added r_skyscroll1/2 to the menu

------------------------------------------------------------------------
r4212 | havoc | 2004-05-20 17:49:52 -0700 (Thu, 20 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_sky.c

handle sky scroll wrapping better

------------------------------------------------------------------------
r4211 | havoc | 2004-05-20 17:40:53 -0700 (Thu, 20 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/render.h

Tomaz implemented r_skyscroll1/2 cvars to control sky scrolling speeds

------------------------------------------------------------------------
r4210 | havoc | 2004-05-20 17:38:50 -0700 (Thu, 20 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/cl_screen.h
   M /trunk/darkplaces/gl_backend.c

Tomaz implemented the vid_pixelaspect patch provided by Grisha Spivak

------------------------------------------------------------------------
r4209 | havoc | 2004-05-20 16:24:41 -0700 (Thu, 20 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h

added GAME_NEOTERIC

------------------------------------------------------------------------
r4208 | havoc | 2004-05-20 16:18:41 -0700 (Thu, 20 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r4207 | havoc | 2004-05-20 16:17:57 -0700 (Thu, 20 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c

changed Son of Man's data directory to sonofman, as requested by Supajoe

------------------------------------------------------------------------
r4206 | havoc | 2004-05-20 16:05:55 -0700 (Thu, 20 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/render.h

GL_TransformToScreen now properly calculates out[2], thanks to Vic for pointing out the flaw

------------------------------------------------------------------------
r4205 | havoc | 2004-05-20 14:05:15 -0700 (Thu, 20 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r4204 | havoc | 2004-05-20 13:33:00 -0700 (Thu, 20 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/image.h

Tomaz made cl_avidemo screenshot saving use no mallocs

------------------------------------------------------------------------
r4203 | havoc | 2004-05-20 12:29:04 -0700 (Thu, 20 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/curves.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/snd_win.c

Tomaz cleaned up some double ;; lines (strange stuff)

------------------------------------------------------------------------
r4202 | havoc | 2004-05-20 11:57:28 -0700 (Thu, 20 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h

Tomaz optimized the cl_avidemo mode by making it keep around the image processing buffers, two less mallocs per frame

------------------------------------------------------------------------
r4200 | havoc | 2004-05-19 00:22:37 -0700 (Wed, 19 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

... actually 16 looks better as a start size

------------------------------------------------------------------------
r4199 | havoc | 2004-05-19 00:22:06 -0700 (Wed, 19 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

updated cl_explosions_size_start and cl_explosions_size_end to 64 and 128 respectively

------------------------------------------------------------------------
r4198 | havoc | 2004-05-19 00:20:12 -0700 (Wed, 19 May 2004) | 3 lines
Changed paths:
   M /trunk/darkplaces/r_explosion.c

restructured parts of explosion code
cl_explosions_size_start and cl_explosions_size_end now work

------------------------------------------------------------------------
r4196 | havoc | 2004-05-18 17:49:08 -0700 (Tue, 18 May 2004) | 3 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/fs.c

moved screenshot base name stuff to common.c, out of fs.c (by adding a gamescreenshotname variable, set like gamename and gamedirname)
added support for multiple -game directories (-game a -game b -game c ...)

------------------------------------------------------------------------
r4195 | havoc | 2004-05-18 15:01:56 -0700 (Tue, 18 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_sky.c

Tomaz changed skybox rendering/loading to flip skyboxes and use cubemaps directly (no visual differences, just prefers cubemaps now) and reordered suffix tables to load in the order px posx rt

------------------------------------------------------------------------
r4194 | havoc | 2004-05-18 14:48:55 -0700 (Tue, 18 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/image.c

Tomaz fixed Image_CopyMux

------------------------------------------------------------------------
r4193 | havoc | 2004-05-18 14:28:40 -0700 (Tue, 18 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/image.c

new optimized Image_CopyMux is broken, disabled until it's fixed

------------------------------------------------------------------------
r4192 | havoc | 2004-05-18 14:04:59 -0700 (Tue, 18 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_sky.c

Tomaz added support for loading a cubemap as skybox

------------------------------------------------------------------------
r4191 | havoc | 2004-05-18 13:48:56 -0700 (Tue, 18 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

Tomaz fixed black models in unlit maps

------------------------------------------------------------------------
r4190 | havoc | 2004-05-18 11:55:36 -0700 (Tue, 18 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_explosion.c

Tomaz patch to implement controllable fade rate in explosions

------------------------------------------------------------------------
r4189 | havoc | 2004-05-18 11:26:12 -0700 (Tue, 18 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/image.c

Vic optimized Image_CopyMux

------------------------------------------------------------------------
r4188 | havoc | 2004-05-17 23:26:07 -0700 (Mon, 17 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

merged RSurfShader_Water_Callback and RSurfShader_Wall_Vertex_Callback and made them more consistent, water lightmaps are now basically supported (vertex though)

------------------------------------------------------------------------
r4187 | havoc | 2004-05-17 23:24:22 -0700 (Mon, 17 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_light.c

allow drawing coronas fainter than 1 (it was checking r_coronas.integer)

------------------------------------------------------------------------
r4186 | havoc | 2004-05-17 23:13:31 -0700 (Mon, 17 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r4185 | havoc | 2004-05-17 21:35:35 -0700 (Mon, 17 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

separated rtlight (light[]) settings from normal glow dlights, this means no more anomalies involving cubemaps on glowing models and such, all pflags are ignored on dlights, only rtlights are affected

------------------------------------------------------------------------
r4184 | havoc | 2004-05-17 13:09:21 -0700 (Mon, 17 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

Tomaz added lightning settings to effects options menu

------------------------------------------------------------------------
r4183 | havoc | 2004-05-17 13:06:10 -0700 (Mon, 17 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/r_explosion.c

Tomaz added some cl_explosions cvars, more work on this to come

------------------------------------------------------------------------
r4182 | havoc | 2004-05-17 12:46:52 -0700 (Mon, 17 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c

cleaned up PF_fopen filename rejection, now rejects more unsafe names, including control characters (yes I expect problems with player names as a result)

------------------------------------------------------------------------
r4181 | havoc | 2004-05-17 12:27:00 -0700 (Mon, 17 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c

Tomaz patch to fopen builtin which now tries to read files outside data/ (but won't try to write or append outside data/), for better compatibility with other engines that don't use data/ in their FRIK_FILE implementation

------------------------------------------------------------------------
r4180 | havoc | 2004-05-17 12:18:31 -0700 (Mon, 17 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c

Tomaz's con_backscroll patch, backscroll is no longer reset by new prints, and remains locked on the same position in the history

------------------------------------------------------------------------
r4179 | havoc | 2004-05-17 12:08:44 -0700 (Mon, 17 May 2004) | 3 lines
Changed paths:
   M /trunk/darkplaces/common.c

changed Com_HexDumpToConsole to print space separated 4 byte groups, added some comments, and cleaned up the readability of it
thanks to Tomaz for the beginnings of this patch

------------------------------------------------------------------------
r4178 | havoc | 2004-05-17 11:22:31 -0700 (Mon, 17 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix r_fullbright being accidentally reset on level change

------------------------------------------------------------------------
r4176 | havoc | 2004-05-15 17:21:11 -0700 (Sat, 15 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/matrixlib.c

Tomaz optimized Matrix4x4_CreateFromQuakeEntity

------------------------------------------------------------------------
r4175 | havoc | 2004-05-15 17:19:10 -0700 (Sat, 15 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/mathlib.c

Tomaz optimized AngleVectorsFLU for the roll == 0 case

------------------------------------------------------------------------
r4174 | havoc | 2004-05-15 16:35:18 -0700 (Sat, 15 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

Tomaz made envmap also save px/nx/py/ny/pz/nz files (GL cubemap)

------------------------------------------------------------------------
r4173 | havoc | 2004-05-15 16:24:11 -0700 (Sat, 15 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/mathlib.c

Tomaz optimized AngleVectors for the roll == 0 case

------------------------------------------------------------------------
r4172 | havoc | 2004-05-15 14:49:10 -0700 (Sat, 15 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/keys.c

Tomaz enabled some numpad keys in the console and the insert key, and also fixed up the console edit line rendering so you can move left/right on the editing line

------------------------------------------------------------------------
r4171 | havoc | 2004-05-15 13:43:17 -0700 (Sat, 15 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c

Tomaz renamed all R_Model_Brush functions to R_Q1BSP

------------------------------------------------------------------------
r4170 | havoc | 2004-05-15 13:40:07 -0700 (Sat, 15 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

added comments to cubemap loader, to explain its confusing logic

------------------------------------------------------------------------
r4169 | havoc | 2004-05-15 13:24:19 -0700 (Sat, 15 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/r_shadow.c

Tomaz fixed the envmap command; it was saving black images, and now saves images in the correct order with appropriate flipping, to comply with skybox arrangements

------------------------------------------------------------------------
r4168 | havoc | 2004-05-15 12:35:15 -0700 (Sat, 15 May 2004) | 4 lines
Changed paths:
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/image.h

renamed most Image_CopyMux parameters to begin with input to clarify their purpose, inputwidth for example, because these are input properties, not output properties
cleaned up Image_CopyMux, and fixed its handling of inputflipdiagonal to properly work with unequal inputwidth/inputheight
swapped Image_CopyMux numinputcomponents/numoutputcomponents parameters to be more consistent with the 'output, input' order of its other parameters

------------------------------------------------------------------------
r4167 | havoc | 2004-05-15 11:34:46 -0700 (Sat, 15 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r4166 | havoc | 2004-05-14 22:52:06 -0700 (Fri, 14 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fix skybox loading in q3 shaders, needed to append a _ to the end of the skybox name

------------------------------------------------------------------------
r4165 | havoc | 2004-05-14 08:53:58 -0700 (Fri, 14 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

Tomaz fixed cubemap loading of skyboxes

------------------------------------------------------------------------
r4164 | havoc | 2004-05-13 17:17:43 -0700 (Thu, 13 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_sky.c

Tomaz fixed the skybox arrangement to match glquake/quake2/quake3/3dstudio

------------------------------------------------------------------------
r4163 | havoc | 2004-05-13 17:16:34 -0700 (Thu, 13 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_shared.c

Tomaz fixed the stencil support (I had accidentally broken it in my over-zealous resetting of gl related variables)

------------------------------------------------------------------------
r4162 | havoc | 2004-05-13 15:39:18 -0700 (Thu, 13 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r4161 | havoc | 2004-05-13 15:02:33 -0700 (Thu, 13 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/view.c

Tomaz's gl_polyblend patch to control intensity of view blends

------------------------------------------------------------------------
r4160 | havoc | 2004-05-13 12:10:44 -0700 (Thu, 13 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

Tomaz's patch to add fov to options menu

------------------------------------------------------------------------
r4159 | havoc | 2004-05-13 11:41:18 -0700 (Thu, 13 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r4158 | havoc | 2004-05-13 11:40:01 -0700 (Thu, 13 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/server.h

Tomaz's nametime patch (prevent frequent name changes on the server)

------------------------------------------------------------------------
r4157 | havoc | 2004-05-13 10:23:09 -0700 (Thu, 13 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/cl_screen.h
   M /trunk/darkplaces/fs.c

Tomaz's patch to name screenshots based on gamemode or -game if specified

------------------------------------------------------------------------
r4148 | havoc | 2004-05-12 15:08:29 -0700 (Wed, 12 May 2004) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/vid_shared.c

Tomaz's patch to ask the driver for a gl_texture_anisotropy limit, and apply that limit
also fixed a bunch of extension variables that were not being reset on resolution changes

------------------------------------------------------------------------
r4147 | havoc | 2004-05-12 11:03:11 -0700 (Wed, 12 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r4146 | havoc | 2004-05-12 09:57:48 -0700 (Wed, 12 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces
   M /trunk/darkplaces/.cvsignore

now ignores darkplaces-sdl and darkplaces-dedicated executables, removed darkplaces-3dfx executable (as it has been abandoned for a long time)

------------------------------------------------------------------------
r4145 | havoc | 2004-05-12 09:55:42 -0700 (Wed, 12 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/render.h

Tomaz's patch for r_waterwarp with controllable intensity

------------------------------------------------------------------------
r4144 | havoc | 2004-05-12 09:52:39 -0700 (Wed, 12 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

Tomaz's patch for optimized vectorlength calls in the vertex lighting code, as Vic suggested

------------------------------------------------------------------------
r4141 | molivier | 2004-05-04 03:10:10 -0700 (Tue, 04 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

Fixed a few warnings regarding casts of lvalues (deprecated in GCC 3.3, unsupported in GCC 3.4)

------------------------------------------------------------------------
r4138 | molivier | 2004-05-04 01:45:14 -0700 (Tue, 04 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_alsa.c
   M /trunk/darkplaces/snd_dma.c

Removed the printings at the end of ALSA driver initialization. Fixed the soundinfo format string for the DMA pointer

------------------------------------------------------------------------
r4131 | havoc | 2004-05-03 03:11:16 -0700 (Mon, 03 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt

credited Elric for some of his great contributions, and removed the warnings about music files often using 50mb or so of memory, as Elric made them stream

------------------------------------------------------------------------
r4120 | havoc | 2004-05-01 20:54:31 -0700 (Sat, 01 May 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_edict.c

clean up vector parsing in ED_ParseEpair, now stores 0 into any vector components that can not be read due to end of string

------------------------------------------------------------------------
r4118 | molivier | 2004-04-29 00:54:05 -0700 (Thu, 29 Apr 2004) | 3 lines
Changed paths:
   M /trunk/darkplaces/console.c

The log file is now started and stopped at run-time whenever the value of the "log_file" cvar changes. Added timestamps at the beginning and at the end of the log files. Increased the log queue size from 256 to 512.
DP now appends the new logs instead of overwritting the files (except when using "-condebug", it overwrites "qconsole.log").

------------------------------------------------------------------------
r4117 | molivier | 2004-04-29 00:51:11 -0700 (Thu, 29 Apr 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.inc
   A /trunk/darkplaces/snd_alsa.c
   D /trunk/darkplaces/snd_alsa_0_5.c
   D /trunk/darkplaces/snd_alsa_0_9.c

Updated ALSA driver (API version 1.0). The vast majority of the code comes from QuakeForge, like the previous versions

------------------------------------------------------------------------
r4116 | molivier | 2004-04-29 00:48:32 -0700 (Thu, 29 Apr 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_ogg.c

Fixed a bug in the Ogg Vorbis streaming code that can cause sound files to be unplayable if the sound device is set to a lower speed

------------------------------------------------------------------------
r4115 | havoc | 2004-04-17 18:47:46 -0700 (Sat, 17 Apr 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

merged R_DrawSurfaceChain into R_DrawSurfaces loop

------------------------------------------------------------------------
r4114 | havoc | 2004-04-17 18:24:54 -0700 (Sat, 17 Apr 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

more consistent and helpful model loading error messages

------------------------------------------------------------------------
r4113 | havoc | 2004-04-16 01:06:36 -0700 (Fri, 16 Apr 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/sv_main.c

fixed the huge networking problems regarding invalid reference frames

------------------------------------------------------------------------
r4112 | havoc | 2004-04-15 23:36:32 -0700 (Thu, 15 Apr 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

made the player setup menu actually change the rate cvar (like it was supposed to)

------------------------------------------------------------------------
r4111 | molivier | 2004-04-15 23:28:12 -0700 (Thu, 15 Apr 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cd_bsd.c
   M /trunk/darkplaces/cd_linux.c
   M /trunk/darkplaces/cd_shared.c

Fine-grained CD volume for NetBSD. Made the CD error message "Bad track number" a normal (non-developer) message. Zeroed the 3rd and 4th channel volumes in the Linux CD module too. The initial CD volume is now printed at startup (developer message).

------------------------------------------------------------------------
r4110 | havoc | 2004-04-15 23:08:18 -0700 (Thu, 15 Apr 2004) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h

renamed r_shadow_worldshadows to r_shadow_realtime_world_shadows
renamed r_shadow_dlightshadows to r_shadow_realtime_dlight_shadows, and added r_shadow_realtime_world_dlightshadows to control dlight shadows in realtime world mode

------------------------------------------------------------------------
r4109 | havoc | 2004-04-15 23:06:24 -0700 (Thu, 15 Apr 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/sys_win.c

make WinMain commandline parser handle quoted strings

------------------------------------------------------------------------
r4108 | molivier | 2004-04-15 07:24:03 -0700 (Thu, 15 Apr 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cd_bsd.c
   M /trunk/darkplaces/cd_linux.c
   M /trunk/darkplaces/cd_null.c
   M /trunk/darkplaces/cd_shared.c
   M /trunk/darkplaces/cd_win.c

Fine-grained CD volume support for Linux. Note that it uses the CD player internal volume, not the system audio mixer. The BSD version should follow very soon; if someone knows how to do that on Win32, I would be glad to hear from him.

------------------------------------------------------------------------
r4107 | molivier | 2004-04-14 23:04:09 -0700 (Wed, 14 Apr 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_ogg.c
   M /trunk/darkplaces/todo

Fixed streaming of sounds with a sample rate different from the engine output rate. Streamed sounds are now processed by 1 sec steps, to avoid lossing samples in ResampleSfx among other things (it could occur when resampling from 48KHz to 44KHz for instance).

------------------------------------------------------------------------
r4106 | havoc | 2004-04-14 01:47:14 -0700 (Wed, 14 Apr 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_shared.h

r_ambient no longer alters the lightmap in q1bsp, instead it adds another render pass (this makes sense for performance as it's a cheat anyway, no optimization needed)

------------------------------------------------------------------------
r4105 | havoc | 2004-04-14 00:53:38 -0700 (Wed, 14 Apr 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h

renamed q3mface_t to q3msurface_t

------------------------------------------------------------------------
r4104 | havoc | 2004-04-14 00:34:44 -0700 (Wed, 14 Apr 2004) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/r_shadow.c

renamed model->numsurfaces to model->nummodelsurfaces
renamed model->brushq1.firstmodelsurface and model->brushq1.nummodelsurfaces to model->firstmodelsurface and model->nummodelsurfaces

------------------------------------------------------------------------
r4103 | havoc | 2004-04-13 23:17:43 -0700 (Tue, 13 Apr 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c

merged R_DrawWorld into DrawSky/Draw so that rmain can just call DrawSky and Draw on the world entity like any other

------------------------------------------------------------------------
r4102 | molivier | 2004-04-13 23:02:02 -0700 (Tue, 13 Apr 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cd_linux.c

The Linux CD module now uses O_NONBLOCK when opening the CDROM device to avoid failure if there's no CD in the player

------------------------------------------------------------------------
r4101 | havoc | 2004-04-13 22:13:50 -0700 (Tue, 13 Apr 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

cleaned up submodel loading, and wrote a big description of how quake worked (since it was so confusing), as well as how it now works

------------------------------------------------------------------------
r4100 | havoc | 2004-04-13 21:59:06 -0700 (Tue, 13 Apr 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r4099 | havoc | 2004-04-13 21:58:31 -0700 (Tue, 13 Apr 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt

added a number of tips and a sound features section

------------------------------------------------------------------------
r4098 | havoc | 2004-04-13 21:47:31 -0700 (Tue, 13 Apr 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

fix sprite pitch; apparently quake did not negate their pitch after all...

------------------------------------------------------------------------
r4097 | havoc | 2004-04-12 00:58:04 -0700 (Mon, 12 Apr 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

another change for transfusion (remove the little frag counts display from the sbar)

------------------------------------------------------------------------
r4096 | havoc | 2004-04-12 00:34:02 -0700 (Mon, 12 Apr 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/sbar.c

patch from transfusion team to change transfusion hud layout a bit (moves minideathmatch overlay to be across the top of the screen, and centers the sbar even in deathmatch)

------------------------------------------------------------------------
r4095 | havoc | 2004-04-12 00:30:47 -0700 (Mon, 12 Apr 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

patch from transfusion team to add taunts to transfusion bind menu

------------------------------------------------------------------------
r4094 | molivier | 2004-04-11 10:41:17 -0700 (Sun, 11 Apr 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cd_shared.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/snd_dma.c
   M /trunk/darkplaces/snd_null.c
   M /trunk/darkplaces/sound.h

The first step towards a real CD volume setting (only the fake CD tracks volume are correctly supported for the moment). Removed a couple of useless definitions in "sound.h".

------------------------------------------------------------------------
r4093 | molivier | 2004-04-11 10:34:51 -0700 (Sun, 11 Apr 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_ogg.c

Added an error message when the sound mixer requests more samples from a stream than its buffer can contain

------------------------------------------------------------------------
r4092 | havoc | 2004-04-09 19:20:09 -0700 (Fri, 09 Apr 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

reverse pitch direction on PFLAGS_FULLDYNAMIC light entities to match tenebrae

------------------------------------------------------------------------
r4091 | molivier | 2004-04-09 12:37:18 -0700 (Fri, 09 Apr 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c

The base size of the log queue is 256 bytes, not 4 (it was a test for the queue automatic resizing that was commited by mistake)

------------------------------------------------------------------------
r4090 | molivier | 2004-04-08 06:11:51 -0700 (Thu, 08 Apr 2004) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_demo.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/console.h
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/fs.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/todo

Added a "log_file" cvar to control the log file name (default: "" which means no log, "-condebug" sets it to "qconsole.log"). Added a "log_sync" cvar to control whether or not the log output is flushed at each write (default: 0, "-condebug" sets it to 1).
Note that we now need to wait until the cvars are initialized to start logging the console, so the logging system puts every message printed before that in a logging queue that is proceed when the log file is actually opened.
Renamed "Con_LogPrint" and "Con_LogPrintf" to "Log_Print" and "Log_Printf" respectively. Added "FS_VPrintf"

------------------------------------------------------------------------
r4089 | molivier | 2004-04-08 05:59:34 -0700 (Thu, 08 Apr 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_dma.c
   M /trunk/darkplaces/snd_ogg.c
   M /trunk/darkplaces/snd_wav.c
   M /trunk/darkplaces/sound.h

"soundlist" now tells you if a sound is streamed and whether it is mono or stereo

------------------------------------------------------------------------
r4088 | havoc | 2004-04-06 21:36:11 -0700 (Tue, 06 Apr 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

fixed entities disappearing when partially submerged in water (it was a very stupid bounding box bug)

------------------------------------------------------------------------
r4087 | molivier | 2004-04-06 06:08:07 -0700 (Tue, 06 Apr 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c

Removed an unused cvar (logfile)

------------------------------------------------------------------------
r4086 | molivier | 2004-04-05 22:58:07 -0700 (Mon, 05 Apr 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/todo

Fixed cl_nodelta 1

------------------------------------------------------------------------
r4085 | molivier | 2004-04-05 00:00:19 -0700 (Mon, 05 Apr 2004) | 4 lines
Changed paths:
   M /trunk/darkplaces/cd_bsd.c
   M /trunk/darkplaces/cd_linux.c
   M /trunk/darkplaces/cd_null.c
   M /trunk/darkplaces/cd_shared.c
   M /trunk/darkplaces/makefile.inc
   M /trunk/darkplaces/snd_dma.c
   M /trunk/darkplaces/snd_mix.c
   M /trunk/darkplaces/snd_null.c
   M /trunk/darkplaces/sound.h

Fake CD tracks support; DP now tries to play "sound/cdtracks/trackXX.wav" instead of CD track XX. If it fails, it tries "trackXX.ogg", and then the real CD track if any. CD console commands should work as expected.
"cd_shared.c" is now part of the common files so it allows people to compile DP without real CD support, but with fake CD tracks support. "cd_null.c" is now a null driver, at the same level as "cd_linux.c" or "cd_win.c".
Fixed the broken return value of S_StartSound and a potential memory leak in S_StopAllSounds in the process.

------------------------------------------------------------------------
r4084 | molivier | 2004-04-04 23:51:41 -0700 (Sun, 04 Apr 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/todo

Fixed the "-path" option. A couple of FS variables were never initialized explicitly

------------------------------------------------------------------------
r4083 | havoc | 2004-04-04 23:49:31 -0700 (Sun, 04 Apr 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/quakedef.h

inlined Host_EndGame in CL_ParseServerMessage's svc_disconnect case and greatly reduced its code (removing the server shutdown, etc), this fixed an infinite recursion shutdown crash introduced by the Host_ShutdownServer changes

------------------------------------------------------------------------
r4082 | molivier | 2004-04-04 23:45:47 -0700 (Sun, 04 Apr 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/sys_linux.c
   M /trunk/darkplaces/todo

Fixed Win32 dedicated server input

------------------------------------------------------------------------
r4081 | havoc | 2004-04-04 23:20:23 -0700 (Sun, 04 Apr 2004) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_demo.c
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/netconn.c

fixed very annoying '5 second timeout' bug in Host_ShutdownServer (the local client was timing out on the NetConn_SendToAll because the server was ignoring the client's reply packets, by setting sv.active = false too early)
added Host_ShutdownServer call near every CL_Disconnect call, for consistency
CL_Disconnect and Host_ShutdownServer now report their calls as dprints (previously they were entirely silent)

------------------------------------------------------------------------
r4080 | havoc | 2004-04-03 15:20:30 -0800 (Sat, 03 Apr 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/world.c

make shrak work (lots of SOLID_BSP/MOVETYPE_PUSH entities with no models)

------------------------------------------------------------------------
r4079 | havoc | 2004-04-02 17:34:56 -0800 (Fri, 02 Apr 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

fixed missing newline after map name in join message

------------------------------------------------------------------------
r4078 | molivier | 2004-04-02 05:23:20 -0800 (Fri, 02 Apr 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/snd_dma.c
   M /trunk/darkplaces/snd_mix.c
   M /trunk/darkplaces/snd_null.c
   M /trunk/darkplaces/sound.h

Added a CHANNELFLAG_LOCALSOUND flag for channels playing a client-side sound, such as menu sounds for instance. Added the ability to pause/resume channels. When the game is paused, all non-local sounds are now automatically paused (previously, no new sound was started during the pause, but those already created were played normally).

------------------------------------------------------------------------
r4077 | molivier | 2004-04-01 23:27:05 -0800 (Thu, 01 Apr 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

Oops... It seems this malloc/free was actually intended (part of a piece of code protected by a WORKINGLQUAKE define)

------------------------------------------------------------------------
r4076 | molivier | 2004-04-01 23:12:10 -0800 (Thu, 01 Apr 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/snd_dma.c
   M /trunk/darkplaces/snd_mix.c
   M /trunk/darkplaces/sound.h
   M /trunk/darkplaces/sys_shared.c

strncpy -> {strlcpy,memcpy}. Replaced the "forceloop" boolean in "channel_t" by a flags field.

------------------------------------------------------------------------
r4075 | molivier | 2004-04-01 23:08:54 -0800 (Thu, 01 Apr 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/fs.c

Replaced a direct call to "malloc" and "free", and removed several misuses of "Z_Malloc" where using the temp mempool was sufficient.

------------------------------------------------------------------------
r4074 | havoc | 2004-04-01 14:42:40 -0800 (Thu, 01 Apr 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

fixed animated textures in realtime lighting mode (now calls R_UpdateTextureInfo)

------------------------------------------------------------------------
r4073 | havoc | 2004-04-01 14:10:17 -0800 (Thu, 01 Apr 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/lhnet.c

fix the namelen parameter in the getsockname call

------------------------------------------------------------------------
r4072 | havoc | 2004-04-01 14:07:23 -0800 (Thu, 01 Apr 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/lhnet.c

now uses getsockname to find out what address/port a newly opened socket is at, so it won't say 0.0.0.0:0 anymore

------------------------------------------------------------------------
r4071 | molivier | 2004-04-01 01:46:46 -0800 (Thu, 01 Apr 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/collision.c

Fixed a warning (unused variable)

------------------------------------------------------------------------
r4070 | havoc | 2004-03-31 18:06:20 -0800 (Wed, 31 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

default to r_shadow_realtime_dlight 1 mode

------------------------------------------------------------------------
r4069 | havoc | 2004-03-31 08:14:54 -0800 (Wed, 31 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/collision.c

disabled triangle normal validation because the validator was broken and just spewing warnings

------------------------------------------------------------------------
r4068 | molivier | 2004-03-31 05:41:22 -0800 (Wed, 31 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_bsd.c

OpenBSD doesn't define _PATH_SOUND

------------------------------------------------------------------------
r4065 | havoc | 2004-03-30 17:33:56 -0800 (Tue, 30 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

disabled the invalid model check in Mod_CheckLoaded as it was preventing the game from working with missing models

------------------------------------------------------------------------
r4064 | havoc | 2004-03-30 17:33:16 -0800 (Tue, 30 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

fix NODRAW flag check (don't draw NODRAW shaders)

------------------------------------------------------------------------
r4063 | havoc | 2004-03-30 17:08:50 -0800 (Tue, 30 Mar 2004) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/sv_main.c

now supports missing models
trying to load a non-existent map no longer kills the server

------------------------------------------------------------------------
r4062 | havoc | 2004-03-28 08:19:36 -0800 (Sun, 28 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r4061 | molivier | 2004-03-26 06:22:26 -0800 (Fri, 26 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_mix.c
   M /trunk/darkplaces/sound.h

The portable_samplepair_t structure has no need to be public

------------------------------------------------------------------------
r4060 | molivier | 2004-03-26 06:20:39 -0800 (Fri, 26 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c

Removed a couple of useless inclusions

------------------------------------------------------------------------
r4058 | havoc | 2004-03-25 06:36:17 -0800 (Thu, 25 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/matrixlib.c

include <> above ""

------------------------------------------------------------------------
r4057 | molivier | 2004-03-25 01:47:01 -0800 (Thu, 25 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.dsp
   M /trunk/darkplaces/makefile.inc
   M /trunk/darkplaces/snd_dma.c
   M /trunk/darkplaces/snd_mem.c
   M /trunk/darkplaces/snd_ogg.c
   A /trunk/darkplaces/snd_wav.c
   A /trunk/darkplaces/snd_wav.h
   M /trunk/darkplaces/sound.h

Moved the WAV loading code out of "snd_mem.c". Removed a couple of useless definitions in "sound.h".

------------------------------------------------------------------------
r4056 | molivier | 2004-03-24 05:40:43 -0800 (Wed, 24 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/jpeg.c
   M /trunk/darkplaces/snd_ogg.c
   M /trunk/darkplaces/sys.h
   M /trunk/darkplaces/sys_shared.c

Factorized some code in the shared library loaders

------------------------------------------------------------------------
r4055 | molivier | 2004-03-24 00:06:56 -0800 (Wed, 24 Mar 2004) | 3 lines
Changed paths:
   M /trunk/darkplaces/snd_dma.c
   M /trunk/darkplaces/snd_mix.c
   M /trunk/darkplaces/sound.h

Fixed the sounds not being advanced in time while not being listened. This is a long standing bug I think, it looks like the original Quake source code has it too, though I haven't tested. Each channel now remembers the last time it was painted, and so it can resume the play at the appropriate position if it missed some painting rounds.
Also, added a check to avoid looped sounds being overridden when picking a channel.

------------------------------------------------------------------------
r4054 | havoc | 2004-03-23 11:32:38 -0800 (Tue, 23 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

rtlights shouldn't do anything with sky and water (this fixes shadowing problems mainly)

------------------------------------------------------------------------
r4053 | molivier | 2004-03-23 07:59:10 -0800 (Tue, 23 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_mem.c

Fixed the WAV file loading code (loopstart was always 0 if the sound was looped)

------------------------------------------------------------------------
r4052 | molivier | 2004-03-23 00:28:28 -0800 (Tue, 23 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_bsd.c
   M /trunk/darkplaces/snd_dma.c
   M /trunk/darkplaces/snd_mem.c
   M /trunk/darkplaces/snd_mix.c
   M /trunk/darkplaces/snd_ogg.c
   M /trunk/darkplaces/snd_ogg.h
   M /trunk/darkplaces/snd_oss.c
   M /trunk/darkplaces/snd_win.c
   M /trunk/darkplaces/sound.h

Ogg vorbis streaming support; the code decides whether it will cache or stream the sound depending on the file and uncompressed sound sizes. It should be stable enough for a regular use now; you lose a few FPS once every second or so of course, it's not free, but you can expect the Vorbis stream to use between 5 and 12 times less memory than before, depending on the sound quality and the number of SFX sources using it. This patch also contains a couple of fixes (a pretty annoying typo in the OSS and BSD driver - 22051Hz instead of 22050Hz, and a potential memory leak in WAV loader)

------------------------------------------------------------------------
r4051 | molivier | 2004-03-22 23:59:09 -0800 (Mon, 22 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/fs.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/palette.c
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/snd_mem.c
   M /trunk/darkplaces/snd_ogg.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/wad.c

Added a mempool parameter to FS_LoadFile

------------------------------------------------------------------------
r4050 | havoc | 2004-03-22 23:44:34 -0800 (Mon, 22 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/image.c

fixed a memory leak if an image file loaded but failed to decode

------------------------------------------------------------------------
r4049 | havoc | 2004-03-22 10:43:32 -0800 (Mon, 22 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

commented out mini scoreboard in nexuiz hud

------------------------------------------------------------------------
r4048 | havoc | 2004-03-22 08:15:19 -0800 (Mon, 22 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

fixed two warnings on glGetDoublev calls

------------------------------------------------------------------------
r4047 | havoc | 2004-03-22 02:08:37 -0800 (Mon, 22 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

q3bsp pvs works again (was checking loadmodel when it should have been checking model)

------------------------------------------------------------------------
r4046 | havoc | 2004-03-22 02:04:48 -0800 (Mon, 22 Mar 2004) | 9 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

worked around an ATI driver bug with glColor during GL_EXT_compiled_vertex_array locks being ignored - R_Shadow_RenderLighting dot3 paths now lock around each pass instead of the whole set of final passes - ATI PLEASE FIX THIS, the GL_EXT_compiled_vertex_array spec says all settings can be changed during a lock!
reorganized R_Shadow_RenderLighting to reduce code duplication a bit
enabled scissor without stencil support (the bug was in the lack of a valid projectmatrix)
added 3 tmu vertex lighting path (uses XYZ attenuation via textures, and vertex shading) which is mainly for use on 3+ tmu cards in 16bit color mode
renamed R_Shadow_VertexLighting functions to R_Shadow_VertexShading and made their names more clear
fixed a bug in the R_Shadow_VertexShading math (now normalizes the vertex->light vector as well as normal vector)
made some functions static
added an #ifndef USETEXMATRIX around the cpu matrix transform functions as they're not used anymore due to USETEXMATRIX code

------------------------------------------------------------------------
r4045 | havoc | 2004-03-22 01:22:38 -0800 (Mon, 22 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

fix scissoring bugs with r_shadow_realtime_dlight - the projectmatrix was not being set for glFrustum and glOrtho cases, now it is (by reading back from GL)

------------------------------------------------------------------------
r4044 | havoc | 2004-03-22 01:19:28 -0800 (Mon, 22 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/vid_shared.c

uncommented a lot of GL functions

------------------------------------------------------------------------
r4042 | havoc | 2004-03-19 02:16:43 -0800 (Fri, 19 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.inc

removed -fexpensive-optimizations (which is turned on by -O2), added -funroll-loops

------------------------------------------------------------------------
r4041 | havoc | 2004-03-18 02:49:02 -0800 (Thu, 18 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fixed 'black models' bugs in RecursiveLightPoint code

------------------------------------------------------------------------
r4040 | havoc | 2004-03-17 21:15:08 -0800 (Wed, 17 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

fixed r_fullbright

------------------------------------------------------------------------
r4039 | havoc | 2004-03-16 22:48:04 -0800 (Tue, 16 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

expanded cl_max_beams from 24 to 256

------------------------------------------------------------------------
r4038 | havoc | 2004-03-16 19:43:50 -0800 (Tue, 16 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h

bsp model shadows are now enlarged by r_shadow_projectdistance (to cure problems with nearby surfaces casting shadow volumes too small)

------------------------------------------------------------------------
r4036 | havoc | 2004-03-16 01:49:59 -0800 (Tue, 16 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r4035 | havoc | 2004-03-16 01:49:16 -0800 (Tue, 16 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

optimized away most texmatrix comparisons (now checks unit->texmatrixenabled which just dodges the comparisons)

------------------------------------------------------------------------
r4029 | coderjoe | 2004-03-15 22:40:42 -0800 (Mon, 15 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cd_null.c
   M /trunk/darkplaces/sv_user.qc
   M /trunk/dpmod/default.cfg
   M /trunk/dpmod/qc/CTF.qc
   M /trunk/dpmod/qc/ai.qc
   M /trunk/dpmod/qc/bullets.qc
   M /trunk/dpmod/qc/buttons.qc
   M /trunk/dpmod/qc/casings.qc
   M /trunk/dpmod/qc/cheatcode.qc
   M /trunk/dpmod/qc/client.qc
   M /trunk/dpmod/qc/damage.qc
   M /trunk/dpmod/qc/damagetype.qc
   M /trunk/dpmod/qc/darkp.qc
   M /trunk/dpmod/qc/decals.qc
   M /trunk/dpmod/qc/decors.qc
   M /trunk/dpmod/qc/defs.qc
   M /trunk/dpmod/qc/domination.qc
   M /trunk/dpmod/qc/doors.qc
   M /trunk/dpmod/qc/dpextensions.qc
   M /trunk/dpmod/qc/explosion.qc
   M /trunk/dpmod/qc/fight.qc
   M /trunk/dpmod/qc/finalarenamaps.qc
   M /trunk/dpmod/qc/fire.qc
   M /trunk/dpmod/qc/fireball.qc
   M /trunk/dpmod/qc/flash.qc
   M /trunk/dpmod/qc/fog.qc
   M /trunk/dpmod/qc/footstep.qc
   M /trunk/dpmod/qc/forcefield.qc
   M /trunk/dpmod/qc/gibcomments.qc
   M /trunk/dpmod/qc/gore.qc
   M /trunk/dpmod/qc/halflife.qc
   M /trunk/dpmod/qc/havocbot.qc
   M /trunk/dpmod/qc/impulse_main.qc
   M /trunk/dpmod/qc/invisiblewall.qc
   M /trunk/dpmod/qc/item_ammo.qc
   M /trunk/dpmod/qc/item_armor.qc
   M /trunk/dpmod/qc/item_artifacts.qc
   M /trunk/dpmod/qc/item_backpacks.qc
   M /trunk/dpmod/qc/item_health.qc
   M /trunk/dpmod/qc/item_keys.qc
   M /trunk/dpmod/qc/item_legacystuff.qc
   M /trunk/dpmod/qc/item_sigil.qc
   M /trunk/dpmod/qc/item_weapons.qc
   M /trunk/dpmod/qc/itemstuff.qc
   M /trunk/dpmod/qc/lag.qc
   M /trunk/dpmod/qc/lightning.qc
   M /trunk/dpmod/qc/localdamage.qc
   M /trunk/dpmod/qc/m_boss.qc
   M /trunk/dpmod/qc/m_demon.qc
   M /trunk/dpmod/qc/m_dog.qc
   M /trunk/dpmod/qc/m_enforcer.qc
   M /trunk/dpmod/qc/m_fish.qc
   M /trunk/dpmod/qc/m_hknight.qc
   M /trunk/dpmod/qc/m_knight.qc
   M /trunk/dpmod/qc/m_monsters.qc
   M /trunk/dpmod/qc/m_ogre.qc
   M /trunk/dpmod/qc/m_oldone.qc
   M /trunk/dpmod/qc/m_shalrath.qc
   M /trunk/dpmod/qc/m_shambler.qc
   M /trunk/dpmod/qc/m_soldier.qc
   M /trunk/dpmod/qc/m_tarbaby.qc
   M /trunk/dpmod/qc/m_wizard.qc
   M /trunk/dpmod/qc/m_zombie.qc
   M /trunk/dpmod/qc/mine.qc
   M /trunk/dpmod/qc/misc.qc
   M /trunk/dpmod/qc/mode_elimination.qc
   M /trunk/dpmod/qc/mode_management.qc
   M /trunk/dpmod/qc/modedefs.qc
   M /trunk/dpmod/qc/music.qc
   M /trunk/dpmod/qc/plats.qc
   M /trunk/dpmod/qc/player.qc
   M /trunk/dpmod/qc/playermovement.qc
   M /trunk/dpmod/qc/raddamage.qc
   M /trunk/dpmod/qc/rain.qc
   M /trunk/dpmod/qc/regen.qc
   M /trunk/dpmod/qc/rotate.qc
   M /trunk/dpmod/qc/shake.qc
   M /trunk/dpmod/qc/spike.qc
   M /trunk/dpmod/qc/spotlights.qc
   M /trunk/dpmod/qc/sprintnumdigits.qc
   M /trunk/dpmod/qc/sqrt.qc
   M /trunk/dpmod/qc/stats.qc
   M /trunk/dpmod/qc/subs.qc
   M /trunk/dpmod/qc/superdamagesound.qc
   M /trunk/dpmod/qc/t_damage.qc
   M /trunk/dpmod/qc/t_radiusdamage.qc
   M /trunk/dpmod/qc/teamplay.qc
   M /trunk/dpmod/qc/think.qc
   M /trunk/dpmod/qc/trig_original.qc
   M /trunk/dpmod/qc/trig_playercount.qc
   M /trunk/dpmod/qc/trig_stuffcmd.qc
   M /trunk/dpmod/qc/trig_ticker.qc
   M /trunk/dpmod/qc/util.qc
   M /trunk/dpmod/qc/visibleweapons.qc
   M /trunk/dpmod/qc/w_defs.qc
   M /trunk/dpmod/qc/w_grapple.qc
   M /trunk/dpmod/qc/waypoint_spawnformap.qc
   M /trunk/dpmod/qc/world.qc
   M /trunk/dpmod/qc/xplowall.qc

fix newlines

------------------------------------------------------------------------
r4028 | havoc | 2004-03-15 16:30:49 -0800 (Mon, 15 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/todo

doubled brightness of most dlights, and halved brightness of lightmap dlight rendering, this should make dlights and rtlights look mostly the same

------------------------------------------------------------------------
r4027 | havoc | 2004-03-15 16:27:51 -0800 (Mon, 15 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_light.c

added a note to optimize the MAX_DLIGHTS loop somehow

------------------------------------------------------------------------
r4026 | havoc | 2004-03-15 15:49:18 -0800 (Mon, 15 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

optimized R_Mesh_State to only update most settings if there is an active texture on the unit

------------------------------------------------------------------------
r4025 | molivier | 2004-03-15 00:52:06 -0800 (Mon, 15 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.dsp
   M /trunk/darkplaces/makefile.inc
   D /trunk/darkplaces/ogg.c
   D /trunk/darkplaces/ogg.h
   M /trunk/darkplaces/snd_dma.c
   M /trunk/darkplaces/snd_mem.c
   A /trunk/darkplaces/snd_ogg.c
   A /trunk/darkplaces/snd_ogg.h

Renamed ogg.[ch] to snd_ogg.[ch]

------------------------------------------------------------------------
r4024 | havoc | 2004-03-15 00:24:46 -0800 (Mon, 15 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

enabled USETEXMATRIX because it wasn't broken after all (testing mistake made me think it was)

------------------------------------------------------------------------
r4023 | molivier | 2004-03-15 00:00:02 -0800 (Mon, 15 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/ogg.c
   M /trunk/darkplaces/snd_mem.c

Removed the little endian -> native endian conversion from the sound resampling function. The sound file reading functions now take care of that.

------------------------------------------------------------------------
r4022 | molivier | 2004-03-14 23:56:04 -0800 (Sun, 14 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_mem.c

Made use of the common functions BuffLittle{Short,Long} in "snd_mem.c" instead of reinventing the wheel. Made a few variables static in the process.

------------------------------------------------------------------------
r4021 | havoc | 2004-03-14 23:00:14 -0800 (Sun, 14 Mar 2004) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/todo

3d texcoords now must use rmeshstate_t.pointer_texcoord3f instead of pointer_texcoord, this allows texture matrices and such
implemented (broken and disabled) texture matrix optimizations in R_Shadow_RenderLighting, I'm still trying to figure out what is wrong

------------------------------------------------------------------------
r4020 | havoc | 2004-03-14 21:27:02 -0800 (Sun, 14 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

reorganized texture setup code in R_Shadow_RenderLighting to be cleaner, fixed CVA locking in voodoo1/2 paths (it was locked while the color array update was happening, no good)

------------------------------------------------------------------------
r4019 | havoc | 2004-03-14 01:58:53 -0800 (Sun, 14 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/todo

fixed 2d attenuation texturing (it was all black due to an attenuationz matrix bug)

------------------------------------------------------------------------
r4018 | havoc | 2004-03-14 01:50:52 -0800 (Sun, 14 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt

added a tip about using the color control menu to calibrate for proper quake viewing

------------------------------------------------------------------------
r4017 | havoc | 2004-03-13 21:31:45 -0800 (Sat, 13 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h

got rid of Cshader system as it really wasn't helping anything, now all surfaces types use one R_DrawSurfaceChain function, which calls the appropriate passes

------------------------------------------------------------------------
r4016 | havoc | 2004-03-13 15:50:03 -0800 (Sat, 13 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

don't draw lighting on sky and water

------------------------------------------------------------------------
r4015 | havoc | 2004-03-13 15:30:20 -0800 (Sat, 13 Mar 2004) | 5 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h
   M /trunk/darkplaces/todo

merged static and dynamic rtlight handling almost entirely (even uses DrawShadowVolume and DrawLight to generate cached meshes - however this currently lost the r_shadow_portallight optimizations)
added a surfacelist to model_t containing surface indices for each submodel
merged R_Shadow_DiffuseLighting and R_Shadow_SpecularLighting into R_Shadow_RenderLighting (which takes a lighting parameter containing LIGHTING_DIFFUSE and LIGHTING_SPECULAR flags)
commented out cullradius/cullradius2 in rtlight structs because they weren't used

------------------------------------------------------------------------
r4014 | havoc | 2004-03-13 15:26:17 -0800 (Sat, 13 Mar 2004) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_sky.c

added texmatrix[] to rmeshstate_t and removed R_Mesh_TextureMatrix function
reorganized water rendering code to make it a lot less confusing (especially the r_watershader code)

------------------------------------------------------------------------
r4013 | havoc | 2004-03-13 15:14:29 -0800 (Sat, 13 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c

fixed gl_paranoid warnings in R_DrawQueue

------------------------------------------------------------------------
r4012 | havoc | 2004-03-13 15:12:35 -0800 (Sat, 13 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/menu.c

fixed gl_paranoid warnings caused by gl_texture_anisotropy being less than 1, it is now bound to 1-128 range

------------------------------------------------------------------------
r4011 | black | 2004-03-13 06:43:04 -0800 (Sat, 13 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cmd.c

DP should read the config files correcly again now.

------------------------------------------------------------------------
r4010 | havoc | 2004-03-13 03:50:11 -0800 (Sat, 13 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r4009 | havoc | 2004-03-12 23:21:07 -0800 (Fri, 12 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h

added const to most parameters to Mod_ShadowMesh_AddMesh

------------------------------------------------------------------------
r4008 | havoc | 2004-03-12 23:12:13 -0800 (Fri, 12 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

q3bsp rendering now uses visframe instead of markframe, also removed some cruft in R_Q3BSP_DrawShadowVolume/R_Q3BSP_DrawLight

------------------------------------------------------------------------
r4007 | molivier | 2004-03-11 00:08:04 -0800 (Thu, 11 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/snd_oss.c

Changed the way DP detects and handles the CPU endianess. All the tests are done at compile time now. Tested on Win32 (MSVC6 and MinGW32), Linux and NetBSD; should also work on the other BSDs.

------------------------------------------------------------------------
r4006 | havoc | 2004-03-10 16:43:46 -0800 (Wed, 10 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

removed special GAME_FNIGGIUM default for con_forcewhiledisconnected

------------------------------------------------------------------------
r4005 | havoc | 2004-03-10 13:40:02 -0800 (Wed, 10 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_lightning.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/todo

now calls GL_LockArrays manually around each R_Mesh_Draw call instead of locking inside R_Mesh_Draw, so some things can render the same geometry repeatedly (shadow volumes and lighting) without unlocking)

------------------------------------------------------------------------
r4004 | havoc | 2004-03-10 01:52:55 -0800 (Wed, 10 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

removed r_shadow_showtris (superseded by r_showtris)

------------------------------------------------------------------------
r4003 | havoc | 2004-03-10 01:48:53 -0800 (Wed, 10 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_lightning.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_sky.c

merged CL_ColorPointer into R_Mesh_State

------------------------------------------------------------------------
r4002 | havoc | 2004-03-10 00:35:53 -0800 (Wed, 10 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_lightning.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_sky.c

R_Mesh_State_Texture and GL_VertexPointer merge once again to become the reborn R_Mesh_State function

------------------------------------------------------------------------
r4001 | havoc | 2004-03-09 23:43:41 -0800 (Tue, 09 Mar 2004) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_lightning.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_sky.c

GL_Color no longer interacts with GL_ColorPointer (so be sure to set GL_ColorPointer if it have been left on something you don't want)
GL_ColorPointer now resets glColor when array is turned off, because glColor gets trashed while color array is on (so sayeth the GL spec, and so proveth the NVIDIA driver)

------------------------------------------------------------------------
r4000 | havoc | 2004-03-09 23:14:24 -0800 (Tue, 09 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/todo
   M /trunk/darkplaces/vid_shared.c

now supports GL_EXT_stencil_two_side extension (found on NV30/R300 class cards), this halves the polycount thrown at the card for shadow volumes, which got me a 77% speed gain on my GFFX5200

------------------------------------------------------------------------
r3998 | havoc | 2004-03-09 22:34:43 -0800 (Tue, 09 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c

sorted extension list again

------------------------------------------------------------------------
r3997 | havoc | 2004-03-09 22:33:22 -0800 (Tue, 09 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/todo

added DP_SV_ROTATINGBMODEL extension to list

------------------------------------------------------------------------
r3996 | havoc | 2004-03-09 22:20:56 -0800 (Tue, 09 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt

added a few items to the client features list

------------------------------------------------------------------------
r3995 | havoc | 2004-03-09 22:17:56 -0800 (Tue, 09 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_demo.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/todo

added -benchmark commandline option

------------------------------------------------------------------------
r3994 | havoc | 2004-03-09 21:51:53 -0800 (Tue, 09 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/sbar.c
   M /trunk/darkplaces/screen.h

added showtime/showtime_format and showdate/showdate_format cvars, and moved the fps display to bottom right corner (above the optional time/date displays)

------------------------------------------------------------------------
r3993 | havoc | 2004-03-09 21:48:41 -0800 (Tue, 09 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/sys.h
   M /trunk/darkplaces/sys_shared.c

added convenience function Sys_TimeString which calls strftime into a temporary buffer and returns the string, now Sys_Print uses this

------------------------------------------------------------------------
r3992 | havoc | 2004-03-09 21:47:18 -0800 (Tue, 09 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.h

added an extern for cmdline cvar

------------------------------------------------------------------------
r3991 | havoc | 2004-03-09 19:28:04 -0800 (Tue, 09 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cd_bsd.c
   M /trunk/darkplaces/cd_linux.c
   M /trunk/darkplaces/cd_shared.c
   M /trunk/darkplaces/cd_win.c
   M /trunk/darkplaces/cl_demo.c
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/cmd.h
   M /trunk/darkplaces/collision.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/conproc.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/console.h
   M /trunk/darkplaces/cvar.c
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/fs.h
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/jpeg.c
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/lhnet.c
   M /trunk/darkplaces/mathlib.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/ogg.c
   M /trunk/darkplaces/palette.c
   M /trunk/darkplaces/portals.c
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/pr_exec.c
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/prvm_exec.c
   M /trunk/darkplaces/r_lerpanim.c
   M /trunk/darkplaces/r_modules.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/screen.h
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/snd_alsa_0_5.c
   M /trunk/darkplaces/snd_alsa_0_9.c
   M /trunk/darkplaces/snd_bsd.c
   M /trunk/darkplaces/snd_dma.c
   M /trunk/darkplaces/snd_mem.c
   M /trunk/darkplaces/snd_mix.c
   M /trunk/darkplaces/snd_oss.c
   M /trunk/darkplaces/snd_win.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sv_user.c
   M /trunk/darkplaces/sys.h
   M /trunk/darkplaces/sys_linux.c
   M /trunk/darkplaces/sys_sdl.c
   M /trunk/darkplaces/sys_shared.c
   M /trunk/darkplaces/sys_win.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_sdl.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c
   M /trunk/darkplaces/wad.c
   M /trunk/darkplaces/zone.c

added Print versions of Printf functions and made all calls that do not need formating use the Print versions; yes this is a cosmetic cleanup, prints are too rare to have any performance improvements.

------------------------------------------------------------------------
r3990 | havoc | 2004-03-09 16:06:05 -0800 (Tue, 09 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

clean up an unnecessary snprintf

------------------------------------------------------------------------
r3989 | havoc | 2004-03-09 14:25:44 -0800 (Tue, 09 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/todo

added scr_conforcewhiledisconnected cvar so it is possible to disable the console forcing (and defaults off in GAME_FNIGGIUM)

------------------------------------------------------------------------
r3988 | havoc | 2004-03-09 14:14:07 -0800 (Tue, 09 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/todo

"edict" command no longer crashes if given -1 as edict number

------------------------------------------------------------------------
r3987 | havoc | 2004-03-09 13:59:59 -0800 (Tue, 09 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r3986 | havoc | 2004-03-09 13:56:49 -0800 (Tue, 09 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

reorganized SV_FlyMove to merge the two paths (new simple/old complex approaches)

------------------------------------------------------------------------
r3985 | havoc | 2004-03-09 12:35:51 -0800 (Tue, 09 Mar 2004) | 4 lines
Changed paths:
   M /trunk/darkplaces/collision.c

worked around curve collision problems by doing special sort-of-axial edge planes on triangle collisions (ultimately the collision routine needs to do edge/edge collisions somehow to make this unnecessary)
now snaps triangle mesh vertices to 1/32 of a unit precision to keep the plane calculations a little more accurate (note: this is done at collision time), although this doesn't seem to be necessary
collision nudge values are now configurable via cvars (collision_ cvars, warning: things tend to break if startnudge != endnudge, and enternudge should be the same as leavenudge)

------------------------------------------------------------------------
r3982 | havoc | 2004-03-08 20:59:14 -0800 (Mon, 08 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_sky.c

now supports loading skybox specified by q3 sky shaders

------------------------------------------------------------------------
r3981 | havoc | 2004-03-08 20:56:04 -0800 (Mon, 08 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

fix saving of rtlights files (everything past cubemap was getting lost)

------------------------------------------------------------------------
r3979 | havoc | 2004-03-07 00:15:17 -0800 (Sun, 07 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

fix two signed/unsigned comparison warnings

------------------------------------------------------------------------
r3978 | havoc | 2004-03-06 17:06:17 -0800 (Sat, 06 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r3976 | havoc | 2004-03-05 18:09:08 -0800 (Fri, 05 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r3975 | havoc | 2004-03-05 17:54:44 -0800 (Fri, 05 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c

con_notify is now measured in cl.time, not realtime, so cl_avidemo doesn't have terribly brief notify messages in it when rendering slowly

------------------------------------------------------------------------
r3974 | molivier | 2004-03-05 05:12:52 -0800 (Fri, 05 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

Don't use coronas for muzzleflashes

------------------------------------------------------------------------
r3973 | havoc | 2004-03-04 21:01:02 -0800 (Thu, 04 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/view.c

no view tilt when dead in GAME_FNIGGIUM

------------------------------------------------------------------------
r3972 | havoc | 2004-03-04 18:27:13 -0800 (Thu, 04 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fixed noclipping rendering nothing (there was no vis update)

------------------------------------------------------------------------
r3971 | havoc | 2004-03-04 18:11:22 -0800 (Thu, 04 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cmd.c

improve console text parsing a little (now handles \r line endings as well as \n, and strips whitespace before the line, just for completeness)

------------------------------------------------------------------------
r3970 | havoc | 2004-03-04 11:12:12 -0800 (Thu, 04 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/world.c

fix monsters ignoring player underwater if a bmodel is in the area (inopen was being set by bmodels)

------------------------------------------------------------------------
r3967 | molivier | 2004-03-04 05:17:37 -0800 (Thu, 04 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

Fixed key bindings menu (we have a range of 1024 key numbers now)

------------------------------------------------------------------------
r3966 | molivier | 2004-03-04 05:14:53 -0800 (Thu, 04 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/curves.c
   M /trunk/darkplaces/gl_backend.c

Removed a few warnings in MSVC6

------------------------------------------------------------------------
r3965 | havoc | 2004-03-03 23:06:00 -0800 (Wed, 03 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h

separate collision curve geometry from rendering, this means lower detail collision curves for more performance

------------------------------------------------------------------------
r3964 | havoc | 2004-03-03 22:20:20 -0800 (Wed, 03 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/curves.c
   M /trunk/darkplaces/curves.h
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/todo

implemented r_subdivisions_ cvars to control q3bsp patches, adaptive LOD based on flatness, etc

------------------------------------------------------------------------
r3963 | havoc | 2004-03-03 18:11:03 -0800 (Wed, 03 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

fix r_editlights_edit not accepting some commands

------------------------------------------------------------------------
r3962 | havoc | 2004-03-03 17:27:46 -0800 (Wed, 03 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

r_showtris is now a float cvar which controls intensity, rather than just a flag

------------------------------------------------------------------------
r3961 | havoc | 2004-03-03 07:26:27 -0800 (Wed, 03 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/render.h

made r_showtris transparent (quite faint actually), color coded different types of geometry, and now shows all tris (even hud), cleaned up a few qgl calls (GL_Clear added, etc) to make it more reliable

------------------------------------------------------------------------
r3960 | havoc | 2004-03-02 23:05:05 -0800 (Tue, 02 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fix Q3BSP submodels to have no GetPVS function (or assorted other functions which would fail)

------------------------------------------------------------------------
r3959 | havoc | 2004-03-02 22:50:56 -0800 (Tue, 02 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/todo

fixed bmodel realtime lighting/shadowing render crashes (and bogus shadows from them)

------------------------------------------------------------------------
r3958 | havoc | 2004-03-02 22:00:42 -0800 (Tue, 02 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/todo

added r_showtris

------------------------------------------------------------------------
r3957 | havoc | 2004-03-02 21:25:07 -0800 (Tue, 02 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/todo

realtime dlight shadows are now nearly the speed of compiled lights

------------------------------------------------------------------------
r3956 | havoc | 2004-03-02 12:29:58 -0800 (Tue, 02 Mar 2004) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h
   M /trunk/darkplaces/todo

temporarily disabled compiled rtlights (they'll make a comeback after dynamic rtlight optimizations are finished)
dynamic rtlight shadow volumes for bmodels are now generated from a single mesh for the entire model, in which only some ranges of triangles are marked, this finally cured the performance problems with dlight
s

------------------------------------------------------------------------
r3955 | havoc | 2004-03-01 21:34:58 -0800 (Mon, 01 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

fix rtlights cubemapname load/save

------------------------------------------------------------------------
r3953 | havoc | 2004-03-01 18:27:59 -0800 (Mon, 01 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

fix the inverted bumps on some surfaces (no longer uses CrossProduct to get the svector)

------------------------------------------------------------------------
r3949 | havoc | 2004-03-01 16:26:59 -0800 (Mon, 01 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

forgot to init the effects variable in the light parser

------------------------------------------------------------------------
r3947 | havoc | 2004-03-01 16:22:31 -0800 (Mon, 01 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/todo

dlights using light_lev now need the PFLAG_FULLDYNAMIC flag set to operate, otherwise they are ignored, this was necessary (lights that did not remove themselves were being treated as proper dlights), it is also now more tenebrae compatible (EF_FULLDYNAMIC translated to PFLAG_FULLDYNAMIC in GAME_TENEBRAE mode)

------------------------------------------------------------------------
r3946 | havoc | 2004-03-01 10:56:32 -0800 (Mon, 01 Mar 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/render.h

more cleanups of R_RenderScene (now r_view_ variables exist which are copied from the r_refdef fields each frame, these variables can easily be reconfigured for texture renders for mirrors or whatever)

------------------------------------------------------------------------
r3945 | havoc | 2004-02-29 21:03:46 -0800 (Sun, 29 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/view.c

remove unused variable i in V_ParseDamage

------------------------------------------------------------------------
r3944 | havoc | 2004-02-29 21:01:36 -0800 (Sun, 29 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

remove unused variable i in CL_ParseStartSoundPacket

------------------------------------------------------------------------
r3943 | havoc | 2004-02-29 20:59:51 -0800 (Sun, 29 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/todo

screenshots are now saved to screenshots/ and videos are now saved to video/, and both now use the name template dp%06d.tga or .jpg, GAME_FNIGGIUM uses fniggium%06d.tga or .jpg as per Sajt's request

------------------------------------------------------------------------
r3942 | havoc | 2004-02-29 20:29:38 -0800 (Sun, 29 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/todo

fixed cubemap upload scaling crash (was using power of 2 size for parsing input, should have used input size)

------------------------------------------------------------------------
r3941 | havoc | 2004-02-29 20:20:33 -0800 (Sun, 29 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/todo

fixed viewblends which were broken the past few days

------------------------------------------------------------------------
r3940 | havoc | 2004-02-29 19:49:14 -0800 (Sun, 29 Feb 2004) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/todo
   M /trunk/darkplaces/view.c

upgraded network protocol to DP5, now sends precise entity angles (except for EF_LOWPRECISION entities), this increases normal entity data by 3 bytes (18 bytes for origin+angles, was 15 bytes in DP4, still 9 bytes for EF_LOWPRECISION origin+angles), upgraded a few other parts of protocol to precise angles and/or floats as well (client data updates now use float for punchvector and velocity
)

------------------------------------------------------------------------
r3939 | havoc | 2004-02-29 17:58:02 -0800 (Sun, 29 Feb 2004) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_light.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/todo

cleaned up rtlight handling, merging most code between world rtlights and dlights (which now could conceivably be compiled if static)
moved R_ShadowVolumeLighting to r_shadow.c
added RENDER_LIGHT flag to entity_render_t to make rtlighting optional per entity

------------------------------------------------------------------------
r3938 | havoc | 2004-02-29 17:54:54 -0800 (Sun, 29 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/progs.h

forgot to commit this as part of the SV_TouchAreaGrid fix

------------------------------------------------------------------------
r3937 | havoc | 2004-02-29 17:46:35 -0800 (Sun, 29 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/world.c

fixed SV_TouchAreaGrid to not crash if SV_IncreaseEdicts is called during a touch function, by making a list of edicts to touch and then running through the list afterward

------------------------------------------------------------------------
r3936 | havoc | 2004-02-29 17:29:43 -0800 (Sun, 29 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

safety checked lightmap access in Mod_Q1BSP_RecursiveLightPoint as one map Sajt uses was crashing, it now rounds off coords to be inside the lightmap

------------------------------------------------------------------------
r3935 | havoc | 2004-02-28 07:41:43 -0800 (Sat, 28 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c

default a few cvars accordingly for GAME_TENEBRAE mode

------------------------------------------------------------------------
r3934 | havoc | 2004-02-28 07:18:21 -0800 (Sat, 28 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

support angles on light entities

------------------------------------------------------------------------
r3933 | havoc | 2004-02-28 07:15:55 -0800 (Sat, 28 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

support skin and pflags in light entity loader

------------------------------------------------------------------------
r3931 | havoc | 2004-02-26 11:28:15 -0800 (Thu, 26 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo
   M /trunk/darkplaces/world.c

PF_traceline/PF_tracebox can now use world as the edict

------------------------------------------------------------------------
r3930 | havoc | 2004-02-26 11:25:38 -0800 (Thu, 26 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/todo

made the static light built message a dprint

------------------------------------------------------------------------
r3929 | havoc | 2004-02-25 18:06:11 -0800 (Wed, 25 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

TEU uses teu.rc, not quake.rc

------------------------------------------------------------------------
r3926 | havoc | 2004-02-25 10:42:31 -0800 (Wed, 25 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/todo

renamed brush model pvs stuff to be in brush struct instead of brushq1 and brushq3 structs

------------------------------------------------------------------------
r3925 | havoc | 2004-02-25 10:41:19 -0800 (Wed, 25 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

MOVETYPE_BOUNCE change: an explosion above gibs will now cause them to bounce into the air, rather than skidding to a halt immediately like they were doing

------------------------------------------------------------------------
r3924 | havoc | 2004-02-25 04:42:41 -0800 (Wed, 25 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c

enable MOVE_ values on PF_tracebox (already enabled on PF_traceline)

------------------------------------------------------------------------
r3923 | havoc | 2004-02-24 09:10:27 -0800 (Tue, 24 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/todo

fixed black fullbrights on models in realtime mode

------------------------------------------------------------------------
r3922 | havoc | 2004-02-22 10:56:51 -0800 (Sun, 22 Feb 2004) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/portals.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h
   M /trunk/darkplaces/todo

fixed GL_Scissor call in rtlight code (apparently I need to feed it a top to bottom rectangle... ?  must be something weird in the transform math as GL uses bottom to top)
made q1bsp and q3bsp a little more alike (regarding pvs clusters), now q3bsp has all the same pvs cluster fields as q3bsp
added fake lightgrid and pvs data to q3bsp loading when map is unlit or unvised respectively, this should improve internal consistency

------------------------------------------------------------------------
r3921 | havoc | 2004-02-22 09:09:13 -0800 (Sun, 22 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_user.c

allow "rate" command to be executed on server when sent from client

------------------------------------------------------------------------
r3920 | havoc | 2004-02-21 22:48:42 -0800 (Sat, 21 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/todo

fixed a possible crash in R_DrawCoronas (it was using rd->origin where it should have used wl->origin)

------------------------------------------------------------------------
r3919 | havoc | 2004-02-21 13:05:21 -0800 (Sat, 21 Feb 2004) | 9 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_light.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/screen.h
   M /trunk/darkplaces/todo

cleaned up R_RenderView setup code a bit, and shuffled SCR_CalcRefdef stuff to SCR_UpdateScreen
scissor is now on during all of R_RenderView (including rtlight portions), and GL_Scissor is used to set it instead of direct qglScissor calls, also GL_ScissorTest is used
r_farclip is now calculated without need for... just about anything, this allowed shuffling the setup code around a bit
various cleanups to allow multiple view renders per frame
added scr_zoomwindow cvars to do a (silly) zoomed view picture-in-picture overlay, it works but turned out useless in playtesting unless you want to stare at a shambler's chest... ugh
R_AnimateLight and R_BuildLightList merged to become R_UpdateLights
some setup code from R_RenderView became a new function R_UpdateWorld
GL_SetupView_ViewPort calls replaced by qglViewport calls, as it was a mostly useless wrapper

------------------------------------------------------------------------
r3918 | havoc | 2004-02-21 06:19:26 -0800 (Sat, 21 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_demo.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/todo

timedemo now also prints min/avg/max fps

------------------------------------------------------------------------
r3917 | havoc | 2004-02-21 04:51:19 -0800 (Sat, 21 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

added rate limiting to player setup menu

------------------------------------------------------------------------
r3916 | havoc | 2004-02-21 03:58:08 -0800 (Sat, 21 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_demo.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/netconn.h
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c

rate limited networking ("rate" command in client console, limited by sv_maxrate cvar on server), also cleaned up some of the MAX_DATAGRAM and similar defines (now only uses NET_MAXMESSAGE)

------------------------------------------------------------------------
r3915 | havoc | 2004-02-20 23:43:37 -0800 (Fri, 20 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/lhnet.c
   M /trunk/darkplaces/todo

cl_fakelocalping cvars now produce the specified ping time (rather than twice it) by lagging each way only 50% of the requested ping

------------------------------------------------------------------------
r3914 | havoc | 2004-02-20 23:39:41 -0800 (Fri, 20 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_sprite.c

remove unused stripextension code

------------------------------------------------------------------------
r3913 | havoc | 2004-02-20 23:37:36 -0800 (Fri, 20 Feb 2004) | 9 lines
Changed paths:
   M /trunk/darkplaces/cgame_api.h
   M /trunk/darkplaces/cgamevm.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_light.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/todo

moved light matrix generation out of the render code and into the light creation code (rtlight and dlight setup) to save time and simplify things
rtlights and dlights now have an orientation matrix (this allows cubemaps to be rotated)
rtlights can now have corona flares, and it is adjustable per light (also on dlights)
r_coronas cvar now controls corona intensity, and menu now has r_coronas slider instead of checkbox
dlights now have color[]/radius settings instead of just colored intensity, so the radius can be independently controlled again (this mainly improves realtime dlight behaviors)
dlights can now have cubemaps, light styles, optional shadows (rather than always on), and better color/radius settings (and all this is tenebrae compatible) using the light_lev, color, style, skin (cubemap number, only available if modelindex is 0), and pflags (1 is no shadow, 2 is draw corona which is ignored by darkplaces because it always draws a corona) fields in the quakec entities
now supports tenebrae dlight fields (light_lev, color, style, pflags), this means dlights can now have cubemaps (skin, only used if modelindex is 0), light style (style), color (color) and radius (light_lev) with more precision than glow_ fields, and pflags (flag 1 is no shadow, flag 2 is corona which is ignored because dlights always have a corona in darkplaces), also loads tenebrae mods
added TENEBRAE_GFX_DLIGHTS extension

------------------------------------------------------------------------
r3912 | havoc | 2004-02-20 09:04:03 -0800 (Fri, 20 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_sprite.c

fixed loading of replacement frame images (it was stripping the .spr extension, weird), and reduced spr internal image handling code a bit by using a second alpha palette

------------------------------------------------------------------------
r3911 | havoc | 2004-02-20 08:31:03 -0800 (Fri, 20 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/image.h

upgraded Image_CopyMux to be able to output constant byte values as well as indexed components

------------------------------------------------------------------------
r3910 | havoc | 2004-02-20 08:15:40 -0800 (Fri, 20 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

possible improvement to infinite perspective matrix generation

------------------------------------------------------------------------
r3909 | havoc | 2004-02-19 18:50:18 -0800 (Thu, 19 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

remove the exec default.cfg call from the reset to defaults, I have no idea why it was there

------------------------------------------------------------------------
r3907 | havoc | 2004-02-18 06:46:06 -0800 (Wed, 18 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

improved error message for missing cubemap images, no longer complains during cubemap loading, as long as one or more sides are found

------------------------------------------------------------------------
r3906 | havoc | 2004-02-18 06:37:36 -0800 (Wed, 18 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

now loads each cubemap only once, no matter how many lights use it

------------------------------------------------------------------------
r3905 | havoc | 2004-02-18 06:06:38 -0800 (Wed, 18 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/image.h
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/todo

cubemap filters for rtlights are now supported

------------------------------------------------------------------------
r3904 | havoc | 2004-02-18 02:32:06 -0800 (Wed, 18 Feb 2004) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h
   M /trunk/darkplaces/todo

added gl_lightmaps cvar (for looking at the raw lightmaps in the map without textures)
added r_shadow_realtime_world_lightmaps cvar (turn on/off lightmaps in r_shadow_realtime_world mode, also can be a fraction to control brightness)

------------------------------------------------------------------------
r3903 | havoc | 2004-02-18 02:29:30 -0800 (Wed, 18 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/keys.c

fix some warnings

------------------------------------------------------------------------
r3898 | havoc | 2004-02-16 18:13:34 -0800 (Mon, 16 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

reduced size of viewblend triangle from 64000 units to 64 units, in hopes of curing precision problems on some graphics cards (NVIDIA and ATI both) causing a missing line on the blend

------------------------------------------------------------------------
r3895 | black | 2004-02-12 08:50:06 -0800 (Thu, 12 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

Forgot to add a couple of return statements to a switch block.

------------------------------------------------------------------------
r3894 | black | 2004-02-11 10:56:43 -0800 (Wed, 11 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.h

Fixed: Removed not needed variable.

------------------------------------------------------------------------
r3893 | black | 2004-02-11 09:43:27 -0800 (Wed, 11 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cvar.h
   M /trunk/darkplaces/menu.h
   M /trunk/darkplaces/prvm_cmds.c

Added some menu builtins and changed VM_registercvar (it takes one parameter more now).

------------------------------------------------------------------------
r3892 | molivier | 2004-02-10 23:25:20 -0800 (Tue, 10 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_dma.c
   M /trunk/darkplaces/snd_mem.c
   M /trunk/darkplaces/sound.h

Added automatic unloading of unused sounds. The "silentlymissing" boolean is now part of a flags bit field in the "sfx_t" structure.

------------------------------------------------------------------------
r3891 | molivier | 2004-02-10 23:22:09 -0800 (Tue, 10 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/ui.c

Commented out some unused static functions in "ui.c" to get rid of GCC warnings

------------------------------------------------------------------------
r3890 | molivier | 2004-02-10 23:20:58 -0800 (Tue, 10 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/mingw_note.txt

Updated the MinGW note according to the new makefiles

------------------------------------------------------------------------
r3889 | molivier | 2004-02-10 23:20:15 -0800 (Tue, 10 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_null.c

I forgot to add the new sound functions to "snd_null.c"

------------------------------------------------------------------------
r3888 | havoc | 2004-02-10 13:09:57 -0800 (Tue, 10 Feb 2004) | 3 lines
Changed paths:
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/keys.h

change joystick key numbers to start at 768 instead of 1024 (this gives 512 keys, 256 mouse, 256 joystick)
enlarge various key arrays to hold 1024 keys

------------------------------------------------------------------------
r3887 | havoc | 2004-02-10 12:54:54 -0800 (Tue, 10 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt

corrections and additions

------------------------------------------------------------------------
r3886 | havoc | 2004-02-10 12:54:20 -0800 (Tue, 10 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

recalculate farclip immediately before rendering, instead of from the previous frame, cures some quick turn glitches

------------------------------------------------------------------------
r3885 | black | 2004-02-10 08:03:44 -0800 (Tue, 10 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/keys.h

The mouse buttons now use the range 512 - 1023 and the joystick/aux stuff starts at 1024. I **hope** this won't be changed as I've just fixed the msys.qc.

------------------------------------------------------------------------
r3884 | molivier | 2004-02-09 23:14:03 -0800 (Mon, 09 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/snd_dma.c
   M /trunk/darkplaces/snd_mem.c
   M /trunk/darkplaces/snd_null.c
   M /trunk/darkplaces/sound.h

Added a couple of function skeletons for the automatic unloading of unused sounds (coming very soon). Removed the empty functions S_BeginPrecaching, S_EndPrecaching and S_ClearPrecache. I broke the "silentlymissing" sound flag recently, it could be set even if the sound was successfully loaded (this flag doesn't seem to be used in any active part of the code, but until I sort this out it's better to have it right); anyhow it's fixed now. Switched "silentlymissing"'s type to "qboolean" in the process. Fixed an implicit conversion warning when calling Sys_Sleep in MSVC6.

------------------------------------------------------------------------
r3883 | molivier | 2004-02-09 01:26:45 -0800 (Mon, 09 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

The test used in the FS_Read function to detect the end of a compressed file was incorrect, causing some big files to be truncated when unzipped. Many thanks to Fuh for poiting out this mistake to me

------------------------------------------------------------------------
r3882 | havoc | 2004-02-08 23:08:45 -0800 (Sun, 08 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

fix a particle trail bug with freshly spawned entities that leave a trail, I don't really understand how this bug happens (or why it doesn't happen all the time), but it is fixed

------------------------------------------------------------------------
r3881 | havoc | 2004-02-08 21:50:53 -0800 (Sun, 08 Feb 2004) | 4 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

changed shader parsing to use strcasecmp just incase some shader has a weird case on the surfaceparms
made some of the q3bsp warnings use dprintf because they're probably annoying users
switched to simpler tracebrush bsp recursion code (the old code crashed for me occasionally, but I've been unable to reproduce that problem again, so I guess it's fixed too, or something)

------------------------------------------------------------------------
r3880 | havoc | 2004-02-08 21:21:04 -0800 (Sun, 08 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

fix video modes menu to not let you select the extra 0x0 mode

------------------------------------------------------------------------
r3879 | havoc | 2004-02-08 11:02:24 -0800 (Sun, 08 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

added Willis's dpmaster to list

------------------------------------------------------------------------
r3878 | havoc | 2004-02-06 13:36:30 -0800 (Fri, 06 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt

trying to make this binary

------------------------------------------------------------------------
r3877 | havoc | 2004-02-06 13:30:18 -0800 (Fri, 06 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt

DOS line endings, and now marked binary (I hope)

------------------------------------------------------------------------
r3876 | havoc | 2004-02-06 10:48:19 -0800 (Fri, 06 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.txt
   M /trunk/darkplaces/todo

updated readme

------------------------------------------------------------------------
r3875 | havoc | 2004-02-06 10:45:46 -0800 (Fri, 06 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

increased numverts/numtris/skinwidth/skinheight limits to 65536, and made r_fullbrights affect model skins

------------------------------------------------------------------------
r3874 | havoc | 2004-02-05 21:24:44 -0800 (Thu, 05 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h
   M /trunk/darkplaces/todo

renamed r_shadow_shadows to r_shadow_dlightshadows and added r_shadow_worldshadows cvar

------------------------------------------------------------------------
r3873 | havoc | 2004-02-05 21:22:17 -0800 (Thu, 05 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h

fixed Mod_Q3BSP_BoxTouchingPVS to handle unvised maps properly

------------------------------------------------------------------------
r3872 | havoc | 2004-02-05 21:20:02 -0800 (Thu, 05 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c

rewrote PF_tokenize to not use memory allocations

------------------------------------------------------------------------
r3871 | havoc | 2004-02-05 21:18:17 -0800 (Thu, 05 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c

increased size of ditherpattern texture to try to work around the odd 'not black' dither bug (succeeded? yes, but no closer to figuring out why it was misbehaving in the first place)

------------------------------------------------------------------------
r3870 | havoc | 2004-02-05 21:17:08 -0800 (Thu, 05 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

gl_texturemode should not affect TEXF_FORCENEAREST and TEXF_FORCELINEAR textures

------------------------------------------------------------------------
r3869 | warp | 2004-02-05 20:55:54 -0800 (Thu, 05 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces
   M /trunk/darkplaces/.cvsignore
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/keys.h
   M /trunk/darkplaces/menu.c

This is your key system, this is your key system after being mostly replaced with Twilight's and then modified.

------------------------------------------------------------------------
r3868 | havoc | 2004-02-03 11:22:06 -0800 (Tue, 03 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

optimized BoxTouchingPVS code to no longer be recursive

------------------------------------------------------------------------
r3867 | havoc | 2004-02-02 20:52:39 -0800 (Mon, 02 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/image.c

support tga's with incomplete colormaps (less than 256 colors), I HOPE this is correct

------------------------------------------------------------------------
r3866 | havoc | 2004-02-02 18:16:13 -0800 (Mon, 02 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/keys.c

added some names for certain characters: ` backquote, ~ tilde, ' apostrophe, " quote (note that ` and ~ are not bindable anyway, hardwired in the engine)

------------------------------------------------------------------------
r3865 | coderjoe | 2004-02-02 07:02:19 -0800 (Mon, 02 Feb 2004) | 3 lines
Changed paths:
   M /trunk/darkplaces/vid_wgl.c

don't need to send WM_SETICON... just set the icon in the window class and
windows will take care of it.

------------------------------------------------------------------------
r3864 | havoc | 2004-02-02 06:55:05 -0800 (Mon, 02 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/sys_win.c
   M /trunk/darkplaces/vid_wgl.c

fix misplaced extern S_UnblockSound

------------------------------------------------------------------------
r3863 | black | 2004-02-02 06:47:20 -0800 (Mon, 02 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_dma.c

DS_OK used instead of DD_OK

------------------------------------------------------------------------
r3862 | coderjoe | 2004-02-02 06:44:04 -0800 (Mon, 02 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.dsp
   A /trunk/darkplaces/darkplaces.rc
   M /trunk/darkplaces/resource.h
   M /trunk/darkplaces/vid_wgl.c

get msvc using the new icon

------------------------------------------------------------------------
r3861 | havoc | 2004-02-02 06:41:20 -0800 (Mon, 02 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_wgl.c

cast the char array to unsigned short in the ToAscii call, because windows is insane enough to make it take an unsigned short *, even though it writes byte chars to it

------------------------------------------------------------------------
r3860 | havoc | 2004-02-02 06:37:56 -0800 (Mon, 02 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_dma.c
   M /trunk/darkplaces/snd_win.c
   M /trunk/darkplaces/sys_win.c
   M /trunk/darkplaces/todo
   M /trunk/darkplaces/vid_wgl.c
   D /trunk/darkplaces/winquake.h

winquake.h is gone, absorbed into the respective files which used it, also cleaned out all unneeded winquake.h cruft

------------------------------------------------------------------------
r3859 | havoc | 2004-02-02 06:04:30 -0800 (Mon, 02 Feb 2004) | 2 lines
Changed paths:
   A /trunk/darkplaces/darkplaces.ico
   A /trunk/darkplaces/darkplaces16x16.png
   A /trunk/darkplaces/darkplaces24x24.png
   A /trunk/darkplaces/darkplaces32x32.png
   A /trunk/darkplaces/darkplaces48x48.png
   A /trunk/darkplaces/darkplaces64x64.png
   A /trunk/darkplaces/darkplaces72x72.png

thanks to de-we for these great icons (I have not figured out how to use them yet, though)

------------------------------------------------------------------------
r3858 | havoc | 2004-02-02 05:22:40 -0800 (Mon, 02 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/todo

fixing up rtlight handling a bit (now always runs the dynlight stage which has been renamed rtlights stage in the r_speeds report)

------------------------------------------------------------------------
r3857 | havoc | 2004-02-02 05:09:30 -0800 (Mon, 02 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/makefile.bsd
   A /trunk/darkplaces/makefile.inc

thanks to Mathieu Olivier for these new makefiles

------------------------------------------------------------------------
r3856 | havoc | 2004-02-02 04:45:11 -0800 (Mon, 02 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_light.c

fix a logic bug in EntLight handling (should have been checking r_shadow_realtime_world not dlight or flashblend)

------------------------------------------------------------------------
r3855 | havoc | 2004-02-01 20:32:50 -0800 (Sun, 01 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

fixed sv_freezenonclients (now freezes time as well)

------------------------------------------------------------------------
r3854 | havoc | 2004-02-01 20:06:30 -0800 (Sun, 01 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/collision.c

forgot to init enterfrac2 in the TraceLineBrushFloat code

------------------------------------------------------------------------
r3853 | havoc | 2004-02-01 19:56:38 -0800 (Sun, 01 Feb 2004) | 9 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/collision.c
   M /trunk/darkplaces/collision.h
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/todo
   M /trunk/darkplaces/world.c

added trace.realfraction field which is now used for comparisons instead of fraction, this allows proper detection of the nearest blocker without the glitches previously seen sometimes on brush-brush boundaries (where the expanded side boundary was closer than the floor it was part of)
optimized q3bsp point traces (point, not line)
optimized q3bsp line traces (finally got that code working, and added optimized line-triangle tracing code for curves which is 52% faster)
optimized q3bsp brush traces (or tried to...  seems to be slower unfortunately, more work to do on this in the future)
BrushForBox now sets the mins/maxs of the brush for culling
reduced q3mnode_t structure by 4 bytes (checks plane pointer now instead of a dedicated isnode variable)
cleaned up some collision code a bit
added some TargetQuake workarounds (spew warnings instead of crashing to console) for weird physics settings (like MOVETYPE_PUSH and SOLID_BSP with no model)

------------------------------------------------------------------------
r3852 | havoc | 2004-02-01 19:36:11 -0800 (Sun, 01 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

added sv_freezenonclients cvar, fixed the bug that caused falling damage when standing on a sloped floor pushing you into a wall, and cleaned up a few other things a bit

------------------------------------------------------------------------
r3851 | havoc | 2004-02-01 18:43:21 -0800 (Sun, 01 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_shadow.c

now always uses glPolygonOffset, and collision brush rendering has been fixed with better glPolygonOffset settings (no more flicker), also uses glPolygonOffset on shadow volumes now (but this probably has any effect in any cases I know of)

------------------------------------------------------------------------
r3850 | havoc | 2004-02-01 18:28:40 -0800 (Sun, 01 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/mathlib.c
   M /trunk/darkplaces/mathlib.h

added several BoxPlane comparison functions to find information on corners relative to the plane (rather than merely checking which side it is on)

------------------------------------------------------------------------
r3849 | havoc | 2004-02-01 18:21:52 -0800 (Sun, 01 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/pr_exec.c
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_exec.c

changed a lot of progs errors to warnings, and it prints QC status for warnings

------------------------------------------------------------------------
r3848 | havoc | 2004-02-01 14:40:39 -0800 (Sun, 01 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_lightning.c

reduced default r_lightningbeams_repeatdistance from 1024 to 128

------------------------------------------------------------------------
r3847 | havoc | 2004-02-01 14:30:51 -0800 (Sun, 01 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/sys.h
   M /trunk/darkplaces/sys_linux.c
   M /trunk/darkplaces/sys_sdl.c
   M /trunk/darkplaces/sys_win.c

changed Sys_Sleep from (void) to (int milliseconds), now wastes a lot less cpu time while waiting for the next frame

------------------------------------------------------------------------
r3846 | black | 2004-02-01 04:20:05 -0800 (Sun, 01 Feb 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

Only one player list is displayed now. Moved it a little bit down so if you set con_notify 2, it wont bother you any more.

------------------------------------------------------------------------
r3845 | havoc | 2004-01-31 15:04:13 -0800 (Sat, 31 Jan 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_wgl.c

handle funky ToAscii values (shift/ctrl/alt sometimes produce ascii values for no reason), and also ignore any 0 or 2 character values

------------------------------------------------------------------------
r3841 | molivier | 2004-01-27 01:08:55 -0800 (Tue, 27 Jan 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h

Slight improvement in the way we include the strl{cat,cpy} declarations and implementations into the code.

------------------------------------------------------------------------
r3840 | molivier | 2004-01-27 00:12:54 -0800 (Tue, 27 Jan 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_wgl.c

Don't allow a higher depth than the desktop when using a windowed mode on Win32. It seems X11 already forbids this.

------------------------------------------------------------------------
r3839 | havoc | 2004-01-26 22:13:40 -0800 (Mon, 26 Jan 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

use sys_ticrate timing on dedicated servers

------------------------------------------------------------------------
r3838 | havoc | 2004-01-26 00:57:04 -0800 (Mon, 26 Jan 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_shared.c

improved handling of video mode failures

------------------------------------------------------------------------
r3832 | havoc | 2004-01-23 17:00:11 -0800 (Fri, 23 Jan 2004) | 3 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/netconn.c

changed local server ports to 1 (server) and 2 (client), regardless of cl_port and port cvars
merged cl_netaddress and sv_netaddress into one net_address cvar

------------------------------------------------------------------------
r3831 | havoc | 2004-01-23 16:42:26 -0800 (Fri, 23 Jan 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/lhnet.c

fix a severe bug with the checking of WSAStartup (basically any socket after the first would fail for no reason)

------------------------------------------------------------------------
r3830 | havoc | 2004-01-23 02:03:13 -0800 (Fri, 23 Jan 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/lhnet.c
   M /trunk/darkplaces/lhnet.h
   M /trunk/darkplaces/netconn.c

disabled opening of ipv6 sockets since that code still isn't finished (this MIGHT fix win32 problems, not sure yet), and now prints error messages when socket/bind/ioctl calls fail

------------------------------------------------------------------------
r3827 | havoc | 2004-01-21 01:22:19 -0800 (Wed, 21 Jan 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

wrap angles on rotating pushers because large angle values are bad for precision

------------------------------------------------------------------------
r3823 | molivier | 2004-01-20 23:29:42 -0800 (Tue, 20 Jan 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/menu.c

Transfusion update: renamed the mod directory to "basetf" instead of "transfusion", and added 6 new maps.

------------------------------------------------------------------------
r3818 | havoc | 2004-01-20 13:03:38 -0800 (Tue, 20 Jan 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_shared.c

-safe now implies -window and disables all GL extensions that offer a disable option

------------------------------------------------------------------------
r3817 | molivier | 2004-01-20 05:18:49 -0800 (Tue, 20 Jan 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_mem.c

Added a check in the WAV loading code to make sure the file is a WAV file before proceeding. Thanks to Urre for pointing out this bug.

------------------------------------------------------------------------
r3815 | havoc | 2004-01-19 14:30:46 -0800 (Mon, 19 Jan 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

ignore visofs errors on leaf 0 (solid), thanks to Vic for pointing out the problem in qbsp itself

------------------------------------------------------------------------
r3813 | havoc | 2004-01-19 13:34:59 -0800 (Mon, 19 Jan 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

changed comment above FS_CreatePath

------------------------------------------------------------------------
r3810 | havoc | 2004-01-16 20:07:32 -0800 (Fri, 16 Jan 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r3808 | havoc | 2004-01-13 14:14:48 -0800 (Tue, 13 Jan 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_sprites.c

fixed a crash with r_lerpsprites 0 mode

------------------------------------------------------------------------
r3806 | black | 2004-01-12 10:48:36 -0800 (Mon, 12 Jan 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

Fixed findkeysforcommand hopefully.

------------------------------------------------------------------------
r3805 | molivier | 2004-01-11 23:38:15 -0800 (Sun, 11 Jan 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.bsd
   A /trunk/darkplaces/snd_bsd.c
   M /trunk/darkplaces/snd_dma.c

Added sound support to the NetBSD port. Most of the code comes from the original "snd_sun.c" file, by id Software. Some TODO remains, including the support for the "-snd*" options. Hopefully, the BSD specific code in DP works for the 3 majors BSD flavors, though I cannot test it on FreeBSD and OpenBSD anyway (feedback and test welcome if you have a BSD box at your disposal).

------------------------------------------------------------------------
r3804 | molivier | 2004-01-11 23:33:11 -0800 (Sun, 11 Jan 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_dma.c
   M /trunk/darkplaces/snd_win.c

Removed a few warnings when compiling with MinGW

------------------------------------------------------------------------
r3803 | havoc | 2004-01-11 19:54:29 -0800 (Sun, 11 Jan 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

don't try to upload distorttextures if the texture shader extension is missing

------------------------------------------------------------------------
r3802 | black | 2004-01-11 09:41:08 -0800 (Sun, 11 Jan 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

Added the findkeysforcommand builtin to the menu qc. It returns an altstring containing the keys which trigger the searched command.

------------------------------------------------------------------------
r3801 | black | 2004-01-11 09:35:27 -0800 (Sun, 11 Jan 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/ui.c
   M /trunk/darkplaces/ui.h

Hopefully finished the core of the new ui.

------------------------------------------------------------------------
r3781 | havoc | 2004-01-07 04:09:57 -0800 (Wed, 07 Jan 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c

rewrote COM_ParseToken and COM_ParseTokenConsole to make them buffer size safe (thanks to Vic for pointing out this problem), not that a rewrite was strictly necessary but it probably fixed unknown bugs

------------------------------------------------------------------------
r3780 | havoc | 2004-01-07 04:07:14 -0800 (Wed, 07 Jan 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c

fix a bad bug in developer printing of out of bounds fraction (crashed Con_Printf by giving it bad parameters)

------------------------------------------------------------------------
r3779 | knghtbrd | 2004-01-01 08:50:10 -0800 (Thu, 01 Jan 2004) | 4 lines
Changed paths:
   M /trunk/darkplaces/makefile
   A /trunk/darkplaces/sys_sdl.c
   A /trunk/darkplaces/vid_sdl.c

INCOMPLETE SDL video support (don't use it!)  No input, no multiple video
modes, no proper shutdown.  May not even compile anywher but my mac as of
yet.

------------------------------------------------------------------------
r3778 | knghtbrd | 2004-01-01 08:45:56 -0800 (Thu, 01 Jan 2004) | 5 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c

Undo moving cl_available.  This really doesn't belong in system-specific
video code, but it's the only place for that kind of thing unless someone
wants to make the dedicated DarkPlaces binary a lot less bloated.  Not on
my priority list right now.

------------------------------------------------------------------------
r3777 | havoc | 2004-01-01 04:25:36 -0800 (Thu, 01 Jan 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

added c_nodes, c_leafs, and c_faces increments in q3bsp rendering to make r_speeds more useful

------------------------------------------------------------------------
r3776 | havoc | 2004-01-01 02:25:05 -0800 (Thu, 01 Jan 2004) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

sorry Mathieu, can't use va() in filesystem code, not safe. (this was causing the crosshairs to not work due to heavy reuse of va() buffers)

------------------------------------------------------------------------
r3775 | havoc | 2003-12-31 21:22:21 -0800 (Wed, 31 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c

fix a missing ; from knghtbrd's commit

------------------------------------------------------------------------
r3774 | knghtbrd | 2003-12-31 20:39:47 -0800 (Wed, 31 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_shared.c

Moved an extern to the proper header.

------------------------------------------------------------------------
r3773 | knghtbrd | 2003-12-31 20:01:00 -0800 (Wed, 31 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c

Moved cl_available definition to vid_shared.c

------------------------------------------------------------------------
r3772 | havoc | 2003-12-31 18:35:56 -0800 (Wed, 31 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/cvar.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/todo

now runs scripts at startup differently - runs scripts twice, once only executing cvar and exec, then starts video, then runs scripts again

------------------------------------------------------------------------
r3771 | havoc | 2003-12-31 18:33:48 -0800 (Wed, 31 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_dma.c

fixed the complaints about missing sounds (no longer complains after the initial precache failure)

------------------------------------------------------------------------
r3770 | knghtbrd | 2003-12-31 10:03:49 -0800 (Wed, 31 Dec 2003) | 16 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/vid_glx.c

More MacOS X stuff.  The correct test for MacOS X in preprocessor seems to
be defined(__APPLE__) && defined(__MACH__).  MacOS X has strl functions,
so don't bother compiling them.  Also, the correct name and location of
libGL for X11 on a Mac is /usr/X11R6/lib/libGL.1.dylib.  Compiles with one
warning caused by use of dlfcn.h (an emulation of the dynamic ELF object
loader which complains that you really should be using the Mach-O dylib
API instead.)

Compiled with gcc 3.1 (use gcc_select) on MacOS X 10.3 with X11 and the
Xcode Tools installed.  Makefile changes were: null sound/cd, removal of
-lxf86dga from the GLX build, and replacing -ggdb in both places with
plain old -g (someone at Apple needs a LARTing for this...)  SHOULD work
with 10.2 provided that you have developer tools, X11 with devel stuff,
and the dlfcn emulation package from fink.  I can't promise meaningful
support for anything but Panther, sorry.

------------------------------------------------------------------------
r3769 | havoc | 2003-12-31 00:32:54 -0800 (Wed, 31 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

make sure client ports are opened before trying to connect to anything

------------------------------------------------------------------------
r3768 | havoc | 2003-12-30 23:37:22 -0800 (Tue, 30 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c

don't even try to support XF86DGA stuff on Mac

------------------------------------------------------------------------
r3767 | havoc | 2003-12-30 23:18:07 -0800 (Tue, 30 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.h

fix a thinko in big endian support (forgot to use defined() in a #elif)

------------------------------------------------------------------------
r3766 | molivier | 2003-12-30 05:00:48 -0800 (Tue, 30 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

Factorized the file searching algorithm in the FS code. Sorted packaged files list at load time to allow the use of a binary search. Overall, I think you can expect a file search time divided by a factor between 1.5 to 3 depending on your mod and packages layout. Time lost in the file search code on my P233MMX: vanilla Quake (4121 searches while loading the 1st demo): 2.7 sec -> 1.6 sec, Transfusion mod (9752 searches while loading BB1): 18.0 sec -> 7.6 sec

------------------------------------------------------------------------
r3765 | havoc | 2003-12-29 15:47:55 -0800 (Mon, 29 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

updated sv_masterextra1 to point to the newer master server address

------------------------------------------------------------------------
r3764 | havoc | 2003-12-28 21:43:47 -0800 (Sun, 28 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

changed nexuiz hud to display a different (more minimal) sbar pic when viewsize is 110

------------------------------------------------------------------------
r3763 | havoc | 2003-12-28 17:57:38 -0800 (Sun, 28 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/sbar.c

added GAME_SOM (and its hud), and shuffled some hud code around to make things a little cleaner

------------------------------------------------------------------------
r3762 | havoc | 2003-12-27 22:21:36 -0800 (Sat, 27 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

fixed bug with falling (not on ground) MOVETYPE_STEP entities not touching triggers

------------------------------------------------------------------------
r3761 | havoc | 2003-12-27 21:14:29 -0800 (Sat, 27 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

made TryUnstick failure a DPrintf (like TryUnstick success is)

------------------------------------------------------------------------
r3760 | havoc | 2003-12-27 18:14:15 -0800 (Sat, 27 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile

added ogg.o to WGL exe build

------------------------------------------------------------------------
r3759 | havoc | 2003-12-27 18:08:10 -0800 (Sat, 27 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/world.c

fix a thinko on clip.trace.ent = sv.edicts (it should only be set if startsolid or fraction < 1)

------------------------------------------------------------------------
r3758 | havoc | 2003-12-27 17:05:40 -0800 (Sat, 27 Dec 2003) | 3 lines
Changed paths:
   M /trunk/darkplaces/sv_move.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/todo
   M /trunk/darkplaces/world.c

fixed fiends jumping through player bug, huge thanks to Tomaz for days of help tracking down this longstanding bug! (it supported rotated collisions with bbox entities - not good!)
refined the COLLISIONPARANOID checks (now centralized in SV_Move)

------------------------------------------------------------------------
r3757 | havoc | 2003-12-27 16:58:38 -0800 (Sat, 27 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

improved support for q3map2 lights (added fade and scale keys supported by rtcw and sof2 respectively)

------------------------------------------------------------------------
r3756 | molivier | 2003-12-27 13:15:16 -0800 (Sat, 27 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.dsp
   M /trunk/darkplaces/makefile
   A /trunk/darkplaces/ogg.c
   A /trunk/darkplaces/ogg.h
   M /trunk/darkplaces/snd_dma.c
   M /trunk/darkplaces/snd_mem.c

Simple Ogg Vorbis support (no streaming: the file is fully decompressed in memory, you just save disk space). DP will try to load the VorbisFile library at startup and will enable Ogg Vorbis support if it succeeds, so you need the Ogg Vorbis official DLLs. Win32 binaries works, but the Linux binaries are still untested for the moment - they compile successfully though.

------------------------------------------------------------------------
r3755 | havoc | 2003-12-26 09:28:18 -0800 (Fri, 26 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

made an annoying cbox message that I had forgotten to disable, into a COLLISIONPARANOID >= 3 line

------------------------------------------------------------------------
r3754 | havoc | 2003-12-24 13:24:49 -0800 (Wed, 24 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_move.c

fix a bug with using the wrong trace end variable in the COLLISIONPARANOID print

------------------------------------------------------------------------
r3753 | havoc | 2003-12-24 13:22:43 -0800 (Wed, 24 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/ui.c

patched up some compiler warnings in incomplete code

------------------------------------------------------------------------
r3752 | havoc | 2003-12-24 13:07:41 -0800 (Wed, 24 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/collision.c
   M /trunk/darkplaces/collision.h
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/sv_move.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/todo
   M /trunk/darkplaces/world.c

added a bunch more COLLISIONPARANOID code trying to track down a physics bug with fiends jumping through players, this defaults off (see end of collision.h)

------------------------------------------------------------------------
r3751 | havoc | 2003-12-24 13:05:17 -0800 (Wed, 24 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

added "sv_saveentfile" command to allow easy dumping of .ent files from maps so they can then be edited in a text editor

------------------------------------------------------------------------
r3750 | havoc | 2003-12-24 10:16:58 -0800 (Wed, 24 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_sky.c

fixed cloud layers in quake sky loading

------------------------------------------------------------------------
r3749 | black | 2003-12-23 04:12:03 -0800 (Tue, 23 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/todo
   M /trunk/darkplaces/ui.c
   M /trunk/darkplaces/ui.h
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_wgl.c
   M /trunk/darkplaces/zone.c
   M /trunk/darkplaces/zone.h

Fast commit before Im off for 10 days. Please correct/undo my commit if it breaks something, I havent had time to test everything perfectly but Im hoping that everything works. Merry Christmas everybody !

------------------------------------------------------------------------
r3746 | black | 2003-12-20 10:32:47 -0800 (Sat, 20 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c
   M /trunk/darkplaces/sbar.h
   M /trunk/darkplaces/todo

Added the cvar sbar_alpha.

------------------------------------------------------------------------
r3745 | black | 2003-12-20 10:21:18 -0800 (Sat, 20 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/todo

PR_SetString and PRVM_SetString now point to pr_strings - resp. prog->strings if a NULL string is passed.

------------------------------------------------------------------------
r3744 | black | 2003-12-19 09:54:22 -0800 (Fri, 19 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/todo

Added the console commands edictset and prvm_edictset.

------------------------------------------------------------------------
r3743 | black | 2003-12-19 08:46:48 -0800 (Fri, 19 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/todo

Fixed the crash that occured when the commandline got "too long".

------------------------------------------------------------------------
r3742 | molivier | 2003-12-18 00:59:54 -0800 (Thu, 18 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

Removed a potential buffer overflow and factorized some code

------------------------------------------------------------------------
r3740 | black | 2003-12-17 05:16:47 -0800 (Wed, 17 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

minor, minor change to Host_Init - the loading plaque is now displayed before the menu is initialized

------------------------------------------------------------------------
r3738 | havoc | 2003-12-17 01:50:20 -0800 (Wed, 17 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

fixed a bug with high framerate (or low speed) rotating bmodels failing to push when blocked

------------------------------------------------------------------------
r3737 | molivier | 2003-12-16 23:58:33 -0800 (Tue, 16 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

Fixed AK version of the FS code, it should now behave as expected, without much duplicated code. Factorized "dir" and "ls" console commands code.

------------------------------------------------------------------------
r3736 | havoc | 2003-12-16 07:59:21 -0800 (Tue, 16 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

fix a filesystem directory listing bug in FS_Search

------------------------------------------------------------------------
r3735 | havoc | 2003-12-16 07:26:28 -0800 (Tue, 16 Dec 2003) | 3 lines
Changed paths:
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/filematch.c
   M /trunk/darkplaces/fs.c

rewrote FS_Search, hopefully it will work better now, and it now matches directories inside paks (in other words: listing sound/* will tell you about sound/plats and sound/whatever.wav, this is mainly to be consistent with filesystem directories), it is also no longer two-pass (although simple the two-pass approach was dangerous if the two listings came out different), and it now sorts the listing
rewrote much of matchpattern, now handles path separators specially, and uses a much better approach to handling the * wildcard (no longer looks for the following character, simply tries multiple matchpattern calls until it hits a path separator or gets a match)

------------------------------------------------------------------------
r3733 | black | 2003-12-16 04:43:50 -0800 (Tue, 16 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/prvm_cmds.c

Added the togglemenu command for both menus and the chr builtin command (menu qc)

------------------------------------------------------------------------
r3726 | havoc | 2003-12-16 03:08:07 -0800 (Tue, 16 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/dpmod/qc/dpextensions.qc

added cvar_string extension at the request of Paul Timofeyev

------------------------------------------------------------------------
r3725 | molivier | 2003-12-14 23:48:43 -0800 (Sun, 14 Dec 2003) | 2 lines
Changed paths:
   A /trunk/darkplaces/cd_bsd.c
   M /trunk/darkplaces/cd_linux.c
   M /trunk/darkplaces/makefile.bsd

Audio CD support for NetBSD; it also compiles on OpenBSD, but I can't test it for now. Plus some diff noise reduction and a minor bug fix in cd_linux.c (the case when the user changes track without using the "cd" command should now be handled correctly)

------------------------------------------------------------------------
r3724 | molivier | 2003-12-12 07:01:14 -0800 (Fri, 12 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cd_linux.c
   M /trunk/darkplaces/cd_win.c

Removed redundant definitions in cd_linux.c

------------------------------------------------------------------------
r3723 | havoc | 2003-12-11 16:28:56 -0800 (Thu, 11 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/todo

made sure EF_FULLBRIGHT works on everything (bmodels were broken)

------------------------------------------------------------------------
r3722 | molivier | 2003-12-11 06:17:34 -0800 (Thu, 11 Dec 2003) | 2 lines
Changed paths:
   D /trunk/darkplaces/dp-bc.mak

Borland C++ makefile is *so* outdated that I can't even imagine someone is still using it

------------------------------------------------------------------------
r3721 | molivier | 2003-12-11 05:57:59 -0800 (Thu, 11 Dec 2003) | 2 lines
Changed paths:
   A /trunk/darkplaces/cd_shared.c

Oops... I forgot to add this file to the previous commit

------------------------------------------------------------------------
r3720 | molivier | 2003-12-11 05:52:46 -0800 (Thu, 11 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cd_linux.c
   M /trunk/darkplaces/cd_win.c
   M /trunk/darkplaces/cdaudio.h
   M /trunk/darkplaces/darkplaces.dsp
   M /trunk/darkplaces/makefile

Factorized audio CD code

------------------------------------------------------------------------
r3716 | molivier | 2003-12-10 00:05:25 -0800 (Wed, 10 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.bsd
   M /trunk/darkplaces/sys_shared.c

OpenBSD support wasn't very far away...

------------------------------------------------------------------------
r3714 | havoc | 2003-12-09 05:17:46 -0800 (Tue, 09 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/todo
   M /trunk/darkplaces/world.c

fixed the wall slide stuttering bug (the one that has been annoying me for months), it turned out to be a float precision issue with cliphull selection, and this also fixed the movetogoal bug (monsters not noticing they hit a wall) and also the scrags-flying-through-wall/ceilings bug

------------------------------------------------------------------------
r3712 | molivier | 2003-12-09 00:05:43 -0800 (Tue, 09 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/lhnet.c
   A /trunk/darkplaces/makefile.bsd
   M /trunk/darkplaces/sys_shared.c

Early support for NetBSD (the dedicated binary works and the GLX binary compiles)

------------------------------------------------------------------------
r3711 | molivier | 2003-12-08 23:54:59 -0800 (Mon, 08 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/menu.c

Fixed scr_screenshot_jpeg_quality slider in options menu

------------------------------------------------------------------------
r3710 | havoc | 2003-12-08 00:03:24 -0800 (Mon, 08 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_dma.c
   M /trunk/darkplaces/todo

todo item done: sounds spawn even if out of hearing range (because the player might teleport to them)

------------------------------------------------------------------------
r3709 | havoc | 2003-12-07 23:58:28 -0800 (Sun, 07 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cd_linux.c
   M /trunk/darkplaces/cd_null.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/snd_dma.c
   M /trunk/darkplaces/snd_null.c

fixed gcc and linux related compilation problems from Black's recent commit

------------------------------------------------------------------------
r3708 | havoc | 2003-12-07 23:11:31 -0800 (Sun, 07 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

fix the weapon alpha with invisibility in transfusion

------------------------------------------------------------------------
r3707 | havoc | 2003-12-07 21:05:22 -0800 (Sun, 07 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r3706 | havoc | 2003-12-07 16:22:13 -0800 (Sun, 07 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

added a comment above particle() function to describe its parameters

------------------------------------------------------------------------
r3705 | black | 2003-12-07 10:55:56 -0800 (Sun, 07 Dec 2003) | 3 lines
Changed paths:
   M /trunk/darkplaces/cd_linux.c
   M /trunk/darkplaces/cd_win.c
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/snd_dma.c
   M /trunk/darkplaces/sound.h

Added qc fs search functions, so the qcs can easily verify directories contents, etc. -> useful for dynamic content loading.
Changed some 'bool's into read-only cvars to make them accessible for the menu qc.

------------------------------------------------------------------------
r3704 | havoc | 2003-12-07 05:01:28 -0800 (Sun, 07 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_shared.c

added an easteregg (v_psycho), thanks to Zinx Verituse and Ben Winslow for the original code for this

------------------------------------------------------------------------
r3703 | havoc | 2003-12-07 03:40:03 -0800 (Sun, 07 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/todo

todo item done: now ignores modelflags on view entities and tag attached entities, so there aren't spinning view models and such anymore in Zerstorer and Malice

------------------------------------------------------------------------
r3702 | havoc | 2003-12-07 03:13:25 -0800 (Sun, 07 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/todo

todo item done: turning keys are no longer affected by slowmo

------------------------------------------------------------------------
r3701 | havoc | 2003-12-07 03:08:32 -0800 (Sun, 07 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/console.h
   M /trunk/darkplaces/todo

todo item done: fixed con_notify cvar (limits number of displayed notify lines)

------------------------------------------------------------------------
r3700 | havoc | 2003-12-07 02:57:29 -0800 (Sun, 07 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/todo

todo item done: added cl_particles_blood_bloodhack cvar so now id1 blood particles use the blood effect, and added this to effects options menu as Force New Blood Effect

------------------------------------------------------------------------
r3699 | havoc | 2003-12-07 02:28:54 -0800 (Sun, 07 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r3698 | havoc | 2003-12-07 02:26:20 -0800 (Sun, 07 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/cl_screen.h
   M /trunk/darkplaces/jpeg.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/todo

added scr_screenshot_jpeg_quality cvar (and added it to the menu)

------------------------------------------------------------------------
r3697 | havoc | 2003-12-07 01:56:51 -0800 (Sun, 07 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/todo

todo item done: added "saveconfig" console command

------------------------------------------------------------------------
r3696 | havoc | 2003-12-07 01:48:29 -0800 (Sun, 07 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/todo
   M /trunk/dpmod/qc/dpextensions.qc

added DP_LITSUPPORT extension

------------------------------------------------------------------------
r3695 | havoc | 2003-12-07 01:39:49 -0800 (Sun, 07 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/todo

todo item done: GAME_FNIGGIUM minimum resolution of 640x480

------------------------------------------------------------------------
r3694 | havoc | 2003-12-07 01:24:41 -0800 (Sun, 07 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

added r_wateralpha to effects menu

------------------------------------------------------------------------
r3693 | havoc | 2003-12-07 00:35:48 -0800 (Sun, 07 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c

removed vid_allowhwgamma variable because vid_activewindow is a better thing to check

------------------------------------------------------------------------
r3692 | havoc | 2003-12-07 00:33:54 -0800 (Sun, 07 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r3691 | havoc | 2003-12-07 00:24:23 -0800 (Sun, 07 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

no longer throttles back framerate when console is active, now only when app is not the focus

------------------------------------------------------------------------
r3690 | havoc | 2003-12-07 00:21:54 -0800 (Sun, 07 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c

fixed behavior of vid_activewindow and vid_allowhwgamma in x11 event code, now behaves more like the windows version (gamma is now based on whether the window is the focus, not related to mouse entering/leaving anymore)

------------------------------------------------------------------------
r3689 | havoc | 2003-12-07 00:01:01 -0800 (Sun, 07 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/view.c

added CSHIFT_VCSHIFT blend so v_cshift now affects underwater blending (as well as other liquids) for more consistent behavior, and disabled powerup blends in transfusion (at their request)

------------------------------------------------------------------------
r3688 | havoc | 2003-12-04 03:13:57 -0800 (Thu, 04 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/common.c

eradicated SZ_Print, thanks to Fuh for pointing out the sheer evil of this function found in nq, qw and q2...  SZ_Print is a strcat onto a sizebuf - note that it could OVERWRITE THE SIZEBUF STRUCT if it is empty (but it was never empty where quake used it).

------------------------------------------------------------------------
r3687 | havoc | 2003-12-04 02:05:12 -0800 (Thu, 04 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

removed need for gfx/menuplyr.lmp (this code wasn't even used anymore, since the menu loads it directly on demand and that is optional)

------------------------------------------------------------------------
r3686 | havoc | 2003-12-04 01:47:38 -0800 (Thu, 04 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h

console parsing now behaves like qwcl, thanks to Fuh for pointing out the problems with the winquake COM_ParseToken (it treated : as a single character keyword, thus breaking connect commands involving a port, for example), so I added COM_ParseTokenConsole for the console parsing

------------------------------------------------------------------------
r3676 | havoc | 2003-12-02 18:00:15 -0800 (Tue, 02 Dec 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c

fix a severe bug with 16bit modes (VID_InitMode in vid_glx.c was taking a stencil parameter which does not exist, and thus stencil was in general always on even in 16bit)

------------------------------------------------------------------------
r3675 | havoc | 2003-11-30 16:17:32 -0800 (Sun, 30 Nov 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

added a note about the Creative Technology Ltd patent (US Patent #6384822) on the Carmack's Reverse approach to stencil shadow volume rendering, and changed the rendering algorithm to further distance it from Creative's patent.

------------------------------------------------------------------------
r3674 | black | 2003-11-30 10:33:26 -0800 (Sun, 30 Nov 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

The menu isnt initialized for dedicated servers

------------------------------------------------------------------------
r3673 | havoc | 2003-11-29 22:33:33 -0800 (Sat, 29 Nov 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_shadow.c

now uses q3bsp surfaceflags when possible instead of shaders (but the trans flag still exists only in shader surfaceparms so they are still read for that)

------------------------------------------------------------------------
r3672 | havoc | 2003-11-29 17:56:29 -0800 (Sat, 29 Nov 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h

added GAME_FNIGGIUM and GAME_SETHERAL

------------------------------------------------------------------------
r3671 | havoc | 2003-11-29 17:48:34 -0800 (Sat, 29 Nov 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

fix a little bug in the FS_Search code (it was checking the pak case sensitivity flag even if it was looking at a directory listing)

------------------------------------------------------------------------
r3670 | havoc | 2003-11-29 17:14:47 -0800 (Sat, 29 Nov 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_shadow.c

now parses q3 shaders for surfaceparms (this mainly fixes up the many falsely transparent walls in shader tricks, and also detects nodraw shaders properly)

------------------------------------------------------------------------
r3669 | havoc | 2003-11-29 17:10:51 -0800 (Sat, 29 Nov 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h

added comment support to COM_ReadAndTokenizeLine

------------------------------------------------------------------------
r3667 | havoc | 2003-11-28 21:32:06 -0800 (Fri, 28 Nov 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/fs.h

added dir and ls console commands (yes they are different), these search paks (although not very good at pattern matching), and FS_Search and FS_FreeSearch functions

------------------------------------------------------------------------
r3666 | havoc | 2003-11-28 21:30:13 -0800 (Fri, 28 Nov 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

added a quick hack for nodraw support in q3bsp (I hope this is right)

------------------------------------------------------------------------
r3662 | black | 2003-11-19 06:59:56 -0800 (Wed, 19 Nov 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_shared.c

vid_hardwaregammasupported is now a read-only cvar

------------------------------------------------------------------------
r3661 | black | 2003-11-19 05:56:38 -0800 (Wed, 19 Nov 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cvar.c
   M /trunk/darkplaces/cvar.h
   M /trunk/darkplaces/pr_edict.c

Cvars can be read-only now.

------------------------------------------------------------------------
r3659 | havoc | 2003-11-19 02:07:39 -0800 (Wed, 19 Nov 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_sprites.c
   M /trunk/darkplaces/todo

fixed oriented sprite problems (no longer uses entity angles for them) by rewriting the whole R_SpriteSetup function, it is now VERY optimized and more readable

------------------------------------------------------------------------
r3658 | havoc | 2003-11-19 00:50:19 -0800 (Wed, 19 Nov 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_shared.c

ignore vid_restart commands in configs

------------------------------------------------------------------------
r3657 | molivier | 2003-11-18 23:50:53 -0800 (Tue, 18 Nov 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_wgl.c

ClearAllStates cleared the key states twice in vid_wgl.c, and vid_glx.c didn't do that when he closes its window (which caused missed key strokes with vid_restart and the video options menu)

------------------------------------------------------------------------
r3656 | molivier | 2003-11-18 23:45:46 -0800 (Tue, 18 Nov 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.dsp

Updated MSVC6 DSP file

------------------------------------------------------------------------
r3653 | havoc | 2003-11-18 09:48:40 -0800 (Tue, 18 Nov 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/keys.c

fix an input bug that prevented function keys from working inside console

------------------------------------------------------------------------
r3650 | havoc | 2003-11-16 21:00:50 -0800 (Sun, 16 Nov 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/palette.c

now includes quake palette as a fallback if no gfx/palette.lmp is loaded

------------------------------------------------------------------------
r3649 | havoc | 2003-11-14 20:17:54 -0800 (Fri, 14 Nov 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r3648 | havoc | 2003-11-14 20:16:30 -0800 (Fri, 14 Nov 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r3647 | havoc | 2003-11-14 17:03:37 -0800 (Fri, 14 Nov 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

fixed flipped sound (stupid bug in S_Update call)

------------------------------------------------------------------------
r3646 | havoc | 2003-11-14 06:02:56 -0800 (Fri, 14 Nov 2003) | 10 lines
Changed paths:
   D /trunk/darkplaces/chase.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/meshqueue.c
   M /trunk/darkplaces/r_crosshairs.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_lightning.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/r_sprites.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/snd_dma.c
   M /trunk/darkplaces/sound.h
   M /trunk/darkplaces/todo
   M /trunk/darkplaces/view.c

r_refdef.vieworg and r_refdef.viewangles replaced by r_refdef.viewentitymatrix
fixed intermission camera bug (now the right place and angles by copying the entity matrix directly to r_refdef)
fixed intermission listener bug (now the right place by copying the entity matrix to listener variables)
fixed envmap command saving (now reads the correct part of the screen according to GL's bottom to top coordinates, so this works again)
fixed envmap command rendering (it was not hiding view and exterior models)
fixed timerefresh command rendering (it was not properly setting up the view)
merged chase.c into view.c because it really didn't have any good reasons to be separate
renamed listener_forward to listener_viewforward, listener_up to listener_viewup, listener_origin to listener_vieworigin, and converted listener_right to listener_viewleft
renamed vpn to r_viewforward, vup to r_viewup, vright to r_viewright (deprecated, trying to use just r_viewleft but haven't finished converting things over to it yet), r_origin to r_vieworigin

------------------------------------------------------------------------
r3645 | havoc | 2003-11-14 05:55:44 -0800 (Fri, 14 Nov 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_null.c

removed double newlines (don't have a clue how this file got them)

------------------------------------------------------------------------
r3644 | havoc | 2003-11-14 05:46:28 -0800 (Fri, 14 Nov 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

fix a couple signed/unsigned comparison warnings

------------------------------------------------------------------------
r3643 | havoc | 2003-11-14 05:19:24 -0800 (Fri, 14 Nov 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

don't draw viewmodel during intermission

------------------------------------------------------------------------
r3639 | molivier | 2003-11-12 03:37:53 -0800 (Wed, 12 Nov 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

Options menu has a width of 320, not 640

------------------------------------------------------------------------
r3638 | havoc | 2003-11-12 00:44:54 -0800 (Wed, 12 Nov 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c

make quake completable again (killtarget problem with double remove call, now just a developer warning instead of an error)

------------------------------------------------------------------------
r3637 | black | 2003-11-11 12:20:11 -0800 (Tue, 11 Nov 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

Added {0,0} to vid_resolutions and added the macro/constant VID_RES_COUNT

------------------------------------------------------------------------
r3636 | black | 2003-11-11 12:18:37 -0800 (Tue, 11 Nov 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

Added 2 builtins.

------------------------------------------------------------------------
r3635 | havoc | 2003-11-10 20:56:32 -0800 (Mon, 10 Nov 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h

q3bsp transparency support (note: makes maps that abuse alpha in shaders for special effects look quite weird)

------------------------------------------------------------------------
r3634 | havoc | 2003-11-10 18:36:21 -0800 (Mon, 10 Nov 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_shared.h

q1bsp lightmaps are now always rendered at 2x overbright like software quake and q3bsp (this means all multitexture lightmapped wall methods now require combine)

------------------------------------------------------------------------
r3633 | havoc | 2003-11-10 00:20:04 -0800 (Mon, 10 Nov 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/todo

now limits animation lerp time to .1 second to fix a problem with framegroup models changing frame (which they do infrequently) and interpolating the change really slowly

------------------------------------------------------------------------
r3632 | havoc | 2003-11-08 00:33:41 -0800 (Sat, 08 Nov 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/winding.c
   M /trunk/darkplaces/winding.h

added Polygon_Divide_Double and Polygon_Divide_Float functions which take point arrays and such instead of windings, for more flexibility

------------------------------------------------------------------------
r3631 | havoc | 2003-11-07 19:16:11 -0800 (Fri, 07 Nov 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c

check for many invalid attempts to modify entities (like setmodel on world, or on a free entity)

------------------------------------------------------------------------
r3630 | molivier | 2003-11-07 00:13:43 -0800 (Fri, 07 Nov 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

When exiting the color control menu, return to the options menu instead of the main menu

------------------------------------------------------------------------
r3628 | havoc | 2003-11-05 00:18:54 -0800 (Wed, 05 Nov 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_sky.c

call reset functions in init code (not necessary currently, as the compilers currently being used for darkplaces clear uninitialized variables, but a good practice)

------------------------------------------------------------------------
r3627 | havoc | 2003-11-05 00:03:27 -0800 (Wed, 05 Nov 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h

immense speedups to triangle neighbor building by using an edge hash table (this sped up rtlight loading by 10x or more in some cases)

------------------------------------------------------------------------
r3626 | havoc | 2003-11-05 00:00:34 -0800 (Wed, 05 Nov 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_sky.c

fixed r_restart/vid_restart bugs with skybox (now reloads skybox as it should) and cleaned up skybox loading/unloading (no more memory leaks when changing skybox during game)

------------------------------------------------------------------------
r3625 | havoc | 2003-11-04 20:14:55 -0800 (Tue, 04 Nov 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

added r_fullbright (and EF_FULLBRIGHT) support to q3bsp rendering

------------------------------------------------------------------------
r3624 | havoc | 2003-11-04 20:10:10 -0800 (Tue, 04 Nov 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c

added r_ambient support to q3bsp rendering

------------------------------------------------------------------------
r3623 | havoc | 2003-11-04 19:36:38 -0800 (Tue, 04 Nov 2003) | 6 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/todo

added r_shadow_showtris
added gl_texture_anisotropy to menu
changed sv_cullentities_trace and _pvs defaults to 0 and 1 respectively (now uses pvs culling because trace culling was too slow in q3bsp)
r_shadow_realtime_world now works in q3bsp (using upgraded Mod_ShadowMesh functions to combine lighting meshes)
rewrote most of R_Q3BSP_DrawFace - now supports singletexture cards, r_shadow_realtime_world, and glow textures

------------------------------------------------------------------------
r3622 | havoc | 2003-11-04 19:34:24 -0800 (Tue, 04 Nov 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/glquake.h

added R_Mesh_Draw_ShowTris function which draws a triangle mesh as lines

------------------------------------------------------------------------
r3620 | black | 2003-10-31 11:24:12 -0800 (Fri, 31 Oct 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/mprogdefs.h
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_edict.c

Added isfunction and changed callfunction so it works

------------------------------------------------------------------------
r3615 | black | 2003-10-30 04:49:30 -0800 (Thu, 30 Oct 2003) | 3 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/vid_shared.c

Added 2(3) builtin functions.
Changed the 2d mouse code, so that the relative coords are mapped into the console coord system (mouse speed is always the same in the menu qc).

------------------------------------------------------------------------
r3614 | black | 2003-10-28 14:29:30 -0800 (Tue, 28 Oct 2003) | 4 lines
Changed paths:
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/prvm_exec.c

Fixed a bug that caused some messages to not be logged to the disk (Con_Print calls instead of Con_Printf).
Changed the comment of Con_Print, so it isnt misleading any more.
Fixed a bug so dp wont crash when VM_strzone/VM_strunzone is used.

------------------------------------------------------------------------
r3611 | molivier | 2003-10-28 03:17:36 -0800 (Tue, 28 Oct 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_mem.c

Moved some sound code in preparation of adding Ogg Vorbis support

------------------------------------------------------------------------
r3609 | black | 2003-10-26 13:54:59 -0800 (Sun, 26 Oct 2003) | 3 lines
Changed paths:
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_edict.c

Changed the way the new vm is handling the unloading of programs - respectively cleaned PRVM_ResetProgs.
Moved the key_dest reset from MR_Restart to M_Shutdown/MP_Shutdown.

------------------------------------------------------------------------
r3608 | black | 2003-10-25 09:28:18 -0700 (Sat, 25 Oct 2003) | 3 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/prvm_execprogram.h

Added a new builin function (callfunction)
Fixed my drawqueue clipping code - should work now

------------------------------------------------------------------------
r3605 | molivier | 2003-10-23 23:47:21 -0700 (Thu, 23 Oct 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

Fixed FS code so that unpacked files are handled normally when AKVERSION isn't defined

------------------------------------------------------------------------
r3604 | black | 2003-10-23 12:47:08 -0700 (Thu, 23 Oct 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/prvm_exec.c

Changed prvm_ed_loadfromfile - it isnt really compatible with the old vm anymore (allows now loading multiple files. Fixed prvm_crashall and altered some error texts.

------------------------------------------------------------------------
r3602 | molivier | 2003-10-22 01:41:27 -0700 (Wed, 22 Oct 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_dma.c

Factorized the code of the S_Play* functions

------------------------------------------------------------------------
r3601 | molivier | 2003-10-22 01:35:11 -0700 (Wed, 22 Oct 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cd_win.c
   M /trunk/darkplaces/vid_wgl.c

Fixed 2 warnings found by MSVC6

------------------------------------------------------------------------
r3600 | havoc | 2003-10-21 06:02:16 -0700 (Tue, 21 Oct 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/glquake.h

removed pragma that disabled signed/unsigned mismatch warnings in MSVC4, as these have all been fixed in the engine already

------------------------------------------------------------------------
r3599 | black | 2003-10-21 05:59:55 -0700 (Tue, 21 Oct 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h

I hope this fixes some warnings

------------------------------------------------------------------------
r3598 | havoc | 2003-10-21 05:21:26 -0700 (Tue, 21 Oct 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_move.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sv_user.c

physics code no longer uses allsolid (mainly of concern to q3bsp which rarely set it), only startsolid (allsolid is of course kept for QC compatibility, as non-functional as it may be), and I reenabled movement when in solid (so objects can move out of obstacles they managed to end up inside)

------------------------------------------------------------------------
r3597 | havoc | 2003-10-21 05:18:43 -0700 (Tue, 21 Oct 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/world.c

SV_Move (and children) now only set trace.ent if there is an impact, not if it was an allsolid situation...  and SV_PointQ1Contents now uses SV_PointSuperContents

------------------------------------------------------------------------
r3596 | black | 2003-10-21 05:08:29 -0700 (Tue, 21 Oct 2003) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/cl_screen.h
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/input.h
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/pr_exec.c
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/prvm_exec.c
   M /trunk/darkplaces/prvm_execprogram.h
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c

Added in_mouse_x and in_mouse_y, which contain the rel. coords of the mouse.
Fixed a bug where PRVM_Stacktrace/PR_Stacktrace were involved.
Added some vm builtin functions to the new vm and changed PRVM_ED_LoadFromFile, so it can load multiple files.

------------------------------------------------------------------------
r3594 | havoc | 2003-10-21 04:43:58 -0700 (Tue, 21 Oct 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/collision.c

moved trace endpos calculation outside of RecursiveHullCheck, to improve code layout consistency between collision box and q1bsp code (no effect on results)

------------------------------------------------------------------------
r3593 | havoc | 2003-10-21 04:34:57 -0700 (Tue, 21 Oct 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

one more input underrun check in pvs decompression

------------------------------------------------------------------------
r3591 | black | 2003-10-17 08:30:22 -0700 (Fri, 17 Oct 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

Removed some bugs (I forget to change a few pr_argc to prog->argc)

------------------------------------------------------------------------
r3589 | black | 2003-10-17 07:02:34 -0700 (Fri, 17 Oct 2003) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/input.h
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/vid_shared.c

Updated some builtin parameter lists, added 2 functions to the menu builtins.
Added the boolean in_client_mouse (used to indicate wheter mouse position data
should be send to the client.
(Only Win at the moment)

------------------------------------------------------------------------
r3588 | havoc | 2003-10-16 20:32:32 -0700 (Thu, 16 Oct 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_demo.c

read multiple frames from demo if client is falling behind

------------------------------------------------------------------------
r3587 | black | 2003-10-16 10:45:29 -0700 (Thu, 16 Oct 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

Fixed crash in Host_Shutdown when MR_Shutdown was 0.

------------------------------------------------------------------------
r3586 | havoc | 2003-10-16 04:41:18 -0700 (Thu, 16 Oct 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c

handle one error condition I forgot to code in PF_setattachment (modelindex was checked, but did not check for it resolving to a NULL model, as is the case whem modelindex is 0)

------------------------------------------------------------------------
r3584 | havoc | 2003-10-15 00:37:05 -0700 (Wed, 15 Oct 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

marked off some completed items and such

------------------------------------------------------------------------
r3583 | havoc | 2003-10-13 14:14:05 -0700 (Mon, 13 Oct 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

added r_shadow_help and r_editlights_help commands containing documentation

------------------------------------------------------------------------
r3582 | black | 2003-10-13 05:43:28 -0700 (Mon, 13 Oct 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/sys_win.c
   M /trunk/darkplaces/vid_wgl.c

Fixed windows input (bad,bad hack)

------------------------------------------------------------------------
r3581 | warp | 2003-10-12 02:05:19 -0700 (Sun, 12 Oct 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/vid_glx.c

Whoops, fix some stupidity on my part, should work better.

------------------------------------------------------------------------
r3580 | warp | 2003-10-12 01:43:23 -0700 (Sun, 12 Oct 2003) | 4 lines
Changed paths:
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/keys.h
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/menu.h
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_wgl.c

Change key handling, er, quite a bit.

Note, Windows is broken by this, it needs fixing up ASAP.

------------------------------------------------------------------------
r3579 | warp | 2003-10-11 22:45:42 -0700 (Sat, 11 Oct 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c

Tweak the key handling, may need more invasive changes.

------------------------------------------------------------------------
r3578 | black | 2003-10-11 12:46:12 -0700 (Sat, 11 Oct 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_null.c

Added S_GetCached so the dedicated servers compiles now

------------------------------------------------------------------------
r3577 | havoc | 2003-10-11 12:32:36 -0700 (Sat, 11 Oct 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

remove +use and -use commands because they prevent mods from defining them (and they never worked anyway)

------------------------------------------------------------------------
r3576 | black | 2003-10-11 05:14:33 -0700 (Sat, 11 Oct 2003) | 6 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/menu.h
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_edict.c
   M /trunk/darkplaces/snd_dma.c
   M /trunk/darkplaces/snd_win.c
   M /trunk/darkplaces/sound.h

Added the drawing functions and added also probably menu only message functions
(almost the same as the server ones, but with different param (order)).
Also added all functions to the menu builtin list (except the menu specific ones :-/).
The drawflag constants are now the drawqueue_drawflag_e enum.
Added function S_GetCached.

------------------------------------------------------------------------
r3572 | havoc | 2003-10-10 22:34:49 -0700 (Fri, 10 Oct 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/snd_dma.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/world.c
   M /trunk/darkplaces/world.h

added DP_QC_TRACE_MOVETYPE_HITMODEL extension (and added DP_QC_TRACE_MOVETYPE_WORLDONLY to extension list) - this means traceline/tracebox can now check model geometry

------------------------------------------------------------------------
r3571 | havoc | 2003-10-10 22:16:19 -0700 (Fri, 10 Oct 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r3570 | havoc | 2003-10-10 20:39:39 -0700 (Fri, 10 Oct 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

reverted two bugs introduced by Black (anum red digits were not being loaded, and restored the positioning of the minideathmatchoverlay to exactly where quake had it - my previous commit was 4 pixels off in positioning)

------------------------------------------------------------------------
r3569 | havoc | 2003-10-10 20:25:09 -0700 (Fri, 10 Oct 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

fix Sbar_MiniDeathmatchOverlay to draw to the right of the sbar (in non-Nexuiz modes) like quake did

------------------------------------------------------------------------
r3568 | havoc | 2003-10-10 20:12:36 -0700 (Fri, 10 Oct 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

added another todo item for dpmod, sorted list again

------------------------------------------------------------------------
r3567 | havoc | 2003-10-10 20:11:49 -0700 (Fri, 10 Oct 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

made weapon only 50% invisible in Transfusion with the invisibility powerup, and now being dead or invisible only affects the main viewmodel (not viewmodelforccient entities) to allow more flexibility in mods

------------------------------------------------------------------------
r3563 | havoc | 2003-10-09 21:50:00 -0700 (Thu, 09 Oct 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_cmds.c

fixed a crash in PR_objerror (trying to free self when there is no self), and removed an unused prototype called "error();"

------------------------------------------------------------------------
r3562 | havoc | 2003-10-09 21:42:37 -0700 (Thu, 09 Oct 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

one more reminder that nested for(i) loops are bad, mmk?

------------------------------------------------------------------------
r3561 | havoc | 2003-10-09 20:07:18 -0700 (Thu, 09 Oct 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c

this should fix skybox in q3bsp (extra preprocessing pass to look for sky surfaces before rendering normal surfaces, only used if the map has sky surfaces)

------------------------------------------------------------------------
r3560 | havoc | 2003-10-09 18:45:51 -0700 (Thu, 09 Oct 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c

q3bsp surfaces are now always rendered in the same order, made the q1bsp vis overrun/underrun warnings dprintf's, added some (unused) array merging code in q3bsp loading

------------------------------------------------------------------------
r3558 | black | 2003-10-09 12:48:12 -0700 (Thu, 09 Oct 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

Sorry, forgot to remove some debug code from host.c

------------------------------------------------------------------------
r3557 | black | 2003-10-09 12:42:35 -0700 (Thu, 09 Oct 2003) | 4 lines
Changed paths:
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/menu.h
   M /trunk/darkplaces/progsvm.h
   M /trunk/darkplaces/prvm_cmds.c
   M /trunk/darkplaces/prvm_edict.c

Added a lot of builtin commands to prvm_cmds.c (mostly from pr_cmds).
Also changed the menu again, so menu_restart doesnt try to reregister cvars
and cmds any more.

------------------------------------------------------------------------
r3556 | havoc | 2003-10-08 14:57:32 -0700 (Wed, 08 Oct 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/view.c

added back glquake stair step up smoothing, and made it somewhat adjustable (cl_stairsmoothspeed)

------------------------------------------------------------------------
r3555 | havoc | 2003-10-08 14:40:12 -0700 (Wed, 08 Oct 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

fixed Apply option in video options menu (I had forgotten to renumber it)

------------------------------------------------------------------------
r3554 | havoc | 2003-10-08 14:00:04 -0700 (Wed, 08 Oct 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_win.c

fixed a couple warnings on memsetting shm

------------------------------------------------------------------------
r3553 | havoc | 2003-10-08 13:50:28 -0700 (Wed, 08 Oct 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/collision.c
   M /trunk/darkplaces/collision.h
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/winding.c
   M /trunk/darkplaces/winding.h

collision brush generation in q3bsp is now *MUCH* faster and uses a lot less memory (technical: now uses two temp windings, repeatedly swapping between them, avoiding all the temporary allocs, to achieve this BufWinding_NewFromPlane and BufWinding_Divide were added)

------------------------------------------------------------------------
r3552 | havoc | 2003-10-08 13:21:37 -0700 (Wed, 08 Oct 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

fixed splashing sounds once and for all - now splashes only on transitions involving water/slime, rather than the old 'any liquid except lava' check, so this means no more sky splashing...

------------------------------------------------------------------------
r3551 | havoc | 2003-10-07 19:37:00 -0700 (Tue, 07 Oct 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_dma.c

snd_initialized is now checked by S_FindName and S_PrecacheSound (Thanks to Moz for reporting the -nosound crash)

------------------------------------------------------------------------
r3550 | havoc | 2003-10-07 18:28:19 -0700 (Tue, 07 Oct 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.dsp

added prvm_cmds.c prvm_edict.c prvm_exec.c prvm_execprogram.h

------------------------------------------------------------------------
r3549 | havoc | 2003-10-07 17:59:57 -0700 (Tue, 07 Oct 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cd_win.c

fixed a variable declaration I forgot to move when moving some other code

------------------------------------------------------------------------
r3548 | havoc | 2003-10-07 16:45:14 -0700 (Tue, 07 Oct 2003) | 7 lines
Changed paths:
   M /trunk/darkplaces/cd_linux.c
   M /trunk/darkplaces/cd_null.c
   M /trunk/darkplaces/cd_win.c
   M /trunk/darkplaces/cdaudio.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h
   M /trunk/darkplaces/snd_alsa_0_5.c
   M /trunk/darkplaces/snd_alsa_0_9.c
   M /trunk/darkplaces/snd_dma.c
   M /trunk/darkplaces/snd_mem.c
   M /trunk/darkplaces/snd_null.c
   M /trunk/darkplaces/snd_oss.c
   M /trunk/darkplaces/snd_win.c
   M /trunk/darkplaces/sound.h
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_null.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c

cd audio now tied to sound system
sound system now tied to video system because DirectSound needs a window to work at all (thank you Windows for another useless obstacle)
sound system can now restart (snd_restart command)
vid_stencil cvar removed (now tied to 32bit color)
vid_bitsperpixel now defaults to 32
r_shadow_shadows cvar added (default 1) for stencil shadows on dlights (since vid_stencil is gone)

------------------------------------------------------------------------
r3547 | havoc | 2003-10-07 08:16:43 -0700 (Tue, 07 Oct 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile

removed a temporary comment from Black

------------------------------------------------------------------------
r3546 | havoc | 2003-10-07 08:15:33 -0700 (Tue, 07 Oct 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/prvm_edict.c

fix a signed/unsigned comparison warning

------------------------------------------------------------------------
r3545 | black | 2003-10-07 05:12:01 -0700 (Tue, 07 Oct 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/prvm_edict.c

*** empty log message ***

------------------------------------------------------------------------
r3544 | black | 2003-10-07 04:56:02 -0700 (Tue, 07 Oct 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile

AK: Changed makefile temporarily so the new prvm compiles on linux.

------------------------------------------------------------------------
r3543 | black | 2003-10-06 23:19:14 -0700 (Mon, 06 Oct 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/cl_screen.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/menu.h
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/sbar.c
   M /trunk/darkplaces/snd_win.c
   M /trunk/darkplaces/ui.c
   M /trunk/darkplaces/vid_wgl.c

Changed dp so the new vm fits in.

------------------------------------------------------------------------
r3542 | havoc | 2003-10-06 21:49:50 -0700 (Mon, 06 Oct 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

a stab in the dark at supporting unlit q3bsp maps

------------------------------------------------------------------------
r3541 | black | 2003-10-06 11:52:56 -0700 (Mon, 06 Oct 2003) | 2 lines
Changed paths:
   A /trunk/darkplaces/clprogdefs.h
   A /trunk/darkplaces/mprogdefs.h
   A /trunk/darkplaces/progsvm.h
   A /trunk/darkplaces/prvm_cmds.c
   A /trunk/darkplaces/prvm_edict.c
   A /trunk/darkplaces/prvm_exec.c
   A /trunk/darkplaces/prvm_execprogram.h

Adding the new vm

------------------------------------------------------------------------
r3539 | havoc | 2003-10-05 06:48:03 -0700 (Sun, 05 Oct 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h

added COM_ReadAndTokenizeLine, a useful parsing function

------------------------------------------------------------------------
r3538 | havoc | 2003-10-05 06:47:26 -0700 (Sun, 05 Oct 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_edict.c

fix a signed/unsigned comparison in PR_UglyValueString

------------------------------------------------------------------------
r3524 | molivier | 2003-10-02 02:04:12 -0700 (Thu, 02 Oct 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/fs.h
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/r_shadow.c

The crusade against buffer overflows continues...

------------------------------------------------------------------------
r3521 | molivier | 2003-10-01 05:36:29 -0700 (Wed, 01 Oct 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_edict.c

Fixed/switched the "ev_string" and "ev_field" cases in PR_UglyValueString

------------------------------------------------------------------------
r3520 | molivier | 2003-10-01 05:19:26 -0700 (Wed, 01 Oct 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/sys_linux.c
   M /trunk/darkplaces/sys_win.c

Mostly [v]sprintf -> [v]snprintf replacements, and a couple of other fixes regarding buffers management

------------------------------------------------------------------------
r3519 | molivier | 2003-09-30 08:07:55 -0700 (Tue, 30 Sep 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/zone.c

More strcpy -> strlcpy and sprintf -> snprintf

------------------------------------------------------------------------
r3518 | molivier | 2003-09-30 05:58:04 -0700 (Tue, 30 Sep 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cd_linux.c
   M /trunk/darkplaces/cl_demo.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/filematch.c
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/fs.h
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/ui.c

Lots of str[n]cat, str[n]cpy, and [v]sprintf have been replaced by strlcat, strlcpy and [v]snprintf to insure that they don't write outside of their buffers. More to come later.

------------------------------------------------------------------------
r3517 | molivier | 2003-09-30 05:54:02 -0700 (Tue, 30 Sep 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h

Added strlcat and strlcpy, from OpenBSD. They are smart replacements for strncat and strncpy - see http://www.courtesan.com/todd/papers/strlcpy.html or their manual pages on the OpenBSD website for details

------------------------------------------------------------------------
r3516 | havoc | 2003-09-30 01:10:38 -0700 (Tue, 30 Sep 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

md3 flags support (blood trails, etc)

------------------------------------------------------------------------
r3514 | molivier | 2003-09-29 23:36:41 -0700 (Mon, 29 Sep 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c

Fixed 2 potential buffer overflows in SearchInfostring

------------------------------------------------------------------------
r3513 | molivier | 2003-09-29 05:32:57 -0700 (Mon, 29 Sep 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/fs.h

The "position" field of the "qfile_t" structure was (correctly) used for 2 differents things; this is clearly bad practice though, so it's no longer the case. Added a missing test in FS_Seek to insure we don't seek outside of a deflated file. Plus some minor cleanups here and there in the FS code.

------------------------------------------------------------------------
r3505 | havoc | 2003-09-22 13:55:31 -0700 (Mon, 22 Sep 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h

Tomaz's new water effect has been added and looks very nice

------------------------------------------------------------------------
r3504 | havoc | 2003-09-22 13:05:40 -0700 (Mon, 22 Sep 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fixed lightgrid out-of-bounds crash (for example when one hits the very top of a q3bsp)

------------------------------------------------------------------------
r3503 | havoc | 2003-09-22 12:44:20 -0700 (Mon, 22 Sep 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

empty lightgrid lump should now work

------------------------------------------------------------------------
r3501 | havoc | 2003-09-21 19:25:31 -0700 (Sun, 21 Sep 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

disabled GF3 water shader when water is fogged, fixed too-bright normal water rendering (when GF3 water shader is not used)

------------------------------------------------------------------------
r3500 | havoc | 2003-09-21 18:21:54 -0700 (Sun, 21 Sep 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/cl_screen.h
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/portals.c
   M /trunk/darkplaces/r_shadow.c

huge (16%) speed gain on surface rendering by eliminating the surfmesh chain in q1bsp surfaces, now only allows one mesh per surface and the surfmesh_t is embedded in the surface struct

------------------------------------------------------------------------
r3499 | havoc | 2003-09-21 16:23:27 -0700 (Sun, 21 Sep 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

removed RSurf_LightCheck because nothing used it anymore

------------------------------------------------------------------------
r3498 | havoc | 2003-09-21 16:08:36 -0700 (Sun, 21 Sep 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/render.h

r_dlightmap 0 mode removed (vertex dlights on lightmapped walls)

------------------------------------------------------------------------
r3497 | havoc | 2003-09-21 15:45:30 -0700 (Sun, 21 Sep 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_oss.c
   M /trunk/darkplaces/snd_win.c

engine now defaults to 44100hz sound

------------------------------------------------------------------------
r3496 | havoc | 2003-09-21 15:42:57 -0700 (Sun, 21 Sep 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/model_sprite.c

removed r_shadows (glquake fake shadows)

------------------------------------------------------------------------
r3495 | havoc | 2003-09-21 15:06:27 -0700 (Sun, 21 Sep 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_shared.c

r_colorscale gone, v_overbrightbits (cvar which controlled r_colorscale) gone

------------------------------------------------------------------------
r3494 | havoc | 2003-09-21 14:06:24 -0700 (Sun, 21 Sep 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

removed water lighting support

------------------------------------------------------------------------
r3490 | havoc | 2003-09-20 20:34:58 -0700 (Sat, 20 Sep 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/todo

now supports skyboxes in q3bsp (note: must use the "sky" key in worldspawn to set the skybox basename like in q2, and it identifies sky shaders by names beginning with "textures/skies/"), and added a little error checking to Mod_Q1BSP_LoadLeafs, and added a couple todo items

------------------------------------------------------------------------
r3480 | havoc | 2003-09-20 02:16:01 -0700 (Sat, 20 Sep 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h

added GAME_ZYMOTIC

------------------------------------------------------------------------
r3479 | havoc | 2003-09-20 00:34:52 -0700 (Sat, 20 Sep 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/portals.c
   M /trunk/darkplaces/portals.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/todo
   M /trunk/darkplaces/winding.c

finally managed to fix the r_shadow_portallight bug (had to reverse portal handling in many old broken cases), also changed the Portal_Visibility call to take a box instead of a sphere for culling

------------------------------------------------------------------------
r3474 | havoc | 2003-09-19 13:18:30 -0700 (Fri, 19 Sep 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_textures.h
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/vid_shared.c

Tomaz's awesome new GeForce3 water effect, thanks!

------------------------------------------------------------------------
r3473 | havoc | 2003-09-19 12:53:57 -0700 (Fri, 19 Sep 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/cl_screen.h
   M /trunk/darkplaces/menu.c

recoded options menus, and replaced scr_2dresolution with vid_conwidth and vid_conheight cvars (and updated menu accordingly)

------------------------------------------------------------------------
r3472 | havoc | 2003-09-19 12:50:51 -0700 (Fri, 19 Sep 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/portals.c
   M /trunk/darkplaces/portals.h
   M /trunk/darkplaces/r_shadow.c

migrated light bounding box generation from r_shadow code to Portal_Visibility code when using r_shadow_portallight 1, I hoped this would fix bugs but it did not, still it is an optimization...

------------------------------------------------------------------------
r3471 | havoc | 2003-09-19 12:48:42 -0700 (Fri, 19 Sep 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/image.c

flip the X in normalmaps generated from heightmaps (according to FrikaC it was broken)

------------------------------------------------------------------------
r3470 | havoc | 2003-09-19 12:44:00 -0700 (Fri, 19 Sep 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

added some SV_CheckVelocity calls to MOVETYPE_WALK code

------------------------------------------------------------------------
r3469 | havoc | 2003-09-18 18:52:41 -0700 (Thu, 18 Sep 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_demo.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/netconn.h
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/todo

finished a lot of little todo items, mostly regarding server list and networking init bugs, and fixed skybox rendering

------------------------------------------------------------------------
r3468 | havoc | 2003-09-18 12:29:39 -0700 (Thu, 18 Sep 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

after an argument with Black it was decided that GAME_NEXUIZ will be weird (in my opinion) and use a bit number instead of a bitfield for STAT_ACTIVEWEAPON

------------------------------------------------------------------------
r3466 | havoc | 2003-09-17 10:51:31 -0700 (Wed, 17 Sep 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_user.c
   M /trunk/darkplaces/todo

the new partial-update entity compression protocol now works for the first time ever

------------------------------------------------------------------------
r3465 | havoc | 2003-09-17 10:49:51 -0700 (Wed, 17 Sep 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

forgot to include this file in the previous commit (no longer opens gfx.wad until a lump is requested)

------------------------------------------------------------------------
r3464 | havoc | 2003-09-17 10:48:58 -0700 (Wed, 17 Sep 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/wad.c
   M /trunk/darkplaces/wad.h

no longer opens gfx.wad until a lump is requested (and gracefully fails if not found)

------------------------------------------------------------------------
r3462 | havoc | 2003-09-14 19:21:50 -0700 (Sun, 14 Sep 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fixed empty texture lump handling in q1bsp loading

------------------------------------------------------------------------
r3461 | havoc | 2003-09-14 19:21:13 -0700 (Sun, 14 Sep 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/protocol.c

made a commit debugging message only happen with developer_networkentities

------------------------------------------------------------------------
r3460 | havoc | 2003-09-14 14:34:00 -0700 (Sun, 14 Sep 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/protocol.h

move developer_networkentities extern to protocol.h

------------------------------------------------------------------------
r3459 | havoc | 2003-09-13 20:52:21 -0700 (Sat, 13 Sep 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/sbar.c
   M /trunk/darkplaces/sv_main.c

more Nexuiz hud stuff from BlackHC, minor style edits to fit in with surrounding code better

------------------------------------------------------------------------
r3458 | havoc | 2003-09-13 20:40:32 -0700 (Sat, 13 Sep 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

added an item about corona shaders

------------------------------------------------------------------------
r3457 | havoc | 2003-09-13 13:58:33 -0700 (Sat, 13 Sep 2003) | 3 lines
Changed paths:
   M /trunk/darkplaces/mathlib.h

fixed log2i to use parentheses around n
changed bit2i to use log2i((n) << 1)

------------------------------------------------------------------------
r3456 | havoc | 2003-09-13 13:41:35 -0700 (Sat, 13 Sep 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/mathlib.h

added bit2i and log2i (these return the base 2 exponent of an integer, perhaps bit2i should be replaced by log2i() - 1 though)

------------------------------------------------------------------------
r3455 | havoc | 2003-09-13 13:39:35 -0700 (Sat, 13 Sep 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_sky.c

fixed an R_InitSky warning regarding transpix being uninitialized, added transpixunion to clean up the aliasing mess (thanks to Black for pointing this out)

------------------------------------------------------------------------
r3454 | havoc | 2003-09-13 13:37:14 -0700 (Sat, 13 Sep 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/sv_user.c

more developer_networkentities messages

------------------------------------------------------------------------
r3453 | havoc | 2003-09-12 21:50:36 -0700 (Fri, 12 Sep 2003) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_user.c

renamed PROTOCOL_VERSION stuff to PROTOCOL_QUAKE, PROTOCOL_DARKPLACES1, and so on
mostly fixed network entity bugs

------------------------------------------------------------------------
r3452 | havoc | 2003-09-12 21:49:32 -0700 (Fri, 12 Sep 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r3451 | havoc | 2003-09-12 16:57:58 -0700 (Fri, 12 Sep 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c

changed teu game dir to "baseteu" at request of teu team

------------------------------------------------------------------------
r3450 | havoc | 2003-09-12 05:47:02 -0700 (Fri, 12 Sep 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

aitur fixed some important bugs in the error checks of the md2 model loader, thanks!

------------------------------------------------------------------------
r3440 | havoc | 2003-09-08 15:03:15 -0700 (Mon, 08 Sep 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r3439 | havoc | 2003-09-08 15:00:37 -0700 (Mon, 08 Sep 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r3438 | havoc | 2003-09-04 06:34:15 -0700 (Thu, 04 Sep 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

a couple bugfixes in Nehahra demos menu regarding end of menu wrapping (thanks to Vic for pointing out these bugs)

------------------------------------------------------------------------
r3437 | havoc | 2003-09-04 06:30:07 -0700 (Thu, 04 Sep 2003) | 3 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

fix some glitches in the original commit
clean up blank lines

------------------------------------------------------------------------
r3436 | havoc | 2003-09-04 05:30:46 -0700 (Thu, 04 Sep 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/sbar.c

patch from Andreas Kirsh to add Nexuiz hud

------------------------------------------------------------------------
r3435 | havoc | 2003-09-04 02:30:48 -0700 (Thu, 04 Sep 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

the Connect failed error is now just a print

------------------------------------------------------------------------
r3434 | havoc | 2003-09-04 02:25:06 -0700 (Thu, 04 Sep 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

fix a nasty crash with multiplayer servers (thanks to Willis for finding this bug)

------------------------------------------------------------------------
r3432 | havoc | 2003-08-30 23:35:49 -0700 (Sat, 30 Aug 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c

fixed a couple stupid bugs

------------------------------------------------------------------------
r3431 | havoc | 2003-08-30 22:25:23 -0700 (Sat, 30 Aug 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r3430 | havoc | 2003-08-30 22:20:33 -0700 (Sat, 30 Aug 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c

now uses string buffers more sanely and supports multiple strcat buffers (now uses PR_GetTempString), modified PF_VarString to read into a string buffer (FrikaC noticed strcat was being overwritten by print, inconsistent with his implementation of FRIK_FILE)

------------------------------------------------------------------------
r3429 | havoc | 2003-08-30 22:17:06 -0700 (Sat, 30 Aug 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_edict.c

fix a crash related to MAX_EDICTS in "pr_fields" command (thanks to SeienAbunae for reporting this)

------------------------------------------------------------------------
r3428 | havoc | 2003-08-29 18:54:31 -0700 (Fri, 29 Aug 2003) | 5 lines
Changed paths:
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sv_user.c
   M /trunk/darkplaces/todo

reverted the massive svs.connectedclients change, now back to svs.clients and svs.maxclients like quake
this fixes mods detecting singleplayer as multiplayer
this fixes frikbot frags updates on the scoreboard
added most of the capability necessary for botclient extension

------------------------------------------------------------------------
r3427 | havoc | 2003-08-28 20:49:00 -0700 (Thu, 28 Aug 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r3426 | havoc | 2003-08-28 20:46:52 -0700 (Thu, 28 Aug 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/lhnet.c

now prints "Connection refused" if LHNET_Read gets an ECONNREFUSED from inet4 or inet6 (thanks to Andreas Kirsh for this)

------------------------------------------------------------------------
r3425 | havoc | 2003-08-28 07:07:47 -0700 (Thu, 28 Aug 2003) | 3 lines
Changed paths:
   M /trunk/darkplaces/vid_shared.c

v_hwgamma is now saved to config (Andreas Kirsh suggested this and I agree)
gl_combine is now saved to config (due to popular demand, although this really should become a separate overbright cvar instead)

------------------------------------------------------------------------
r3424 | havoc | 2003-08-28 06:52:47 -0700 (Thu, 28 Aug 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_wgl.c

thanks to Andreas Kirsh for a discussion about using WS_EX_TOPMOST flag on the fullscreen window (hopefully this will keep dialogs from cutting holes in the frame like some people have reported)

------------------------------------------------------------------------
r3421 | havoc | 2003-08-28 01:08:07 -0700 (Thu, 28 Aug 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

fixed Prydon Gate behavior regarding the start map (which immediately changes level)

------------------------------------------------------------------------
r3420 | havoc | 2003-08-27 23:32:13 -0700 (Wed, 27 Aug 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h

experimental (not terribly useful) support for r_shadow_realtime_dlight 1 mode (_world mode put on hold for a while)

------------------------------------------------------------------------
r3419 | havoc | 2003-08-27 06:21:30 -0700 (Wed, 27 Aug 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

removed used of PolygonOffset because it caused (extremely minor) visual glitches on the map, and isn't really much help even when using r_drawcollisionbrushes

------------------------------------------------------------------------
r3418 | havoc | 2003-08-27 06:10:41 -0700 (Wed, 27 Aug 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c

fixed a crash with clusterindex -1 in GetPVS and FatPVS

------------------------------------------------------------------------
r3417 | havoc | 2003-08-27 05:22:00 -0700 (Wed, 27 Aug 2003) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/collision.c
   M /trunk/darkplaces/collision.h
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/mathlib.h
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/todo
   M /trunk/darkplaces/world.c

q3bsp curve collisions (technically it can collide against any triangle mesh)
fixed some severe bugs in the q3bsp traceline code
optimized q3bsp tracebrush code - now uses a bbox for the trace, and reduces it to fit each node it encounters, this caused *IMMENSE* speedups!
optimized q3bsp curve collisions to use bbox culling of triangles (to avoid the cost of generating collision brushes most of the time)

------------------------------------------------------------------------
r3416 | molivier | 2003-08-24 23:35:47 -0700 (Sun, 24 Aug 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

Removed useless function M_PrintWhite, since M_Print prints in white already. Added M_PrintRed. Added support for sections for the key binding list (for clarity when using a lot of commands), and made it adjust its position depending on the number of commands. Updated Transfusion key binding list.

------------------------------------------------------------------------
r3415 | havoc | 2003-08-24 17:11:52 -0700 (Sun, 24 Aug 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c

curves are now precomputed at load time, and all surfaces are treated as Q3FACETYPE_MESH (or skipped if they have no triangles)

------------------------------------------------------------------------
r3414 | havoc | 2003-08-24 16:00:26 -0700 (Sun, 24 Aug 2003) | 2 lines
Changed paths:
   A /trunk/darkplaces/curves.c
   A /trunk/darkplaces/curves.h
   M /trunk/darkplaces/darkplaces.dsp
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/todo

the quadratic spline patches in quake3 maps now work (in english: curves!)

------------------------------------------------------------------------
r3413 | havoc | 2003-08-23 21:00:52 -0700 (Sat, 23 Aug 2003) | 3 lines
Changed paths:
   M /trunk/darkplaces/collision.c
   M /trunk/darkplaces/cvar.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/r_shadow.c

no more uses of %g in printf as it tends to lose precision too often (this caused problems with ftos in QuakeC truncating numbers to 6 digits, a problem afflicting Prydon Gate especially)
still tries to print numbers briefly if possible (by checking if their value is an int)

------------------------------------------------------------------------
r3412 | havoc | 2003-08-23 03:30:40 -0700 (Sat, 23 Aug 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r3411 | havoc | 2003-08-23 03:19:26 -0700 (Sat, 23 Aug 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/chase.c

fix severe bug that made chase_up continually increase up to 118 (thanks to yummyluv for pointing this out, and Electro for making me realize why it happened)

------------------------------------------------------------------------
r3410 | havoc | 2003-08-23 01:32:29 -0700 (Sat, 23 Aug 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_light.c

negate the dnormal instead of negating the dotproduct result

------------------------------------------------------------------------
r3409 | havoc | 2003-08-23 01:30:23 -0700 (Sat, 23 Aug 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_light.c

diffusenormal lighting was backwards (thanks to Electro for pointing this out)

------------------------------------------------------------------------
r3408 | havoc | 2003-08-23 01:23:54 -0700 (Sat, 23 Aug 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

don't call PlayerPreThink/PlayerPostThink on unspawned clients

------------------------------------------------------------------------
r3407 | havoc | 2003-08-23 00:09:13 -0700 (Sat, 23 Aug 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

fix a (very bad!) bug with -port cvar setting

------------------------------------------------------------------------
r3406 | havoc | 2003-08-23 00:05:55 -0700 (Sat, 23 Aug 2003) | 3 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

added error messages when opening sockets (reports both success and failure)
added support for legacy -ip and -port options

------------------------------------------------------------------------
r3405 | havoc | 2003-08-22 23:20:30 -0700 (Fri, 22 Aug 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

in the server setup menu, default to 8 players instead of MAX_SCOREBOARD

------------------------------------------------------------------------
r3404 | havoc | 2003-08-22 22:13:31 -0700 (Fri, 22 Aug 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/collision.c

fixed a couple warnings

------------------------------------------------------------------------
r3403 | havoc | 2003-08-22 19:17:04 -0700 (Fri, 22 Aug 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/collision.c
   M /trunk/darkplaces/collision.h
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/todo
   M /trunk/darkplaces/world.c

q3bsp is working, but no curves yet, and no realtime lighting support

------------------------------------------------------------------------
r3402 | havoc | 2003-08-22 16:44:31 -0700 (Fri, 22 Aug 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

fix handling of .alpha, .renderamt, .scale, and .glow_color defaulting when 0 (it has to compare the float value, not the byte version of it)

------------------------------------------------------------------------
r3401 | molivier | 2003-08-19 01:27:24 -0700 (Tue, 19 Aug 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

Someone forgot to increment the number of items in the options menu. Added the "use" button to Transfusion key binding list

------------------------------------------------------------------------
r3400 | havoc | 2003-08-18 21:03:51 -0700 (Mon, 18 Aug 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/chase.c

adjusted up camera height for chase_stevie in GoodVsBad2 as requested by yummyluv

------------------------------------------------------------------------
r3399 | havoc | 2003-08-18 17:43:35 -0700 (Mon, 18 Aug 2003) | 2 lines
Changed paths:
   A /trunk/darkplaces/winding.c
   A /trunk/darkplaces/winding.h

forgot to commit these

------------------------------------------------------------------------
r3398 | havoc | 2003-08-18 17:25:08 -0700 (Mon, 18 Aug 2003) | 4 lines
Changed paths:
   M /trunk/darkplaces/bspfile.h
   M /trunk/darkplaces/cgamevm.c
   M /trunk/darkplaces/chase.c
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/cl_collision.h
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/collision.c
   M /trunk/darkplaces/collision.h
   M /trunk/darkplaces/darkplaces.dsp
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/mathlib.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/r_crosshairs.c
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/sv_move.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sv_user.c
   M /trunk/darkplaces/todo
   M /trunk/darkplaces/view.c
   M /trunk/darkplaces/world.c
   M /trunk/darkplaces/world.h

more q3bsp work (and no it still doesn't work right)
converted over most of the engine to use new SUPERCONTENTS_ values (bit flags), and the q1bsp and q3bsp loaders convert to these, conversion to q1 contents and back is supported as well
other stuff...  I've forgotten what

------------------------------------------------------------------------
r3397 | havoc | 2003-08-18 12:31:41 -0700 (Mon, 18 Aug 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r3396 | havoc | 2003-08-14 12:29:42 -0700 (Thu, 14 Aug 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.dsp

sv_light.c is gone, updated project to remove it

------------------------------------------------------------------------
r3395 | havoc | 2003-08-13 20:48:13 -0700 (Wed, 13 Aug 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/portals.c
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/snd_dma.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/world.c

q3bsp is still not working yet, but getting closer

------------------------------------------------------------------------
r3394 | havoc | 2003-08-13 16:08:58 -0700 (Wed, 13 Aug 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/collision.c
   M /trunk/darkplaces/collision.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/snd_dma.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/todo
   M /trunk/darkplaces/world.c

no time to explain, more changes on the path to q3bsp support

------------------------------------------------------------------------
r3393 | havoc | 2003-08-12 19:17:16 -0700 (Tue, 12 Aug 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_shadow.c

more hackish cleanups of PVS stuff, now decompresses the PVS data at load and this got rid of the last of the calls to LeafPVS (now checks the pvs in the leaf directly)

------------------------------------------------------------------------
r3392 | havoc | 2003-08-12 19:16:04 -0700 (Tue, 12 Aug 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r3391 | havoc | 2003-08-12 19:08:11 -0700 (Tue, 12 Aug 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

I hope this fixes a md3 tag bug, but don't know

------------------------------------------------------------------------
r3390 | havoc | 2003-08-11 05:20:51 -0700 (Mon, 11 Aug 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/sv_main.c

moved SV_FatPVS to model code

------------------------------------------------------------------------
r3389 | havoc | 2003-08-10 13:03:05 -0700 (Sun, 10 Aug 2003) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_light.h
   M /trunk/darkplaces/r_sprites.c
   D /trunk/darkplaces/sv_light.c

moved RecursiveLightPoint code to model_brush.c (model->brush.LightPoint), removing it from r_light.c and sv_light.c (now no longer needed)
made LightPoint able to return quake3 lightgrid data (diffuse color and direction in addition to ambient)

------------------------------------------------------------------------
r3388 | havoc | 2003-08-10 12:58:45 -0700 (Sun, 10 Aug 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r3387 | havoc | 2003-08-10 06:50:00 -0700 (Sun, 10 Aug 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/collision.c
   M /trunk/darkplaces/collision.h
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h

Q3BSP collisions implemented (although not for patches, which aren't supported anyway, yet, and this is definitely not tested yet)

------------------------------------------------------------------------
r3386 | havoc | 2003-08-09 10:57:02 -0700 (Sat, 09 Aug 2003) | 4 lines
Changed paths:
   M /trunk/darkplaces/menu.c

patch supplied by Toddd
changed GAME_BATTLEMECH quit messages
now knows about deathmatch and rambo modes in GAME_BATTLEMECH

------------------------------------------------------------------------
r3385 | havoc | 2003-08-09 10:54:27 -0700 (Sat, 09 Aug 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c

change GAME_BATTLEMECH gamedir to "base" (patch supplied by Toddd)

------------------------------------------------------------------------
r3384 | havoc | 2003-08-09 10:01:04 -0700 (Sat, 09 Aug 2003) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/menu.c

redesigned blood effects (now looks like droplets until they hit a surface)
added decals for bullet impacts, explosions, plasma, etc
added cl_particles_quality cvar (cranks up the number of particles, reducing their alpha, making softer effects)
removed cl_particles_blood_size and cl_particles_smoke_size cvars

------------------------------------------------------------------------
r3383 | havoc | 2003-08-09 09:56:06 -0700 (Sat, 09 Aug 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_edict.c

fixed loadgame bug with edict references to later edicts (d was pointing at the old address, redesigned how it works to fix this)

------------------------------------------------------------------------
r3379 | havoc | 2003-08-08 15:23:49 -0700 (Fri, 08 Aug 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r3378 | havoc | 2003-08-08 15:22:30 -0700 (Fri, 08 Aug 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_user.qc

fixed compile errors

------------------------------------------------------------------------
r3377 | havoc | 2003-08-08 15:19:01 -0700 (Fri, 08 Aug 2003) | 2 lines
Changed paths:
   A /trunk/darkplaces/sv_user.qc

sample implementation of QC replacement physics (already available on website, but it might as well become a maintainable thing in cvs)

------------------------------------------------------------------------
r3376 | havoc | 2003-08-08 15:06:08 -0700 (Fri, 08 Aug 2003) | 3 lines
Changed paths:
   M /trunk/darkplaces/sv_user.c

reverted noclip movement to quake behavior (commented out the free movement call) to fix Cannon Fodder Quake ( http://www.qexpo.com/booths.php?id=5 )
ported sv_user.qc to C (C -> QC -> C again) because it greatly reduces the amount of code and makes it a bit more maintainable

------------------------------------------------------------------------
r3373 | havoc | 2003-08-07 04:01:38 -0700 (Thu, 07 Aug 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/todo

multiplayer-only games (Transfusion and so on) now start playing demos as usual, rather than starting a server at startup (unless dedicated or -listen is used)

------------------------------------------------------------------------
r3372 | havoc | 2003-08-07 03:56:24 -0700 (Thu, 07 Aug 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c

fix a warning

------------------------------------------------------------------------
r3371 | havoc | 2003-08-07 03:44:20 -0700 (Thu, 07 Aug 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/lhnet.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/netconn.h

simulated packet loss (cl_fakepacketloss_receive, cl_fakepacketloss_send, sv_fakepacketloss_receive, sv_fakepacketloss_send) and ping (cl_fakelocalping_min, cl_fakelocalping_max) for network testing (or to handicap oneself in a local game)

------------------------------------------------------------------------
r3370 | havoc | 2003-08-07 03:41:28 -0700 (Thu, 07 Aug 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r3369 | havoc | 2003-08-07 03:38:26 -0700 (Thu, 07 Aug 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c

sigh, one more thing I forgot to commit :(

------------------------------------------------------------------------
r3368 | havoc | 2003-08-06 09:33:26 -0700 (Wed, 06 Aug 2003) | 4 lines
Changed paths:
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/netconn.h
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/server.h

working code is better than broken code
code that compiles is good too...
(fix bugs/unfinished code in the DPPROTOCOL_VERSION4 commit)

------------------------------------------------------------------------
r3367 | havoc | 2003-08-06 06:16:48 -0700 (Wed, 06 Aug 2003) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/netconn.h
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/sbar.c
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sv_user.c

upgraded network protocol to DPPROTOCOL_VERSION4 - this means partial entity updates are now supported (limited bandwidth entity updates), although the "rate" cvar stuff has not been implemented yet...  it also means entirely dynamic resizing of arrays in the server's entity database per client, so memory usage goes *WAY* down (used to be 256mb for 64 players, no matter what map/mod, now entirely adaptive as the game goes)
svs.clients gone, replaced with svs.connectedclients (similar idea except this is an array of pointers, and they are NULL for any unconnected client slots), this means entirely dynamic memory usage depending on number of clients (at least in the server; the client still needs fixing), this also means "maxplayers" is now a cvar (sv_maxplayers internally), not a command
some fixes/cleanups/tweaks (like proper setup of default maxplayers and deathmatch cvar in multiplayer-only games incase someone starts a map from console right away without using the menus)

------------------------------------------------------------------------
r3366 | havoc | 2003-08-06 06:11:33 -0700 (Wed, 06 Aug 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r3365 | havoc | 2003-08-06 03:22:10 -0700 (Wed, 06 Aug 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/collision.c

optimized polygon collision code a bit (optimized node side comparison)

------------------------------------------------------------------------
r3363 | havoc | 2003-08-03 06:20:27 -0700 (Sun, 03 Aug 2003) | 4 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/world.c
   M /trunk/darkplaces/world.h

added MOVE_WORLDONLY movement type
now does vis traces using MOVE_WORLDONLY to get a significant speed boost (back to the way it was before) and hopefully prevent any problems with transparent solid bmodels blocking visibility of
entities

------------------------------------------------------------------------
r3362 | havoc | 2003-08-03 06:05:22 -0700 (Sun, 03 Aug 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r3361 | havoc | 2003-08-03 06:04:04 -0700 (Sun, 03 Aug 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

fix skin loading on mdl (and probably md2) models by not setting numskins unless skin file override is happening

------------------------------------------------------------------------
r3352 | havoc | 2003-07-30 17:26:34 -0700 (Wed, 30 Jul 2003) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/r_shadow.c

corrected a few LittleLongs to LittleFloat in md3 loading (EEP those were bad)
.skin loading is now able to parse the quake3 format, and uses "common/nodraw" or "textures/common/nodraw" for the invisible parts, this also meant supporting replacement tag names in the .skin files...  so that's implemented as well (quite difficult)
COM_ParseToken upgraded to be able to parse .skin files (now identifies more single character tokens, and can return newlines if desired - this required patching lots of code to pass false to it)
added beginnings of support for DPPROTOCOL_VERSION4 in client (I.E. does nothing right now because the server speaks DPPROTOCOL_VERSION3)

------------------------------------------------------------------------
r3351 | havoc | 2003-07-30 17:25:40 -0700 (Wed, 30 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r3350 | havoc | 2003-07-30 17:16:05 -0700 (Wed, 30 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

simplified dlight fading code

------------------------------------------------------------------------
r3346 | havoc | 2003-07-28 16:47:05 -0700 (Mon, 28 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/protocol.h

added code for protocol 4, not hooked up or tested

------------------------------------------------------------------------
r3345 | havoc | 2003-07-28 16:46:11 -0700 (Mon, 28 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r3344 | havoc | 2003-07-28 04:45:56 -0700 (Mon, 28 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

I hope this fixes tags on md3 models, but I don't have any idea...

------------------------------------------------------------------------
r3343 | havoc | 2003-07-28 04:02:26 -0700 (Mon, 28 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c

fix setattachment (it was setting tag_index to i, should have been i + 1), also added some developer warnings if it fails

------------------------------------------------------------------------
r3340 | havoc | 2003-07-26 22:23:35 -0700 (Sat, 26 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile

disable -Werror because it makes a mess of releases if anyone has warnings (like a certain release I made a few days ago...  and then got 5 or so 'it doesn't compile' reports from Linux users :)

------------------------------------------------------------------------
r3339 | havoc | 2003-07-26 22:20:17 -0700 (Sat, 26 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

remove an unused variable (and kill the one incorrect use of it)

------------------------------------------------------------------------
r3338 | havoc | 2003-07-26 22:13:27 -0700 (Sat, 26 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/sv_main.c

added MAX_PACKETFRAGMENT to limit size of reliable packets, and also try to keep effects from pushing it over the limit either, this means the only possible way to push it over the limit is entity updates, and if exceeding the limit the packets might be lost, possibly dropping the player...  but at least everything else should work now.

------------------------------------------------------------------------
r3337 | havoc | 2003-07-26 21:52:19 -0700 (Sat, 26 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r3335 | havoc | 2003-07-26 03:52:35 -0700 (Sat, 26 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

missing )

------------------------------------------------------------------------
r3333 | havoc | 2003-07-26 02:34:23 -0700 (Sat, 26 Jul 2003) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

changed .skin loading behavior to compare mesh name, not shader name, this matches quake3 behavior
now shows r_notexture if a texture is missing on md2/md3 and missing .skin replacements

------------------------------------------------------------------------
r3332 | havoc | 2003-07-26 01:28:43 -0700 (Sat, 26 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

report if skins are missing in SkinFiles system

------------------------------------------------------------------------
r3331 | havoc | 2003-07-25 17:18:35 -0700 (Fri, 25 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r3330 | havoc | 2003-07-25 17:09:41 -0700 (Fri, 25 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r3329 | havoc | 2003-07-25 17:08:21 -0700 (Fri, 25 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r3328 | havoc | 2003-07-25 15:35:59 -0700 (Fri, 25 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r3327 | havoc | 2003-07-25 02:23:03 -0700 (Fri, 25 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

marked a couple done, and sorted

------------------------------------------------------------------------
r3326 | havoc | 2003-07-25 02:19:31 -0700 (Fri, 25 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/dpmod/qc/dpextensions.qc

added DP_GFX_SKINFILES and DP_GFX_QUAKE3MODELTAGS extensions

------------------------------------------------------------------------
r3325 | havoc | 2003-07-25 01:56:56 -0700 (Fri, 25 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/todo

support for %s_%i.skin files on alias models (I.E. progs/test.mdl_0.skin), which contain "replace" commands, followed by the name of the mesh skin to replace ("default" for mdl/md2), and the replacement name, any skins that are not replaced are set to not draw (this means of course that a model can have extra pieces that become invisible in some skins)

------------------------------------------------------------------------
r3324 | havoc | 2003-07-24 14:45:53 -0700 (Thu, 24 Jul 2003) | 3 lines
Changed paths:
   M /trunk/darkplaces/mingw_note.txt

removed gl.h from the list
added note that the dx includes can be found in q1source.zip on the id ftp

------------------------------------------------------------------------
r3323 | havoc | 2003-07-24 14:43:23 -0700 (Thu, 24 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/mingw_note.txt

wsipx.h is not needed anymore, removed from the list

------------------------------------------------------------------------
r3322 | havoc | 2003-07-24 14:14:06 -0700 (Thu, 24 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/mingw_note.txt

a correction about mingw makefile

------------------------------------------------------------------------
r3321 | havoc | 2003-07-24 13:08:50 -0700 (Thu, 24 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/menu.c

added Battlemech (thanks to Todd for submitting the patch, though I replaced his quit messages)

------------------------------------------------------------------------
r3320 | havoc | 2003-07-24 12:30:54 -0700 (Thu, 24 Jul 2003) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/todo
   M /trunk/darkplaces/view.c

md3 tag attachments (implemented but untested), also the capability to attach any entity to any other entity without tags (I.E. Q2 vwep models should work if attached to tag "")
redesigned large portions of entity networking (client and server) to deal with the hierarchical entity associations, viewmodel handling (client and server), view handling (client)
this may have fixed some unknown bugs regarding viewmodels and such (I hope so, it's cleaner, although more complicated)

------------------------------------------------------------------------
r3319 | havoc | 2003-07-24 11:45:20 -0700 (Thu, 24 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

cleaned up quit message system, now GAME_GOODVSBAD2's quit messages work and it's easy to add other games, also added back quake messages for quake/hipnotic/rogue modes

------------------------------------------------------------------------
r3318 | havoc | 2003-07-24 00:20:18 -0700 (Thu, 24 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

a little more explanation of shadow edge code

------------------------------------------------------------------------
r3317 | havoc | 2003-07-23 23:12:03 -0700 (Wed, 23 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

quite possibly the smallest ever commit - deleting an obsolete comment

------------------------------------------------------------------------
r3316 | warp | 2003-07-22 15:02:47 -0700 (Tue, 22 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_sky.c

Kill an unused increment.

------------------------------------------------------------------------
r3315 | havoc | 2003-07-22 13:02:16 -0700 (Tue, 22 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_alias.h
   M /trunk/darkplaces/model_shared.h

now loads md3 tags

------------------------------------------------------------------------
r3314 | havoc | 2003-07-22 12:23:37 -0700 (Tue, 22 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/protocol.h

fixed TE_BLOOD2 (by making it go away, it was not used by anyone, now an empty slot named TE_UNUSED1)

------------------------------------------------------------------------
r3312 | havoc | 2003-07-22 11:50:38 -0700 (Tue, 22 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/collision.c
   M /trunk/darkplaces/collision.h
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/world.c
   M /trunk/darkplaces/world.h

collision code cleanups (model->brush.TraceBox is now used for everything except of course bbox collisions which use Collision_ClipTrace_Box)

------------------------------------------------------------------------
r3311 | havoc | 2003-07-22 11:45:55 -0700 (Tue, 22 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/view.c

get rid of bobbing when dead

------------------------------------------------------------------------
r3310 | havoc | 2003-07-22 11:44:34 -0700 (Tue, 22 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/mathlib.h

added VectorLerp

------------------------------------------------------------------------
r3309 | havoc | 2003-07-22 11:42:43 -0700 (Tue, 22 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/bspfile.h

added Q2 and Q3 contents flags

------------------------------------------------------------------------
r3308 | havoc | 2003-07-22 11:12:51 -0700 (Tue, 22 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

viewmodels should not emit dlights (they spawn around 0 0 0), thanks to Tomaz for reporting this

------------------------------------------------------------------------
r3307 | havoc | 2003-07-22 11:08:08 -0700 (Tue, 22 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_light.c

gl_flashblend 1 now disables model dlighting like it was supposed to (thanks to Tomaz for reporting this)

------------------------------------------------------------------------
r3306 | havoc | 2003-07-22 10:22:21 -0700 (Tue, 22 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

fix major editing mistake in Mod_LoadSkinFrame (it was using basepixels_width/height for nmappixels), thanks to Tomaz for finding this bug

------------------------------------------------------------------------
r3305 | havoc | 2003-07-22 09:35:40 -0700 (Tue, 22 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/image.c

add a couple Mem_CheckSentinelsGlobal calls to loadimagepixels when developer_memorydebug is on (I really can't imagine these ever being needed, but might as well check)

------------------------------------------------------------------------
r3304 | havoc | 2003-07-22 09:31:39 -0700 (Tue, 22 Jul 2003) | 3 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

use proper string for conn->address when accepting a new client (otherwise it could easily be so bogus as to trash the netconn structure)
thanks very much to Tomaz for tracking down this major bug

------------------------------------------------------------------------
r3303 | havoc | 2003-07-22 09:28:27 -0700 (Tue, 22 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/zone.h

expose the developer_memory and developer_memorydebug cvars for use in other modules

------------------------------------------------------------------------
r3301 | havoc | 2003-07-21 17:46:50 -0700 (Mon, 21 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

two more dpzoo items

------------------------------------------------------------------------
r3300 | havoc | 2003-07-21 17:41:57 -0700 (Mon, 21 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.dsp

thanks to Tomaz for pestering me about the fact his last project files didn't get committed somehow (I KNOW I did commit it!  but it didn't stick somehow)

------------------------------------------------------------------------
r3299 | havoc | 2003-07-21 15:36:38 -0700 (Mon, 21 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

more changes

------------------------------------------------------------------------
r3298 | havoc | 2003-07-21 15:24:03 -0700 (Mon, 21 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

some more battlemech related todo items

------------------------------------------------------------------------
r3297 | havoc | 2003-07-21 14:26:10 -0700 (Mon, 21 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

added a battlemech bug report

------------------------------------------------------------------------
r3296 | havoc | 2003-07-21 13:48:44 -0700 (Mon, 21 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r3295 | havoc | 2003-07-20 21:15:18 -0700 (Sun, 20 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/lhnet.c

fix an error in a last minute change (was using maxcontentlength in Write, which takes contentlength)

------------------------------------------------------------------------
r3294 | havoc | 2003-07-20 21:04:31 -0700 (Sun, 20 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

skip over NULL sockets in cl_sockets and sv_sockets lists

------------------------------------------------------------------------
r3293 | havoc | 2003-07-20 21:03:12 -0700 (Sun, 20 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/lhnet.c

patch up some major cracks in the armor of the functions (they now don't like being passed NULL for anything)

------------------------------------------------------------------------
r3292 | havoc | 2003-07-20 16:21:40 -0700 (Sun, 20 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

marked gl_texturemode bug as done (apparently I fixed it at some point long ago and forgot about fixing it), thanks to Vic for noticing this

------------------------------------------------------------------------
r3291 | havoc | 2003-07-19 10:53:04 -0700 (Sat, 19 Jul 2003) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_move.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/world.c
   M /trunk/darkplaces/world.h

added SV_PointContents
moved PointContents and FindNonSolidLocation function pointers into brush from brushq1
added TraceBox function pointer to brush (but no implementations of it yet)

------------------------------------------------------------------------
r3290 | havoc | 2003-07-19 10:51:39 -0700 (Sat, 19 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r3289 | havoc | 2003-07-18 14:20:03 -0700 (Fri, 18 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.dsp

thanks to Tomaz for updating the project files

------------------------------------------------------------------------
r3288 | havoc | 2003-07-18 12:42:08 -0700 (Fri, 18 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/todo

*** empty log message ***

------------------------------------------------------------------------
r3286 | havoc | 2003-07-18 11:40:01 -0700 (Fri, 18 Jul 2003) | 3 lines
Changed paths:
   A /trunk/darkplaces/todo

finally I decided to commit my todo list, for whoever wants to contribute to the effort of finishing items on it
NOTE: I sort this periodically, so if any items are out of order they will be sorted later

------------------------------------------------------------------------
r3285 | havoc | 2003-07-18 10:24:44 -0700 (Fri, 18 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.h

now loads q3 bsp (but can't render it or collide with it, so don't try it)

------------------------------------------------------------------------
r3284 | havoc | 2003-07-17 07:57:05 -0700 (Thu, 17 Jul 2003) | 7 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/cl_collision.h
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/collision.c
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/model_sprite.c
   M /trunk/darkplaces/portals.c
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_sprites.c
   M /trunk/darkplaces/snd_dma.c
   M /trunk/darkplaces/sv_light.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_move.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/view.c

moved all type-specific model fields to respective structures (alias, sprite, brush)
renamed model_t brush to brushq1, and created brush, brushq2, brushq3, currently brush only has entities, all else is type specific
wrote the beginnings of a q3 bsp loader (and of course the headers)
added functions CL_PointContents and CL_FindNonSolidLocation to simplify queries of world model (and make it more maintainable when q3bsp support is finished)
added r_shadow_glossintensity cvar (default 1) for glossmap textures
added r_shadow_gloss2intensity cvar (default 0.25) for forced gloss

------------------------------------------------------------------------
r3278 | havoc | 2003-07-15 02:09:24 -0700 (Tue, 15 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile

turn down optimizations to -O2 because some versions of gcc are buggy on higher settings

------------------------------------------------------------------------
r3277 | havoc | 2003-07-15 02:07:27 -0700 (Tue, 15 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/zone.c

increase number of digits for memlist reports

------------------------------------------------------------------------
r3276 | havoc | 2003-07-15 02:06:38 -0700 (Tue, 15 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

jpeg screenshot support in cl_avidemo recording

------------------------------------------------------------------------
r3275 | havoc | 2003-07-14 08:46:58 -0700 (Mon, 14 Jul 2003) | 6 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/makefile
   A /trunk/darkplaces/r_lightning.c
   M /trunk/darkplaces/view.c

added r_lightning.c to move the lightning beam rendering code out of cl_main.c
shrunk entity_t struct a bit (by removing some stuff from persistent which had similar/identical values in render)
restructured/refactored some of entity relinking (now all relinking happens in cl_main.c where it belongs, moved viewmodel stuff out of view code)
restructured how viewmodels are handled
streamlined/cleanedup/refactored V_CalcRefdef (and merged in V_UpdateBlends and V_AddIdle and V_CalcBob)

------------------------------------------------------------------------
r3274 | havoc | 2003-07-14 08:38:23 -0700 (Mon, 14 Jul 2003) | 3 lines
Changed paths:
   M /trunk/darkplaces/snd_mem.c

now reports resamplesfx calls that don't involve resampling (of course only if developer is on)
now reports if memory allocation failed for a sound during loading

------------------------------------------------------------------------
r3272 | rain | 2003-07-14 01:23:51 -0700 (Mon, 14 Jul 2003) | 3 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c

Fix the event mask so that the gamma is reset when DP loses the focus or
the pointer leaves the window.

------------------------------------------------------------------------
r3271 | havoc | 2003-07-14 01:21:52 -0700 (Mon, 14 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

now defaults to 20% brightness conback because I got the first of many reports of 'broken console'

------------------------------------------------------------------------
r3270 | havoc | 2003-07-14 00:48:16 -0700 (Mon, 14 Jul 2003) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/screen.h

added scr_conbrightness cvar
added scr_conspeed, scr_conalpha, and scr_conbrightness cvars to options menu
moved definitions and externs of scr_conspeed, scr_conalpha, and scr_conbrightness cvars to cl_screen.c/screen.h

------------------------------------------------------------------------
r3269 | havoc | 2003-07-14 00:46:44 -0700 (Mon, 14 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/image.c

fix loading of skins that end in ".tga" or similar (now strips image extensions off the shader name before loading the textures)

------------------------------------------------------------------------
r3268 | havoc | 2003-07-13 10:54:42 -0700 (Sun, 13 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

added some (untested) terrain code for whomever cares

------------------------------------------------------------------------
r3267 | havoc | 2003-07-13 10:53:50 -0700 (Sun, 13 Jul 2003) | 3 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

compare coop.value instead of coop.integer
(no difference in any mod I know of, but...)

------------------------------------------------------------------------
r3266 | havoc | 2003-07-13 10:49:10 -0700 (Sun, 13 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

added a very important part of GAME_GOODVSBAD2 support (it was not in the gamelist array and thus its levels were not listed)

------------------------------------------------------------------------
r3265 | havoc | 2003-07-13 03:22:32 -0700 (Sun, 13 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/vid_shared.c

GL_EXT_texture_filter_anisotropic support (thanks zinx!)

------------------------------------------------------------------------
r3263 | havoc | 2003-07-12 21:20:50 -0700 (Sat, 12 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

slight simplification of fog layer in alias skins

------------------------------------------------------------------------
r3262 | havoc | 2003-07-12 21:09:47 -0700 (Sat, 12 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

fixed a severe bug in texcoord2f[] reading in Mod_BuildTextureVectorsAndNormals

------------------------------------------------------------------------
r3261 | havoc | 2003-07-12 09:50:07 -0700 (Sat, 12 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_lerpanim.c
   M /trunk/darkplaces/r_light.c

fix a bunch of things that should have been checking if the model (usually cl.worldmodel) was not NULL before calling its functions

------------------------------------------------------------------------
r3260 | havoc | 2003-07-12 09:49:09 -0700 (Sat, 12 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

now sends nops to server as unreliable, to avoid trashing the reliable packet system, this fixed connecting through NAT (!)

------------------------------------------------------------------------
r3258 | havoc | 2003-07-12 08:05:33 -0700 (Sat, 12 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

NetConn_Write should print packets even if LHNET_Write returns 0

------------------------------------------------------------------------
r3257 | havoc | 2003-07-12 07:59:53 -0700 (Sat, 12 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c

added GL_HALFLIFE_MAP_CVAR extension to list (the cvar is ancient)

------------------------------------------------------------------------
r3256 | havoc | 2003-07-12 07:57:20 -0700 (Sat, 12 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

added .ent file loading to client

------------------------------------------------------------------------
r3243 | havoc | 2003-07-12 03:01:17 -0700 (Sat, 12 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c

added DP_GFX_EXTERNALTEXTURES extension to list

------------------------------------------------------------------------
r3233 | havoc | 2003-07-11 20:09:32 -0700 (Fri, 11 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/sbar.c

got rid of frags per hour and time connected in scoreboard (both full size and mini) because both depended on scoreboard_t->entertime (which has been removed as it was not accurate)

------------------------------------------------------------------------
r3232 | havoc | 2003-07-11 20:07:49 -0700 (Fri, 11 Jul 2003) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

all outputs of Mod_BuildTextureVectorsAndNormals are now optional
slightly optimized Mod_BuildTextureVectorsAndNormals

------------------------------------------------------------------------
r3228 | havoc | 2003-07-11 00:45:10 -0700 (Fri, 11 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/r_lerpanim.c
   M /trunk/darkplaces/r_sprites.c
   M /trunk/darkplaces/render.h

added cvars r_lerpsprites, r_lerpmodels, and r_waterscroll (and to menu as well)

------------------------------------------------------------------------
r3227 | havoc | 2003-07-11 00:44:17 -0700 (Fri, 11 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

added a note about another kind of terrain strip and documented code for generating the strips

------------------------------------------------------------------------
r3225 | havoc | 2003-07-09 21:33:57 -0700 (Wed, 09 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/palette.c

err I guess BuildGammaTable8 was used!

------------------------------------------------------------------------
r3224 | havoc | 2003-07-09 21:30:53 -0700 (Wed, 09 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/mathlib.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/palette.c

#if 0'd out a few unused functions

------------------------------------------------------------------------
r3223 | havoc | 2003-07-09 21:21:51 -0700 (Wed, 09 Jul 2003) | 4 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

server no longer responds to any netquake control packets (must use netchan-style commands to connect)
connection process now uses getchallenge-connect approach to prevent join floods (who knows maybe I fixed NAT by doing this too, somehow)
improved some of the command packet handling

------------------------------------------------------------------------
r3222 | havoc | 2003-07-09 21:19:22 -0700 (Wed, 09 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

added decals to effects options menu

------------------------------------------------------------------------
r3221 | havoc | 2003-07-09 21:15:39 -0700 (Wed, 09 Jul 2003) | 3 lines
Changed paths:
   M /trunk/darkplaces/pr_execprogram.h

added a tip to runaway loop error (suggesting use of the profile command)
made all possible exit paths of the execution update profile counts properly before exiting

------------------------------------------------------------------------
r3220 | havoc | 2003-07-09 21:12:34 -0700 (Wed, 09 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

added 'readable' version of a particular line of code in shadow volume building

------------------------------------------------------------------------
r3191 | havoc | 2003-07-08 03:06:53 -0700 (Tue, 08 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

check svc_setview against MAX_EDICTS

------------------------------------------------------------------------
r3190 | havoc | 2003-07-08 03:04:59 -0700 (Tue, 08 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

fixed a buffer overflow in SV_BroadcastPrintf

------------------------------------------------------------------------
r3189 | havoc | 2003-07-08 03:03:46 -0700 (Tue, 08 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

more of the fixes to clients joining and properly setting up edicts (forgot to commit this with sv_main.c and pr_edict.c)

------------------------------------------------------------------------
r3188 | havoc | 2003-07-08 03:00:47 -0700 (Tue, 08 Jul 2003) | 6 lines
Changed paths:
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/sv_main.c

fixed a lot of problems with filling out client edicts properly (or rather, not filling them out properly) which mostly appeared when doing changelevel or restart
fixed nameless player joins/exits (finally!)
code cleanups
other little things stomped
took another stab at fixing bogus entities being linked into areagrid (presumably caused by SV_IncreaseEdicts), hopefully fixing it this time (as if that wasn't the hope with all the previous attempts)

------------------------------------------------------------------------
r3186 | havoc | 2003-07-08 02:54:27 -0700 (Tue, 08 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c
   M /trunk/darkplaces/netconn.h

some enhancements to timeout handling inspired by ProQuake fixes - net_connecttimeout cvar (a short timeout until first packet in connection), net_messagerejointimeout cvar (only kicks off old client matching peeraddress if the client has reached this message timeout)

------------------------------------------------------------------------
r3185 | havoc | 2003-07-08 02:51:12 -0700 (Tue, 08 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c

redesigned much of PF_VarString to clean it up (shorter, faster, etc)

------------------------------------------------------------------------
r3184 | havoc | 2003-07-08 02:50:21 -0700 (Tue, 08 Jul 2003) | 3 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

fixed model shadows going through walls (by making everything use a constant project distance - clearly there are other solutions to the problem of a model using too low a project distance, but this works...)
some code shuffling (mostly to match up with a previous version I was comparing against)

------------------------------------------------------------------------
r3170 | havoc | 2003-07-06 00:50:07 -0700 (Sun, 06 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c

renamed GAME_GOODVSBAD2 executable to gvb2

------------------------------------------------------------------------
r3169 | havoc | 2003-07-06 00:49:39 -0700 (Sun, 06 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

reverted RunParticleEffect appearance in non-GOODVSBAD2 mode because they were far too different looking

------------------------------------------------------------------------
r3168 | havoc | 2003-07-06 00:48:57 -0700 (Sun, 06 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c

allow traceline to take unusual values for nomonsters parameter again (like original quake traceline)

------------------------------------------------------------------------
r3163 | havoc | 2003-07-03 18:36:14 -0700 (Thu, 03 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/lhnet.c

because gethostbyname("0.0.0.0") fails in windows, the fallback was being called and it was broken, replaced it with a working one based on sscanf

------------------------------------------------------------------------
r3162 | havoc | 2003-07-03 16:56:12 -0700 (Thu, 03 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/lhnet.c

fix htons warnings in MSVC (thanks to Tomaz for reporting this, apparently MSVC warns about passing int to functions taking unsigned short)

------------------------------------------------------------------------
r3161 | havoc | 2003-07-03 16:40:07 -0700 (Thu, 03 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_explosion.c

fixed numerous bugs with explosion hull shape (now looks consistently correct for the first time ever)

------------------------------------------------------------------------
r3160 | havoc | 2003-07-03 14:23:09 -0700 (Thu, 03 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.dsp

Tomaz updated the darkplaces project file (thanks!)

------------------------------------------------------------------------
r3149 | havoc | 2003-07-03 00:01:34 -0700 (Thu, 03 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_dma.c

ambients should be forced to loop as well

------------------------------------------------------------------------
r3148 | havoc | 2003-07-02 23:59:54 -0700 (Wed, 02 Jul 2003) | 3 lines
Changed paths:
   M /trunk/darkplaces/snd_dma.c
   M /trunk/darkplaces/snd_mix.c
   M /trunk/darkplaces/sound.h

sounds now follow their owner (so riding a lift doesn't leave the sound at the start position, for example)
static sounds now automatically loop even if they have no cue list

------------------------------------------------------------------------
r3147 | havoc | 2003-07-02 17:45:48 -0700 (Wed, 02 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_user.c

got rid of sv_predict because it caused too many problems with mods trying to have multiple entities attached to eachother

------------------------------------------------------------------------
r3137 | havoc | 2003-07-01 22:58:28 -0700 (Tue, 01 Jul 2003) | 3 lines
Changed paths:
   M /trunk/darkplaces/snd_dma.c
   M /trunk/darkplaces/snd_null.c
   M /trunk/darkplaces/sound.h

added snd_staticvolume to snd_null.c
fixed prototype of SND_Spatialize in sound.h

------------------------------------------------------------------------
r3136 | havoc | 2003-07-01 22:48:36 -0700 (Tue, 01 Jul 2003) | 4 lines
Changed paths:
   M /trunk/darkplaces/cd_linux.c
   M /trunk/darkplaces/cd_win.c
   M /trunk/darkplaces/chase.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/jpeg.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/sbar.c
   M /trunk/darkplaces/snd_dma.c
   M /trunk/darkplaces/snd_mem.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c

added support for GAME_GOODVSBAD2
moved Hostname option from Player Setup to server setup menu, and renamed it "Server name"
added snd_staticvolume cvar to control volume of static sounds

------------------------------------------------------------------------
r3135 | havoc | 2003-07-01 22:44:34 -0700 (Tue, 01 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h

added GAME_GOODVSBAD2 and GAME_TEU

------------------------------------------------------------------------
r3134 | havoc | 2003-07-01 20:50:33 -0700 (Tue, 01 Jul 2003) | 3 lines
Changed paths:
   M /trunk/darkplaces/menu.c

redesigned menuplyr handling again - now allocates memory for it instead of using a static buffer
merged together some menuplyr code

------------------------------------------------------------------------
r3133 | havoc | 2003-07-01 19:26:26 -0700 (Tue, 01 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_alias.h
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/model_sprite.c
   M /trunk/darkplaces/model_sprite.h
   M /trunk/darkplaces/model_zymotic.h
   M /trunk/darkplaces/portals.c
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/snd_dma.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_move.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/view.c

changed brush model API - now uses function pointers for some of the brush model functions (intent to transition over to this completely)

------------------------------------------------------------------------
r3119 | havoc | 2003-07-01 11:43:42 -0700 (Tue, 01 Jul 2003) | 9 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_crosshairs.c
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/r_sprites.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/vid_shared.c

redesigned how the renderer handles much of it's state (R_Mesh_State turned into R_Mesh_State_Textures - no longer handles blendfunc and depthmask and depthtest and vertex pointers and so on)
batching is gone
VAR support is gone (but may make a return someday)
dynamic shadow volumes are now more optimized (removal of unused verts)
added a glossary of terminology to the start of r_shadow.c
added gl_mesh_testarrayelement and gl_mesh_testmanualfeeding cvars for testing/debugging purposes in the backend (incase vertex array state is a mess)
added gl_paranoid cvar (enables CHECKGLERROR and verifies geometry before rendering it)
added gl_printcheckerror cvar (prints location of every CHECKGLERROR statement as it executes, for tracking code flow)

------------------------------------------------------------------------
r3118 | havoc | 2003-07-01 11:32:11 -0700 (Tue, 01 Jul 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/world.c

extremely minor optimization to linking edicts into area grid

------------------------------------------------------------------------
r3111 | havoc | 2003-06-30 19:59:36 -0700 (Mon, 30 Jun 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

Disable singleplayer menu in Nexuiz (just like Transfusion does)

------------------------------------------------------------------------
r3107 | havoc | 2003-06-28 16:09:08 -0700 (Sat, 28 Jun 2003) | 4 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

reverted SV_Physics_Step to exactly match quake (shorter though)
removed a clear velocity statement in SV_Physics_Toss
some whitespace cleanup

------------------------------------------------------------------------
r3106 | havoc | 2003-06-27 13:25:54 -0700 (Fri, 27 Jun 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_demo.c

fix timedemos (it was not starting the timer because it was misjudging what the next frame number is)

------------------------------------------------------------------------
r3104 | havoc | 2003-06-26 09:51:35 -0700 (Thu, 26 Jun 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_mem.c

a prototype for the long dead function S_Alloc removed (thanks to Vic for mentioning this)

------------------------------------------------------------------------
r3103 | havoc | 2003-06-26 09:21:20 -0700 (Thu, 26 Jun 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

fix a bug in non-monster interpolation code (it was checking RENDER_STEP and doing a really bad job of it too, thanks to Vic for reporting this bug)

------------------------------------------------------------------------
r3102 | havoc | 2003-06-24 08:10:58 -0700 (Tue, 24 Jun 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

ReceivedMessage now sets lastMessageTime when a valid message or ack is received, this fixes the timeout problems (yes, all of them)

------------------------------------------------------------------------
r3095 | havoc | 2003-06-22 03:31:36 -0700 (Sun, 22 Jun 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/netconn.c

initialize the various server properties when parsing an infoResponse incase some are not set

------------------------------------------------------------------------
r3094 | havoc | 2003-06-22 03:07:16 -0700 (Sun, 22 Jun 2003) | 2 lines
Changed paths:
   A /trunk/darkplaces/lhnet.c
   A /trunk/darkplaces/lhnet.h
   A /trunk/darkplaces/netconn.c
   A /trunk/darkplaces/netconn.h

Forgot to include lhnet in the previous commit and tried to abort the commit but apparently it was nearly done (which messed up netconn.[ch] such that I could not add or delete netconn.[ch], so I deleted that from cvs and added it again)

------------------------------------------------------------------------
r3093 | havoc | 2003-06-22 02:58:55 -0700 (Sun, 22 Jun 2003) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_demo.c
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/menu.h
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   D /trunk/darkplaces/net.h
   D /trunk/darkplaces/net_bsd.c
   D /trunk/darkplaces/net_dgrm.c
   D /trunk/darkplaces/net_dgrm.h
   D /trunk/darkplaces/net_loop.c
   D /trunk/darkplaces/net_loop.h
   D /trunk/darkplaces/net_main.c
   D /trunk/darkplaces/net_master.c
   D /trunk/darkplaces/net_master.h
   D /trunk/darkplaces/net_udp.c
   D /trunk/darkplaces/net_udp.h
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_user.c

This is the network rewrite I've been working on for over a week; multiplayer should work through NAT routers now.
A few other commits (a new clientcolors extension for example) have snuck their way into this commit because they were waiting while the cvs was down.

------------------------------------------------------------------------
r3092 | havoc | 2003-06-22 02:55:02 -0700 (Sun, 22 Jun 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/world.c

report invalid edicts when attempting to link them

------------------------------------------------------------------------
r3090 | havoc | 2003-06-21 04:05:32 -0700 (Sat, 21 Jun 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/zone.c

added developer_memorydebug cvar (does CheckSentinelsGlobal on all Mem_Alloc calls)

------------------------------------------------------------------------
r3080 | havoc | 2003-06-08 21:19:09 -0700 (Sun, 08 Jun 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

Sbar_UpdateScoreboard was totally unused in quake, it's history (as are the arrays it used)

------------------------------------------------------------------------
r3073 | havoc | 2003-06-07 22:47:20 -0700 (Sat, 07 Jun 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/progs.h

fix a couple EDICT_NUM errors that often happened when loading savegames with more than 256 entities

------------------------------------------------------------------------
r3072 | havoc | 2003-06-07 22:43:44 -0700 (Sat, 07 Jun 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

cleaned up Host_Error a bit

------------------------------------------------------------------------
r3071 | havoc | 2003-06-07 22:42:58 -0700 (Sat, 07 Jun 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/world.c

fix SOLID_BSP with non-BSP model error that can occur after a Host_Error (fixed by using Mod_CheckLoaded)

------------------------------------------------------------------------
r3070 | havoc | 2003-06-07 12:21:07 -0700 (Sat, 07 Jun 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/sv_user.c

KRIMZON_SV_PARSECLIENTCOMMAND extension (untested currently!)

------------------------------------------------------------------------
r3069 | havoc | 2003-06-07 12:20:06 -0700 (Sat, 07 Jun 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile

no longer uses -Werror on exe builds

------------------------------------------------------------------------
r3068 | havoc | 2003-06-07 12:19:16 -0700 (Sat, 07 Jun 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/sys_linux.c

fix an uninitialized variable warning in win32

------------------------------------------------------------------------
r3067 | havoc | 2003-06-04 12:26:35 -0700 (Wed, 04 Jun 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/net_dgrm.c

fixed forged packet identification to only care about address (not port) and do so in a cleaner way than before

------------------------------------------------------------------------
r3066 | havoc | 2003-06-04 12:24:41 -0700 (Wed, 04 Jun 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

added support for gl_mesh_copyarrays 0 mode in most shaders

------------------------------------------------------------------------
r3065 | havoc | 2003-06-04 12:22:31 -0700 (Wed, 04 Jun 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/net_udp.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/wad.c

fixed a bunch of signed/unsigned mismatch warnings in newer gcc versions (mostly related to size_t being unsigned)

------------------------------------------------------------------------
r3063 | havoc | 2003-06-02 22:18:04 -0700 (Mon, 02 Jun 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/world.c

fixed bug that used bmodel collision geometry on non-SOLID_BSP entities (thanks to FrikaC for reporting this bug)

------------------------------------------------------------------------
r3059 | havoc | 2003-05-28 06:57:47 -0700 (Wed, 28 May 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_user.c

got rid of my attempts to delay sending the ServerInfo packet until the first message from the client, because the ServerInfo packet is already handled by the quake reliable message system and thus will be re-sent multiple times...  back to the drawing board on my attempts to fix quake through NAT routers

------------------------------------------------------------------------
r3057 | havoc | 2003-05-27 19:00:46 -0700 (Tue, 27 May 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile

apparently -Werr isn't valid in gcc3.2, so switch to -Werror

------------------------------------------------------------------------
r3051 | havoc | 2003-05-26 11:58:16 -0700 (Mon, 26 May 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/cl_screen.h
   M /trunk/darkplaces/gl_draw.c

2D art can now be drawn using vertex pointers

------------------------------------------------------------------------
r3050 | havoc | 2003-05-26 11:57:25 -0700 (Mon, 26 May 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile

added back -Werr so warnings are errors

------------------------------------------------------------------------
r3049 | havoc | 2003-05-26 11:52:04 -0700 (Mon, 26 May 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_sky.c

fix some warnings I kept forgetting

------------------------------------------------------------------------
r3048 | havoc | 2003-05-26 11:20:52 -0700 (Mon, 26 May 2003) | 3 lines
Changed paths:
   M /trunk/darkplaces/r_explosion.c

removed directional shading on explosions because it was a nuisance to maintain (and strangely they seem to look better now)
explosion rendering now supports gl_mesh_copyarrays 0

------------------------------------------------------------------------
r3047 | havoc | 2003-05-26 11:18:59 -0700 (Mon, 26 May 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_models.c

fix a warning caused by the fact vertex pointers are now const

------------------------------------------------------------------------
r3046 | havoc | 2003-05-26 11:17:48 -0700 (Mon, 26 May 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h

vertex pointers are now const

------------------------------------------------------------------------
r3045 | havoc | 2003-05-26 09:35:14 -0700 (Mon, 26 May 2003) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/r_sky.c

added R_ScrollTexCoord2f (copies while texture coordinates with an offset)
added multitexture path to skysphere rendering (10% speed gain) and modified combine setup in gl_backend to support GL_INTERPOLATE_ARB behaving like GL_DECAL
added support for gl_mesh_copyarrays 0 mode in skysphere rendering (1% speed gain)

------------------------------------------------------------------------
r3044 | havoc | 2003-05-26 06:25:59 -0700 (Mon, 26 May 2003) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h

fixed realtime lighting bugs with gl_mesh_batching 1 (... by not using batching while rendering realtime lighting - I was unable to figure out what was causing the problem)
some cleanups to realtime lighting code (mostly fixing some bugs with incorrect counting of meshes/triangles (for r_speeds reports), and optimized out unnecessary vertex copying in the final lighting application pass)

------------------------------------------------------------------------
r3043 | havoc | 2003-05-26 06:23:27 -0700 (Mon, 26 May 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_models.c

no longer uses R_Shadow_VertexBuffer, instead uses aliasvert_vertex3f

------------------------------------------------------------------------
r3040 | havoc | 2003-05-25 18:01:36 -0700 (Sun, 25 May 2003) | 3 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_user.c

fixed connection process again
added developer prints for changes to sendserverinfo

------------------------------------------------------------------------
r3039 | havoc | 2003-05-25 15:47:36 -0700 (Sun, 25 May 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/net_dgrm.c

fix an unused variable warning

------------------------------------------------------------------------
r3038 | havoc | 2003-05-25 15:46:31 -0700 (Sun, 25 May 2003) | 6 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/net.h
   M /trunk/darkplaces/net_dgrm.c
   M /trunk/darkplaces/net_loop.c
   M /trunk/darkplaces/net_main.c
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_user.c

some cleanups to hostcache (got rid of driver/address stuff and expanded the strings, also increased number of cache slots)
connecting to a server is now much more direct (does not use hostcache)
now ignores the address string received in server info packets because it's often bogus in dp (sorry...  but not really avoidable)
slist reports now include the address of the server (useful!!) and are much wider (79 characters) to give more room for info
the NOROUTINGFIX option has been kind of merged away, whether the server uses it or not is still optional (search for routing fix)

------------------------------------------------------------------------
r3037 | havoc | 2003-05-25 15:38:29 -0700 (Sun, 25 May 2003) | 2 lines
Changed paths:
   D /trunk/darkplaces/makefile.mingw
   D /trunk/darkplaces/makefile.mingwcross

no longer needed (makefile does it all now)

------------------------------------------------------------------------
r3036 | havoc | 2003-05-25 15:37:49 -0700 (Sun, 25 May 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile

merged makefile, makefile.mingw (outdated) and makefile.mingwcross into one makefile

------------------------------------------------------------------------
r3035 | havoc | 2003-05-25 15:35:07 -0700 (Sun, 25 May 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/net_master.c

removed rick.cube-sol.net from master server list because it's not resolving and was really delaying server lists

------------------------------------------------------------------------
r3034 | havoc | 2003-05-25 15:33:03 -0700 (Sun, 25 May 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/sys_linux.c
   M /trunk/darkplaces/sys_shared.c
   M /trunk/darkplaces/sys_win.c

merged dll handling code into sys_shared.c because the code in sys_linux.c was for both windows and linux, no real point in separating them

------------------------------------------------------------------------
r3033 | havoc | 2003-05-25 09:26:02 -0700 (Sun, 25 May 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.mingwcross

fix darkplaces-dedicated.exe building to open a console

------------------------------------------------------------------------
r3032 | havoc | 2003-05-25 09:17:37 -0700 (Sun, 25 May 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/sys.h
   M /trunk/darkplaces/sys_linux.c
   M /trunk/darkplaces/sys_shared.c
   M /trunk/darkplaces/sys_win.c

Sys_Print added to handle the output of text to the terminal (since this varies from platform to platform and may depend on whether it is dedicated)

------------------------------------------------------------------------
r3031 | havoc | 2003-05-25 08:48:00 -0700 (Sun, 25 May 2003) | 5 lines
Changed paths:
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/makefile.mingwcross
   M /trunk/darkplaces/sys_linux.c
   M /trunk/darkplaces/sys_shared.c

darkplaces-dedicated.exe now builds
sys_linux.c (needs new name badly!) modified to support windows for purposes of darkplaces-dedicated.exe
Sys_Printf probably no longer works properly with darkplaces.exe (but we'll see)
darkplaces.exe should now be a proper windows app again (how I got --mwindows in there I don't know), so -dedicated may work

------------------------------------------------------------------------
r3030 | havoc | 2003-05-25 04:59:58 -0700 (Sun, 25 May 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_models.c

alias model fake shadows can now be cached

------------------------------------------------------------------------
r3029 | havoc | 2003-05-25 04:44:31 -0700 (Sun, 25 May 2003) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

fixed a severe bug with pointer_color state tracking (no longer checks .colorarray, so you don't have to do the GL_Color/GL_UseColorArray call before R_Mesh_State anymore), this fixes explosion coloring when using pointer_color for other stuff rendered immediately before it
fixed a crash when entire sequentialchain is emptied while trying to get space for a new cache item (this happened!  I can't guess why though)

------------------------------------------------------------------------
r3028 | havoc | 2003-05-25 04:40:34 -0700 (Sun, 25 May 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_explosion.c

simplified explosion rendering a little (probably a very minor slowdown, but more maintainable)

------------------------------------------------------------------------
r3027 | havoc | 2003-05-24 07:53:30 -0700 (Sat, 24 May 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_light.h

alias model (q1/q2/q3) rendering now supports gl_mesh_copyarrays 0 (even caches lighting!) for a speed boost (enough to compensate for the current loss on world rendering), note that only normal rendering uses this so far (more rendering functions to upgrade)

------------------------------------------------------------------------
r3026 | havoc | 2003-05-24 07:48:33 -0700 (Sat, 24 May 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.h

made id_pointer fields of rcachearrayrequest_t const (because they'll never be used as pointers anyway)

------------------------------------------------------------------------
r3025 | havoc | 2003-05-24 07:47:32 -0700 (Sat, 24 May 2003) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

disabled various testing code in R_Mesh_CacheArray
fixed a bug with pointer_color if gl_mesh_floatcolors is false (it was incorrectly comparing p to varray_buf_color4f, it should have compared it to NULL)

------------------------------------------------------------------------
r3023 | havoc | 2003-05-24 00:18:47 -0700 (Sat, 24 May 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_wgl.c

possible stability improvement in VID_Shutdown - moved ChangeDisplaySettings call after DestroyWindow

------------------------------------------------------------------------
r3021 | havoc | 2003-05-23 11:38:34 -0700 (Fri, 23 May 2003) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_alias.h

aliasvertex_t no longer exists, models are now stored as arrays of vertex3f, svector3f, tvector3f, normal3f
cleaned up loaders somewhat (they're still nasty as always)
now validates elements in mdl model files

------------------------------------------------------------------------
r3020 | havoc | 2003-05-23 11:36:28 -0700 (Fri, 23 May 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_rsurf.c

added R_Mesh_CacheArray (not yet used by anything, but has been tested with some code in gl_rsurf.c), a generic dynamic data caching system intended for vertex arrays

------------------------------------------------------------------------
r3019 | havoc | 2003-05-23 00:43:26 -0700 (Fri, 23 May 2003) | 6 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/r_sky.c

added gl_mesh_batching (default on) which merges several meshes in a row to reduce overhead of array locking and drawing
added MESH_VAR and MESH_BATCH defines to allow relevant code to be disabled (MESH_VAR is currently disabled because it's somewhat broken last I checked)
added custom array pointer support in R_Mesh_State (MainState and TextureState), this is experimental but works fine
added gl_mesh_copyarrays (default off) which tells renderer code that it should use custom array pointer support instead of copying (currently testable on surface rendering - not a good use, too many Pointer calls for very little geometry)
some other cleanups

------------------------------------------------------------------------
r3018 | havoc | 2003-05-23 00:38:25 -0700 (Fri, 23 May 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/console.h

console logging (-condebug) now starts earlier in the startup process (just after the filesystem)

------------------------------------------------------------------------
r3017 | havoc | 2003-05-22 23:58:34 -0700 (Thu, 22 May 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/bspfile.h
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h

more preparation for quake2 bsp support

------------------------------------------------------------------------
r3016 | havoc | 2003-05-22 23:30:36 -0700 (Thu, 22 May 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

merged SV_Physics_Client into SV_Physics (not difficult)

------------------------------------------------------------------------
r3015 | havoc | 2003-05-22 23:28:05 -0700 (Thu, 22 May 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/sys_win.c

cleaned up/simplified Sys_Error, now should never get in a recursive crash loop, but also lost the timeout on dedicated server errors as a result (if engine crashes, the server will leave up a dialog eternally until someone closes it)

------------------------------------------------------------------------
r3009 | havoc | 2003-05-21 05:15:06 -0700 (Wed, 21 May 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_dma.c

renamed "precache" cvar to "snd_precache" because it's name was very confusing

------------------------------------------------------------------------
r3008 | havoc | 2003-05-21 04:24:20 -0700 (Wed, 21 May 2003) | 4 lines
Changed paths:
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/image.h
   M /trunk/darkplaces/jpeg.c

added support for q2 .wal images (not yet tested but suspected as working)
cleaned up multiple format loader hub, now parses a list of formats things to try
cleaned up invalid image size detection (now all format loaders check for >4096 and <=0 in each axis)

------------------------------------------------------------------------
r3007 | havoc | 2003-05-21 02:08:15 -0700 (Wed, 21 May 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.c

beginning to add Q2 bsp support (Q3 bsp support coming later)

------------------------------------------------------------------------
r3006 | havoc | 2003-05-21 02:05:15 -0700 (Wed, 21 May 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/world.c

added a note about an id bug with triggers and ignoring .owner (the fact they don't)

------------------------------------------------------------------------
r3005 | molivier | 2003-05-19 00:11:22 -0700 (Mon, 19 May 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

Fix Transfusion bug 030429-01 (If you go to the console from the options menu, then exit the console, you can't get back to the menu)

------------------------------------------------------------------------
r3001 | havoc | 2003-05-17 03:29:35 -0700 (Sat, 17 May 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

fixed a bug with Host_Startdemos_f that caused it to never shorten the list of demos (it forgot to clear the remaining slots)

------------------------------------------------------------------------
r3000 | havoc | 2003-05-16 04:34:56 -0700 (Fri, 16 May 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/image.c

corrected call to Image_HasAlpha to be Image_CheckAlpha

------------------------------------------------------------------------
r2999 | havoc | 2003-05-16 04:10:32 -0700 (Fri, 16 May 2003) | 3 lines
Changed paths:
   M /trunk/darkplaces/image.c

replaced a loop that checked for alpha pixels with a call to Image_HasAlpha
fixed a memory leak on s->maskpixels (due to memory pools this leak was probably not too bad)

------------------------------------------------------------------------
r2998 | havoc | 2003-05-16 04:09:23 -0700 (Fri, 16 May 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c

added DP_GFX_SKYBOX and DP_CL_LOADSKY extensions

------------------------------------------------------------------------
r2996 | havoc | 2003-04-29 09:04:40 -0700 (Tue, 29 Apr 2003) | 3 lines
Changed paths:
   M /trunk/darkplaces/protocol.h

new entity protocol has been canceled due to a fatal design flaw only detected today (insufficient data on history of entities)
added explanation of old entity protocol and how it will be revised to use partial entity updates (without breaking compatibility with old clients!)

------------------------------------------------------------------------
r2989 | havoc | 2003-04-26 03:21:02 -0700 (Sat, 26 Apr 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/net_dgrm.c
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sv_user.c
   M /trunk/darkplaces/world.c

reverted dynamic allocation of sv.edicts because there are FAR too many broken pointer cases, however shrinking the edict_t to just a couple pointers and dynamically allocating the data they point to, keeps memory usage way down

------------------------------------------------------------------------
r2988 | havoc | 2003-04-26 03:19:21 -0700 (Sat, 26 Apr 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

increased default gl_mesh_maxverts to 65536, and also increased the limit to that

------------------------------------------------------------------------
r2987 | havoc | 2003-04-26 03:03:42 -0700 (Sat, 26 Apr 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/net_udp.c

cleaned up UDP_Init a bit

------------------------------------------------------------------------
r2985 | havoc | 2003-04-25 07:43:10 -0700 (Fri, 25 Apr 2003) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/net_dgrm.c
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_user.c
   M /trunk/darkplaces/world.c

sv.edicts (and related things) are now dynamically reallocated as more edicts are used
no edict_t *'s exist in any persistent structures anymore, using edict numbers in all such cases (as it turns out the only such structs were client_t in server.h and link_t in progs.h)
edicts are unlinked before reallocation and relinked after reallocation to keep the link_t pointers valid

------------------------------------------------------------------------
r2984 | havoc | 2003-04-25 07:39:22 -0700 (Fri, 25 Apr 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/net_udp.c

UDP_Init now tries to bind to INADDR_ANY and various others in sequence

------------------------------------------------------------------------
r2983 | havoc | 2003-04-25 05:44:22 -0700 (Fri, 25 Apr 2003) | 3 lines
Changed paths:
   M /trunk/darkplaces/fs.c

pk3 is now case insensitive to match quake3 behavior (however pak is still case sensitive)
FS_FileExtension has been basically rewritten, it was taking the first . in the filename (which might even be part of a directory name)

------------------------------------------------------------------------
r2981 | havoc | 2003-04-23 04:48:05 -0700 (Wed, 23 Apr 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_execprogram.h

increased runaway loop counter 10x (now 10 million opcodes before runaway error

------------------------------------------------------------------------
r2975 | havoc | 2003-04-21 04:27:09 -0700 (Mon, 21 Apr 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

always do r_shadow_realtime_dlight if r_shadow_realtime_world is on

------------------------------------------------------------------------
r2974 | havoc | 2003-04-21 04:26:22 -0700 (Mon, 21 Apr 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

nudge dlights out of walls if they're too close

------------------------------------------------------------------------
r2973 | havoc | 2003-04-21 03:05:18 -0700 (Mon, 21 Apr 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_sprite.c

added TEXF_CLAMP flag on model and sprite textures (software quake did not support out of bounds texcoords, so repeat is clearly unnecessary and even undesirable)

------------------------------------------------------------------------
r2970 | havoc | 2003-04-19 22:48:03 -0700 (Sat, 19 Apr 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/keys.h
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_wgl.c

thanks to "backslash" for submitting a patch to support Intellimouse Explorer's two extra buttons (side buttons), I expanded the patch to support up to 10 mouse buttons (plus mwheelup/mwheeldown) in both GLX and WGL ports.

------------------------------------------------------------------------
r2969 | havoc | 2003-04-19 22:39:54 -0700 (Sat, 19 Apr 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix flipped sprites

------------------------------------------------------------------------
r2963 | havoc | 2003-04-18 05:11:30 -0700 (Fri, 18 Apr 2003) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_alias.h

reorganized aliaslayer_t handling to fix a few bugs
fixed md2 models
fixed skinless models

------------------------------------------------------------------------
r2962 | havoc | 2003-04-18 05:03:57 -0700 (Fri, 18 Apr 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

very minor correction to a comment

------------------------------------------------------------------------
r2961 | havoc | 2003-04-18 05:03:09 -0700 (Fri, 18 Apr 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_light.c

inlined the only call of R_ModelLightPoint (in R_LightModel)

------------------------------------------------------------------------
r2960 | havoc | 2003-04-18 05:01:12 -0700 (Fri, 18 Apr 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

greatly improved pointfile command, it now shows a huge beam crosshair at the site of the leak entity

------------------------------------------------------------------------
r2959 | havoc | 2003-04-18 04:59:16 -0700 (Fri, 18 Apr 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cmd.c

parser can now handle recursive commands (although this still doesn't work with the whole Cmd_Argv/Cmd_Argc stuff)

------------------------------------------------------------------------
r2958 | havoc | 2003-04-18 04:58:05 -0700 (Fri, 18 Apr 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_demo.c

Fixed bug in record command (it was running a map command before getting the demo name, which gets replaced by the map command parameter, causing the demo to always be named the same as the map)

------------------------------------------------------------------------
r2957 | havoc | 2003-04-18 04:53:26 -0700 (Fri, 18 Apr 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

fix model lighting (pitch was backwards)

------------------------------------------------------------------------
r2948 | havoc | 2003-04-14 15:23:12 -0700 (Mon, 14 Apr 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c

added some extensions I forgot to put in the list before

------------------------------------------------------------------------
r2945 | havoc | 2003-04-14 05:18:45 -0700 (Mon, 14 Apr 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/net_main.c

removed special cases for transfusion in server search messages (now prints gamename)

------------------------------------------------------------------------
r2944 | havoc | 2003-04-13 20:04:10 -0700 (Sun, 13 Apr 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_edict.c

expanded stats reporting (when in developer mode) of how many entities were processed during loading (now displays parsed/inhibited/spawned/died)

------------------------------------------------------------------------
r2943 | havoc | 2003-04-13 03:45:08 -0700 (Sun, 13 Apr 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/net_udp.c

expanded UDP_Read and UDP_Write error messages to include the function parameters

------------------------------------------------------------------------
r2942 | havoc | 2003-04-09 21:03:59 -0700 (Wed, 09 Apr 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

Mod_FindNonSolidLocation fixed for no map case (again)

------------------------------------------------------------------------
r2935 | havoc | 2003-04-08 01:11:45 -0700 (Tue, 08 Apr 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/host_cmd.c

fix two more fs_gamedir mixups (loading saved games should now work, as well as video playback)

------------------------------------------------------------------------
r2934 | havoc | 2003-04-08 01:02:01 -0700 (Tue, 08 Apr 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c

added DP_QUAKE3_MODEL extension (thanks to Elric for pointing out the need for this)

------------------------------------------------------------------------
r2929 | havoc | 2003-04-06 23:40:44 -0700 (Sun, 06 Apr 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

disable use of scissor when stencil is not available (sure seems like a driver bug, scissor should work)

------------------------------------------------------------------------
r2928 | havoc | 2003-04-06 22:31:37 -0700 (Sun, 06 Apr 2003) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_shadow.c

some more minor cleanups
bug with dlights when not using stencil has not been found yet

------------------------------------------------------------------------
r2927 | havoc | 2003-04-06 18:45:34 -0700 (Sun, 06 Apr 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

fixed M_ScanSaves to use FS_Open properly

------------------------------------------------------------------------
r2926 | havoc | 2003-04-06 18:44:56 -0700 (Sun, 06 Apr 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_mix.c

fixed name of dpavi.wav file to work correctly with FS_Open (this is in commented out code though so it doesn't matter)

------------------------------------------------------------------------
r2925 | havoc | 2003-04-06 18:43:11 -0700 (Sun, 06 Apr 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

forgot to make a couple changes before committing this

------------------------------------------------------------------------
r2924 | havoc | 2003-04-06 18:28:47 -0700 (Sun, 06 Apr 2003) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h

split r_shadow_realtime into r_shadow_realtime_world (which requires stencil) and r_shadow_realtime_dlight (which works without stencil)
one bug remains with scissoring dlights without stencil, I'll try to figure out this problem soon

------------------------------------------------------------------------
r2920 | havoc | 2003-04-06 12:24:33 -0700 (Sun, 06 Apr 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h

redesigned surfmesh allocation in brush model loader, in preparation for some more drastic changes

------------------------------------------------------------------------
r2919 | havoc | 2003-04-06 12:23:34 -0700 (Sun, 06 Apr 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile

release build optimizations changed - removed -funroll-loops, added -O9

------------------------------------------------------------------------
r2910 | havoc | 2003-04-05 16:23:21 -0800 (Sat, 05 Apr 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/protocol.h

revised EntityFrame4 function prototypes (no I still haven't coded this)

------------------------------------------------------------------------
r2909 | havoc | 2003-04-05 08:53:14 -0800 (Sat, 05 Apr 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

optimized shadow volume generation a bit (only projects vertices that are necessary)

------------------------------------------------------------------------
r2901 | havoc | 2003-04-03 12:56:05 -0800 (Thu, 03 Apr 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/protocol.h

preparation for a new protocol upgrade to use partial frame updates

------------------------------------------------------------------------
r2900 | havoc | 2003-04-03 12:55:08 -0800 (Thu, 03 Apr 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/view.c

got rid of use of eye in entity database

------------------------------------------------------------------------
r2899 | havoc | 2003-04-03 12:49:31 -0800 (Thu, 03 Apr 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/quakedef.h

added MAX_NETRELIABLE define (currently same as MAX_DATAGRAM, but will change someday)

------------------------------------------------------------------------
r2897 | molivier | 2003-04-03 00:02:14 -0800 (Thu, 03 Apr 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/cl_screen.h
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/jpeg.c
   M /trunk/darkplaces/jpeg.h
   M /trunk/darkplaces/menu.c

Added support for JPEG screenshots. You can toggle that with the cvar "scr_screenshot_jpeg" or the option menu. Note that you'll need the libjpeg library DLL.

------------------------------------------------------------------------
r2895 | havoc | 2003-04-02 16:11:08 -0800 (Wed, 02 Apr 2003) | 3 lines
Changed paths:
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_user.c

fix for server dying when someone times out
some other cleanups (some Sys_Printf calls turned into Con_Printf, some comments added about DropClient calls)

------------------------------------------------------------------------
r2894 | havoc | 2003-04-02 10:51:59 -0800 (Wed, 02 Apr 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/protocol.c

fix for incorrect rounding of vertex locations when using RENDER_LOWPRECISION (now it always rounds to nearest)

------------------------------------------------------------------------
r2892 | havoc | 2003-04-01 16:22:15 -0800 (Tue, 01 Apr 2003) | 3 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/pr_exec.c
   M /trunk/darkplaces/pr_execprogram.h

cleaned up pr_builtins array (now uses NULL instead of PF_fixme) and now reports builtin number if an unknown builtin is called
fixed name of PF_setcolor (was setcolors)

------------------------------------------------------------------------
r2891 | havoc | 2003-04-01 16:20:10 -0800 (Tue, 01 Apr 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/net_main.c

fixed NET_SendToAll

------------------------------------------------------------------------
r2890 | havoc | 2003-03-31 13:46:06 -0800 (Mon, 31 Mar 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/image.c

added some commented out code to Image_HeightmapToNormalmap explaining how to do heightmap to normalmap conversion a little bit differently (very insignificant difference, purely code for those who care)

------------------------------------------------------------------------
r2889 | havoc | 2003-03-31 13:43:50 -0800 (Mon, 31 Mar 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c

QSG_FILE removed because some mods use the old builtin numbers and think that QSG_FILE would provide them (FRIK_FILE remains, which uses the new numbers already)

------------------------------------------------------------------------
r2888 | havoc | 2003-03-30 11:19:06 -0800 (Sun, 30 Mar 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

dlights now cast shadows in realtime lighting mode again (actually they already did, but it wasn't working for world, because world didn't have the shadow flag set)

------------------------------------------------------------------------
r2887 | havoc | 2003-03-30 11:18:05 -0800 (Sun, 30 Mar 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_dma.c
   M /trunk/darkplaces/snd_mem.c
   M /trunk/darkplaces/sound.h

no longer complains about missing ambient liquid sounds in nexuiz

------------------------------------------------------------------------
r2886 | havoc | 2003-03-30 00:40:28 -0800 (Sun, 30 Mar 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/dpvsimpledecode.c

removed a couple unused hz_bitstream_read functions

------------------------------------------------------------------------
r2878 | havoc | 2003-03-29 12:02:11 -0800 (Sat, 29 Mar 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_models.c

fix zym model rendering (wrong vertex padding)

------------------------------------------------------------------------
r2877 | havoc | 2003-03-29 10:58:11 -0800 (Sat, 29 Mar 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c
   M /trunk/darkplaces/fs.h

Elric added deflated file support for pk3 archives (in other words: compressed pk3 now work), even with FS_Seek support, I'm amazed, thanks Elric! :)

------------------------------------------------------------------------
r2875 | havoc | 2003-03-28 08:45:23 -0800 (Fri, 28 Mar 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/gl_rmain.c

corrected the misspelled name GAME_NEXIUZ (and related things) to GAME_NEXUIZ (and related things)

------------------------------------------------------------------------
r2873 | havoc | 2003-03-28 07:47:33 -0800 (Fri, 28 Mar 2003) | 3 lines
Changed paths:
   M /trunk/darkplaces/net_udp.c

UDP_StringToAddr did not work with less than full x.x.x.x:x specifications, now it supports all the stuff PartialIPAddress supported (filling in most significant components with myAddr, etc)
UDP_Read and UDP_Write now log entire packets to console if developer_networking is on

------------------------------------------------------------------------
r2872 | havoc | 2003-03-28 07:45:20 -0800 (Fri, 28 Mar 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/net_dgrm.c

add support for NAT fix in the client (by no longer checking the port a connection accepted came from)

------------------------------------------------------------------------
r2871 | havoc | 2003-03-28 07:43:52 -0800 (Fri, 28 Mar 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/net.h
   M /trunk/darkplaces/net_main.c

added developer_networking cvar

------------------------------------------------------------------------
r2870 | havoc | 2003-03-28 05:27:15 -0800 (Fri, 28 Mar 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/net_dgrm.c

Thanks to faded (of the tenebrae team) for provoking me to recite a lengthy explanation of NAT nightmares, and realize this very simple fix for NQ server support of clients behind NAT routers (send first message from the player socket instead of the accept socket)

------------------------------------------------------------------------
r2869 | havoc | 2003-03-28 05:24:11 -0800 (Fri, 28 Mar 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

changed behavior of SV_DropClient a bit (now calls ClientDisconnect QC function even if crash is true, as it's the client being harshly dropped, not the server dying), and made the final svc_disconnect an unreliable message

------------------------------------------------------------------------
r2868 | havoc | 2003-03-28 05:22:06 -0800 (Fri, 28 Mar 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/net_main.c

refactored NET_SendToAll, it is debatable whether it is more readable or not, but it works the same, and is shorter, and I think it is slightly more understandable than the mess it used to be

------------------------------------------------------------------------
r2867 | havoc | 2003-03-28 02:31:28 -0800 (Fri, 28 Mar 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/net_dgrm.c
   M /trunk/darkplaces/net_master.c
   M /trunk/darkplaces/net_master.h

net_inetslist (and the corresponding menu as well) now work without being an active server (dfunc.controlSock is now used for all transactions involved, and since there is always one of those...)

------------------------------------------------------------------------
r2866 | havoc | 2003-03-28 02:29:42 -0800 (Fri, 28 Mar 2003) | 6 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h

MSG_ReadFloat now checks if the message has enough bytes for a float before trying to decode it (why id forgot this I don't know)
added MSG_ReadBigShort, MSG_ReadBigLong, MSG_ReadBigFloat, MSG_ReadBytes
renamed MSG_ReadShort to MSG_ReadLittleShort, MSG_ReadLong to MSG_ReadLittleLong, and MSG_ReadFloat to MSG_ReadLittleFloat
added #defines for MSG_ReadShort, MSG_ReadLong, and MSG_ReadFloat to use their Little versions
optimized/cleaned up MSG_Read functions (some are now significantly shorter)

------------------------------------------------------------------------
r2865 | havoc | 2003-03-28 00:37:13 -0800 (Fri, 28 Mar 2003) | 5 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.dsp
   M /trunk/darkplaces/makefile.mingw
   M /trunk/darkplaces/makefile.mingwcross
   M /trunk/darkplaces/net_udp.c
   D /trunk/darkplaces/net_wins.c

net_wins.c is gone, winsock support merged into net_udp.c
numerous other cleanups/changes also done to net_udp.c (to try to simplify it, hopefully work better, that kind of stuff)
support for partial IP addresses has been removed (that is you say you can't simply type 'connect 1.123' and have it expand to xxx.xxx.1.123 where xxx.xxx came from your own IP address, however hostnames still work fine)
also the automatic changing of the hostname cvar according to internet hostname has been removed, so servers will be called "UNNAMED" if they don't set it, rather than using their internet hostname

------------------------------------------------------------------------
r2864 | havoc | 2003-03-27 19:33:18 -0800 (Thu, 27 Mar 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.dsp
   M /trunk/darkplaces/makefile.mingw
   M /trunk/darkplaces/makefile.mingwcross
   D /trunk/darkplaces/net_win.c
   M /trunk/darkplaces/net_wins.c
   D /trunk/darkplaces/net_wins.h

renamed all net_wins.c functions to UDP instead of WINS, this allows use of net_bsd.c and net_udp.h instead of net_win.c and net_wins.h

------------------------------------------------------------------------
r2863 | havoc | 2003-03-27 19:23:13 -0800 (Thu, 27 Mar 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/net_wins.c

removed winsock_initialized counter as there are no longer two things initializing winsock (wins and wipx), only one

------------------------------------------------------------------------
r2862 | havoc | 2003-03-27 19:21:12 -0800 (Thu, 27 Mar 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/net_wins.c

no longer dynamically loads portions of wsock32.dll (because it required static linking anyway for other parts, no point)

------------------------------------------------------------------------
r2861 | havoc | 2003-03-27 19:18:57 -0800 (Thu, 27 Mar 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/net_win.c

forgot to remove #include "net_wipx.h"

------------------------------------------------------------------------
r2860 | havoc | 2003-03-27 19:04:44 -0800 (Thu, 27 Mar 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.dsp
   M /trunk/darkplaces/makefile.mingw
   M /trunk/darkplaces/makefile.mingwcross
   M /trunk/darkplaces/net_win.c
   D /trunk/darkplaces/net_wipx.c
   D /trunk/darkplaces/net_wipx.h

removed winsock ipx support

------------------------------------------------------------------------
r2858 | havoc | 2003-03-27 04:25:32 -0800 (Thu, 27 Mar 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_null.c

Fix for win32 dedicated servers (oh it still doesn't compile, other problems remain with sys_win.c, but this one thing has been annoying me long enough)

------------------------------------------------------------------------
r2857 | havoc | 2003-03-27 00:58:58 -0800 (Thu, 27 Mar 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

Elric's pk3 support (no support for compressed files yet, that's still to come)

------------------------------------------------------------------------
r2856 | havoc | 2003-03-27 00:58:07 -0800 (Thu, 27 Mar 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h

Elric added BuffBigLong, BuffBigShort, BuffLittleLong, and BuffLittleShort functions intended for reading from misaligned locations in file memory buffers (these read as bytes rather than entire numbers, so memory misalignments are not a problem on Sparc and certain other CPUs)

------------------------------------------------------------------------
r2855 | havoc | 2003-03-27 00:04:27 -0800 (Thu, 27 Mar 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/pr_edict.c

added FRIK_FILE (aka QSG_FILE) extension, this brings string handling and text file access to the QuakeC support (note: files go in gamedir/data/)

------------------------------------------------------------------------
r2854 | havoc | 2003-03-27 00:02:43 -0800 (Thu, 27 Mar 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/mathlib.c
   M /trunk/darkplaces/mathlib.h

added Math_atov function (ascii to vector), tries to parse any imaginable vector (even badly formatted ones with varying numbers of spaces)

------------------------------------------------------------------------
r2853 | havoc | 2003-03-27 00:01:33 -0800 (Thu, 27 Mar 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/fs.c

create directories when opening any file for writing, because it's a real pain having to do it elsewhere

------------------------------------------------------------------------
r2848 | havoc | 2003-03-22 02:23:38 -0800 (Sat, 22 Mar 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/render.h

got rid of R_NewMap, directly calls R_Modules_NewMap instead

------------------------------------------------------------------------
r2847 | havoc | 2003-03-22 02:22:53 -0800 (Sat, 22 Mar 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

fix decals bug introduced by transition to matrix use

------------------------------------------------------------------------
r2846 | havoc | 2003-03-21 13:54:43 -0800 (Fri, 21 Mar 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sv_user.c

added more SV_CheckVelocity calls on players for safety sake

------------------------------------------------------------------------
r2845 | havoc | 2003-03-21 13:52:04 -0800 (Fri, 21 Mar 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

Thanks to IceDagger for pointing out this important optimization to multipass specular rendering - removes one pass (dropping from 6 to 5 passes on GF2, 5 to 4 passes on GF3/Radeon) by squaring specular even on the first pass

------------------------------------------------------------------------
r2844 | havoc | 2003-03-21 13:47:57 -0800 (Fri, 21 Mar 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cd_linux.c
   M /trunk/darkplaces/cd_win.c
   M /trunk/darkplaces/cl_demo.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/cvar.c
   M /trunk/darkplaces/cvar.h
   M /trunk/darkplaces/darkplaces.dsp
   M /trunk/darkplaces/dpvsimpledecode.c
   A /trunk/darkplaces/fs.c
   A /trunk/darkplaces/fs.h
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/jpeg.c
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/keys.h
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/makefile.mingw
   M /trunk/darkplaces/makefile.mingwcross
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/net_dgrm.c
   M /trunk/darkplaces/net_main.c
   M /trunk/darkplaces/palette.c
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/quakedef.h
   D /trunk/darkplaces/quakeio.c
   D /trunk/darkplaces/quakeio.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/snd_mem.c
   M /trunk/darkplaces/snd_mix.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_user.c
   M /trunk/darkplaces/sys.h
   M /trunk/darkplaces/sys_shared.c
   M /trunk/darkplaces/wad.c
   M /trunk/darkplaces/wavefile.c
   M /trunk/darkplaces/wavefile.h

This is a patch from Elric greatly cleaning up the filesystem portions of the engine, and partially prepares the engine for .pk3 support (yay), this also removes support for gzipped files (but that had been disabled for months anyway)

------------------------------------------------------------------------
r2842 | havoc | 2003-03-14 20:54:47 -0800 (Fri, 14 Mar 2003) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/cl_screen.h
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/mathlib.h
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_alias.h
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/portals.c
   M /trunk/darkplaces/r_crosshairs.c
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/r_sprites.c
   M /trunk/darkplaces/render.h

varray_* rewritten to remove padding (varray_vertex3f, varray_texcoord2f, varray_texcoord3f, varray_color4f now exist), this required changes to a huge amount of code (but netted a 30% speed gain typically)
fixed some various bugs
added voodoo1/2 support in realtime lighting engine (well, except for the fact it still requires stencil, which voodoo1/2 don't have, this will be addressed later when world lights and dlights are independently controlled)
changed lightning beams a bit (they're now white) and due to a request I added support for r_lightningbeam_qmbtexture (loads textures/particles/lightning.pcx and knows approximately how to use it, I recommend changing r_lightningbeam_repeatdistance to make it look right)

------------------------------------------------------------------------
r2841 | havoc | 2003-03-14 20:53:24 -0800 (Fri, 14 Mar 2003) | 3 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

added loading of .ent files if found (overriding entities in bsp)
added sv_entpatch cvar (to allow disabling the feature)

------------------------------------------------------------------------
r2840 | molivier | 2003-03-13 08:10:51 -0800 (Thu, 13 Mar 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/makefile.mingw
   M /trunk/darkplaces/makefile.mingwcross

Makefiles cleanups: r_explosion.o was declared twice in all Makefiles; removed some commented-out commands; diff reduction between makefile and makefile.mingwcross; forgot to call builddate previously; strip was even called on non-release binaries.

------------------------------------------------------------------------
r2839 | havoc | 2003-03-12 07:38:46 -0800 (Wed, 12 Mar 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

fix for 16bit textures looking awful (bug in the alpha check for 8bit)

------------------------------------------------------------------------
r2821 | molivier | 2003-03-09 23:05:45 -0800 (Sun, 09 Mar 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/matrixlib.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/net.h

Fixed a MSVC6 warning in matrixlib. Added a "Public server" yes/no line in the server creation menu. Removed a duplicated cvar declaration in "net.h".

------------------------------------------------------------------------
r2820 | havoc | 2003-03-09 12:33:23 -0800 (Sun, 09 Mar 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

Vic informed me of the AGP settings (0-0.25, 0-0.25, 0.25-0.75) and video memory settings (0-0.25, 0-0.25, 0.75-1) for use with GL_NV_vertex_array_range, they seem to have no effect but the defaults have been updated (to 0.2, 0.2, 0.7) to choose AGP

------------------------------------------------------------------------
r2819 | havoc | 2003-03-09 08:42:54 -0800 (Sun, 09 Mar 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_shared.c

GL_NV_vertex_array_range support added, but disabled by default because for some reason it's halving my framerate rather than making it faster

------------------------------------------------------------------------
r2818 | havoc | 2003-03-09 03:39:08 -0800 (Sun, 09 Mar 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_crosshairs.c
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/r_sprites.c

changed R_Mesh_ system (again), now uses R_Mesh_GetSpace to set up varray_* pointers, then fills in the data, then calls R_Mesh_Draw (this can be done repeatedly, but vertex data should *NOT* be modified after the first call)

------------------------------------------------------------------------
r2817 | havoc | 2003-03-09 03:19:57 -0800 (Sun, 09 Mar 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h

Mod_FindNonSolidLocation now takes a radius and can output to a different vector than the input (purpose: the sphere is nudged out of any surfaces in the area, this makes realtime lighting look a lot better as the lights aren't too close to the surface)

------------------------------------------------------------------------
r2813 | havoc | 2003-03-07 01:34:15 -0800 (Fri, 07 Mar 2003) | 10 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/menu.h
   M /trunk/darkplaces/palette.c
   M /trunk/darkplaces/palette.h
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_null.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c

menu.c - changed M_DrawSlider to take a value and a min/max range, now prints the current value of the cvar as well
menu.c, menu.h, gl_draw.c - added new color control options menu (the gl_draw.c change is merely adding a "ditherpattern" texture)
menu.c - added "Delay refresh (faster)" to options menu (gl_delayfinish cvar)
menu.c - added "Game Speed" to options menu (slowmo cvar)
vid_wgl.c, vid_glx.c, vid_null.c, vid_shared.c, vid.h, palette.c, palette.h, host.c - gamma system redesigned (VID_SetGamma now takes ramps, VID_GetGamma added, other cruft removed), moved VID_UpdateGamma to vid_shared.c, gamma is now turned off when darkplaces is minimized in X11 (unmapped), and when it's window is not active in Windows as well
vid_wgl.c - trailing whitespace fixed
vid_shared.c - added v_color_enable, v_color_black_[rgb], v_color_grey_[rgb], and v_color_white_[rgb] cvars as another way to adjust color settings
gl_draw.c - added support for v_color_* cvars, removed support for darkening screen (not possible to do in color)
vid_glx.c - got rid of unfinished X11 colormap based gamma code (using XF86 VidMode extension instead)

------------------------------------------------------------------------
r2812 | havoc | 2003-03-07 01:33:07 -0800 (Fri, 07 Mar 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

unfinished beginnings of support for voodoo1/voodoo2 class paths for realtime lighting (no shadows however)

------------------------------------------------------------------------
r2811 | havoc | 2003-03-07 01:31:46 -0800 (Fri, 07 Mar 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

now uses TEXF_FORCELINEAR on lightmaps

------------------------------------------------------------------------
r2810 | havoc | 2003-03-07 01:31:10 -0800 (Fri, 07 Mar 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/r_textures.h

added TEXF_FORCENEAREST and TEXF_FORCELINEAR flags

------------------------------------------------------------------------
r2809 | havoc | 2003-03-07 01:30:21 -0800 (Fri, 07 Mar 2003) | 7 lines
Changed paths:
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/world.c

got rid of AreaNode stuff, now only has AreaGrid (had to add sv_areagrid_outside node)
renamed sv_useareanodes to sv_debugmove (inverted behavior)
SV_CreateAreaGrid now has a minimum grid size (sv_areagrid_mingridsize cvar), this greatly improved performance in helm18
SV_ClipToAreaGrid and SV_TouchAreaGrid no longer process any edicts twice (edict_t now has areagridmarknumber for this purpose)
increased AREA_GRID from 16 to 512
added SV_ClipToNode function to get rid of duplicate code in SV_ClipToAreaGrid

------------------------------------------------------------------------
r2808 | havoc | 2003-03-07 01:28:12 -0800 (Fri, 07 Mar 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

added gl_delayfinish cvar (default off, used to always be on)

------------------------------------------------------------------------
r2807 | havoc | 2003-03-07 01:27:33 -0800 (Fri, 07 Mar 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/mathlib.h

added invpow (arbitrary logarithm, finds a power that the base number would need to be raised to, to get the requested number)

------------------------------------------------------------------------
r2806 | havoc | 2003-03-07 01:26:11 -0800 (Fri, 07 Mar 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/cl_screen.h

added DrawQ_SuperPic, fixed severe bug in DrawQ_Mesh (was not allocating enough room in drawqueue for the texcoords), DrawQ_Pic and DrawQ_Fill now use DrawQ_SuperPic

------------------------------------------------------------------------
r2805 | havoc | 2003-03-07 01:24:59 -0800 (Fri, 07 Mar 2003) | 7 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/view.c

view.c, cl_parse.c, cl_main.c, gl_rmain.c - trying to remove all uses of origin, angles, or scale fields of entity_render_t
view.c, gl_rmain.c - viewmodel entities are now processed in view.c instead of gl_rmain.c
view.c now uses matrix and inversematrix for view damage kicks

what this means:
the QC feature viewmodelforclient now works

------------------------------------------------------------------------
r2804 | havoc | 2003-03-07 01:23:33 -0800 (Fri, 07 Mar 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/matrixlib.c
   M /trunk/darkplaces/matrixlib.h

added Matrix4x4_OriginFromMatrix, and Matrix4x4_ScaleFromMatrix

------------------------------------------------------------------------
r2802 | havoc | 2003-03-04 23:20:40 -0800 (Tue, 04 Mar 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.mingw

got an email about this being out of date, fixed

------------------------------------------------------------------------
r2797 | havoc | 2003-03-01 23:20:28 -0800 (Sat, 01 Mar 2003) | 3 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

changed gloss behavior, now darkens light intensity (to 25% of normal) instead of assuming gloss texture is dim, this is consistent with tenebrae behavior, inconsistent with doom3 behavior (sigh...), this makes OgrO's model skins look a lot better
no longer spews 'refusing to create light' warnings when loading map light entities that actually aren't lights at all

------------------------------------------------------------------------
r2796 | havoc | 2003-03-01 23:18:14 -0800 (Sat, 01 Mar 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

fix external model skins (they weren't rendering)

------------------------------------------------------------------------
r2795 | havoc | 2003-03-01 17:30:44 -0800 (Sat, 01 Mar 2003) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/sys_shared.c

changed lots of printf to Con_Printf
removed some trailing whitespace

------------------------------------------------------------------------
r2794 | havoc | 2003-02-28 03:31:14 -0800 (Fri, 28 Feb 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

fix improper handling of overbright pixels when saving screenshots

------------------------------------------------------------------------
r2793 | havoc | 2003-02-28 03:28:10 -0800 (Fri, 28 Feb 2003) | 15 lines
Changed paths:
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/mathlib.c
   M /trunk/darkplaces/mathlib.h
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/portals.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h

lights now have an orientation (this isn't editable yet, and is infact not really supported for rotated lights at the moment, their bbox would need to be rotated)
lights now use bbox culling instead of radius (because they aren't round in 2D texture mode)
fixed LOTS of light culling bugs (particularly with surface selection)
fixed scissor to be more efficient (smaller) when easily done (entirely infront of view) and fixed some bugs
got rid of ShadowSphere code in gl_rmain.c (it was not used)
added back RadiusFromBounds (and optimized it) and added RadiusFromBoundsAndOrigin
removed trailing whitespace in mathlib.c
added BoxesOverlap macro to mathlib.h
fixed a portal-flow bug when a light lies directly inside a portal polygon (now checks both leafs involved, very mild search tolerance for leafs around the light)
added back 3d attenuation texture (true spherical lights make a return, r_shadow_texture3d cvar controls this)
fixed light-bleeding in attenuation textures at the edges (fixed a bug in the biasing during texture generation, now the edge is always black as it should be)
realtime lighting texture generation (attenuation/normalizationcubemap) now has some macros for more easily adjusting texture resolutions
reduced resolution of attenuation and normalization textures
added a bunch more rendering paths for diffuse and specular lighting, to reduce number of passes in a few cases (and allow use of 3D attenuation texture)

------------------------------------------------------------------------
r2792 | havoc | 2003-02-28 03:27:10 -0800 (Fri, 28 Feb 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/protocol.h

some added structures in in preparation for another protocol version bump (to add partial entity updates to avoid kicking people off server when packet buffer fills up in a single frame - yes this means rate capping and such will be possible)

------------------------------------------------------------------------
r2791 | havoc | 2003-02-28 03:09:24 -0800 (Fri, 28 Feb 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

fix chthon lightning (ugh, how did I manage to use polygon lightning for this, I made polygon lightning optional per beam for this very reason!)

------------------------------------------------------------------------
r2787 | havoc | 2003-02-26 16:00:31 -0800 (Wed, 26 Feb 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/vid_shared.c

changed TEXF_CLAMP to use GL_CLAMP_TO_EDGE (GL_EXT_texture_edge_clamp or GL_SGIS_texture_edge_clamp) instead of GL_CLAMP because it's a more useful behavior all-round, also fixed normalization cubemap on non-NVIDIA cards by doing this (I was properly using GL_CLAMP for attenuation texture, but not for normalization cubemap... *slaps self*)

------------------------------------------------------------------------
r2786 | havoc | 2003-02-26 04:47:49 -0800 (Wed, 26 Feb 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

adjustable r_shadow_projectdistance for testing (trying to identify Radeon bug)

------------------------------------------------------------------------
r2782 | havoc | 2003-02-25 17:41:00 -0800 (Tue, 25 Feb 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/world.c

Too fine an AREA_GRID seems to be dropping performance in normal quake maps (I hope this fixes the performance).

------------------------------------------------------------------------
r2775 | havoc | 2003-02-21 01:24:53 -0800 (Fri, 21 Feb 2003) | 3 lines
Changed paths:
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/world.c

added new method of culling irrelevant entity collisions - a grid of areas
the areanode system still lingers because it can cope with things the grid can not (entities outside the grid, or too large for the alloted 16 grid links per entity)

------------------------------------------------------------------------
r2774 | havoc | 2003-02-21 01:22:58 -0800 (Fri, 21 Feb 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/mathlib.h

added VectorMultiply (not used by anything, but for completeness...)

------------------------------------------------------------------------
r2773 | havoc | 2003-02-21 01:22:27 -0800 (Fri, 21 Feb 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

disable step interpolation unless entity is MOVETYPE_STEP

------------------------------------------------------------------------
r2771 | havoc | 2003-02-20 01:22:08 -0800 (Thu, 20 Feb 2003) | 3 lines
Changed paths:
   M /trunk/darkplaces/collision.c
   M /trunk/darkplaces/collision.h
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/world.c

optional polygon collisions, not ready for practical use yet, also support for brush collisions
not terribly optimized (fast enough though)

------------------------------------------------------------------------
r2770 | havoc | 2003-02-20 01:20:36 -0800 (Thu, 20 Feb 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

added #include "portals.h"

------------------------------------------------------------------------
r2769 | havoc | 2003-02-20 01:17:42 -0800 (Thu, 20 Feb 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/net_udp.c

some minor cleanup of PartialIPAddress (and some comments about how stupid it is) and a comment about hostname coming from network address being stupid, and some whitespace

------------------------------------------------------------------------
r2768 | havoc | 2003-02-20 01:15:46 -0800 (Thu, 20 Feb 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/pr_comp.h
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/pr_exec.c
   M /trunk/darkplaces/pr_execprogram.h
   M /trunk/darkplaces/progs.h

now counts (very approximate) cost of builtin functions called by progs, profile command reports this in addition to the instructions count, also profile now reports a whole list, not just the top 10

------------------------------------------------------------------------
r2767 | havoc | 2003-02-20 01:13:31 -0800 (Thu, 20 Feb 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/net_main.c

simplified "connect local" a bit

------------------------------------------------------------------------
r2766 | havoc | 2003-02-20 01:12:25 -0800 (Thu, 20 Feb 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/portals.c
   M /trunk/darkplaces/portals.h
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/r_shadow.c

optional portal based determination of lit surfaces (good speed gain, enough to make dpdm2 somewhat playable, on by default)

------------------------------------------------------------------------
r2751 | havoc | 2003-02-16 18:59:50 -0800 (Sun, 16 Feb 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

no longer adopt colors from server updates (this means demos no longer change your colors, and other such annoyances)

------------------------------------------------------------------------
r2750 | havoc | 2003-02-16 16:58:53 -0800 (Sun, 16 Feb 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c

improved Com_HexDumpToConsole, it now prints properly (not with a data byte on the left side followed by offset number, and other sillyness), and also prints a text listing beside the hex, it remains the same width as the old hex-only listing.

------------------------------------------------------------------------
r2741 | havoc | 2003-02-13 17:27:10 -0800 (Thu, 13 Feb 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

optimized some functions like SV_WallFriction and SV_FlyMove, no known behavioral changes (the code is a lot simpler however)

------------------------------------------------------------------------
r2740 | havoc | 2003-02-13 17:22:29 -0800 (Thu, 13 Feb 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_light.c

fix some bugs with r_fullbright, no lights, and other such cases

------------------------------------------------------------------------
r2739 | havoc | 2003-02-13 17:17:51 -0800 (Thu, 13 Feb 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c

added con_notify cvar, which controls how many console notify lines are displayed (default 4 like quake, max 32)

------------------------------------------------------------------------
r2738 | havoc | 2003-02-13 17:16:41 -0800 (Thu, 13 Feb 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/mathlib.h
   M /trunk/darkplaces/matrixlib.c
   M /trunk/darkplaces/matrixlib.h

added VectorBlend and Matrix4x4_Blend

------------------------------------------------------------------------
r2737 | havoc | 2003-02-13 17:15:06 -0800 (Thu, 13 Feb 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

don't crash on NULL model in entity culling

------------------------------------------------------------------------
r2736 | havoc | 2003-02-12 10:09:58 -0800 (Wed, 12 Feb 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile

restructured LDFLAGS a bit to make sure libraries come last (especially -lm as the very last), also moved debugging/profiling flags to be first

------------------------------------------------------------------------
r2735 | havoc | 2003-02-11 16:11:07 -0800 (Tue, 11 Feb 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

get rid of yet another entity_frame_t on the stack, this is the last one, hopefully the last stack overflow

------------------------------------------------------------------------
r2734 | havoc | 2003-02-11 15:55:46 -0800 (Tue, 11 Feb 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/protocol.c

fix two more stack overflows on win32 (in one case two 3.25mb entity_frame_t structs resided on the stack at once!)

------------------------------------------------------------------------
r2733 | havoc | 2003-02-11 06:03:15 -0800 (Tue, 11 Feb 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

another stack overflow fixed, this one more on the order of 300k+?

------------------------------------------------------------------------
r2732 | havoc | 2003-02-11 05:48:34 -0800 (Tue, 11 Feb 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

fixed another stack overflow on win32, apparently a 64k packet buffer on the stack causes a stack overflow - yeesh win32 stack is pathetic

------------------------------------------------------------------------
r2731 | havoc | 2003-02-10 15:55:33 -0800 (Mon, 10 Feb 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

fix win32 stack overflows in CL_ParseServerInfo, it was choking on the sheer quantity of memory used by model and sound precache names

------------------------------------------------------------------------
r2730 | havoc | 2003-02-10 13:04:09 -0800 (Mon, 10 Feb 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

added cl_noplayershadow cvar to allow disabling player shadow

------------------------------------------------------------------------
r2729 | havoc | 2003-02-10 13:02:29 -0800 (Mon, 10 Feb 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

almost lost this very important part of the MAX_EDICTS commit

------------------------------------------------------------------------
r2727 | havoc | 2003-02-10 06:46:15 -0800 (Mon, 10 Feb 2003) | 9 lines
Changed paths:
   M /trunk/darkplaces/cl_demo.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/net.h
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c

MAX_EDICTS has changed to 32768.  Yes this is madness.  Thanks to banshee for prompting this necessity to run his map helm10000!
Sound protocol has been upgraded to be able to send 16bit entity numbers (this allows going beyond the old 8192 limit)
MAX_ENTITY_DATABASE is now dependent on MAX_EDICTS
MAX_DATAGRAM increased from 8000 to 65536
MAX_MSGLEN has been removed (now uses MAX_DATAGRAM)
NET_MAXMESSAGE is now dependent on MAX_DATAGRAM
SV_PushMove's list of moved entities has been moved into sv.moved_edicts (just an array of pointers) and their original origin and angles have been moved into edict_t, this avoids stack crashes on win32 with the new edict limit
increased MAX_MODELS and MAX_SOUNDS from 1024 to 4096 (this is not really necessary but a good idea)

------------------------------------------------------------------------
r2726 | havoc | 2003-02-01 06:20:07 -0800 (Sat, 01 Feb 2003) | 2 lines
Changed paths:
   A /trunk/darkplaces/makefile.mingwcross

makefile to use for cross compiling mingw builds

------------------------------------------------------------------------
r2725 | havoc | 2003-02-01 00:42:18 -0800 (Sat, 01 Feb 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_sky.c

fixed targa quake sky loading

------------------------------------------------------------------------
r2723 | havoc | 2003-01-30 23:27:31 -0800 (Thu, 30 Jan 2003) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h

chthon lightning no longer uses beam polygons
lightning beams are now relative to their owner entity (if they have one), this makes aiming lightning look instantaneous for the first time ever in quake

------------------------------------------------------------------------
r2722 | havoc | 2003-01-30 23:24:12 -0800 (Thu, 30 Jan 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_shared.c

limited pitch range to that of quake

------------------------------------------------------------------------
r2710 | havoc | 2003-01-27 18:19:51 -0800 (Mon, 27 Jan 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

corrected comment again, indicating that the offset for polygon 3 is in the bottom right, not in the top left

------------------------------------------------------------------------
r2709 | havoc | 2003-01-27 18:14:14 -0800 (Mon, 27 Jan 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

corrected numbering of polygons in comment (oops)

------------------------------------------------------------------------
r2708 | havoc | 2003-01-27 18:13:37 -0800 (Mon, 27 Jan 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

added a lot of comments to lightning beam code

------------------------------------------------------------------------
r2704 | warp | 2003-01-27 01:38:31 -0800 (Mon, 27 Jan 2003) | 3 lines
Changed paths:
   M /trunk/darkplaces/pr_exec.c
   M /trunk/darkplaces/pr_execprogram.h
   M /trunk/darkplaces/progs.h

The gcc 2.95 problem was in fact OP_STORE_V doing nasty things to numbers that were not quite 'valid' floats, so we now just copy as ints.
This allows us to make the string handling /much/ cleaner again.

------------------------------------------------------------------------
r2703 | havoc | 2003-01-26 23:37:18 -0800 (Sun, 26 Jan 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile

fixed some very ewww bugs (a few .c files made their way into the .o lists)

------------------------------------------------------------------------
r2702 | havoc | 2003-01-26 23:36:22 -0800 (Sun, 26 Jan 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

corrected rtlights loading of cubemapname (stupid typo)

------------------------------------------------------------------------
r2701 | havoc | 2003-01-26 18:54:54 -0800 (Sun, 26 Jan 2003) | 14 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h

lightning beams have been replaced with a polygon effect which renders faster than the model effect and looks...  oh umm... about 100x better, old effect still available - cl_beampolygons 0 to go back to models - some r_lightningbeam_* cvars added for tweaking new effect
r_speeds now reports some realtime lighting info
shadowless light support added
(unsuccessful) attempt to fix r_drawportals by moving the call to happen whether portal rendering was used or not
comment about possible optimization to shadow volumes added (rather, inverted light volumes and how to get maximum performance from them)
light styles are now checked for validity (must be in the right number range)
tiny cleanup to cubemap name handling (cubemaps are still not actually supported)
r_editlights_rtlightcolorscale and sizescale are now applied only in LoadWorldLights and SaveWorldLights, not in light creation (also somewhat to compensate for this fact, .lights loading has been tweaked to double the brightness)
torch light colors changed (more orange)
r_editlights_spawn no longer takes parameters
r_editlights_edit now has subcommands instead of setting all properties, the commands are: origin, originx, originy, originz, move, movex, movey, movez, radius, color, style, cubemap, shadows
r_editlights_toggleshadow added (useful for point and click shadow toggling)
display overlay now shown when pointing at a light in editing mode, indicating all properties of the light

------------------------------------------------------------------------
r2700 | havoc | 2003-01-23 12:10:07 -0800 (Thu, 23 Jan 2003) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/protocol.h

entity shadow casting is now optional per entity (EF_NOSHADOW added), and special entities (static entities like torchs, and tempentities like beams) do not cast shadows
intermission player does not cast shadows and the cameraman in Nehahra movie and cinematics no longer casts shadows

------------------------------------------------------------------------
r2699 | havoc | 2003-01-23 11:34:11 -0800 (Thu, 23 Jan 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

added resolutions 320x240, 400x300, 1152x864, 1280x1024, 1600x1200, 1792x1344, 1920x1440, 2048x1536

------------------------------------------------------------------------
r2698 | havoc | 2003-01-21 16:49:13 -0800 (Tue, 21 Jan 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

reduced intensity and radius of teleport flash

------------------------------------------------------------------------
r2697 | havoc | 2003-01-21 16:42:44 -0800 (Tue, 21 Jan 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c

removed allsolid check from droptofloor

------------------------------------------------------------------------
r2696 | havoc | 2003-01-21 16:42:05 -0800 (Tue, 21 Jan 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

turned off mipmapping on attenuation texture

------------------------------------------------------------------------
r2695 | havoc | 2003-01-16 15:53:26 -0800 (Thu, 16 Jan 2003) | 7 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

works with NULL worldmodel
fixed overbright lighting!  (light flickering is now smooth and everything)
added r_editlights_rtlightssizescale and r_editlights_rtlightscolorscale which scale light properties when loading as well as saving (to undo the change - this can be exploited to modify all lights in the level)
reduced used area of attenuation texture a little to ensure black edges
changed defaults for attenuation texture settings and rtlights sizescale/colorscale to greatly improve performance while still looking good
now defaults to no fake bumpmapping on walls (saves texture memory and looks better to me)

------------------------------------------------------------------------
r2694 | havoc | 2003-01-15 05:21:19 -0800 (Wed, 15 Jan 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

changed a debugging notice about texture loading

------------------------------------------------------------------------
r2693 | havoc | 2003-01-15 05:13:28 -0800 (Wed, 15 Jan 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

now checks for NULL worldmodel

------------------------------------------------------------------------
r2692 | havoc | 2003-01-15 05:12:47 -0800 (Wed, 15 Jan 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/image.c

now prints image size (was printing garbage before)

------------------------------------------------------------------------
r2691 | havoc | 2003-01-15 05:12:14 -0800 (Wed, 15 Jan 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/mathlib.c

tiny cleanup to RotatePointAroundVector (uses a VectorCopy instead of 3 lines)

------------------------------------------------------------------------
r2690 | havoc | 2003-01-15 05:09:16 -0800 (Wed, 15 Jan 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

fixed bumpmapping!  now looks correct

------------------------------------------------------------------------
r2689 | havoc | 2003-01-15 05:05:32 -0800 (Wed, 15 Jan 2003) | 3 lines
Changed paths:
   M /trunk/darkplaces/pr_exec.c

expanded string table offset table from 1024 to 65536, there must be a better solution than this though...
this fixes savegame loading (which allocates lots of negative string offsets)

------------------------------------------------------------------------
r2688 | havoc | 2003-01-15 05:01:21 -0800 (Wed, 15 Jan 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/zone.c

added developer_memory cvar (default off) to decide whether to print memory debugging messages if developer is on

------------------------------------------------------------------------
r2687 | havoc | 2003-01-15 04:59:40 -0800 (Wed, 15 Jan 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

now checks if worldmodel is NULL again, some comment cleanups and clarifications

------------------------------------------------------------------------
r2686 | havoc | 2003-01-15 03:40:17 -0800 (Wed, 15 Jan 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

cleanup of precache messages and assorted comments

------------------------------------------------------------------------
r2685 | molivier | 2003-01-06 06:28:37 -0800 (Mon, 06 Jan 2003) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

E4M9 was added to the Transfusion map list

------------------------------------------------------------------------
r2684 | havoc | 2002-12-24 15:00:59 -0800 (Tue, 24 Dec 2002) | 3 lines
Changed paths:
   M /trunk/darkplaces/image.c

loadimagepixels is a little cleaner now (yes made cleaner by goto...) and dprints info about loaded images
critical bug in image_loadskin fixed (s->basepixels_width and height were not being set)

------------------------------------------------------------------------
r2683 | havoc | 2002-12-24 14:59:23 -0800 (Tue, 24 Dec 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

detect bogus texture upload attempts and print the info to console

------------------------------------------------------------------------
r2682 | havoc | 2002-12-22 14:56:09 -0800 (Sun, 22 Dec 2002) | 10 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/image.h
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/palette.c
   M /trunk/darkplaces/palette.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h

unified model skinframe loaders used for mdl, md2, md3, and bsp textures (both external and internal where applicable)
imageskin_t and image_loadskin/image_freeskin functions added to image.[ch] for use by the unified skinframe loaders
added palette_nocolormap
split r_shadow_bumpscale cvar into r_shadow_bumpscale_bumpmap (for _bump textures) and r_shadow_bumpscale_basetexture (self explanatory)
now loads _norm normalmap textures (tenebrae compatibility)
_nmap normalmap texture support removed (it was broken in the previous release and I don't need to bog down the texture loader with even more unnecessary names)
r_shadow_lightattenuationpower added (default 2, to leave it looking identical to previous versions, this controls the falloff curve of light)
renamed detailtextures array to mod_shared_detailtextures and moved it and related code to model_shared.[ch]
removed progs/missile.mdl shadow casting check (in r_shadow_realtime mode) I had forgotten to remove before committing last time

------------------------------------------------------------------------
r2681 | molivier | 2002-12-11 09:51:31 -0800 (Wed, 11 Dec 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/net_udp.c

Some stupid Linux machines (i.e. Mandrake) seem to ignore their own network properties; in this case, we use the loopback address as the default one. Also, fixed an inoffensive bug when binding the UDP control socket.

------------------------------------------------------------------------
r2680 | havoc | 2002-12-10 19:06:44 -0800 (Tue, 10 Dec 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/vid_shared.c

I guess those glLoadIdentity calls were more important than expected

------------------------------------------------------------------------
r2679 | havoc | 2002-12-09 04:37:59 -0800 (Mon, 09 Dec 2002) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/vid_shared.c

removed glLoadIdentity calls (they were all useless where they were used)
commented out unused GL functions

------------------------------------------------------------------------
r2678 | havoc | 2002-12-09 04:35:08 -0800 (Mon, 09 Dec 2002) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

added Electro's smoke trail tweaks
decals now follow the bmodel they stuck to

------------------------------------------------------------------------
r2677 | molivier | 2002-12-03 02:16:37 -0800 (Tue, 03 Dec 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/matrixlib.c

Removed some warnings in MSVC6

------------------------------------------------------------------------
r2676 | molivier | 2002-12-03 02:15:01 -0800 (Tue, 03 Dec 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

Updated Transfusion map list

------------------------------------------------------------------------
r2675 | havoc | 2002-12-02 12:06:27 -0800 (Mon, 02 Dec 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c

fix textured DrawQ_Fill problem when DrawQ_Fill is the first 2d primitive rendered (thanks Tomaz)

------------------------------------------------------------------------
r2672 | havoc | 2002-12-01 20:52:47 -0800 (Sun, 01 Dec 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

another bugfix for WORKINGLQUAKE code

------------------------------------------------------------------------
r2671 | havoc | 2002-12-01 17:55:54 -0800 (Sun, 01 Dec 2002) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_alias.h
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h

md3 model support and some cleanups to skin loading and other things in the mdl and md2 loaders
md3 tags are not loaded yet

------------------------------------------------------------------------
r2670 | havoc | 2002-12-01 17:53:51 -0800 (Sun, 01 Dec 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/net_main.c

beginnings of some proper server list code, commented out for now

------------------------------------------------------------------------
r2669 | havoc | 2002-12-01 17:52:13 -0800 (Sun, 01 Dec 2002) | 5 lines
Changed paths:
   M /trunk/darkplaces/net_dgrm.c
   M /trunk/darkplaces/net_master.c

changed master server list around a bit (added rick.cube-sol.net and my master server as well)
master server list can now have gaps
ipaddr is now parsed from the getserversResponse properly (thanks Rick)
now reports port number in developer print for sending messages to master servers

------------------------------------------------------------------------
r2668 | havoc | 2002-12-01 17:43:50 -0800 (Sun, 01 Dec 2002) | 3 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

reverted to fast version of trianglefacinglight code, as it was found to be a speed gain in benchmarks compared to the light radius checking version
fixed an unitialized variable warning

------------------------------------------------------------------------
r2667 | havoc | 2002-12-01 17:33:33 -0800 (Sun, 01 Dec 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/image.h

added loadtextureimagebumpasnmap

------------------------------------------------------------------------
r2666 | havoc | 2002-12-01 17:31:32 -0800 (Sun, 01 Dec 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

water moves around again

------------------------------------------------------------------------
r2665 | havoc | 2002-12-01 17:28:30 -0800 (Sun, 01 Dec 2002) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_models.c

optimized single frame lerp case
removed FetchSkinFrame
mesh rendering loop now... advances the mesh

------------------------------------------------------------------------
r2664 | havoc | 2002-12-01 17:25:32 -0800 (Sun, 01 Dec 2002) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

cleaned up shadow volume culling somewhat
added r_shadow_cull cvar to decide whether or not to apply shadow volume culling

------------------------------------------------------------------------
r2663 | havoc | 2002-12-01 16:42:25 -0800 (Sun, 01 Dec 2002) | 3 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h

renamed and altered SZ_HexDumpToConsole to be Com_HexDumpToConsole which takes a qbyte * and a size, instead of a sizebuf_t
added SZ_HexDumptoConsole which just calls Com_HexDumpToConsole

------------------------------------------------------------------------
r2662 | havoc | 2002-12-01 12:08:22 -0800 (Sun, 01 Dec 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.dsp
   M /trunk/darkplaces/matrixlib.h

fix compiling problems in MSVC (thanks Tomaz)

------------------------------------------------------------------------
r2661 | havoc | 2002-12-01 00:28:39 -0800 (Sun, 01 Dec 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

a few more glquake and glqwcl compatibility fixes

------------------------------------------------------------------------
r2660 | havoc | 2002-11-30 20:40:37 -0800 (Sat, 30 Nov 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

added a simplified CL_TraceLine in the WORKINGLQUAKE code and enabled particle collisions in WORKINGLQUAKE

------------------------------------------------------------------------
r2659 | havoc | 2002-11-30 01:44:26 -0800 (Sat, 30 Nov 2002) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

decals added back due to popular demand, currently not at all optimized (they're just particles) and not clipped to surfaces
cl_decals 1 to enable (this is saved to config), cl_decals_time and cl_decals_fadetime change settings for them (these are also saved to config)
redesigned particle additive flag to be a blend mode number (PBLEND_ALPHA, PBLEND_ADD, or PBLEND_MOD - for decals), lots of special hacks for the nifty new PBLEND_MOD mode

------------------------------------------------------------------------
r2658 | havoc | 2002-11-28 16:33:13 -0800 (Thu, 28 Nov 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_shared.c

-width and -height can now be used alone (instead of having to use both) for better compatibility with stock glquake behavior

------------------------------------------------------------------------
r2657 | havoc | 2002-11-27 19:41:10 -0800 (Wed, 27 Nov 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_alias.h
   M /trunk/darkplaces/model_shared.h

mdl/md2 transitioned to meshes

------------------------------------------------------------------------
r2656 | havoc | 2002-11-27 18:33:39 -0800 (Wed, 27 Nov 2002) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_alias.h
   M /trunk/darkplaces/r_light.c

most of the new alias mesh system is in place now...
reversed lighting direction in R_LightModel because it was backwards (weird...)

------------------------------------------------------------------------
r2655 | havoc | 2002-11-26 16:22:15 -0800 (Tue, 26 Nov 2002) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_alias.h
   M /trunk/darkplaces/model_shared.h

changed format of aliasvertex_t to use floats (hopefully this is a speedup, it sure bloats memory use - 36 bytes each, compared to 4 bytes in mdl/md2)
corrected scale for md3 vertices mentioned in header (md3 is still not supported yet)
added some unfinished mesh structures to begin support for md3

------------------------------------------------------------------------
r2654 | havoc | 2002-11-26 13:01:02 -0800 (Tue, 26 Nov 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.h

cleaned up md3 structs

------------------------------------------------------------------------
r2653 | havoc | 2002-11-26 12:55:37 -0800 (Tue, 26 Nov 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_shared.h

removed model_t mdlmd2data_frames (no longer needed)

------------------------------------------------------------------------
r2652 | havoc | 2002-11-26 12:49:13 -0800 (Tue, 26 Nov 2002) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/mathlib.h
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_alias.h
   M /trunk/darkplaces/model_shared.h

mdl and md2 vertices are now stored in a different structure called aliasvertex_t, it has all the features of mdl, md2 and md3 formats and simplifies interpolation, it also has precomputed texture vectors for faster realtime lighting.
normals are no longer interpolated if not needed (fake shadows and shadow volumes do not need them)
added VectorM, VectorMAM, VectorMAMAM and VectorMAMAMAM macros to make aliasvertex_t interpolation code more readable

------------------------------------------------------------------------
r2651 | havoc | 2002-11-26 12:38:41 -0800 (Tue, 26 Nov 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h

BuildTriangleNeighbors now detects edges shared by three triangles, fixes weird shadow bugs in a few places

------------------------------------------------------------------------
r2650 | havoc | 2002-11-24 17:16:06 -0800 (Sun, 24 Nov 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/keys.h
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_wgl.c

most of Q2's keyboard handling ported over - what this means: keypad is now separately bindable (bind kp_pgup and such)

------------------------------------------------------------------------
r2649 | havoc | 2002-11-24 17:08:50 -0800 (Sun, 24 Nov 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.h

reverse engineered md3 format and wrote struct declarations (this is *NOT* based on Q3 SDK source)

------------------------------------------------------------------------
r2645 | havoc | 2002-11-22 04:43:30 -0800 (Fri, 22 Nov 2002) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

r_shadows is now ignored when in r_shadow_realtime mode
r_shadow_realtime 3 added (no depth test on visible shadow volumes)
visible shadow volumes now have backface culling disabled, to better demonstrate the overdraw

------------------------------------------------------------------------
r2644 | havoc | 2002-11-21 10:26:48 -0800 (Thu, 21 Nov 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/pr_exec.c
   M /trunk/darkplaces/pr_execprogram.h
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c

implemented PR_GetString and PR_SetString from QWSV source, these work around the map change crash bugs in gcc 2.95.3

------------------------------------------------------------------------
r2643 | havoc | 2002-11-21 10:24:38 -0800 (Thu, 21 Nov 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

defaulting to r_surfaceworldnode 1

------------------------------------------------------------------------
r2642 | havoc | 2002-11-21 02:56:30 -0800 (Thu, 21 Nov 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

fixed a silly and harmless typo in RSurfShader_Water (*chain++ should have been chain++)

------------------------------------------------------------------------
r2640 | havoc | 2002-11-20 04:54:15 -0800 (Wed, 20 Nov 2002) | 6 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h

CalcSurfaceExtents now uses surf->poly_verts instead of edges
brush model bounding box calculations are now based on meshes instead of edges
CalcSurfaceExtents has been merged into Mod_GenerateSurfacePolygon
msurface_t firstedge and numedges have been removed (they were only used for generating the polygon during loading)
shuffled around msurface_t fields in order of most common access at the top, to least common at the bottom, this is in an attempt to reduce wasted memory traffic

------------------------------------------------------------------------
r2639 | havoc | 2002-11-20 03:18:50 -0800 (Wed, 20 Nov 2002) | 3 lines
Changed paths:
   M /trunk/darkplaces/mathlib.c
   M /trunk/darkplaces/mathlib.h
   M /trunk/darkplaces/matrixlib.c
   M /trunk/darkplaces/matrixlib.h

removed all 3x4 matrix support (wasn't used, and isn't likely to ever be used)
moved Matrix4x4_Print to mathlib.[ch] because it really doesn't belong in the entirely quake-independent matrixlib.[ch]

------------------------------------------------------------------------
r2638 | havoc | 2002-11-20 03:10:37 -0800 (Wed, 20 Nov 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/render.h
   D /trunk/darkplaces/transform.c
   D /trunk/darkplaces/transform.h

softwaretransform hasn't been used in ages, I thought I had already gotten rid of it...

------------------------------------------------------------------------
r2632 | havoc | 2002-11-16 05:52:08 -0800 (Sat, 16 Nov 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.h

got rid of all the (no longer used) cached_ fields in the msurface_t struct, except for cached_dlight

------------------------------------------------------------------------
r2631 | havoc | 2002-11-16 05:35:36 -0800 (Sat, 16 Nov 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h

merged GL_DrawRangeElements into R_Mesh_Draw for a mild speed gain

------------------------------------------------------------------------
r2630 | havoc | 2002-11-16 04:49:34 -0800 (Sat, 16 Nov 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/render.h

lightmap update checking is now handled very differently; each brush model has a set of lightmap chains for each light style, and they are marked if the light style's value changes, similarly dlights mark surfaces they touch as well...  both use surf->cached_dlight...  this doesn't seem to be a speed gain (or loss) at present, but allows further restructuring which should be a speed gain

------------------------------------------------------------------------
r2629 | havoc | 2002-11-15 17:24:03 -0800 (Fri, 15 Nov 2002) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.h

rewrote how texture chains are handled, they are now stored outside the surfaces, and are rebuilt as the player moves through the world (bmodel texture chains are just left untouched)
good efficiency improvement I think

------------------------------------------------------------------------
r2628 | havoc | 2002-11-15 17:00:26 -0800 (Fri, 15 Nov 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

fixed fiends teleporting when they check if a jump is a good one or not

------------------------------------------------------------------------
r2621 | molivier | 2002-11-14 00:05:05 -0800 (Thu, 14 Nov 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/jpeg.c

The Linux version doesn't need libjpeg.h anymore

------------------------------------------------------------------------
r2620 | havoc | 2002-11-11 13:36:09 -0800 (Mon, 11 Nov 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

thanks to Vic for pointing out the fact I should be using + 0.5f when dealing with the alias texcoords

------------------------------------------------------------------------
r2619 | havoc | 2002-11-10 21:04:53 -0800 (Sun, 10 Nov 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/matrixlib.c

thanks to Tomaz for finding a severe bug in CopyTranslateOnly (it was copying the X translate into all 3 translate components)

------------------------------------------------------------------------
r2618 | havoc | 2002-11-09 21:03:42 -0800 (Sat, 09 Nov 2002) | 11 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/render.h

added Nexiuz TE_ effects (prefixed TE_TEI_) and Nexiuz plasma trail (an override for EF_BRIGHTFIELD)
Nexiuz mode disables fullbrights
reshaped some of the particle structure (flags is gone, broken apart into separate fields again)
added tex_beam (which uses a separate texture instead of the particle font because it needs to repeat)
simplified some of the texture font generation (tex_ variables now indicate where to put the images in the texture)
now resets trail positions if entity was not active in previous frame
now gives packet dump when Host_Error is called during client message parsing code
now frees the model(s) being loaded when Host_Error is called during model loading code
removed modelflush command because it crashes the realtime lighting code (which points to leafs and surfaces in the world model, a problem which does not exist with r_restart and vid_restart)
R_Stain and R_CalcBeamVerts now use const where appropriate

------------------------------------------------------------------------
r2617 | havoc | 2002-11-09 18:51:31 -0800 (Sat, 09 Nov 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h

add GAME_NEXIUZ gamemode

------------------------------------------------------------------------
r2616 | havoc | 2002-11-09 18:49:45 -0800 (Sat, 09 Nov 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

fixed Mod_LoadZymoticModel - it had TONS of crashs

------------------------------------------------------------------------
r2615 | havoc | 2002-11-09 18:34:19 -0800 (Sat, 09 Nov 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fix crashs on maps with missing textures

------------------------------------------------------------------------
r2614 | havoc | 2002-11-09 18:26:47 -0800 (Sat, 09 Nov 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_crosshairs.c

fix which crosshair texture is used

------------------------------------------------------------------------
r2613 | havoc | 2002-11-09 18:22:43 -0800 (Sat, 09 Nov 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

don't send free entities!  (I've been observing this bug for months)

------------------------------------------------------------------------
r2610 | havoc | 2002-11-08 15:26:54 -0800 (Fri, 08 Nov 2002) | 7 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.dsp
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/image.c
   A /trunk/darkplaces/jpeg.c
   A /trunk/darkplaces/jpeg.h
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/sys.h
   M /trunk/darkplaces/sys_linux.c
   M /trunk/darkplaces/sys_win.c
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c

Elric's changes:
JPEG texture loading using libjpeg (entirely optional at runtime - if not present, it won't load it)
gl_extensionfunctionlist_t is now renamed dllfunction_t and part of a shared system for library opening/function retrieval (functions Sys_LoadLibrary, Sys_GetProcAddress, Sys_UnloadLibrary - for this the library handles are considered void *'s)
LordHavoc's changes:
fixed libjpeg support in non-win32 by using jpeglib.h - honors jpeglib.h's idea of boolean - Linux libjpeg is compiled with boolean as int, unlike windows where it is apparently byte - unfortunately this also means you need libjpeg-devel installed to compile it in non-win32, not sure what can be done about this (but most people seem to have that anyway...)
looks for libjpeg.so.62 instead of libjpeg.so

------------------------------------------------------------------------
r2609 | havoc | 2002-11-07 12:50:05 -0800 (Thu, 07 Nov 2002) | 7 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

glossmap textures are now brighter (no change to forced gloss brightness)
now clears lights when reloading lights
r_editlights_quakelightsizescale cvar added, default 0.8, controls size of lights imported from maps, gets a major speed gain but makes the map a little darker
R_Shadow_NewWorldLight now checks if radius or color is too dim and won't spawn such lights
in editing mode the centers of lights are visible now (as crosshair images)
light selection is now done a bit differently - the more precisely you point at a light, the higher it's rating gets, sometimes surpassing the closer lights in the area

------------------------------------------------------------------------
r2608 | havoc | 2002-11-07 12:42:36 -0800 (Thu, 07 Nov 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

changed a server protocol error to use Host_Error

------------------------------------------------------------------------
r2607 | havoc | 2002-11-07 12:41:50 -0800 (Thu, 07 Nov 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

when realtime mode fails now mentions setting vid_bitsperpixel to 32 as well

------------------------------------------------------------------------
r2606 | havoc | 2002-11-07 12:40:28 -0800 (Thu, 07 Nov 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/image.c

LoadTGA now loads colormapped and greyscale targas (as found in qe1m1 project)

------------------------------------------------------------------------
r2605 | havoc | 2002-11-07 12:38:57 -0800 (Thu, 07 Nov 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_shared.c

don't allow stencil without bitsperpixel 32

------------------------------------------------------------------------
r2600 | havoc | 2002-11-04 07:56:31 -0800 (Mon, 04 Nov 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.h

added comments explaining what all the fields of surfmesh_t do

------------------------------------------------------------------------
r2599 | havoc | 2002-11-03 17:28:08 -0800 (Sun, 03 Nov 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h

removed use of 3D textures

------------------------------------------------------------------------
r2598 | havoc | 2002-11-03 17:23:30 -0800 (Sun, 03 Nov 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

renamed r_staticworldlights to r_shadow_staticworldlights

------------------------------------------------------------------------
r2597 | havoc | 2002-11-03 17:09:33 -0800 (Sun, 03 Nov 2002) | 11 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h

now clears stencil to 128 instead of 0, this avoids problems with arbitrary incr/decr orders
stencil shadows are now always erased by glClear, never by drawing again, removes r_shadow_erasebydrawing cvar
shadow volumes now have a nudge away from the surface that cast them, this is controlled by the r_shadow_shadownudge cvar (default 1 unit), avoids rare z fighting issues
shadow volume projection distance is now not infinite for alias model volumes, because they are more well-behaved than the world shadows...
msurface_t poly_radius and poly_radius2 removed
now validates elements in more parts of loading (hoped this would reveal a model shadow bug, but it didn't)
Mod_ShadowMesh_AddVertex now uses a hash table search to speed up static shadow volume building (unfortunately this doesn't seem to be the real speed problem)
removed ALLOCMESHINPIECES option from Mod_ShadowMesh code
removed non-PRECOMPUTEDSHADOWVOLUMES option from static shadow volume creation
removed some unused variables

------------------------------------------------------------------------
r2596 | havoc | 2002-11-03 15:10:45 -0800 (Sun, 03 Nov 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c

fix polygon distance checks (the radius comparison was completely wrong)

------------------------------------------------------------------------
r2595 | havoc | 2002-11-03 15:07:26 -0800 (Sun, 03 Nov 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/vid_shared.c

added support for glPolygonOffset (not used though)

------------------------------------------------------------------------
r2593 | havoc | 2002-10-31 07:35:42 -0800 (Thu, 31 Oct 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/image.c

untested support for tenebrae override/ textures directory

------------------------------------------------------------------------
r2592 | havoc | 2002-10-31 07:17:40 -0800 (Thu, 31 Oct 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/view.c

make view kicks (both angle and origin) occur before gun is oriented, so it follows the view exactly

------------------------------------------------------------------------
r2591 | havoc | 2002-10-30 07:28:26 -0800 (Wed, 30 Oct 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/net_dgrm.c
   M /trunk/darkplaces/net_master.c
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/pr_exec.c
   M /trunk/darkplaces/pr_execprogram.h
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/quakeio.c
   M /trunk/darkplaces/snd_dma.c
   M /trunk/darkplaces/snd_oss.c
   M /trunk/darkplaces/wad.c
   M /trunk/darkplaces/zone.h

fixed all the signed/unsigned mismatch warnings

------------------------------------------------------------------------
r2590 | havoc | 2002-10-30 07:23:48 -0800 (Wed, 30 Oct 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

commented out two unused static const int variables gcc 3.3 noticed

------------------------------------------------------------------------
r2589 | havoc | 2002-10-30 03:46:08 -0800 (Wed, 30 Oct 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/view.c

fix viewmodel crash

------------------------------------------------------------------------
r2588 | havoc | 2002-10-29 13:06:11 -0800 (Tue, 29 Oct 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

minor update to texture flags and logic stuff

------------------------------------------------------------------------
r2587 | havoc | 2002-10-29 13:04:07 -0800 (Tue, 29 Oct 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

fix for use of cubemaps on hardware without 3d texture support

------------------------------------------------------------------------
r2586 | havoc | 2002-10-29 11:29:58 -0800 (Tue, 29 Oct 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/view.c

view model is now properly lit in realtime mode

------------------------------------------------------------------------
r2585 | havoc | 2002-10-29 10:55:05 -0800 (Tue, 29 Oct 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

color the torch light

------------------------------------------------------------------------
r2584 | havoc | 2002-10-29 10:36:06 -0800 (Tue, 29 Oct 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

tweak large flame lights a bit more

------------------------------------------------------------------------
r2583 | havoc | 2002-10-29 10:31:12 -0800 (Tue, 29 Oct 2002) | 4 lines
Changed paths:
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/r_shadow.c

bumpscale is now adjustable (r_shadow_bumpscale) for experimenting (it's not saved to config)
.lights loading now has the correct light intensity
torchs now spawn lights above their location so the shadow is cast down, not up

------------------------------------------------------------------------
r2582 | havoc | 2002-10-29 10:01:43 -0800 (Tue, 29 Oct 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

now lights are automatically loaded from the .bsp, .lights, or .rtlights if available

------------------------------------------------------------------------
r2581 | havoc | 2002-10-29 07:44:15 -0800 (Tue, 29 Oct 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

* LordHavoc slaps self for having loadmodel->mempool references where he should have had r_shadow_mempool references

------------------------------------------------------------------------
r2580 | havoc | 2002-10-29 07:36:49 -0800 (Tue, 29 Oct 2002) | 3 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/net_dgrm.c
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/pr_exec.c
   M /trunk/darkplaces/pr_execprogram.h
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_move.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sv_user.c
   M /trunk/darkplaces/world.c

changed how QC interpreter handles edict field access - the entvars struct is now a pointer - yes this changed that many files...
discovered gcc 2.95.3 is the sole cause of map change crashs in the QC interpreter - it does not compile pr_exec.c correctly somehow (I think OP_ADDRESS is the only place it has a problem), makefile now refers to gcc-3.1 (maybe this should be changed, but oh well for now)

------------------------------------------------------------------------
r2574 | havoc | 2002-10-28 06:26:49 -0800 (Mon, 28 Oct 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c

faster number to edict lookup (sv.edictstable) and faster edict to number lookup (edict_t now has a number inside it)

------------------------------------------------------------------------
r2573 | havoc | 2002-10-28 06:24:33 -0800 (Mon, 28 Oct 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_exec.c

check for negative pr_depth in PR_Crash just to be obsessive

------------------------------------------------------------------------
r2572 | havoc | 2002-10-28 06:23:41 -0800 (Mon, 28 Oct 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c

fixed CopyEntity builtin, now only copies the vars (not the physics info and such)

------------------------------------------------------------------------
r2571 | havoc | 2002-10-28 01:17:44 -0800 (Mon, 28 Oct 2002) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h
   M /trunk/darkplaces/vid_shared.c

implemented scissor rect clipping of lights in realtime lighting mode
DP is no longer fillrate limited on my GF4 at 640x480 :)

------------------------------------------------------------------------
r2570 | havoc | 2002-10-27 05:15:43 -0800 (Sun, 27 Oct 2002) | 38 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h

gloss now works correctly
major speedups to realtime lighting mode (it's now actually playable on my machine)

world lights are now handled by r_shadow.c instead of the lights list in the world model
world lights can be ingame edited/loaded/saved (the file name ends in .rtlights), this is all controlled by r_editlights* commands/cvars
realtime lighting cvars renamed from r_light_* to r_shadow_*
r_shadow_realtime takes the place of r_shadows modes 2 and 3, mode 1 is realtime lighting, mode 2 is realtime lighting plus visible shadow volumes overlaid
r_shadow_lightingmode variable added (updated each frame) indicating whether or not realtime lighting is active
changed how player model and chase_active is handled (player model is now considered a forced RENDER_EXTERIORMODEL), so player now casts shadows
R_Shadow_Volume no longer takes a vertex parameter, it is implied that it is in varray_vertex (since all the code relied on this fact anyway)
R_Shadow_Volume's code has been split out into reusable functions (R_Shadow_ProjectVertices, R_Shadow_MakeTriangleShadowFlags, R_Shadow_BuildShadowVolumeTriangles)
R_Shadow_RenderLighting split into R_Shadow_DiffuseLighting and R_Shadow_SpecularLighting since sometimes it's usable to use more than one call to diffuse lighting (colormapped models)
R_Model_Alias_DrawLight now handles colormapping
added Light_CullBox and LightAndVis_CullBox functions for culling shadow volumes
R_DrawWorldLightShadowVolume has been moved to r_shadow.c
Mod_ShadowMesh_Begin now takes an initial number of triangles to hold, number of triangles in each additional shadowmesh is now based on previous mesh
R_Model_Brush_DrawLightForSurfaceList added to greatly reduce wasted lighting
rewrote visibility logic in R_Model_Brush_DrawLight, now uses different approachs for bmodels and world
lights are now pvs culled (according to what leafs are visible to the viewer, and what leafs are visible to the light)
R_Shadow_Stage_EraseShadowVolumes now returns an int, indicating whether or not to draw the shadow volumes again to erase
rewrote how texture info based on entity and time is updated (it is now a function called R_UpdateTextureInfo)
fixed a ton of bugs relating to animated textures and transparency of bmodels (also changed texture_t currentframe to no longer be an array)
disabled building of surface neighbors (oh sure I made it a lot faster and stuff, but it's still not practical, and is no longer necessary)
changed parameters of model_t DrawLight function to no longer take distbias and subtract
Mod_ProcessLightList is no longer called
mlight_t fields relating to shadow volumes have been commented out
Mod_ValidateElements function added
notes on enormous cost added to Mod_BuildTextureVectorsAndNormals (188 float operations per triangle, and 39 float operations per vertex)
added (disabled) code for allocating and freeing shadowmeshs in pieces, just for obsessive memory corruption detection (none was found)
Mod_ShadowMesh_AddTriangle and Mod_ShadowMesh_AddMesh functions added, and Mod_ShadowMesh_AddPolygon now uses AddTriangle (this is a slowdown but I'm not sure it matters that it is, it fills out meshs more completely)
added (disabled) code for Mod_ShadowMesh_Finish to work without reallocating meshs
R_Shadow_ResizeTriangleFacingLight and R_Shadow_ResizeShadowElements added
R_Shadow_RenderShadowMeshVolume added (properly renders shadowmesh_t chains, fixing all the bugs with static shadow volume rendering)
r_shadow_blankbumptexture is now 1x1
r_shadow_blankglosstexture and r_shadow_blankwhitetexture added (both 1x1)
added a 4 texture path for r_shadowtexture3d 0 mode
when static shadow volumes are constructed for world lights, it is now done by constructing a combined mesh of all lit geometry, and then casting shadows from that (this reduces shadow volume edges greatly, since separate polygons become a continuous mesh during the mesh creation)

------------------------------------------------------------------------
r2569 | havoc | 2002-10-27 05:10:42 -0800 (Sun, 27 Oct 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_sky.c

added a FIXME note about skyboxes and vid_restart

------------------------------------------------------------------------
r2568 | havoc | 2002-10-27 04:13:53 -0800 (Sun, 27 Oct 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

set depth and stencil clear values

------------------------------------------------------------------------
r2567 | havoc | 2002-10-27 04:11:48 -0800 (Sun, 27 Oct 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/collision.c

check for out of bounds fraction

------------------------------------------------------------------------
r2566 | havoc | 2002-10-27 04:00:37 -0800 (Sun, 27 Oct 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c

add an error check for invalid maxfrac before returning it, nothing significant

------------------------------------------------------------------------
r2564 | havoc | 2002-10-26 08:23:58 -0700 (Sat, 26 Oct 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_sky.c

fix for drawing explosions and sky twice as much as necessary (!), no longer does a 360 degree sweep on both axis, one axis is only 180 degrees

------------------------------------------------------------------------
r2562 | havoc | 2002-10-25 05:30:55 -0700 (Fri, 25 Oct 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

fix for lift blocking due to imprecision at very low frame times (slowmo)

------------------------------------------------------------------------
r2561 | havoc | 2002-10-25 04:15:08 -0700 (Fri, 25 Oct 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

minor whitespace cleanup

------------------------------------------------------------------------
r2551 | havoc | 2002-10-22 00:13:13 -0700 (Tue, 22 Oct 2002) | 6 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/render.h

reworked visibility a bit (added VIS_CullBox and VIS_CullSphere) so it can be pretty accurate
made pvs surface/leaf lists to make R_SurfaceWorldNode as fast as possible
world geometry now casts shadows from frontfaces instead of backfaces
fixed most shadowing bugs
static shadow volumes now work (other than one bug I'm trying to find) and are on by default

------------------------------------------------------------------------
r2550 | havoc | 2002-10-22 00:10:26 -0700 (Tue, 22 Oct 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

added a comment describing GL triangle strip order (why add it to this?  convenience)

------------------------------------------------------------------------
r2549 | havoc | 2002-10-22 00:05:24 -0700 (Tue, 22 Oct 2002) | 3 lines
Changed paths:
   M /trunk/darkplaces/makefile

make profile now works
no longer prints 'Compiling whatever.c' and so on as per Mercury's request

------------------------------------------------------------------------
r2548 | havoc | 2002-10-22 00:03:44 -0700 (Tue, 22 Oct 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

cast shadows from frontfaces instead of backfaces

------------------------------------------------------------------------
r2547 | havoc | 2002-10-22 00:02:47 -0700 (Tue, 22 Oct 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_shared.c

don't use 3d textures on drivers that don't explicitly advertise it as an extension

------------------------------------------------------------------------
r2546 | havoc | 2002-10-21 00:21:01 -0700 (Mon, 21 Oct 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

change maximum lerp time from 1 second to 0.1 seconds (this was a mistake in a previous commit)

------------------------------------------------------------------------
r2545 | molivier | 2002-10-20 23:07:25 -0700 (Sun, 20 Oct 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

The new video menu is clean now (or at least cleaner). Updated Transfusion map list

------------------------------------------------------------------------
r2542 | havoc | 2002-10-19 16:23:03 -0700 (Sat, 19 Oct 2002) | 5 lines
Changed paths:
   M /trunk/darkplaces/net_master.c

reorganized how heartbeat timing works (much simpler and cleaner now)
sv_heartbeatperiod controls how often a heartbeat is sent
sv_public controls whether heartbeats are sent at all (default: 0)
sv_masterextra1 added (points at a master server that a friend just put online)

------------------------------------------------------------------------
r2541 | molivier | 2002-10-19 03:12:49 -0700 (Sat, 19 Oct 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/vid_wgl.c

Implemented a very simple video mode selection menu. The way it handles the various resolutions is still very naive, so expect another update soon.

------------------------------------------------------------------------
r2540 | molivier | 2002-10-19 02:43:46 -0700 (Sat, 19 Oct 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/r_shadow.c

Added a test when freeing textures (glt->image can be NULL if the program exits because of a lack of memory at startup). Also, Transfusion doesn't have a "start" map, so Transfusion dedicated servers shouldn't use it as their default map. Removed a preprocessor warning in r_shadow.c

------------------------------------------------------------------------
r2536 | havoc | 2002-10-16 19:44:08 -0700 (Wed, 16 Oct 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.mingw

trying less optimizations in hopes that it will fix the crashs

------------------------------------------------------------------------
r2535 | havoc | 2002-10-16 19:39:30 -0700 (Wed, 16 Oct 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

MSVC has a pathetic stack size.

------------------------------------------------------------------------
r2534 | havoc | 2002-10-16 15:33:16 -0700 (Wed, 16 Oct 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

oops, removed the wrong one

------------------------------------------------------------------------
r2533 | havoc | 2002-10-16 15:26:56 -0700 (Wed, 16 Oct 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

remove unused variables

------------------------------------------------------------------------
r2531 | havoc | 2002-10-16 14:48:14 -0700 (Wed, 16 Oct 2002) | 21 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/model_sprite.c
   M /trunk/darkplaces/palette.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_wgl.c

fixed some dynamic lighting bugs related to glowing self
rmeshstate_t now has alphascale
now clears stencil from shadows differently (draws shadow volume over again to clear)
R_LightModel now does GL_Color or GL_UseColorArray depending on whether the model has any shading
model->DrawBaseLighting function is gone, now just a few special cases in the normal Draw function
removed R_NotCulledBox
added PVS_CullBox, R_CullSphere, and PVS_CullSphere
visiblevolume flag is gone from shadow rendering code (visible volumes are now automatic depending on what stage the shadow system is in)
R_DrawShadowVolumes is gone (now just a special option to R_ShadowVolumeLighting)
cubemap textures now upload correctly
doubled the bumpyness of surfaces to make bumpmapping noticable (still less than tenebrae)
fixed crash when loading external map textures
now supports _luma as an alternate name for _glow map textures (tenebrae compatibility)
can now override _bump, _gloss, and _glow/_luma textures that were generated from the map
bumpmapping works on the map now (that was a stupid typo...)
now uses alpha buffering for multi-pass lighting effects
r_shadows 3 now works on Geforce2 (2tex no3D 3 pass per layer) and Radeon (2tex 3D 2 pass per layer - Radeon has 3 texture units but the lighting code is most efficient with 2 units, and 3D textures use up 2 texture units on Radeon... lame...)
gloss isn't working yet
r_shadows 3 mode supports up to 64x overbright lighting now (by rendering light multiple times)
fixed palettes (this fixes oddities like seeing sky behind fullbrights)

------------------------------------------------------------------------
r2530 | molivier | 2002-10-16 01:26:48 -0700 (Wed, 16 Oct 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

Added back "turn left" and "turn right" to the Transfusion bind list. Added 2 new Transfusion maps (e4m8 and maim)

------------------------------------------------------------------------
r2529 | havoc | 2002-10-15 16:22:36 -0700 (Tue, 15 Oct 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_video.c

made the QueueWantsMore message a Con_DPrintf

------------------------------------------------------------------------
r2528 | havoc | 2002-10-14 12:37:40 -0700 (Mon, 14 Oct 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

cruft

------------------------------------------------------------------------
r2527 | havoc | 2002-10-14 12:34:01 -0700 (Mon, 14 Oct 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

fix jitter in interpolation of monster movement

------------------------------------------------------------------------
r2526 | havoc | 2002-10-14 12:05:23 -0700 (Mon, 14 Oct 2002) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/image.h
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/model_sprite.c
   M /trunk/darkplaces/palette.c
   M /trunk/darkplaces/palette.h
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/r_crosshairs.c
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/r_textures.h
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/sbar.c
   M /trunk/darkplaces/vid_shared.c

R_LoadTexture functions take a palette pointer now
there are many palettes available now (d_8to24table renamed to palette_complete)
R_LoadTexture is gone, use R_LoadTexture2D instead
bumpmaps are now generated for models and maps (sigh, so much reworking of their loaders)

------------------------------------------------------------------------
r2522 | havoc | 2002-10-13 15:13:57 -0700 (Sun, 13 Oct 2002) | 24 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/mathlib.h
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/model_sprite.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h
   M /trunk/darkplaces/r_textures.h
   M /trunk/darkplaces/render.h

added TEXF_CLAMP flag for textures
r_shadows 3 mode is under heavy construction
changed pvsframecount stuff to be part of the model structure
new function Mod_BuildTextureVectorsAndNormals added
changed/improved how animating textures work
surface texture chains are now permanent for the lifetime of the model, and are specific to each submodel
surface textures now have a rendertype field which is updated every time R_PrepareSurfaces is called, values are SURFRENDER_ADD, SURFRENDER_ALPHA, or SURFRENDER_OPAQUE
added SHADERSTAGE_BASELIGHTING
added surfaceneighbors system (currently disabled because it increases load time greatly)
surface meshs are now allocated by a single function to simplify things
more heavy construction on static shadow volumes (which aren't working correctly)
VectorNormalize, VectorNormalize2, and VectorNormalizeDouble macros no longer produce infinite vectors if given null vectors
corrected names of dot3 enums
reduced duplicate code in texture manager with some new arrays for gl texture type enums
added GL_SetupView_Mode_PerspectiveInfiniteFarClip based on code from tenebrae
texture state management now has combinergb and combinealpha for each texture unit
aliasvert array went away
aliasvert_svectors, aliasvert_tvectors, and aliasvert_normals added (note: padded to 4 floats)
aliasvertnorm replaced with aliasvert_normals (adjusted code to use 4 float padding)
new r_light_* cvars allow tweaking of r_shadows 3 lighting system
R_DrawShadowSphere now works correctly
fixed fakeshadows appearing ontop of transparent stuff
got rid of unused RSurfShader_Wall_Fullbright

------------------------------------------------------------------------
r2520 | molivier | 2002-10-10 23:20:33 -0700 (Thu, 10 Oct 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

Added Frag'M to the Transfusion map list

------------------------------------------------------------------------
r2518 | havoc | 2002-10-09 10:25:05 -0700 (Wed, 09 Oct 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

fixed glowing entities disappearing randomly (by testing more thoroughly)

------------------------------------------------------------------------
r2515 | havoc | 2002-10-07 11:43:12 -0700 (Mon, 07 Oct 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile

Elric rewrote the makefile, it is quite self explanatory when run.

------------------------------------------------------------------------
r2513 | havoc | 2002-10-06 16:09:46 -0700 (Sun, 06 Oct 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_shared.c

now checks for both TexImage3D built into the OpenGL library and for GL_EXT_texture3D (glTexImage3DEXT, etc)

------------------------------------------------------------------------
r2512 | havoc | 2002-10-06 09:51:35 -0700 (Sun, 06 Oct 2002) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/r_shadow.c

make r_shadows 3 mode mostly match lighting conditions of the lightmaps
r_shadows 3 mode now checks SURF_SHADOWCAST and SURF_SHADOWLIGHT flags

------------------------------------------------------------------------
r2511 | havoc | 2002-10-06 08:08:22 -0700 (Sun, 06 Oct 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

fix restart command

------------------------------------------------------------------------
r2510 | havoc | 2002-10-06 08:07:48 -0700 (Sun, 06 Oct 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

clean up map changes a little more

------------------------------------------------------------------------
r2509 | havoc | 2002-10-06 07:45:53 -0700 (Sun, 06 Oct 2002) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

fix fragment texture image creation so it has depth 1
error if fragment texture is attempted with texture types other than 2D

------------------------------------------------------------------------
r2508 | havoc | 2002-10-06 07:43:11 -0700 (Sun, 06 Oct 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

GL_DrawRangeElements now reports if it got a bogus indexcount and vertex range

------------------------------------------------------------------------
r2507 | havoc | 2002-10-06 07:40:58 -0700 (Sun, 06 Oct 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

R_ShadowMesh_Finish now discards empty meshs

------------------------------------------------------------------------
r2506 | havoc | 2002-10-06 07:23:32 -0700 (Sun, 06 Oct 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_shared.c

detect 3D textures as GL_EXT_texture3D again

------------------------------------------------------------------------
r2505 | havoc | 2002-10-06 06:58:23 -0700 (Sun, 06 Oct 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

use qbyte * math instead of void * math to keep MSVC happy

------------------------------------------------------------------------
r2504 | havoc | 2002-10-05 20:24:47 -0700 (Sat, 05 Oct 2002) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h
   M /trunk/darkplaces/vid_shared.c

3D attenuation texture works now
also fixed the commandline options -width and such (untested)

------------------------------------------------------------------------
r2503 | havoc | 2002-10-05 12:32:43 -0700 (Sat, 05 Oct 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h

backend now supports 1D, 2D, 3D, and Cubemap texture binding

------------------------------------------------------------------------
r2502 | havoc | 2002-10-05 07:38:14 -0700 (Sat, 05 Oct 2002) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/cl_screen.h
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_crosshairs.c
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/r_sprites.c

texcoord arrays are now 3 component (padded to 4 floats)
rewrote zym model loader
partially rewrote skysphere rendering

------------------------------------------------------------------------
r2499 | havoc | 2002-10-04 15:31:51 -0700 (Fri, 04 Oct 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.c

now uploads a 3D attenuation texture (not used yet)

------------------------------------------------------------------------
r2498 | havoc | 2002-10-04 15:28:42 -0700 (Fri, 04 Oct 2002) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/r_textures.h

forgot to add prototypes for new texture functions to r_textures.h
fixed misreporting of texture memory use (was reporting 0 for all textures because sides was 0)

------------------------------------------------------------------------
r2497 | havoc | 2002-10-04 14:04:11 -0700 (Fri, 04 Oct 2002) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/image.h
   M /trunk/darkplaces/vid_shared.c

1D, 3D, and cubemap textures are now supported (in addition to 2D)
added detection of GL_EXT_texture3D, GL_ARB_texture_cube_map, and GL_ARB_texture_env_dot3
shadow volume rendering mode now depends on all of the above being present (but doesn't use them yet)

------------------------------------------------------------------------
r2496 | havoc | 2002-10-04 06:52:01 -0700 (Fri, 04 Oct 2002) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/model_sprite.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h
   M /trunk/darkplaces/r_sprites.c
   M /trunk/darkplaces/render.h

shadow volume rendering still very incomplete, but works mostly
committing this before I add 3D textures to the texture manager
(alert: this is the last version of the stencil shadow rendering that will work with TNT class hardware (and not well), 3D textures will be required and will not work on TNT class... sorry.  vertex just looks too horrible)

------------------------------------------------------------------------
r2494 | molivier | 2002-10-03 23:05:46 -0700 (Thu, 03 Oct 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/cl_screen.h
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/net_main.c

Added a couple more "const". Fixed "+map" in the command line for dedicated servers. Updated LordHavoc email address in the multiplayer menu. Removed some duplicated code.

------------------------------------------------------------------------
r2493 | havoc | 2002-10-03 10:11:24 -0700 (Thu, 03 Oct 2002) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/model_sprite.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_light.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h

massive coding has been done on shadow volumes (some scrapped code which will be removed, some incomplete code, etc)
some model fixes relating to gl_combine - r_quickmodels is gone
off-screen models were not being culled (oops)

------------------------------------------------------------------------
r2492 | molivier | 2002-10-02 23:51:52 -0700 (Wed, 02 Oct 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_models.c

From LordHavoc: the r_quickmodels cvar wasn't used anywhere; it's fixed.

------------------------------------------------------------------------
r2491 | molivier | 2002-10-02 23:36:54 -0700 (Wed, 02 Oct 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/vid_null.c

Removed an unused variable in gl_draw.c (Forest, could you double check this one please?). Removed an useless include in vid_null.c

------------------------------------------------------------------------
r2490 | molivier | 2002-10-02 05:02:15 -0700 (Wed, 02 Oct 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

Fixed dedicated server (the server was never really spawned)

------------------------------------------------------------------------
r2489 | molivier | 2002-10-02 00:02:14 -0700 (Wed, 02 Oct 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile

Made a few changes to makefile so we can switch compiler more easily

------------------------------------------------------------------------
r2488 | molivier | 2002-10-01 23:50:45 -0700 (Tue, 01 Oct 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/net.h
   M /trunk/darkplaces/net_dgrm.c
   M /trunk/darkplaces/net_dgrm.h
   M /trunk/darkplaces/net_loop.c
   M /trunk/darkplaces/net_loop.h
   M /trunk/darkplaces/net_main.c
   M /trunk/darkplaces/net_master.c
   M /trunk/darkplaces/net_master.h
   M /trunk/darkplaces/net_win.c
   M /trunk/darkplaces/sv_main.c

Tried to be a little smarter with the heartbeats, using a simple priority mecanism. Added a few "const" here and there in the net code. Fixed heartbeat code on Win32 (added Loop_Heartbeat and Datagram_Heartbeat to net_win.c; oups...)

------------------------------------------------------------------------
r2486 | havoc | 2002-09-30 11:01:08 -0700 (Mon, 30 Sep 2002) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h

optimized trianglefacing calculation, per Vic's recommendation (yes it's all one statement now)
shadow functions now take a vertex array pointer, to make them more broadly useful (in precomputation perhaps?)
beginning work on a precomputed shadow volumes system for static lights

------------------------------------------------------------------------
r2485 | havoc | 2002-09-30 07:55:28 -0700 (Mon, 30 Sep 2002) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/vid_shared.c

bmodel shadow volumes
static lights (in maps with .lights files) now cast shadow volumes (this combined with the above makes dpdm1 and dpdm2 unplayably slow - need to do precomputed world shadow volumes)
(note: like the previous shadow volume commits, this is still just visible volumes when you use r_shadows 2, purely experimental still)

------------------------------------------------------------------------
r2484 | havoc | 2002-09-30 07:52:26 -0700 (Mon, 30 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

smoke from bullet impacts and rocket trails now grows in size a little as it fades

------------------------------------------------------------------------
r2482 | havoc | 2002-09-29 23:53:30 -0700 (Sun, 29 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/r_crosshairs.c
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_shadow.c
   M /trunk/darkplaces/r_shadow.h
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/r_sprites.c
   M /trunk/darkplaces/vid_shared.c

gl backend now has functions for color array and flat color states (GL_UseColorArray and GL_Color), this gets a 9.76% speed gain in bigass1 for me

------------------------------------------------------------------------
r2481 | havoc | 2002-09-29 20:37:53 -0700 (Sun, 29 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

fix changelevel, and simplify restart code

------------------------------------------------------------------------
r2480 | havoc | 2002-09-29 19:34:37 -0700 (Sun, 29 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c

fix view blends

------------------------------------------------------------------------
r2479 | havoc | 2002-09-29 19:19:36 -0700 (Sun, 29 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_shadow.h

newline to keep gcc3 happy

------------------------------------------------------------------------
r2478 | havoc | 2002-09-29 19:07:32 -0700 (Sun, 29 Sep 2002) | 2 lines
Changed paths:
   A /trunk/darkplaces/r_shadow.h

forgot to commit this

------------------------------------------------------------------------
r2477 | havoc | 2002-09-29 18:57:43 -0700 (Sun, 29 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.dsp
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/makefile.mingw
   A /trunk/darkplaces/r_shadow.c

new experimental shadow volumes, try r_shadows 2 to see the shadow volumes cast by dlights

------------------------------------------------------------------------
r2476 | havoc | 2002-09-29 18:09:13 -0700 (Sun, 29 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/model_sprite.c

added radius and radius2 (squared radius) fields to model structure

------------------------------------------------------------------------
r2475 | havoc | 2002-09-29 18:05:10 -0700 (Sun, 29 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_light.h

ent field added back to dlight structures

------------------------------------------------------------------------
r2474 | havoc | 2002-09-29 18:00:31 -0700 (Sun, 29 Sep 2002) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

now uses more smoke particles for gunshots, looks better
more WORKINGLQUAKE stuff

------------------------------------------------------------------------
r2473 | havoc | 2002-09-29 17:55:17 -0700 (Sun, 29 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c

added -gl_driver commandline option, and cleaned up some glX init stuff a bit

------------------------------------------------------------------------
r2469 | havoc | 2002-09-28 19:06:55 -0700 (Sat, 28 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c

fix DrawQ_Fill rendering (Pic with no string)

------------------------------------------------------------------------
r2468 | havoc | 2002-09-28 16:59:46 -0700 (Sat, 28 Sep 2002) | 4 lines
Changed paths:
   M /trunk/darkplaces/vid_wgl.c

fixed vid_restart
now destroys the window (did not before)
fixed stupid behavior in MainWndProc handling of WM_DESTROY (it's no longer caught)

------------------------------------------------------------------------
r2467 | havoc | 2002-09-28 05:41:50 -0700 (Sat, 28 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_wgl.c

needed one more prototype

------------------------------------------------------------------------
r2466 | havoc | 2002-09-28 05:34:15 -0700 (Sat, 28 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_wgl.c

trying to fix many forward references in input code

------------------------------------------------------------------------
r2465 | havoc | 2002-09-28 03:54:36 -0700 (Sat, 28 Sep 2002) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_models.c

major speedup to alias model fake shadow rendering
now traces in direction of light instead of straight down, this causes a shadow to be cast on a wall in some cases (desirable)

------------------------------------------------------------------------
r2464 | havoc | 2002-09-28 03:50:34 -0700 (Sat, 28 Sep 2002) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

disabled smoke from explosions, it was a minor effect and used too much fillrate
added fractalnoise to the WORKINGLQUAKE section at the top, and fixed an oldtime reference in WORKINGLQUAKE code

------------------------------------------------------------------------
r2463 | havoc | 2002-09-28 03:23:16 -0700 (Sat, 28 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

fix restart command (can't do the "connect local" for a restart)

------------------------------------------------------------------------
r2457 | havoc | 2002-09-27 22:35:21 -0700 (Fri, 27 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c

map and load commands are now delayed until the video system is started, this fixes crashs caused by the video system starting after the configs are read

------------------------------------------------------------------------
r2456 | havoc | 2002-09-27 21:44:44 -0700 (Fri, 27 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/cl_screen.h
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/gl_draw.c

2D is now drawn using R_Mesh system

------------------------------------------------------------------------
r2455 | havoc | 2002-09-27 21:43:45 -0700 (Fri, 27 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

fixed glOrtho call

------------------------------------------------------------------------
r2454 | havoc | 2002-09-27 21:42:02 -0700 (Fri, 27 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/client.h

added sparks and smoke to explosions

------------------------------------------------------------------------
r2453 | havoc | 2002-09-27 05:02:23 -0700 (Fri, 27 Sep 2002) | 4 lines
Changed paths:
   M /trunk/darkplaces/cgamevm.c
   M /trunk/darkplaces/chase.c
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/cl_collision.h
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/matrixlib.c
   M /trunk/darkplaces/matrixlib.h
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/model_sprite.c
   M /trunk/darkplaces/r_crosshairs.c
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/render.h

CL_TraceLine can now return what entity was hit (this isn't actually used, and accounts for most of the changed files)
r_shadows returns, currently only supported on alias models (they are the only ones with a DrawFakeShadow function)
added Matrix4x4_Transform3x3

------------------------------------------------------------------------
r2452 | havoc | 2002-09-27 00:30:05 -0700 (Fri, 27 Sep 2002) | 4 lines
Changed paths:
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_null.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c

stencil is now supported (optional, off by default, use vid_stencil to enable)
vid_ cvars are updated when VID_Mode succeeds
GL stencil functions enabled

------------------------------------------------------------------------
r2451 | havoc | 2002-09-26 22:49:29 -0700 (Thu, 26 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h

alias mdl/md2 models now have a mdlmd2data_triangleneighbors array

------------------------------------------------------------------------
r2450 | havoc | 2002-09-26 22:23:34 -0700 (Thu, 26 Sep 2002) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h

added Mod_FindTriangleWithEdge and Mod_BuildTriangleNeighbors functions (not used by anything)
added Mod_LoadModels function, which is called when renderer is restarted or "modelflush" is used, it reloads all models that are used

------------------------------------------------------------------------
r2449 | havoc | 2002-09-26 22:06:51 -0700 (Thu, 26 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c

added newline to end of Draw_CachePic error message

------------------------------------------------------------------------
r2447 | molivier | 2002-09-26 00:28:53 -0700 (Thu, 26 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

Updated Transfusion map list

------------------------------------------------------------------------
r2446 | molivier | 2002-09-26 00:20:59 -0700 (Thu, 26 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/net_master.c

The call to alloca has been removed. This function has a quite bad reputation and MinGW didn't want it anyway.

------------------------------------------------------------------------
r2445 | havoc | 2002-09-25 19:55:14 -0700 (Wed, 25 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_exec.c

increased maximum stack depth

------------------------------------------------------------------------
r2444 | havoc | 2002-09-25 19:38:38 -0700 (Wed, 25 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

limit entity movement lerp to 10th of a second

------------------------------------------------------------------------
r2443 | havoc | 2002-09-25 18:45:12 -0700 (Wed, 25 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c

fix for repeated mode switchs losing keyboard/mouse focus

------------------------------------------------------------------------
r2442 | havoc | 2002-09-25 18:24:41 -0700 (Wed, 25 Sep 2002) | 13 lines
Changed paths:
   M /trunk/darkplaces/cd_linux.c
   M /trunk/darkplaces/cd_null.c
   M /trunk/darkplaces/cd_win.c
   M /trunk/darkplaces/cdaudio.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/input.h
   M /trunk/darkplaces/snd_alsa_0_5.c
   M /trunk/darkplaces/snd_alsa_0_9.c
   M /trunk/darkplaces/snd_null.c
   M /trunk/darkplaces/snd_oss.c
   M /trunk/darkplaces/snd_win.c
   M /trunk/darkplaces/sound.h
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_null.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c

this commit adds video mode switching, and preferred mode is saved to config, no more need for -window/-width/-height/-bpp (they still work)
IN_Init and IN_Shutdown code has been merged into VID_InitMode and VID_Shutdown code in each of the video systems
VID_InitCvars renamed to VID_Shared_Init
VID_Open and VID_Close functions added in vid_shared, Host_Init now calls VID_Open
S_Open/Close and CDAudio_Open/Close added (none of these do anything yet)
VID_Open and VID_Close call R_Modules_Start, S_Open, and CDAudio_Open and their corresponding Close functions
VID_Restart_f added (vid_restart command)
vid_hidden now starts true (to avoid any refreshs until video is started)
vid_fullscreen/width/height/bitsperpixel are now saved to config
VID_Open is called after configs are parsed
Render_Init now longer starts/stops modules
IN_MouseEvent in vid_wgl.c no longer clamps pitch (since that's done by IN_PostMove)

------------------------------------------------------------------------
r2441 | havoc | 2002-09-24 19:38:01 -0700 (Tue, 24 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_wgl.c

added -gl_driver commandline option, it's useless though (crashs when I try it on my voodoo2)

------------------------------------------------------------------------
r2437 | havoc | 2002-09-24 15:17:31 -0700 (Tue, 24 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/net_udp.c
   M /trunk/darkplaces/net_udp.h

fix warnings

------------------------------------------------------------------------
r2436 | havoc | 2002-09-24 15:11:44 -0700 (Tue, 24 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/net.h
   M /trunk/darkplaces/net_wipx.c
   M /trunk/darkplaces/net_wipx.h

fix some prototype warnings

------------------------------------------------------------------------
r2435 | havoc | 2002-09-24 15:11:08 -0700 (Tue, 24 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.mingw

update file list

------------------------------------------------------------------------
r2434 | havoc | 2002-09-24 15:10:21 -0700 (Tue, 24 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/sys_win.c

fix a warning on argv

------------------------------------------------------------------------
r2433 | havoc | 2002-09-24 15:09:40 -0700 (Tue, 24 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_wgl.c

remove an unused extension function list

------------------------------------------------------------------------
r2432 | havoc | 2002-09-24 05:16:28 -0700 (Tue, 24 Sep 2002) | 8 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/darkplaces.dsp
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/net.h
   M /trunk/darkplaces/net_bsd.c
   M /trunk/darkplaces/net_dgrm.c
   M /trunk/darkplaces/net_dgrm.h
   M /trunk/darkplaces/net_loop.c
   M /trunk/darkplaces/net_loop.h
   M /trunk/darkplaces/net_main.c
   A /trunk/darkplaces/net_master.c
   A /trunk/darkplaces/net_master.h
   M /trunk/darkplaces/net_udp.c
   M /trunk/darkplaces/net_udp.h
   M /trunk/darkplaces/net_win.c
   M /trunk/darkplaces/net_wins.c
   M /trunk/darkplaces/net_wins.h
   M /trunk/darkplaces/net_wipx.c
   M /trunk/darkplaces/net_wipx.h
   M /trunk/darkplaces/sv_main.c

Thanks to Elric for adding dpmaster support!
slist command renamed to net_slist, net_inetslist command added
"heartbeat" command notifies master server(s) of your server's presence (this is automatic, but you can force a heartbeat)
sv_master1 through sv_master4 cvars contain master server addresses, they all default to "" (none), this may change if someone hosts a darkplaces master server and wants it added to the defaults...  (note: these cvars ARE saved to config)
com_modname contains the currently running mod directory name (for example id1, darkplaces, transfusion, etc)
some Con_DPrintf's have been added to the server query code, so if you want to know if people are checking out your server, it should tell you about it now (I think?)
some Con_DPrintf's exist in the inetslist code so you can watch the packet flow

------------------------------------------------------------------------
r2428 | havoc | 2002-09-24 01:38:27 -0700 (Tue, 24 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cd_linux.c

whitespace changes by Elric

------------------------------------------------------------------------
r2427 | havoc | 2002-09-24 00:42:04 -0700 (Tue, 24 Sep 2002) | 5 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_crosshairs.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/sbar.c

static crosshair is now drawn during sbar stage (where it should be), fixes the bug where it appeared infront of the menus
world crosshair size is now constant on the screen
rearranged code greatly
it just works better, ok?

------------------------------------------------------------------------
r2426 | havoc | 2002-09-24 00:05:13 -0700 (Tue, 24 Sep 2002) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/sbar.c

now pretends gfx.wad pics are in the gfx/ directory, this changes the override path for gfx.wad pics (statusbar images in other words) to be for example gfx/blah.tga, however the old override path (no prepended gfx/) is still supported for compatibility with previous versions (mainly just for sake of conchars and conback)
Sbar_Init now called from Render_Init instead of Host_Init (it was being called before the texture system was started...)
Sbar_Init now registers an sbar module, with corresponding start/shutdown/newmap functions, so when the renderer is restarted, the pics are precached again

------------------------------------------------------------------------
r2425 | havoc | 2002-09-23 23:59:49 -0700 (Mon, 23 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_null.c

fixed.

------------------------------------------------------------------------
r2424 | havoc | 2002-09-22 23:13:17 -0700 (Sun, 22 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_shared.c

default to 640x480x16 again, just for consistency with other engines

------------------------------------------------------------------------
r2423 | havoc | 2002-09-22 22:59:01 -0700 (Sun, 22 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_wgl.c

wglGetExtensionsString is properly detected now (was checking for an extension string, but none is present outside the wgl extensions list, which is a chicken and egg problem, now just checks if the function exists, like the spec says to do)

------------------------------------------------------------------------
r2422 | havoc | 2002-09-22 22:56:04 -0700 (Sun, 22 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_shared.c

VID_CompareMode removed

------------------------------------------------------------------------
r2421 | havoc | 2002-09-22 21:37:33 -0700 (Sun, 22 Sep 2002) | 5 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/darkplaces.dsp
   M /trunk/darkplaces/host.c
   D /trunk/darkplaces/in_win.c
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_null.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c
   M /trunk/darkplaces/winquake.h

almost completely rewrote vid_wgl's mode code, there is no modelist of any kind anymore
vid_wgl works again
VID_Init renamed to VID_InitMode, it returns false if it was unsuccessful
VID_Mode added, which prints mode change message to console and passes on to VID_InitMode

------------------------------------------------------------------------
r2420 | havoc | 2002-09-22 21:24:51 -0700 (Sun, 22 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/sys_win.c

now uses VID_Shutdown instead of VID_SetDefaultMode (which hardly does anything in vid_wgl anyway)

------------------------------------------------------------------------
r2419 | havoc | 2002-09-22 21:20:04 -0700 (Sun, 22 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/snd_mix.c

no need to include winquake.h

------------------------------------------------------------------------
r2418 | eviltypeguy | 2002-09-22 19:02:33 -0700 (Sun, 22 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_oss.c

Make formatting sane

------------------------------------------------------------------------
r2414 | havoc | 2002-09-21 17:29:49 -0700 (Sat, 21 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_wgl.c

fixed crash on startup and shutdown

------------------------------------------------------------------------
r2413 | havoc | 2002-09-21 17:19:43 -0700 (Sat, 21 Sep 2002) | 3 lines
Changed paths:
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_null.c
   M /trunk/darkplaces/vid_wgl.c

VID_Init now takes an int bpp parameter
finished some work on the wgl VID_Init code

------------------------------------------------------------------------
r2412 | havoc | 2002-09-21 17:17:46 -0700 (Sat, 21 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cd_win.c
   M /trunk/darkplaces/net_wins.c
   M /trunk/darkplaces/net_wins.h
   M /trunk/darkplaces/net_wipx.c
   M /trunk/darkplaces/net_wipx.h

const.

------------------------------------------------------------------------
r2411 | havoc | 2002-09-21 17:16:50 -0700 (Sat, 21 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c

Mem_Free on a const pointer apparently irritates MSVC but not gcc...  hush MSVC

------------------------------------------------------------------------
r2410 | havoc | 2002-09-21 16:18:41 -0700 (Sat, 21 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.dsp

DOS line endings

------------------------------------------------------------------------
r2397 | havoc | 2002-09-19 22:29:09 -0700 (Thu, 19 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

fix for glowing invisible models showing up (artifact items staying visible after pickup in darkplaces mod - the glow still stays though)

------------------------------------------------------------------------
r2396 | havoc | 2002-09-19 16:51:53 -0700 (Thu, 19 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

fix for beams coming from invisible objects

------------------------------------------------------------------------
r2392 | havoc | 2002-09-19 11:01:45 -0700 (Thu, 19 Sep 2002) | 3 lines
Changed paths:
   D /trunk/darkplaces/cl_light.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   D /trunk/darkplaces/cl_tent.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/darkplaces.dsp
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/makefile.mingw

shuffled cl_light and some of cl_tent into cl_main and remaining cl_tent code into cl_parse
got rid of bitprofile console command because it only worked for old protocol (probably should add it back for new protocol though)

------------------------------------------------------------------------
r2391 | havoc | 2002-09-17 22:02:10 -0700 (Tue, 17 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile

disable profiling by default

------------------------------------------------------------------------
r2390 | havoc | 2002-09-17 21:57:21 -0700 (Tue, 17 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

move CL_RelinkBeams after CL_RelinkNetworkEntities so position is up to date

------------------------------------------------------------------------
r2389 | havoc | 2002-09-17 21:51:59 -0700 (Tue, 17 Sep 2002) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_tent.c

make lightning come from player's gun
fix lightning visibility (wasn't calculating bounding box before)

------------------------------------------------------------------------
r2388 | havoc | 2002-09-17 20:50:21 -0700 (Tue, 17 Sep 2002) | 3 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/filematch.c

matchpattern can now be case insensitive if desired
pak filename matching is now case insensitive

------------------------------------------------------------------------
r2387 | havoc | 2002-09-17 16:23:45 -0700 (Tue, 17 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/snd_dma.c
   M /trunk/darkplaces/snd_null.c
   M /trunk/darkplaces/sound.h
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_glx.c
   A /trunk/darkplaces/vid_null.c
   M /trunk/darkplaces/vid_wgl.c

you can now build a darkplaces-dedicated executable as well as a darkplaces-glx executable (and infact this is done automatically :)

------------------------------------------------------------------------
r2386 | havoc | 2002-09-17 14:47:10 -0700 (Tue, 17 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/client.h

sparks and rain are now beam particles

------------------------------------------------------------------------
r2385 | havoc | 2002-09-17 14:27:46 -0700 (Tue, 17 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/render.h

added R_CalcBeamVerts function, calculates vertex array for beam polygon

------------------------------------------------------------------------
r2384 | havoc | 2002-09-17 14:25:51 -0700 (Tue, 17 Sep 2002) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/cl_screen.h
   M /trunk/darkplaces/cl_video.c
   M /trunk/darkplaces/gl_draw.c

colors for DrawQ_Mesh are now float rather than byte, and vertices are padded to 4 floats per vertex
R_DrawQueue conversion to R_Mesh is getting closer to done

------------------------------------------------------------------------
r2383 | havoc | 2002-09-16 18:40:59 -0700 (Mon, 16 Sep 2002) | 8 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/r_crosshairs.c
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/r_sprites.c
   M /trunk/darkplaces/render.h

m.wantoverbright is gone
done manually by the few things that wanted it (tweaking the texrgbscale in other words, and their own local colorscale variables)
mesh_colorscale renamed to r_colorscale, and now available throughout rendering (no need to wait for the results of R_Mesh_State before scaling your colors)
lightscalebit renamed to r_lightmapscalebit
lightscale is gone (wasn't used)
msurface_t cached_lightscalebit renamed accordingly to cached_lightmapscalebit
starting work on converting the 2D system to use R_Mesh calls

------------------------------------------------------------------------
r2379 | havoc | 2002-09-15 13:13:59 -0700 (Sun, 15 Sep 2002) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/gl_rsurf.c

integer dlight code is now 32bit (instead of 64bit)
stain creation code is now floating point
stain creation code is now linear falloff instead of 1/(x*x), to make stains more consistent with respect to radius (their center density is exactly known)

------------------------------------------------------------------------
r2378 | havoc | 2002-09-13 17:25:02 -0700 (Fri, 13 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

enlarge bbox for visibility purposes if there is a glow or other such effect

------------------------------------------------------------------------
r2376 | havoc | 2002-09-12 21:03:54 -0700 (Thu, 12 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_rmain.c

GL_SetupView_* functions added, they replace most of R_Mesh_Start's functionality (it still exists and does the remaining things), GL_SetupView_* functions should be used for setting up a view (obviously) for rendering, view orientation and perspective and all that...

------------------------------------------------------------------------
r2375 | havoc | 2002-09-12 20:33:36 -0700 (Thu, 12 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c

unused variable arraylocked removed

------------------------------------------------------------------------
r2373 | havoc | 2002-09-12 15:31:18 -0700 (Thu, 12 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_draw.c

got rid of gl_mesh_drawmode, now only gl_mesh_drawrangeelements remains, this got rid of support for non-vertex-array rendering, also now c_meshs and c_meshtris are counted by GL_DrawRangeElements (c_meshtris was renamed to c_meshelements)

------------------------------------------------------------------------
r2372 | havoc | 2002-09-12 09:07:13 -0700 (Thu, 12 Sep 2002) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_crosshairs.c
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/r_sprites.c

varray_element is gone, instead you pass your own element array to R_Mesh_Draw
this got a 3.5% speed gain in cavetest2bench
also, R_Mesh_ResizeCheck now takes only a numverts parameter, since numtriangles was only used for the varray_element array

------------------------------------------------------------------------
r2371 | havoc | 2002-09-12 07:55:25 -0700 (Thu, 12 Sep 2002) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/vid_shared.c

manually inlined GL_LockArray and GL_UnlockArray in the only places they were used
RGB fragment textures are no longer aligned on 3 pixel boundaries, changed UNPACK_ALIGNMENT to allow this

------------------------------------------------------------------------
r2365 | havoc | 2002-09-12 05:20:01 -0700 (Thu, 12 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/pr_exec.c

added pr_traceqc cvar, to enable serious spew (printing every opcode executed to console) for extreme debugging

------------------------------------------------------------------------
r2364 | havoc | 2002-09-12 05:15:34 -0700 (Thu, 12 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/keys.c

a little extra error checking in keynum lookup

------------------------------------------------------------------------
r2363 | havoc | 2002-09-11 08:05:44 -0700 (Wed, 11 Sep 2002) | 13 lines
Changed paths:
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c

VID_Init now takes mode settings (fullscreen, width, height)
commandline options like -window and -width are now parsed by vid_shared code
vid_width, vid_height, and vid_bitsperpixel cvars added, vid_mode removed
VID_CompareMode added, for simpler mode matching (returns a double, smaller value is better match)
GL_OpenLibrary takes a library name to load
GL_OpenLibrary, GL_CloseLibrary, and GL_GetProcAddress have been moved to platform specific vid_ files (wgl and glx)
gl_platform added (example values: "WGL", "GLX")
gl_platformextensions added (containing any extensions reported by platform specific strings)
gl_checkextension renamed to GL_CheckExtension for consistency
glXQueryExtensionsString and glXGetProcAddressARB support
looks up GLX_SGI_video_sync extension
removed halfscreen hack from vid_wgl (the code that tried to identify dual monitor configurations and use only one of them)

------------------------------------------------------------------------
r2362 | havoc | 2002-09-11 07:55:46 -0700 (Wed, 11 Sep 2002) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/cmd.h
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/console.h
   M /trunk/darkplaces/cvar.c
   M /trunk/darkplaces/cvar.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/net.h
   M /trunk/darkplaces/net_dgrm.c
   M /trunk/darkplaces/net_udp.c
   M /trunk/darkplaces/net_udp.h
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/pr_exec.c
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sys_linux.c
   M /trunk/darkplaces/zone.c
   M /trunk/darkplaces/zone.h

whitespace
lots of things are now const pointers

------------------------------------------------------------------------
r2361 | havoc | 2002-09-11 07:12:30 -0700 (Wed, 11 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_dma.c

check for -safe

------------------------------------------------------------------------
r2360 | havoc | 2002-09-11 06:59:53 -0700 (Wed, 11 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/render.h

R_SetSkyBox now takes a const char *

------------------------------------------------------------------------
r2359 | havoc | 2002-09-11 06:57:54 -0700 (Wed, 11 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c

whitespace

------------------------------------------------------------------------
r2358 | havoc | 2002-09-11 06:54:36 -0700 (Wed, 11 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/in_win.c

check for -safe

------------------------------------------------------------------------
r2357 | havoc | 2002-09-11 06:49:07 -0700 (Wed, 11 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/keys.c

whitespace

------------------------------------------------------------------------
r2356 | havoc | 2002-09-11 06:48:31 -0700 (Wed, 11 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cd_linux.c
   M /trunk/darkplaces/cd_win.c

check for -safe

------------------------------------------------------------------------
r2355 | havoc | 2002-09-10 21:03:27 -0700 (Tue, 10 Sep 2002) | 5 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/mathlib.c
   M /trunk/darkplaces/mathlib.h
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/sv_main.c

BoxOnPlaneSideFunc code - gone, replaced by BoxOnPlaneSide
BOX_ON_PLANE_SIDE macro - gone, no replacement necessary (use BoxOnPlaneSide)
R_CullBox and R_CulledBox macros have been replaced by optimized functions
this gets a minor speed gain overall

------------------------------------------------------------------------
r2354 | havoc | 2002-09-10 18:19:39 -0700 (Tue, 10 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

major speed gain in cavetest2 by checking if the portal is facing the wrong way

------------------------------------------------------------------------
r2353 | havoc | 2002-09-10 17:15:23 -0700 (Tue, 10 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/zone.c
   M /trunk/darkplaces/zone.h

memheaders are now doubly linked, so Mem_Free goes faster than it used to

------------------------------------------------------------------------
r2352 | havoc | 2002-09-10 16:04:07 -0700 (Tue, 10 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

corrected an error message in .lights code

------------------------------------------------------------------------
r2351 | havoc | 2002-09-10 15:47:05 -0700 (Tue, 10 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

no need to update lightmaps if using r_vertexsurfaces

------------------------------------------------------------------------
r2350 | havoc | 2002-09-10 15:27:59 -0700 (Tue, 10 Sep 2002) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_light.c

optimizing R_DrawSurfaces and WorldNode functions
visframe and pvsframe are now arrays rather than part of the surface struct, resulting in less cache misses

------------------------------------------------------------------------
r2349 | havoc | 2002-09-10 10:17:18 -0700 (Tue, 10 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile

enable optimizations again (oops)

------------------------------------------------------------------------
r2348 | havoc | 2002-09-10 10:12:15 -0700 (Tue, 10 Sep 2002) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.h

surfaces are now texture sorted rather than shader sorted, OpaqueWall renderers have been reorganized to minimize state checks, which offers a minor speedup
r_vertexsurfacesthreshold is gone, no longer supported...

------------------------------------------------------------------------
r2347 | havoc | 2002-09-10 09:54:12 -0700 (Tue, 10 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

fixed combine overbright behavior

------------------------------------------------------------------------
r2346 | havoc | 2002-09-09 08:58:36 -0700 (Mon, 09 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/keys.c

expanded console buffer from 16k to 128k, and changed scroll amount to be dependent on visible console height (scrolls half the visible area instead of just 2 lines)

------------------------------------------------------------------------
r2345 | havoc | 2002-09-09 08:31:26 -0700 (Mon, 09 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/net_main.c

fixed typo

------------------------------------------------------------------------
r2344 | havoc | 2002-09-09 08:30:16 -0700 (Mon, 09 Sep 2002) | 3 lines
Changed paths:
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/net_main.c
   M /trunk/darkplaces/server.h

svs.clients is now allocated dynamically according to svs.maxclients, and there is now a function for updating svs.maxclients called SV_SetMaxClients
this cuts the memory usage in singleplayer by 17mb

------------------------------------------------------------------------
r2343 | havoc | 2002-09-09 07:30:09 -0700 (Mon, 09 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h

removed modelsortedsurfaces

------------------------------------------------------------------------
r2342 | havoc | 2002-09-06 09:51:51 -0700 (Fri, 06 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/zone.c
   M /trunk/darkplaces/zone.h

mempools now have sentinel checks, for completeness

------------------------------------------------------------------------
r2341 | havoc | 2002-09-06 05:05:29 -0700 (Fri, 06 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.h

whitespace cleanup

------------------------------------------------------------------------
r2340 | havoc | 2002-09-06 04:48:47 -0700 (Fri, 06 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/r_crosshairs.c
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/r_sprites.c
   M /trunk/darkplaces/render.h

transform matrix is now separate from R_Mesh_State, a new function called R_Mesh_Matrix takes up the task of changing transforms, and is used a lot less frequently in the engine than R_Mesh_State, this gets a nice speed gain in cavetest2

------------------------------------------------------------------------
r2339 | havoc | 2002-09-06 02:45:51 -0700 (Fri, 06 Sep 2002) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/matrixlib.c
   M /trunk/darkplaces/matrixlib.h
   M /trunk/darkplaces/vid_shared.c

now uses hardware transforms
fixed a bunch of bugs in matrixlib
view matrix is now calculated using Matrix4x4 functions instead of GL calls

------------------------------------------------------------------------
r2338 | havoc | 2002-09-06 00:14:15 -0700 (Fri, 06 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

corrected function names reported in various backend not active errors (by using a #define that uses __func__ to get the function name as a string)

------------------------------------------------------------------------
r2337 | havoc | 2002-09-05 23:51:18 -0700 (Thu, 05 Sep 2002) | 7 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_crosshairs.c
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/r_sprites.c

vertex arrays renamed to varray_ and exposed to rest of engine
mesh_maxtris and mesh_maxverts exposed (really only intended for R_Mesh_ResizeCheck #define)
R_Mesh_GetBuffer is gone, R_Mesh_State takes it's place for most of it's functionality
R_Mesh_ResizeCheck (a #define) will expand arrays on the fly if a mesh is too big (note: be sure to use this if you have a mesh that may be more than 1024 triangles, 3072 verts)
R_Mesh_Draw takes the place of R_Mesh_Render and takes two parameters (number of verts and number of triangles)
fixed bug that caused sky to appear through models when sky was onscreen (R_DrawWorld must be called at a specific point in rendering, had forgotten that)

------------------------------------------------------------------------
r2334 | havoc | 2002-09-05 07:38:39 -0700 (Thu, 05 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

currenttriangle and currentvertex no longer exist, also firstvert and firsttriangle no longer exist in the internal mesh structure

------------------------------------------------------------------------
r2333 | havoc | 2002-09-05 07:24:16 -0700 (Thu, 05 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h

surfvertex_t is gone, in it's place are non-interleaved arrays, which keeps things simpler...

------------------------------------------------------------------------
r2332 | havoc | 2002-09-05 07:22:28 -0700 (Thu, 05 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

moved state update from R_Mesh_Render to R_Mesh_Draw_GetBuffer

------------------------------------------------------------------------
r2331 | havoc | 2002-09-05 06:05:23 -0700 (Thu, 05 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

buf_mesh is no longer a pointer, since there is only one of it

------------------------------------------------------------------------
r2330 | havoc | 2002-09-05 05:07:55 -0700 (Thu, 05 Sep 2002) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/render.h

added r_surfaceworldnode and r_cullsurface cvars (it is recommended that these both be on, or both be off)
shuffled around WorldNode, DrawSurfaces, PrepareSurfaces, SurfMarkLights, and other related code a great deal, it is now somewhat cleaner

------------------------------------------------------------------------
r2329 | havoc | 2002-09-05 03:24:32 -0700 (Thu, 05 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c

added getsurfaceclippedpoint builtin

------------------------------------------------------------------------
r2328 | havoc | 2002-09-05 03:10:47 -0700 (Thu, 05 Sep 2002) | 28 lines
Changed paths:
   M /trunk/darkplaces/cl_demo.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/collision.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/keys.h
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/portals.c
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/pr_exec.c
   M /trunk/darkplaces/pr_execprogram.h
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/r_lerpanim.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/sv_move.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/view.c
   M /trunk/darkplaces/world.c

you can now (try to) play in maps you don't have, and models you don't have are shown as little multicolored things
added CL_BoundingBoxForEntity to clean up the various mins/maxs calculations in the engine
no longer spews clc_nops to server past the first signon stage
the clc_nops sent to the server are now sent using unreliable packets (because queuing them up as reliable made no sense and spewed warnings when developer was on)
failed client to server reliable messages now print a hexdump of the message contents when developer is on
there is now Mod_PointContents (this is different than Mod_PointInLeaf because a lot of calls to Mod_PointInLeaf were just wanting the contents, and it's not convenient to check for NULL (no world model) in the caller
r_speeds no longer reports a "walls" count, as it was often nearly identical to faces and simplified the code to remove it
r_speeds faces count may count bmodels twice if some contain sky polygons (this is less technically correct, but more performance correct - it is processing the faces twice)
DrawQ_Pic won't crash if given a NULL picname now (won't draw it either)
r_cullsurfaces cvar added
r_surfacesworldnode cvar added
surface backface culling moved to PrepareSurfaces
simplified a lot of worldnode related stuff
surf->pvsframe and node->pvsframe and leaf->pvsframe simplified worldnode code, and only needs updating when leaf changes (this is partly how quake did things)
leaf->visframe no longer exists, this meant changing/cleaning a lot of code
leaf->dlightbits and leaf->dlightframe no longer exist, this meant doing TraceLine's to see if dlights should shine on models and such (but only if within radius of them)
console is forced if there's nothing else to look at, this is tracked separately from whether the user wants a console (key_consoleactive is now bits, but most code should just check if it is non-zero)
RecursiveHullCheckPoint has been enabled again, only invoked if trace length is exactly 0
SZ_GetSpace overflow warnings/errors have newlines at the end now
R_VisibleCullBox is gone (it relied on leaf->visframe), uses R_CullBox instead
move around some R_NewMap code into more suitable modules
rearranged R_RenderView code a lot, to group things more appropriately
dlights work correctly on bmodels now
PR_Crash function added, to properly shutdown progs interpreter (reset it's stack) and print out a crash report
PR_RunError went away, it has been replaced by Host_Error (which now calls PR_Crash incase it happend during progs execution)
R_ResetQuakeSky and R_ResetSkyBox added, to clean up some sky related hacks in model loading
various QC builtins added for getting info on surfaces from the engine

------------------------------------------------------------------------
r2327 | havoc | 2002-09-02 03:44:25 -0700 (Mon, 02 Sep 2002) | 9 lines
Changed paths:
   M /trunk/darkplaces/cl_demo.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/console.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/keys.h
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/sbar.c
   M /trunk/darkplaces/sv_user.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_wgl.c

you can now open/close the console independently of menu and messagemode
console catchs input before anything else
console appears ontop of anything else
console is no longer forced fullscreen when there is nothing else to show
shuffled around the 2D drawing calls in CL_UpdateScreen
now only console pauses singleplayer, instead of console/menu/messagemode
simplified console singleplayer pausing code a bit
mouse grabbing is now only forced off when console is down, not when menu or messagemode is shown

------------------------------------------------------------------------
r2326 | havoc | 2002-09-01 23:46:43 -0700 (Sun, 01 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

make sure zFar is at least 64 units to avoid feeding a bogus value to glFrustum

------------------------------------------------------------------------
r2325 | molivier | 2002-09-01 23:20:07 -0700 (Sun, 01 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

Updated Transfusion map list

------------------------------------------------------------------------
r2324 | havoc | 2002-09-01 05:24:44 -0700 (Sun, 01 Sep 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

don't allocate resizebuffer for an R_Upload that doesn't need it (native RGB or RGBA fragment texture)

------------------------------------------------------------------------
r2323 | havoc | 2002-08-31 18:06:02 -0700 (Sat, 31 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/r_textures.h

free texture processing buffers each frame so they don't hang around wasting memory

------------------------------------------------------------------------
r2322 | havoc | 2002-08-31 18:05:02 -0700 (Sat, 31 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

reduced default max particles from 16384 to 8192

------------------------------------------------------------------------
r2321 | havoc | 2002-08-31 02:17:29 -0700 (Sat, 31 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_edict.c

improved pr_fields command to list how many entities are using each entity field and give more information on how many fields are needed and how much memory they need

------------------------------------------------------------------------
r2320 | havoc | 2002-08-31 02:15:24 -0700 (Sat, 31 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c

removed console text left/right edge margins (giving an extra 2 chars per line)

------------------------------------------------------------------------
r2319 | havoc | 2002-08-30 06:18:11 -0700 (Fri, 30 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

weapon models were not being lit in maps using .lights

------------------------------------------------------------------------
r2318 | havoc | 2002-08-30 06:17:32 -0700 (Fri, 30 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_light.c

commented out bit-hacking 1/sqrt code

------------------------------------------------------------------------
r2317 | havoc | 2002-08-30 06:16:43 -0700 (Fri, 30 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/matrixlib.c

consistency cleanup of a (disabled) part of Invert_Simple

------------------------------------------------------------------------
r2316 | havoc | 2002-08-30 06:13:56 -0700 (Fri, 30 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.dsp

MSVC updated the project file, why I'm not sure, oh well...

------------------------------------------------------------------------
r2315 | havoc | 2002-08-30 06:09:25 -0700 (Fri, 30 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.dsp

changed to use C runtime library DLL instead of static linking it

------------------------------------------------------------------------
r2314 | havoc | 2002-08-30 02:33:04 -0700 (Fri, 30 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_models.c

fixed models getting dark in the distance when fogged bug (thanks to Elric for reporting this, trivial fix, was a silly mistake on my part)

------------------------------------------------------------------------
r2313 | havoc | 2002-08-29 19:20:42 -0700 (Thu, 29 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

fixed bug which caused all models to be untextured if they used internal skins

------------------------------------------------------------------------
r2312 | havoc | 2002-08-29 19:06:14 -0700 (Thu, 29 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_models.c

draw models which have no textures using the notexture checkerboard

------------------------------------------------------------------------
r2311 | havoc | 2002-08-29 18:27:17 -0700 (Thu, 29 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

support for loading external skins that don't exist inside the model

------------------------------------------------------------------------
r2310 | havoc | 2002-08-29 07:14:34 -0700 (Thu, 29 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/matrixlib.c

fixed viewmodel (it wasn't drawing because it's matrix was empty), fixed a bug with scaling in Matrix4x4_CreateFromQuakeEntity (and Matrix3x4 to match), added some extra code to Matrix4x4_Invert_Simple (and Matrix3x4) to further clarify the scaling inversion

------------------------------------------------------------------------
r2309 | havoc | 2002-08-29 05:45:24 -0700 (Thu, 29 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_models.c

fixed crash when ent->skinnum >= model->numskins

------------------------------------------------------------------------
r2308 | havoc | 2002-08-29 05:44:34 -0700 (Thu, 29 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

speed gain in lightmap updates

------------------------------------------------------------------------
r2299 | havoc | 2002-08-28 07:33:20 -0700 (Wed, 28 Aug 2002) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/render.h

optimizations to rendering
particle lighting is no longer supported, sorry
particle visibility is no longer checked, it was wasting too much time

------------------------------------------------------------------------
r2298 | havoc | 2002-08-28 06:35:31 -0700 (Wed, 28 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rsurf.c

fix various fog bugs, and also fix missing colormap layer bugs (specifically if the base/merged texture is missing, as it is on a lava ball for instance)

------------------------------------------------------------------------
r2297 | havoc | 2002-08-28 05:56:12 -0700 (Wed, 28 Aug 2002) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_rsurf.c

no more m.transparent, transparent surfaces are sorted using MeshQueue now
glow textures were being rendered using detail texture coordinates, fixed

------------------------------------------------------------------------
r2296 | havoc | 2002-08-28 05:14:11 -0700 (Wed, 28 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

added lighting options (and explosion clipping) to effects options menu

------------------------------------------------------------------------
r2295 | havoc | 2002-08-28 04:56:00 -0700 (Wed, 28 Aug 2002) | 10 lines
Changed paths:
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/cl_collision.h
   M /trunk/darkplaces/cl_light.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/matrixlib.c
   M /trunk/darkplaces/matrixlib.h
   M /trunk/darkplaces/meshqueue.c
   M /trunk/darkplaces/meshqueue.h
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_crosshairs.c
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_light.h
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/r_sprites.c

most of the framework for hardware accelerated transforms is back, just the actual gl calls need to be put in, but that will be a later commit
gl_backend internal mesh structure now has a matrix stored in it
entity_render_t now has a matrix and a inverse matrix
many additions of const to various functions, this required restructuring some code
transparent mesh sorting is gone, this also means subsorting of triangles by depth is gone (meshqueue should be used for transparent mesh sorting, I have not yet written a new triangle sorter)
rewrote RSurf_ shader functions *yet again*, they are now more compact and share code (by way of using lots of function calls)
lots of changes/bugfixes/additions to matrixlib.c and .h, including an actual working Matrix4x4_Invert_Simple function
added gl_flashblend (brightens and enlarges coronas, turns off all actual lighting)
added r_coronas (can turn off coronas)

------------------------------------------------------------------------
r2294 | havoc | 2002-08-27 23:46:21 -0700 (Tue, 27 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

got rid of dlightradius variable which was never actually used

------------------------------------------------------------------------
r2293 | havoc | 2002-08-27 04:59:28 -0700 (Tue, 27 Aug 2002) | 5 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/meshqueue.c
   M /trunk/darkplaces/meshqueue.h
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h

liquid now goes through meshqueue sorting
fixed a bunch of minor sorting consistency bugs in the meshqueue code
changed behavior of R_MeshQueue_EndScene and exposed R_MeshQueue_Render and R_MeshQueue_RenderTransparent
cleaned up liquid rendering code a bit

------------------------------------------------------------------------
r2292 | havoc | 2002-08-27 03:04:57 -0700 (Tue, 27 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

forgot a m.transparent = in the last commit, and removed a comment

------------------------------------------------------------------------
r2291 | havoc | 2002-08-27 02:49:54 -0700 (Tue, 27 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_crosshairs.c
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/r_sprites.c

got rid of lots of unnecessary m.transparent = lines, as well as some depthdisable =, and depthwrite =

------------------------------------------------------------------------
r2290 | havoc | 2002-08-27 02:42:59 -0700 (Tue, 27 Aug 2002) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_light.h
   M /trunk/darkplaces/r_sprites.c
   M /trunk/darkplaces/render.h

engine mostly converted to use R_MeshQueue functions instead of true transparent meshs, this meant getting rid of currentrenderentity
the rest of the conversion to R_MeshQueue will be in a future commit, just wanted to get this in now

------------------------------------------------------------------------
r2289 | molivier | 2002-08-26 07:00:56 -0700 (Mon, 26 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

Added a new cvar sv_echobprint which controls the printing of broadcast messages in dedicated server mode. It's on by default.

------------------------------------------------------------------------
r2288 | molivier | 2002-08-25 23:24:30 -0700 (Sun, 25 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c

Fixed a potential buffer overflow in Con_DebugLog

------------------------------------------------------------------------
r2287 | havoc | 2002-08-25 22:40:47 -0700 (Sun, 25 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

renamed mesh_ variables to gl_state. (created a struct for this purpose)

------------------------------------------------------------------------
r2285 | havoc | 2002-08-25 08:45:41 -0700 (Sun, 25 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/render.h

got rid of R_Mesh_Draw and R_Mesh_DrawPolygon, now all 3D geometry is drawn using R_Mesh_Draw_GetBuffer and R_Mesh_Render

------------------------------------------------------------------------
r2284 | havoc | 2002-08-25 05:26:23 -0700 (Sun, 25 Aug 2002) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_crosshairs.c
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_sky.c

batching is gone.
if you forget to call R_Mesh_Render after each mesh the backend system will yell at you.

------------------------------------------------------------------------
r2283 | havoc | 2002-08-25 04:12:01 -0700 (Sun, 25 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h

monster movement interpolation now works in both protocols (shared code), this bloated the entity persistent struct a bit more unfortunately

------------------------------------------------------------------------
r2282 | havoc | 2002-08-24 00:14:15 -0700 (Sat, 24 Aug 2002) | 12 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/r_crosshairs.c
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/r_sprites.c
   M /trunk/darkplaces/render.h

detail texturing added (although with just one generated texture applied to everything)
detail texturing makes use of up to 3 texture units if you have combine
detail texturing added to effects options menu (r_detailtextures cvar)
surfvertex_t now has another set of texcoords, for detail texturing
Mod_BrushStartup and Mod_BrushShutdown functions added to alloc/free the detail texture
r_multitexture cvar renamed to r_textureunits, so you can limit number of texture units enabled for testing, rather than just as a yes/no kind of option
gl_combine is forced to 0 if r_textureunits is less than 2 (this is purely for consistency, not of any importance)
split up the wall rendering into two kinds - vertex lit with optional transparency, and opaque lightmapped with no support for transparency
R_Mesh_Draw_GetBuffer now takes a wantoverbrights parameter, if false it will not use the 4x overbright (even if combine is enabled), this is useful to improve the color precision of anything which does not need overbright
fixed crosshair brightness (it was unintentionally adjusting the alpha using m.colorscale just like the RGB portion of the color)
sprites only use overbright if they are lit (normal unlit sprites are rendered without overbright)

------------------------------------------------------------------------
r2281 | havoc | 2002-08-22 23:12:01 -0700 (Thu, 22 Aug 2002) | 3 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/menu.c

removed check for registered.integer in GAME_NORMAL naming (this means it just says DarkPlaces-Quake whether the game is registered or not)
removed support for games FiendArena (because I have not heard from the author in a long time) and Zymotic (because the game was canceled long ago)

------------------------------------------------------------------------
r2280 | molivier | 2002-08-22 23:04:40 -0700 (Thu, 22 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

Finally got rid of the last TRANSFUSION define (the key binding menu is determined at runtime now). Also a few maps won't make it for the 1.0 release, so they've been removed from the map list.

------------------------------------------------------------------------
r2279 | havoc | 2002-08-22 15:24:17 -0700 (Thu, 22 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c

added DP_SV_SLOWMO to extensions list

------------------------------------------------------------------------
r2277 | havoc | 2002-08-22 14:58:33 -0700 (Thu, 22 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/gl_rsurf.c

made stains more small and focused

------------------------------------------------------------------------
r2276 | havoc | 2002-08-22 00:30:58 -0700 (Thu, 22 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/image.c

workaround for gcc -funroll-loops bug with RLE compressed TGA, fixed LoadTGA (by rewriting it), probably faster now too

------------------------------------------------------------------------
r2275 | molivier | 2002-08-21 23:13:21 -0700 (Wed, 21 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_crosshairs.c

Disabled crosshair during intermission

------------------------------------------------------------------------
r2274 | molivier | 2002-08-21 04:26:14 -0700 (Wed, 21 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/sys_win.c

Fixed GetModuleFileName call

------------------------------------------------------------------------
r2273 | molivier | 2002-08-21 04:24:46 -0700 (Wed, 21 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c

Refixed COM_StripExtension  :oP

------------------------------------------------------------------------
r2272 | havoc | 2002-08-21 02:43:39 -0700 (Wed, 21 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/sys_win.c

this should fix the program name in com_argv[0], so detection of which game to run based on executable name should work now, thanks to Elric for reporting the bug

------------------------------------------------------------------------
r2271 | havoc | 2002-08-21 02:23:43 -0700 (Wed, 21 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c

change default com_basedir to "." to fix the game when not using -basedir, oops.  thanks to Elric for the bug report.

------------------------------------------------------------------------
r2270 | molivier | 2002-08-21 00:49:50 -0700 (Wed, 21 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c

Fixed COM_StripExtension for strings without a single dot

------------------------------------------------------------------------
r2269 | molivier | 2002-08-21 00:47:52 -0700 (Wed, 21 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/r_crosshairs.c
   M /trunk/darkplaces/screen.h

Static/floating crosshair is now an option controled by the cvar "crosshair_static"

------------------------------------------------------------------------
r2268 | havoc | 2002-08-20 17:10:30 -0700 (Tue, 20 Aug 2002) | 5 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/render.h

no more warping meshs of any kind
sky is always of the masked variety if enabled at all
water does not move
R_Mesh_Draw is no longer used by gl_rsurf at all

------------------------------------------------------------------------
r2266 | havoc | 2002-08-20 15:47:31 -0700 (Tue, 20 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/fractalnoise.c

corrected spelling of alorgithm

------------------------------------------------------------------------
r2265 | havoc | 2002-08-20 13:24:31 -0700 (Tue, 20 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/image.h
   M /trunk/darkplaces/menu.c

fixed menu player colormapping

------------------------------------------------------------------------
r2264 | havoc | 2002-08-20 12:54:39 -0700 (Tue, 20 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

changed color command description to mention it is 0-15 range, not 0-13

------------------------------------------------------------------------
r2263 | havoc | 2002-08-20 01:28:01 -0700 (Tue, 20 Aug 2002) | 4 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/sys_linux.c
   M /trunk/darkplaces/sys_win.c

got rid of host_parms
added com_basedir
cleaned up gamedir related code

------------------------------------------------------------------------
r2262 | havoc | 2002-08-20 00:08:40 -0700 (Tue, 20 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/sys_linux.c
   M /trunk/darkplaces/sys_shared.c
   M /trunk/darkplaces/sys_win.c

got rid of host_parms.argc and argv, now uses com_argc and com_argv directly

------------------------------------------------------------------------
r2261 | havoc | 2002-08-19 20:13:02 -0700 (Mon, 19 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/sys.h
   M /trunk/darkplaces/sys_linux.c
   M /trunk/darkplaces/sys_shared.c
   M /trunk/darkplaces/sys_win.c

cleaned up and merged a lot of sys_*.c code into sys_shared.c

------------------------------------------------------------------------
r2260 | havoc | 2002-08-19 19:57:12 -0700 (Mon, 19 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

centered Sbar_IntermissionOverlay

------------------------------------------------------------------------
r2259 | havoc | 2002-08-19 19:50:38 -0700 (Mon, 19 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/sys_shared.c
   M /trunk/darkplaces/sys_win.c

sys_usetimegettime is now initialized at a place where it shouldn't crash anymore (this should make win32 run again)

------------------------------------------------------------------------
r2256 | havoc | 2002-08-17 16:19:47 -0700 (Sat, 17 Aug 2002) | 3 lines
Changed paths:
   D /trunk/darkplaces/in_svgalib.c
   M /trunk/darkplaces/makefile
   D /trunk/darkplaces/vid_3dfxsvga.c

removed fxmesa support (3dfx svgalib) because no one used it to my knowledge, and it probably did not even work due to poor maintenance
and cleaned up makefile a bit

------------------------------------------------------------------------
r2252 | havoc | 2002-08-15 22:59:27 -0700 (Thu, 15 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

update client color values when new values are recieved from server

------------------------------------------------------------------------
r2251 | havoc | 2002-08-15 22:57:27 -0700 (Thu, 15 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

SV_ChangeTeam now actually gets called with the right value

------------------------------------------------------------------------
r2250 | havoc | 2002-08-15 22:56:27 -0700 (Thu, 15 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c

reformatted and updated extensions list

------------------------------------------------------------------------
r2249 | havoc | 2002-08-15 22:55:25 -0700 (Thu, 15 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

fix alignment of frag list, it is now centered

------------------------------------------------------------------------
r2248 | havoc | 2002-08-15 22:53:28 -0700 (Thu, 15 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/glquake.h

changed GL_MATRIX_MODE check to GL_PROJECTION, and removed GL_MATRIX_MODE define, this should be more compatible in identifying odd gl.h's

------------------------------------------------------------------------
r2247 | havoc | 2002-08-15 12:00:31 -0700 (Thu, 15 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/sys_linux.c
   M /trunk/darkplaces/sys_win.c

only warn about time stepping backwards if it's more than 10ms

------------------------------------------------------------------------
r2246 | havoc | 2002-08-15 11:53:25 -0700 (Thu, 15 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/sv_main.c

added support for .colormap values >= 1024 in QC to mean direct color specification (two 0-15 values, just like SV_ChangeTeam and setcolor use)

------------------------------------------------------------------------
r2245 | havoc | 2002-08-15 11:51:33 -0700 (Thu, 15 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cvar.c
   M /trunk/darkplaces/cvar.h
   M /trunk/darkplaces/net_dgrm.c
   M /trunk/darkplaces/pr_cmds.c

cvar_vars is no longer known by files other than cvar.c, this meant adding a Cvar_FindVarAfter function to keep the server queries working correctly

------------------------------------------------------------------------
r2244 | havoc | 2002-08-15 11:49:43 -0700 (Thu, 15 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/sys_win.c

turned #define WIN32_USETIMEGETTIME into a cvar named sys_usetimegettime, default on (used to be off by default), can be changed at any time

------------------------------------------------------------------------
r2243 | havoc | 2002-08-14 16:48:14 -0700 (Wed, 14 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/pr_exec.c
   M /trunk/darkplaces/progs.h

reset stack position when new progs loaded, or error occurs

------------------------------------------------------------------------
r2242 | havoc | 2002-08-14 16:29:34 -0700 (Wed, 14 Aug 2002) | 5 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

changed fps counter behavior to be more 'traditional' (count how many frames go by in a given amount of time), this means 3 modes are now available for showfps...
showfps 1 - count frames
showfps 2 - average of recent frame times
showfps 3 - most recent frame time only

------------------------------------------------------------------------
r2234 | havoc | 2002-08-10 09:51:30 -0700 (Sat, 10 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/net_main.c

(patch from Elric) BloodBath renamed to Transfusion

------------------------------------------------------------------------
r2233 | havoc | 2002-08-10 09:29:27 -0700 (Sat, 10 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/render.h

converted particle rendering to use R_Mesh_Draw_GetBuffer

------------------------------------------------------------------------
r2232 | havoc | 2002-08-09 16:20:25 -0700 (Fri, 09 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_sprites.c

now uses R_Mesh_Draw_GetBuffer

------------------------------------------------------------------------
r2231 | havoc | 2002-08-09 16:13:48 -0700 (Fri, 09 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

changed viewblend to use R_Mesh_Draw_GetBuffer

------------------------------------------------------------------------
r2230 | havoc | 2002-08-09 15:45:03 -0700 (Fri, 09 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_light.c

converted coronas to R_Mesh_Draw_GetBuffer

------------------------------------------------------------------------
r2229 | havoc | 2002-08-09 15:19:54 -0700 (Fri, 09 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_sky.c

converted skysphere to R_Mesh_Draw_GetBuffer

------------------------------------------------------------------------
r2228 | havoc | 2002-08-09 15:03:28 -0700 (Fri, 09 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

changed a bunch of #if 1's to #if USEMESHBUFFER (which is 1)

------------------------------------------------------------------------
r2227 | havoc | 2002-08-09 15:02:06 -0700 (Fri, 09 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_sky.c

skybox now uses R_Mesh_Draw_GetBuffer

------------------------------------------------------------------------
r2226 | havoc | 2002-08-09 15:01:25 -0700 (Fri, 09 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile

re-enable optimizations by default

------------------------------------------------------------------------
r2225 | havoc | 2002-08-09 14:48:19 -0700 (Fri, 09 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_explosion.c

converted code to use R_Mesh_Draw_GetBuffer

------------------------------------------------------------------------
r2224 | havoc | 2002-08-09 14:47:11 -0700 (Fri, 09 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_crosshairs.c

converted drawing code from R_Mesh_Draw to R_Mesh_Draw_GetBuffer

------------------------------------------------------------------------
r2223 | havoc | 2002-08-09 14:14:12 -0700 (Fri, 09 Aug 2002) | 8 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_light.h

rewrote most of the RSurfShader_ functions to use R_Mesh_Draw_GetBuffer instead of R_Mesh_Draw

r_modellights replaced r_lightmodels, r_modellights sets limit on how many directional lights will be shaded onto the model (only the brightest are chosen)

cleaned up lighting code a lot, it is now consistent between static and dynamic light sources, and the light radius has been reduced

unfortunately this commit seems to have slowed down the engine a bit, and I don't know why, it should be a speed gain

------------------------------------------------------------------------
r2217 | havoc | 2002-08-07 13:31:56 -0700 (Wed, 07 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fixed r_drawentities 0 which was forgetting to enlarge the farclip based on the world bounding box

------------------------------------------------------------------------
r2216 | havoc | 2002-08-07 13:09:46 -0700 (Wed, 07 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/image.c

support for top to bottom TGA, thanks Elric.

------------------------------------------------------------------------
r2213 | havoc | 2002-08-06 09:35:51 -0700 (Tue, 06 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

added r_sortsurfaces cvar, default off, sorting them seems to be a very minor slowdown ingame for me

------------------------------------------------------------------------
r2212 | havoc | 2002-08-06 09:04:57 -0700 (Tue, 06 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

fix for the effects menu input code, thanks Elric

------------------------------------------------------------------------
r2211 | havoc | 2002-08-06 09:01:46 -0700 (Tue, 06 Aug 2002) | 3 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

fix for 'falling' in a corner bug, thanks to Elric for finding the fix for this.
also removed a SOLID_BSP check that shouldn't be there anymore.

------------------------------------------------------------------------
r2208 | havoc | 2002-08-05 16:23:53 -0700 (Mon, 05 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

spawned entities were often not appearing in quake protocol (demos), oops

------------------------------------------------------------------------
r2207 | havoc | 2002-08-05 12:57:04 -0700 (Mon, 05 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.mingw

the -I and -L  weren't necessary (and didn't work anyway)

------------------------------------------------------------------------
r2205 | havoc | 2002-08-05 12:18:15 -0700 (Mon, 05 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cgame.c

fix for double to float warning in MSVC

------------------------------------------------------------------------
r2204 | havoc | 2002-08-05 12:17:28 -0700 (Mon, 05 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_shared.c

consistency fix for GL_EXT_draw_range_elements - don't be silent about missing functions if the extension is reported

------------------------------------------------------------------------
r2203 | havoc | 2002-08-05 06:28:26 -0700 (Mon, 05 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/render.h

a rather hefty 6% speed gain by getting rid of the R_Mesh_UpdateFarClip function, and reorganizing it to use bounding boxes instead (outside of gl_backend even)

------------------------------------------------------------------------
r2202 | havoc | 2002-08-05 05:16:44 -0700 (Mon, 05 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/r_textures.h

R_GetTexture is now named R_RealGetTexture, R_GetTexture is a macro which hardly ever calls R_RealGetTexture - this is a nice speed gain, cutting out about 2.3 million calls during timedemo bigass1

------------------------------------------------------------------------
r2201 | havoc | 2002-08-05 04:54:28 -0700 (Mon, 05 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/r_textures.h

removed procedural texture support because it was inefficient where it was implemented - it can be implemented more efficiently in renderer code than in R_GetTexture

------------------------------------------------------------------------
r2200 | havoc | 2002-08-05 04:40:14 -0700 (Mon, 05 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

lightmaps shouldn't be procedural, because they have no generate function anyway (and are therefore not self-animating)

------------------------------------------------------------------------
r2199 | havoc | 2002-08-05 04:39:08 -0700 (Mon, 05 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_mix.c

attempt to optimize SND_PaintChannelFrom8 a little bit

------------------------------------------------------------------------
r2198 | havoc | 2002-08-05 04:11:52 -0700 (Mon, 05 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

fix view_ofs when dead (negative viewheight)

------------------------------------------------------------------------
r2197 | havoc | 2002-08-05 03:58:27 -0700 (Mon, 05 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.dsp
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/makefile.mingw
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/model_sprite.c
   D /trunk/darkplaces/r_clip.c
   D /trunk/darkplaces/r_clip.h
   M /trunk/darkplaces/r_sprites.c
   M /trunk/darkplaces/render.h

removed support for r_ser (also known as R_Clip or "Hidden Surface Removal") as it was a slowdown for everyone I know of

------------------------------------------------------------------------
r2196 | havoc | 2002-08-05 03:20:25 -0700 (Mon, 05 Aug 2002) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h

an optimization to CL_RelinkNetworkEntities (and related code) which increases performance by 5%
(store the ent->state_current.active flags in a separate array to use less memory bandwidth)

------------------------------------------------------------------------
r2195 | havoc | 2002-08-05 02:47:21 -0700 (Mon, 05 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cg_math.h
   M /trunk/darkplaces/cgame.c

optimized phys_moveentities (in cgame.c) so it doesn't waste so much time

------------------------------------------------------------------------
r2194 | havoc | 2002-08-04 13:07:11 -0700 (Sun, 04 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/sv_main.c

fix svc_setview

------------------------------------------------------------------------
r2193 | havoc | 2002-08-04 13:04:22 -0700 (Sun, 04 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_wgl.c

moved the GL_CloseLibrary call a bit

------------------------------------------------------------------------
r2192 | havoc | 2002-08-04 12:37:09 -0700 (Sun, 04 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/in_win.c
   M /trunk/darkplaces/sys_win.c
   M /trunk/darkplaces/vid_wgl.c
   M /trunk/darkplaces/winquake.h

fix mouse in win32, I had forgotten to update a lot of code

------------------------------------------------------------------------
r2191 | havoc | 2002-08-04 08:06:53 -0700 (Sun, 04 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

limit gl_mesh_batchtriangles to never go below 1, because although < 1 works it calls R_Mesh_Render twice per mesh rather than once

------------------------------------------------------------------------
r2182 | havoc | 2002-08-03 14:02:02 -0700 (Sat, 03 Aug 2002) | 2 lines
Changed paths:
   D /trunk/darkplaces/cl_light.h
   M /trunk/darkplaces/darkplaces.dsp

removed cl_light.h (which has already been merged into client.h)

------------------------------------------------------------------------
r2181 | havoc | 2002-08-03 13:59:29 -0700 (Sat, 03 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/vid_3dfxsvga.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c

now entirely dynamic OpenGL binding

------------------------------------------------------------------------
r2180 | havoc | 2002-08-03 13:51:07 -0700 (Sat, 03 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/makefile

added r_floatbuildlightmap, unfortunately using floats for the calculations is still ever so slightly slower than integer

------------------------------------------------------------------------
r2179 | havoc | 2002-08-03 13:46:17 -0700 (Sat, 03 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

optimized entity updates substantially (or rather, UpdateEnd), nice speedup

------------------------------------------------------------------------
r2178 | havoc | 2002-08-03 13:44:31 -0700 (Sat, 03 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

some optimizations (notably sparks don't have air friction anymore, which is a significant speedup to demos), a bit of reorganization

------------------------------------------------------------------------
r2177 | havoc | 2002-08-03 13:41:12 -0700 (Sat, 03 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

rearranged things a little, mostly related to particles created by EntityParticles, which should only live one frame

------------------------------------------------------------------------
r2176 | havoc | 2002-08-03 13:39:43 -0700 (Sat, 03 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

default gl_mesh_floatcolors on, and force it off on 3Dfx drivers (sure this is unnecessary unless it is specifically the windows 3Dfx drivers, as surely WickedGL and others work fine, but oh well, 3Dfx cards want byte colors anyway)

------------------------------------------------------------------------
r2175 | havoc | 2002-08-03 13:34:59 -0700 (Sat, 03 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cgamevm.c
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/cl_collision.h
   M /trunk/darkplaces/cl_light.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/cl_screen.h
   M /trunk/darkplaces/cl_tent.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_light.h

Lots of speedups and cleanups in client code, dynamically allocated cl_entities (and friends), rearranged some things  - sorry this commit is vague, but it's mostly just a lot of rearrangement, cleanup, etc...

------------------------------------------------------------------------
r2174 | havoc | 2002-08-03 13:27:54 -0700 (Sat, 03 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

cls.spawnparms isn't needed

------------------------------------------------------------------------
r2173 | havoc | 2002-08-03 13:26:09 -0700 (Sat, 03 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_oss.c

changed linux/soundcard.h to sys/soundcard.h for more portability - doesn't work properly on FreeBSD yet, though

------------------------------------------------------------------------
r2172 | havoc | 2002-08-03 13:23:25 -0700 (Sat, 03 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/world.c

print edict responsible for "Trigger in clipping list" error

------------------------------------------------------------------------
r2170 | havoc | 2002-08-02 11:11:23 -0700 (Fri, 02 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.dsp
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/makefile.mingw
   A /trunk/darkplaces/meshqueue.c
   A /trunk/darkplaces/meshqueue.h

added a mesh queue callback system (to allow mesh rendering things in different orders, etc)

------------------------------------------------------------------------
r2167 | havoc | 2002-08-02 08:12:19 -0700 (Fri, 02 Aug 2002) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_3dfxsvga.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c

cleaned up vid_glx.c somewhat, it can now quit properly when the close button is pressed (what a mess talking to a window manager, sigh...)

added vid_hidden (iconified or otherwise disabled window - don't render anything) and vid_activewindow (not the active window, don't hog CPU power) to vid_* files

------------------------------------------------------------------------
r2166 | havoc | 2002-08-02 08:08:44 -0700 (Fri, 02 Aug 2002) | 6 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/menu.h

added alphafade and gravity fields to particle struct, which made most particle types redundent, now only a few remain

tweaked various effects (particularly underwater blood, bubbles, smoke effects, etc)

added effects options menu to control the many possible options

------------------------------------------------------------------------
r2165 | havoc | 2002-08-02 08:07:43 -0700 (Fri, 02 Aug 2002) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/client.h

added cl_explosions and cl_stainmaps cvars, which will be used soon...

renamed cl_draweffects to r_draweffects and made it actually work

------------------------------------------------------------------------
r2164 | havoc | 2002-08-02 08:01:21 -0700 (Fri, 02 Aug 2002) | 6 lines
Changed paths:
   M /trunk/darkplaces/r_light.c

fixed a lighting bug with overbright modes when using r_quickmodels which made most models far too bright

changed directional lighting to only light vertices facing the light source (this makes for a very dramatic look)

CompleteLightPoint is now twice as bright as it used to be when running a map that uses a .lights file - more closely matchs the lightmaps

------------------------------------------------------------------------
r2163 | havoc | 2002-08-02 07:57:39 -0700 (Fri, 02 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/view.c

made liquid colors 50% thinner (it's still apparent you're in a liquid, but you can see clearly now)

------------------------------------------------------------------------
r2162 | havoc | 2002-08-02 07:55:27 -0700 (Fri, 02 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/net_main.c

'sock' local variable isn't needed anymore, cleaned up NET_Shutdown socket closing loop

------------------------------------------------------------------------
r2161 | havoc | 2002-08-02 07:53:33 -0700 (Fri, 02 Aug 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/net_main.c

fixed bug in NET_Shutdown related to freeing sockets

------------------------------------------------------------------------
r2160 | havoc | 2002-08-02 05:11:16 -0700 (Fri, 02 Aug 2002) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h

removed R_Mesh_Draw_NativeOnly (it was not used)
cleaned up modulate detection (overbright decisions)

------------------------------------------------------------------------
r2147 | havoc | 2002-07-31 23:34:46 -0700 (Wed, 31 Jul 2002) | 6 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/vid_shared.c

cleaned up glDrawRangeElements limit checking a bit (now done in gl_backend.c)

no longer limits maxtriangles based on DrawRangeElements limits (since DrawRangeElements is required to work even if limits are exceeded, according to the OpenGL spec)

now posts startup/shutdown messages for gl_backend

------------------------------------------------------------------------
r2145 | havoc | 2002-07-31 07:04:06 -0700 (Wed, 31 Jul 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_draw.c

cleaned up gl_mesh_drawmode related code, hopefully fixing various unknown bugs

------------------------------------------------------------------------
r2144 | havoc | 2002-07-31 06:46:25 -0700 (Wed, 31 Jul 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c

expanded sprint/centerprint buffer from 256 chars to 4096

------------------------------------------------------------------------
r2143 | havoc | 2002-07-31 05:11:17 -0700 (Wed, 31 Jul 2002) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

disabled 3DFX mesh size error (because it really only applies when gl_mesh_floatcolors is 1, which is not the default)
automatically grow mesh buffers based on size of meshs encountered

------------------------------------------------------------------------
r2142 | havoc | 2002-07-31 04:45:17 -0700 (Wed, 31 Jul 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

cleaned up behavior when an invalid replacement sky texture is found - now it will fall back to the texture inside the map

------------------------------------------------------------------------
r2141 | havoc | 2002-07-31 02:57:51 -0700 (Wed, 31 Jul 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.mingw

added -fno-strict-aliasing  (even though it isn't a problem with gcc 2.95.3 anyway)

------------------------------------------------------------------------
r2140 | havoc | 2002-07-31 02:43:23 -0700 (Wed, 31 Jul 2002) | 4 lines
Changed paths:
   M /trunk/darkplaces/sys_shared.c

increased name limit on engineversion string from 39 chars to 127, this fixed a bug in windows builds where the string was too long for the buffer...

also shortened the string itself to no longer mention 'GL' or 'build'

------------------------------------------------------------------------
r2137 | havoc | 2002-07-30 22:24:06 -0700 (Tue, 30 Jul 2002) | 2 lines
Changed paths:
   A /trunk/darkplaces/darkplaces.txt

added the readme file to cvs (... and it needs massive updates)

------------------------------------------------------------------------
r2136 | havoc | 2002-07-30 22:15:05 -0700 (Tue, 30 Jul 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/dpvsimpledecode.c
   M /trunk/darkplaces/snd_win.c
   M /trunk/darkplaces/wavefile.c

win32 fixes and some MSVC warnings fixed

------------------------------------------------------------------------
r2134 | knghtbrd | 2002-07-30 20:07:50 -0700 (Tue, 30 Jul 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

Fix for -particles specified wrongly on the cmdline..

------------------------------------------------------------------------
r2121 | havoc | 2002-07-29 20:15:09 -0700 (Mon, 29 Jul 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_crosshairs.c

fix 'flashing' crosshair bug caused by negative colors (clamp them before drawing the sprite)

------------------------------------------------------------------------
r2119 | havoc | 2002-07-29 06:23:05 -0700 (Mon, 29 Jul 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

slight simplification/optimzation/readability enhancement/whatever to animating textures

------------------------------------------------------------------------
r2118 | havoc | 2002-07-29 06:21:56 -0700 (Mon, 29 Jul 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fix animating textures

------------------------------------------------------------------------
r2117 | knghtbrd | 2002-07-29 04:20:46 -0700 (Mon, 29 Jul 2002) | 5 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

Water transition splashes do not happen for lava anymore.  This means
lavaballs do not drive one ABSOLUTELY INSANE anymore.  (Except when you
get hit by them and they knock you into said lava, but that's another
story entirely..)

------------------------------------------------------------------------
r2116 | knghtbrd | 2002-07-29 04:11:59 -0700 (Mon, 29 Jul 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_light.c

Make coronas look better (it looks good in Twilight, so...)

------------------------------------------------------------------------
r2115 | havoc | 2002-07-29 03:33:39 -0700 (Mon, 29 Jul 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_crosshairs.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/sbar.c

Serious-Sam style crosshair (an actual sprite in the world, with slight variation in size based on distance, and is based on actual quake gun position, not center of screen)

------------------------------------------------------------------------
r2114 | havoc | 2002-07-29 03:31:57 -0700 (Mon, 29 Jul 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

much nicer rocket and grenade trails

------------------------------------------------------------------------
r2112 | havoc | 2002-07-29 03:09:45 -0700 (Mon, 29 Jul 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

corrected fullbright map handling for the case when the fullbright bmodel is not the running map, but one of the imported bmodels instead, also corrected a comment about r_ambient

------------------------------------------------------------------------
r2110 | havoc | 2002-07-29 00:06:52 -0700 (Mon, 29 Jul 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/zone.c
   M /trunk/darkplaces/zone.h

disabled memory clumping, which surprisingly improves memory use, rather than hinders it (at least in Linux...  hopefully same in windows) and massively speeds up loading of complicated maps

------------------------------------------------------------------------
r2105 | knghtbrd | 2002-07-27 22:45:46 -0700 (Sat, 27 Jul 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c

Alphabetized extensions and added TW_SV_STEPCONTROL..

------------------------------------------------------------------------
r2093 | molivier | 2002-07-25 23:18:16 -0700 (Thu, 25 Jul 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/image.c

Fixed PCX file loading for images with an odd width

------------------------------------------------------------------------
r2089 | havoc | 2002-07-25 02:58:47 -0700 (Thu, 25 Jul 2002) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_video.c

now uses a fragment texture for the video (massive speedup)
clears audioqueue when video stops

------------------------------------------------------------------------
r2088 | havoc | 2002-07-25 02:57:41 -0700 (Thu, 25 Jul 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

fragment images made for fragment textures will now always be big enough for the fragment texture that created them

------------------------------------------------------------------------
r2084 | havoc | 2002-07-25 02:50:06 -0700 (Thu, 25 Jul 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_dma.c

fix fatal bugs in S_RawSamples_Enqueue and Dequeue relating to mis-detected buffer wraps

------------------------------------------------------------------------
r2083 | havoc | 2002-07-25 02:14:48 -0700 (Thu, 25 Jul 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/cl_screen.h
   A /trunk/darkplaces/cl_video.c
   A /trunk/darkplaces/cl_video.h
   M /trunk/darkplaces/darkplaces.dsp
   A /trunk/darkplaces/dpvsimpledecode.c
   A /trunk/darkplaces/dpvsimpledecode.h
   M /trunk/darkplaces/draw.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/makefile.mingw
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/r_textures.h
   M /trunk/darkplaces/snd_dma.c
   M /trunk/darkplaces/sound.h
   A /trunk/darkplaces/wavefile.c
   A /trunk/darkplaces/wavefile.h

.dpv video playback is now implemented.  Slow though, because it's resizing textures, this needs to be fixed...

------------------------------------------------------------------------
r2082 | havoc | 2002-07-24 19:51:20 -0700 (Wed, 24 Jul 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_mix.c

whitespace

------------------------------------------------------------------------
r2081 | havoc | 2002-07-24 19:49:43 -0700 (Wed, 24 Jul 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_mix.c

whitespace cleanup

------------------------------------------------------------------------
r2080 | havoc | 2002-07-24 19:43:33 -0700 (Wed, 24 Jul 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_dma.c
   M /trunk/darkplaces/snd_mix.c
   M /trunk/darkplaces/sound.h

added S_RawSamples_Enqueue, S_RawSamples_Dequeue, and S_RawSamples_ClearQueue functions to allow background music/video support, these are now used to clear the paintbuffer

------------------------------------------------------------------------
r2079 | havoc | 2002-07-24 19:03:37 -0700 (Wed, 24 Jul 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile

add -fno-strict-aliasing

------------------------------------------------------------------------
r2078 | havoc | 2002-07-24 18:44:38 -0700 (Wed, 24 Jul 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_mem.c

minor whitespace and comment cleanup

------------------------------------------------------------------------
r2077 | havoc | 2002-07-24 18:40:06 -0700 (Wed, 24 Jul 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_alsa_0_5.c
   M /trunk/darkplaces/snd_alsa_0_9.c
   M /trunk/darkplaces/snd_mix.c
   M /trunk/darkplaces/snd_oss.c
   M /trunk/darkplaces/snd_win.c
   M /trunk/darkplaces/sound.h

massive cleanup of S_TransferPaintBuffer and moved DirectSound locking junk into snd_win.c (adding S_LockBuffer and S_UnlockBuffer stubs for other platforms)

------------------------------------------------------------------------
r2063 | havoc | 2002-07-21 01:40:19 -0700 (Sun, 21 Jul 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/matrixlib.c

include quakedef (which drags in lots of other stuff) to hide various MSVC warnings and make sure M_PI is defined

------------------------------------------------------------------------
r2061 | havoc | 2002-07-19 18:02:11 -0700 (Fri, 19 Jul 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix view blends so they are alpha, not additive

------------------------------------------------------------------------
r2046 | havoc | 2002-07-16 22:29:20 -0700 (Tue, 16 Jul 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/r_light.c

faster static light tracing (by not doing it as often), this also means results of static light traces are cached in the entity_render_t (which is now considered semi-persistent), made light falloff in .lights file actually work (it wasn't being used by the model lighting code... oops), also made coronas twice as bright

------------------------------------------------------------------------
r2045 | havoc | 2002-07-16 22:24:16 -0700 (Tue, 16 Jul 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.dsp
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/makefile.mingw
   D /trunk/darkplaces/matrix3x4.c
   D /trunk/darkplaces/matrix3x4.h
   D /trunk/darkplaces/matrix4x4.c
   D /trunk/darkplaces/matrix4x4.h
   A /trunk/darkplaces/matrixlib.c
   A /trunk/darkplaces/matrixlib.h

merged matrix4x4 and matrix3x4 into matrixlib, updated makefiles and dsp, some cleanups to matrixlib as well

------------------------------------------------------------------------
r2044 | havoc | 2002-07-16 22:18:31 -0700 (Tue, 16 Jul 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/mathlib.h

put parentheses around parameters to min/max/bound macros

------------------------------------------------------------------------
r2043 | havoc | 2002-07-16 22:15:21 -0700 (Tue, 16 Jul 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_particles.c

scrag, hellknight, and shalrath shots now glow, also tweaked the particle colors and made them additive blend

------------------------------------------------------------------------
r2029 | knghtbrd | 2002-07-09 11:46:41 -0700 (Tue, 09 Jul 2002) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

The Nehahra movie was borked.  They were making static ents without
models.  When you try to do this, DarkPlaces has issues!  Issues I say!

------------------------------------------------------------------------
r2020 | havoc | 2002-07-07 23:54:42 -0700 (Sun, 07 Jul 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.dsp
   M /trunk/darkplaces/makefile.mingw

updated mingw makefile and MSVC project to add matrix4x4.c and matrix3x4.c

------------------------------------------------------------------------
r2019 | havoc | 2002-07-07 23:02:23 -0700 (Sun, 07 Jul 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

better check for 0 alpha (it now must be exactly 0.0f, not merely rounded off to 0 as a byte)

------------------------------------------------------------------------
r2018 | havoc | 2002-07-07 19:57:02 -0700 (Sun, 07 Jul 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/mathlib.c

some whitespace cleanups and a correction of a comment

------------------------------------------------------------------------
r2017 | havoc | 2002-07-07 19:40:59 -0700 (Sun, 07 Jul 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/matrix3x4.c
   M /trunk/darkplaces/matrix4x4.c

Matrix4x4_CreateRotate and Matrix3x4_CreateRotate now take degrees instead of radians for the angle

------------------------------------------------------------------------
r2016 | havoc | 2002-07-07 17:39:24 -0700 (Sun, 07 Jul 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/mathlib.c

a minor whitespace cleanup on R_ConcatRotations

------------------------------------------------------------------------
r2015 | havoc | 2002-07-07 17:12:22 -0700 (Sun, 07 Jul 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/sys_linux.c
   M /trunk/darkplaces/sys_win.c

if the OS returns a very bogus time (or it wrapped), warn about it and keep ticking

------------------------------------------------------------------------
r2012 | havoc | 2002-07-07 17:02:54 -0700 (Sun, 07 Jul 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces
   M /trunk/darkplaces/.cvsignore

updated .cvsignore so it ignores darkplaces-3dfx and gmon.out

------------------------------------------------------------------------
r2011 | havoc | 2002-07-07 17:02:03 -0700 (Sun, 07 Jul 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile
   A /trunk/darkplaces/snd_null.c

added snd_null for anyone who can't use the other sound drivers, and cleaned up the notes regarding sound drivers in the makefile

------------------------------------------------------------------------
r2009 | havoc | 2002-07-07 16:42:36 -0700 (Sun, 07 Jul 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile
   A /trunk/darkplaces/matrix3x4.c
   A /trunk/darkplaces/matrix3x4.h
   A /trunk/darkplaces/matrix4x4.c
   A /trunk/darkplaces/matrix4x4.h

created a couple matrix libraries (4x4 and 3x4), hopefully these will be useful

------------------------------------------------------------------------
r2008 | havoc | 2002-07-07 16:38:28 -0700 (Sun, 07 Jul 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/mathlib.h

now includes qtypes.h

------------------------------------------------------------------------
r2007 | havoc | 2002-07-07 16:37:32 -0700 (Sun, 07 Jul 2002) | 2 lines
Changed paths:
   A /trunk/darkplaces/qtypes.h
   M /trunk/darkplaces/quakedef.h

added a qtypes.h for little things like qbyte and such

------------------------------------------------------------------------
r1999 | knghtbrd | 2002-07-07 13:43:10 -0700 (Sun, 07 Jul 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

Make screenshot saving more like Twilight's.

------------------------------------------------------------------------
r1996 | havoc | 2002-07-06 13:23:36 -0700 (Sat, 06 Jul 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/mathlib.h

corrected QuatMake math, and commented out the entire set of quaternion macros

------------------------------------------------------------------------
r1993 | knghtbrd | 2002-07-06 05:04:47 -0700 (Sat, 06 Jul 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.dsp
   M /trunk/darkplaces/darkplaces.dsw

Make sure these files are marked as binary so CVS keeps the dos newlines.

------------------------------------------------------------------------
r1992 | havoc | 2002-07-05 18:48:50 -0700 (Fri, 05 Jul 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h

some cleanup of map texture loading and related code (mainly better support for untextured maps), no longer uploads more than one copy of the notexture image (it used to upload one copy of it per bmodel loaded), minor optimization of animating texture support (or rather, optimization of the extremely common non-animating texture case)

------------------------------------------------------------------------
r1991 | havoc | 2002-07-05 18:45:15 -0700 (Fri, 05 Jul 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/collision.c

disabled RecursiveHullCheckPoint because it probably isn't much of a speed gain really, and it could break things in rare cases

------------------------------------------------------------------------
r1990 | havoc | 2002-07-05 18:43:27 -0700 (Fri, 05 Jul 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

fix for grenades sinking into brush model floor in start.bsp

------------------------------------------------------------------------
r1985 | knghtbrd | 2002-07-05 06:28:07 -0700 (Fri, 05 Jul 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_tent.c

Change to using a flash for teleport rather than a particle effect.

------------------------------------------------------------------------
r1983 | knghtbrd | 2002-07-04 20:28:10 -0700 (Thu, 04 Jul 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_edict.c

Kill trigraphs.  Die die die.  Or something.

------------------------------------------------------------------------
r1969 | havoc | 2002-06-28 21:00:11 -0700 (Fri, 28 Jun 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_tent.c
   M /trunk/darkplaces/snd_dma.c
   M /trunk/darkplaces/snd_mem.c
   M /trunk/darkplaces/snd_mix.c
   M /trunk/darkplaces/sound.h

no longer complains about missing sounds loaded by the engine (wind2, water1, etc), only the QC

------------------------------------------------------------------------
r1965 | molivier | 2002-06-24 00:19:28 -0700 (Mon, 24 Jun 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_wgl.c

Fixed video modes menu on Win32

------------------------------------------------------------------------
r1954 | knghtbrd | 2002-06-14 02:49:36 -0700 (Fri, 14 Jun 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_edict.c

Someone has been programming QC too long.  (At least it was QC related!)

------------------------------------------------------------------------
r1953 | lordhavoc | 2002-06-13 12:38:52 -0700 (Thu, 13 Jun 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/sys_linux.c
   M /trunk/darkplaces/sys_win.c

Fixed major bug in time wrap code, would have not advanced clock at all after wrap.  Thanks to Mercury for pointing out the bug.

------------------------------------------------------------------------
r1951 | lordhavoc | 2002-06-12 17:38:27 -0700 (Wed, 12 Jun 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_light.c

Forgot to apply Vic's axial patch for r_light.c, here it is.

------------------------------------------------------------------------
r1950 | lordhavoc | 2002-06-12 17:25:18 -0700 (Wed, 12 Jun 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

Optimized AddDynamicLights and StainNode for axial surfaces/nodes (respectively), thanks to Vic for example code.

------------------------------------------------------------------------
r1947 | molivier | 2002-06-12 05:24:09 -0700 (Wed, 12 Jun 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

Added a special key binding menu when compiling for BloodBath

------------------------------------------------------------------------
r1946 | molivier | 2002-06-12 05:22:48 -0700 (Wed, 12 Jun 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/sys_win.c

Removed an error when compiling with MSVC

------------------------------------------------------------------------
r1943 | lordhavoc | 2002-06-10 14:43:32 -0700 (Mon, 10 Jun 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

faster stainmap code in BuildLightMap

------------------------------------------------------------------------
r1942 | lordhavoc | 2002-06-10 14:42:18 -0700 (Mon, 10 Jun 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/world.c

cleaned up order of bbox checks (whether to use the normal mins/maxs, or the clipmins/maxs, or the hullmins/maxs), and made use of areanodes culling optional (sv_useareanodes 0 will cause it to check against all entities every move, for debugging)

------------------------------------------------------------------------
r1941 | lordhavoc | 2002-06-10 14:40:10 -0700 (Mon, 10 Jun 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

cleaned up SV_Physics_Toss a bit - particularly water transitions and floating items

------------------------------------------------------------------------
r1940 | lordhavoc | 2002-06-10 12:07:21 -0700 (Mon, 10 Jun 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

get rid of velocity jittering on rain and snow, except for horizontal jitter on snow while falling (since that is a desired effect), should make snow work at low velocities

------------------------------------------------------------------------
r1939 | lordhavoc | 2002-06-10 10:21:30 -0700 (Mon, 10 Jun 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

advance angles as well as origin on clients when noclipping (why?  I don't know, consistency)

------------------------------------------------------------------------
r1934 | lordhavoc | 2002-06-08 17:36:34 -0700 (Sat, 08 Jun 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

step up stairs while flying

------------------------------------------------------------------------
r1933 | lordhavoc | 2002-06-08 17:30:10 -0700 (Sat, 08 Jun 2002) | 7 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_move.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sv_user.c
   M /trunk/darkplaces/world.c
   M /trunk/darkplaces/world.h

SV_PointContents removed (all calls replaced with Mod_PointInLeaf, which is faster)
SV_HullPointContents removed (no longer needed)
SV_TestEntityPosition now returns an int (true if in solid) rather than an edict_t *
sv_jumpstep added - step up while airborn, for example when jumping
sv_wallfriction added - to allow it to be turned off if desired
fly and noclip movement for players is now more like swimming

------------------------------------------------------------------------
r1932 | lordhavoc | 2002-06-08 17:26:08 -0700 (Sat, 08 Jun 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

made snow smaller and slightly transparent, looks better now

------------------------------------------------------------------------
r1931 | lordhavoc | 2002-06-08 17:23:07 -0700 (Sat, 08 Jun 2002) | 3 lines
Changed paths:
   M /trunk/darkplaces/sys_linux.c

timer now simply returns the same time twice if the OS value wraps, and posts a warning (rather than Sys_Error)
whitespace cleanup

------------------------------------------------------------------------
r1930 | lordhavoc | 2002-06-08 17:20:49 -0700 (Sat, 08 Jun 2002) | 3 lines
Changed paths:
   M /trunk/darkplaces/sys_win.c

timer now simply returns same time twice if the time input wraps, and posts a warning about this occurring, rather than doing a Sys_Error
cleaned up lots of code, mostly timer related.

------------------------------------------------------------------------
r1920 | knghtbrd | 2002-06-07 13:37:45 -0700 (Fri, 07 Jun 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cd_null.c
   M /trunk/darkplaces/makefile

cd_null.c works now.  It's the default because cd_linux.c is Linux only.

------------------------------------------------------------------------
r1919 | lordhavoc | 2002-06-07 12:03:35 -0700 (Fri, 07 Jun 2002) | 2 lines
Changed paths:
   A /trunk/darkplaces/cd_null.c

added back this file from stock quake, so people can build with no CD audio if desired...

------------------------------------------------------------------------
r1898 | lordhavoc | 2002-06-03 10:02:59 -0700 (Mon, 03 Jun 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_light.c

changed model lighting to match map lighting (this means it is only barely directional, sadly, but matchs the brightness of the map)

------------------------------------------------------------------------
r1895 | molivier | 2002-06-02 23:14:06 -0700 (Sun, 02 Jun 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

Updated BloodBath maps list

------------------------------------------------------------------------
r1894 | lordhavoc | 2002-06-02 20:02:21 -0700 (Sun, 02 Jun 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

make r_render skip the 3D rendering code (I forgot this before? ick)

------------------------------------------------------------------------
r1893 | lordhavoc | 2002-06-02 19:19:01 -0700 (Sun, 02 Jun 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

removed unneeded r_render check

------------------------------------------------------------------------
r1892 | lordhavoc | 2002-06-02 19:07:53 -0700 (Sun, 02 Jun 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

disable hidden surface removal by default

------------------------------------------------------------------------
r1891 | knghtbrd | 2002-06-02 12:52:39 -0700 (Sun, 02 Jun 2002) | 3 lines
Changed paths:
   M /trunk/darkplaces/builddate.c
   M /trunk/darkplaces/cd_linux.c
   M /trunk/darkplaces/cd_win.c
   M /trunk/darkplaces/cgame.c
   M /trunk/darkplaces/cgamevm.c
   M /trunk/darkplaces/cl_collision.c
   M /trunk/darkplaces/cl_demo.c
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_light.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/cl_tent.c
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/collision.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/crc.c
   M /trunk/darkplaces/cvar.c
   M /trunk/darkplaces/fractalnoise.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/in_svgalib.c
   M /trunk/darkplaces/in_win.c
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/mathlib.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_sprite.c
   M /trunk/darkplaces/net_bsd.c
   M /trunk/darkplaces/net_dgrm.c
   M /trunk/darkplaces/net_loop.c
   M /trunk/darkplaces/net_main.c
   M /trunk/darkplaces/net_udp.c
   M /trunk/darkplaces/net_win.c
   M /trunk/darkplaces/net_wins.c
   M /trunk/darkplaces/net_wipx.c
   M /trunk/darkplaces/palette.c
   M /trunk/darkplaces/portals.c
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/pr_exec.c
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/quakeio.c
   M /trunk/darkplaces/r_clip.c
   M /trunk/darkplaces/r_crosshairs.c
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_lerpanim.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_modules.c
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/r_sprites.c
   M /trunk/darkplaces/sbar.c
   M /trunk/darkplaces/screen.h
   M /trunk/darkplaces/snd_alsa_0_5.c
   M /trunk/darkplaces/snd_dma.c
   M /trunk/darkplaces/snd_mem.c
   M /trunk/darkplaces/snd_mix.c
   M /trunk/darkplaces/snd_oss.c
   M /trunk/darkplaces/snd_win.c
   M /trunk/darkplaces/sv_light.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_move.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sv_user.c
   M /trunk/darkplaces/sys_linux.c
   M /trunk/darkplaces/sys_shared.c
   M /trunk/darkplaces/sys_win.c
   M /trunk/darkplaces/transform.c
   M /trunk/darkplaces/ui.c
   M /trunk/darkplaces/vid_3dfxsvga.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c
   M /trunk/darkplaces/view.c
   M /trunk/darkplaces/wad.c
   M /trunk/darkplaces/world.c
   M /trunk/darkplaces/zone.c

A minor removal of a few pieces of dead code.  Nothing major.  This is
stage two.

------------------------------------------------------------------------
r1890 | knghtbrd | 2002-06-02 06:47:28 -0700 (Sun, 02 Jun 2002) | 2 lines
Changed paths:
   D /trunk/darkplaces/buildnumber.c

Unused.

------------------------------------------------------------------------
r1889 | knghtbrd | 2002-06-02 06:43:41 -0700 (Sun, 02 Jun 2002) | 3 lines
Changed paths:
   M /trunk/darkplaces/bspfile.h
   M /trunk/darkplaces/cdaudio.h
   M /trunk/darkplaces/cg_math.h
   M /trunk/darkplaces/cgame_api.h
   M /trunk/darkplaces/cl_light.h
   M /trunk/darkplaces/cl_screen.h
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/cmd.h
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/conproc.h
   M /trunk/darkplaces/console.h
   M /trunk/darkplaces/crc.h
   M /trunk/darkplaces/cvar.h
   M /trunk/darkplaces/draw.h
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_warp_sin.h
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/image.h
   M /trunk/darkplaces/input.h
   M /trunk/darkplaces/keys.h
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/mathlib.h
   M /trunk/darkplaces/menu.h
   M /trunk/darkplaces/model_alias.h
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/model_sprite.h
   M /trunk/darkplaces/model_zymotic.h
   M /trunk/darkplaces/modelgen.h
   M /trunk/darkplaces/net.h
   M /trunk/darkplaces/net_dgrm.h
   M /trunk/darkplaces/net_loop.h
   M /trunk/darkplaces/net_udp.h
   M /trunk/darkplaces/net_wins.h
   M /trunk/darkplaces/net_wipx.h
   M /trunk/darkplaces/palette.h
   M /trunk/darkplaces/portals.h
   M /trunk/darkplaces/pr_comp.h
   M /trunk/darkplaces/pr_execprogram.h
   M /trunk/darkplaces/progdefs.h
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/r_clip.h
   M /trunk/darkplaces/r_lerpanim.h
   M /trunk/darkplaces/r_light.h
   M /trunk/darkplaces/r_modules.h
   M /trunk/darkplaces/r_textures.h
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/sbar.c
   M /trunk/darkplaces/sbar.h
   M /trunk/darkplaces/screen.h
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sound.h
   M /trunk/darkplaces/spritegn.h
   M /trunk/darkplaces/sys.h
   M /trunk/darkplaces/transform.h
   M /trunk/darkplaces/ui.h
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/wad.h
   M /trunk/darkplaces/winquake.h
   M /trunk/darkplaces/world.h
   M /trunk/darkplaces/zone.h

DP code cleanup, stage one - all headers that can be protected by ifdef
and define now are.  Some dead code found in them was also removed.

------------------------------------------------------------------------
r1886 | lordhavoc | 2002-06-01 14:30:36 -0700 (Sat, 01 Jun 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

remove unused DrawNotifyString, fix intermission screen so only the finale-style intermission screens print a message slowly onto the screen

------------------------------------------------------------------------
r1885 | lordhavoc | 2002-06-01 14:27:23 -0700 (Sat, 01 Jun 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/palette.c

added -texgamma, -texcontrast, -texbrightness, these manipulate the palette (note: only affects quake palette images) in ways similar to qgamma (or so I assume, having never used it), possibly useful, sorta

------------------------------------------------------------------------
r1884 | lordhavoc | 2002-06-01 14:04:36 -0700 (Sat, 01 Jun 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

use volatile on icolor and fcolor pointers in GL_ConvertColorsFloatToByte to avoid aliasing problems (aliasing is exactly what that code is doing, after all)

------------------------------------------------------------------------
r1877 | mercury | 2002-05-29 04:28:09 -0700 (Wed, 29 May 2002) | 4 lines
Changed paths:
   M /trunk/darkplaces/collision.c

I have commit access to DP? When did that happen?

Fix the flying backpacks, just moving two lines, one of which is a comment.

------------------------------------------------------------------------
r1874 | lordhavoc | 2002-05-26 23:54:54 -0700 (Sun, 26 May 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c

attempt at working around a NVIDIA 23.11 TNT driver bug which causes the menu text to be squished to the top

------------------------------------------------------------------------
r1873 | lordhavoc | 2002-05-26 23:48:03 -0700 (Sun, 26 May 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/collision.c

make bbox collisions work again

------------------------------------------------------------------------
r1872 | lordhavoc | 2002-05-26 23:47:22 -0700 (Sun, 26 May 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

fix for gl_mesh_maxtriangles not defaulting correctly and raised minimum limit to 1024

------------------------------------------------------------------------
r1871 | lordhavoc | 2002-05-26 23:44:59 -0700 (Sun, 26 May 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

added some smoke to the fire effect (requested for bloodbath)

------------------------------------------------------------------------
r1867 | lordhavoc | 2002-05-22 03:08:34 -0700 (Wed, 22 May 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/collision.c

fix for uninitialized start/end of trace against bbox (oops!!)

------------------------------------------------------------------------
r1866 | lordhavoc | 2002-05-22 02:57:49 -0700 (Wed, 22 May 2002) | 4 lines
Changed paths:
   M /trunk/darkplaces/collision.c

added RecursiveHullCheckPoint for quicker tracing of a single point (that is to say: start == end)
rewrote RecursiveHullCheck a few times trying to improve it and gave up (epsilons are finicky), mostly reverted, however the mid point calculation is more accurate
(this fixes the 'can't move' bug)

------------------------------------------------------------------------
r1865 | lordhavoc | 2002-05-21 20:17:50 -0700 (Tue, 21 May 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/mathlib.c
   M /trunk/darkplaces/mathlib.h
   M /trunk/darkplaces/r_sprites.c

fix a bunch of pointer type warnings introduced by the change to const parameters in R_ConcatRotations and R_ConcatTransforms (now take float * instead of two dimensional array)

------------------------------------------------------------------------
r1864 | lordhavoc | 2002-05-21 04:12:40 -0700 (Tue, 21 May 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces
   M /trunk/darkplaces/.cvsignore

ignore various MSVC files (.opt, .plg, .ncb) and .exe

------------------------------------------------------------------------
r1863 | lordhavoc | 2002-05-21 04:10:23 -0700 (Tue, 21 May 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces
   M /trunk/darkplaces/.cvsignore

ignore .o files

------------------------------------------------------------------------
r1862 | lordhavoc | 2002-05-21 03:49:48 -0700 (Tue, 21 May 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.dsp

added collision.c, cl_collision.c. collision.h, cl_collision.h

------------------------------------------------------------------------
r1861 | lordhavoc | 2002-05-21 03:47:23 -0700 (Tue, 21 May 2002) | 4 lines
Changed paths:
   M /trunk/darkplaces/cgamevm.c
   M /trunk/darkplaces/chase.c
   A /trunk/darkplaces/cl_collision.c
   A /trunk/darkplaces/cl_collision.h
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/client.h
   A /trunk/darkplaces/collision.c
   A /trunk/darkplaces/collision.h
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/makefile.mingw
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/world.c
   M /trunk/darkplaces/world.h

split out RecursiveHullCheck and related code into collision.c (shared by client and server, doesn't care what an entity is), and cl_collision.c (CL_TraceLine and related code), this cleans up a lot of messy RecursiveHullCheck calls, replacing them with Collision_ClipTrace calls
also removed some commented out code
and fixed an epsilon glitch in RecursiveHullCheck which was mostly visible when shooting a gun along a wall at angles nearly parallel with the wall

------------------------------------------------------------------------
r1860 | lordhavoc | 2002-05-21 03:36:48 -0700 (Tue, 21 May 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/mathlib.c
   M /trunk/darkplaces/mathlib.h

made various things take const pointers (optimizer hint), commented out and/or removed a lot of unused functions

------------------------------------------------------------------------
r1859 | lordhavoc | 2002-05-21 03:22:32 -0700 (Tue, 21 May 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_user.c

changed Length() call to VectorLength() macro in two places

------------------------------------------------------------------------
r1858 | lordhavoc | 2002-05-21 03:20:45 -0700 (Tue, 21 May 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/view.c

changed Length() call to VectorLength() macro...  inside a comment...  yes pointless I know...

------------------------------------------------------------------------
r1857 | lordhavoc | 2002-05-21 03:18:11 -0700 (Tue, 21 May 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c

optimized (now does not use a sqrt for each entity) and improved findradius (now compares sphere against bboxes, rather than entity centers)

------------------------------------------------------------------------
r1856 | lordhavoc | 2002-05-20 20:51:57 -0700 (Mon, 20 May 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.mingw

build for -mwindows (so it doesn't open a console)

------------------------------------------------------------------------
r1855 | lordhavoc | 2002-05-20 19:32:04 -0700 (Mon, 20 May 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

validate animations in zym models

------------------------------------------------------------------------
r1852 | lordhavoc | 2002-05-18 18:30:53 -0700 (Sat, 18 May 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fix for really dumb mistake (missing memset) in Mod_SplitSurfMeshIfTooBig

------------------------------------------------------------------------
r1848 | lordhavoc | 2002-05-15 23:54:20 -0700 (Wed, 15 May 2002) | 5 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/vid_shared.c

now fetchs wgl functions
now works with all drivers I would hope (tries both wglGetProcAddress and GetProcAddress to get a function's address)
now detects both glDrawRangeElements (1.2 function) and GL_EXT_draw_range_elements (1.1 and above extension)
now tunes gl_mesh_maxtriangles based on DrawRangeElements limitations reported by driver (if available)

------------------------------------------------------------------------
r1847 | lordhavoc | 2002-05-15 23:51:15 -0700 (Wed, 15 May 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

use qglDeleteTextures, not glDeleteTextures

------------------------------------------------------------------------
r1842 | lordhavoc | 2002-05-15 02:04:56 -0700 (Wed, 15 May 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

increased MAX_SURFVERTS to hold as many as the surf mesh splitter in model_brush.c allows (and added comment saying so)

------------------------------------------------------------------------
r1841 | lordhavoc | 2002-05-15 01:56:45 -0700 (Wed, 15 May 2002) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/r_light.c

muzzleflash fades out
changed .lights file format very slightly to add customizable distance bias (softness)
now splits surface meshs bigger than 1000 tris into multiple smaller ones automatically while loading

------------------------------------------------------------------------
r1840 | lordhavoc | 2002-05-15 01:53:48 -0700 (Wed, 15 May 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_sky.c

reduced skysphere from 2048 triangles to 1024

------------------------------------------------------------------------
r1839 | lordhavoc | 2002-05-14 21:00:37 -0700 (Tue, 14 May 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_light.c

directional static lighting support (but not fast yet), for maps compiled with (as yet unreleased) new version of hlight

------------------------------------------------------------------------
r1838 | lordhavoc | 2002-05-14 20:58:00 -0700 (Tue, 14 May 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/r_clip.c
   M /trunk/darkplaces/vid_3dfxsvga.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c

change a lot of calls from gl to qgl

------------------------------------------------------------------------
r1837 | lordhavoc | 2002-05-14 20:55:53 -0700 (Tue, 14 May 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c

oops forgot to commit this piece of the unsuccessful support for floating items

------------------------------------------------------------------------
r1834 | lordhavoc | 2002-05-14 19:30:05 -0700 (Tue, 14 May 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c

sv_stepheight cvar, SV_Init now calls SV_Phys_Init, and another unsuccessful attempt to make items float in air if spawned on soon-deleted platforms (mapper trick for floating items)

------------------------------------------------------------------------
r1833 | lordhavoc | 2002-05-14 19:25:08 -0700 (Tue, 14 May 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

slight optimizations to GL_ConvertColorsFloattoByte

------------------------------------------------------------------------
r1830 | lordhavoc | 2002-05-14 03:43:25 -0700 (Tue, 14 May 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_shared.c

search for GL functions using GetProcAddress on win32 instead of wglGetProcAddress (which only lists extensions, apparently), fixes inability to find GL 1.1.0 functions in 3dfx driver (maybe NVIDIA and others, only tested 3dfx)

------------------------------------------------------------------------
r1829 | lordhavoc | 2002-05-14 03:40:35 -0700 (Tue, 14 May 2002) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

independent control of gl_mesh_maxtriangles and gl_mesh_transtriangles (that is to say you can have more transparent triangles than normal ones, they get rendered in batchs anyway)

also a check for meshs too big for 3DFX drivers, which might fix problems for some people, I dunno, I was unable to reproduce the problem on my voodoo2 this time (has occurred in the past, maybe something else is broken in the gl_backend preventing it from overflowing the vertex buffers of the driver)

------------------------------------------------------------------------
r1820 | lordhavoc | 2002-05-04 05:08:45 -0700 (Sat, 04 May 2002) | 3 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/world.c

cleaned up and fixed collisions with brush models (example: you can now ramp jump and hit the light fixture in e4m1 in dp mod), now uses 3 different bounding boxes for the trace (hullmins/hullmaxs for collisions with brush models, mins/maxs for collisions with normal entities, mins2/maxs2 for collisions with monsters), and the movebounds use the largest of the bounding boxes to ensure proper collisions
items suspended in the air on a func_door (or similar) entity which is then killed by a trigger, should now continue floating in the air (this is a gross hack, to make suspended items in various maps stay in the air)

------------------------------------------------------------------------
r1819 | lordhavoc | 2002-05-04 05:04:19 -0700 (Sat, 04 May 2002) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/vid_shared.c

mostly dynamic GL binding (more needs to be done, but it's closer)
added gl_mesh_drawmode cvar (3 = drawrangeelements (if available), 2 = drawelements, 1 = arrayelement, 0 = completely manual), 0 should get the 3dfx glquake minigl running...

------------------------------------------------------------------------
r1818 | lordhavoc | 2002-05-03 15:07:16 -0700 (Fri, 03 May 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

reverted embedded-in-other-object behavior to sticking, rather than allowing you to walk through it, to fix many maps

------------------------------------------------------------------------
r1817 | lordhavoc | 2002-05-03 15:06:05 -0700 (Fri, 03 May 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c

hopefully this fixes the problem in TNT drivers with the options menu (too much text in one batch)

------------------------------------------------------------------------
r1802 | lordhavoc | 2002-04-30 00:37:35 -0700 (Tue, 30 Apr 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/palette.c

i is not longer an unsigned short in Palette_Setup8to24

------------------------------------------------------------------------
r1800 | lordhavoc | 2002-04-29 23:28:21 -0700 (Mon, 29 Apr 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/r_clip.c

more cleaning - glTexParameterf replaced with glTexParameteri

------------------------------------------------------------------------
r1799 | lordhavoc | 2002-04-29 23:24:30 -0700 (Mon, 29 Apr 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/r_clip.c

changed texrgbscale to int rather than float, this allowed me to change all remaining glTexEnvf calls to glTexEnvi

------------------------------------------------------------------------
r1798 | lordhavoc | 2002-04-29 23:03:29 -0700 (Mon, 29 Apr 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c

no longer uses glColor3f at all

------------------------------------------------------------------------
r1797 | lordhavoc | 2002-04-29 23:02:29 -0700 (Mon, 29 Apr 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/glquake.h

disabled lookup of unused multitexture function (glMultiTexCoord2f)

------------------------------------------------------------------------
r1796 | lordhavoc | 2002-04-29 22:43:54 -0700 (Mon, 29 Apr 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_shared.c

disabled lookup of unused multitexture function (glMultiTexCoord2f)

------------------------------------------------------------------------
r1781 | lordhavoc | 2002-04-28 13:15:05 -0700 (Sun, 28 Apr 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_mem.c

fix for misparsing of sound length in "data" chunk of WAVE, this should fix stereo sound crashs

------------------------------------------------------------------------
r1780 | lordhavoc | 2002-04-28 12:41:52 -0700 (Sun, 28 Apr 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_mem.c

some cleaning which seems to have fixed (I hope?) a crash in stereo 16bit sound resampling when source and destination rates are the same

------------------------------------------------------------------------
r1779 | lordhavoc | 2002-04-28 12:37:59 -0700 (Sun, 28 Apr 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_edict.c

fix for savegames containing newlines inside strings (now they are converted to escape codes, which COM_Parse will happily dismantle again when loading)

------------------------------------------------------------------------
r1778 | lordhavoc | 2002-04-28 12:35:17 -0700 (Sun, 28 Apr 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/protocol.h

minor cleaning of obsolete protocol stuff (svc_fog is now considered unused, because it really never was used)

------------------------------------------------------------------------
r1735 | lordhavoc | 2002-04-11 21:24:29 -0700 (Thu, 11 Apr 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.mingw

cleaned up the newlines (carriagereturn carriagereturn linefeed?  weird!)

------------------------------------------------------------------------
r1734 | lordhavoc | 2002-04-11 02:33:15 -0700 (Thu, 11 Apr 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/mathlib.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_sprite.c
   M /trunk/darkplaces/r_clip.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/zone.c
   M /trunk/darkplaces/zone.h

removed silly uses of 'long' (now int, or qbyte *, depending on the way it was used), and changed memheader sentinels to work on processors which can not handle unaligned memory access (Sparc for example)

------------------------------------------------------------------------
r1733 | lordhavoc | 2002-04-11 02:30:51 -0700 (Thu, 11 Apr 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

timerefresh works more sanely again

------------------------------------------------------------------------
r1715 | lordhavoc | 2002-04-05 19:43:50 -0800 (Fri, 05 Apr 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_user.c

added back the hacky NAT routing fix since it actually does work, the win32 problems were unrelated and have been fixed

------------------------------------------------------------------------
r1713 | lordhavoc | 2002-04-05 01:34:39 -0800 (Fri, 05 Apr 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/net_dgrm.c

MSG_Read functions are never used inside if's anymore (this fixes some problems with MSVC)

------------------------------------------------------------------------
r1712 | lordhavoc | 2002-04-05 01:32:12 -0800 (Fri, 05 Apr 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_explosion.c

minor cleanup/simplification (though a bit of a de-optimization) of explosion shading, might fix a glitch or two on the edges, not sure

------------------------------------------------------------------------
r1699 | lordhavoc | 2002-04-01 01:14:45 -0800 (Mon, 01 Apr 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.dsp

newline change?

------------------------------------------------------------------------
r1697 | lordhavoc | 2002-04-01 01:00:29 -0800 (Mon, 01 Apr 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_user.c

removed hacky network code that tried to make DP work through NAT routers (but infact just broke everything, sigh)

------------------------------------------------------------------------
r1696 | lordhavoc | 2002-04-01 00:58:47 -0800 (Mon, 01 Apr 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

fix for dedicated server spewing error about cl_avidemo

------------------------------------------------------------------------
r1693 | lordhavoc | 2002-03-29 21:04:54 -0800 (Fri, 29 Mar 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/image.h
   M /trunk/darkplaces/snd_mix.c

added cl_avidemo cvar (saves a series of tga images named gamedir/dpavi000000.tga and so on, the parameter to it is the framerate to save, locks framerate to this while saving, set back to 0 to stop - note there is sound saving code but it is commented out because it's always desynchronized to the video because quake has such a lousy sound engine)

------------------------------------------------------------------------
r1692 | lordhavoc | 2002-03-29 21:00:08 -0800 (Fri, 29 Mar 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.h

forgot to commit this before

------------------------------------------------------------------------
r1691 | lordhavoc | 2002-03-29 19:04:49 -0800 (Fri, 29 Mar 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/filematch.c

force filenames to lowercase in listdirectory code on windows

------------------------------------------------------------------------
r1688 | lordhavoc | 2002-03-27 02:21:45 -0800 (Wed, 27 Mar 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile

-lXIE does not seem to be necessary, disabled (but left a comment incase anyone needs it)

------------------------------------------------------------------------
r1687 | lordhavoc | 2002-03-27 01:13:34 -0800 (Wed, 27 Mar 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c

removed fog shaderstage, merged it into the normal stage

------------------------------------------------------------------------
r1686 | lordhavoc | 2002-03-26 19:44:35 -0800 (Tue, 26 Mar 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h

reorganized shader rendering calls to process the whole surface chain multiple times in the shader function (pretty fast), rather than calling the shader function multiple times per surface (slow!)

------------------------------------------------------------------------
r1685 | lordhavoc | 2002-03-26 19:42:22 -0800 (Tue, 26 Mar 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

smoke is alpha again (not additive), rather dark in appearance, lingers longer

------------------------------------------------------------------------
r1684 | lordhavoc | 2002-03-26 19:40:26 -0800 (Tue, 26 Mar 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/protocol.c

massive speedups (removed a few 256k memsets)

------------------------------------------------------------------------
r1682 | lordhavoc | 2002-03-26 16:34:02 -0800 (Tue, 26 Mar 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

added some (not yet used) key config menu code, part of a redesign for loading the key config menu layout from configs (more specifically default.cfg in DP mod and any others that use it)

------------------------------------------------------------------------
r1681 | eviltypeguy | 2002-03-26 09:47:42 -0800 (Tue, 26 Mar 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/filematch.c

Added newline at end for lame gcc versions ;)

------------------------------------------------------------------------
r1680 | molivier | 2002-03-26 04:40:19 -0800 (Tue, 26 Mar 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

Some menu customizations for BloodBath

------------------------------------------------------------------------
r1679 | molivier | 2002-03-26 01:55:33 -0800 (Tue, 26 Mar 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c

Fixed PF_registercvar

------------------------------------------------------------------------
r1678 | lordhavoc | 2002-03-25 16:47:44 -0800 (Mon, 25 Mar 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h

minor speed increase in surface shaders, by splitting out surfaces with and without fullbrights into different shader code

------------------------------------------------------------------------
r1677 | lordhavoc | 2002-03-25 15:00:53 -0800 (Mon, 25 Mar 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.dsp
   M /trunk/darkplaces/makefile.mingw

updated MSVC and mingw files to compile filematch.c

------------------------------------------------------------------------
r1676 | lordhavoc | 2002-03-25 14:51:57 -0800 (Mon, 25 Mar 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   A /trunk/darkplaces/filematch.c
   M /trunk/darkplaces/makefile

now loads gamedir/*.pak instead of gamedir/pak#.pak, sorted by ASCII value (note: lowercase overrides uppercase)

------------------------------------------------------------------------
r1675 | lordhavoc | 2002-03-25 14:48:25 -0800 (Mon, 25 Mar 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.h

reduced the drawqueue buffer from 1mb to 256k (really it only needs about 60k)

------------------------------------------------------------------------
r1674 | lordhavoc | 2002-03-25 14:46:41 -0800 (Mon, 25 Mar 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

seed the random number generator with the current time at startup (quake never seeded it)

------------------------------------------------------------------------
r1673 | molivier | 2002-03-25 04:38:10 -0800 (Mon, 25 Mar 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/net_main.c

DarkPlaces should always wait for connections in BloodBath mode

------------------------------------------------------------------------
r1668 | molivier | 2002-03-21 23:12:05 -0800 (Thu, 21 Mar 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/menu.c

A few minor changes for BloodBath support (including the map list); more to come

------------------------------------------------------------------------
r1665 | lordhavoc | 2002-03-20 11:06:49 -0800 (Wed, 20 Mar 2002) | 3 lines
Changed paths:
   M /trunk/darkplaces/menu.c

cleaned up nehahra demo list
cleaned up level/episode system, now it is much easier (and cleaner) to add new maps/episodes/games

------------------------------------------------------------------------
r1664 | lordhavoc | 2002-03-20 11:05:16 -0800 (Wed, 20 Mar 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h

added -bloodbath game

------------------------------------------------------------------------
r1663 | lordhavoc | 2002-03-20 09:31:29 -0800 (Wed, 20 Mar 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c

fix for CreatePath creating a directory of the drive's letter in windows (d:\quake created a d directory, then d: (ignored), then d:\quake, now creates d: (ignored), then d:\quake)  (thanks Elric)

------------------------------------------------------------------------
r1662 | lordhavoc | 2002-03-20 09:29:43 -0800 (Wed, 20 Mar 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

fixed options menu item count (thanks Elric)

------------------------------------------------------------------------
r1661 | lordhavoc | 2002-03-17 08:32:02 -0800 (Sun, 17 Mar 2002) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/protocol.h

added EF_STARDUST effect (showering golden sparks, and the entity glows)
reduced rocket glow a little
made blood stains brighter again (so you can at least see the floor)
EF_STARDUST and EF_FLAME now create a fixed size effect rather than attempting to use the model bounding box (which is too big usually)

------------------------------------------------------------------------
r1660 | lordhavoc | 2002-03-17 07:56:18 -0800 (Sun, 17 Mar 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/protocol.c

fix for EF_FLAME and lots of other bugs with 16bit/8bit fields (modelindex, frame, effects)

------------------------------------------------------------------------
r1659 | lordhavoc | 2002-03-16 07:00:15 -0800 (Sat, 16 Mar 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/sv_main.c

changed protocol back to using float coordinates, unless the mod specifies EF_LOWPRECISION on an entity, then it is sent using shorts (if it is within the short range, otherwise it uses floats), this loses some bandwidth but makes everything look nice (lifts aren't jerky, etc)

------------------------------------------------------------------------
r1658 | lordhavoc | 2002-03-16 06:51:55 -0800 (Sat, 16 Mar 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile

added note not to use athlon optimizations in current gcc versions

------------------------------------------------------------------------
r1657 | lordhavoc | 2002-03-16 06:49:13 -0800 (Sat, 16 Mar 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/net_dgrm.c

whitespace

------------------------------------------------------------------------
r1656 | lordhavoc | 2002-03-16 06:46:57 -0800 (Sat, 16 Mar 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

don't do down traces if sitting on the floor of world (world never moves, so we can skip it), restores a lot of the speed lost in recent commits

------------------------------------------------------------------------
r1655 | lordhavoc | 2002-03-16 06:45:18 -0800 (Sat, 16 Mar 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/world.c

Check bbox for overlap even on bmodels again (disabling it was a speed loss)

------------------------------------------------------------------------
r1654 | lordhavoc | 2002-03-15 06:40:18 -0800 (Fri, 15 Mar 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

darkened blood

------------------------------------------------------------------------
r1651 | lordhavoc | 2002-03-14 11:54:08 -0800 (Thu, 14 Mar 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

changed blood settings (note: these are saved cvars, so clear your config for them to take effect)

------------------------------------------------------------------------
r1650 | lordhavoc | 2002-03-14 11:52:06 -0800 (Thu, 14 Mar 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

randomized blood and smoke color a bit (darker/brighter randomly), got rid of smoke texture color (so now it fogs for free, no state thrash), looks a bit worse on blood, but oh well

------------------------------------------------------------------------
r1649 | lordhavoc | 2002-03-14 11:46:31 -0800 (Thu, 14 Mar 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_lerpanim.c

Hide no such frame warning if developer is off

------------------------------------------------------------------------
r1648 | lordhavoc | 2002-03-14 11:26:12 -0800 (Thu, 14 Mar 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_sprite.c

workaround for absolutely empty sprites (Nehahra s_null.spr)

------------------------------------------------------------------------
r1647 | molivier | 2002-03-14 08:46:07 -0800 (Thu, 14 Mar 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.dsp
   M /trunk/darkplaces/makefile.mingw

Removed references to r_particles.c

------------------------------------------------------------------------
r1646 | lordhavoc | 2002-03-14 05:30:03 -0800 (Thu, 14 Mar 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/makefile
   D /trunk/darkplaces/r_particles.c

Merged r_particles.c back into cl_particles.c to reduce overhead (renderparticle stuff is gone now)

------------------------------------------------------------------------
r1645 | lordhavoc | 2002-03-13 16:04:15 -0800 (Wed, 13 Mar 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

MOVETYPE_STEP entities should now fall when support is removed (even if it is not a MOVETYPE_PUSH object beneath them), and fish fall if in the air

------------------------------------------------------------------------
r1644 | lordhavoc | 2002-03-13 16:02:34 -0800 (Wed, 13 Mar 2002) | 3 lines
Changed paths:
   M /trunk/darkplaces/world.c

skip bbox check on bmodels because it is fast enough to trace against their hull and has less problem cases
commented out no longer useful clip.trace.allsolid check in SV_Move

------------------------------------------------------------------------
r1643 | lordhavoc | 2002-03-13 15:59:09 -0800 (Wed, 13 Mar 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_sprites.c

sprite code now uses left vector instead of right, and upright facing sprites now work correctly

------------------------------------------------------------------------
r1642 | lordhavoc | 2002-03-13 15:57:42 -0800 (Wed, 13 Mar 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

fog water when r_wateralpha is 1

------------------------------------------------------------------------
r1641 | lordhavoc | 2002-03-13 15:56:41 -0800 (Wed, 13 Mar 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

greatly improved chances of an entity being visible (in traceline test), checks nearest point (typically corner) on bbox as well as a random trace

------------------------------------------------------------------------
r1640 | lordhavoc | 2002-03-13 05:58:20 -0800 (Wed, 13 Mar 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/world.c

fix for fall-through-floor-when-embedded-in-another-entity situation (now the entity only falls through entities it is embedded in, and blocks on all others), and another fix for grenade bounce sound, also some cleanup of the toss physics code, and corpses no longer block against eachother

------------------------------------------------------------------------
r1639 | lordhavoc | 2002-03-13 05:46:05 -0800 (Wed, 13 Mar 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile

added athlon CPU choice (for gcc 2.96 and up)

------------------------------------------------------------------------
r1637 | lordhavoc | 2002-03-13 04:23:18 -0800 (Wed, 13 Mar 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

fixed grenades to behave more like quake again (60 normal-dot-velocity tolerance for stopping), fixed continuous bounce sound (repeated touch when sitting on floor), you can now walk on SOLID_SLIDEBOX/SOLID_BBOX objects (like in Q2/Q3), if two objects are stacked and the bottom one moves out from under, the top one will fall (always wished quake would do that)

------------------------------------------------------------------------
r1636 | lordhavoc | 2002-03-13 02:41:45 -0800 (Wed, 13 Mar 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

knight/scrag/vore trail effects are half as intense now

------------------------------------------------------------------------
r1634 | lordhavoc | 2002-03-12 21:56:20 -0800 (Tue, 12 Mar 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_wgl.c

whoever last modified this forgot a rather important ;

------------------------------------------------------------------------
r1632 | lordhavoc | 2002-03-12 09:14:29 -0800 (Tue, 12 Mar 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

more subtle rocket smoke

------------------------------------------------------------------------
r1631 | lordhavoc | 2002-03-12 08:57:26 -0800 (Tue, 12 Mar 2002) | 15 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/image.h
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/net_dgrm.c
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_light.h
   M /trunk/darkplaces/vid_wgl.c

added cl_particles_blood_size_min, cl_particles_blood_size_max, and cl_particles_blood_alpha cvars
changed trails back to quake-style (spawn over distance, not over time)
pt_fade now takes a fade rate (in p->time2)
many tweaks to particle effets
loading screens work correctly now
cleaned up backend code a bit, now does not freak out if a texture upload occurs during rendering
added r_quickmodels (default: on) which makes single-pass models (the vast majority of models) store vertex data directly into the backend arrays (using R_Mesh_Draw_GetBuffer)
model vertex transforms are now applied *after* lighting, this avoids transforming the normals, and prepares for someday adding transforms to the backend
fixed view blend in gl_rmain.c to work correctly with fov values above 90
moved image resampling and mipmapping from gl_textures.c to image.c
now updates screen twice while connecting to a server (so it displays the 'trying...' messages)
improved directional shading of explosions
disabled r_lightmodelhardness since the default was nearly 1.0 anyway, 1.0 is a special quick case
R_LightModel now tints the model and can accept vertices/normals in either model or world coordinates (previously required world coordinates)

------------------------------------------------------------------------
r1614 | lordhavoc | 2002-03-09 21:04:22 -0800 (Sat, 09 Mar 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

check for empty submodels (lacrima.bsp for example)

------------------------------------------------------------------------
r1608 | lordhavoc | 2002-03-04 03:10:53 -0800 (Mon, 04 Mar 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_explosion.c

slowed down explosion so it lasts about as long as the light flash

------------------------------------------------------------------------
r1607 | lordhavoc | 2002-03-04 03:09:40 -0800 (Mon, 04 Mar 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

greatly improved movetype bounce stopping check to consider the angle of the surface

------------------------------------------------------------------------
r1606 | lordhavoc | 2002-03-04 03:08:20 -0800 (Mon, 04 Mar 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

don't send entities outside addressable origin range (+-32767)

------------------------------------------------------------------------
r1600 | lordhavoc | 2002-03-01 04:53:52 -0800 (Fri, 01 Mar 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

fix for being stuck on a loading screen when it could not find the map (and any other such failures)

------------------------------------------------------------------------
r1599 | lordhavoc | 2002-03-01 04:52:43 -0800 (Fri, 01 Mar 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

added Texture Combine option to menu

------------------------------------------------------------------------
r1598 | lordhavoc | 2002-03-01 04:27:33 -0800 (Fri, 01 Mar 2002) | 20 lines
Changed paths:
   M /trunk/darkplaces/cl_demo.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/screen.h
   M /trunk/darkplaces/vid_3dfxsvga.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_wgl.c

reenabled loading plaques (and cleaned up that code a lot)
moved screenshot/envmap code from gl_backend.c to cl_screen.c (except for the GL SCR_ScreenShot function of course)
cleaned up trailing whitespace in console.c
backend between-batch overhead is now pretty much non-existent (set up state at start of frame, keep it until end of 3D rendering)
default batch size is now 0 triangles (never batch)
index array is not offset for first mesh in batch (which might be the only mesh in the batch)
does not lock arrays until it tries to render the first mesh
moved GL_LockArray/GL_UnlockArray from gl_models.c to gl_backend.c
made GL calls in r_sky.c unnecessary (now uses R_Mesh_ClearDepth)
made every enum in GL_PrintError (used by CHECKGLERROR) optional, for consistency (not that any GL headers would lack most of them)
inlined MYgluPerspective
removed a few unnecessary GL calls in frame setup code
reformatted uses of CHECKGLERROR to be on the same line as the function they are checking (looks cleaner)
increased MAX_TEXTUREUNITS from 4 to 8 (not that there is any code trying to use more than 2 textures anyway)
calling R_RenderView with no worldmodel is no longer fatal (just returns)
R_Mesh_Clear renamed to R_Mesh_Start
R_Mesh_Finish added (ends 3D rendering)
cleaned up some cruft in screen.h
moved gldepthmin/max from vid_ files to gl_backend, and then commented it out anyway (not currently used)

------------------------------------------------------------------------
r1596 | lordhavoc | 2002-02-28 16:13:42 -0800 (Thu, 28 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile.mingw

changed mingw makefile to by default not compile for any specific processor

------------------------------------------------------------------------
r1595 | lordhavoc | 2002-02-28 02:36:58 -0800 (Thu, 28 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rsurf.c

fixed fogging on models and opaque liquids (teleport/lava)

------------------------------------------------------------------------
r1594 | lordhavoc | 2002-02-28 02:35:32 -0800 (Thu, 28 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_sprites.c

made sprite interpolation optional with a #define (enabled currently, looks too bad ingame without it)

------------------------------------------------------------------------
r1593 | lordhavoc | 2002-02-27 23:15:41 -0800 (Wed, 27 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/vid_shared.c

fixed some majorly messed up fixes to the angle clamping

------------------------------------------------------------------------
r1592 | lordhavoc | 2002-02-27 22:43:22 -0800 (Wed, 27 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c

fixed some sloppyness in my earlier input merging

------------------------------------------------------------------------
r1590 | lordhavoc | 2002-02-27 18:58:30 -0800 (Wed, 27 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/conproc.c
   M /trunk/darkplaces/in_win.c
   M /trunk/darkplaces/makefile.mingw
   M /trunk/darkplaces/snd_win.c

fix mingw warnings

------------------------------------------------------------------------
r1589 | lordhavoc | 2002-02-27 17:38:47 -0800 (Wed, 27 Feb 2002) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/in_svgalib.c
   M /trunk/darkplaces/in_win.c
   M /trunk/darkplaces/input.h
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_shared.c

cleaned up mouse input system
fixed a bug with svc_setangle on pitch (it was immediately getting clamped in some cases, which made it quite useless)

------------------------------------------------------------------------
r1583 | lordhavoc | 2002-02-26 21:07:47 -0800 (Tue, 26 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cd_win.c

fixed warnings in mingw

------------------------------------------------------------------------
r1582 | lordhavoc | 2002-02-26 21:06:45 -0800 (Tue, 26 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/winquake.h

removed unneeded protocol

------------------------------------------------------------------------
r1581 | lordhavoc | 2002-02-26 20:57:43 -0800 (Tue, 26 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

added glFlush call when done feeding geometry, to get a very nice speed boost, and removed unnecessary glFinish (since VID_Finish does one itself)

------------------------------------------------------------------------
r1580 | lordhavoc | 2002-02-26 20:00:45 -0800 (Tue, 26 Feb 2002) | 2 lines
Changed paths:
   A /trunk/darkplaces/makefile.mingw
   A /trunk/darkplaces/mingw_note.txt

darkplaces now compiles in mingw

------------------------------------------------------------------------
r1579 | lordhavoc | 2002-02-26 19:58:07 -0800 (Tue, 26 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/bspfile.h
   M /trunk/darkplaces/cd_linux.c
   M /trunk/darkplaces/cd_win.c
   M /trunk/darkplaces/cdaudio.h
   M /trunk/darkplaces/cgamevm.c
   M /trunk/darkplaces/cgamevm.h
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/cl_screen.h
   M /trunk/darkplaces/cl_tent.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/console.h
   M /trunk/darkplaces/crc.c
   M /trunk/darkplaces/crc.h
   M /trunk/darkplaces/fractalnoise.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/image.h
   M /trunk/darkplaces/mathlib.c
   M /trunk/darkplaces/mathlib.h
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/model_sprite.c
   M /trunk/darkplaces/modelgen.h
   M /trunk/darkplaces/net.h
   M /trunk/darkplaces/net_dgrm.c
   M /trunk/darkplaces/net_loop.c
   M /trunk/darkplaces/net_udp.c
   M /trunk/darkplaces/net_udp.h
   M /trunk/darkplaces/net_wins.c
   M /trunk/darkplaces/net_wins.h
   M /trunk/darkplaces/net_wipx.c
   M /trunk/darkplaces/net_wipx.h
   M /trunk/darkplaces/palette.c
   M /trunk/darkplaces/palette.h
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/pr_comp.h
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/pr_execprogram.h
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/r_clip.c
   M /trunk/darkplaces/r_crosshairs.c
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_particles.c
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/r_textures.h
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/sbar.c
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/snd_mem.c
   M /trunk/darkplaces/sound.h
   M /trunk/darkplaces/sv_light.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sys_win.c
   M /trunk/darkplaces/ui.c
   M /trunk/darkplaces/vid_3dfxsvga.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c
   M /trunk/darkplaces/wad.c
   M /trunk/darkplaces/wad.h
   M /trunk/darkplaces/winquake.h
   M /trunk/darkplaces/world.c
   M /trunk/darkplaces/zone.h

renamed byte to qbyte throughout engine to eliminate a mingw conflict

------------------------------------------------------------------------
r1578 | lordhavoc | 2002-02-26 15:20:50 -0800 (Tue, 26 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/world.c

hopeful fix for flymove !trace.ent error

------------------------------------------------------------------------
r1571 | lordhavoc | 2002-02-25 05:46:26 -0800 (Mon, 25 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/model_shared.c

removed a few CheckSentinelsGlobal calls to get a loading speedup

------------------------------------------------------------------------
r1570 | lordhavoc | 2002-02-25 04:58:23 -0800 (Mon, 25 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

removed gl_mesh_merge feature due to unknown buggyness

------------------------------------------------------------------------
r1569 | lordhavoc | 2002-02-25 04:52:56 -0800 (Mon, 25 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_alias.h
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/r_light.c

cleaned up backend code a bit more, added R_Mesh_Draw_GetBuffer (untested - returns addresses in geometry buffers to fill in, to save memcpy on singlepass objects), rewrote Q2 model loading (now Q2 models are the same as Q1 models after loading), removed Q2 model renderer (and good riddence!), changed aliasvert array from 3 float to 4 float alignment to make copies faster

------------------------------------------------------------------------
r1568 | lordhavoc | 2002-02-25 00:31:17 -0800 (Mon, 25 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/in_svgalib.c
   M /trunk/darkplaces/in_win.c
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_shared.c

added in_pitch_min and in_pitch_max cvars to limit pitch (default: -90 to +90)

------------------------------------------------------------------------
r1567 | lordhavoc | 2002-02-24 23:14:21 -0800 (Sun, 24 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

clean up

------------------------------------------------------------------------
r1566 | lordhavoc | 2002-02-24 19:47:56 -0800 (Sun, 24 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/render.h

removed mergesky code

------------------------------------------------------------------------
r1565 | lordhavoc | 2002-02-24 19:45:00 -0800 (Sun, 24 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/render.h

removed r_mergesky

------------------------------------------------------------------------
r1564 | lordhavoc | 2002-02-24 18:06:58 -0800 (Sun, 24 Feb 2002) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/view.c

removed gl_viewmodeldepthhack
fixed gl_mesh_merge bug (which was causing bizarre glitchs)
added mesh index validation when DEBUGGL is enabled

------------------------------------------------------------------------
r1563 | lordhavoc | 2002-02-24 15:48:19 -0800 (Sun, 24 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

improved internal texture management error messages

------------------------------------------------------------------------
r1562 | lordhavoc | 2002-02-24 15:40:11 -0800 (Sun, 24 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_particles.c
   M /trunk/darkplaces/r_sprites.c

Forgot to commit removal of DrawDecal

------------------------------------------------------------------------
r1560 | lordhavoc | 2002-02-23 23:22:42 -0800 (Sat, 23 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h

restructured transparent mesh processing to do conversion from straight index list to transtris during AddTransparent

------------------------------------------------------------------------
r1557 | lordhavoc | 2002-02-23 21:06:26 -0800 (Sat, 23 Feb 2002) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

cleaned up lots of unused code, restructured where certain operations are done (index lists are now relative to mesh->firstvert until R_Mesh_Render, for instance)
working toward major speed gains by avoiding geometry copying

------------------------------------------------------------------------
r1556 | lordhavoc | 2002-02-23 14:48:03 -0800 (Sat, 23 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

cleanup of float/byte colors, now colors are always floats until R_Mesh_Render converts them to bytes before use

------------------------------------------------------------------------
r1555 | lordhavoc | 2002-02-23 14:00:46 -0800 (Sat, 23 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_explosion.c

fix for explosions sometimes not being freed at very high framerates

------------------------------------------------------------------------
r1554 | lordhavoc | 2002-02-23 02:50:01 -0800 (Sat, 23 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c

CRITICAL fix to checkextension function, it absolutely did not work until this fix.

------------------------------------------------------------------------
r1553 | lordhavoc | 2002-02-23 01:35:29 -0800 (Sat, 23 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/world.c

major cleanup to pusher and SV_Move code, major fixes to pusher code (everything should work right now)

------------------------------------------------------------------------
r1552 | lordhavoc | 2002-02-23 01:32:50 -0800 (Sat, 23 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_edict.c

whitespace

------------------------------------------------------------------------
r1551 | lordhavoc | 2002-02-23 01:31:47 -0800 (Sat, 23 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_crosshairs.c

improved client number check to prevent potential crashs

------------------------------------------------------------------------
r1550 | lordhavoc | 2002-02-23 01:30:15 -0800 (Sat, 23 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c

removed -zone mention from SZ_GetSpace overflow error

------------------------------------------------------------------------
r1549 | lordhavoc | 2002-02-22 02:41:18 -0800 (Fri, 22 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_explosion.c

fixed bugs with explosion intensity shading according to view direction

------------------------------------------------------------------------
r1544 | molivier | 2002-02-20 00:59:38 -0800 (Wed, 20 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c

Modified 3 casts to get rid of a few warnings in MSVC6.

------------------------------------------------------------------------
r1543 | lordhavoc | 2002-02-20 00:08:01 -0800 (Wed, 20 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile

changed clean to delete *.o

------------------------------------------------------------------------
r1539 | lordhavoc | 2002-02-19 02:56:54 -0800 (Tue, 19 Feb 2002) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/in_svgalib.c
   M /trunk/darkplaces/in_win.c
   M /trunk/darkplaces/net_dgrm.c
   M /trunk/darkplaces/net_loop.c
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_user.c
   M /trunk/darkplaces/vid_glx.c

added viewzoom extension to QC and client (smooth sniper zooming, with sensitivity scaling)
protocol should be able to masq now (not a perfect fix like net_chan, but a fix for most people - I hope) - server waits to send serverinfo until first reply from client (any clc_ message will do), client spams clc_nop every 3 seconds until it gets serverinfo (FIXME: maybe only once would do?)
upgraded aiming angles sent from client to floats in DPPROTOCOL_VERSION2 mode
updated cl_shownet 2 svc name list in cl_parse.c (it was quite outdated)

------------------------------------------------------------------------
r1537 | molivier | 2002-02-18 02:49:31 -0800 (Mon, 18 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.dsp

Updated DSP file

------------------------------------------------------------------------
r1534 | lordhavoc | 2002-02-17 22:35:09 -0800 (Sun, 17 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/chase.c
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_user.c
   M /trunk/darkplaces/view.c

new entity protocol, GREATLY improved over quake, massive net traffic reduction

------------------------------------------------------------------------
r1533 | lordhavoc | 2002-02-17 20:57:58 -0800 (Sun, 17 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

fixed dedicated erroring on startup

------------------------------------------------------------------------
r1530 | lordhavoc | 2002-02-17 12:56:00 -0800 (Sun, 17 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/protocol.h

new entity protocol nearly complete, but still unused

------------------------------------------------------------------------
r1527 | lordhavoc | 2002-02-15 15:50:36 -0800 (Fri, 15 Feb 2002) | 3 lines
Changed paths:
   M /trunk/darkplaces/cd_linux.c
   M /trunk/darkplaces/cd_win.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/snd_dma.c
   M /trunk/darkplaces/sound.h

changed bgmvolume/volume to always be registered, sliders for them always work (even with -nosound), but the items are displayed ghosted if -nosound or -nocdaudio is used
changed all Cvar_SetValue calls to Cvar_SetValueQuick

------------------------------------------------------------------------
r1526 | lordhavoc | 2002-02-15 15:21:38 -0800 (Fri, 15 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/sys_linux.c

removed (unused) quake endscreen text

------------------------------------------------------------------------
r1525 | lordhavoc | 2002-02-15 15:16:06 -0800 (Fri, 15 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

reduced view warping when underwater

------------------------------------------------------------------------
r1524 | lordhavoc | 2002-02-15 15:15:20 -0800 (Fri, 15 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

disable sliders for volume and vgmvolume (CD volume) when they do not exist

------------------------------------------------------------------------
r1523 | lordhavoc | 2002-02-15 14:28:08 -0800 (Fri, 15 Feb 2002) | 20 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c
   M /trunk/darkplaces/cl_screen.h
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   D /trunk/darkplaces/gl_screen.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/palette.c
   M /trunk/darkplaces/palette.h
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/r_crosshairs.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/screen.h
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_3dfxsvga.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_wgl.c

moved a lot of 2D/screen stuff out of gl_screen.c into cl_screen.c
moved remainder of gl_screen.c into gl_backend.c
removed gl_screen.c
inlined GL_BrightenScreen in gl_draw.c
moved a lot of GL stuff out of gl_rmain.c into gl_backend.c
converted polyblend to R_Mesh based
replaced lighthalf/gl_lightmode with v_overbrightbits
renamed contrast to brightness, and brightness to contrast (to match monitor controls)
merged hardware and software brightness/contrast/gamma into v_contrast, v_brightness, v_gamma, etc, switchable using v_hwgamma (automatically forced off if hardware gamma support is unavailable)
added ghostable menu items (unavailable gamma, for example)
rearranged options menu
2D resolution slider added (from 320x240 to full resolution)
fixed misuse of strncmp for bindings menu (thanks Elric)
adjustable crosshair size
renamed GL_BeginRendering to VID_GetWindowSize
renamed GL_EndRendering to VID_Finish
made screenshot and envmap share one function for grabbing images
moved underwater warping into cl_screen code
starting work on new entity protocol (not hooked up yet)

------------------------------------------------------------------------
r1522 | lordhavoc | 2002-02-15 13:40:24 -0800 (Fri, 15 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

particle tweaks

------------------------------------------------------------------------
r1521 | lordhavoc | 2002-02-15 13:33:31 -0800 (Fri, 15 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/chase.c

double precision RecursiveHullCheck

------------------------------------------------------------------------
r1520 | lordhavoc | 2002-02-15 13:29:45 -0800 (Fri, 15 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_particles.c

made smoke/blood texture a little brighter

------------------------------------------------------------------------
r1519 | lordhavoc | 2002-02-15 13:28:09 -0800 (Fri, 15 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

validate more when loading zymotic models, also reverse triangles so they don't render inside out (FIXME: fix this in the converter)

------------------------------------------------------------------------
r1518 | lordhavoc | 2002-02-15 13:27:00 -0800 (Fri, 15 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_light.c

made corona texture brighter, and rendering of it darker, fixes 'white' coronas around lava balls (they needed more overbright)

------------------------------------------------------------------------
r1517 | lordhavoc | 2002-02-15 13:25:43 -0800 (Fri, 15 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_move.c
   M /trunk/darkplaces/world.h

double precision RecursiveHullCheck

------------------------------------------------------------------------
r1516 | lordhavoc | 2002-02-15 13:21:31 -0800 (Fri, 15 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_models.c

cleaned up zym cruft from debugging

------------------------------------------------------------------------
r1515 | lordhavoc | 2002-02-15 13:20:12 -0800 (Fri, 15 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cvar.c
   M /trunk/darkplaces/cvar.h

added Cvar_SetQuick and Cvar_SetValueQuick (both take a cvar_t * instead of a name)

------------------------------------------------------------------------
r1514 | lordhavoc | 2002-02-15 13:19:04 -0800 (Fri, 15 Feb 2002) | 3 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/world.c

fixed rotating+moving pushers (teleport ball in end.bsp), cleaned up code a lot
double precision RecursiveHullCheck

------------------------------------------------------------------------
r1513 | lordhavoc | 2002-02-13 16:43:48 -0800 (Wed, 13 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_models.c

fixed zymotic model transforms (lots of cruft leftover that I will clean up soon)

------------------------------------------------------------------------
r1500 | eviltypeguy | 2002-02-06 17:18:22 -0800 (Wed, 06 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

Remove pointless and wasteful variable assignment

------------------------------------------------------------------------
r1497 | lordhavoc | 2002-02-05 07:22:07 -0800 (Tue, 05 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

check if model is NULL when doing trace checking

------------------------------------------------------------------------
r1496 | lordhavoc | 2002-02-04 19:08:32 -0800 (Mon, 04 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/world.c

cleaned up entity culling in server code, implemented new option - sv_cullentities_trace - traces a line from eye to random locations in the model box, if a trace succeeds it marks the entity visibility timeout for 1 second in the future, and if it fails and the timeout has expired by then, it culls the entity.  this method works great for most cases, and is far more aggressive (and faster) than pvs culling

------------------------------------------------------------------------
r1493 | molivier | 2002-02-04 02:36:23 -0800 (Mon, 04 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cgame.c
   M /trunk/darkplaces/darkplaces.dsp

Updated DSP file. Fixed a bunch of warnings with MSVC6

------------------------------------------------------------------------
r1487 | lordhavoc | 2002-02-03 08:51:30 -0800 (Sun, 03 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

fixed numerous bugs in SV_Trace_Toss

------------------------------------------------------------------------
r1486 | lordhavoc | 2002-02-03 08:50:42 -0800 (Sun, 03 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/progs.h

removed steporigin etc, they aren't used anymore

------------------------------------------------------------------------
r1485 | lordhavoc | 2002-02-03 03:34:53 -0800 (Sun, 03 Feb 2002) | 4 lines
Changed paths:
   D /trunk/darkplaces/cl_decals.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/makefile
   D /trunk/darkplaces/r_decals.c
   M /trunk/darkplaces/r_particles.c
   M /trunk/darkplaces/render.h

removed decals
fixed viewmodel disappearing with masked sky (skybox or skyquality 2)
removed flare particle from rockets (might add it back later)

------------------------------------------------------------------------
r1484 | lordhavoc | 2002-02-03 02:40:46 -0800 (Sun, 03 Feb 2002) | 6 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_screen.c

rearranged r_speeds report a bit, and split up reporting of meshtris into normal and transparent categories, also displays number of meshs of each type
made byte color array format work (byte format is very slightly faster than float)
disabled float color array format to save some memory
added gl_mesh_sorttransbymesh cvar (default: on) to get a performance gain in mingled mesh conditions (by never mingling triangles of different meshs), this mode can batch render transparent triangles too (unlike the other two modes)
increased default maxtriangles to 8192

------------------------------------------------------------------------
r1483 | lordhavoc | 2002-02-03 02:34:02 -0800 (Sun, 03 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile

changed back to profiling, with optimizations, and back to alsa 0.5 sound

------------------------------------------------------------------------
r1482 | lordhavoc | 2002-02-03 02:32:34 -0800 (Sun, 03 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

fixed monster interpolation in normal quake, which makes dpcrush not lerped unfortunately

------------------------------------------------------------------------
r1481 | lordhavoc | 2002-02-03 02:30:25 -0800 (Sun, 03 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_light.c

passing 0 time to CL_AllocDlight now gives a die time of 0, not cl.time + 0

------------------------------------------------------------------------
r1480 | lordhavoc | 2002-02-03 02:29:16 -0800 (Sun, 03 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

muzzleflashs do not keep stacking up on consecutive frames now

------------------------------------------------------------------------
r1479 | lordhavoc | 2002-02-03 02:27:54 -0800 (Sun, 03 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

moved viewmodel rendering to avoid polluting the main model rendering time

------------------------------------------------------------------------
r1478 | lordhavoc | 2002-02-03 02:26:48 -0800 (Sun, 03 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_light.c

removed some old commented out code

------------------------------------------------------------------------
r1477 | lordhavoc | 2002-02-03 02:25:45 -0800 (Sun, 03 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

lights should not decay now when console is down (pausing game), and cleaned up sound update call to not use renderer variables

------------------------------------------------------------------------
r1476 | lordhavoc | 2002-02-03 02:24:02 -0800 (Sun, 03 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_explosion.c

changed explosion color calculations, they look much better now

------------------------------------------------------------------------
r1475 | lordhavoc | 2002-02-03 02:23:09 -0800 (Sun, 03 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_light.c

made coronas small and intense, much more noticable now

------------------------------------------------------------------------
r1469 | lordhavoc | 2002-02-02 10:58:01 -0800 (Sat, 02 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_light.c

coronas now scale with the light radius

------------------------------------------------------------------------
r1468 | knghtbrd | 2002-02-01 07:28:42 -0800 (Fri, 01 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cgame.c

cgame.c:60: warning: implicit declaration of function `memset', fixed

------------------------------------------------------------------------
r1467 | knghtbrd | 2002-02-01 07:22:46 -0800 (Fri, 01 Feb 2002) | 2 lines
Changed paths:
   A /trunk/darkplaces/buildnumber.c
   M /trunk/darkplaces/cgamevm.h
   M /trunk/darkplaces/makefile

cgamevm.h:11:6: no newline at end of file, fixed.

------------------------------------------------------------------------
r1462 | lordhavoc | 2002-02-01 03:40:21 -0800 (Fri, 01 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cgame.c

added gib shower effect, they leave no trails but make blood marks where they hit...  (note: this is still highly experimental and cgame might be removed at some point, and no mods use this anyway)

------------------------------------------------------------------------
r1461 | lordhavoc | 2002-02-01 03:37:41 -0800 (Fri, 01 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cgame_api.h
   M /trunk/darkplaces/cgamevm.c

added CGVM_Stain function

------------------------------------------------------------------------
r1460 | lordhavoc | 2002-02-01 01:22:28 -0800 (Fri, 01 Feb 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

removed unnecessary if in setting up divide table for dlighting

------------------------------------------------------------------------
r1459 | molivier | 2002-01-31 23:20:26 -0800 (Thu, 31 Jan 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cgame.c
   M /trunk/darkplaces/cgamevm.c
   M /trunk/darkplaces/darkplaces.dsp
   M /trunk/darkplaces/gl_draw.c

Removed warnings in MSVC6. Updated the DSP file.

------------------------------------------------------------------------
r1452 | lordhavoc | 2002-01-31 08:41:59 -0800 (Thu, 31 Jan 2002) | 25 lines
Changed paths:
   A /trunk/darkplaces/builddate.c
   D /trunk/darkplaces/buildnum
   D /trunk/darkplaces/buildnumber.c
   A /trunk/darkplaces/cg_math.h
   A /trunk/darkplaces/cgame.c
   A /trunk/darkplaces/cgame_api.h
   A /trunk/darkplaces/cgamevm.c
   A /trunk/darkplaces/cgamevm.h
   M /trunk/darkplaces/chase.c
   M /trunk/darkplaces/cl_decals.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_tent.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/cvar.c
   M /trunk/darkplaces/fractalnoise.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/mathlib.c
   M /trunk/darkplaces/mathlib.h
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sys_shared.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/view.c
   M /trunk/darkplaces/zone.c

got rid of buildnumber.c and buildnum program, now uses builddate.c (touched each time it is built to keep the date changing)
clientside TraceLine can now hit brush model entities (TraceLine_ScanForBModels updates list of entities to check)
added *highly experimental* clientside gamecode (currently embedded in the engine, just trying things out) which currently doesn't do anything really
made CL_RelinkEntities only called when the client is connected and there is a world model
added fractalnoisequick (variant of fractalnoise that does not allocate/free a temporary buffer, and to achieve this does not use the range remapping)
added stainmap effects (stained lightmaps), which will probably soon replace decals
spark showers now pay attention to the velocity in the TE_SPARKSHOWER packet (if the mod uses this), bullet impacts still have no velocity
added TE_PLASMABURN (combination of TE_SMALLFLASH and a stain on the walls)
added svc_cgame (DO NOT USE THIS, EXPERIMENTAL, but so is the cgame code itself)
Cmd_TokenizeString now uses a fixed size buffer instead of many little allocations (speedup by not having Z_Malloc/Z_Free happening constantly)
cvar code tries very hard to avoid reallocating string now
va() function now uses a cycling set of 8 string buffers to try to avoid conflicts
console logging no longer uses va()
reduced default mesh buffer size from 21760 triangles to 4096 (transparent triangles are costly enough it's not a good idea to exceed this anyway)
texture management code now uses 3 memory pools to give better memory reports according to type of data
R_UpdateTexture has better memory behavior on non-procedural textures now (replaces inputtexels if it has not been uploaded yet, otherwise just uploads it directly)
added -developer commandline option (which is rather hacky) to force developer on for entire startup process, to get logging before the configs are read
decals stick to brush model entities now
stains stick to embedded bmodels (ones that are part of the map, not ones instanced from outside like ammo boxes)
skingroups above 0 are not automatically precached now (if you have a lot of mods installed in your id1 directory, they tend to not use all the skins, which is wasteful)
starting a new game (from the singleplayer menu) forces deathmatch and coop to 0 now
lightmaps are precached again (can't remember why I ever disabled this)
changed VectorSet's parameter order to be more consistent with other vector ops
removed a duplicate registration of the vid_mouse cvar (in vid_glx.c)

------------------------------------------------------------------------
r1451 | lordhavoc | 2002-01-31 04:16:59 -0800 (Thu, 31 Jan 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/net.h
   M /trunk/darkplaces/net_dgrm.c
   M /trunk/darkplaces/net_main.c

qsockets are now dynamically allocated/freed, this drops memory use by about 2mb

------------------------------------------------------------------------
r1447 | eviltypeguy | 2002-01-29 22:35:22 -0800 (Tue, 29 Jan 2002) | 4 lines
Changed paths:
   M /trunk/darkplaces/snd_dma.c

Fix for memset glibc bug crash

(why would it read from PROT_WRITE only memory? silly thing...)

------------------------------------------------------------------------
r1440 | lordhavoc | 2002-01-28 23:10:28 -0800 (Mon, 28 Jan 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_screen.c

changed free(dat) to Mem_Free(dat) (EWWW I HAD A FREE STILL??)

------------------------------------------------------------------------
r1434 | lordhavoc | 2002-01-28 01:09:03 -0800 (Mon, 28 Jan 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

replaced a bunch of one-line 3-statement while loops, with nicer looking one-line for loops

------------------------------------------------------------------------
r1424 | lordhavoc | 2002-01-27 00:33:58 -0800 (Sun, 27 Jan 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

fix problem with dynamic lights on lightmaps wider than 18 pixels (oops!)

------------------------------------------------------------------------
r1423 | lordhavoc | 2002-01-26 23:58:52 -0800 (Sat, 26 Jan 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_light.c

halved corona size

------------------------------------------------------------------------
r1418 | lordhavoc | 2002-01-26 16:16:17 -0800 (Sat, 26 Jan 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/buildnumber.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_light.h

added coronas (glow) to dynamic lights

------------------------------------------------------------------------
r1417 | lordhavoc | 2002-01-26 16:14:21 -0800 (Sat, 26 Jan 2002) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

added gl_mesh_dupetransverts cvar (found it is a slowdown though)
moved meshfarclip checking from R_Mesh_Draw to R_Mesh_Render

------------------------------------------------------------------------
r1415 | lordhavoc | 2002-01-26 15:36:03 -0800 (Sat, 26 Jan 2002) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

additive water
enabled transparency on world polygons (not a good idea in existing quake maps, but maybe someday...)

------------------------------------------------------------------------
r1414 | lordhavoc | 2002-01-26 15:33:42 -0800 (Sat, 26 Jan 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/r_particles.c

made most particles additive (speedup in fog)

------------------------------------------------------------------------
r1413 | lordhavoc | 2002-01-26 15:30:50 -0800 (Sat, 26 Jan 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_explosion.c

made explosions additive, softened edges (hacky but looks good enough), cleaned up some of the physics

------------------------------------------------------------------------
r1412 | lordhavoc | 2002-01-26 15:27:07 -0800 (Sat, 26 Jan 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/mathlib.c
   M /trunk/darkplaces/mathlib.h

changed most #define macros to use (,,,) format instead of {;;;} so they will gobble a ; like a normal function

------------------------------------------------------------------------
r1411 | lordhavoc | 2002-01-26 15:25:09 -0800 (Sat, 26 Jan 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_tent.c

got rid of cl_glowinglightning cvar, lightning no longer glows

------------------------------------------------------------------------
r1410 | lordhavoc | 2002-01-26 15:24:13 -0800 (Sat, 26 Jan 2002) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

made "entities" command show scale and alpha
made rocket glow a little brighter (25%)

------------------------------------------------------------------------
r1409 | lordhavoc | 2002-01-26 15:18:22 -0800 (Sat, 26 Jan 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/r_textures.h

renamed R_GetFragmentLocation to R_FragmentLocation

------------------------------------------------------------------------
r1397 | lordhavoc | 2002-01-25 18:20:13 -0800 (Fri, 25 Jan 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/view.c

due to Mercury's insistance you can disable bobbing by using cl_bobcycle == 0 as well as cl_bob == 0 (cl_bobcycle == 0 causes NaN bob)

------------------------------------------------------------------------
r1394 | molivier | 2002-01-25 04:33:35 -0800 (Fri, 25 Jan 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.dsp
   M /trunk/darkplaces/gl_backend.c

Updated MSVC6 project files. Vanilla MSVC6 doesn't know the GL_TABLE_TOO_LARGE error... Strange.

------------------------------------------------------------------------
r1393 | lordhavoc | 2002-01-25 00:31:35 -0800 (Fri, 25 Jan 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

added back intermission overlays (oops)

------------------------------------------------------------------------
r1391 | lordhavoc | 2002-01-24 16:45:55 -0800 (Thu, 24 Jan 2002) | 36 lines
Changed paths:
   M /trunk/darkplaces/buildnumber.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   A /trunk/darkplaces/cl_screen.c
   A /trunk/darkplaces/cl_screen.h
   M /trunk/darkplaces/cl_tent.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/console.h
   M /trunk/darkplaces/draw.h
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_screen.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/net_dgrm.c
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/r_crosshairs.c
   M /trunk/darkplaces/r_decals.c
   M /trunk/darkplaces/r_particles.c
   M /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/r_sprites.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/sbar.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/ui.c
   M /trunk/darkplaces/ui.h
   M /trunk/darkplaces/vid_wgl.c
   M /trunk/darkplaces/view.c
   D /trunk/darkplaces/view.h
   M /trunk/darkplaces/wad.c

added cl_screen.c/h (eventually most 2D stuff should be moved here)
removed view.h (merged into client.h)
cleaned up the animation interpolation code (CL_LerpUpdate) a bit more
increased interpolation 'teleport' tolerance from 400 units to 1000 units per frame
changed calls to Mod_ForName to not use checkdisk (except for viewthing model changes and map changes)
added viewent to r_refdef
moved v_blend to r_refdef
all 2D art now goes through Draw_CachePic
cachepic replaced qpic (in all non-wad code)
moved all engine generated pics (mousepointer, crosshairs) to gl_draw.c (they are called by Draw_CachePic)
cachepic now uses a hash lookup instead of just a string search
added drawqueue to r_refdef
all 2D art now goes through DrawQ_ functions (drawqueue)
DrawQ_String now stretchs the character texture a tiny bit, and always uses default filtering
cleaned out some old cruft in console drawing code
fixed some silly bugs in showfps
made showfps display use only 4 characters, and made the text larger, and moved it down a little
moved showfps from gl_screen.c to sbar.c
moved Draw_ConsoleBackground to console.c
removed drawinput parameter from Con_DrawConsole (it was always true)
c_alias_polys now counts all meshs rendered (a model may be rendered multiple times), not just the total number of triangles in the model, much more accurate
r_speeds2 renamed to r_speeds
disabled all Mem_CheckSentinelsGlobal calls during gameplay (they were wasting time)
r_speeds now displays time spent throughout SCR_UpdateScreen code, not just R_RenderView
frame is now rendered in 'finish begin render' order instead of 'begin render finish' order in SCR_Updatescreen - not sure if this is a speedup or not
BLOCK_SIZE in gl_textures.c renamed to block_size and now adjustable (r_max_scrapsize cvar), r_restart for changes to take effect, 1024 (default) or less recommended
menu, r_speeds, and showfps now have a darkened (50% black) background beneath them to improve readability
menu is now centered on the screen
menu text is now white
translatepic code now updates texture rather than constantly cache mismatching
cleaned up cshift code
cleaned up viewent setup code
W_GetLumpinfo failing to find a lump is no longer fatal
added R_Mesh_DrawDecal for the highly specialized task of adding decals/particles/sprites to the mesh system (trying to get a minor speed gain)
decals, particles, and sprites now use R_Mesh_DrawDecal

------------------------------------------------------------------------
r1386 | lordhavoc | 2002-01-21 23:01:30 -0800 (Mon, 21 Jan 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

moved CHECKGLERROR to detect errors *after* rather than before uploading a texture

------------------------------------------------------------------------
r1385 | lordhavoc | 2002-01-21 22:58:49 -0800 (Mon, 21 Jan 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_light.c

made lights half as bright

------------------------------------------------------------------------
r1384 | lordhavoc | 2002-01-21 21:36:02 -0800 (Mon, 21 Jan 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c

make dedicated work again

------------------------------------------------------------------------
r1383 | lordhavoc | 2002-01-21 21:34:21 -0800 (Mon, 21 Jan 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

fake answers for R_GetFragmentLocation when running dedicated

------------------------------------------------------------------------
r1382 | lordhavoc | 2002-01-21 21:33:30 -0800 (Mon, 21 Jan 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

models don't allocate a texture pool when running dedicated

------------------------------------------------------------------------
r1381 | lordhavoc | 2002-01-21 21:32:02 -0800 (Mon, 21 Jan 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_decals.c
   M /trunk/darkplaces/r_decals.c

more thorough checking of 'this should never happen' cases

------------------------------------------------------------------------
r1380 | lordhavoc | 2002-01-21 21:31:25 -0800 (Mon, 21 Jan 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

flush unused models when running dedicated server

------------------------------------------------------------------------
r1379 | lordhavoc | 2002-01-21 20:46:52 -0800 (Mon, 21 Jan 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fixed 4 warnings in MSVC related to assigning -1000 to unsigned shorts

------------------------------------------------------------------------
r1375 | lordhavoc | 2002-01-20 19:02:15 -0800 (Sun, 20 Jan 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

removed a lot of memory checks now that it works again

------------------------------------------------------------------------
r1374 | lordhavoc | 2002-01-20 18:57:28 -0800 (Sun, 20 Jan 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

fix for bug in memory checking

------------------------------------------------------------------------
r1373 | lordhavoc | 2002-01-20 18:50:07 -0800 (Sun, 20 Jan 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

yet more memory testing

------------------------------------------------------------------------
r1372 | lordhavoc | 2002-01-20 18:39:08 -0800 (Sun, 20 Jan 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

changed way windings are allocated, may fix memory corruption bug on MSVC

------------------------------------------------------------------------
r1371 | lordhavoc | 2002-01-20 18:09:24 -0800 (Sun, 20 Jan 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

added some memory corruption checks, trying to find a bug

------------------------------------------------------------------------
r1368 | lordhavoc | 2002-01-19 15:22:15 -0800 (Sat, 19 Jan 2002) | 3 lines
Changed paths:
   M /trunk/darkplaces/zone.c
   M /trunk/darkplaces/zone.h

improved error reporting on memory functions
memlist command now has an optional 'all' parameter to list the individual allocations inside pools

------------------------------------------------------------------------
r1367 | lordhavoc | 2002-01-19 13:36:53 -0800 (Sat, 19 Jan 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

rearranged error checking during portal building so it will only Host_Error when an error occurs, and changed tempmempool allocations for portal processing to use the loadmodel mempool so portals can be freed after an error (using modelflush)

------------------------------------------------------------------------
r1366 | lordhavoc | 2002-01-18 16:31:58 -0800 (Fri, 18 Jan 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/buildnumber.c
   M /trunk/darkplaces/cl_decals.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_tent.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/render.h

moved cl_visedicts to r_refdef.entities

------------------------------------------------------------------------
r1365 | lordhavoc | 2002-01-18 12:33:38 -0800 (Fri, 18 Jan 2002) | 5 lines
Changed paths:
   M /trunk/darkplaces/buildnumber.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/gl_screen.c
   M /trunk/darkplaces/r_particles.c
   M /trunk/darkplaces/render.h

cleaned up a lot of particle rendering properties (mainly related to rain code), rain looks nice now.
added depthdisable to rmeshinfo_t
gl_backend now uses glDrawRangeElements on non-win32 (need to use dynamic GL binding to get it on win32), nice speedup
rearranged r_speeds2 time reporting code, now times more things (in gl_screen.c especially)

------------------------------------------------------------------------
r1364 | lordhavoc | 2002-01-18 12:21:55 -0800 (Fri, 18 Jan 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_decals.c

minor optimization to fogged decal rendering

------------------------------------------------------------------------
r1363 | lordhavoc | 2002-01-18 12:20:08 -0800 (Fri, 18 Jan 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_models.c

view model is no longer fully fogged (it was a divide by zero)

------------------------------------------------------------------------
r1362 | lordhavoc | 2002-01-18 12:17:58 -0800 (Fri, 18 Jan 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

grenades no longer stick when you fire down a slope

------------------------------------------------------------------------
r1360 | molivier | 2002-01-17 09:38:45 -0800 (Thu, 17 Jan 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_backend.c

Fixed a couple of warnings on MSVC6

------------------------------------------------------------------------
r1353 | lordhavoc | 2002-01-16 17:30:08 -0800 (Wed, 16 Jan 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/buildnumber.c
   M /trunk/darkplaces/cl_parse.c

removed no longer used static light parsing code

------------------------------------------------------------------------
r1352 | lordhavoc | 2002-01-16 17:22:52 -0800 (Wed, 16 Jan 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/buildnumber.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/r_light.c

made directional static lighting work, then disabled it because it is not practical without reliable data from the lighting utility

------------------------------------------------------------------------
r1351 | lordhavoc | 2002-01-16 17:09:28 -0800 (Wed, 16 Jan 2002) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_particles.c

removed (experimental, and broken) particles with polygonal explosion (after some testing I found it looked lousy)
fixed particles disappearing when using slowmo 0

------------------------------------------------------------------------
r1350 | lordhavoc | 2002-01-16 12:31:44 -0800 (Wed, 16 Jan 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/buildnumber.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h

changed behavior about 'Bad Surfaces Extents', now only a warning, and such surfaces are rendered fullbright

------------------------------------------------------------------------
r1349 | lordhavoc | 2002-01-16 11:17:10 -0800 (Wed, 16 Jan 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.dsp

updated project to match added/removed files

------------------------------------------------------------------------
r1348 | lordhavoc | 2002-01-16 11:08:04 -0800 (Wed, 16 Jan 2002) | 4 lines
Changed paths:
   M /trunk/darkplaces/buildnumber.c
   M /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/gl_backend.c
   M /trunk/darkplaces/model_shared.c

hushed unitialized warning on end in cl_particles.c when using MSVC
fixed direct use of glActiveTextureARB/glClientActiveTextureARB
type cast parameters to glDepthMask

------------------------------------------------------------------------
r1347 | lordhavoc | 2002-01-16 10:47:28 -0800 (Wed, 16 Jan 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/buildnumber.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/vid_shared.c

fix for missing (byte *) cast, and fix for WIN32 function lookup code in vid_shared.c

------------------------------------------------------------------------
r1346 | lordhavoc | 2002-01-16 10:41:22 -0800 (Wed, 16 Jan 2002) | 2 lines
Changed paths:
   M /trunk/darkplaces/buildnumber.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_particles.c
   D /trunk/darkplaces/gl_poly.c
   D /trunk/darkplaces/gl_poly.h
   D /trunk/darkplaces/gl_warp.c

fixed a typo in cl_particles.c that happened to work in Linux (random() instead of rand()), removed unused files, and moved CL_UpdateTEnts call

------------------------------------------------------------------------
r1344 | lordhavoc | 2002-01-15 22:20:30 -0800 (Tue, 15 Jan 2002) | 2 lines
Changed paths:
   D /trunk/darkplaces/cl_effects.c
   D /trunk/darkplaces/r_decals.h

forgot to remove these

------------------------------------------------------------------------
r1343 | lordhavoc | 2002-01-15 22:16:58 -0800 (Tue, 15 Jan 2002) | 50 lines
Changed paths:
   M /trunk/darkplaces/buildnumber.c
   M /trunk/darkplaces/chase.c
   A /trunk/darkplaces/cl_decals.c
   M /trunk/darkplaces/cl_demo.c
   M /trunk/darkplaces/cl_light.c
   M /trunk/darkplaces/cl_light.h
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   A /trunk/darkplaces/cl_particles.c
   M /trunk/darkplaces/cl_tent.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/cmd.h
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/cvar.c
   M /trunk/darkplaces/cvar.h
   M /trunk/darkplaces/draw.h
   M /trunk/darkplaces/fractalnoise.c
   A /trunk/darkplaces/gl_backend.c
   A /trunk/darkplaces/gl_backend.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rmain.c
   D /trunk/darkplaces/gl_rmisc.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/gl_screen.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/glquake.h
   D /trunk/darkplaces/hcompress.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/image.h
   M /trunk/darkplaces/in_svgalib.c
   M /trunk/darkplaces/in_win.c
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/mathlib.c
   M /trunk/darkplaces/mathlib.h
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_alias.h
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/model_sprite.c
   M /trunk/darkplaces/model_sprite.h
   M /trunk/darkplaces/modelgen.h
   M /trunk/darkplaces/net_main.c
   M /trunk/darkplaces/palette.c
   M /trunk/darkplaces/palette.h
   M /trunk/darkplaces/portals.c
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/pr_exec.c
   A /trunk/darkplaces/pr_execprogram.h
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/quakeio.c
   M /trunk/darkplaces/r_clip.c
   M /trunk/darkplaces/r_crosshairs.c
   M /trunk/darkplaces/r_decals.c
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_lerpanim.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_light.h
   M /trunk/darkplaces/r_modules.c
   D /trunk/darkplaces/r_part.c
   A /trunk/darkplaces/r_particles.c
   A /trunk/darkplaces/r_sky.c
   M /trunk/darkplaces/r_sprites.c
   M /trunk/darkplaces/r_textures.h
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/sbar.c
   M /trunk/darkplaces/snd_dma.c
   M /trunk/darkplaces/snd_mem.c
   M /trunk/darkplaces/sound.h
   M /trunk/darkplaces/spritegn.h
   M /trunk/darkplaces/sv_light.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sv_user.c
   M /trunk/darkplaces/sys_linux.c
   M /trunk/darkplaces/sys_shared.c
   M /trunk/darkplaces/sys_win.c
   M /trunk/darkplaces/transform.c
   M /trunk/darkplaces/transform.h
   M /trunk/darkplaces/ui.c
   M /trunk/darkplaces/vid_3dfxsvga.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c
   M /trunk/darkplaces/view.c
   M /trunk/darkplaces/wad.c
   M /trunk/darkplaces/wad.h
   M /trunk/darkplaces/world.c
   M /trunk/darkplaces/world.h
   M /trunk/darkplaces/zone.c
   M /trunk/darkplaces/zone.h

rewrote memory system entirely (hunk, cache, and zone are gone, memory pools replaced them all)
models can be reloaded at any time (Mod_CheckLoaded, etc)
entire renderer can be restarted using r_restart command
batch triangle mesh rendering system (gl_backend.c)
most rendering code does not touch GL anymore
gl_textures now supports procedural textures, and fragment textures (small textures combined into larger images)
lightmaps can now be mipmapped (r_miplightmaps)
broke up r_part.c and r_decals.c into cl_particles.c, r_particles.c, cl_decals.c, and r_decals.c to improve renderer/client separation, but explosions are still renderer
moved CL_NextDemo from cl_main.c to cl_demo.c
cleaned up demo stop/disconnect code
removed render modules stuff from all cl_ files
renderer uses separate light array, and recalculates radius for lights based on color, and calculates subtract value to give it a soft edge at the radius perimeter
small surfaces do not use lightmaps (unfortunately they still look slightly different in dynamic lighting)
items can now bob according to cl_itembob* cvars
moved CL_SignonReply from cl_main.c to cl_parse.c
monster movement interpolation is now done clientside instead of serverside, Nehahra movie should look better now
cvars now have a .integer field containing the integer value of their string (nearly all .value accesses have been changed to .integer for speed reasons)
pmodel is now only available in Nehahra mode (pmodel was a bad hack)
r_farclip cvar removed, farclip now dynamically adjusts to level as you explore it
parsing of wad names out of HL maps is now in renderer code
changed isworldmodel stuff in model loading
cleaned up CL_ParseUpdate a bit (related to clientside monster interpolation)
renamed r_glowinglightning to cl_glowinglightning
moved FindNonSolidLocation to bmodel code
lightning beam models are now only looked up once
entity_t now contains an entity_persistent_t which holds data persistent from frame to frame (interpolation mainly), entity_render_t is wiped every frame
marked a lot more things as static
increased command buffer (script execution buffer) from 8k to 32k
COM_LoadMallocFile has been renamed to COM_LoadFile, and all other variants are gone
rounding on MSG_Read/Write stuff has been changed to fix negative rounding (C rounds toward zero, old code assumed it always rounded down)
improved cachepic (menu images) system to load from wad
statusbar now uses cachepic system
cachepics are cleared when renderer is restarted
fixed fog on transparent objects, should always look correct now
moved R_TimeRefresh_f from gl_rmisc.c to gl_rmain.c
moved R_NewMap from gl_rmisc.c to gl_rmain.c
deleted gl_rmisc.c
removed support for glfog
masked sky rendering is now done by first rendering the sky scene, clearing the depthbuffer, rendering invisible depth polys over it, then rendering the scene, this is for more flexibility
C-code based shader system (not scripted)
deleted hcompress.c
due to more thorough memory corruption detection, a (harmless with old zone system) buffer overflow bug in the client name command was fixed
untested (and quite possibly broken) quaternion math stuff added to mathlib.h
removed support for colormod entity effect (massive mess to support it everywhere)
improved QC PR_RunError reports
moved QC opcode execution loop into pr_execprogram.h, included multiple times
fairly major sbar cleanup
rearranged GL extension detection again
added EXT_texture_env_combine support

------------------------------------------------------------------------
r1296 | eviltypeguy | 2001-12-29 13:20:49 -0800 (Sat, 29 Dec 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c

Small fixes to tab completion

------------------------------------------------------------------------
r1260 | knghtbrd | 2001-12-17 00:25:27 -0800 (Mon, 17 Dec 2001) | 6 lines
Changed paths:
   M /trunk/darkplaces/buildnum/buildnum.c
   M /trunk/darkplaces/buildnumber.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/r_part.c
   M /trunk/darkplaces/vid_glx.c

-safe now does something approximately close to correct.  Not a full fix
for what it does and doesn't do, but this will suffice for now.  Added the
-nomouse flag to GLX.  Debugging is a bitch without it, really.  Also made
a few minor changes for gcc v3 building.  I'm not through with makefile
yet, though.

------------------------------------------------------------------------
r1256 | lordhavoc | 2001-12-13 10:24:05 -0800 (Thu, 13 Dec 2001) | 2 lines
Changed paths:
   A /trunk/darkplaces/buildnum/makefile

forgot to add this

------------------------------------------------------------------------
r1188 | molivier | 2001-12-04 23:06:27 -0800 (Tue, 04 Dec 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/darkplaces.dsp

Updated MSVC6 project files

------------------------------------------------------------------------
r1185 | lordhavoc | 2001-12-04 05:28:29 -0800 (Tue, 04 Dec 2001) | 67 lines
Changed paths:
   M /trunk/darkplaces/buildnumber.c
   M /trunk/darkplaces/chase.c
   M /trunk/darkplaces/cl_demo.c
   M /trunk/darkplaces/cl_effects.c
   A /trunk/darkplaces/cl_light.c
   A /trunk/darkplaces/cl_light.h
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_tent.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/draw.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_poly.c
   M /trunk/darkplaces/gl_poly.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rmisc.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/gl_screen.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/image.h
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/mathlib.c
   M /trunk/darkplaces/mathlib.h
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/model_sprite.c
   M /trunk/darkplaces/portals.c
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/r_clip.c
   M /trunk/darkplaces/r_crosshairs.c
   M /trunk/darkplaces/r_decals.c
   M /trunk/darkplaces/r_decals.h
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_lerpanim.c
   M /trunk/darkplaces/r_lerpanim.h
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_light.h
   M /trunk/darkplaces/r_part.c
   M /trunk/darkplaces/r_sprites.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/sbar.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sv_user.c
   M /trunk/darkplaces/sys.h
   M /trunk/darkplaces/sys_linux.c
   M /trunk/darkplaces/sys_shared.c
   M /trunk/darkplaces/sys_win.c
   M /trunk/darkplaces/transform.c
   M /trunk/darkplaces/transform.h
   M /trunk/darkplaces/ui.c
   M /trunk/darkplaces/ui.h
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_3dfxsvga.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_wgl.c
   M /trunk/darkplaces/view.c
   M /trunk/darkplaces/view.h
   M /trunk/darkplaces/world.c
   M /trunk/darkplaces/world.h

rewrote RecursiveHullCheck, no longer gets stuck on angle changes, and is generally more correct all the time (no longer uses PointContents checks either)
added content value to RecursiveHullCheck and TraceLine, they can now treat any content change as an impact
TraceLine now can take NULL impact and normal if they are not desired
TraceLine now sets trace_endcontents to the impacted content value
rewrote nehahra/rogue/hipnotic/standard_quake variables to be gamemode (GAME_NORMAL, GAME_HIPNOTIC, GAME_ROGUE, GAME_NEHAHRA, etc)
unfinished code for directional static lighting on models (CL_ParseEntityLump)
game now uses current mode as title everywhere (window title, server title, etc), so it would say 'DarkPlaces-Hipnotic' for example
added Draw_AdditiveString variant of Draw_String, switchs to additive blending and back to alpha afterward
engineversion string is now generated in sys_shared
major rewrite of transpolyrender, now uses glDrawElements (with batching of same texture/mode) and array locking
transpolyparticle added to quickly add particles to transpoly list (30% or so savings)
split wallpolyrender into two pieces, first renders walls, second renders fog over them, decals are rendered between the two, so decals are now fogged
added field of vision distortion when underwater (in MYgluPerspective)
changed gl_lightmapalign to align to the specified byte boundary instead of pixel boundary, and removed NVIDIA mentions (it is not their problem, it is a matter of the texture unpack alignment, but I stuck with 4 byte alignment because it is likely faster for most people)
fixed animating textures
rearranged a little bmodel code (probably no effect)
got rid of r_solidworldnode and r_pvsworldnode cvars (only the fastest choices are available now)
screenshots are now corrected to match lighthalf if it is being done using hardware gamma
removed some old unused cruft from host.c
added RGB gamma correction code to image.c
added VectorRandom to mathlib.h
model skins are no longer mipmapped by default (r_mipskins 0, but this is saved in configs so most people might not notice) because quake skins were not designed for it, and it is a 25% texture memory use increase on model skins
removed old unused Mod_FloodFillSkin code
transparent textures no longer clip other geometry in the hidden surface removal (ouch this was a bug)
maps should be able to use engine fields without the mod knowing about them now (alpha, etc), engine fields are appended to the list of progs fields
particle and decal textures are now all stored in one 'particle font' texture, for a rather hefty speed gain (no texture switchs)
all particles are now alpha blended (additive wasn't necessary on them, but is still available), to kill off state changes
new splash effect from raindrops
added a few bithacking float optimizations here and there (most with alternates if you define SLOWMATH)
new explosion effect (on by default, but a major speed drain, turn off with r_particles_explosions 0)
particle textures are now all in one image (a 'particle font'), massive speed gains with mixed particle types
all particles are alpha blend now (additive still supported, just not used), for more speed gains
particles now use 24bit RGB colors, rather than palette colors (the quake palette has been included however, because many particles still use it)
a lot of old cruft has been removed from r_part
ui items can now be strings rather than pics (actually they can be both, but I have not found a real use for this, perhaps a second draw location needs to be added for the string, so a button could have a label centered on it)
unfinished X11 gamma ramp support (need to allocate colors before setting them, haven't figured this out yet)
changed pitch range in GLX to let you look straight up and down, like in wgl version
mostly redesigned animation interpolation management code (R_LerpUpdate is now CL_LerpUpdate and performed on all network entities, R_LerpAnimation has been tweaked to not crash on bmodels and is now automatically used on all visible entities in the renderer, lerping info has has been split out of entity_render_t into entity_persistent_t so that entity_render_t contains no persistent data)
renderer now only uses entity_render_t structures
renderer now uses only currentrenderentity, and rarely passes individual properties around
cleaned out some old global variables relating to rendering
moved most of glquake.h to render.h
envmap is now actually a vaguely useful command (renders cubic environment map images of the current scene, changed to write tga images rather than raw rgba, and take a basename to use, and name them like skyboxes expect, and place them in the env directory)
many things that should be private to a particular file have been marked static
models now contain a SERAddEntity function (to add themselves to the SER clipping list to verify visibility)
models now contain DrawEarly and DrawLate functions (to render before and after wallpoly/decals/skypoly/etc, respectively)
dlight management functions moved out of cl_main and into cl_light
rewrote RelinkStaticEntities (does the same, just cleaner)
renamed RelinkEntities to RelinkNetworkEntities, split out LerpPlayerVelocity, and made a RelinkEntities function which calls the various functions
rewrote or altered portions of RelinkNetworkEntities relating to origin
muzzleflash lights are now clipped to keep them out of walls
fixed up code relating to vid.conwidth/height and vid.width/height (which is now gone, converted to vid.conwidth/height) and renamed glx/gly/glwidth/glheight to vid.realx/y/width/height (updated each frame using GL_BeginRendering)
rewrote most (all?) code relating to r_refdef, it is now always recalculated as well
dynamic lights will only update a lightmap if they actually alter it (optimization)
models now have 3 bounding boxes, used depending on angles (normal, yaw rotation only, and full rotation)
bmodel bounding boxes are recalculated from vertices
server now uses model bounding box instead of entity bounding box for visibility testing (since entity bounding box is often smaller)
server no longer portal-visibility checks entities because it was FAR too slow (sv_vischeckentities is still available though)
gl_rsurf code now relies on there being a currentrenderentity (even if it is cl.worldent.render), R_SetupWorldEnt added to avoid duplicate code for this
engine no longer has a version number, only build number
makefile now uses buildnum (as was originally intended) to increment build number every time it is compiled, build numbers will be rising rapidly from now on
timedemos will now force up console instantly
rocket trails are more dense
renamed VectorMA (function) to VectorMASlow, renamed VectorMAQuick (#define) to VectorMA, don't know why I had changed it before, had already cleaned up the parameter issues where it is used
converted most of lighting in decal code to integer
added support for all sprite types (untested)

------------------------------------------------------------------------
r1042 | lordhavoc | 2001-11-12 11:33:33 -0800 (Mon, 12 Nov 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

reenabled some invisible entity checking (probably no difference)

------------------------------------------------------------------------
r1039 | lordhavoc | 2001-11-12 07:52:13 -0800 (Mon, 12 Nov 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/ui.h

added comments about use of the functions, and regrouped engine-use-only ones to avoid confusion

------------------------------------------------------------------------
r1010 | lordhavoc | 2001-11-07 18:25:53 -0800 (Wed, 07 Nov 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_edict.c

got rid of two trigraph warnings in gcc 3.0

------------------------------------------------------------------------
r1009 | lordhavoc | 2001-11-07 18:23:00 -0800 (Wed, 07 Nov 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

changed swapintblock loop to hopefully get rid of a gcc 3.0 warning

------------------------------------------------------------------------
r1008 | lordhavoc | 2001-11-07 18:20:07 -0800 (Wed, 07 Nov 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_tent.c

fix for gcc 3.0 warnings on MSG_ReadByte in function parameters

------------------------------------------------------------------------
r1006 | molivier | 2001-11-05 23:16:21 -0800 (Mon, 05 Nov 2001) | 2 lines
Changed paths:
   A /trunk/darkplaces/darkplaces.dsp
   A /trunk/darkplaces/darkplaces.dsw

Added MSVC6 project files

------------------------------------------------------------------------
r1002 | lordhavoc | 2001-11-02 04:45:53 -0800 (Fri, 02 Nov 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_poly.c
   M /trunk/darkplaces/gl_poly.h

two-layer sky rendering now uses GL_ARB_texture_env_combine if available to render both layers in one pass (nice speedup), and sky rendering code has been simplified a little, also optimized the per vertex direction calculations to use RSqrt code instead of normal 1/sqrt

------------------------------------------------------------------------
r1001 | lordhavoc | 2001-11-02 03:06:35 -0800 (Fri, 02 Nov 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_shared.c

fixed gl_combine so it is enabled by default (if present)

------------------------------------------------------------------------
r1000 | lordhavoc | 2001-11-02 03:02:38 -0800 (Fri, 02 Nov 2001) | 5 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_3dfxsvga.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c

removed support for GL_SGIS_multitexture (ancient)
redesigned entire extension setup system (now resides only in vid_shared.c)
all extension functions are checked against NULL before the extension is enabled (if one is NULL it complains appropriately)
now also looks for glClientActiveTextureARB (needed for multitexture in vertex arrays)

------------------------------------------------------------------------
r999 | lordhavoc | 2001-11-02 02:54:24 -0800 (Fri, 02 Nov 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/sys_shared.c

minor buffer-size-safe improvement in Sys_Printf, and some other changes to it

------------------------------------------------------------------------
r998 | lordhavoc | 2001-11-02 02:52:41 -0800 (Fri, 02 Nov 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/chase.c

possible improvement to keep camera out of walls (still ends up in a wall occasionally, just less often)

------------------------------------------------------------------------
r997 | lordhavoc | 2001-11-02 02:50:43 -0800 (Fri, 02 Nov 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

corrected a typo in a comment referring to the e4 hall in start as e1m4

------------------------------------------------------------------------
r996 | lordhavoc | 2001-11-02 02:49:31 -0800 (Fri, 02 Nov 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

fix for misnumbered video mode menu in menu key code  (it should never be misnumbered again... it is now a calculated index)

------------------------------------------------------------------------
r995 | lordhavoc | 2001-11-02 01:18:47 -0800 (Fri, 02 Nov 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/keys.c

clear keybindings[] array during Key_Init (bounds checker freaks if it isn't cleared before it is used)

------------------------------------------------------------------------
r994 | lordhavoc | 2001-11-01 22:15:42 -0800 (Thu, 01 Nov 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile

changed -march=686 to -march=i686

------------------------------------------------------------------------
r988 | lordhavoc | 2001-10-30 13:55:46 -0800 (Tue, 30 Oct 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_poly.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/gl_screen.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/vid_shared.c

added support for GL_ARB_texture_env_combine, currently only used on wall rendering (for 4x overbright support)

------------------------------------------------------------------------
r987 | lordhavoc | 2001-10-30 13:51:37 -0800 (Tue, 30 Oct 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h

added support for transparent model skins

------------------------------------------------------------------------
r986 | lordhavoc | 2001-10-30 13:48:21 -0800 (Tue, 30 Oct 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/r_textures.h

added R_TextureHasAlpha function to check if a loaded texture has alpha

------------------------------------------------------------------------
r982 | lordhavoc | 2001-10-29 15:43:58 -0800 (Mon, 29 Oct 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/sys_shared.c

added include unistd.h and fcntl.h on non-win32

------------------------------------------------------------------------
r981 | lordhavoc | 2001-10-29 15:38:36 -0800 (Mon, 29 Oct 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/portals.c

removed unused portalstack array

------------------------------------------------------------------------
r978 | lordhavoc | 2001-10-28 23:23:10 -0800 (Sun, 28 Oct 2001) | 3 lines
Changed paths:
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/world.c

got rid of leafnums array in edict structure for pvs checking, pvs is now checked based on predicted locations of entities, and some reorganizational optimizations of WriteEntitiestoClient
changed an SV_Move call to use the proper MOVE_ define (no behavior change, only cleanup)

------------------------------------------------------------------------
r977 | lordhavoc | 2001-10-28 23:20:32 -0800 (Sun, 28 Oct 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_move.c

changed SV_Move calls to use MOVE_NORMAL or MOVE_NOMONSTERS instead of false/true as the type parameter (no behavior change, only cleanup)

------------------------------------------------------------------------
r976 | lordhavoc | 2001-10-28 23:17:36 -0800 (Sun, 28 Oct 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_edict.c

fixed ED_Print so that it can not cause buffer overflows on large entities

------------------------------------------------------------------------
r975 | lordhavoc | 2001-10-28 23:16:35 -0800 (Sun, 28 Oct 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/sys_linux.c
   A /trunk/darkplaces/sys_shared.c
   M /trunk/darkplaces/sys_win.c
   M /trunk/darkplaces/vid_wgl.c
   M /trunk/darkplaces/winquake.h

moved Sys_Printf and related code/data to sys_shared.c (new), removed all uses of isDedicated (replaced with cls.state == ca_dedicated), timestamps should work on all targets now, and made some minor whitespace changes

------------------------------------------------------------------------
r974 | lordhavoc | 2001-10-28 22:51:57 -0800 (Sun, 28 Oct 2001) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/palette.c

changing all isDedicated references to cls.state == ca_dedicated

also changed where Chase_Init is called in Host_Init (no behavior change, just cleanup)

------------------------------------------------------------------------
r973 | lordhavoc | 2001-10-28 22:45:08 -0800 (Sun, 28 Oct 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/mathlib.c

forgot to put a newline at the end of the file

------------------------------------------------------------------------
r972 | lordhavoc | 2001-10-28 22:43:57 -0800 (Sun, 28 Oct 2001) | 4 lines
Changed paths:
   M /trunk/darkplaces/sv_user.c

fixed input reading code bug in dedicated servers (clients are not kicked off immediately on connecting now...  clearly an important fix)
minor whitespace changes
and changed a SV_Move call to use MOVE_NOMONSTERS instead of 1, no effect on code behavior

------------------------------------------------------------------------
r971 | lordhavoc | 2001-10-28 22:40:05 -0800 (Sun, 28 Oct 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_phys.c

changed SV_Move call to use MOVE_NORMAL instead of false, no effect on code behavior

------------------------------------------------------------------------
r970 | lordhavoc | 2001-10-28 22:37:10 -0800 (Sun, 28 Oct 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c

changed SV_Move calls to always use the correct MOVE_ defines in the type parameter (true or false were often passed, due to a legacy of it being simply 'nomonsters', apparently during quake's development), no code change, just cleanup

------------------------------------------------------------------------
r969 | lordhavoc | 2001-10-28 22:34:57 -0800 (Sun, 28 Oct 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/portals.c

rearranged some variable declarations (no code changes)

------------------------------------------------------------------------
r968 | lordhavoc | 2001-10-28 22:32:06 -0800 (Sun, 28 Oct 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

minor whitespace tweak on loc1 label, removed old debugging warnings about not checking certain portals

------------------------------------------------------------------------
r967 | lordhavoc | 2001-10-28 22:30:27 -0800 (Sun, 28 Oct 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/mathlib.c

moved ixtable definition and initialization code to mathlib (and added Mathlib_Init call to common.c), fixes bugs in dedicated server (previously ixtable was being initialized in the renderer)

------------------------------------------------------------------------
r966 | lordhavoc | 2001-10-28 22:28:36 -0800 (Sun, 28 Oct 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c

removed duplicate comment on a line

------------------------------------------------------------------------
r965 | lordhavoc | 2001-10-28 22:27:54 -0800 (Sun, 28 Oct 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

changed way that "entities" (CL_PrintEntities_f) displays entities, and now skips inactive entities (forgot to update it's code a long time ago, apparently)

------------------------------------------------------------------------
r964 | lordhavoc | 2001-10-28 19:28:21 -0800 (Sun, 28 Oct 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/ui.c

no longer needs ui/mousepointer.lmp

------------------------------------------------------------------------
r963 | lordhavoc | 2001-10-28 19:11:26 -0800 (Sun, 28 Oct 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.h

fix for snprintf check (can't check if functions exist, changed to WIN32 check)

------------------------------------------------------------------------
r962 | lordhavoc | 2001-10-28 15:06:54 -0800 (Sun, 28 Oct 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/net_dgrm.c

fix for two Con_Printf calls that are passed a string as the format string

------------------------------------------------------------------------
r961 | lordhavoc | 2001-10-28 14:10:51 -0800 (Sun, 28 Oct 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/palette.c

don't change gamma ramps when running dedicated

------------------------------------------------------------------------
r960 | lordhavoc | 2001-10-28 12:49:16 -0800 (Sun, 28 Oct 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

added hidden surface removal option (r_ser cvar)

------------------------------------------------------------------------
r959 | lordhavoc | 2001-10-28 12:48:43 -0800 (Sun, 28 Oct 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.h

added #define snprintf _snprintf for win32

------------------------------------------------------------------------
r958 | lordhavoc | 2001-10-28 12:48:05 -0800 (Sun, 28 Oct 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/winquake.h

add externs for window_x and window_y

------------------------------------------------------------------------
r957 | lordhavoc | 2001-10-28 12:47:32 -0800 (Sun, 28 Oct 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/in_win.c

forgot to update this file apparently

------------------------------------------------------------------------
r956 | lordhavoc | 2001-10-28 01:18:01 -0800 (Sun, 28 Oct 2001) | 7 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/mathlib.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/render.h

made the Sorted Edge Rasterizer (hidden surface removal) optional as the r_ser cvar, can be a speed difference
added back the old portal-passage worldnode code (sometimes faster)
recalculate node bounding boxes when loading (based on leaf bounding boxes which are calculated from portal generation)
added untested code for qftol (much faster double to integer conversion on x86, not used yet)
added a couple Hunk_Check calls while loading things (just to be a little more paranoid)
minor whitespace cleanup, some commented out code removed

------------------------------------------------------------------------
r953 | lordhavoc | 2001-10-26 13:17:33 -0700 (Fri, 26 Oct 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/chase.c
   M /trunk/darkplaces/cl_effects.c
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_tent.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/cvar.c
   M /trunk/darkplaces/cvar.h
   M /trunk/darkplaces/draw.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_poly.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/gl_screen.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/in_svgalib.c
   M /trunk/darkplaces/in_win.c
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_sprite.c
   M /trunk/darkplaces/net_dgrm.c
   M /trunk/darkplaces/net_main.c
   M /trunk/darkplaces/palette.c
   A /trunk/darkplaces/portals.c
   A /trunk/darkplaces/portals.h
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/r_clip.c
   M /trunk/darkplaces/r_crosshairs.c
   M /trunk/darkplaces/r_decals.c
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_part.c
   M /trunk/darkplaces/r_sprites.c
   M /trunk/darkplaces/snd_dma.c
   M /trunk/darkplaces/spritegn.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sv_user.c
   A /trunk/darkplaces/ui.c
   A /trunk/darkplaces/ui.h
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/view.c

added CVAR_SAVE and CVAR_NOTIFY flags to cvar_t structure (at the beginning), updated all cvar definitions to match, a lot more cvars are saved now.\nadded server-side portal checking of entity visibility, only entities which really are visible are sent to clients now (some slowdown on server, but reduces network traffic and makes wallhacks useless)\nadded mostly untested mouse and keyboard user interface code (input support not completely finished yet, and no code using the UI yet)\n

------------------------------------------------------------------------
r939 | lordhavoc | 2001-10-18 07:48:51 -0700 (Thu, 18 Oct 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/buildnumber.c

Forgot to update build number for 105 release

------------------------------------------------------------------------
r937 | lordhavoc | 2001-10-17 17:59:02 -0700 (Wed, 17 Oct 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/r_explosion.c

probable fix for severe model rendering bugs in 3DFX voodoo4/5 win32 drivers, and G400 win32 drivers (they don't seem to handle a sizeof == 0 case for the array pointer stepping)

------------------------------------------------------------------------
r936 | lordhavoc | 2001-10-17 12:17:21 -0700 (Wed, 17 Oct 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_wgl.c

little whitespace change

------------------------------------------------------------------------
r935 | lordhavoc | 2001-10-17 12:15:55 -0700 (Wed, 17 Oct 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/in_svgalib.c
   M /trunk/darkplaces/in_win.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_shared.c

added force_centerview to glx (by moving it to vid_shared)

------------------------------------------------------------------------
r934 | lordhavoc | 2001-10-17 12:14:07 -0700 (Wed, 17 Oct 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/cvar.c

fix for cvar tab completion crash

------------------------------------------------------------------------
r933 | lordhavoc | 2001-10-17 11:43:57 -0700 (Wed, 17 Oct 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_sprites.c

fix for oriented sprites not appearing

------------------------------------------------------------------------
r929 | lordhavoc | 2001-10-16 05:49:07 -0700 (Tue, 16 Oct 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile

forgot to commit updated makefile

------------------------------------------------------------------------
r924 | lordhavoc | 2001-10-15 10:12:15 -0700 (Mon, 15 Oct 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/quakeio.c

mallocs, callocs, and frees changed to qmalloc/qfree

------------------------------------------------------------------------
r922 | lordhavoc | 2001-10-15 09:25:33 -0700 (Mon, 15 Oct 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c

fix for command/cvar/alias completion bug (example: imp gave iimpulse)

------------------------------------------------------------------------
r921 | lordhavoc | 2001-10-15 06:41:55 -0700 (Mon, 15 Oct 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/chase.c

changed defaults for chase_active camera position, and the settings are now saved to the config

------------------------------------------------------------------------
r920 | lordhavoc | 2001-10-15 06:41:25 -0700 (Mon, 15 Oct 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

move dynamic lights up 30 units for the client player when firstperson (so the gun gets lit by glow effects)

------------------------------------------------------------------------
r919 | lordhavoc | 2001-10-15 06:36:37 -0700 (Mon, 15 Oct 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

fix the off-by-one fix (oops)

------------------------------------------------------------------------
r918 | lordhavoc | 2001-10-15 06:23:19 -0700 (Mon, 15 Oct 2001) | 4 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_light.c

fix an off-by-one issue with model->numleafs in PVS related code (dynamic lighting and world rendering), numleafs excludes leaf 0, how strange...

no missing (black) leaf bug anymore...

------------------------------------------------------------------------
r917 | lordhavoc | 2001-10-15 05:13:20 -0700 (Mon, 15 Oct 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/cmd.h

added function definitions for tab completion back (oops)

------------------------------------------------------------------------
r915 | lordhavoc | 2001-10-15 04:46:20 -0700 (Mon, 15 Oct 2001) | 12 lines
Changed paths:
   M /trunk/darkplaces/buildnumber.c
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cmd.h
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rmisc.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/gl_screen.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/mathlib.c
   M /trunk/darkplaces/mathlib.h
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/quakeio.c
   M /trunk/darkplaces/quakeio.h
   A /trunk/darkplaces/r_clip.c
   A /trunk/darkplaces/r_clip.h
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_part.c
   M /trunk/darkplaces/r_sprites.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/snd_alsa_0_5.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_user.c
   M /trunk/darkplaces/sys_linux.c
   M /trunk/darkplaces/sys_win.c
   M /trunk/darkplaces/transform.c
   M /trunk/darkplaces/transform.h
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_3dfxsvga.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/view.c
   M /trunk/darkplaces/wad.c
   M /trunk/darkplaces/world.c

Major update, been neglecting CVS for some time...

clipping engine (r_clip.c) to determine exactly what is visible (this has altered MANY parts of the rendering engine)

fixed visibility bug with multiple players on a listen server

vid_glx.c has been improved/cleaned up greatly and now pays attention to vid_mouse and vid_dga and will not grab the mouse until after the first frame

snd_alsa_0_5.c has been fixed (Qprintf vs fprintf bug)

nehahra works again (was missing svc_skybox support)

------------------------------------------------------------------------
r270 | taniwha | 2001-07-20 13:25:17 -0700 (Fri, 20 Jul 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces
   M /trunk/darkplaces/.cvsignore

ignore ChangeLog

------------------------------------------------------------------------
r269 | taniwha | 2001-07-20 13:24:36 -0700 (Fri, 20 Jul 2001) | 4 lines
Changed paths:
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/cmd.h
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/console.h
   M /trunk/darkplaces/cvar.c
   M /trunk/darkplaces/cvar.h
   M /trunk/darkplaces/keys.c

very nice command line tab completeion from Shawn Walker
<eviltypeguy@qeradiant.com> with my later modifications so that commands
are completed as much as possible.

------------------------------------------------------------------------
r234 | lordhavoc | 2001-06-15 13:55:45 -0700 (Fri, 15 Jun 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_poly.c
   M /trunk/darkplaces/gl_poly.h
   M /trunk/darkplaces/render.h

another attempt to fix skybox loading

------------------------------------------------------------------------
r233 | taniwha | 2001-06-10 14:21:41 -0700 (Sun, 10 Jun 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

fix loading savegames

------------------------------------------------------------------------
r232 | lordhavoc | 2001-06-10 13:03:42 -0700 (Sun, 10 Jun 2001) | 3 lines
Changed paths:
   M /trunk/darkplaces/makefile

added -lz to the non-ALSA compile line, switched to non-ALSA compile by default (to match the sound driver default being non-ALSA)
added a lot of descriptive comments

------------------------------------------------------------------------
r231 | taniwha | 2001-06-07 12:38:17 -0700 (Thu, 07 Jun 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

apply a fix for LordHavoc as his tree is not yet ready for committing

------------------------------------------------------------------------
r230 | lordhavoc | 2001-06-07 12:36:56 -0700 (Thu, 07 Jun 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_poly.c

fix for skybox

------------------------------------------------------------------------
r229 | lordhavoc | 2001-06-03 16:40:51 -0700 (Sun, 03 Jun 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/world.h

added a newline to the end

------------------------------------------------------------------------
r228 | taniwha | 2001-06-02 20:18:25 -0700 (Sat, 02 Jun 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c

hopefully fix external file gzip support

------------------------------------------------------------------------
r227 | lordhavoc | 2001-05-30 19:02:16 -0700 (Wed, 30 May 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_poly.c

skyquality and mergesky are saved to the config now

------------------------------------------------------------------------
r226 | lordhavoc | 2001-05-30 01:36:08 -0700 (Wed, 30 May 2001) | 3 lines
Changed paths:
   M /trunk/darkplaces/image.c

fixed PCX loader bug to do with palettes
added bounds checking for PCX, TGA, and LMP loaders

------------------------------------------------------------------------
r225 | lordhavoc | 2001-05-30 01:28:52 -0700 (Wed, 30 May 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h

added loadsize variable set by COM_LoadFile

------------------------------------------------------------------------
r224 | lordhavoc | 2001-05-30 01:03:02 -0700 (Wed, 30 May 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.h

added newline at end to appease gcc

------------------------------------------------------------------------
r223 | lordhavoc | 2001-05-30 01:02:44 -0700 (Wed, 30 May 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/image.c

fix for mistake in pcx loader (had two pointers swapped)

------------------------------------------------------------------------
r222 | lordhavoc | 2001-05-30 00:09:03 -0700 (Wed, 30 May 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/buildnumber.c

increased build number to 103

------------------------------------------------------------------------
r221 | lordhavoc | 2001-05-30 00:08:19 -0700 (Wed, 30 May 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_poly.h
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/screen.h

added sky quality and show framerate options to menu

------------------------------------------------------------------------
r220 | taniwha | 2001-05-29 23:16:04 -0700 (Tue, 29 May 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces
   M /trunk/darkplaces/.cvsignore
   M /trunk/darkplaces/makefile

compile dependencies

------------------------------------------------------------------------
r219 | lordhavoc | 2001-05-29 23:04:58 -0700 (Tue, 29 May 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/in_win.c
   M /trunk/darkplaces/quakeio.c
   M /trunk/darkplaces/quakeio.h

fixes for zlib support, eliminated win32 FAR warnings and other warnings

------------------------------------------------------------------------
r218 | taniwha | 2001-05-29 22:10:29 -0700 (Tue, 29 May 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/sys_win.c

oops, forgot to fix the Qread and Qwrite calls

------------------------------------------------------------------------
r217 | lordhavoc | 2001-05-29 21:57:15 -0700 (Tue, 29 May 2001) | 6 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_poly.c
   M /trunk/darkplaces/gl_poly.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_warp.c
   M /trunk/darkplaces/render.h

rearranged sky rendering code
reenabled sky sphere code
added r_skyquality cvar (0 = no sky, higher values improve quality of quake sky rendering, no change to skybox)
sky sphere uses identical texture calculations as glquake style now
added r_mergesky cvar (speed loss in my testing, but could be useful for very low fillrate cards, albeit a bit jerky)

------------------------------------------------------------------------
r216 | lordhavoc | 2001-05-29 21:50:53 -0700 (Tue, 29 May 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/r_textures.h

added TEXF_ALWAYSPRECACHE

------------------------------------------------------------------------
r215 | taniwha | 2001-05-29 21:50:19 -0700 (Tue, 29 May 2001) | 3 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/image.c

check in LordHavoc's changes for him after cleaning up the mess of conflicts
I caused. I hope I got it right :)

------------------------------------------------------------------------
r214 | lordhavoc | 2001-05-29 21:50:11 -0700 (Tue, 29 May 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/glquake.h

removed unused skytexturenum

------------------------------------------------------------------------
r213 | lordhavoc | 2001-05-29 21:44:44 -0700 (Tue, 29 May 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmisc.c

removed unused skytexturenum code

------------------------------------------------------------------------
r212 | lordhavoc | 2001-05-29 21:39:22 -0700 (Tue, 29 May 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.h

commented out COM_LoadCacheFile

------------------------------------------------------------------------
r211 | lordhavoc | 2001-05-29 21:38:19 -0700 (Tue, 29 May 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/cmd.c

converted script loading to use COM_LoadMallocFile instead of COM_LoadHunkFile

------------------------------------------------------------------------
r210 | taniwha | 2001-05-29 19:36:15 -0700 (Tue, 29 May 2001) | 3 lines
Changed paths:
   M /trunk/darkplaces/cl_demo.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/cvar.c
   M /trunk/darkplaces/cvar.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/keys.h
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/menu.h
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/quakeio.c
   M /trunk/darkplaces/quakeio.h
   M /trunk/darkplaces/r_part.c
   M /trunk/darkplaces/snd_alsa_0_5.c
   M /trunk/darkplaces/snd_oss.c
   M /trunk/darkplaces/sys_linux.c
   M /trunk/darkplaces/sys_win.c
   M /trunk/darkplaces/wad.c

gzip support from quakeforge (QFile and friends). also includes a couple of
compile fixes

------------------------------------------------------------------------
r209 | lordhavoc | 2001-05-29 09:25:03 -0700 (Tue, 29 May 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/buildnumber.c

updated to build 102

------------------------------------------------------------------------
r208 | lordhavoc | 2001-05-29 09:00:56 -0700 (Tue, 29 May 2001) | 5 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/in_win.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/render.h

split render portion of entity_t struct into entity_render_t
got rid of glowsize and glowtrail fields in entity_render_t (since they were only used inside RelinkEntities anyway)
removed some commented out struct stuff
fixed mouse hide/show code in win32 (could get stuck shown)

------------------------------------------------------------------------
r207 | lordhavoc | 2001-05-26 19:50:48 -0700 (Sat, 26 May 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/cd_win.c
   M /trunk/darkplaces/cl_effects.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_poly.c
   M /trunk/darkplaces/gl_poly.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rmisc.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/gl_screen.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/gl_warp.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/in_svgalib.c
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/menu.h
   M /trunk/darkplaces/model_alias.h
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/model_sprite.h
   M /trunk/darkplaces/model_zymotic.h
   M /trunk/darkplaces/net.h
   M /trunk/darkplaces/net_dgrm.c
   M /trunk/darkplaces/net_udp.c
   M /trunk/darkplaces/net_wins.c
   M /trunk/darkplaces/net_wipx.c
   M /trunk/darkplaces/palette.c
   M /trunk/darkplaces/palette.h
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/r_crosshairs.c
   M /trunk/darkplaces/r_decals.c
   M /trunk/darkplaces/r_decals.h
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_modules.c
   M /trunk/darkplaces/r_modules.h
   M /trunk/darkplaces/r_part.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/snd_alsa_0_9.c
   M /trunk/darkplaces/snd_mix.c
   M /trunk/darkplaces/sound.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sv_user.c
   M /trunk/darkplaces/transform.c
   M /trunk/darkplaces/transform.h
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_3dfxsvga.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c
   M /trunk/darkplaces/view.c

cleaned up nearly all of the externs in .c files (moved to appropriate .h files)

------------------------------------------------------------------------
r206 | lordhavoc | 2001-05-26 15:24:12 -0700 (Sat, 26 May 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile

added protocol.o

------------------------------------------------------------------------
r205 | lordhavoc | 2001-05-26 12:44:32 -0700 (Sat, 26 May 2001) | 28 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_poly.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rmisc.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/gl_screen.c
   M /trunk/darkplaces/gl_warp.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/in_svgalib.c
   M /trunk/darkplaces/in_win.c
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_zymotic.h
   M /trunk/darkplaces/net_loop.c
   M /trunk/darkplaces/net_main.c
   M /trunk/darkplaces/net_wins.c
   M /trunk/darkplaces/palette.c
   M /trunk/darkplaces/palette.h
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/progs.h
   A /trunk/darkplaces/protocol.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/r_decals.c
   M /trunk/darkplaces/r_part.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/screen.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sv_user.c
   M /trunk/darkplaces/sys.h
   M /trunk/darkplaces/sys_linux.c
   M /trunk/darkplaces/sys_win.c
   D /trunk/darkplaces/sys_wind.c
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_3dfxsvga.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c
   M /trunk/darkplaces/view.c
   M /trunk/darkplaces/winquake.h

some whitespace changes
rearranged a few cvar definitions to be in more appropriate places
removed remnants of efrags system
added bitprofile command to report popularity of entity update components
fixed a number of baseline bugs and inconsistencies in the server and client (discovered using bitprofile)
general baseline generation code added (protocol.c)
added freelook cvar and menu option
exterior model capability added (so a model could be visible only when you are using chasecam, needed for visible weapon models)
fixed some inconsistencies in frame number sizes (should have been 16bit) in 16bit modelindex messages, and 8bit sound numbers that should have been 16bit
renamed Sys_FloatTime to Sys_DoubleTime
rewrote win32 Sys_DoubleTime code and minor work on UNIX Sys_DoubleTime
removed most of svc_entitiesbegin/svc_entitiesend code (big entity update protocol improvement planned)
hardware gamma/brightness/contrast support
hardware and software gamma/brightness/contrast adjustable in the menu
gl_lightmode (also known as lighthalf) switchable in the menu
can pick a crosshair in the menu
changed renderer references to r_refdef.vieworg to use r_origin instead
stripped out ancient transpoly code that was not being used
renamed qgamma array to texgamma
significant cleanup of mouse hide/show code in win32
improved eprint for better readability (better printing of floats/vectors)
added pr_fields and pr_globals commands to print a list of entity fields and global variables in loaded progs
moved some entity_state_t related stuff to protocol.c and protocol.h
made delta compression optional (sv_deltacompress cvar)
removed a lot of cruft
disabled stair step-up blending (never worked that well anyway)
removed sys_wind.c (I seriously doubt it worked)

------------------------------------------------------------------------
r204 | knghtbrd | 2001-05-26 11:26:59 -0700 (Sat, 26 May 2001) | 3 lines
Changed paths:
   M /trunk/darkplaces/makefile

Cleaned up clean target
Changed defaults to reflect the majority of systems

------------------------------------------------------------------------
r202 | lordhavoc | 2001-05-13 00:49:53 -0700 (Sun, 13 May 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

now renders inward portals rather than outward portals in r_drawportals (more useful)

------------------------------------------------------------------------
r201 | lordhavoc | 2001-05-12 08:31:17 -0700 (Sat, 12 May 2001) | 10 lines
Changed paths:
   M /trunk/darkplaces/buildnumber.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/world.c

build number 101
all leaf bounding boxes are recalculated based on portals (superior to qbsp's method)
bounding box removed from node structure
vismarkframe stuff removed from node and leaf structures
minor tweaking to some network stuff (trying to track down a bug)
R_BSPWorldmode and R_LeafWorldmode have been removed, related cvars have been removed
R_NoVisWorldnode is only used when in a solid leaf now
have been trying to track down very rare disappearing leaf bug in portal worldnode code (or portal building?), unsuccessfully
redesign of entity dlight code, much cleaner and saner (all dlight effects can be combined at once now as well, no override occurs)

------------------------------------------------------------------------
r200 | lordhavoc | 2001-05-12 04:09:25 -0700 (Sat, 12 May 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

forgot to put in extern qboolean hlbsp;

------------------------------------------------------------------------
r199 | lordhavoc | 2001-05-12 04:03:05 -0700 (Sat, 12 May 2001) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

disabled wad3 loading from "wad" key in worldspawn of map when not loading an HL map

minor tweaks to entity update range code

------------------------------------------------------------------------
r198 | lordhavoc | 2001-05-12 03:54:51 -0700 (Sat, 12 May 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile

removed net_vcr from the list of objects

------------------------------------------------------------------------
r197 | lordhavoc | 2001-05-11 01:27:05 -0700 (Fri, 11 May 2001) | 43 lines
Changed paths:
   M /trunk/darkplaces/buildnumber.c
   M /trunk/darkplaces/cl_demo.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/console.h
   M /trunk/darkplaces/gl_models.c
   D /trunk/darkplaces/gl_refrag.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rmisc.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/gl_screen.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/keys.c
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/r_decals.c
   M /trunk/darkplaces/r_decals.h
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_light.h
   M /trunk/darkplaces/r_part.c
   M /trunk/darkplaces/r_sprites.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/sbar.c
   M /trunk/darkplaces/screen.h
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/snd_dma.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sys.h
   M /trunk/darkplaces/sys_linux.c
   M /trunk/darkplaces/sys_win.c
   M /trunk/darkplaces/sys_wind.c
   M /trunk/darkplaces/view.c

***map loader generates portals for the map*** (can you tell this is a big deal? :)
increased build number to 100 (it's the truth)
made loadingplaque work correctly
disabled (commented out) loadingplaque
removed efrags
each model is checked against visible leafs (made efrags obsolete)
put .active field into client entity states (more correct than checking modelindex)
disabled all cachedir stuff (#if CACHEENABLE)
removed scr_copytop and other no-longer-relevant variables
removed Con_NotifyBox (wasn't used)
cleaned up visframe stuff
removed a lot of unnecessary fields from mnode_t and a few from mleaf_t
clarified r_visframecount stuff (now referred to as r_vismarkframecount, and similarly visframe field in mnode_t/mleaf_t is now called vismarkframe)
got rid of offsets[] array in texture_t
rewrote r_notexture_mip related code (fixing black default texture)
got rid of skyisvisible variable (check currentskypoly instead)
got rid of gl_texsort
simplified surface rendering process greatly (R_DrawSurfaces)
surface rendering should now be totally sequential (good for caches)
renamed r_newworldnode to r_leafworldnode (will be removed in next commit)
disabled r_oldclip code (will be removed in next commit)
renamed R_WorldNode to R_BSPWorldNode (will be removed in next commit)
renamed R_NewWorldNode to R_LeafWorldNode (will be removed in next commit)
made copy of R_WorldNode that ignores vis data, called R_NoVisWorldNode
added R_PortalWorldNode, 3-80% speed gain depending on situation, improved culling of non-relevant leafs/surfaces
added r_portalworldnode cvar to test new code (this will become the standard worldnode in next commit)
minor optimization to wateralpha code
minor redesign of R_TextureAnimation and animated texture stuff in texture_t
cleaned up timing issues in water (now synced to cl.time, not realtime) and menu code (now synced to realtime, not host_time)
removed host_time
removed SCR_ModalMessage (this got rid of the 'are you sure?' question on newgame)
changed quit messages
got rid of SCR_BringDownConsole
reorganized 2D screen drawing code (now draws console when loading plaque is displayed, etc)
some cleanup on texture loading
redesigned R_Decal to make use of BSP tree in finding nearest surfaces
renamed and redesigned R_DrawDecals to GL_DrawDecals and no longer uses transpoly
particles are now only rendered if inside a visible leaf
sprites are now only rendered if touching a visible leaf
ambient sounds no longer play after disconnecting
fixed severe delta compressed entity bugs in client
sped up MOVETYPE_NONE a bit

------------------------------------------------------------------------
r196 | lordhavoc | 2001-05-04 20:32:21 -0700 (Fri, 04 May 2001) | 3 lines
Changed paths:
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/net.h
   M /trunk/darkplaces/net_main.c

stripped out serial and modem stuff (was not supported anyway)
a little bit of new very incomplete menu code

------------------------------------------------------------------------
r195 | lordhavoc | 2001-05-04 11:52:30 -0700 (Fri, 04 May 2001) | 3 lines
Changed paths:
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sys_linux.c

No more busy-waiting when framerate cap is reached (in both Linux and win versions)
MOVETYPE_WALK on non-clients now links the edict like it should (major bugfix)

------------------------------------------------------------------------
r194 | lordhavoc | 2001-04-27 23:07:51 -0700 (Fri, 27 Apr 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/net_main.c
   D /trunk/darkplaces/net_vcr.c
   D /trunk/darkplaces/net_vcr.h
   M /trunk/darkplaces/sys_linux.c

removed unused net_vcr (and all other traces of vcr system), apparently a predecessor to quake demos

------------------------------------------------------------------------
r193 | lordhavoc | 2001-04-25 22:38:37 -0700 (Wed, 25 Apr 2001) | 7 lines
Changed paths:
   M /trunk/darkplaces/bspfile.h
   M /trunk/darkplaces/cl_effects.c
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_tent.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_refrag.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rmisc.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/mathlib.c
   M /trunk/darkplaces/mathlib.h
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_part.c
   M /trunk/darkplaces/r_sprites.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/sbar.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_move.c
   M /trunk/darkplaces/transform.c
   M /trunk/darkplaces/view.c

a big change with a little description...

rearranged client entity_t structure
redesigned entity update system (same protocol)
added support for split entity updates in the future for rate capping
glow trails and view relative entities should work now (untested)

------------------------------------------------------------------------
r192 | lordhavoc | 2001-04-23 15:49:56 -0700 (Mon, 23 Apr 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

oops, two loop counting bugs, fixed

------------------------------------------------------------------------
r191 | lordhavoc | 2001-04-23 15:03:00 -0700 (Mon, 23 Apr 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

added back support for textures smaller than 4 pixels wide (Nehahra uses one)

------------------------------------------------------------------------
r190 | lordhavoc | 2001-04-20 08:48:49 -0700 (Fri, 20 Apr 2001) | 31 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

added newmap function to render modules (so explosions and other things are reset on map load)
CL_AllocDlight redesigned (takes all settings for dlight on parameter line)
dlights now use a pointer to their owner entity instead of a key number
light emitting entities now glow properly (directional lighting disabled on the entity that owns the dlight)
cl_shownet no longer spews empty lines when recieving less updates from server than client framerate
some whitespace cleanup
fixed some missing parentheses on a condition in R_BuildLightmap (mixed &&, &, and ||, eek)
fixed vertex array problems with fog sky
increased MAX_TRANSPOLYS from 8192 to 65536
added a general purpose decal engine, superior to the decal particles (lower CPU use, better lighting)
added bullet hole decals and bullet hole texture generator
added r_speeds2 time reporting for moveexplosions, drawexplosions, and drawdecals
cleaned up dlight logic, all code now relies on radius, which is cleared when the dlight dies, this removed all potential flickering problems and offers a minor speedup
optimized R_ResampleTexture further to improve load times
moved heap size commandline parameter stuff from platform specific startup code to Host_Init, now all platforms understand -mem, -winmem, and -heapsize
WAD3 texture transparency now supported again
r_explosionclip cvar is now saved to config
r_drawexplosions cvar added
r_particles cvar is now saved to config
r_dynamicparticles cvar renamed to r_particles_lighting
r_particles_bloodshowers cvar added to disable blood shower effects
r_particles_blood cvar added to disable blood effects
r_particles_smoke cvar added to disable smoke effects
r_particles_sparks cvar added to disable spark effects
r_particles_bubbles cvar added to disable bubble effects
fixed smoke texture problem (0 alpha-noise portions were not written to texture, leaving portions of previous texture in buffer)
changed nearly every particle effect to look better and use less particles and fillrate, major speed gains resulted
blood particles no longer fade inflight as it made the effects less impressive and resulted in a lot of mostly transparent decals
major particle size bug fixed, all view aligned particles (everything but rain and decals) were 50% larger than they were supposed to be
particles now use transpolyvertub (unsigned byte colors) instead of transpolyvert for a speedup

------------------------------------------------------------------------
r189 | lordhavoc | 2001-04-20 08:38:28 -0700 (Fri, 20 Apr 2001) | 31 lines
Changed paths:
   M /trunk/darkplaces/cl_effects.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_tent.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/fractalnoise.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_poly.c
   M /trunk/darkplaces/gl_poly.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rmisc.c
   M /trunk/darkplaces/gl_screen.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/image.h
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/r_crosshairs.c
   A /trunk/darkplaces/r_decals.c
   A /trunk/darkplaces/r_decals.h
   M /trunk/darkplaces/r_explosion.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_light.h
   M /trunk/darkplaces/r_modules.c
   M /trunk/darkplaces/r_modules.h
   M /trunk/darkplaces/r_part.c
   M /trunk/darkplaces/r_sprites.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/snd_win.c
   M /trunk/darkplaces/sys_linux.c
   M /trunk/darkplaces/sys_win.c

added newmap function to render modules (so explosions and other things are reset on map load)
CL_AllocDlight redesigned (takes all settings for dlight on parameter line)
dlights now use a pointer to their owner entity instead of a key number
light emitting entities now glow properly (directional lighting disabled on the entity that owns the dlight)
cl_shownet no longer spews empty lines when recieving less updates from server than client framerate
some whitespace cleanup
fixed some missing parentheses on a condition in R_BuildLightmap (mixed &&, &, and ||, eek)
fixed vertex array problems with fog sky
increased MAX_TRANSPOLYS from 8192 to 65536
added a general purpose decal engine, superior to the decal particles (lower CPU use, better lighting)
added bullet hole decals and bullet hole texture generator
added r_speeds2 time reporting for moveexplosions, drawexplosions, and drawdecals
cleaned up dlight logic, all code now relies on radius, which is cleared when the dlight dies, this removed all potential flickering problems and offers a minor speedup
optimized R_ResampleTexture further to improve load times
moved heap size commandline parameter stuff from platform specific startup code to Host_Init, now all platforms understand -mem, -winmem, and -heapsize
WAD3 texture transparency now supported again
r_explosionclip cvar is now saved to config
r_drawexplosions cvar added
r_particles cvar is now saved to config
r_dynamicparticles cvar renamed to r_particles_lighting
r_particles_bloodshowers cvar added to disable blood shower effects
r_particles_blood cvar added to disable blood effects
r_particles_smoke cvar added to disable smoke effects
r_particles_sparks cvar added to disable spark effects
r_particles_bubbles cvar added to disable bubble effects
fixed smoke texture problem (0 alpha-noise portions were not written to texture, leaving portions of previous texture in buffer)
changed nearly every particle effect to look better and use less particles and fillrate, major speed gains resulted
blood particles no longer fade inflight as it made the effects less impressive and resulted in a lot of mostly transparent decals
major particle size bug fixed, all view aligned particles (everything but rain and decals) were 50% larger than they were supposed to be
particles now use transpolyvertub (unsigned byte colors) instead of transpolyvert for a speedup

------------------------------------------------------------------------
r188 | knghtbrd | 2001-04-05 20:51:39 -0700 (Thu, 05 Apr 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c

gl_mtex_enum has moved to vid_shared.c

------------------------------------------------------------------------
r187 | lordhavoc | 2001-04-05 20:49:40 -0700 (Thu, 05 Apr 2001) | 2 lines
Changed paths:
   A /trunk/darkplaces/cl_effects.c

missed this one...

------------------------------------------------------------------------
r186 | lordhavoc | 2001-04-05 20:48:40 -0700 (Thu, 05 Apr 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_part.c

added default case for particles to report the error and remove the particle

------------------------------------------------------------------------
r185 | knghtbrd | 2001-04-05 20:44:45 -0700 (Thu, 05 Apr 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/r_part.c

Fix a couple gcc warnings

------------------------------------------------------------------------
r184 | lordhavoc | 2001-04-05 20:43:36 -0700 (Thu, 05 Apr 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

fix for lightmap update check

------------------------------------------------------------------------
r183 | lordhavoc | 2001-04-05 20:10:06 -0700 (Thu, 05 Apr 2001) | 88 lines
Changed paths:
   D /trunk/darkplaces/anorms.h
   M /trunk/darkplaces/chase.c
   M /trunk/darkplaces/cl_demo.c
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_tent.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/cmd.h
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   D /trunk/darkplaces/cpu_noasm.c
   D /trunk/darkplaces/cpu_x86.bat
   D /trunk/darkplaces/cpu_x86.nasm
   D /trunk/darkplaces/cpu_x86.obj
   M /trunk/darkplaces/cvar.c
   M /trunk/darkplaces/cvar.h
   M /trunk/darkplaces/draw.h
   M /trunk/darkplaces/fractalnoise.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_poly.c
   M /trunk/darkplaces/gl_poly.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/gl_screen.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/gl_warp.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/image.h
   M /trunk/darkplaces/in_svgalib.c
   M /trunk/darkplaces/in_win.c
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/mathlib.c
   M /trunk/darkplaces/mathlib.h
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_alias.h
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/model_sprite.c
   M /trunk/darkplaces/model_sprite.h
   M /trunk/darkplaces/net.h
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/r_crosshairs.c
   M /trunk/darkplaces/r_explosion.c
   A /trunk/darkplaces/r_lerpanim.c
   A /trunk/darkplaces/r_lerpanim.h
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_light.h
   M /trunk/darkplaces/r_part.c
   M /trunk/darkplaces/r_sprites.c
   A /trunk/darkplaces/r_textures.h
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/snd_dma.c
   M /trunk/darkplaces/snd_mem.c
   M /trunk/darkplaces/snd_mix.c
   M /trunk/darkplaces/snd_win.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sv_user.c
   M /trunk/darkplaces/sys_win.c
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_3dfxsvga.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c
   M /trunk/darkplaces/view.c
   M /trunk/darkplaces/world.c
   M /trunk/darkplaces/zone.c

optimized AngleVectors calls (pass NULL for vectors that should not be generated)
added VectorVectors (takes a forward unit vector, makes right and up vectors)
corrected silly id spelling mistakes 'allready' and 'allways'
most host_frametime references changed to cl.frametime or sv.frametime
fixed movement interpolation in listen games (host client wasn't lerping the framerate capped server's frames)
added EF_FLAME effect, untested
changed svc_showlmp to use shorts, not bytes (except in nehahra compatibility mode)
broke svc_fog for now
removed svc_farclip
removed svc_playerposition
removed svc_skybox
increased maximum number of models and sounds to 1024 each (and added extra svc_ messages and update bits to handle the new limits)
made punchangle use preciseangles (on DP servers), added punchvector (view origin kick, useful for earthquakes?)
redesigned entire animation interpolation system (can lerp between independently playing framegroups)
redesigned animation scene lookup in model and sprite rendering to use a single system
added a simple clientside effect system (meant for playing sprite explosion animations entirely on the client, with very nice interpolation and framerate control)
added te_smallflash
added te_customflash
added te_flamejet (untested)
darkened lightning glow and made it adjustable (r_glowinglightning cvar is now a scaler, not just an option)
increased maximum number of clientside entities
COM_WriteFile will now create a path leading up to the file
removed cpu_*.* files
reorganized fractalnoise code, now behaves more correctly
stripped out qsg_version stuff, replaced by pr_checkextension and extensions have changed completely (extensions are documented in dpextensions.qc in DP mod and release zips)
made skin and sprite mipmapping optional (r_mipskins cvar, r_mipsprites cvar), saves about 32% of texture memory if disabled
rewrote texture management system (again), now uses flags to specify texture attributes (all textures without the PRECACHE flag are uploaded only when first used, conserves huge amounts of memory), and is cleaner code
r_precachetextures cvar controls how PRECACHE texture flag is used (0 = never precache, 1 = use PRECACHE flag, 2 = always precache)
changed way text filtering mode is decided
now requires vertex array support (standard in OpenGL 1.1 so this is not a problem)
takes advantage of GL_EXT_compiled_vertex_array extension (no speed gain for my Geforce2, may help other people)
reverted to GL transforms for models (no speed gain for my Geforce2, may help other people)
gl_transform cvar controls whether to use GL transforms (1) or software transforms (0), could not measure any speed difference in my testing
r_shadows removed due to GL transforms on models
model and sprite interpolation now handle 4 frame interpolation to accomodate new interpolation system
RSurf_Draw* functions greatly optimized
Host_Error will now Sys_Error rather than crash if Host_Frame has not yet been executed
cleaned up viewthing frame reporting code, now uses the new animation system
can now look directly up and down
ByteToNormal and NormalToByte added in mathlib.c, also moved anorms.h table to mathlib.c
added axial cases for BoxOnPlaneSide (BIG improvement)
trivert2 vertex format removed, now uses alias trivertx_t format as-is (33% less model memory usage and possibly quicker loading)
redesigned map texture loading again (particularly HL maps)
water is now lit on both sides
sprites are now cached like models
sprite loading redesigned to use new animation system
increased maximum packet size to accomodate the largest possible
PF_vectoyaw optimized a little
PF_vectoangles optimized a little
PF_findchain added
PF_findchainfloat added
PF_effect added
PF_te_blood added
PF_te_bloodshower added
PF_te_explosionrgb added
PF_te_particlecube added
PF_te_particlerain added
PF_te_particlesnow added
PF_te_spark added
PF_te_gunshotquad added
PF_te_spikequad added
PF_te_superspikequad added
PF_te_explosionquad added
PF_te_smallflash added
PF_te_customflash added
PF_te_gunshot added
PF_te_spike added
PF_te_superspike added
PF_te_explosion added
PF_te_tarexplosion added
PF_te_wizspike added
PF_te_knightspike added
PF_te_lavasplash added
PF_te_teleport added
PF_te_explosion2 added
PF_te_lightning1 added
PF_te_lightning2 added
PF_te_lightning3 added
PF_te_beam added
PF_vectorvectors added
increased maximum file path length
explosions are no longer round
removed LIGHTSCALE settings
removed r_donttransformmodels cvar
a lot of particle effect changes (bouncing sparks, blood sprays from gibs that stick on the walls)
fixed sound combining so it no longer plays past the end of the buffer
fixed sound resampling

------------------------------------------------------------------------
r182 | taniwha | 2001-04-05 10:51:30 -0700 (Thu, 05 Apr 2001) | 4 lines
Changed paths:
   A /trunk/darkplaces/quakeio.c
   A /trunk/darkplaces/quakeio.h

while not yet used (I'd forgotten how much side work was involved in getting
zlib support into quake), these will allow dp to use compressed paks :) The
rest will be coming as soon as I get everything working.

------------------------------------------------------------------------
r181 | dabb | 2001-03-15 08:19:13 -0800 (Thu, 15 Mar 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/dp-bc.mak

Compile fixes.

------------------------------------------------------------------------
r179 | lordhavoc | 2001-03-04 14:30:07 -0800 (Sun, 04 Mar 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.c

now supports upto 256x256 texel lightmaps (rather than 17x17), as_tundra.bsp works now

------------------------------------------------------------------------
r178 | lordhavoc | 2001-03-03 17:16:22 -0800 (Sat, 03 Mar 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/sys_wind.c

forgot this file while changing FALSE and TRUE to false and true

------------------------------------------------------------------------
r177 | lordhavoc | 2001-03-03 17:04:38 -0800 (Sat, 03 Mar 2001) | 4 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/conproc.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rmisc.c
   M /trunk/darkplaces/gl_warp.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/in_win.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/net_wins.c
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/r_part.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sys_win.c
   M /trunk/darkplaces/vid_wgl.c
   M /trunk/darkplaces/wad.c
   M /trunk/darkplaces/wad.h

rewrite of map texture loading (mainly to do with HL textures and wads)

and all FALSE and TRUE changed to false and true

------------------------------------------------------------------------
r176 | lordhavoc | 2001-03-03 14:49:59 -0800 (Sat, 03 Mar 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/wad.c

redesigned transparent HL texture checking again, now treats color 255 as transparent but only when the texture begins with a { character

------------------------------------------------------------------------
r175 | lordhavoc | 2001-03-03 14:10:56 -0800 (Sat, 03 Mar 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/wad.c

fixed transparent color in HL textures (was red, should be blue... oops)

------------------------------------------------------------------------
r174 | lordhavoc | 2001-03-03 14:02:34 -0800 (Sat, 03 Mar 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/view.c

server speed controls fade out of damage/bonus flashs now (more reliable timedemo)

------------------------------------------------------------------------
r169 | lordhavoc | 2001-03-02 14:14:49 -0800 (Fri, 02 Mar 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

a little cleanup, and eliminated a lightstyle buffer overflow

------------------------------------------------------------------------
r168 | lordhavoc | 2001-03-02 14:03:33 -0800 (Fri, 02 Mar 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

added DPPROTOCOL support to svc_version parsing (is svc_version even used?)

------------------------------------------------------------------------
r167 | lordhavoc | 2001-03-02 13:40:19 -0800 (Fri, 02 Mar 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

added a new hack to make MSVC work which will definitely not break any other compilers

------------------------------------------------------------------------
r166 | lordhavoc | 2001-03-02 13:28:43 -0800 (Fri, 02 Mar 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

removed hack to make MSVC work as it was breaking gcc

------------------------------------------------------------------------
r165 | lordhavoc | 2001-03-02 02:52:15 -0800 (Fri, 02 Mar 2001) | 13 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_tent.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/r_part.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/wad.c
   M /trunk/darkplaces/world.c
   M /trunk/darkplaces/zone.c

Coordinates are now floats in network protocol (bloats it yes, but the accuracy allows unlimited map size, and smoother movement at very high framerates)
prints dump of last 32 svc messages in packet when client encounters unknown svc (corrupt or mis-parsed network stream)
some aesthetic cleanup of tempentity parsing
rewrite of COM_FileBase
default gl_lightmaprgba to 1 (driver speedup (data bloat, but drivers are often more optimized for it), thought I defaulted it to 1 all along, but apparently not)
model names no longer use COM_FileBase (thus they are the full name, like "progs/blah.mdl" rather than "blah", "maps/start.bsp" instead of "start", etc)
fixed bugs in model colormapping, and added external skin texture support (example: progs/blah.mdl_0_normal.tga and progs/blah.mdl_0_glow.tga, pants and shirts are also supported)
support for textures inside HL maps, and the transparent color has been fixed (HL checks for pure blue, not index 255)
default r_dynamicparticles to 1 (light smoke/blood)
improvement in angled corner sticking situations (still get a little bump as you pass through, but not actually stuck)
fixed rotation support in MOVETYPE_FOLLOW, now works perfectly
extended description length in hunk headers (50 characters now)

------------------------------------------------------------------------
r164 | despair | 2001-02-28 12:41:46 -0800 (Wed, 28 Feb 2001) | 3 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c

Fix for exit segfault preventing fullscreen cleanup, and for the segfault as well.
Also enables dga mouse support, and adds in_dga_mouseaccel. DGA support needs testing.

------------------------------------------------------------------------
r160 | lordhavoc | 2001-02-27 00:11:44 -0800 (Tue, 27 Feb 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_light.c

oops, hadn't finished this

------------------------------------------------------------------------
r159 | lordhavoc | 2001-02-27 00:07:57 -0800 (Tue, 27 Feb 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile

forgot to commit this

------------------------------------------------------------------------
r158 | lordhavoc | 2001-02-27 00:07:34 -0800 (Tue, 27 Feb 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_light.c
   A /trunk/darkplaces/sv_light.c
   M /trunk/darkplaces/sv_main.c

clean up use of client structs in server

------------------------------------------------------------------------
r157 | despair | 2001-02-23 16:21:48 -0800 (Fri, 23 Feb 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_alsa_0_5.c

Minor comment update.

------------------------------------------------------------------------
r156 | despair | 2001-02-23 16:20:04 -0800 (Fri, 23 Feb 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile
   D /trunk/darkplaces/snd_alsa_0_6.c
   M /trunk/darkplaces/snd_alsa_0_9.c
   M /trunk/darkplaces/sound.h

Remove alsa 0.6 (for some random date of cvs alsa) support, never officially released. 0.9 is out, rejoice!

------------------------------------------------------------------------
r155 | despair | 2001-02-23 16:10:10 -0800 (Fri, 23 Feb 2001) | 3 lines
Changed paths:
   A /trunk/darkplaces/snd_alsa_0_9.c

Update to latest ALSA development drivers.
(Thanks again to Abramo)

------------------------------------------------------------------------
r154 | lordhavoc | 2001-02-23 16:08:51 -0800 (Fri, 23 Feb 2001) | 2 lines
Changed paths:
   A /trunk/darkplaces/model_zymotic.h

added model_zymotic.h (forgot)

------------------------------------------------------------------------
r153 | lordhavoc | 2001-02-23 15:51:02 -0800 (Fri, 23 Feb 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile
   A /trunk/darkplaces/r_explosion.c

updated makefile and added r_explosion.c (forgot)

------------------------------------------------------------------------
r152 | lordhavoc | 2001-02-23 15:39:54 -0800 (Fri, 23 Feb 2001) | 20 lines
Changed paths:
   M /trunk/darkplaces/chase.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_poly.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/gl_screen.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_alias.h
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/pr_exec.c
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_light.h
   M /trunk/darkplaces/r_part.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sv_user.c
   M /trunk/darkplaces/transform.c
   M /trunk/darkplaces/transform.h
   M /trunk/darkplaces/vid_wgl.c
   M /trunk/darkplaces/world.c

improved TraceLine in chase.c to be more generally useful (should move it to another file, though)
error checking in qmalloc/qfree
expanded COM_LoadFile max filename length from 32 to 1024
improved COM_LoadFile error messages
added COM_ToLowerString and COM_ToUpperString
.zym model support (not quite complete, in development)
unfinished transition to hardware model transforms (not used yet)
changed polylists to draw 5+ point polygons as GL_POLYGON instead of GL_TRIANGLE_FAN (I thought I had reverted to GL_POLYGON a long time ago... strange) for a minor speedup
new explosion effect (no particles)
reverted to lightmapped dynamic lighting effects (vertex hybrid still available as r_dlightmaps 0)
extreme speed improvements in which wall polygons are lit
minor optimization to lightmap building (memset to clear blocklights)
added and disabled texture caching to disk (it turned out to be a slowdown and a massive waste of space, but kept in source form incase it is ever useful)
much improved missing QC function errors (most notably think)
partial redesign of the skin colormapping engine (not used yet)
more consistent light falloff on different objects
created and scrapped a new particle explosion effect (way too fillrate intensive), superseded by the new explosion effect
only dynamically lights smoke and blood particles unless r_dynamicparticles is 2
possible fix for alt-tab bug in NVidia drivers (from Dabb)

------------------------------------------------------------------------
r151 | despair | 2001-02-18 07:14:25 -0800 (Sun, 18 Feb 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile

Undo accidental makefile commit.

------------------------------------------------------------------------
r150 | despair | 2001-02-18 07:09:37 -0800 (Sun, 18 Feb 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/net_udp.c
   M /trunk/darkplaces/sys_linux.c

Couple of 1 liner compile fixes. Missing header and missing cast.

------------------------------------------------------------------------
r149 | lordhavoc | 2001-02-13 14:07:14 -0800 (Tue, 13 Feb 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/zone.c

report name when Hunk_Alloc fails

------------------------------------------------------------------------
r148 | lordhavoc | 2001-02-12 00:24:04 -0800 (Mon, 12 Feb 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix for unitialized variable warnings

------------------------------------------------------------------------
r147 | lordhavoc | 2001-02-09 04:11:11 -0800 (Fri, 09 Feb 2001) | 21 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_poly.c
   M /trunk/darkplaces/gl_refrag.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rmisc.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/gl_screen.c
   M /trunk/darkplaces/gl_warp.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/mathlib.h
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/r_part.c
   M /trunk/darkplaces/r_sprites.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sv_user.c
   M /trunk/darkplaces/world.c

added back r_speeds2, with masses of information (6 lines high), and made it print to the screen rather than console print
changed fps reading to be integer, no fraction (is this desirable?) and moved it to bottom right corner
changed rendering order yet again
made sky and waterripple speed dependent on cl.time rather than realtime (undecided if this is desirable)
made console scrolling not subject to slowmo time scaling
some whitespace changes/cleanup
moved some registervariable definitions around
optional new worldnode function (r_newworldnode, defaults to off), very different approach, minimal speed differences...  sigh
added backface culling on surfaces (r_nobacks, defaults to off), barely a gain
in worldnode, made 'trivial inclusion' case for all children nodes of a completely successful CullBox test, defaults to off because it was no speed gain even on the most complex maps I could find
readability cleanup and minor speedup in lightmap conversion
added host_minfps (if framerate drops below this it will be slowmo, this replaces quake's hardcoded 10fps limit)
added host_maxfps (limit your framerate if desired, defaults to 1000, this does affect timedemo)
improved slowmo behavior
optimized out most vec3_origin uses (created VectorNegate and VectorClear for this reason)
fixed VectorDistance (old definition didn't work correctly, but never got used anyway)
darkened blood trails a bit
split R_DrawParticles into R_MoveParticles and R_DrawParticles (for speed profiling reasons)
fix for extremely rare and probably unnoticable bug in particle compacter
fixed a number of prediction issues, prediction does not occur in local games anymore, prediction also made optional (sv_predict cvar)

------------------------------------------------------------------------
r146 | lordhavoc | 2001-02-07 02:22:53 -0800 (Wed, 07 Feb 2001) | 2 lines
Changed paths:
   D /trunk/darkplaces/snd_linux.c
   A /trunk/darkplaces/snd_oss.c

renamed snd_linux.c to snd_oss.c

------------------------------------------------------------------------
r145 | lordhavoc | 2001-02-06 09:26:46 -0800 (Tue, 06 Feb 2001) | 8 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_light.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sys_linux.c

better version reports (always mention build number)
minor cleanup of qpic system (loading and drawing)
minor improvement to lighting engine tweakability (LIGHTSCALE2)
minor cleanup to texture tracking (totaltexels now called texeldatasize)
r_texturestats texture size reports are now correct (was showing 4x what it should have)
r_texturestats report rearranged to put size on the left for easy sorting in console logs
cruft removal

------------------------------------------------------------------------
r144 | lordhavoc | 2001-02-03 07:54:34 -0800 (Sat, 03 Feb 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/buildnumber.c

increased build number to 79

------------------------------------------------------------------------
r143 | lordhavoc | 2001-02-03 07:54:06 -0800 (Sat, 03 Feb 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_wgl.c

removed unused cvars

------------------------------------------------------------------------
r142 | lordhavoc | 2001-01-29 03:59:51 -0800 (Mon, 29 Jan 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/cmd.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/gl_warp.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_sprite.c
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/sys_linux.c
   M /trunk/darkplaces/sys_win.c
   M /trunk/darkplaces/sys_wind.c
   M /trunk/darkplaces/zone.c
   M /trunk/darkplaces/zone.h

got rid of Hunk_Alloc, all allocations now have a proper name (perhaps a bit too descriptive even), improved texture tally to list wasted skin layers (colormapping), made hunk names 24 characters instead of 8.

------------------------------------------------------------------------
r141 | lordhavoc | 2001-01-29 00:14:37 -0800 (Mon, 29 Jan 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/fractalnoise.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_poly.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/gl_screen.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/gl_warp.c
   M /trunk/darkplaces/hcompress.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_sprite.c
   M /trunk/darkplaces/palette.c
   M /trunk/darkplaces/r_part.c
   M /trunk/darkplaces/snd_mem.c
   M /trunk/darkplaces/sys_linux.c
   M /trunk/darkplaces/sys_win.c
   M /trunk/darkplaces/sys_wind.c
   M /trunk/darkplaces/wad.c

every malloc/calloc/free converted to qmalloc/qfree with tracking (memstats command), and all uses of Hunk_TempAlloc have gone away

------------------------------------------------------------------------
r140 | lordhavoc | 2001-01-28 23:00:17 -0800 (Sun, 28 Jan 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/zone.c

reduced default -zone from 512k to 128k (quake used 48k)

------------------------------------------------------------------------
r139 | lordhavoc | 2001-01-28 22:49:42 -0800 (Sun, 28 Jan 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_part.c

smoke trails no longer rise (but you could hardly tell anyway, due to their short length)

------------------------------------------------------------------------
r138 | lordhavoc | 2001-01-28 22:47:40 -0800 (Sun, 28 Jan 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_part.c

smoke trails changed again, smoke texture greatly improved

------------------------------------------------------------------------
r137 | lordhavoc | 2001-01-28 22:10:57 -0800 (Sun, 28 Jan 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_screen.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/image.h

make screenshots rightside up again (or rather, upside down like TGA wants, which happens to be the output format of glReadPixels, a fact I was unaware of, so the flipping was turning it to rightside up, which is upside down in TGA...  follow that logic?  good :)

------------------------------------------------------------------------
r136 | lordhavoc | 2001-01-28 03:03:49 -0800 (Sun, 28 Jan 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_part.c

smoke effects changed a bit (and the smoke texture generator as well), rockets trail sparks too

------------------------------------------------------------------------
r135 | lordhavoc | 2001-01-28 02:03:30 -0800 (Sun, 28 Jan 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_wgl.c

VID_CheckMultiTexture case was wrong (now VID_CheckMultitexture)

------------------------------------------------------------------------
r134 | lordhavoc | 2001-01-24 22:46:16 -0800 (Wed, 24 Jan 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile

updated OBJECTS list and added cleaning of darkplaces-3dfx

------------------------------------------------------------------------
r133 | lordhavoc | 2001-01-22 16:27:41 -0800 (Mon, 22 Jan 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_3dfxsvga.c

removed unused gldir string

------------------------------------------------------------------------
r132 | lordhavoc | 2001-01-22 16:12:34 -0800 (Mon, 22 Jan 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c

disabled unused variable

------------------------------------------------------------------------
r131 | lordhavoc | 2001-01-22 16:10:51 -0800 (Mon, 22 Jan 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_glx.c

ripped out vertex array function lookup, require OpenGL 1.2.x instead.

------------------------------------------------------------------------
r130 | lordhavoc | 2001-01-22 15:58:32 -0800 (Mon, 22 Jan 2001) | 10 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/gl_screen.c
   M /trunk/darkplaces/gl_warp.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/image.h
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/world.c

clarifications about the format of svc_fog
precache name overflow checks
gl_screen.c - whitespace changes?
sky name overflow checks
"tell" buffer overflow improvement (not really a fix)
edict parsing buffer increase (not really a fix)
increased number of leafs per entity from 64 to 256 (mem hog...  but fixes fall2.bsp  note: quake used 16 and did not have a problem with fall2?) and added warning when it runs out
removed rotating pusher hack and added solid checking
non-working MOVETYPE_FOLLOW rotation support (in-progress)

------------------------------------------------------------------------
r129 | lordhavoc | 2001-01-22 15:15:51 -0800 (Mon, 22 Jan 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/model_sprite.c

fixed (byte *) - (char *) subtraction

------------------------------------------------------------------------
r128 | taniwha | 2001-01-22 15:13:25 -0800 (Mon, 22 Jan 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/image.c

fix a char type problem

------------------------------------------------------------------------
r127 | lordhavoc | 2001-01-12 03:36:47 -0800 (Fri, 12 Jan 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/model_sprite.c

Fix for image replacement in sprites, now the sprite extension is stripped before the frame names are generated (so naming for s_explod.spr is like s_explod_0.tga, s_explod_1.tga, etc) and the extension stripping in the image loader will only strip off .lmp or .pcx or .tga, not other extensions, the sprite extension stripper is similar but for .spr and .spr32.

------------------------------------------------------------------------
r126 | lordhavoc | 2001-01-07 08:56:48 -0800 (Sun, 07 Jan 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

workaround/fix for bounds checking warning

------------------------------------------------------------------------
r125 | lordhavoc | 2001-01-07 08:49:54 -0800 (Sun, 07 Jan 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c

critical fix for COM_FileBase (could go hunting through mem for /)

------------------------------------------------------------------------
r124 | lordhavoc | 2001-01-07 08:38:16 -0800 (Sun, 07 Jan 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

workaround for bounds checking error in loading texture lump

------------------------------------------------------------------------
r123 | lordhavoc | 2001-01-07 08:11:57 -0800 (Sun, 07 Jan 2001) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c

disabled scrap system (what an eye sore that was...) and fixed interpolated text condition (now interpolated when scaling up, as it was meant to be)

------------------------------------------------------------------------
r122 | lordhavoc | 2000-12-20 14:16:15 -0800 (Wed, 20 Dec 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_part.c

smoke and blood changes

------------------------------------------------------------------------
r121 | dabb | 2000-12-10 02:59:17 -0800 (Sun, 10 Dec 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/dp-bc.mak

Added palette.c and r_sprites.c. Compiles now.

------------------------------------------------------------------------
r120 | lordhavoc | 2000-12-09 10:15:30 -0800 (Sat, 09 Dec 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/buildnumber.c

build 78

------------------------------------------------------------------------
r119 | lordhavoc | 2000-12-09 10:04:45 -0800 (Sat, 09 Dec 2000) | 26 lines
Changed paths:
   M /trunk/darkplaces/chase.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_poly.c
   M /trunk/darkplaces/gl_poly.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rmisc.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/gl_screen.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/gl_warp.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/in_win.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_sprite.c
   A /trunk/darkplaces/palette.c
   A /trunk/darkplaces/palette.h
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/r_crosshairs.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_part.c
   A /trunk/darkplaces/r_sprites.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sys_linux.c
   M /trunk/darkplaces/sys_win.c
   M /trunk/darkplaces/sys_wind.c
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_3dfxsvga.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c
   M /trunk/darkplaces/view.c
   M /trunk/darkplaces/view.h
   M /trunk/darkplaces/winquake.h
   M /trunk/darkplaces/world.c
   M /trunk/darkplaces/world.h

bmodel rotation physics now work
new vid_glx.c (contributed by zinx)
removed DPNEHAHRA engine titling
fixed some lighthalf, fog, and sky related bugs
removed some 3D card hacks
merged GL_Init code for all targets (note: vid_glx.c and vid_3dfxsvga.c may be broken)
split sprite code out in gl_sprites.c
rearranged palette management code
removed all traces of 8bit upload support for now (may be added back)
halved memory usage (although this prevents renderer restarting for the moment)
implemented r_texturestats command
removed old texture upload code
rewrote use of host_parms
rewrote some code relating to host_basepal
bigendian support in pcx loading
changed external texture character equivilant for * from + to # to avoid conflicts with animating textures
removed cruft here and there
force all textures to lowercase to mask potentially silly wad lump names in maps
new crosshairs
more stuff is extern in includes
some general cleanup of the MOVETYPE_PUSH code
rewrote portions of vid_wgl.c
V_UpdatePalette renamed to V_UpdateBlends
removed starting dialog code in wgl
made SV_RecursiveHullCheck accessable in world.h

------------------------------------------------------------------------
r118 | taniwha | 2000-11-30 09:07:00 -0800 (Thu, 30 Nov 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/net_udp.c
   M /trunk/darkplaces/net_wins.c

apply the 0 byte udp packet DoS fix from nuq.

------------------------------------------------------------------------
r117 | lordhavoc | 2000-11-28 05:22:31 -0800 (Tue, 28 Nov 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_tent.c

made glowing lightning optional

------------------------------------------------------------------------
r116 | lordhavoc | 2000-11-26 22:46:44 -0800 (Sun, 26 Nov 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_part.c

spark showers on explosions, better sparks on bullet impacts

------------------------------------------------------------------------
r115 | lordhavoc | 2000-11-26 22:40:07 -0800 (Sun, 26 Nov 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

removed cruft from debugging

------------------------------------------------------------------------
r114 | lordhavoc | 2000-11-26 22:05:23 -0800 (Sun, 26 Nov 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_shared.c

put in dprinting of model names as they are loaded

------------------------------------------------------------------------
r113 | lordhavoc | 2000-11-26 22:04:59 -0800 (Sun, 26 Nov 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_part.c

removed unused tracercount

------------------------------------------------------------------------
r112 | lordhavoc | 2000-11-26 17:47:52 -0800 (Sun, 26 Nov 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/buildnumber.c

build 77

------------------------------------------------------------------------
r111 | lordhavoc | 2000-11-26 17:37:42 -0800 (Sun, 26 Nov 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_part.c

rain splatters on the ground and water, and turns to steam on slime/lava, bubbles splatter when they leave water

------------------------------------------------------------------------
r110 | lordhavoc | 2000-11-26 15:20:07 -0800 (Sun, 26 Nov 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/fractalnoise.c
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/r_part.c

fractalnoise enhancements, better smoke textures, better bubble explosions, blood in water

------------------------------------------------------------------------
r109 | lordhavoc | 2000-11-26 01:38:00 -0800 (Sun, 26 Nov 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c

forgot to extern GL_LoadPicTexture

------------------------------------------------------------------------
r108 | lordhavoc | 2000-11-26 01:22:55 -0800 (Sun, 26 Nov 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_screen.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/image.h
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/sbar.h
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c

cruft removal, general cleanup, fix for delta compression bugs, generic targa writer

------------------------------------------------------------------------
r107 | lordhavoc | 2000-11-26 01:18:57 -0800 (Sun, 26 Nov 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_alias.h

work around gcc lacking support for no-size arrays in structures

------------------------------------------------------------------------
r106 | dabb | 2000-11-23 07:09:05 -0800 (Thu, 23 Nov 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/dp-bc.mak

Cleaned up a bit..

------------------------------------------------------------------------
r105 | dabb | 2000-11-23 07:03:59 -0800 (Thu, 23 Nov 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/dp-bc.mak

Fixed some of the mess. Might work now...

------------------------------------------------------------------------
r104 | lordhavoc | 2000-11-23 05:15:01 -0800 (Thu, 23 Nov 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/buildnumber.c

build 76

------------------------------------------------------------------------
r103 | lordhavoc | 2000-11-23 05:14:31 -0800 (Thu, 23 Nov 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/draw.h
   M /trunk/darkplaces/gl_draw.c

minor redesign of console loading/drawing, cruft removal, change to Draw_GenericPic parameter types

------------------------------------------------------------------------
r102 | lordhavoc | 2000-11-23 00:25:57 -0800 (Thu, 23 Nov 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c

cruft removal

------------------------------------------------------------------------
r101 | lordhavoc | 2000-11-23 00:24:10 -0800 (Thu, 23 Nov 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_3dfxsvga.c
   M /trunk/darkplaces/vid_glx.c

very minor cruft removal

------------------------------------------------------------------------
r100 | dabb | 2000-11-21 07:36:32 -0800 (Tue, 21 Nov 2000) | 2 lines
Changed paths:
   A /trunk/darkplaces/dp-bc.mak

Borland C++ makefile for Darkplaces. Does NOT use asm objs yet, but works otherwise.

------------------------------------------------------------------------
r99 | dabb | 2000-11-21 06:54:45 -0800 (Tue, 21 Nov 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/sys_win.c

Borland C++ compile fix - works/compiles now.

------------------------------------------------------------------------
r98 | dabb | 2000-11-21 06:49:36 -0800 (Tue, 21 Nov 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/console.c

Borland C++ compile fixes

------------------------------------------------------------------------
r97 | lordhavoc | 2000-11-21 02:17:37 -0800 (Tue, 21 Nov 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix for sprite scale bug (it was scaling vup and vright!)

------------------------------------------------------------------------
r96 | lordhavoc | 2000-11-21 01:13:52 -0800 (Tue, 21 Nov 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

merged RSurf_DrawWall/EmitWall/etc back into RSurf_DrawWall for speed reasons (split version was only for profile testing)

------------------------------------------------------------------------
r95 | lordhavoc | 2000-11-21 01:12:21 -0800 (Tue, 21 Nov 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_textures.c

fixed duplicate application of gamma correction

------------------------------------------------------------------------
r94 | lordhavoc | 2000-11-21 01:11:34 -0800 (Tue, 21 Nov 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/view.c

removed cruft

------------------------------------------------------------------------
r93 | lordhavoc | 2000-11-21 01:11:03 -0800 (Tue, 21 Nov 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_models.c

removed fullbright torch hack :)

------------------------------------------------------------------------
r92 | lordhavoc | 2000-11-21 01:09:46 -0800 (Tue, 21 Nov 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c

skip all of Draw_String when rendering is disabled

------------------------------------------------------------------------
r91 | lordhavoc | 2000-11-21 01:02:28 -0800 (Tue, 21 Nov 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/image.h
   M /trunk/darkplaces/model_sprite.c

added support to image loader for loading mask as well (used for fog effects), removed some cruft, and made sprite loader check for external textures

------------------------------------------------------------------------
r90 | lordhavoc | 2000-11-21 00:58:02 -0800 (Tue, 21 Nov 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_part.c

more particle effect changes...

------------------------------------------------------------------------
r89 | lordhavoc | 2000-11-21 00:49:51 -0800 (Tue, 21 Nov 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/cvar.c

fixed spelling error (allready -> already)

------------------------------------------------------------------------
r88 | lordhavoc | 2000-11-18 01:53:29 -0800 (Sat, 18 Nov 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_poly.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rmisc.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/gl_screen.c
   M /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/gl_warp.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/vid_3dfxsvga.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_wgl.c

implemented r_render and r_upload cvar options for CPU profiling (not hardware bound), note: defining NORENDER will disable both (useful for making profile builds)

------------------------------------------------------------------------
r87 | lordhavoc | 2000-11-18 00:37:15 -0800 (Sat, 18 Nov 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/r_light.h

removed unused 'minlight' option from dlight struct, and made muzzleflash light maller

------------------------------------------------------------------------
r86 | lordhavoc | 2000-11-18 00:12:19 -0800 (Sat, 18 Nov 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/world.c

backport of PM_RecursiveHullCheck for speedup

------------------------------------------------------------------------
r85 | lordhavoc | 2000-11-18 00:07:18 -0800 (Sat, 18 Nov 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_models.c

removed cruft

------------------------------------------------------------------------
r84 | lordhavoc | 2000-11-17 17:08:38 -0800 (Fri, 17 Nov 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_models.c

removed cruft

------------------------------------------------------------------------
r83 | lordhavoc | 2000-11-17 17:05:02 -0800 (Fri, 17 Nov 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_light.c

light only the front faces, cuts down on noticable visdata anomolies

------------------------------------------------------------------------
r82 | lordhavoc | 2000-11-17 03:28:38 -0800 (Fri, 17 Nov 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/draw.h
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/sbar.c
   M /trunk/darkplaces/vid_wgl.c

obliterated Draw_TransPic and relatives, also fixed Draw_TransPicTranslate, and restored pics to normal brightness

------------------------------------------------------------------------
r81 | lordhavoc | 2000-11-17 03:24:21 -0800 (Fri, 17 Nov 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/gl_screen.c

combined glClear calls, may be a speedup

------------------------------------------------------------------------
r80 | lordhavoc | 2000-11-17 03:22:19 -0800 (Fri, 17 Nov 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/vid_3dfxsvga.c

removed glClearColor because it was being reset in gl_screen anyway

------------------------------------------------------------------------
r79 | lordhavoc | 2000-11-17 03:20:12 -0800 (Fri, 17 Nov 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c

changed texture slots in use message (developer mode only) to not mention glquake

------------------------------------------------------------------------
r78 | lordhavoc | 2000-11-17 02:33:37 -0800 (Fri, 17 Nov 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/model_brush.h

speedups to R_WorldNode, and some shrinkage on the surface struct

------------------------------------------------------------------------
r77 | lordhavoc | 2000-11-17 02:32:00 -0800 (Fri, 17 Nov 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/sys_win.c

disabled Sys_PageIn for quicker startup (whether this is good or not is questionable)

------------------------------------------------------------------------
r76 | lordhavoc | 2000-11-17 00:35:39 -0800 (Fri, 17 Nov 2000) | 14 lines
Changed paths:
   M /trunk/darkplaces/buildnumber.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_tent.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/draw.h
   M /trunk/darkplaces/gl_draw.c
   A /trunk/darkplaces/gl_models.c
   M /trunk/darkplaces/gl_poly.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rmisc.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/gl_screen.c
   A /trunk/darkplaces/gl_textures.c
   M /trunk/darkplaces/gl_warp.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/image.c
   A /trunk/darkplaces/image.h
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_alias.h
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_shared.h
   M /trunk/darkplaces/modelgen.h
   M /trunk/darkplaces/net_wins.c
   M /trunk/darkplaces/pr_exec.c
   M /trunk/darkplaces/quakedef.h
   A /trunk/darkplaces/r_crosshairs.c
   M /trunk/darkplaces/r_light.c
   A /trunk/darkplaces/r_light.h
   A /trunk/darkplaces/r_modules.c
   A /trunk/darkplaces/r_modules.h
   M /trunk/darkplaces/r_part.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c
   M /trunk/darkplaces/view.c
   M /trunk/darkplaces/world.c

updated to version 1.50, build 75.
change log as best I can remember:
rewrote model loading and rendering
multi-pass colormapping on any model (NO UPLOADS!)
fullbrights on models (feature of new multi-pass model renderer)
rewrote texture management
rewrote texture uploading
heavily optimized static light sampling
fancy new crosshair
fixed network angle rounding (shots are fired where you're pointing, not down and to the right)
HL map hull sizes are supported (still sink into grates though)
removal of some commented out junk
other minor stuff I can't remember now

------------------------------------------------------------------------
r75 | lordhavoc | 2000-11-12 14:40:11 -0800 (Sun, 12 Nov 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/buildnumber.c

increased build number to 73

------------------------------------------------------------------------
r74 | taniwha | 2000-10-31 07:33:07 -0800 (Tue, 31 Oct 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_alsa_0_6.c

from newtree. at worst will need a header tweek

------------------------------------------------------------------------
r73 | lordhavoc | 2000-10-30 19:31:02 -0800 (Mon, 30 Oct 2000) | 5 lines
Changed paths:
   M /trunk/darkplaces/gl_poly.c
   M /trunk/darkplaces/gl_poly.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/model_brush.c

lighthalf related transpoly cleanup
major cleanup of surface rendering code for readability sake
SV_ChangeTeam added for sake of QC in mods (allows the mod to review all color changes and decide what to do with them, setcolor is useful for this)
minor light chunk loader cleanup (including a questionable bugfix relating to .lit files for maps without light data)

------------------------------------------------------------------------
r72 | lordhavoc | 2000-10-30 19:20:58 -0800 (Mon, 30 Oct 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/buildnumber.c

incremented buildnum

------------------------------------------------------------------------
r71 | lordhavoc | 2000-10-30 17:34:09 -0800 (Mon, 30 Oct 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c

added setcolor builtin

------------------------------------------------------------------------
r70 | lordhavoc | 2000-10-30 17:33:14 -0800 (Mon, 30 Oct 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/image.c

increased max pcx size to 320x256

------------------------------------------------------------------------
r69 | lordhavoc | 2000-10-28 12:04:51 -0700 (Sat, 28 Oct 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile

added buildnumber.c to makefile

------------------------------------------------------------------------
r68 | lordhavoc | 2000-10-28 11:56:55 -0700 (Sat, 28 Oct 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/buildnum/buildnum.c

fix for missing \n

------------------------------------------------------------------------
r67 | lordhavoc | 2000-10-28 11:49:33 -0700 (Sat, 28 Oct 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

recursive host_error improvement (prints both error messages)

------------------------------------------------------------------------
r66 | lordhavoc | 2000-10-28 11:47:01 -0700 (Sat, 28 Oct 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_part.c

particle audit, only one kind of gravity now, many unused particle types removed, blood trails look cooler without gravity, etc

------------------------------------------------------------------------
r65 | lordhavoc | 2000-10-28 11:45:30 -0700 (Sat, 28 Oct 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

remove never used svc_playerposition code

------------------------------------------------------------------------
r64 | lordhavoc | 2000-10-26 04:57:51 -0700 (Thu, 26 Oct 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_tent.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/r_part.c
   M /trunk/darkplaces/render.h

particle effect changes and code cleanup

------------------------------------------------------------------------
r63 | lordhavoc | 2000-10-26 04:54:41 -0700 (Thu, 26 Oct 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/sv_user.c

changes to dpprotocol code (precise aiming mainly)

------------------------------------------------------------------------
r62 | lordhavoc | 2000-10-24 03:26:19 -0700 (Tue, 24 Oct 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_part.c

fix for blob particle crash

------------------------------------------------------------------------
r61 | lordhavoc | 2000-10-21 03:25:19 -0700 (Sat, 21 Oct 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/chase.c

fixed chase_active (TraceLine no longer returns '0 0 0' when there was no impact)

------------------------------------------------------------------------
r60 | lordhavoc | 2000-10-21 03:24:28 -0700 (Sat, 21 Oct 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/view.c

fix for player model tilting in chase_active mode

------------------------------------------------------------------------
r59 | lordhavoc | 2000-10-21 03:22:24 -0700 (Sat, 21 Oct 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/sv_main.c

fix for serious bug in .nodrawtoclient, .drawonlytoclient, and .viewmodelforclient comparisons - they now work

------------------------------------------------------------------------
r58 | lordhavoc | 2000-10-21 03:15:42 -0700 (Sat, 21 Oct 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/r_part.c

major particle engine speedup and cleanup of old commented out code, also moved particle defines from glquake.h to r_part.c where they belong (all particle code should live in r_part.c)

------------------------------------------------------------------------
r57 | lordhavoc | 2000-10-17 02:38:38 -0700 (Tue, 17 Oct 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/buildnumber.c
   M /trunk/darkplaces/gl_rsurf.c

increased build number, changed default lightmap format to RGB (higher quality in 16bit modes), though this is likely to break windows Matrox G400 drivers in multitexture (the reason it was defaulted to RGBA previously)

------------------------------------------------------------------------
r56 | taniwha | 2000-10-17 00:38:23 -0700 (Tue, 17 Oct 2000) | 3 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/makefile
   D /trunk/darkplaces/snd_alsa.c
   A /trunk/darkplaces/snd_alsa_0_5.c
   A /trunk/darkplaces/snd_alsa_0_6.c

almost compiles on linux again. also bring in the latest and_alsa*.c from
newtree

------------------------------------------------------------------------
r55 | lordhavoc | 2000-10-16 15:13:00 -0700 (Mon, 16 Oct 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.h

fixed all known vertex lighting mode problems (except sorting issues)

------------------------------------------------------------------------
r54 | lordhavoc | 2000-10-16 15:11:37 -0700 (Mon, 16 Oct 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c

fix for transpolys disappearing while turning

------------------------------------------------------------------------
r53 | lordhavoc | 2000-10-16 13:48:26 -0700 (Mon, 16 Oct 2000) | 5 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/r_light.c

yet another rewrite of the dlight engine, this time FAST
new stuff:
much higher quality (loose shadowing)
gl_vertex cvar to try vertex lighting (warning: very obvious transpoly sorting problems)

------------------------------------------------------------------------
r52 | lordhavoc | 2000-10-16 13:46:19 -0700 (Mon, 16 Oct 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/mathlib.h

minor speedup to VectorNormalize #define's

------------------------------------------------------------------------
r51 | lordhavoc | 2000-10-15 08:45:12 -0700 (Sun, 15 Oct 2000) | 12 lines
Changed paths:
   A /trunk/darkplaces/buildnum
   A /trunk/darkplaces/buildnum/buildnum.c
   A /trunk/darkplaces/buildnumber.c
   M /trunk/darkplaces/chase.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_tent.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/cpu_x86.nasm
   M /trunk/darkplaces/cpu_x86.obj
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_poly.c
   M /trunk/darkplaces/gl_poly.h
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rmisc.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/gl_screen.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/mathlib.h
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/net_dgrm.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_part.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/sbar.c
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_user.c
   M /trunk/darkplaces/sys_win.c
   M /trunk/darkplaces/vid_wgl.c
   M /trunk/darkplaces/view.c
   M /trunk/darkplaces/world.c

Gigantic commit - dlight system rewritten
added serverside prediction
removed dark light support
removed explosion sparks
removed blastparticles code
particle effects changed
added build numbering
removed SetPal
removed remnants of surface cache code
fixed SZ_Clear in Host_Spawn_f
forgot what else...

------------------------------------------------------------------------
r50 | lordhavoc | 2000-10-05 15:53:22 -0700 (Thu, 05 Oct 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/host_cmd.c

Clear message buffer before calling ClientConnect, rather than after.

------------------------------------------------------------------------
r49 | taniwha | 2000-10-02 21:00:34 -0700 (Mon, 02 Oct 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile

hopefully fix the 3dfx target

------------------------------------------------------------------------
r48 | mercury | 2000-10-02 17:05:46 -0700 (Mon, 02 Oct 2000) | 3 lines
Changed paths:
   A /trunk/darkplaces/in_svgalib.c

Not adding, it has been here all along, you just have not seen it.
REALLY!

------------------------------------------------------------------------
r47 | lordhavoc | 2000-09-26 12:25:13 -0700 (Tue, 26 Sep 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_screen.c

epsilon checking on brightness and contrast cvars

------------------------------------------------------------------------
r46 | taniwha | 2000-09-25 19:28:20 -0700 (Mon, 25 Sep 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces
   A /trunk/darkplaces/.cvsignore

ignore darkplaces-glx

------------------------------------------------------------------------
r45 | lordhavoc | 2000-09-21 21:47:32 -0700 (Thu, 21 Sep 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c

raised pack file count back to 16384 and fixed stack overflow

------------------------------------------------------------------------
r44 | lordhavoc | 2000-09-21 20:52:20 -0700 (Thu, 21 Sep 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c

decreased pack file count limit to 4096 due to stack overflow

------------------------------------------------------------------------
r43 | lordhavoc | 2000-09-21 20:37:57 -0700 (Thu, 21 Sep 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/common.c

upped pack file count limit to 16384 from 2048

------------------------------------------------------------------------
r42 | lordhavoc | 2000-09-21 18:44:09 -0700 (Thu, 21 Sep 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c

lighting improvement in rgba mode, may crash some windows drivers

------------------------------------------------------------------------
r41 | lordhavoc | 2000-09-21 18:42:47 -0700 (Thu, 21 Sep 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_win.c

-sndspeed option in windows (default: 11025)

------------------------------------------------------------------------
r40 | lordhavoc | 2000-09-21 18:42:04 -0700 (Thu, 21 Sep 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_mem.c

Fix for crashs when downsampling sounds.

------------------------------------------------------------------------
r39 | lordhavoc | 2000-09-20 20:09:22 -0700 (Wed, 20 Sep 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

disabled texcoord checks in alias models, due to CTF v_star bug

------------------------------------------------------------------------
r38 | lordhavoc | 2000-09-20 20:07:58 -0700 (Wed, 20 Sep 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_dma.c
   M /trunk/darkplaces/snd_mem.c
   M /trunk/darkplaces/snd_win.c

44.1khz sound, interpolated resampling, killed cvar loadas8bit

------------------------------------------------------------------------
r37 | lordhavoc | 2000-09-20 18:47:36 -0700 (Wed, 20 Sep 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/snd_mem.c

ResampleSfx clean up and a bug fix on resampled stereo

------------------------------------------------------------------------
r36 | lordhavoc | 2000-09-18 11:45:19 -0700 (Mon, 18 Sep 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/bspfile.h
   M /trunk/darkplaces/mathlib.c
   M /trunk/darkplaces/mathlib.h
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/snd_mix.c
   M /trunk/darkplaces/sound.h
   M /trunk/darkplaces/sys.h
   M /trunk/darkplaces/sys_linux.c
   M /trunk/darkplaces/sys_win.c
   M /trunk/darkplaces/sys_wind.c

removal of various id386 junk

------------------------------------------------------------------------
r35 | lordhavoc | 2000-09-18 08:53:01 -0700 (Mon, 18 Sep 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_cmds.c

copyentity builtin added

------------------------------------------------------------------------
r34 | lordhavoc | 2000-09-18 08:52:24 -0700 (Mon, 18 Sep 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_tent.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/r_part.c

explosions push away particles

------------------------------------------------------------------------
r33 | lordhavoc | 2000-09-18 08:50:22 -0700 (Mon, 18 Sep 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/host.c

minor tweak to the forcing of color 255 to black

------------------------------------------------------------------------
r32 | lordhavoc | 2000-09-17 15:30:31 -0700 (Sun, 17 Sep 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/sbar.c

transparent statusbar

------------------------------------------------------------------------
r31 | taniwha | 2000-09-16 12:53:55 -0700 (Sat, 16 Sep 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/makefile
   A /trunk/darkplaces/snd_alsa.c

add ALSA support

------------------------------------------------------------------------
r30 | taniwha | 2000-09-15 13:34:41 -0700 (Fri, 15 Sep 2000) | 2 lines
Changed paths:
   A /trunk/darkplaces/COPYING

I think that this really should be in here

------------------------------------------------------------------------
r29 | lordhavoc | 2000-09-13 18:00:13 -0700 (Wed, 13 Sep 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/model_brush.h
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_part.c

Implemented r_ambient (mainly for sake of Nehahra's insanely dark maps).

------------------------------------------------------------------------
r28 | deek | 2000-09-12 08:12:18 -0700 (Tue, 12 Sep 2000) | 7 lines
Changed paths:
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/makefile
   M /trunk/darkplaces/sys_linux.c

host.c, sys_linux.c: Clear up linefeeds in Sys_Printf() -- we don't need to
add them, they should already be in there. Also, add optional timestamping
to console - doesn't work well with messages that call Sys_Printf() multiple
times, but for the rest it works fine.

cvar names: timestamps (int), timeformat (string)

------------------------------------------------------------------------
r27 | lordhavoc | 2000-09-11 12:28:30 -0700 (Mon, 11 Sep 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_tent.c
   M /trunk/darkplaces/gl_poly.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/gl_warp.c
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/pr_exec.c
   M /trunk/darkplaces/protocol.h
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_part.c

clean up, r_farclip cvar, lit particles (optional), stuff

------------------------------------------------------------------------
r26 | lordhavoc | 2000-09-11 11:23:06 -0700 (Mon, 11 Sep 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/menu.c

fix for uppercase nehahra movie names (oops, 'twas Ender's code).

------------------------------------------------------------------------
r25 | mercury | 2000-09-11 10:56:42 -0700 (Mon, 11 Sep 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/keys.h
   M /trunk/darkplaces/makefile
   A /trunk/darkplaces/vid_3dfxsvga.c

-3dfx support for linux!

------------------------------------------------------------------------
r24 | lordhavoc | 2000-09-06 15:11:33 -0700 (Wed, 06 Sep 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_tent.c
   M /trunk/darkplaces/console.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rmisc.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/gl_screen.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/r_light.c
   M /trunk/darkplaces/r_part.c
   M /trunk/darkplaces/render.h
   M /trunk/darkplaces/sbar.c
   M /trunk/darkplaces/sbar.h
   M /trunk/darkplaces/vid.h
   M /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_wgl.c
   M /trunk/darkplaces/view.c

Various graphical tweaks (mainly particle related), some code removed.

------------------------------------------------------------------------
r23 | lordhavoc | 2000-09-06 06:24:09 -0700 (Wed, 06 Sep 2000) | 2 lines
Changed paths:
   A /trunk/darkplaces/cd_linux.c
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_tent.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/common.h
   A /trunk/darkplaces/cpu_noasm.c
   A /trunk/darkplaces/cpu_x86.bat
   A /trunk/darkplaces/cpu_x86.nasm
   A /trunk/darkplaces/cpu_x86.obj
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rmisc.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/gl_screen.c
   M /trunk/darkplaces/gl_warp.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/image.c
   A /trunk/darkplaces/makefile
   M /trunk/darkplaces/mathlib.h
   M /trunk/darkplaces/menu.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_alias.h
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/net.h
   A /trunk/darkplaces/net_bsd.c
   M /trunk/darkplaces/net_dgrm.c
   M /trunk/darkplaces/net_main.c
   A /trunk/darkplaces/net_udp.c
   A /trunk/darkplaces/net_udp.h
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/pr_exec.c
   M /trunk/darkplaces/quakedef.h
   M /trunk/darkplaces/r_part.c
   M /trunk/darkplaces/server.h
   M /trunk/darkplaces/snd_dma.c
   A /trunk/darkplaces/snd_linux.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sv_user.c
   A /trunk/darkplaces/sys_linux.c
   M /trunk/darkplaces/sys_win.c
   M /trunk/darkplaces/vid.h
   A /trunk/darkplaces/vid_glx.c
   M /trunk/darkplaces/vid_shared.c
   M /trunk/darkplaces/vid_wgl.c
   M /trunk/darkplaces/wad.h
   M /trunk/darkplaces/winquake.h
   M /trunk/darkplaces/world.c

Linux GLX, a lot of code shrinkage/cleanup, assembly support.

------------------------------------------------------------------------
r22 | dabb | 2000-09-03 02:29:58 -0700 (Sun, 03 Sep 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/transform.h

Borland C++ compile fixes.

------------------------------------------------------------------------
r21 | lordhavoc | 2000-08-31 09:49:27 -0700 (Thu, 31 Aug 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_brush.c

extern fix

------------------------------------------------------------------------
r20 | lordhavoc | 2000-08-31 09:48:54 -0700 (Thu, 31 Aug 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/r_part.c
   M /trunk/darkplaces/vid_wgl.c
   M /trunk/darkplaces/view.c

Better smoke textures, no floodfillskin, some cleanup.

------------------------------------------------------------------------
r19 | lordhavoc | 2000-08-31 08:32:50 -0700 (Thu, 31 Aug 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/r_light.c

Fix for glowing objects sometimes appearing black.

------------------------------------------------------------------------
r18 | lordhavoc | 2000-08-31 08:08:25 -0700 (Thu, 31 Aug 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/fractalnoise.c

Very minor speedup to fractal noise generator.

------------------------------------------------------------------------
r17 | lordhavoc | 2000-08-31 07:43:53 -0700 (Thu, 31 Aug 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/model_alias.c

Major speedup to model loading, using lightnormalindex table now.

------------------------------------------------------------------------
r16 | lordhavoc | 2000-08-31 07:25:26 -0700 (Thu, 31 Aug 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/net_wipx.c

-noipx changed to -ipx at Dabb's request.

------------------------------------------------------------------------
r15 | lordhavoc | 2000-08-31 07:09:05 -0700 (Thu, 31 Aug 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_tent.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/gl_poly.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/gl_warp.c
   M /trunk/darkplaces/glquake.h
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/mathlib.h
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/r_part.c

misc. cleanup, bubble trails fixed, improved lightmap compatibility.

------------------------------------------------------------------------
r14 | lordhavoc | 2000-08-25 05:32:44 -0700 (Fri, 25 Aug 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/chase.c
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/server.h

pmodel fixes (now works properly in listen/singleplayer)

------------------------------------------------------------------------
r13 | lordhavoc | 2000-08-24 12:53:59 -0700 (Thu, 24 Aug 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/gl_rmain.c

Fog variables redesigned slightly. (no longer cvars)

------------------------------------------------------------------------
r12 | dabb | 2000-08-24 00:17:27 -0700 (Thu, 24 Aug 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_rsurf.c
   M /trunk/darkplaces/gl_screen.c
   M /trunk/darkplaces/net_wins.c
   M /trunk/darkplaces/net_wipx.c
   M /trunk/darkplaces/snd_win.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/world.c

Borland C++ compile fixes.

------------------------------------------------------------------------
r11 | lordhavoc | 2000-08-23 17:58:15 -0700 (Wed, 23 Aug 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_parse.c

SVC_FOG changed (uses a short instead of a float so QC can write it).

------------------------------------------------------------------------
r10 | lordhavoc | 2000-08-23 16:42:49 -0700 (Wed, 23 Aug 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/client.h
   M /trunk/darkplaces/host_cmd.c
   M /trunk/darkplaces/model_brush.c

HalfLife texture transparency fixed, pmodel enhanced (Nehahra).

------------------------------------------------------------------------
r9 | lordhavoc | 2000-08-23 04:26:56 -0700 (Wed, 23 Aug 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/cl_demo.c
   M /trunk/darkplaces/cl_input.c
   M /trunk/darkplaces/cl_main.c
   M /trunk/darkplaces/cl_parse.c
   M /trunk/darkplaces/cl_tent.c
   M /trunk/darkplaces/common.c
   M /trunk/darkplaces/gl_draw.c
   M /trunk/darkplaces/gl_poly.c
   M /trunk/darkplaces/gl_rmain.c
   M /trunk/darkplaces/gl_screen.c
   M /trunk/darkplaces/host.c
   M /trunk/darkplaces/image.c
   M /trunk/darkplaces/model_alias.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/model_shared.c
   M /trunk/darkplaces/model_sprite.c
   M /trunk/darkplaces/pr_cmds.c
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/pr_exec.c
   M /trunk/darkplaces/snd_dma.c
   M /trunk/darkplaces/snd_mem.c
   M /trunk/darkplaces/sv_main.c
   M /trunk/darkplaces/sv_phys.c
   M /trunk/darkplaces/sys_win.c

Too many fixes to mention. (sys_ticrate now controls packet rates, and other stuff)

------------------------------------------------------------------------
r8 | lordhavoc | 2000-08-22 18:40:45 -0700 (Tue, 22 Aug 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/gl_poly.c
   M /trunk/darkplaces/model_brush.c
   M /trunk/darkplaces/sv_main.c

Fix for HalfLife texture transparency and renderamt (originally misunderstood).

------------------------------------------------------------------------
r7 | lordhavoc | 2000-08-22 17:57:51 -0700 (Tue, 22 Aug 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/progs.h

Corrected misspelling in HL support (rendertype is now rendermode).

------------------------------------------------------------------------
r6 | lordhavoc | 2000-08-22 17:03:04 -0700 (Tue, 22 Aug 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/sv_main.c

HalfLife renderamt support (why? boredom...)

------------------------------------------------------------------------
r5 | lordhavoc | 2000-08-22 16:27:57 -0700 (Tue, 22 Aug 2000) | 2 lines
Changed paths:
   M /trunk/darkplaces/chase.c
   M /trunk/darkplaces/host_cmd.c
   D /trunk/darkplaces/in_null.c
   D /trunk/darkplaces/net_bsd.c
   D /trunk/darkplaces/nonintel.c
   M /trunk/darkplaces/pr_edict.c
   M /trunk/darkplaces/progs.h
   M /trunk/darkplaces/sv_user.c

pmodel command support for Nehahra multiplayer (select skins/models by one number - hack)

------------------------------------------------------------------------
r2 | lordhavoc | 2000-08-21 19:56:41 -0700 (Mon, 21 Aug 2000) | 2 lines
Changed paths:
   A /trunk/darkplaces
   A /trunk/darkplaces/anorms.h
   A /trunk/darkplaces/bspfile.h
   A /trunk/darkplaces/cd_win.c
   A /trunk/darkplaces/cdaudio.h
   A /trunk/darkplaces/chase.c
   A /trunk/darkplaces/cl_demo.c
   A /trunk/darkplaces/cl_input.c
   A /trunk/darkplaces/cl_main.c
   A /trunk/darkplaces/cl_parse.c
   A /trunk/darkplaces/cl_tent.c
   A /trunk/darkplaces/client.h
   A /trunk/darkplaces/cmd.c
   A /trunk/darkplaces/cmd.h
   A /trunk/darkplaces/common.c
   A /trunk/darkplaces/common.h
   A /trunk/darkplaces/conproc.c
   A /trunk/darkplaces/conproc.h
   A /trunk/darkplaces/console.c
   A /trunk/darkplaces/console.h
   A /trunk/darkplaces/crc.c
   A /trunk/darkplaces/crc.h
   A /trunk/darkplaces/cvar.c
   A /trunk/darkplaces/cvar.h
   A /trunk/darkplaces/draw.h
   A /trunk/darkplaces/fractalnoise.c
   A /trunk/darkplaces/gl_draw.c
   A /trunk/darkplaces/gl_poly.c
   A /trunk/darkplaces/gl_poly.h
   A /trunk/darkplaces/gl_refrag.c
   A /trunk/darkplaces/gl_rmain.c
   A /trunk/darkplaces/gl_rmisc.c
   A /trunk/darkplaces/gl_rsurf.c
   A /trunk/darkplaces/gl_screen.c
   A /trunk/darkplaces/gl_warp.c
   A /trunk/darkplaces/gl_warp_sin.h
   A /trunk/darkplaces/glquake.h
   A /trunk/darkplaces/hcompress.c
   A /trunk/darkplaces/host.c
   A /trunk/darkplaces/host_cmd.c
   A /trunk/darkplaces/image.c
   A /trunk/darkplaces/in_null.c
   A /trunk/darkplaces/in_win.c
   A /trunk/darkplaces/input.h
   A /trunk/darkplaces/keys.c
   A /trunk/darkplaces/keys.h
   A /trunk/darkplaces/mathlib.c
   A /trunk/darkplaces/mathlib.h
   A /trunk/darkplaces/menu.c
   A /trunk/darkplaces/menu.h
   A /trunk/darkplaces/model_alias.c
   A /trunk/darkplaces/model_alias.h
   A /trunk/darkplaces/model_brush.c
   A /trunk/darkplaces/model_brush.h
   A /trunk/darkplaces/model_shared.c
   A /trunk/darkplaces/model_shared.h
   A /trunk/darkplaces/model_sprite.c
   A /trunk/darkplaces/model_sprite.h
   A /trunk/darkplaces/modelgen.h
   A /trunk/darkplaces/net.h
   A /trunk/darkplaces/net_bsd.c
   A /trunk/darkplaces/net_dgrm.c
   A /trunk/darkplaces/net_dgrm.h
   A /trunk/darkplaces/net_loop.c
   A /trunk/darkplaces/net_loop.h
   A /trunk/darkplaces/net_main.c
   A /trunk/darkplaces/net_vcr.c
   A /trunk/darkplaces/net_vcr.h
   A /trunk/darkplaces/net_win.c
   A /trunk/darkplaces/net_wins.c
   A /trunk/darkplaces/net_wins.h
   A /trunk/darkplaces/net_wipx.c
   A /trunk/darkplaces/net_wipx.h
   A /trunk/darkplaces/nonintel.c
   A /trunk/darkplaces/pr_cmds.c
   A /trunk/darkplaces/pr_comp.h
   A /trunk/darkplaces/pr_edict.c
   A /trunk/darkplaces/pr_exec.c
   A /trunk/darkplaces/progdefs.h
   A /trunk/darkplaces/progs.h
   A /trunk/darkplaces/protocol.h
   A /trunk/darkplaces/quakedef.h
   A /trunk/darkplaces/r_light.c
   A /trunk/darkplaces/r_part.c
   A /trunk/darkplaces/render.h
   A /trunk/darkplaces/resource.h
   A /trunk/darkplaces/sbar.c
   A /trunk/darkplaces/sbar.h
   A /trunk/darkplaces/screen.h
   A /trunk/darkplaces/server.h
   A /trunk/darkplaces/snd_dma.c
   A /trunk/darkplaces/snd_mem.c
   A /trunk/darkplaces/snd_mix.c
   A /trunk/darkplaces/snd_win.c
   A /trunk/darkplaces/sound.h
   A /trunk/darkplaces/spritegn.h
   A /trunk/darkplaces/sv_main.c
   A /trunk/darkplaces/sv_move.c
   A /trunk/darkplaces/sv_phys.c
   A /trunk/darkplaces/sv_user.c
   A /trunk/darkplaces/sys.h
   A /trunk/darkplaces/sys_win.c
   A /trunk/darkplaces/sys_wind.c
   A /trunk/darkplaces/transform.c
   A /trunk/darkplaces/transform.h
   A /trunk/darkplaces/vid.h
   A /trunk/darkplaces/vid_shared.c
   A /trunk/darkplaces/vid_wgl.c
   A /trunk/darkplaces/view.c
   A /trunk/darkplaces/view.h
   A /trunk/darkplaces/wad.c
   A /trunk/darkplaces/wad.h
   A /trunk/darkplaces/winquake.h
   A /trunk/darkplaces/world.c
   A /trunk/darkplaces/world.h
   A /trunk/darkplaces/zone.c
   A /trunk/darkplaces/zone.h

Initial revision

------------------------------------------------------------------------
